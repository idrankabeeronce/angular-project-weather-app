(self.webpackChunktest_app=self.webpackChunktest_app||[]).push([[179],{906:(_s,la,Is)=>{"use strict";function Mn(i){return"function"==typeof i}function lo(i){const e=i(n=>{Error.call(n),n.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const Ge=lo(i=>function(e){i(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((n,o)=>`${o+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function u(i,t){if(i){const e=i.indexOf(t);0<=e&&i.splice(e,1)}}class re{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const c of e)c.remove(this);else e.remove(this);const{initialTeardown:n}=this;if(Mn(n))try{n()}catch(c){t=c instanceof Ge?c.errors:[c]}const{_finalizers:o}=this;if(o){this._finalizers=null;for(const c of o)try{Ce(c)}catch(f){t=t??[],f instanceof Ge?t=[...t,...f.errors]:t.push(f)}}if(t)throw new Ge(t)}}add(t){var e;if(t&&t!==this)if(this.closed)Ce(t);else{if(t instanceof re){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&u(e,t)}remove(t){const{_finalizers:e}=this;e&&u(e,t),t instanceof re&&t._removeParent(this)}}re.EMPTY=(()=>{const i=new re;return i.closed=!0,i})();const me=re.EMPTY;function Te(i){return i instanceof re||i&&"closed"in i&&Mn(i.remove)&&Mn(i.add)&&Mn(i.unsubscribe)}function Ce(i){Mn(i)?i():i.unsubscribe()}const Se={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},be={setTimeout(i,t,...e){const{delegate:n}=be;return n?.setTimeout?n.setTimeout(i,t,...e):setTimeout(i,t,...e)},clearTimeout(i){const{delegate:t}=be;return(t?.clearTimeout||clearTimeout)(i)},delegate:void 0};function ce(i){be.setTimeout(()=>{const{onUnhandledError:t}=Se;if(!t)throw i;t(i)})}function ne(){}const K=N("C",void 0,void 0);function N(i,t,e){return{kind:i,value:t,error:e}}let R=null;function I(i){if(Se.useDeprecatedSynchronousErrorHandling){const t=!R;if(t&&(R={errorThrown:!1,error:null}),i(),t){const{errorThrown:e,error:n}=R;if(R=null,e)throw n}}else i()}class P extends re{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Te(t)&&t.add(this)):this.destination=D}static create(t,e,n){return new te(t,e,n)}next(t){this.isStopped?q(function j(i){return N("N",i,void 0)}(t),this):this._next(t)}error(t){this.isStopped?q(function Y(i){return N("E",void 0,i)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?q(K,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const H=Function.prototype.bind;function W(i,t){return H.call(i,t)}class ie{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(n){ee(n)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(n){ee(n)}else ee(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){ee(e)}}}class te extends P{constructor(t,e,n){let o;if(super(),Mn(t)||!t)o={next:t??void 0,error:e??void 0,complete:n??void 0};else{let c;this&&Se.useDeprecatedNextContext?(c=Object.create(t),c.unsubscribe=()=>this.unsubscribe(),o={next:t.next&&W(t.next,c),error:t.error&&W(t.error,c),complete:t.complete&&W(t.complete,c)}):o=t}this.destination=new ie(o)}}function ee(i){Se.useDeprecatedSynchronousErrorHandling?function B(i){Se.useDeprecatedSynchronousErrorHandling&&R&&(R.errorThrown=!0,R.error=i)}(i):ce(i)}function q(i,t){const{onStoppedNotification:e}=Se;e&&be.setTimeout(()=>e(i,t))}const D={closed:!0,next:ne,error:function J(i){throw i},complete:ne},z="function"==typeof Symbol&&Symbol.observable||"@@observable";function A(i){return i}function T(i){return 0===i.length?A:1===i.length?i[0]:function(e){return i.reduce((n,o)=>o(n),e)}}let S=(()=>{class i{constructor(e){e&&(this._subscribe=e)}lift(e){const n=new i;return n.source=this,n.operator=e,n}subscribe(e,n,o){const c=function Z(i){return i&&i instanceof P||function M(i){return i&&Mn(i.next)&&Mn(i.error)&&Mn(i.complete)}(i)&&Te(i)}(e)?e:new te(e,n,o);return I(()=>{const{operator:f,source:y}=this;c.add(f?f.call(c,y):y?this._subscribe(c):this._trySubscribe(c))}),c}_trySubscribe(e){try{return this._subscribe(e)}catch(n){e.error(n)}}forEach(e,n){return new(n=O(n))((o,c)=>{const f=new te({next:y=>{try{e(y)}catch(w){c(w),f.unsubscribe()}},error:c,complete:o});this.subscribe(f)})}_subscribe(e){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(e)}[z](){return this}pipe(...e){return T(e)(this)}toPromise(e){return new(e=O(e))((n,o)=>{let c;this.subscribe(f=>c=f,f=>o(f),()=>n(c))})}}return i.create=t=>new i(t),i})();function O(i){var t;return null!==(t=i??Se.Promise)&&void 0!==t?t:Promise}const ae=lo(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let ue=(()=>{class i extends S{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const n=new ge(this,this);return n.operator=e,n}_throwIfClosed(){if(this.closed)throw new ae}next(e){I(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(e)}})}error(e){I(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:n}=this;for(;n.length;)n.shift().error(e)}})}complete(){I(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:n,isStopped:o,observers:c}=this;return n||o?me:(this.currentObservers=null,c.push(e),new re(()=>{this.currentObservers=null,u(c,e)}))}_checkFinalizedStatuses(e){const{hasError:n,thrownError:o,isStopped:c}=this;n?e.error(o):c&&e.complete()}asObservable(){const e=new S;return e.source=this,e}}return i.create=(t,e)=>new ge(t,e),i})();class ge extends ue{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===n||n.call(e,t)}error(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===n||n.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,n;return null!==(n=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==n?n:me}}function V(i){return Mn(i?.lift)}function $(i){return t=>{if(V(t))return t.lift(function(e){try{return i(e,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function de(i,t,e,n,o){return new Me(i,t,e,n,o)}class Me extends P{constructor(t,e,n,o,c,f){super(t),this.onFinalize=c,this.shouldUnsubscribe=f,this._next=e?function(y){try{e(y)}catch(w){t.error(w)}}:super._next,this._error=o?function(y){try{o(y)}catch(w){t.error(w)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(y){t.error(y)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function Ie(i,t){return $((e,n)=>{let o=0;e.subscribe(de(n,c=>{n.next(i.call(t,c,o++))}))})}function je(i){return this instanceof je?(this.v=i,this):new je(i)}function it(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=e.apply(i,t||[]),c=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(Be){n[Be]&&(o[Be]=function(Xe){return new Promise(function(ot,yt){c.push([Be,Xe,ot,yt])>1||y(Be,Xe)})})}function y(Be,Xe){try{!function w(Be){Be.value instanceof je?Promise.resolve(Be.value.v).then(L,le):ye(c[0][2],Be)}(n[Be](Xe))}catch(ot){ye(c[0][3],ot)}}function L(Be){y("next",Be)}function le(Be){y("throw",Be)}function ye(Be,Xe){Be(Xe),c.shift(),c.length&&y(c[0][0],c[0][1])}}function vt(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=i[Symbol.asyncIterator];return t?t.call(i):(i=function Tt(i){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&i[t],n=0;if(e)return e.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(c){e[c]=i[c]&&function(f){return new Promise(function(y,w){!function o(c,f,y,w){Promise.resolve(w).then(function(L){c({value:L,done:y})},f)}(y,w,(f=i[c](f)).done,f.value)})}}}const Qi=i=>i&&"number"==typeof i.length&&"function"!=typeof i;function bn(i){return Mn(i?.then)}function Ri(i){return Mn(i[z])}function _r(i){return Symbol.asyncIterator&&Mn(i?.[Symbol.asyncIterator])}function Er(i){return new TypeError(`You provided ${null!==i&&"object"==typeof i?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const go=function or(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function yr(i){return Mn(i?.[go])}function kr(i){return it(this,arguments,function*(){const e=i.getReader();try{for(;;){const{value:n,done:o}=yield je(e.read());if(o)return yield je(void 0);yield yield je(n)}}finally{e.releaseLock()}})}function Fr(i){return Mn(i?.getReader)}function _o(i){if(i instanceof S)return i;if(null!=i){if(Ri(i))return function Qe(i){return new S(t=>{const e=i[z]();if(Mn(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(i);if(Qi(i))return function Ae(i){return new S(t=>{for(let e=0;e<i.length&&!t.closed;e++)t.next(i[e]);t.complete()})}(i);if(bn(i))return function Fe(i){return new S(t=>{i.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,ce)})}(i);if(_r(i))return nt(i);if(yr(i))return function Ke(i){return new S(t=>{for(const e of i)if(t.next(e),t.closed)return;t.complete()})}(i);if(Fr(i))return function gt(i){return nt(kr(i))}(i)}throw Er(i)}function nt(i){return new S(t=>{(function Dt(i,t){var e,n,o,c;return function Ne(i,t,e,n){return new(e||(e=Promise))(function(c,f){function y(le){try{L(n.next(le))}catch(ye){f(ye)}}function w(le){try{L(n.throw(le))}catch(ye){f(ye)}}function L(le){le.done?c(le.value):function o(c){return c instanceof e?c:new e(function(f){f(c)})}(le.value).then(y,w)}L((n=n.apply(i,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=vt(i);!(n=yield e.next()).done;)if(t.next(n.value),t.closed)return}catch(f){o={error:f}}finally{try{n&&!n.done&&(c=e.return)&&(yield c.call(e))}finally{if(o)throw o.error}}t.complete()})})(i,t).catch(e=>t.error(e))})}function Et(i,t,e,n=0,o=!1){const c=t.schedule(function(){e(),o?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(c),!o)return c}function Mt(i,t,e=1/0){return Mn(t)?Mt((n,o)=>Ie((c,f)=>t(n,c,o,f))(_o(i(n,o))),e):("number"==typeof t&&(e=t),$((n,o)=>function _t(i,t,e,n,o,c,f,y){const w=[];let L=0,le=0,ye=!1;const Be=()=>{ye&&!w.length&&!L&&t.complete()},Xe=yt=>L<n?ot(yt):w.push(yt),ot=yt=>{c&&t.next(yt),L++;let jt=!1;_o(e(yt,le++)).subscribe(de(t,Gt=>{o?.(Gt),c?Xe(Gt):t.next(Gt)},()=>{jt=!0},void 0,()=>{if(jt)try{for(L--;w.length&&L<n;){const Gt=w.shift();f?Et(t,f,()=>ot(Gt)):ot(Gt)}Be()}catch(Gt){t.error(Gt)}}))};return i.subscribe(de(t,Xe,()=>{ye=!0,Be()})),()=>{y?.()}}(n,o,i,e)))}function Yt(i=1/0){return Mt(A,i)}const gi=new S(i=>i.complete());function zi(i){return i&&Mn(i.schedule)}function Pi(i){return i[i.length-1]}function Yi(i){return Mn(Pi(i))?i.pop():void 0}function dn(i){return zi(Pi(i))?i.pop():void 0}function Li(i,t=0){return $((e,n)=>{e.subscribe(de(n,o=>Et(n,i,()=>n.next(o),t),()=>Et(n,i,()=>n.complete(),t),o=>Et(n,i,()=>n.error(o),t)))})}function sr(i,t=0){return $((e,n)=>{n.add(i.schedule(()=>e.subscribe(n),t))})}function $t(i,t){if(!i)throw new Error("Iterable cannot be null");return new S(e=>{Et(e,t,()=>{const n=i[Symbol.asyncIterator]();Et(e,t,()=>{n.next().then(o=>{o.done?e.complete():e.next(o.value)})},0,!0)})})}function xr(i,t){return t?function io(i,t){if(null!=i){if(Ri(i))return function vr(i,t){return _o(i).pipe(sr(t),Li(t))}(i,t);if(Qi(i))return function bl(i,t){return new S(e=>{let n=0;return t.schedule(function(){n===i.length?e.complete():(e.next(i[n++]),e.closed||this.schedule())})})}(i,t);if(bn(i))return function Pa(i,t){return _o(i).pipe(sr(t),Li(t))}(i,t);if(_r(i))return $t(i,t);if(yr(i))return function Ws(i,t){return new S(e=>{let n;return Et(e,t,()=>{n=i[go](),Et(e,t,()=>{let o,c;try{({value:o,done:c}=n.next())}catch(f){return void e.error(f)}c?e.complete():e.next(o)},0,!0)}),()=>Mn(n?.return)&&n.return()})}(i,t);if(Fr(i))return function Ya(i,t){return $t(kr(i),t)}(i,t)}throw Er(i)}(i,t):_o(i)}function ys(...i){const t=dn(i),e=function Xn(i,t){return"number"==typeof Pi(i)?i.pop():t}(i,1/0),n=i;return n.length?1===n.length?_o(n[0]):Yt(e)(xr(n,t)):gi}function vs(i={}){const{connector:t=(()=>new ue),resetOnError:e=!0,resetOnComplete:n=!0,resetOnRefCountZero:o=!0}=i;return c=>{let f,y,w,L=0,le=!1,ye=!1;const Be=()=>{y?.unsubscribe(),y=void 0},Xe=()=>{Be(),f=w=void 0,le=ye=!1},ot=()=>{const yt=f;Xe(),yt?.unsubscribe()};return $((yt,jt)=>{L++,!ye&&!le&&Be();const Gt=w=w??t();jt.add(()=>{L--,0===L&&!ye&&!le&&(y=Nc(ot,o))}),Gt.subscribe(jt),!f&&L>0&&(f=new te({next:fi=>Gt.next(fi),error:fi=>{ye=!0,Be(),y=Nc(Xe,e,fi),Gt.error(fi)},complete:()=>{le=!0,Be(),y=Nc(Xe,n),Gt.complete()}}),_o(yt).subscribe(f))})(c)}}function Nc(i,t,...e){if(!0===t)return void i();if(!1===t)return;const n=new te({next:()=>{n.unsubscribe(),i()}});return t(...e).subscribe(n)}function br(i){for(let t in i)if(i[t]===br)return t;throw Error("Could not find renamed property on target object.")}function Mo(i,t){for(const e in t)t.hasOwnProperty(e)&&!i.hasOwnProperty(e)&&(i[e]=t[e])}function ri(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(ri).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const t=i.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function Sn(i,t){return null==i||""===i?null===t?"":t:null==t||""===t?i:i+" "+t}const Tn=br({__forward_ref__:br});function On(i){return i.__forward_ref__=On,i.toString=function(){return ri(this())},i}function tn(i){return pn(i)?i():i}function pn(i){return"function"==typeof i&&i.hasOwnProperty(Tn)&&i.__forward_ref__===On}class ti extends Error{constructor(t,e){super(function ca(i,t){return`NG0${Math.abs(i)}${t?": "+t.trim():""}`}(t,e)),this.code=t}}function Gi(i){return"string"==typeof i?i:null==i?"":String(i)}function wl(i,t){throw new ti(-201,!1)}function jo(i,t){null==i&&function an(i,t,e,n){throw new Error(`ASSERTION ERROR: ${i}`+(null==n?"":` [Expected=> ${e} ${n} ${t} <=Actual]`))}(t,i,null,"!=")}function hi(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function fn(i){return{providers:i.providers||[],imports:i.imports||[]}}function Ys(i){return Th(i,ic)||Th(i,nc)}function Th(i,t){return i.hasOwnProperty(t)?i[t]:null}function El(i){return i&&(i.hasOwnProperty(Mu)||i.hasOwnProperty(Ml))?i[Mu]:null}const ic=br({\u0275prov:br}),Mu=br({\u0275inj:br}),nc=br({ngInjectableDef:br}),Ml=br({ngInjectorDef:br});var nn=(()=>((nn=nn||{})[nn.Default=0]="Default",nn[nn.Host=1]="Host",nn[nn.Self=2]="Self",nn[nn.SkipSelf=4]="SkipSelf",nn[nn.Optional=8]="Optional",nn))();let co;function Uo(i){const t=co;return co=i,t}function Xd(i,t,e){const n=Ys(i);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:e&nn.Optional?null:void 0!==t?t:void wl(ri(i))}function ha(i){return{toString:i}.toString()}var Zs=(()=>((Zs=Zs||{})[Zs.OnPush=0]="OnPush",Zs[Zs.Default=1]="Default",Zs))(),Os=(()=>{return(i=Os||(Os={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",Os;var i})();const wr=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Ks={},Vi=[],Dh=br({\u0275cmp:br}),rc=br({\u0275dir:br}),Ah=br({\u0275pipe:br}),oc=br({\u0275mod:br}),Qs=br({\u0275fac:br}),Za=br({__NG_ELEMENT_ID__:br});let Au=0;function Cr(i){return ha(()=>{const e=!0===i.standalone,n={},o={type:i.type,providersResolver:null,decls:i.decls,vars:i.vars,factory:null,template:i.template||null,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:i.exportAs||null,onPush:i.changeDetection===Zs.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&i.dependencies||null,getStandaloneInjector:null,selectors:i.selectors||Vi,viewQuery:i.viewQuery||null,features:i.features||null,data:i.data||{},encapsulation:i.encapsulation||Os.Emulated,id:"c"+Au++,styles:i.styles||Vi,_:null,setInput:null,schemas:i.schemas||null,tView:null},c=i.dependencies,f=i.features;return o.inputs=Ih(i.inputs,n),o.outputs=Ih(i.outputs),f&&f.forEach(y=>y(o)),o.directiveDefs=c?()=>("function"==typeof c?c():c).map(Sl).filter(sc):null,o.pipeDefs=c?()=>("function"==typeof c?c():c).map(Do).filter(sc):null,o})}function Sl(i){return ar(i)||Ho(i)}function sc(i){return null!==i}function mn(i){return ha(()=>({type:i.type,bootstrap:i.bootstrap||Vi,declarations:i.declarations||Vi,imports:i.imports||Vi,exports:i.exports||Vi,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null}))}function Ih(i,t){if(null==i)return Ks;const e={};for(const n in i)if(i.hasOwnProperty(n)){let o=i[n],c=o;Array.isArray(o)&&(c=o[1],o=o[0]),e[o]=n,t&&(t[o]=c)}return e}const ci=Cr;function ar(i){return i[Dh]||null}function Ho(i){return i[rc]||null}function Do(i){return i[Ah]||null}function xs(i,t){const e=i[oc]||null;if(!e&&!0===t)throw new Error(`Type ${ri(i)} does not have '\u0275mod' property.`);return e}function rs(i){return Array.isArray(i)&&"object"==typeof i[1]}function Ao(i){return Array.isArray(i)&&!0===i[1]}function Pu(i){return 0!=(8&i.flags)}function Rh(i){return 2==(2&i.flags)}function zc(i){return 1==(1&i.flags)}function pa(i){return null!==i.template}function Og(i){return 0!=(256&i[2])}function tl(i,t){return i.hasOwnProperty(Qs)?i[Qs]:null}class Lu{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function no(){return il}function il(i){return i.type.prototype.ngOnChanges&&(i.setInput=Fu),Il}function Il(){const i=hc(this),t=i?.current;if(t){const e=i.previous;if(e===Ks)i.previous=t;else for(let n in t)e[n]=t[n];i.current=null,this.ngOnChanges(t)}}function Fu(i,t,e,n){const o=hc(i)||function Fh(i,t){return i[Nu]=t}(i,{previous:Ks,current:null}),c=o.current||(o.current={}),f=o.previous,y=this.declaredInputs[e],w=f[y];c[y]=new Lu(w&&w.currentValue,t,f===Ks),i[n]=t}no.ngInherit=!0;const Nu="__ngSimpleChanges__";function hc(i){return i[Nu]||null}function Or(i){for(;Array.isArray(i);)i=i[0];return i}function Ol(i,t){return Or(t[i])}function ko(i,t){return Or(t[i.index])}function ep(i,t){return i.data[t]}function vo(i,t){const e=t[i];return rs(e)?e:e[0]}function zu(i){return 4==(4&i[2])}function pc(i){return 64==(64&i[2])}function fa(i,t){return null==t?null:i[t]}function Uc(i){i[18]=0}function Vu(i,t){i[5]+=t;let e=i,n=i[3];for(;null!==n&&(1===t&&1===e[5]||-1===t&&0===e[5]);)n[5]+=t,e=n,n=n[3]}const hn={lFrame:ap(null),bindingsEnabled:!0};function ip(){return hn.bindingsEnabled}function ai(){return hn.lFrame.lView}function Vn(){return hn.lFrame.tView}function Io(i){return hn.lFrame.contextLView=i,i[8]}function lr(i){return hn.lFrame.contextLView=null,i}function uo(){let i=Hu();for(;null!==i&&64===i.type;)i=i.parent;return i}function Hu(){return hn.lFrame.currentTNode}function Fa(i,t){const e=hn.lFrame;e.currentTNode=i,e.isParent=t}function ma(){return hn.lFrame.isParent}function Gu(){hn.lFrame.isParent=!1}function Wo(){const i=hn.lFrame;let t=i.bindingRootIndex;return-1===t&&(t=i.bindingRootIndex=i.tView.bindingStartIndex),t}function za(){return hn.lFrame.bindingIndex++}function ga(i){const t=hn.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+i,e}function rp(i,t){const e=hn.lFrame;e.bindingIndex=e.bindingRootIndex=i,zh(t)}function zh(i){hn.lFrame.currentDirectiveIndex=i}function Rl(i){const t=hn.lFrame.currentDirectiveIndex;return-1===t?null:i[t]}function Hc(){return hn.lFrame.currentQueryIndex}function Gc(i){hn.lFrame.currentQueryIndex=i}function Nf(i){const t=i[1];return 2===t.type?t.declTNode:1===t.type?i[6]:null}function Wu(i,t,e){if(e&nn.SkipSelf){let o=t,c=i;for(;!(o=o.parent,null!==o||e&nn.Host||(o=Nf(c),null===o||(c=c[15],10&o.type))););if(null===o)return!1;t=o,i=c}const n=hn.lFrame=sp();return n.currentTNode=t,n.lView=i,!0}function Xu(i){const t=sp(),e=i[1];hn.lFrame=t,t.currentTNode=e.firstChild,t.lView=i,t.tView=e,t.contextLView=i,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function sp(){const i=hn.lFrame,t=null===i?null:i.child;return null===t?ap(i):t}function ap(i){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=t),t}function lp(){const i=hn.lFrame;return hn.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const cp=lp;function Vh(){const i=lp();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function Po(){return hn.lFrame.selectedIndex}function ia(i){hn.lFrame.selectedIndex=i}function m(){const i=hn.lFrame;return ep(i.tView,i.selectedIndex)}function l(){hn.lFrame.currentNamespace="svg"}function _(){!function x(){hn.lFrame.currentNamespace=null}()}function G(i,t){for(let e=t.directiveStart,n=t.directiveEnd;e<n;e++){const c=i.data[e].type.prototype,{ngAfterContentInit:f,ngAfterContentChecked:y,ngAfterViewInit:w,ngAfterViewChecked:L,ngOnDestroy:le}=c;f&&(i.contentHooks||(i.contentHooks=[])).push(-e,f),y&&((i.contentHooks||(i.contentHooks=[])).push(e,y),(i.contentCheckHooks||(i.contentCheckHooks=[])).push(e,y)),w&&(i.viewHooks||(i.viewHooks=[])).push(-e,w),L&&((i.viewHooks||(i.viewHooks=[])).push(e,L),(i.viewCheckHooks||(i.viewCheckHooks=[])).push(e,L)),null!=le&&(i.destroyHooks||(i.destroyHooks=[])).push(e,le)}}function Q(i,t,e){ke(i,t,3,e)}function fe(i,t,e,n){(3&i[2])===e&&ke(i,t,e,n)}function pe(i,t){let e=i[2];(3&e)===t&&(e&=2047,e+=1,i[2]=e)}function ke(i,t,e,n){const c=n??-1,f=t.length-1;let y=0;for(let w=void 0!==n?65535&i[18]:0;w<f;w++)if("number"==typeof t[w+1]){if(y=t[w],null!=n&&y>=n)break}else t[w]<0&&(i[18]+=65536),(y<c||-1==c)&&(ze(i,e,t,w),i[18]=(4294901760&i[18])+w+2),w++}function ze(i,t,e,n){const o=e[n]<0,c=e[n+1],y=i[o?-e[n]:e[n]];if(o){if(i[2]>>11<i[18]>>16&&(3&i[2])===t){i[2]+=2048;try{c.call(y)}finally{}}}else try{c.call(y)}finally{}}class $e{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function xt(i,t,e){let n=0;for(;n<e.length;){const o=e[n];if("number"==typeof o){if(0!==o)break;n++;const c=e[n++],f=e[n++],y=e[n++];i.setAttribute(t,f,y,c)}else{const c=o,f=e[++n];kt(c)?i.setProperty(t,c,f):i.setAttribute(t,c,f),n++}}return n}function Rt(i){return 3===i||4===i||6===i}function kt(i){return 64===i.charCodeAt(0)}function Ct(i,t){if(null!==t&&0!==t.length)if(null===i||0===i.length)i=t.slice();else{let e=-1;for(let n=0;n<t.length;n++){const o=t[n];"number"==typeof o?e=o:0===e||si(i,e,o,null,-1===e||2===e?t[++n]:null)}}return i}function si(i,t,e,n,o){let c=0,f=i.length;if(-1===t)f=-1;else for(;c<i.length;){const y=i[c++];if("number"==typeof y){if(y===t){f=-1;break}if(y>t){f=c-1;break}}}for(;c<i.length;){const y=i[c];if("number"==typeof y)break;if(y===e){if(null===n)return void(null!==o&&(i[c+1]=o));if(n===i[c+1])return void(i[c+2]=o)}c++,null!==n&&c++,null!==o&&c++}-1!==f&&(i.splice(f,0,t),c=f+1),i.splice(c++,0,e),null!==n&&i.splice(c++,0,n),null!==o&&i.splice(c++,0,o)}function At(i){return-1!==i}function Ht(i){return 32767&i}function ei(i,t){let e=function Ft(i){return i>>16}(i),n=t;for(;e>0;)n=n[15],e--;return n}let zt=!0;function Zt(i){const t=zt;return zt=i,t}let Ti=0;const ki={};function Ui(i,t){const e=Fi(i,t);if(-1!==e)return e;const n=t[1];n.firstCreatePass&&(i.injectorIndex=t.length,cn(n.data,i),cn(t,null),cn(n.blueprint,null));const o=Ci(i,t),c=i.injectorIndex;if(At(o)){const f=Ht(o),y=ei(o,t),w=y[1].data;for(let L=0;L<8;L++)t[c+L]=y[f+L]|w[f+L]}return t[c+8]=o,c}function cn(i,t){i.push(0,0,0,0,0,0,0,0,t)}function Fi(i,t){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===t[i.injectorIndex+8]?-1:i.injectorIndex}function Ci(i,t){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let e=0,n=null,o=t;for(;null!==o;){if(n=Oo(o),null===n)return-1;if(e++,o=o[15],-1!==n.injectorIndex)return n.injectorIndex|e<<16}return-1}function jn(i,t,e){!function Di(i,t,e){let n;"string"==typeof e?n=e.charCodeAt(0)||0:e.hasOwnProperty(Za)&&(n=e[Za]),null==n&&(n=e[Za]=Ti++);const o=255&n;t.data[i+(o>>5)]|=1<<o}(i,t,e)}function cr(i,t,e){if(e&nn.Optional)return i;wl()}function tr(i,t,e,n){if(e&nn.Optional&&void 0===n&&(n=null),0==(e&(nn.Self|nn.Host))){const o=i[9],c=Uo(void 0);try{return o?o.get(t,n,e&nn.Optional):Xd(t,n,e&nn.Optional)}finally{Uo(c)}}return cr(n,0,e)}function os(i,t,e,n=nn.Default,o){if(null!==i){if(1024&t[2]){const f=function ol(i,t,e,n,o){let c=i,f=t;for(;null!==c&&null!==f&&1024&f[2]&&!(256&f[2]);){const y=bs(c,f,e,n|nn.Self,ki);if(y!==ki)return y;let w=c.parent;if(!w){const L=f[21];if(L){const le=L.get(e,ki,n);if(le!==ki)return le}w=Oo(f),f=f[15]}c=w}return o}(i,t,e,n,ki);if(f!==ki)return f}const c=bs(i,t,e,n,ki);if(c!==ki)return c}return tr(t,e,n,o)}function bs(i,t,e,n,o){const c=function fr(i){if("string"==typeof i)return i.charCodeAt(0)||0;const t=i.hasOwnProperty(Za)?i[Za]:void 0;return"number"==typeof t?t>=0?255&t:mr:t}(e);if("function"==typeof c){if(!Wu(t,i,n))return n&nn.Host?cr(o,0,n):tr(t,e,n,o);try{const f=c(n);if(null!=f||n&nn.Optional)return f;wl()}finally{cp()}}else if("number"==typeof c){let f=null,y=Fi(i,t),w=-1,L=n&nn.Host?t[16][6]:null;for((-1===y||n&nn.SkipSelf)&&(w=-1===y?Ci(i,t):t[y+8],-1!==w&&Nr(n,!1)?(f=t[1],y=Ht(w),t=ei(w,t)):y=-1);-1!==y;){const le=t[1];if(Ln(c,y,le.data)){const ye=ss(y,t,e,f,n,L);if(ye!==ki)return ye}w=t[y+8],-1!==w&&Nr(n,t[1].data[y+8]===L)&&Ln(c,y,t)?(f=le,y=Ht(w),t=ei(w,t)):y=-1}}return o}function ss(i,t,e,n,o,c){const f=t[1],y=f.data[i+8],le=Ns(y,f,e,null==n?Rh(y)&&zt:n!=f&&0!=(3&y.type),o&nn.Host&&c===y);return null!==le?ir(t,f,le,y):ki}function Ns(i,t,e,n,o){const c=i.providerIndexes,f=t.data,y=1048575&c,w=i.directiveStart,le=c>>20,Be=o?y+le:i.directiveEnd;for(let Xe=n?y:y+le;Xe<Be;Xe++){const ot=f[Xe];if(Xe<w&&e===ot||Xe>=w&&ot.type===e)return Xe}if(o){const Xe=f[w];if(Xe&&pa(Xe)&&Xe.type===e)return w}return null}function ir(i,t,e,n){let o=i[e];const c=t.data;if(function qe(i){return i instanceof $e}(o)){const f=o;f.resolving&&function Oa(i,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${i}`:"";throw new ti(-200,`Circular dependency in DI detected for ${i}${e}`)}(function Ji(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():Gi(i)}(c[e]));const y=Zt(f.canSeeViewProviders);f.resolving=!0;const w=f.injectImpl?Uo(f.injectImpl):null;Wu(i,n,nn.Default);try{o=i[e]=f.factory(void 0,c,i,n),t.firstCreatePass&&e>=n.directiveStart&&function F(i,t,e){const{ngOnChanges:n,ngOnInit:o,ngDoCheck:c}=t.type.prototype;if(n){const f=il(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(i,f),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(i,f)}o&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-i,o),c&&((e.preOrderHooks||(e.preOrderHooks=[])).push(i,c),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(i,c))}(e,c[e],t)}finally{null!==w&&Uo(w),Zt(y),f.resolving=!1,cp()}}return o}function Ln(i,t,e){return!!(e[t+(i>>5)]&1<<i)}function Nr(i,t){return!(i&nn.Self||i&nn.Host&&t)}class Yr{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,n){return os(this._tNode,this._lView,t,n,e)}}function mr(){return new Yr(uo(),ai())}function Hn(i){return ha(()=>{const t=i.prototype.constructor,e=t[Qs]||fc(t),n=Object.prototype;let o=Object.getPrototypeOf(i.prototype).constructor;for(;o&&o!==n;){const c=o[Qs]||fc(o);if(c&&c!==e)return c;o=Object.getPrototypeOf(o)}return c=>new c})}function fc(i){return pn(i)?()=>{const t=fc(tn(i));return t&&t()}:tl(i)}function Oo(i){const t=i[1],e=t.type;return 2===e?t.declTNode:1===e?i[6]:null}function po(i){return function Un(i,t){if("class"===t)return i.classes;if("style"===t)return i.styles;const e=i.attrs;if(e){const n=e.length;let o=0;for(;o<n;){const c=e[o];if(Rt(c))break;if(0===c)o+=2;else if("number"==typeof c)for(o++;o<n&&"string"==typeof e[o];)o++;else{if(c===t)return e[o+1];o+=2}}}return null}(uo(),i)}const ls="__parameters__";function Ll(i,t,e){return ha(()=>{const n=function na(i){return function(...e){if(i){const n=i(...e);for(const o in n)this[o]=n[o]}}}(t);function o(...c){if(this instanceof o)return n.apply(this,c),this;const f=new o(...c);return y.annotation=f,y;function y(w,L,le){const ye=w.hasOwnProperty(ls)?w[ls]:Object.defineProperty(w,ls,{value:[]})[ls];for(;ye.length<=le;)ye.push(null);return(ye[le]=ye[le]||[]).push(f),w}}return e&&(o.prototype=Object.create(e.prototype)),o.prototype.ngMetadataName=i,o.annotationCls=o,o})}class ui{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=hi({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function _a(i,t){void 0===t&&(t=i);for(let e=0;e<i.length;e++){let n=i[e];Array.isArray(n)?(t===i&&(t=i.slice(0,e)),_a(n,t)):t!==i&&t.push(n)}return t}function ja(i,t){i.forEach(e=>Array.isArray(e)?ja(e,t):t(e))}function jg(i,t,e){t>=i.length?i.push(e):i.splice(t,0,e)}function Zu(i,t){return t>=i.length-1?i.pop():i.splice(t,1)[0]}function Wc(i,t){const e=[];for(let n=0;n<i;n++)e.push(t);return e}function ya(i,t,e){let n=Nl(i,t);return n>=0?i[1|n]=e:(n=~n,function Mv(i,t,e,n){let o=i.length;if(o==t)i.push(e,n);else if(1===o)i.push(n,i[0]),i[0]=e;else{for(o--,i.push(i[o-1],i[o]);o>t;)i[o]=i[o-2],o--;i[t]=e,i[t+1]=n}}(i,n,t,e)),n}function hp(i,t){const e=Nl(i,t);if(e>=0)return i[1|e]}function Nl(i,t){return function Bl(i,t,e){let n=0,o=i.length>>e;for(;o!==n;){const c=n+(o-n>>1),f=i[c<<e];if(t===f)return c<<e;f>t?o=c:n=c+1}return~(o<<e)}(i,t,1)}const Yc={},va="__NG_DI_FLAG__",Uf="ngTempTokenPath",ro=/\n/gm,gc="__source";let Zc;function Dn(i){const t=Zc;return Zc=i,t}function Tv(i,t=nn.Default){if(void 0===Zc)throw new ti(-203,!1);return null===Zc?Xd(i,void 0,t):Zc.get(i,t&nn.Optional?null:void 0,t)}function Pt(i,t=nn.Default){return(function Su(){return co}()||Tv)(tn(i),t)}function nr(i,t=nn.Default){return"number"!=typeof t&&(t=0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)),Pt(i,t)}function ra(i){const t=[];for(let e=0;e<i.length;e++){const n=tn(i[e]);if(Array.isArray(n)){if(0===n.length)throw new ti(900,!1);let o,c=nn.Default;for(let f=0;f<n.length;f++){const y=n[f],w=Xo(y);"number"==typeof w?-1===w?o=y.token:c|=w:o=y}t.push(Pt(o,c))}else t.push(Pt(n))}return t}function cs(i,t){return i[va]=t,i.prototype[va]=t,i}function Xo(i){return i[va]}const xa=cs(Ll("Optional"),8),Uh=cs(Ll("SkipSelf"),4);let $f,Wf;function Lo(i){return function Ku(){if(void 0===Wf&&(Wf=null,wr.trustedTypes))try{Wf=wr.trustedTypes.createPolicy("angular",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return Wf}()?.createHTML(i)||i}class jl{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Nv extends jl{getTypeName(){return"HTML"}}class Bv extends jl{getTypeName(){return"Style"}}class Mw extends jl{getTypeName(){return"Script"}}class Zg extends jl{getTypeName(){return"URL"}}class zv extends jl{getTypeName(){return"ResourceURL"}}function hs(i){return i instanceof jl?i.changingThisBreaksApplicationSecurity:i}function Bs(i,t){const e=function xc(i){return i instanceof jl&&i.getTypeName()||null}(i);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}class ws{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(Lo(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch{return null}}}class Ua{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const n=this.inertDocument.createElement("body");e.appendChild(n)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=Lo(t),e;const n=this.inertDocument.createElement("body");return n.innerHTML=Lo(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(t){const e=t.attributes;for(let o=e.length-1;0<o;o--){const f=e.item(o).name;("xmlns:ns1"===f||0===f.indexOf("ns1:"))&&t.removeAttribute(f)}let n=t.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const Hr=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function td(i){return(i=String(i)).match(Hr)?i:"unsafe:"+i}function xo(i){const t={};for(const e of i.split(","))t[e]=!0;return t}function gp(...i){const t={};for(const e of i)for(const n in e)e.hasOwnProperty(n)&&(t[n]=!0);return t}const jv=xo("area,br,col,hr,img,wbr"),Jg=xo("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),e_=xo("rp,rt"),qf=gp(jv,gp(Jg,xo("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),gp(e_,xo("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),gp(e_,Jg)),Yf=xo("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),t_=xo("srcset"),Zf=gp(Yf,t_,xo("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),xo("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Cs=xo("script,style,template");class Gv{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let o=this.checkClobberedElement(e,e.nextSibling);if(o){e=o;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!qf.hasOwnProperty(e))return this.sanitizedSomething=!0,!Cs.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=t.attributes;for(let o=0;o<n.length;o++){const c=n.item(o),f=c.name,y=f.toLowerCase();if(!Zf.hasOwnProperty(y)){this.sanitizedSomething=!0;continue}let w=c.value;Yf[y]&&(w=td(w)),t_[y]&&(i=w,w=(i=String(i)).split(",").map(t=>td(t.trim())).join(", ")),this.buf.push(" ",f,'="',Wv(w),'"')}var i;return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();qf.hasOwnProperty(e)&&!jv.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(Wv(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const Dw=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,$v=/([^\#-~ |!])/g;function Wv(i){return i.replace(/&/g,"&amp;").replace(Dw,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace($v,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Kf;function i_(i,t){let e=null;try{Kf=Kf||function ed(i){const t=new Ua(i);return function Qg(){try{return!!(new window.DOMParser).parseFromString(Lo(""),"text/html")}catch{return!1}}()?new ws(t):t}(i);let n=t?String(t):"";e=Kf.getInertBodyElement(n);let o=5,c=n;do{if(0===o)throw new Error("Failed to sanitize html because the input is unstable");o--,n=c,c=e.innerHTML,e=Kf.getInertBodyElement(n)}while(n!==c);return Lo((new Gv).sanitizeChildren(Qf(e)||e))}finally{if(e){const n=Qf(e)||e;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function Qf(i){return"content"in i&&function Xv(i){return i.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===i.nodeName}(i)?i.content:null}var hr=(()=>((hr=hr||{})[hr.NONE=0]="NONE",hr[hr.HTML=1]="HTML",hr[hr.STYLE=2]="STYLE",hr[hr.SCRIPT=3]="SCRIPT",hr[hr.URL=4]="URL",hr[hr.RESOURCE_URL=5]="RESOURCE_URL",hr))();function Jf(i){const t=function wc(){const i=ai();return i&&i[12]}();return t?t.sanitize(hr.URL,i)||"":Bs(i,"URL")?hs(i):td(Gi(i))}const n_=new ui("ENVIRONMENT_INITIALIZER"),qv=new ui("INJECTOR",-1),Yv=new ui("INJECTOR_DEF_TYPES");class Zv{get(t,e=Yc){if(e===Yc){const n=new Error(`NullInjectorError: No provider for ${ri(t)}!`);throw n.name="NullInjectorError",n}return e}}function Ow(...i){return{\u0275providers:Kv(0,i)}}function Kv(i,...t){const e=[],n=new Set;let o;return ja(t,c=>{const f=c;yp(f,e,[],n)&&(o||(o=[]),o.push(f))}),void 0!==o&&Qv(o,e),e}function Qv(i,t){for(let e=0;e<i.length;e++){const{providers:o}=i[e];ja(o,c=>{t.push(c)})}}function yp(i,t,e,n){if(!(i=tn(i)))return!1;let o=null,c=El(i);const f=!c&&ar(i);if(c||f){if(f&&!f.standalone)return!1;o=i}else{const w=i.ngModule;if(c=El(w),!c)return!1;o=w}const y=n.has(o);if(f){if(y)return!1;if(n.add(o),f.dependencies){const w="function"==typeof f.dependencies?f.dependencies():f.dependencies;for(const L of w)yp(L,t,e,n)}}else{if(!c)return!1;{if(null!=c.imports&&!y){let L;n.add(o);try{ja(c.imports,le=>{yp(le,t,e,n)&&(L||(L=[]),L.push(le))})}finally{}void 0!==L&&Qv(L,t)}if(!y){const L=tl(o)||(()=>new o);t.push({provide:o,useFactory:L,deps:Vi},{provide:Yv,useValue:o,multi:!0},{provide:n_,useValue:()=>Pt(o),multi:!0})}const w=c.providers;null==w||y||ja(w,le=>{t.push(le)})}}return o!==i&&void 0!==i.providers}const od=br({provide:String,useValue:br});function r_(i){return null!==i&&"object"==typeof i&&od in i}function Jc(i){return"function"==typeof i}const sd=new ui("Set Injector scope."),eh={},Jv={};let nm;function th(){return void 0===nm&&(nm=new Zv),nm}class Ul{}class rm extends Ul{constructor(t,e,n,o){super(),this.parent=e,this.source=n,this.scopes=o,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,l_(t,f=>this.processProvider(f)),this.records.set(qv,ih(void 0,this)),o.has("environment")&&this.records.set(Ul,ih(void 0,this));const c=this.records.get(sd);null!=c&&"string"==typeof c.value&&this.scopes.add(c.value),this.injectorDefTypes=new Set(this.get(Yv.multi,Vi,nn.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();for(const t of this._onDestroyHooks)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(t){this._onDestroyHooks.push(t)}runInContext(t){this.assertNotDestroyed();const e=Dn(this),n=Uo(void 0);try{return t()}finally{Dn(e),Uo(n)}}get(t,e=Yc,n=nn.Default){this.assertNotDestroyed();const o=Dn(this),c=Uo(void 0);try{if(!(n&nn.SkipSelf)){let y=this.records.get(t);if(void 0===y){const w=function a_(i){return"function"==typeof i||"object"==typeof i&&i instanceof ui}(t)&&Ys(t);y=w&&this.injectableDefInScope(w)?ih(o_(t),eh):null,this.records.set(t,y)}if(null!=y)return this.hydrate(t,y)}return(n&nn.Self?th():this.parent).get(t,e=n&nn.Optional&&e===Yc?null:e)}catch(f){if("NullInjectorError"===f.name){if((f[Uf]=f[Uf]||[]).unshift(ri(t)),o)throw f;return function Dv(i,t,e,n){const o=i[Uf];throw t[gc]&&o.unshift(t[gc]),i.message=function zl(i,t,e,n=null){i=i&&"\n"===i.charAt(0)&&"\u0275"==i.charAt(1)?i.slice(2):i;let o=ri(t);if(Array.isArray(t))o=t.map(ri).join(" -> ");else if("object"==typeof t){let c=[];for(let f in t)if(t.hasOwnProperty(f)){let y=t[f];c.push(f+":"+("string"==typeof y?JSON.stringify(y):ri(y)))}o=`{${c.join(", ")}}`}return`${e}${n?"("+n+")":""}[${o}]: ${i.replace(ro,"\n  ")}`}("\n"+i.message,o,e,n),i.ngTokenPath=o,i[Uf]=null,i}(f,t,"R3InjectorError",this.source)}throw f}finally{Uo(c),Dn(o)}}resolveInjectorInitializers(){const t=Dn(this),e=Uo(void 0);try{const n=this.get(n_.multi,Vi,nn.Self);for(const o of n)o()}finally{Dn(t),Uo(e)}}toString(){const t=[],e=this.records;for(const n of e.keys())t.push(ri(n));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ti(205,!1)}processProvider(t){let e=Jc(t=tn(t))?t:tn(t&&t.provide);const n=function xp(i){return r_(i)?ih(void 0,i.useValue):ih(t0(i),eh)}(t);if(Jc(t)||!0!==t.multi)this.records.get(e);else{let o=this.records.get(e);o||(o=ih(void 0,eh,!0),o.factory=()=>ra(o.multi),this.records.set(e,o)),e=t,o.multi.push(t)}this.records.set(e,n)}hydrate(t,e){return e.value===eh&&(e.value=Jv,e.value=e.factory()),"object"==typeof e.value&&e.value&&function s_(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=tn(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function o_(i){const t=Ys(i),e=null!==t?t.factory:tl(i);if(null!==e)return e;if(i instanceof ui)throw new ti(204,!1);if(i instanceof Function)return function e0(i){const t=i.length;if(t>0)throw Wc(t,"?"),new ti(204,!1);const e=function kg(i){const t=i&&(i[ic]||i[nc]);if(t){const e=function Wd(i){if(i.hasOwnProperty("name"))return i.name;const t=(""+i).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(i);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(i);return null!==e?()=>e.factory(i):()=>new i}(i);throw new ti(204,!1)}function t0(i,t,e){let n;if(Jc(i)){const o=tn(i);return tl(o)||o_(o)}if(r_(i))n=()=>tn(i.useValue);else if(function vp(i){return!(!i||!i.useFactory)}(i))n=()=>i.useFactory(...ra(i.deps||[]));else if(function Gr(i){return!(!i||!i.useExisting)}(i))n=()=>Pt(tn(i.useExisting));else{const o=tn(i&&(i.useClass||i.provide));if(!function Rw(i){return!!i.deps}(i))return tl(o)||o_(o);n=()=>new o(...ra(i.deps))}return n}function ih(i,t,e=!1){return{factory:i,value:t,multi:e?[]:void 0}}function om(i){return!!i.\u0275providers}function l_(i,t){for(const e of i)Array.isArray(e)?l_(e,t):om(e)?l_(e.\u0275providers,t):t(e)}class n0{}class sm{resolveComponentFactory(t){throw function Fw(i){const t=Error(`No component factory found for ${ri(i)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=i,t}(t)}}let Xh=(()=>{class i{}return i.NULL=new sm,i})();function o0(){return ll(uo(),ai())}function ll(i,t){return new Zn(ko(i,t))}let Zn=(()=>{class i{constructor(e){this.nativeElement=e}}return i.__NG_ELEMENT_ID__=o0,i})();function Nw(i){return i instanceof Zn?i.nativeElement:i}class ad{}let Hl=(()=>{class i{}return i.__NG_ELEMENT_ID__=()=>function Bw(){const i=ai(),e=vo(uo().index,i);return(rs(e)?e:i)[11]}(),i})(),zw=(()=>{class i{}return i.\u0275prov=hi({token:i,providedIn:"root",factory:()=>null}),i})();class qh{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const c_=new qh("14.2.1"),ld={};function mm(i){return i.ngOriginalError}class $r{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&mm(t);for(;e&&mm(e);)e=mm(e);return e||null}}const f_=new Map;let Xw=0;const g_="__ngContext__";function Ms(i,t){rs(t)?(i[g_]=t[20],function gm(i){f_.set(i[20],i)}(t)):i[g_]=t}function Cp(i){const t=i[g_];return"number"==typeof t?function h0(i){return f_.get(i)||null}(t):t||null}function _m(i){const t=Cp(i);return t?rs(t)?t:t.lView:null}function Gl(i){return i instanceof Function?i():i}var zs=(()=>((zs=zs||{})[zs.Important=1]="Important",zs[zs.DashCase=2]="DashCase",zs))();function x_(i,t){return undefined(i,t)}function Dp(i){const t=i[3];return Ao(t)?t[3]:t}function b_(i){return Zh(i[13])}function ud(i){return Zh(i[4])}function Zh(i){for(;null!==i&&!Ao(i);)i=i[4];return i}function dd(i,t,e,n,o){if(null!=n){let c,f=!1;Ao(n)?c=n:rs(n)&&(f=!0,n=n[0]);const y=Or(n);0===i&&null!==e?null==o?D_(t,e,y):Kh(t,e,y,o||null,!0):1===i&&null!==e?Kh(t,e,y,o||null,!0):2===i?function k_(i,t,e){const n=Ip(i,t);n&&function b0(i,t,e,n){i.removeChild(t,e,n)}(i,n,t,e)}(t,y,f):3===i&&t.destroyNode(y),null!=c&&function l1(i,t,e,n,o){const c=e[7];c!==Or(e)&&dd(t,i,n,c,o);for(let y=10;y<e.length;y++){const w=e[y];gd(w[1],w,i,t,n,c)}}(t,i,c,e,o)}}function Ap(i,t,e){return i.createElement(t,e)}function y0(i,t){const e=i[9],n=e.indexOf(t),o=t[3];512&t[2]&&(t[2]&=-513,Vu(o,-1)),e.splice(n,1)}function vm(i,t){if(i.length<=10)return;const e=10+t,n=i[e];if(n){const o=n[17];null!==o&&o!==i&&y0(o,n),t>0&&(i[e-1][4]=n[4]);const c=Zu(i,10+t);!function _0(i,t){gd(i,t,t[11],2,null,null),t[0]=null,t[6]=null}(n[1],n);const f=c[19];null!==f&&f.detachView(c[1]),n[3]=null,n[4]=null,n[2]&=-65}return n}function M_(i,t){if(!(128&t[2])){const e=t[11];e.destroyNode&&gd(i,t,e,3,null,null),function pd(i){let t=i[13];if(!t)return S_(i[1],i);for(;t;){let e=null;if(rs(t))e=t[13];else{const n=t[10];n&&(e=n)}if(!e){for(;t&&!t[4]&&t!==i;)rs(t)&&S_(t[1],t),t=t[3];null===t&&(t=i),rs(t)&&S_(t[1],t),e=t&&t[4]}t=e}}(t)}}function S_(i,t){if(!(128&t[2])){t[2]&=-65,t[2]|=128,function x0(i,t){let e;if(null!=i&&null!=(e=i.destroyHooks))for(let n=0;n<e.length;n+=2){const o=t[e[n]];if(!(o instanceof $e)){const c=e[n+1];if(Array.isArray(c))for(let f=0;f<c.length;f+=2){const y=o[c[f]],w=c[f+1];try{w.call(y)}finally{}}else try{c.call(o)}finally{}}}}(i,t),function v0(i,t){const e=i.cleanup,n=t[7];let o=-1;if(null!==e)for(let c=0;c<e.length-1;c+=2)if("string"==typeof e[c]){const f=e[c+1],y="function"==typeof f?f(t):Or(t[f]),w=n[o=e[c+2]],L=e[c+3];"boolean"==typeof L?y.removeEventListener(e[c],w,L):L>=0?n[o=L]():n[o=-L].unsubscribe(),c+=2}else{const f=n[o=e[c+1]];e[c].call(f)}if(null!==n){for(let c=o+1;c<n.length;c++)(0,n[c])();t[7]=null}}(i,t),1===t[1].type&&t[11].destroy();const e=t[17];if(null!==e&&Ao(t[3])){e!==t[3]&&y0(e,t);const n=t[19];null!==n&&n.detachView(i)}!function u0(i){f_.delete(i[20])}(t)}}function xm(i,t,e){return function T_(i,t,e){let n=t;for(;null!==n&&40&n.type;)n=(t=n).parent;if(null===n)return e[0];if(2&n.flags){const o=i.data[n.directiveStart].encapsulation;if(o===Os.None||o===Os.Emulated)return null}return ko(n,e)}(i,t.parent,e)}function Kh(i,t,e,n,o){i.insertBefore(t,e,n,o)}function D_(i,t,e){i.appendChild(t,e)}function Wl(i,t,e,n,o){null!==n?Kh(i,t,e,n,o):D_(i,t,e)}function Ip(i,t){return i.parentNode(t)}function C0(i,t,e){return A_(i,t,e)}let A_=function E0(i,t,e){return 40&i.type?ko(i,e):null};function Pp(i,t,e,n){const o=xm(i,n,t),c=t[11],y=C0(n.parent||t[6],n,t);if(null!=o)if(Array.isArray(e))for(let w=0;w<e.length;w++)Wl(c,o,e[w],y,!1);else Wl(c,o,e,y,!1)}function Op(i,t){if(null!==t){const e=t.type;if(3&e)return ko(t,i);if(4&e)return nh(-1,i[t.index]);if(8&e){const n=t.child;if(null!==n)return Op(i,n);{const o=i[t.index];return Ao(o)?nh(-1,o):Or(o)}}if(32&e)return x_(t,i)()||Or(i[t.index]);{const n=wm(i,t);return null!==n?Array.isArray(n)?n[0]:Op(Dp(i[16]),n):Op(i,t.next)}}return null}function wm(i,t){return null!==t?i[16][6].projection[t.projection]:null}function nh(i,t){const e=10+i+1;if(e<t.length){const n=t[e],o=n[1].firstChild;if(null!==o)return Op(n,o)}return t[7]}function md(i,t,e,n,o,c,f){for(;null!=e;){const y=n[e.index],w=e.type;if(f&&0===t&&(y&&Ms(Or(y),n),e.flags|=4),64!=(64&e.flags))if(8&w)md(i,t,e.child,n,o,c,!1),dd(t,i,o,y,c);else if(32&w){const L=x_(e,n);let le;for(;le=L();)dd(t,i,o,le,c);dd(t,i,o,y,c)}else 16&w?Rp(i,t,n,e,o,c):dd(t,i,o,y,c);e=f?e.projectionNext:e.next}}function gd(i,t,e,n,o,c){md(e,n,i.firstChild,t,o,c,!1)}function Rp(i,t,e,n,o,c){const f=e[16],w=f[6].projection[n.projection];if(Array.isArray(w))for(let L=0;L<w.length;L++)dd(t,i,o,w[L],c);else md(i,t,w,f[3],o,c,!0)}function M0(i,t,e){i.setAttribute(t,"style",e)}function I_(i,t,e){""===e?i.removeAttribute(t,"class"):i.setAttribute(t,"class",e)}function S0(i,t,e){let n=i.length;for(;;){const o=i.indexOf(t,e);if(-1===o)return o;if(0===o||i.charCodeAt(o-1)<=32){const c=t.length;if(o+c===n||i.charCodeAt(o+c)<=32)return o}e=o+1}}const Em="ng-template";function h1(i,t,e){let n=0;for(;n<i.length;){let o=i[n++];if(e&&"class"===o){if(o=i[n],-1!==S0(o.toLowerCase(),t,0))return!0}else if(1===o){for(;n<i.length&&"string"==typeof(o=i[n++]);)if(o.toLowerCase()===t)return!0;return!1}}return!1}function P_(i){return 4===i.type&&i.value!==Em}function u1(i,t,e){return t===(4!==i.type||e?i.value:Em)}function O_(i,t,e){let n=4;const o=i.attrs||[],c=function Mm(i){for(let t=0;t<i.length;t++)if(Rt(i[t]))return t;return i.length}(o);let f=!1;for(let y=0;y<t.length;y++){const w=t[y];if("number"!=typeof w){if(!f)if(4&n){if(n=2|1&n,""!==w&&!u1(i,w,e)||""===w&&1===t.length){if(hl(n))return!1;f=!0}}else{const L=8&n?w:t[++y];if(8&n&&null!==i.attrs){if(!h1(i.attrs,L,e)){if(hl(n))return!1;f=!0}continue}const ye=rh(8&n?"class":w,o,P_(i),e);if(-1===ye){if(hl(n))return!1;f=!0;continue}if(""!==L){let Be;Be=ye>c?"":o[ye+1].toLowerCase();const Xe=8&n?Be:null;if(Xe&&-1!==S0(Xe,L,0)||2&n&&L!==Be){if(hl(n))return!1;f=!0}}}}else{if(!f&&!hl(n)&&!hl(w))return!1;if(f&&hl(w))continue;f=!1,n=w|1&n}}return hl(n)||f}function hl(i){return 0==(1&i)}function rh(i,t,e,n){if(null===t)return-1;let o=0;if(n||!e){let c=!1;for(;o<t.length;){const f=t[o];if(f===i)return o;if(3===f||6===f)c=!0;else{if(1===f||2===f){let y=t[++o];for(;"string"==typeof y;)y=t[++o];continue}if(4===f)break;if(0===f){o+=4;continue}}o+=c?1:2}return-1}return function L_(i,t){let e=i.indexOf(4);if(e>-1)for(e++;e<i.length;){const n=i[e];if("number"==typeof n)return-1;if(n===t)return e;e++}return-1}(t,i)}function R_(i,t,e=!1){for(let n=0;n<t.length;n++)if(O_(i,t[n],e))return!0;return!1}function d1(i,t){e:for(let e=0;e<t.length;e++){const n=t[e];if(i.length===n.length){for(let o=0;o<i.length;o++)if(i[o]!==n[o])continue e;return!0}}return!1}function D0(i,t){return i?":not("+t.trim()+")":t}function A0(i){let t=i[0],e=1,n=2,o="",c=!1;for(;e<i.length;){let f=i[e];if("string"==typeof f)if(2&n){const y=i[++e];o+="["+f+(y.length>0?'="'+y+'"':"")+"]"}else 8&n?o+="."+f:4&n&&(o+=" "+f);else""!==o&&!hl(f)&&(t+=D0(c,o),o=""),n=f,c=c||!hl(n);e++}return""!==o&&(t+=D0(c,o)),t}const sn={};function Ni(i){Qh(Vn(),ai(),Po()+i,!1)}function Qh(i,t,e,n){if(!n)if(3==(3&t[2])){const c=i.preOrderCheckHooks;null!==c&&Q(t,c,e)}else{const c=i.preOrderHooks;null!==c&&fe(t,c,0,e)}ia(e)}function N_(i,t=null,e=null,n){const o=B_(i,t,e,n);return o.resolveInjectorInitializers(),o}function B_(i,t=null,e=null,n,o=new Set){const c=[e||Vi,Ow(i)];return n=n||("object"==typeof i?void 0:ri(i)),new rm(c,t||th(),n||null,o)}let Wr=(()=>{class i{static create(e,n){if(Array.isArray(e))return N_({name:""},n,e,"");{const o=e.name??"";return N_({name:o},e.parent,e.providers,o)}}}return i.THROW_IF_NOT_FOUND=Yc,i.NULL=new Zv,i.\u0275prov=hi({token:i,providedIn:"any",factory:()=>Pt(qv)}),i.__NG_ELEMENT_ID__=-1,i})();function ft(i,t=nn.Default){const e=ai();return null===e?Pt(i,t):os(uo(),e,tn(i),t)}function iu(){throw new Error("invalid")}function Hp(i,t){return i<<17|t<<2}function ul(i){return i>>17&32767}function Im(i){return 2|i}function Cc(i){return(131068&i)>>2}function $_(i,t){return-131069&i|t<<2}function bd(i){return 1|i}function ou(i,t){const e=i.contentQueries;if(null!==e)for(let n=0;n<e.length;n+=2){const o=e[n],c=e[n+1];if(-1!==c){const f=i.data[c];Gc(o),f.contentQueries(2,t[c],c)}}}function Ca(i,t,e,n,o,c,f,y,w,L,le){const ye=t.blueprint.slice();return ye[0]=o,ye[2]=76|n,(null!==le||i&&1024&i[2])&&(ye[2]|=1024),Uc(ye),ye[3]=ye[15]=i,ye[8]=e,ye[10]=f||i&&i[10],ye[11]=y||i&&i[11],ye[12]=w||i&&i[12]||null,ye[9]=L||i&&i[9]||null,ye[6]=c,ye[20]=function qw(){return Xw++}(),ye[21]=le,ye[16]=2==t.type?i[16]:ye,ye}function ch(i,t,e,n,o){let c=i.data[t];if(null===c)c=function Xp(i,t,e,n,o){const c=Hu(),f=ma(),w=i.data[t]=function G0(i,t,e,n,o,c){return{type:e,index:n,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:o,attrs:c,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,f?c:c&&c.parent,e,t,n,o);return null===i.firstChild&&(i.firstChild=w),null!==c&&(f?null==c.child&&null!==w.parent&&(c.child=w):null===c.next&&(c.next=w)),w}(i,t,e,n,o),function Ff(){return hn.lFrame.inI18n}()&&(c.flags|=64);else if(64&c.type){c.type=e,c.value=n,c.attrs=o;const f=function Nh(){const i=hn.lFrame,t=i.currentTNode;return i.isParent?t:t.parent}();c.injectorIndex=null===f?-1:f.injectorIndex}return Fa(c,!0),c}function Ss(i,t,e,n){if(0===e)return-1;const o=t.length;for(let c=0;c<e;c++)t.push(n),i.blueprint.push(n),i.data.push(null);return o}function ql(i,t,e){Xu(t);try{const n=i.viewQuery;null!==n&&_n(1,n,e);const o=i.template;null!==o&&Ed(i,t,o,1,e),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&ou(i,t),i.staticViewQueries&&_n(2,i.viewQuery,e);const c=i.components;null!==c&&function ty(i,t){for(let e=0;e<t.length;e++)oi(i,t[e])}(t,c)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{t[2]&=-5,Vh()}}function Cd(i,t,e,n){const o=t[2];if(128!=(128&o)){Xu(t);try{Uc(t),function rl(i){return hn.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==e&&Ed(i,t,e,2,n);const f=3==(3&o);if(f){const L=i.preOrderCheckHooks;null!==L&&Q(t,L,null)}else{const L=i.preOrderHooks;null!==L&&fe(t,L,0,null),pe(t,0)}if(function Xt(i){for(let t=b_(i);null!==t;t=ud(t)){if(!t[2])continue;const e=t[9];for(let n=0;n<e.length;n++){const o=e[n],c=o[3];0==(512&o[2])&&Vu(c,1),o[2]|=512}}}(t),function Bt(i){for(let t=b_(i);null!==t;t=ud(t))for(let e=10;e<t.length;e++){const n=t[e],o=n[1];pc(n)&&Cd(o,n,o.template,n[8])}}(t),null!==i.contentQueries&&ou(i,t),f){const L=i.contentCheckHooks;null!==L&&Q(t,L)}else{const L=i.contentHooks;null!==L&&fe(t,L,1),pe(t,1)}!function T1(i,t){const e=i.hostBindingOpCodes;if(null!==e)try{for(let n=0;n<e.length;n++){const o=e[n];if(o<0)ia(~o);else{const c=o,f=e[++n],y=e[++n];rp(f,c),y(2,t[c])}}}finally{ia(-1)}}(i,t);const y=i.components;null!==y&&function ey(i,t){for(let e=0;e<t.length;e++)Qt(i,t[e])}(t,y);const w=i.viewQuery;if(null!==w&&_n(2,w,n),f){const L=i.viewCheckHooks;null!==L&&Q(t,L)}else{const L=i.viewHooks;null!==L&&fe(t,L,2),pe(t,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),t[2]&=-41,512&t[2]&&(t[2]&=-513,Vu(t[3],-1))}finally{Vh()}}}function j0(i,t,e,n){const o=t[10],f=zu(t);try{!f&&o.begin&&o.begin(),f&&ql(i,t,n),Cd(i,t,e,n)}finally{!f&&o.end&&o.end()}}function Ed(i,t,e,n,o){const c=Po(),f=2&n;try{ia(-1),f&&t.length>22&&Qh(i,t,22,!1),e(n,o)}finally{ia(c)}}function qp(i,t,e){if(Pu(t)){const o=t.directiveEnd;for(let c=t.directiveStart;c<o;c++){const f=i.data[c];f.contentQueries&&f.contentQueries(1,e[c],c)}}}function zm(i,t,e){!ip()||(function se(i,t,e,n){const o=e.directiveStart,c=e.directiveEnd;i.firstCreatePass||Ui(e,t),Ms(n,t);const f=e.initialInputs;for(let y=o;y<c;y++){const w=i.data[y],L=pa(w);L&&st(t,e,w);const le=ir(t,i,y,e);Ms(le,t),null!==f&&Ot(0,y-o,le,w,0,f),L&&(vo(e.index,t)[8]=le)}}(i,t,e,ko(e,t)),128==(128&e.flags)&&function he(i,t,e){const n=e.directiveStart,o=e.directiveEnd,c=e.index,f=function op(){return hn.lFrame.currentDirectiveIndex}();try{ia(c);for(let y=n;y<o;y++){const w=i.data[y],L=t[y];zh(y),(null!==w.hostBindings||0!==w.hostVars||null!==w.hostAttrs)&&_e(w,L)}}finally{ia(-1),zh(f)}}(i,t,e))}function Vm(i,t,e=ko){const n=t.localNames;if(null!==n){let o=t.index+1;for(let c=0;c<n.length;c+=2){const f=n[c+1],y=-1===f?e(t,i):i[f];i[o++]=y}}}function U0(i){const t=i.tView;return null===t||t.incompleteFirstPass?i.tView=jm(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):t}function jm(i,t,e,n,o,c,f,y,w,L){const le=22+n,ye=le+o,Be=function H0(i,t){const e=[];for(let n=0;n<t;n++)e.push(n<i?null:sn);return e}(le,ye),Xe="function"==typeof L?L():L;return Be[1]={type:i,blueprint:Be,template:e,queries:null,viewQuery:y,declTNode:t,data:Be.slice().fill(null,le),bindingStartIndex:le,expandoStartIndex:ye,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof c?c():c,pipeRegistry:"function"==typeof f?f():f,firstChild:null,schemas:w,consts:Xe,incompleteFirstPass:!1}}function ny(i,t,e,n){const o=Wi(t);null===e?o.push(n):(o.push(e),i.firstCreatePass&&Kn(i).push(n,o.length-1))}function s(i,t,e){for(let n in i)if(i.hasOwnProperty(n)){const o=i[n];(e=null===e?{}:e).hasOwnProperty(n)?e[n].push(t,o):e[n]=[t,o]}return e}function r(i,t){const n=t.directiveEnd,o=i.data,c=t.attrs,f=[];let y=null,w=null;for(let L=t.directiveStart;L<n;L++){const le=o[L],ye=le.inputs,Be=null===c||P_(t)?null:It(ye,c);f.push(Be),y=s(ye,L,y),w=s(le.outputs,L,w)}null!==y&&(y.hasOwnProperty("class")&&(t.flags|=16),y.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=f,t.inputs=y,t.outputs=w}function h(i,t,e,n,o,c,f,y){const w=ko(t,e);let le,L=t.inputs;!y&&null!=L&&(le=L[n])?(Qn(i,e,le,n,o),Rh(t)&&p(e,t.index)):3&t.type&&(n=function a(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(n),o=null!=f?f(o,t.value||"",n):o,c.setProperty(w,n,o))}function p(i,t){const e=vo(t,i);16&e[2]||(e[2]|=32)}function E(i,t,e,n){let o=!1;if(ip()){const c=function Ee(i,t,e){const n=i.directiveRegistry;let o=null;if(n)for(let c=0;c<n.length;c++){const f=n[c];R_(e,f.selectors,!1)&&(o||(o=[]),jn(Ui(e,t),i,f.type),pa(f)?(Oe(i,e),o.unshift(f)):o.push(f))}return o}(i,t,e),f=null===n?null:{"":-1};if(null!==c){o=!0,ht(e,i.data.length,c.length);for(let le=0;le<c.length;le++){const ye=c[le];ye.providersResolver&&ye.providersResolver(ye)}let y=!1,w=!1,L=Ss(i,t,c.length,null);for(let le=0;le<c.length;le++){const ye=c[le];e.mergedAttrs=Ct(e.mergedAttrs,ye.hostAttrs),et(i,e,t,L,ye),tt(L,ye,f),null!==ye.contentQueries&&(e.flags|=8),(null!==ye.hostBindings||null!==ye.hostAttrs||0!==ye.hostVars)&&(e.flags|=128);const Be=ye.type.prototype;!y&&(Be.ngOnChanges||Be.ngOnInit||Be.ngDoCheck)&&((i.preOrderHooks||(i.preOrderHooks=[])).push(e.index),y=!0),!w&&(Be.ngOnChanges||Be.ngDoCheck)&&((i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(e.index),w=!0),L++}r(i,e)}f&&function Ve(i,t,e){if(t){const n=i.localNames=[];for(let o=0;o<t.length;o+=2){const c=e[t[o+1]];if(null==c)throw new ti(-301,!1);n.push(t[o],c)}}}(e,n,f)}return e.mergedAttrs=Ct(e.mergedAttrs,e.attrs),o}function k(i,t,e,n,o,c){const f=c.hostBindings;if(f){let y=i.hostBindingOpCodes;null===y&&(y=i.hostBindingOpCodes=[]);const w=~t.index;(function X(i){let t=i.length;for(;t>0;){const e=i[--t];if("number"==typeof e&&e<0)return e}return 0})(y)!=w&&y.push(w),y.push(n,o,f)}}function _e(i,t){null!==i.hostBindings&&i.hostBindings(1,t)}function Oe(i,t){t.flags|=2,(i.components||(i.components=[])).push(t.index)}function tt(i,t,e){if(e){if(t.exportAs)for(let n=0;n<t.exportAs.length;n++)e[t.exportAs[n]]=i;pa(t)&&(e[""]=i)}}function ht(i,t,e){i.flags|=1,i.directiveStart=t,i.directiveEnd=t+e,i.providerIndexes=t}function et(i,t,e,n,o){i.data[n]=o;const c=o.factory||(o.factory=tl(o.type)),f=new $e(c,pa(o),ft);i.blueprint[n]=f,e[n]=f,k(i,t,0,n,Ss(i,e,o.hostVars,sn),o)}function st(i,t,e){const n=ko(t,i),o=U0(e),c=i[10],f=di(i,Ca(i,o,null,e.onPush?32:16,n,t,c,c.createRenderer(n,e),null,null,null));i[t.index]=f}function dt(i,t,e,n,o,c){const f=ko(i,t);!function ut(i,t,e,n,o,c,f){if(null==c)i.removeAttribute(t,o,e);else{const y=null==f?Gi(c):f(c,n||"",o);i.setAttribute(t,o,y,e)}}(t[11],f,c,i.value,e,n,o)}function Ot(i,t,e,n,o,c){const f=c[t];if(null!==f){const y=n.setInput;for(let w=0;w<f.length;){const L=f[w++],le=f[w++],ye=f[w++];null!==y?n.setInput(e,ye,L,le):e[le]=ye}}}function It(i,t){let e=null,n=0;for(;n<t.length;){const o=t[n];if(0!==o)if(5!==o){if("number"==typeof o)break;i.hasOwnProperty(o)&&(null===e&&(e=[]),e.push(o,i[o],t[n+1])),n+=2}else n+=2;else n+=4}return e}function ii(i,t,e,n){return new Array(i,!0,!1,t,null,0,n,e,null,null)}function Qt(i,t){const e=vo(t,i);if(pc(e)){const n=e[1];48&e[2]?Cd(n,e,n.template,e[8]):e[5]>0&&Jt(e)}}function Jt(i){for(let n=b_(i);null!==n;n=ud(n))for(let o=10;o<n.length;o++){const c=n[o];if(pc(c))if(512&c[2]){const f=c[1];Cd(f,c,f.template,c[8])}else c[5]>0&&Jt(c)}const e=i[1].components;if(null!==e)for(let n=0;n<e.length;n++){const o=vo(e[n],i);pc(o)&&o[5]>0&&Jt(o)}}function oi(i,t){const e=vo(t,i),n=e[1];(function Vt(i,t){for(let e=t.length;e<i.blueprint.length;e++)t.push(i.blueprint[e])})(n,e),ql(n,e,e[8])}function di(i,t){return i[13]?i[14][4]=t:i[13]=t,i[14]=t,t}function ji(i){for(;i;){i[2]|=32;const t=Dp(i);if(Og(i)&&!t)return i;i=t}return null}function _n(i,t,e){Gc(0),t(i,e)}function Wi(i){return i[7]||(i[7]=[])}function Kn(i){return i.cleanup||(i.cleanup=[])}function rn(i,t,e){return(null===i||pa(i))&&(e=function uc(i){for(;Array.isArray(i);){if("object"==typeof i[1])return i;i=i[0]}return null}(e[t.index])),e[11]}function Cn(i,t){const e=i[9],n=e?e.get($r,null):null;n&&n.handleError(t)}function Qn(i,t,e,n,o){for(let c=0;c<e.length;){const f=e[c++],y=e[c++],w=t[f],L=i.data[f];null!==L.setInput?L.setInput(w,o,n,y):w[y]=o}}function Bn(i,t,e){const n=Ol(t,i);!function g0(i,t,e){i.setValue(t,e)}(i[11],n,e)}function rr(i,t,e){let n=e?i.styles:null,o=e?i.classes:null,c=0;if(null!==t)for(let f=0;f<t.length;f++){const y=t[f];"number"==typeof y?c=y:1==c?o=Sn(o,y):2==c&&(n=Sn(n,y+": "+t[++f]+";"))}e?i.styles=n:i.stylesWithoutHost=n,e?i.classes=o:i.classesWithoutHost=o}function ur(i,t,e,n,o=!1){for(;null!==e;){const c=t[e.index];if(null!==c&&n.push(Or(c)),Ao(c))for(let y=10;y<c.length;y++){const w=c[y],L=w[1].firstChild;null!==L&&ur(w[1],w,L,n)}const f=e.type;if(8&f)ur(i,t,e.child,n);else if(32&f){const y=x_(e,t);let w;for(;w=y();)n.push(w)}else if(16&f){const y=wm(t,e);if(Array.isArray(y))n.push(...y);else{const w=Dp(t[16]);ur(w[1],w,y,n,!0)}}e=o?e.projectionNext:e.next}return n}class dr{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return ur(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(Ao(t)){const e=t[8],n=e?e.indexOf(this):-1;n>-1&&(vm(t,n),Zu(e,n))}this._attachedToViewContainer=!1}M_(this._lView[1],this._lView)}onDestroy(t){ny(this._lView[1],this._lView,null,t)}markForCheck(){ji(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){!function Si(i,t,e){const n=t[10];n.begin&&n.begin();try{Cd(i,t,i.template,e)}catch(o){throw Cn(t,o),o}finally{n.end&&n.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ti(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function kp(i,t){gd(i,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new ti(902,!1);this._appRef=t}}class Br extends dr{constructor(t){super(t),this._view=t}detectChanges(){!function yi(i){!function bi(i){for(let t=0;t<i.components.length;t++){const e=i.components[t],n=_m(e);if(null!==n){const o=n[1];j0(o,n,o.template,e)}}}(i[8])}(this._view)}checkNoChanges(){}get context(){return null}}class fo extends Xh{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=ar(t);return new In(e,this.ngModule)}}function Jn(i){const t=[];for(let e in i)i.hasOwnProperty(e)&&t.push({propName:i[e],templateName:e});return t}class Zr{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,n){const o=this.injector.get(t,ld,n);return o!==ld||e===ld?o:this.parentInjector.get(t,e,n)}}class In extends n0{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function k0(i){return i.map(A0).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return Jn(this.componentDef.inputs)}get outputs(){return Jn(this.componentDef.outputs)}create(t,e,n,o){let c=(o=o||this.ngModule)instanceof Ul?o:o?.injector;c&&null!==this.componentDef.getStandaloneInjector&&(c=this.componentDef.getStandaloneInjector(c)||c);const f=c?new Zr(t,c):t,y=f.get(ad,null);if(null===y)throw new ti(407,!1);const w=f.get(zw,null),L=y.createRenderer(null,this.componentDef),le=this.componentDef.selectors[0][0]||"div",ye=n?function iy(i,t,e){return i.selectRootElement(t,e===Os.ShadowDom)}(L,n,this.componentDef.encapsulation):Ap(y.createRenderer(null,this.componentDef),le,function oo(i){const t=i.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(le)),Be=this.componentDef.onPush?288:272,Xe={components:[]},ot=jm(0,null,null,1,0,null,null,null,null,null),yt=Ca(null,ot,Xe,Be,null,null,y,L,w,f,null);let jt,Gt;Xu(yt);try{const fi=function us(i,t,e,n,o,c){const f=e[1];e[22]=i;const w=ch(f,22,2,"#host",null),L=w.mergedAttrs=t.hostAttrs;null!==L&&(rr(w,L,!0),null!==i&&(xt(o,i,L),null!==w.classes&&I_(o,i,w.classes),null!==w.styles&&M0(o,i,w.styles)));const le=n.createRenderer(i,t),ye=Ca(e,U0(t),null,t.onPush?32:16,e[22],w,n,le,c||null,null,null);return f.firstCreatePass&&(jn(Ui(w,e),f,t.type),Oe(f,w),ht(w,e.length,1)),di(e,ye),e[22]=ye}(ye,this.componentDef,yt,y,L);if(ye)if(n)xt(L,ye,["ng-version",c_.full]);else{const{attrs:qt,classes:Mi}=function Fp(i){const t=[],e=[];let n=1,o=2;for(;n<i.length;){let c=i[n];if("string"==typeof c)2===o?""!==c&&t.push(c,i[++n]):8===o&&e.push(c);else{if(!hl(o))break;o=c}n++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);qt&&xt(L,ye,qt),Mi&&Mi.length>0&&I_(L,ye,Mi.join(" "))}if(Gt=ep(ot,22),void 0!==e){const qt=Gt.projection=[];for(let Mi=0;Mi<this.ngContentSelectors.length;Mi++){const Xi=e[Mi];qt.push(null!=Xi?Array.from(Xi):null)}}jt=function Fo(i,t,e,n,o){const c=e[1],f=function b(i,t,e){const n=uo();i.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),et(i,n,t,Ss(i,t,1,null),e),r(i,n));const o=ir(t,i,n.directiveStart,n);Ms(o,t);const c=ko(n,t);return c&&Ms(c,t),o}(c,e,t);if(n.components.push(f),i[8]=f,null!==o)for(const w of o)w(f,t);if(t.contentQueries){const w=uo();t.contentQueries(1,f,w.directiveStart)}const y=uo();return!c.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(ia(y.index),k(e[1],y,0,y.directiveStart,y.directiveEnd,t),_e(t,f)),f}(fi,this.componentDef,yt,Xe,[Ts]),ql(ot,yt,null)}finally{Vh()}return new pr(this.componentType,jt,ll(Gt,yt),yt,Gt)}}class pr extends class Lw{}{constructor(t,e,n,o,c){super(),this.location=n,this._rootLView=o,this._tNode=c,this.instance=e,this.hostView=this.changeDetectorRef=new Br(o),this.componentType=t}setInput(t,e){const n=this._tNode.inputs;let o;if(null!==n&&(o=n[t])){const c=this._rootLView;Qn(c[1],c,o,t,e),p(c,this._tNode.index)}}get injector(){return new Yr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function Ts(){const i=uo();G(ai()[1],i)}function en(i){let t=function wo(i){return Object.getPrototypeOf(i.prototype).constructor}(i.type),e=!0;const n=[i];for(;t;){let o;if(pa(i))o=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new ti(903,!1);o=t.\u0275dir}if(o){if(e){n.push(o);const f=i;f.inputs=su(i.inputs),f.declaredInputs=su(i.declaredInputs),f.outputs=su(i.outputs);const y=o.hostBindings;y&&W0(i,y);const w=o.viewQuery,L=o.contentQueries;if(w&&Yp(i,w),L&&$0(i,L),Mo(i.inputs,o.inputs),Mo(i.declaredInputs,o.declaredInputs),Mo(i.outputs,o.outputs),pa(o)&&o.data.animation){const le=i.data;le.animation=(le.animation||[]).concat(o.data.animation)}}const c=o.features;if(c)for(let f=0;f<c.length;f++){const y=c[f];y&&y.ngInherit&&y(i),y===en&&(e=!1)}}t=Object.getPrototypeOf(t)}!function Md(i){let t=0,e=null;for(let n=i.length-1;n>=0;n--){const o=i[n];o.hostVars=t+=o.hostVars,o.hostAttrs=Ct(o.hostAttrs,e=Ct(e,o.hostAttrs))}}(n)}function su(i){return i===Ks?{}:i===Vi?[]:i}function Yp(i,t){const e=i.viewQuery;i.viewQuery=e?(n,o)=>{t(n,o),e(n,o)}:t}function $0(i,t){const e=i.contentQueries;i.contentQueries=e?(n,o,c)=>{t(n,o,c),e(n,o,c)}:t}function W0(i,t){const e=i.hostBindings;i.hostBindings=e?(n,o)=>{t(n,o),e(n,o)}:t}let Ea=null;function hh(){if(!Ea){const i=wr.Symbol;if(i&&i.iterator)Ea=i.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Ea=n)}}}return Ea}function au(i){return!!Zp(i)&&(Array.isArray(i)||!(i instanceof Map)&&hh()in i)}function Zp(i){return null!==i&&("function"==typeof i||"object"==typeof i)}function Qr(i,t,e){return i[t]=e}function Co(i,t,e){return!Object.is(i[t],e)&&(i[t]=e,!0)}function Sc(i,t,e,n){const o=Co(i,t,e);return Co(i,t+1,n)||o}function Ir(i,t,e,n){const o=ai();return Co(o,za(),t)&&(Vn(),dt(m(),o,i,t,e,n)),Ir}function Hm(i,t,e,n){return Co(i,za(),e)?t+Gi(e)+n:sn}function Gm(i,t,e,n,o,c){const y=Sc(i,function Ba(){return hn.lFrame.bindingIndex}(),e,o);return ga(2),y?t+Gi(e)+n+Gi(o)+c:sn}function Pr(i,t,e,n,o,c,f,y){const w=ai(),L=Vn(),le=i+22,ye=L.firstCreatePass?function QO(i,t,e,n,o,c,f,y,w){const L=t.consts,le=ch(t,i,4,f||null,fa(L,y));E(t,e,le,fa(L,w)),G(t,le);const ye=le.tViews=jm(2,le,n,o,c,t.directiveRegistry,t.pipeRegistry,null,t.schemas,L);return null!==t.queries&&(t.queries.template(t,le),ye.queries=t.queries.embeddedTView(le)),le}(le,L,w,t,e,n,o,c,f):L.data[le];Fa(ye,!1);const Be=w[11].createComment("");Pp(L,w,Be,ye),Ms(Be,w),di(w,w[le]=ii(Be,w,Be,ye)),zc(ye)&&zm(L,w,ye),null!=f&&Vm(w,ye,y)}function js(i){return function dc(i,t){return i[t]}(function Na(){return hn.lFrame.contextLView}(),22+i)}function on(i,t,e){const n=ai();return Co(n,za(),t)&&h(Vn(),m(),n,i,t,n[11],e,!1),on}function A1(i,t,e,n,o){const f=o?"class":"style";Qn(i,e,t.inputs[f],f,n)}function pi(i,t,e,n){const o=ai(),c=Vn(),f=22+i,y=o[11],w=o[f]=Ap(y,t,function C(){return hn.lFrame.currentNamespace}()),L=c.firstCreatePass?function eR(i,t,e,n,o,c,f){const y=t.consts,L=ch(t,i,2,o,fa(y,c));return E(t,e,L,fa(y,f)),null!==L.attrs&&rr(L,L.attrs,!1),null!==L.mergedAttrs&&rr(L,L.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,L),L}(f,c,o,0,t,e,n):c.data[f];Fa(L,!0);const le=L.mergedAttrs;null!==le&&xt(y,w,le);const ye=L.classes;null!==ye&&I_(y,w,ye);const Be=L.styles;return null!==Be&&M0(y,w,Be),64!=(64&L.flags)&&Pp(c,o,w,L),0===function Uu(){return hn.lFrame.elementDepthCount}()&&Ms(w,o),function nl(){hn.lFrame.elementDepthCount++}(),zc(L)&&(zm(c,o,L),qp(c,L,o)),null!==n&&Vm(o,L),pi}function xi(){let i=uo();ma()?Gu():(i=i.parent,Fa(i,!1));const t=i;!function tp(){hn.lFrame.elementDepthCount--}();const e=Vn();return e.firstCreatePass&&(G(e,i),Pu(i)&&e.queries.elementEnd(i)),null!=t.classesWithoutHost&&function Ye(i){return 0!=(16&i.flags)}(t)&&A1(e,t,ai(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function rt(i){return 0!=(32&i.flags)}(t)&&A1(e,t,ai(),t.stylesWithoutHost,!1),xi}function zn(i,t,e,n){return pi(i,t,e,n),xi(),zn}function ay(i,t,e){const n=ai(),o=Vn(),c=i+22,f=o.firstCreatePass?function tR(i,t,e,n,o){const c=t.consts,f=fa(c,n),y=ch(t,i,8,"ng-container",f);return null!==f&&rr(y,f,!0),E(t,e,y,fa(c,o)),null!==t.queries&&t.queries.elementStart(t,y),y}(c,o,n,t,e):o.data[c];Fa(f,!0);const y=n[c]=n[11].createComment("");return Pp(o,n,y,f),Ms(y,n),zc(f)&&(zm(o,n,f),qp(o,f,n)),null!=e&&Vm(n,f),ay}function ly(){let i=uo();const t=Vn();return ma()?Gu():(i=i.parent,Fa(i,!1)),t.firstCreatePass&&(G(t,i),Pu(i)&&t.queries.elementEnd(i)),ly}function Qp(){return ai()}function cy(i){return!!i&&"function"==typeof i.then}const k1=function xS(i){return!!i&&"function"==typeof i.subscribe};function Rn(i,t,e,n){const o=ai(),c=Vn(),f=uo();return bS(c,o,o[11],f,i,t,0,n),Rn}function q0(i,t){const e=uo(),n=ai(),o=Vn();return bS(o,n,rn(Rl(o.data),e,n),e,i,t),q0}function bS(i,t,e,n,o,c,f,y){const w=zc(n),le=i.firstCreatePass&&Kn(i),ye=t[8],Be=Wi(t);let Xe=!0;if(3&n.type||y){const jt=ko(n,t),Gt=y?y(jt):jt,fi=Be.length,qt=y?Xi=>y(Or(Xi[n.index])):n.index;let Mi=null;if(!y&&w&&(Mi=function iR(i,t,e,n){const o=i.cleanup;if(null!=o)for(let c=0;c<o.length-1;c+=2){const f=o[c];if(f===e&&o[c+1]===n){const y=t[7],w=o[c+2];return y.length>w?y[w]:null}"string"==typeof f&&(c+=2)}return null}(i,t,o,n.index)),null!==Mi)(Mi.__ngLastListenerFn__||Mi).__ngNextListenerFn__=c,Mi.__ngLastListenerFn__=c,Xe=!1;else{c=CS(n,t,ye,c,!1);const Xi=e.listen(Gt,o,c);Be.push(c,Xi),le&&le.push(o,qt,fi,fi+1)}}else c=CS(n,t,ye,c,!1);const ot=n.outputs;let yt;if(Xe&&null!==ot&&(yt=ot[o])){const jt=yt.length;if(jt)for(let Gt=0;Gt<jt;Gt+=2){const $n=t[yt[Gt]][yt[Gt+1]].subscribe(c),zr=Be.length;Be.push(c,$n),le&&le.push(o,n.index,zr,-(zr+1))}}}function wS(i,t,e,n){try{return!1!==e(n)}catch(o){return Cn(i,o),!1}}function CS(i,t,e,n,o){return function c(f){if(f===Function)return n;ji(2&i.flags?vo(i.index,t):t);let w=wS(t,0,n,f),L=c.__ngNextListenerFn__;for(;L;)w=wS(t,0,L,f)&&w,L=L.__ngNextListenerFn__;return o&&!1===w&&(f.preventDefault(),f.returnValue=!1),w}}function Jr(i=1){return function Bf(i){return(hn.lFrame.contextLView=function zf(i,t){for(;i>0;)t=t[15],i--;return t}(i,hn.lFrame.contextLView))[8]}(i)}function nR(i,t){let e=null;const n=function T0(i){const t=i.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(i);for(let o=0;o<t.length;o++){const c=t[o];if("*"!==c){if(null===n?R_(i,c,!0):d1(n,c))return o}else e=o}return e}function dh(i){const t=ai()[16][6];if(!t.projection){const n=t.projection=Wc(i?i.length:1,null),o=n.slice();let c=t.child;for(;null!==c;){const f=i?nR(c,i):0;null!==f&&(o[f]?o[f].projectionNext=c:n[f]=c,o[f]=c),c=c.next}}}function ds(i,t=0,e){const n=ai(),o=Vn(),c=ch(o,22+i,16,null,e||null);null===c.projection&&(c.projection=t),Gu(),64!=(64&c.flags)&&function Cm(i,t,e){Rp(t[11],0,t,e,xm(i,e,t),C0(e.parent||t[6],e,t))}(o,n,c)}function P1(i,t,e,n,o,c,f){const y=ai(),w=Gm(y,t,e,n,o,c);return w!==sn&&h(Vn(),m(),y,i,w,y[11],f,!1),P1}function PS(i,t,e,n,o){const c=i[e+1],f=null===t;let y=n?ul(c):Cc(c),w=!1;for(;0!==y&&(!1===w||f);){const le=i[y+1];sR(i[y],t)&&(w=!0,i[y+1]=n?bd(le):Im(le)),y=n?ul(le):Cc(le)}w&&(i[e+1]=n?Im(c):bd(c))}function sR(i,t){return null===i||null==t||(Array.isArray(i)?i[1]:i)===t||!(!Array.isArray(i)||"string"!=typeof t)&&Nl(i,t)>=0}const ps={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function OS(i){return i.substring(ps.key,ps.keyEnd)}function aR(i){return i.substring(ps.value,ps.valueEnd)}function RS(i,t){const e=ps.textEnd;return e===t?-1:(t=ps.keyEnd=function hR(i,t,e){for(;t<e&&i.charCodeAt(t)>32;)t++;return t}(i,ps.key=t,e),Km(i,t,e))}function LS(i,t){const e=ps.textEnd;let n=ps.key=Km(i,t,e);return e===n?-1:(n=ps.keyEnd=function uR(i,t,e){let n;for(;t<e&&(45===(n=i.charCodeAt(t))||95===n||(-33&n)>=65&&(-33&n)<=90||n>=48&&n<=57);)t++;return t}(i,n,e),n=NS(i,n,e),n=ps.value=Km(i,n,e),n=ps.valueEnd=function dR(i,t,e){let n=-1,o=-1,c=-1,f=t,y=f;for(;f<e;){const w=i.charCodeAt(f++);if(59===w)return y;34===w||39===w?y=f=BS(i,w,f,e):t===f-4&&85===c&&82===o&&76===n&&40===w?y=f=BS(i,41,f,e):w>32&&(y=f),c=o,o=n,n=-33&w}return y}(i,n,e),NS(i,n,e))}function FS(i){ps.key=0,ps.keyEnd=0,ps.value=0,ps.valueEnd=0,ps.textEnd=i.length}function Km(i,t,e){for(;t<e&&i.charCodeAt(t)<=32;)t++;return t}function NS(i,t,e,n){return(t=Km(i,t,e))<e&&t++,t}function BS(i,t,e,n){let o=-1,c=e;for(;c<n;){const f=i.charCodeAt(c++);if(f==t&&92!==o)return c;o=92==f&&92===o?0:f}throw new Error}function O1(i,t,e){return Tc(i,t,e,!1),O1}function fs(i,t){return Tc(i,t,null,!0),fs}function fl(i){Dc(jS,pR,i,!1)}function pR(i,t){for(let e=function cR(i){return FS(i),LS(i,Km(i,0,ps.textEnd))}(t);e>=0;e=LS(t,e))jS(i,OS(t),aR(t))}function ph(i,t){for(let e=function lR(i){return FS(i),RS(i,Km(i,0,ps.textEnd))}(t);e>=0;e=RS(t,e))ya(i,OS(t),!0)}function Tc(i,t,e,n){const o=ai(),c=Vn(),f=ga(2);c.firstUpdatePass&&VS(c,i,f,n),t!==sn&&Co(o,f,t)&&US(c,c.data[Po()],o,o[11],i,o[f+1]=function bR(i,t){return null==i||("string"==typeof t?i+=t:"object"==typeof i&&(i=ri(hs(i)))),i}(t,e),n,f)}function Dc(i,t,e,n){const o=Vn(),c=ga(2);o.firstUpdatePass&&VS(o,null,c,n);const f=ai();if(e!==sn&&Co(f,c,e)){const y=o.data[Po()];if(GS(y,n)&&!zS(o,c)){let w=n?y.classesWithoutHost:y.stylesWithoutHost;null!==w&&(e=Sn(w,e||"")),A1(o,y,f,e,n)}else!function xR(i,t,e,n,o,c,f,y){o===sn&&(o=Vi);let w=0,L=0,le=0<o.length?o[0]:null,ye=0<c.length?c[0]:null;for(;null!==le||null!==ye;){const Be=w<o.length?o[w+1]:void 0,Xe=L<c.length?c[L+1]:void 0;let yt,ot=null;le===ye?(w+=2,L+=2,Be!==Xe&&(ot=ye,yt=Xe)):null===ye||null!==le&&le<ye?(w+=2,ot=le):(L+=2,ot=ye,yt=Xe),null!==ot&&US(i,t,e,n,ot,yt,f,y),le=w<o.length?o[w]:null,ye=L<c.length?c[L]:null}}(o,y,f,f[11],f[c+1],f[c+1]=function vR(i,t,e){if(null==e||""===e)return Vi;const n=[],o=hs(e);if(Array.isArray(o))for(let c=0;c<o.length;c++)i(n,o[c],!0);else if("object"==typeof o)for(const c in o)o.hasOwnProperty(c)&&i(n,c,o[c]);else"string"==typeof o&&t(n,o);return n}(i,t,e),n,c)}}function zS(i,t){return t>=i.expandoStartIndex}function VS(i,t,e,n){const o=i.data;if(null===o[e+1]){const c=o[Po()],f=zS(i,e);GS(c,n)&&null===t&&!f&&(t=!1),t=function mR(i,t,e,n){const o=Rl(i);let c=n?t.residualClasses:t.residualStyles;if(null===o)0===(n?t.classBindings:t.styleBindings)&&(e=hy(e=R1(null,i,t,e,n),t.attrs,n),c=null);else{const f=t.directiveStylingLast;if(-1===f||i[f]!==o)if(e=R1(o,i,t,e,n),null===c){let w=function gR(i,t,e){const n=e?t.classBindings:t.styleBindings;if(0!==Cc(n))return i[ul(n)]}(i,t,n);void 0!==w&&Array.isArray(w)&&(w=R1(null,i,t,w[1],n),w=hy(w,t.attrs,n),function _R(i,t,e,n){i[ul(e?t.classBindings:t.styleBindings)]=n}(i,t,n,w))}else c=function yR(i,t,e){let n;const o=t.directiveEnd;for(let c=1+t.directiveStylingLast;c<o;c++)n=hy(n,i[c].hostAttrs,e);return hy(n,t.attrs,e)}(i,t,n)}return void 0!==c&&(n?t.residualClasses=c:t.residualStyles=c),e}(o,c,t,n),function rR(i,t,e,n,o,c){let f=c?t.classBindings:t.styleBindings,y=ul(f),w=Cc(f);i[n]=e;let le,L=!1;if(Array.isArray(e)){const ye=e;le=ye[1],(null===le||Nl(ye,le)>0)&&(L=!0)}else le=e;if(o)if(0!==w){const Be=ul(i[y+1]);i[n+1]=Hp(Be,y),0!==Be&&(i[Be+1]=$_(i[Be+1],n)),i[y+1]=function y1(i,t){return 131071&i|t<<17}(i[y+1],n)}else i[n+1]=Hp(y,0),0!==y&&(i[y+1]=$_(i[y+1],n)),y=n;else i[n+1]=Hp(w,0),0===y?y=n:i[w+1]=$_(i[w+1],n),w=n;L&&(i[n+1]=Im(i[n+1])),PS(i,le,n,!0),PS(i,le,n,!1),function oR(i,t,e,n,o){const c=o?i.residualClasses:i.residualStyles;null!=c&&"string"==typeof t&&Nl(c,t)>=0&&(e[n+1]=bd(e[n+1]))}(t,le,i,n,c),f=Hp(y,w),c?t.classBindings=f:t.styleBindings=f}(o,c,t,e,f,n)}}function R1(i,t,e,n,o){let c=null;const f=e.directiveEnd;let y=e.directiveStylingLast;for(-1===y?y=e.directiveStart:y++;y<f&&(c=t[y],n=hy(n,c.hostAttrs,o),c!==i);)y++;return null!==i&&(e.directiveStylingLast=y),n}function hy(i,t,e){const n=e?1:2;let o=-1;if(null!==t)for(let c=0;c<t.length;c++){const f=t[c];"number"==typeof f?o=f:o===n&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),ya(i,f,!!e||t[++c]))}return void 0===i?null:i}function jS(i,t,e){ya(i,t,hs(e))}function US(i,t,e,n,o,c,f,y){if(!(3&t.type))return;const w=i.data,L=w[y+1];Y0(function Gp(i){return 1==(1&i)}(L)?HS(w,t,e,o,Cc(L),f):void 0)||(Y0(c)||function G_(i){return 2==(2&i)}(L)&&(c=HS(w,null,e,o,y,f)),function c1(i,t,e,n,o){if(t)o?i.addClass(e,n):i.removeClass(e,n);else{let c=-1===n.indexOf("-")?void 0:zs.DashCase;null==o?i.removeStyle(e,n,c):("string"==typeof o&&o.endsWith("!important")&&(o=o.slice(0,-10),c|=zs.Important),i.setStyle(e,n,o,c))}}(n,f,Ol(Po(),e),o,c))}function HS(i,t,e,n,o,c){const f=null===t;let y;for(;o>0;){const w=i[o],L=Array.isArray(w),le=L?w[1]:w,ye=null===le;let Be=e[o+1];Be===sn&&(Be=ye?Vi:void 0);let Xe=ye?hp(Be,n):le===n?Be:void 0;if(L&&!Y0(Xe)&&(Xe=hp(w,n)),Y0(Xe)&&(y=Xe,f))return y;const ot=i[o+1];o=f?ul(ot):Cc(ot)}if(null!==t){let w=c?t.residualClasses:t.residualStyles;null!=w&&(y=hp(w,n))}return y}function Y0(i){return void 0!==i}function GS(i,t){return 0!=(i.flags&(t?16:32))}function vn(i,t=""){const e=ai(),n=Vn(),o=i+22,c=n.firstCreatePass?ch(n,o,1,t,null):n.data[o],f=e[o]=function w_(i,t){return i.createText(t)}(e[11],t);Pp(n,e,f,c),Fa(c,!1)}function Ac(i){return fh("",i,""),Ac}function fh(i,t,e){const n=ai(),o=Hm(n,i,t,e);return o!==sn&&Bn(n,Po(),o),fh}function Z0(i,t,e,n,o){const c=ai(),f=Gm(c,i,t,e,n,o);return f!==sn&&Bn(c,Po(),f),Z0}function Qm(i,t,e){const n=ai();return Co(n,za(),t)&&h(Vn(),m(),n,i,t,n[11],e,!0),Qm}function K0(i,t,e){const n=ai();if(Co(n,za(),t)){const c=Vn(),f=m();h(c,f,n,i,t,rn(Rl(c.data),f,n),e,!0)}return K0}const eg="en-US";let hT=eg;function N1(i,t,e,n,o){if(i=tn(i),Array.isArray(i))for(let c=0;c<i.length;c++)N1(i[c],t,e,n,o);else{const c=Vn(),f=ai();let y=Jc(i)?i:tn(i.provide),w=t0(i);const L=uo(),le=1048575&L.providerIndexes,ye=L.directiveStart,Be=L.providerIndexes>>20;if(Jc(i)||!i.multi){const Xe=new $e(w,o,ft),ot=z1(y,t,o?le:le+Be,ye);-1===ot?(jn(Ui(L,f),c,y),B1(c,i,t.length),t.push(y),L.directiveStart++,L.directiveEnd++,o&&(L.providerIndexes+=1048576),e.push(Xe),f.push(Xe)):(e[ot]=Xe,f[ot]=Xe)}else{const Xe=z1(y,t,le+Be,ye),ot=z1(y,t,le,le+Be),yt=Xe>=0&&e[Xe],jt=ot>=0&&e[ot];if(o&&!jt||!o&&!yt){jn(Ui(L,f),c,y);const Gt=function BL(i,t,e,n,o){const c=new $e(i,e,ft);return c.multi=[],c.index=t,c.componentProviders=0,LT(c,o,n&&!e),c}(o?NL:FL,e.length,o,n,w);!o&&jt&&(e[ot].providerFactory=Gt),B1(c,i,t.length,0),t.push(y),L.directiveStart++,L.directiveEnd++,o&&(L.providerIndexes+=1048576),e.push(Gt),f.push(Gt)}else B1(c,i,Xe>-1?Xe:ot,LT(e[o?ot:Xe],w,!o&&n));!o&&n&&jt&&e[ot].componentProviders++}}}function B1(i,t,e,n){const o=Jc(t),c=function im(i){return!!i.useClass}(t);if(o||c){const w=(c?tn(t.useClass):t).prototype.ngOnDestroy;if(w){const L=i.destroyHooks||(i.destroyHooks=[]);if(!o&&t.multi){const le=L.indexOf(e);-1===le?L.push(e,[n,w]):L[le+1].push(n,w)}else L.push(e,w)}}}function LT(i,t,e){return e&&i.componentProviders++,i.multi.push(t)-1}function z1(i,t,e,n){for(let o=e;o<n;o++)if(t[o]===i)return o;return-1}function FL(i,t,e,n){return V1(this.multi,[])}function NL(i,t,e,n){const o=this.multi;let c;if(this.providerFactory){const f=this.providerFactory.componentProviders,y=ir(e,e[1],this.providerFactory.index,n);c=y.slice(0,f),V1(o,c);for(let w=f;w<y.length;w++)c.push(y[w])}else c=[],V1(o,c);return c}function V1(i,t){for(let e=0;e<i.length;e++)t.push((0,i[e])());return t}function Tr(i,t=[]){return e=>{e.providersResolver=(n,o)=>function LL(i,t,e){const n=Vn();if(n.firstCreatePass){const o=pa(i);N1(e,n.data,n.blueprint,o,!0),N1(t,n.data,n.blueprint,o,!1)}}(n,o?o(i):i,t)}}class ef{}class FT{}class NT extends ef{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new fo(this);const n=xs(t);this._bootstrapComponents=Gl(n.bootstrap),this._r3Injector=B_(t,e,[{provide:ef,useValue:this},{provide:Xh,useValue:this.componentFactoryResolver}],ri(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class j1 extends FT{constructor(t){super(),this.moduleType=t}create(t){return new NT(this.moduleType,t)}}class VL extends ef{constructor(t,e,n){super(),this.componentFactoryResolver=new fo(this),this.instance=null;const o=new rm([...t,{provide:ef,useValue:this},{provide:Xh,useValue:this.componentFactoryResolver}],e||th(),n,new Set(["environment"]));this.injector=o,o.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function ix(i,t,e=null){return new VL(i,t,e).injector}let jL=(()=>{class i{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const n=Kv(0,e.type),o=n.length>0?ix([n],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,o)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return i.\u0275prov=hi({token:i,providedIn:"environment",factory:()=>new i(Pt(Ul))}),i})();function BT(i){i.getStandaloneInjector=t=>t.get(jL).getOrCreateStandaloneInjector(i)}function $T(i,t,e,n){return function WT(i,t,e,n,o,c){const f=t+e;return Co(i,f,o)?Qr(i,f+1,c?n.call(c,o):n(o)):my(i,f+1)}(ai(),Wo(),i,t,e,n)}function H1(i,t,e,n,o){return function XT(i,t,e,n,o,c,f){const y=t+e;return Sc(i,y,o,c)?Qr(i,y+2,f?n.call(f,o,c):n(o,c)):my(i,y+2)}(ai(),Wo(),i,t,e,n,o)}function my(i,t){const e=i[t];return e===sn?void 0:e}function G1(i){return t=>{setTimeout(i,void 0,t)}}const Fn=class uF extends ue{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){let o=t,c=e||(()=>null),f=n;if(t&&"object"==typeof t){const w=t;o=w.next?.bind(w),c=w.error?.bind(w),f=w.complete?.bind(w)}this.__isAsync&&(c=G1(c),o&&(o=G1(o)),f&&(f=G1(f)));const y=super.subscribe({next:o,error:c,complete:f});return t instanceof re&&t.add(y),y}};function dF(){return this._results[hh()]()}class ig{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=hh(),n=ig.prototype;n[e]||(n[e]=dF)}get changes(){return this._changes||(this._changes=new Fn)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const n=this;n.dirty=!1;const o=_a(t);(this._changesDetected=!function Ev(i,t,e){if(i.length!==t.length)return!1;for(let n=0;n<i.length;n++){let o=i[n],c=t[n];if(e&&(o=e(o),c=e(c)),c!==o)return!1}return!0}(n._results,o,e))&&(n._results=o,n.length=o.length,n.last=o[this.length-1],n.first=o[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let ml=(()=>{class i{}return i.__NG_ELEMENT_ID__=mF,i})();const pF=ml,fF=class extends pF{constructor(t,e,n){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=n}createEmbeddedView(t,e){const n=this._declarationTContainer.tViews,o=Ca(this._declarationLView,n,t,16,null,n.declTNode,null,null,null,null,e||null);o[17]=this._declarationLView[this._declarationTContainer.index];const f=this._declarationLView[19];return null!==f&&(o[19]=f.createEmbeddedView(n)),ql(n,o,t),new dr(o)}};function mF(){return nx(uo(),ai())}function nx(i,t){return 4&i.type?new fF(t,i,ll(i,t)):null}let Sa=(()=>{class i{}return i.__NG_ELEMENT_ID__=gF,i})();function gF(){return JT(uo(),ai())}const _F=Sa,KT=class extends _F{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=n}get element(){return ll(this._hostTNode,this._hostLView)}get injector(){return new Yr(this._hostTNode,this._hostLView)}get parentInjector(){const t=Ci(this._hostTNode,this._hostLView);if(At(t)){const e=ei(t,this._hostLView),n=Ht(t);return new Yr(e[1].data[n+8],e)}return new Yr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=QT(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,n){let o,c;"number"==typeof n?o=n:null!=n&&(o=n.index,c=n.injector);const f=t.createEmbeddedView(e||{},c);return this.insert(f,o),f}createComponent(t,e,n,o,c){const f=t&&!function Yu(i){return"function"==typeof i}(t);let y;if(f)y=e;else{const ye=e||{};y=ye.index,n=ye.injector,o=ye.projectableNodes,c=ye.environmentInjector||ye.ngModuleRef}const w=f?t:new In(ar(t)),L=n||this.parentInjector;if(!c&&null==w.ngModule){const Be=(f?L:this.parentInjector).get(Ul,null);Be&&(c=Be)}const le=w.create(L,o,void 0,c);return this.insert(le.hostView,y),le}insert(t,e){const n=t._lView,o=n[1];if(function Of(i){return Ao(i[3])}(n)){const le=this.indexOf(t);if(-1!==le)this.detach(le);else{const ye=n[3],Be=new KT(ye,ye[6],ye[3]);Be.detach(Be.indexOf(t))}}const c=this._adjustIndex(e),f=this._lContainer;!function E_(i,t,e,n){const o=10+n,c=e.length;n>0&&(e[o-1][4]=t),n<c-10?(t[4]=e[o],jg(e,10+n,t)):(e.push(t),t[4]=null),t[3]=e;const f=t[17];null!==f&&e!==f&&function ym(i,t){const e=i[9];t[16]!==t[3][3][16]&&(i[2]=!0),null===e?i[9]=[t]:e.push(t)}(f,t);const y=t[19];null!==y&&y.insertView(i),t[2]|=64}(o,n,f,c);const y=nh(c,f),w=n[11],L=Ip(w,f[7]);return null!==L&&function wa(i,t,e,n,o,c){n[0]=o,n[6]=t,gd(i,n,e,1,o,c)}(o,f[6],w,n,L,y),t.attachToViewContainerRef(),jg($1(f),c,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=QT(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),n=vm(this._lContainer,e);n&&(Zu($1(this._lContainer),e),M_(n[1],n))}detach(t){const e=this._adjustIndex(t,-1),n=vm(this._lContainer,e);return n&&null!=Zu($1(this._lContainer),e)?new dr(n):null}_adjustIndex(t,e=0){return t??this.length+e}};function QT(i){return i[8]}function $1(i){return i[8]||(i[8]=[])}function JT(i,t){let e;const n=t[i.index];if(Ao(n))e=n;else{let o;if(8&i.type)o=Or(n);else{const c=t[11];o=c.createComment("");const f=ko(i,t);Kh(c,Ip(c,f),o,function w0(i,t){return i.nextSibling(t)}(c,f),!1)}t[i.index]=e=ii(n,t,o,i),di(t,e)}return new KT(e,i,t)}class W1{constructor(t){this.queryList=t,this.matches=null}clone(){return new W1(this.queryList)}setDirty(){this.queryList.setDirty()}}class X1{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const n=null!==t.contentQueries?t.contentQueries[0]:e.length,o=[];for(let c=0;c<n;c++){const f=e.getByIndex(c);o.push(this.queries[f.indexInDeclarationView].clone())}return new X1(o)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==rD(t,e).matches&&this.queries[e].setDirty()}}class eD{constructor(t,e,n=null){this.predicate=t,this.flags=e,this.read=n}}class q1{constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){const o=null!==e?e.length:0,c=this.getByIndex(n).embeddedTView(t,o);c&&(c.indexInDeclarationView=n,null!==e?e.push(c):e=[c])}return null!==e?new q1(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Y1{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new Y1(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&8&n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const n=this.metadata.predicate;if(Array.isArray(n))for(let o=0;o<n.length;o++){const c=n[o];this.matchTNodeWithReadOption(t,e,xF(e,c)),this.matchTNodeWithReadOption(t,e,Ns(e,t,c,!1,!1))}else n===ml?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Ns(e,t,n,!1,!1))}matchTNodeWithReadOption(t,e,n){if(null!==n){const o=this.metadata.read;if(null!==o)if(o===Zn||o===Sa||o===ml&&4&e.type)this.addMatch(e.index,-2);else{const c=Ns(e,t,o,!1,!1);null!==c&&this.addMatch(e.index,c)}else this.addMatch(e.index,n)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function xF(i,t){const e=i.localNames;if(null!==e)for(let n=0;n<e.length;n+=2)if(e[n]===t)return e[n+1];return null}function wF(i,t,e,n){return-1===e?function bF(i,t){return 11&i.type?ll(i,t):4&i.type?nx(i,t):null}(t,i):-2===e?function CF(i,t,e){return e===Zn?ll(t,i):e===ml?nx(t,i):e===Sa?JT(t,i):void 0}(i,t,n):ir(i,i[1],e,t)}function tD(i,t,e,n){const o=t[19].queries[n];if(null===o.matches){const c=i.data,f=e.matches,y=[];for(let w=0;w<f.length;w+=2){const L=f[w];y.push(L<0?null:wF(t,c[L],f[w+1],e.metadata.read))}o.matches=y}return o.matches}function Z1(i,t,e,n){const o=i.queries.getByIndex(e),c=o.matches;if(null!==c){const f=tD(i,t,o,e);for(let y=0;y<c.length;y+=2){const w=c[y];if(w>0)n.push(f[y/2]);else{const L=c[y+1],le=t[-w];for(let ye=10;ye<le.length;ye++){const Be=le[ye];Be[17]===Be[3]&&Z1(Be[1],Be,L,n)}if(null!==le[9]){const ye=le[9];for(let Be=0;Be<ye.length;Be++){const Xe=ye[Be];Z1(Xe[1],Xe,L,n)}}}}}return n}function Dr(i){const t=ai(),e=Vn(),n=Hc();Gc(n+1);const o=rD(e,n);if(i.dirty&&zu(t)===(2==(2&o.metadata.flags))){if(null===o.matches)i.reset([]);else{const c=o.crossesNgTemplate?Z1(e,t,n,[]):tD(e,t,o,n);i.reset(c,Nw),i.notifyOnChanges()}return!0}return!1}function $a(i,t,e){const n=Vn();n.firstCreatePass&&(nD(n,new eD(i,t,e),-1),2==(2&t)&&(n.staticViewQueries=!0)),iD(n,ai(),t)}function Ds(i,t,e,n){const o=Vn();if(o.firstCreatePass){const c=uo();nD(o,new eD(t,e,n),c.index),function MF(i,t){const e=i.contentQueries||(i.contentQueries=[]);t!==(e.length?e[e.length-1]:-1)&&e.push(i.queries.length-1,t)}(o,i),2==(2&e)&&(o.staticContentQueries=!0)}iD(o,ai(),e)}function Ar(){return function EF(i,t){return i[19].queries[t].queryList}(ai(),Hc())}function iD(i,t,e){const n=new ig(4==(4&e));ny(i,t,n,n.destroy),null===t[19]&&(t[19]=new X1),t[19].queries.push(new W1(n))}function nD(i,t,e){null===i.queries&&(i.queries=new q1),i.queries.track(new Y1(t,e))}function rD(i,t){return i.queries.getByIndex(t)}function ox(...i){}const sx=new ui("Application Initializer");let ax=(()=>{class i{constructor(e){this.appInits=e,this.resolve=ox,this.reject=ox,this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,o)=>{this.resolve=n,this.reject=o})}runInitializers(){if(this.initialized)return;const e=[],n=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let o=0;o<this.appInits.length;o++){const c=this.appInits[o]();if(cy(c))e.push(c);else if(k1(c)){const f=new Promise((y,w)=>{c.subscribe({complete:y,error:w})});e.push(f)}}Promise.all(e).then(()=>{n()}).catch(o=>{this.reject(o)}),0===e.length&&n(),this.initialized=!0}}return i.\u0275fac=function(e){return new(e||i)(Pt(sx,8))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const yy=new ui("AppId",{providedIn:"root",factory:function CD(){return`${tC()}${tC()}${tC()}`}});function tC(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const ED=new ui("Platform Initializer"),lx=new ui("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),MD=new ui("appBootstrapListener"),mh=new ui("AnimationModuleType");let WF=(()=>{class i{log(e){console.log(e)}warn(e){console.warn(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();const gh=new ui("LocaleId",{providedIn:"root",factory:()=>nr(gh,nn.Optional|nn.SkipSelf)||function XF(){return typeof $localize<"u"&&$localize.locale||eg}()});class YF{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let iC=(()=>{class i{compileModuleSync(e){return new j1(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const n=this.compileModuleSync(e),c=Gl(xs(e).declarations).reduce((f,y)=>{const w=ar(y);return w&&f.push(new In(w)),f},[]);return new YF(n,c)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const QF=(()=>Promise.resolve(0))();function nC(i){typeof Zone>"u"?QF.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}class En{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Fn(!1),this.onMicrotaskEmpty=new Fn(!1),this.onStable=new Fn(!1),this.onError=new Fn(!1),typeof Zone>"u")throw new ti(908,!1);Zone.assertZonePatched();const o=this;if(o._nesting=0,o._outer=o._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const c=Zone.AsyncStackTaggingZoneSpec;o._inner=o._inner.fork(new c("Angular"))}Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!n&&e,o.shouldCoalesceRunChangeDetection=n,o.lastRequestAnimationFrameId=-1,o.nativeRequestAnimationFrame=function JF(){let i=wr.requestAnimationFrame,t=wr.cancelAnimationFrame;if(typeof Zone<"u"&&i&&t){const e=i[Zone.__symbol__("OriginalDelegate")];e&&(i=e);const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function iN(i){const t=()=>{!function tN(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(wr,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,oC(i),i.isCheckStableRunning=!0,rC(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),oC(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,n,o,c,f,y)=>{try{return DD(i),e.invokeTask(o,c,f,y)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===c.type||i.shouldCoalesceRunChangeDetection)&&t(),AD(i)}},onInvoke:(e,n,o,c,f,y,w)=>{try{return DD(i),e.invoke(o,c,f,y,w)}finally{i.shouldCoalesceRunChangeDetection&&t(),AD(i)}},onHasTask:(e,n,o,c)=>{e.hasTask(o,c),n===o&&("microTask"==c.change?(i._hasPendingMicrotasks=c.microTask,oC(i),rC(i)):"macroTask"==c.change&&(i.hasPendingMacrotasks=c.macroTask))},onHandleError:(e,n,o,c)=>(e.handleError(o,c),i.runOutsideAngular(()=>i.onError.emit(c)),!1)})}(o)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!En.isInAngularZone())throw new ti(909,!1)}static assertNotInAngularZone(){if(En.isInAngularZone())throw new ti(909,!1)}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,o){const c=this._inner,f=c.scheduleEventTask("NgZoneEvent: "+o,t,eN,ox,ox);try{return c.runTask(f,e,n)}finally{c.cancelTask(f)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}const eN={};function rC(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function oC(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function DD(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function AD(i){i._nesting--,rC(i)}class nN{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Fn,this.onMicrotaskEmpty=new Fn,this.onStable=new Fn,this.onError=new Fn}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,o){return t.apply(e,n)}}const kD=new ui(""),cx=new ui("");let lC,sC=(()=>{class i{constructor(e,n,o){this._ngZone=e,this.registry=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,lC||(function rN(i){lC=i}(o),o.addToWindow(n)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{En.assertNotInAngularZone(),nC(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())nC(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>!n.updateCb||!n.updateCb(e)||(clearTimeout(n.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,n,o){let c=-1;n&&n>0&&(c=setTimeout(()=>{this._callbacks=this._callbacks.filter(f=>f.timeoutId!==c),e(this._didWork,this.getPendingTasks())},n)),this._callbacks.push({doneCb:e,timeoutId:c,updateCb:o})}whenStable(e,n,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,n,o),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,n,o){return[]}}return i.\u0275fac=function(e){return new(e||i)(Pt(En),Pt(aC),Pt(cx))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})(),aC=(()=>{class i{constructor(){this._applications=new Map}registerApplication(e,n){this._applications.set(e,n)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,n=!0){return lC?.findTestabilityInTree(this,e,n)??null}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})(),Td=null;const ID=new ui("AllowMultipleToken"),cC=new ui("PlatformDestroyListeners");class PD{constructor(t,e){this.name=t,this.token=e}}function RD(i,t,e=[]){const n=`Platform: ${t}`,o=new ui(n);return(c=[])=>{let f=hC();if(!f||f.injector.get(ID,!1)){const y=[...e,...c,{provide:o,useValue:!0}];i?i(y):function aN(i){if(Td&&!Td.get(ID,!1))throw new ti(400,!1);Td=i;const t=i.get(FD);(function OD(i){const t=i.get(ED,null);t&&t.forEach(e=>e())})(i)}(function LD(i=[],t){return Wr.create({name:t,providers:[{provide:sd,useValue:"platform"},{provide:cC,useValue:new Set([()=>Td=null])},...i]})}(y,n))}return function cN(i){const t=hC();if(!t)throw new ti(401,!1);return t}()}}function hC(){return Td?.get(FD)??null}let FD=(()=>{class i{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,n){const o=function BD(i,t){let e;return e="noop"===i?new nN:("zone.js"===i?void 0:i)||new En(t),e}(n?.ngZone,function ND(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!i||!i.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!i||!i.ngZoneRunCoalescing)||!1}}(n)),c=[{provide:En,useValue:o}];return o.run(()=>{const f=Wr.create({providers:c,parent:this.injector,name:e.moduleType.name}),y=e.create(f),w=y.injector.get($r,null);if(!w)throw new ti(402,!1);return o.runOutsideAngular(()=>{const L=o.onError.subscribe({next:le=>{w.handleError(le)}});y.onDestroy(()=>{hx(this._modules,y),L.unsubscribe()})}),function zD(i,t,e){try{const n=e();return cy(n)?n.catch(o=>{throw t.runOutsideAngular(()=>i.handleError(o)),o}):n}catch(n){throw t.runOutsideAngular(()=>i.handleError(n)),n}}(w,o,()=>{const L=y.injector.get(ax);return L.runInitializers(),L.donePromise.then(()=>(function uT(i){jo(i,"Expected localeId to be defined"),"string"==typeof i&&(hT=i.toLowerCase().replace(/_/g,"-"))}(y.injector.get(gh,eg)||eg),this._moduleDoBootstrap(y),y))})})}bootstrapModule(e,n=[]){const o=VD({},n);return function oN(i,t,e){const n=new j1(e);return Promise.resolve(n)}(0,0,e).then(c=>this.bootstrapModuleFactory(c,o))}_moduleDoBootstrap(e){const n=e.injector.get(og);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(o=>n.bootstrap(o));else{if(!e.instance.ngDoBootstrap)throw new ti(403,!1);e.instance.ngDoBootstrap(n)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ti(404,!1);this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n());const e=this._injector.get(cC,null);e&&(e.forEach(n=>n()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(e){return new(e||i)(Pt(Wr))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();function VD(i,t){return Array.isArray(t)?t.reduce(VD,i):{...i,...t}}let og=(()=>{class i{constructor(e,n,o){this._zone=e,this._injector=n,this._exceptionHandler=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const c=new S(y=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{y.next(this._stable),y.complete()})}),f=new S(y=>{let w;this._zone.runOutsideAngular(()=>{w=this._zone.onStable.subscribe(()=>{En.assertNotInAngularZone(),nC(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,y.next(!0))})})});const L=this._zone.onUnstable.subscribe(()=>{En.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{y.next(!1)}))});return()=>{w.unsubscribe(),L.unsubscribe()}});this.isStable=ys(c,f.pipe(vs()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,n){const o=e instanceof n0;if(!this._injector.get(ax).done)throw!o&&function Ka(i){const t=ar(i)||Ho(i)||Do(i);return null!==t&&t.standalone}(e),new ti(405,false);let f;f=o?e:this._injector.get(Xh).resolveComponentFactory(e),this.componentTypes.push(f.componentType);const y=function sN(i){return i.isBoundToModule}(f)?void 0:this._injector.get(ef),L=f.create(Wr.NULL,[],n||f.selector,y),le=L.location.nativeElement,ye=L.injector.get(kD,null);return ye?.registerApplication(le),L.onDestroy(()=>{this.detachView(L.hostView),hx(this.components,L),ye?.unregisterApplication(le)}),this._loadComponent(L),L}tick(){if(this._runningTick)throw new ti(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const n=e;this._views.push(n),n.attachToAppRef(this)}detachView(e){const n=e;hx(this._views,n),n.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(MD,[]).concat(this._bootstrapListeners).forEach(o=>o(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>hx(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new ti(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return i.\u0275fac=function(e){return new(e||i)(Pt(En),Pt(Ul),Pt($r))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function hx(i,t){const e=i.indexOf(t);e>-1&&i.splice(e,1)}let UD=!0,Wa=(()=>{class i{}return i.__NG_ELEMENT_ID__=dN,i})();function dN(i){return function pN(i,t,e){if(Rh(i)&&!e){const n=vo(i.index,t);return new dr(n,n)}return 47&i.type?new dr(t[16],t):null}(uo(),ai(),16==(16&i))}class XD{constructor(){}supports(t){return au(t)}create(t){return new vN(t)}}const yN=(i,t)=>t;class vN{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||yN}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,o=0,c=null;for(;e||n;){const f=!n||e&&e.currentIndex<YD(n,o,c)?e:n,y=YD(f,o,c),w=f.currentIndex;if(f===n)o--,n=n._nextRemoved;else if(e=e._next,null==f.previousIndex)o++;else{c||(c=[]);const L=y-o,le=w-o;if(L!=le){for(let Be=0;Be<L;Be++){const Xe=Be<c.length?c[Be]:c[Be]=0,ot=Xe+Be;le<=ot&&ot<L&&(c[Be]=Xe+1)}c[f.previousIndex]=le-L}}y!==w&&t(f,y,w)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!au(t))throw new ti(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let o,c,f,e=this._itHead,n=!1;if(Array.isArray(t)){this.length=t.length;for(let y=0;y<this.length;y++)c=t[y],f=this._trackByFn(y,c),null!==e&&Object.is(e.trackById,f)?(n&&(e=this._verifyReinsertion(e,c,f,y)),Object.is(e.item,c)||this._addIdentityChange(e,c)):(e=this._mismatch(e,c,f,y),n=!0),e=e._next}else o=0,function uh(i,t){if(Array.isArray(i))for(let e=0;e<i.length;e++)t(i[e]);else{const e=i[hh()]();let n;for(;!(n=e.next()).done;)t(n.value)}}(t,y=>{f=this._trackByFn(o,y),null!==e&&Object.is(e.trackById,f)?(n&&(e=this._verifyReinsertion(e,y,f,o)),Object.is(e.item,y)||this._addIdentityChange(e,y)):(e=this._mismatch(e,y,f,o),n=!0),e=e._next,o++}),this.length=o;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,o){let c;return null===t?c=this._itTail:(c=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,c,o)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,o))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,c,o)):t=this._addAfter(new xN(e,n),c,o),t}_verifyReinsertion(t,e,n,o){let c=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==c?t=this._reinsertAfter(c,t._prev,o):t.currentIndex!=o&&(t.currentIndex=o,this._addToMoves(t,o)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const o=t._prevRemoved,c=t._nextRemoved;return null===o?this._removalsHead=c:o._nextRemoved=c,null===c?this._removalsTail=o:c._prevRemoved=o,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const o=null===e?this._itHead:e._next;return t._next=o,t._prev=e,null===o?this._itTail=t:o._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new qD),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new qD),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class xN{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class bN{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class qD{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new bN,this.map.set(e,n)),n.add(t)}get(t,e){const o=this.map.get(t);return o?o.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function YD(i,t,e){const n=i.previousIndex;if(null===n)return n;let o=0;return e&&n<e.length&&(o=e[n]),n+t+o}class ZD{constructor(){}supports(t){return t instanceof Map||Zp(t)}create(){return new wN}}class wN{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||Zp(t)))throw new ti(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(n,o)=>{if(e&&e.key===o)this._maybeAddToChanges(e,n),this._appendAfter=e,e=e._next;else{const c=this._getOrCreateRecordForKey(o,n);e=this._insertBeforeOrAppend(e,c)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let n=e;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const o=this._records.get(t);this._maybeAddToChanges(o,e);const c=o._prev,f=o._next;return c&&(c._next=f),f&&(f._prev=c),o._next=null,o._prev=null,o}const n=new CN(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class CN{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function KD(){return new px([new XD])}let px=(()=>{class i{constructor(e){this.factories=e}static create(e,n){if(null!=n){const o=n.factories.slice();e=e.concat(o)}return new i(e)}static extend(e){return{provide:i,useFactory:n=>i.create(e,n||KD()),deps:[[i,new Uh,new xa]]}}find(e){const n=this.factories.find(o=>o.supports(e));if(null!=n)return n;throw new ti(901,!1)}}return i.\u0275prov=hi({token:i,providedIn:"root",factory:KD}),i})();function QD(){return new vy([new ZD])}let vy=(()=>{class i{constructor(e){this.factories=e}static create(e,n){if(n){const o=n.factories.slice();e=e.concat(o)}return new i(e)}static extend(e){return{provide:i,useFactory:n=>i.create(e,n||QD()),deps:[[i,new Uh,new xa]]}}find(e){const n=this.factories.find(o=>o.supports(e));if(n)return n;throw new ti(901,!1)}}return i.\u0275prov=hi({token:i,providedIn:"root",factory:QD}),i})();const SN=RD(null,"core",[]);let TN=(()=>{class i{constructor(e){}}return i.\u0275fac=function(e){return new(e||i)(Pt(og))},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({}),i})();function cu(i){return"boolean"==typeof i?i:null!=i&&"false"!==i}let fx=null;function _h(){return fx}const Pn=new ui("DocumentToken");let mC=(()=>{class i{historyGo(e){throw new Error("Not implemented")}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=hi({token:i,factory:function(){return function IN(){return Pt(JD)}()},providedIn:"platform"}),i})();const PN=new ui("Location Initialized");let JD=(()=>{class i extends mC{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return _h().getBaseHref(this._doc)}onPopState(e){const n=_h().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",e,!1),()=>n.removeEventListener("popstate",e)}onHashChange(e){const n=_h().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",e,!1),()=>n.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,n,o){eA()?this._history.pushState(e,n,o):this.location.hash=o}replaceState(e,n,o){eA()?this._history.replaceState(e,n,o):this.location.hash=o}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return i.\u0275fac=function(e){return new(e||i)(Pt(Pn))},i.\u0275prov=hi({token:i,factory:function(){return function ON(){return new JD(Pt(Pn))}()},providedIn:"platform"}),i})();function eA(){return!!window.history.pushState}function gC(i,t){if(0==i.length)return t;if(0==t.length)return i;let e=0;return i.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?i+t.substring(1):1==e?i+t:i+"/"+t}function tA(i){const t=i.match(/#|\?|$/),e=t&&t.index||i.length;return i.slice(0,e-("/"===i[e-1]?1:0))+i.slice(e)}function hu(i){return i&&"?"!==i[0]?"?"+i:i}let nf=(()=>{class i{historyGo(e){throw new Error("Not implemented")}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=hi({token:i,factory:function(){return nr(nA)},providedIn:"root"}),i})();const iA=new ui("appBaseHref");let nA=(()=>{class i extends nf{constructor(e,n){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??nr(Pn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return gC(this._baseHref,e)}path(e=!1){const n=this._platformLocation.pathname+hu(this._platformLocation.search),o=this._platformLocation.hash;return o&&e?`${n}${o}`:n}pushState(e,n,o,c){const f=this.prepareExternalUrl(o+hu(c));this._platformLocation.pushState(e,n,f)}replaceState(e,n,o,c){const f=this.prepareExternalUrl(o+hu(c));this._platformLocation.replaceState(e,n,f)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return i.\u0275fac=function(e){return new(e||i)(Pt(mC),Pt(iA,8))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),RN=(()=>{class i extends nf{constructor(e,n){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(e){const n=gC(this._baseHref,e);return n.length>0?"#"+n:n}pushState(e,n,o,c){let f=this.prepareExternalUrl(o+hu(c));0==f.length&&(f=this._platformLocation.pathname),this._platformLocation.pushState(e,n,f)}replaceState(e,n,o,c){let f=this.prepareExternalUrl(o+hu(c));0==f.length&&(f=this._platformLocation.pathname),this._platformLocation.replaceState(e,n,f)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return i.\u0275fac=function(e){return new(e||i)(Pt(mC),Pt(iA,8))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})(),xy=(()=>{class i{constructor(e){this._subject=new Fn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const n=this._locationStrategy.getBaseHref();this._baseHref=tA(rA(n)),this._locationStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,n=""){return this.path()==this.normalize(e+hu(n))}normalize(e){return i.stripTrailingSlash(function FN(i,t){return i&&t.startsWith(i)?t.substring(i.length):t}(this._baseHref,rA(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,n="",o=null){this._locationStrategy.pushState(o,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+hu(n)),o)}replaceState(e,n="",o=null){this._locationStrategy.replaceState(o,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+hu(n)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)})),()=>{const n=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(n,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",n){this._urlChangeListeners.forEach(o=>o(e,n))}subscribe(e,n,o){return this._subject.subscribe({next:e,error:n,complete:o})}}return i.normalizeQueryParams=hu,i.joinWithSlash=gC,i.stripTrailingSlash=tA,i.\u0275fac=function(e){return new(e||i)(Pt(nf))},i.\u0275prov=hi({token:i,factory:function(){return function LN(){return new xy(Pt(nf))}()},providedIn:"root"}),i})();function rA(i){return i.replace(/\/index.html$/,"")}function pA(i,t){t=encodeURIComponent(t);for(const e of i.split(";")){const n=e.indexOf("="),[o,c]=-1==n?[e,""]:[e.slice(0,n),e.slice(n+1)];if(o.trim()===t)return decodeURIComponent(c)}return null}let SC=(()=>{class i{constructor(e,n,o,c){this._iterableDiffers=e,this._keyValueDiffers=n,this._ngEl=o,this._renderer=c,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(au(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(n=>this._toggleClass(n.key,n.currentValue)),e.forEachChangedItem(n=>this._toggleClass(n.key,n.currentValue)),e.forEachRemovedItem(n=>{n.previousValue&&this._toggleClass(n.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(n=>{if("string"!=typeof n.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${ri(n.item)}`);this._toggleClass(n.item,!0)}),e.forEachRemovedItem(n=>this._toggleClass(n.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(n=>this._toggleClass(n,!0)):Object.keys(e).forEach(n=>this._toggleClass(n,!!e[n])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(n=>this._toggleClass(n,!1)):Object.keys(e).forEach(n=>this._toggleClass(n,!1)))}_toggleClass(e,n){(e=e.trim())&&e.split(/\s+/g).forEach(o=>{n?this._renderer.addClass(this._ngEl.nativeElement,o):this._renderer.removeClass(this._ngEl.nativeElement,o)})}}return i.\u0275fac=function(e){return new(e||i)(ft(px),ft(vy),ft(Zn),ft(Hl))},i.\u0275dir=ci({type:i,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),i})();class xB{constructor(t,e,n,o){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=o}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let TC=(()=>{class i{constructor(e,n,o){this._viewContainer=e,this._template=n,this._differs=o,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const n=this._viewContainer;e.forEachOperation((o,c,f)=>{if(null==o.previousIndex)n.createEmbeddedView(this._template,new xB(o.item,this._ngForOf,-1,-1),null===f?void 0:f);else if(null==f)n.remove(null===c?void 0:c);else if(null!==c){const y=n.get(c);n.move(y,f),gA(y,o)}});for(let o=0,c=n.length;o<c;o++){const y=n.get(o).context;y.index=o,y.count=c,y.ngForOf=this._ngForOf}e.forEachIdentityChange(o=>{gA(n.get(o.currentIndex),o)})}static ngTemplateContextGuard(e,n){return!0}}return i.\u0275fac=function(e){return new(e||i)(ft(Sa),ft(ml),ft(px))},i.\u0275dir=ci({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),i})();function gA(i,t){i.context.$implicit=t.item}let Cy=(()=>{class i{constructor(e,n){this._viewContainer=e,this._context=new wB,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){_A("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){_A("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,n){return!0}}return i.\u0275fac=function(e){return new(e||i)(ft(Sa),ft(ml))},i.\u0275dir=ci({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),i})();class wB{constructor(){this.$implicit=null,this.ngIf=null}}function _A(i,t){if(t&&!t.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${ri(t)}'.`)}class DC{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let Ey=(()=>{class i{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const n=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||n,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),n}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let n=0;n<this._defaultViews.length;n++)this._defaultViews[n].enforceState(e)}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=ci({type:i,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),i})(),AC=(()=>{class i{constructor(e,n,o){this.ngSwitch=o,o._addCase(),this._view=new DC(e,n)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return i.\u0275fac=function(e){return new(e||i)(ft(Sa),ft(ml),ft(Ey,9))},i.\u0275dir=ci({type:i,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),i})(),yA=(()=>{class i{constructor(e,n,o){o._addDefault(new DC(e,n))}}return i.\u0275fac=function(e){return new(e||i)(ft(Sa),ft(ml),ft(Ey,9))},i.\u0275dir=ci({type:i,selectors:[["","ngSwitchDefault",""]],standalone:!0}),i})(),xA=(()=>{class i{constructor(e,n,o){this._ngEl=e,this._differs=n,this._renderer=o,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,n){const[o,c]=e.split("."),f=-1===o.indexOf("-")?void 0:zs.DashCase;null!=n?this._renderer.setStyle(this._ngEl.nativeElement,o,c?`${n}${c}`:n,f):this._renderer.removeStyle(this._ngEl.nativeElement,o,f)}_applyChanges(e){e.forEachRemovedItem(n=>this._setStyle(n.key,null)),e.forEachAddedItem(n=>this._setStyle(n.key,n.currentValue)),e.forEachChangedItem(n=>this._setStyle(n.key,n.currentValue))}}return i.\u0275fac=function(e){return new(e||i)(ft(Zn),ft(vy),ft(Hl))},i.\u0275dir=ci({type:i,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),i})(),rf=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({}),i})();const wA="browser";let ZB=(()=>{class i{}return i.\u0275prov=hi({token:i,providedIn:"root",factory:()=>new KB(Pt(Pn),window)}),i})();class KB{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function QB(i,t){const e=i.getElementById(t)||i.getElementsByName(t)[0];if(e)return e;if("function"==typeof i.createTreeWalker&&i.body&&(i.body.createShadowRoot||i.body.attachShadow)){const n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let o=n.currentNode;for(;o;){const c=o.shadowRoot;if(c){const f=c.getElementById(t)||c.querySelector(`[name="${t}"]`);if(f)return f}o=n.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,o=e.top+this.window.pageYOffset,c=this.offset();this.window.scrollTo(n-c[0],o-c[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=CA(this.window.history)||CA(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function CA(i){return Object.getOwnPropertyDescriptor(i,"scrollRestoration")}class EA{}class RC extends class gz extends class kN{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function AN(i){fx||(fx=i)}(new RC)}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function _z(){return Sy=Sy||document.querySelector("base"),Sy?Sy.getAttribute("href"):null}();return null==e?null:function yz(i){Mx=Mx||document.createElement("a"),Mx.setAttribute("href",i);const t=Mx.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){Sy=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return pA(document.cookie,t)}}let Mx,Sy=null;const DA=new ui("TRANSITION_ID"),xz=[{provide:sx,useFactory:function vz(i,t,e){return()=>{e.get(ax).donePromise.then(()=>{const n=_h(),o=t.querySelectorAll(`style[ng-transition="${i}"]`);for(let c=0;c<o.length;c++)n.remove(o[c])})}},deps:[DA,Pn,Wr],multi:!0}];let wz=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})();const Sx=new ui("EventManagerPlugins");let Tx=(()=>{class i{constructor(e,n){this._zone=n,this._eventNameToPlugin=new Map,e.forEach(o=>o.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,n,o){return this._findPluginFor(n).addEventListener(e,n,o)}addGlobalEventListener(e,n,o){return this._findPluginFor(n).addGlobalEventListener(e,n,o)}getZone(){return this._zone}_findPluginFor(e){const n=this._eventNameToPlugin.get(e);if(n)return n;const o=this._plugins;for(let c=0;c<o.length;c++){const f=o[c];if(f.supports(e))return this._eventNameToPlugin.set(e,f),f}throw new Error(`No event manager plugin found for event ${e}`)}}return i.\u0275fac=function(e){return new(e||i)(Pt(Sx),Pt(En))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})();class AA{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const o=_h().getGlobalEventTarget(this._doc,t);if(!o)throw new Error(`Unsupported event target ${o} for event ${e}`);return this.addEventListener(o,e,n)}}let kA=(()=>{class i{constructor(){this._stylesSet=new Set}addStyles(e){const n=new Set;e.forEach(o=>{this._stylesSet.has(o)||(this._stylesSet.add(o),n.add(o))}),this.onStylesAdded(n)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})(),Ty=(()=>{class i extends kA{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,n,o){e.forEach(c=>{const f=this._doc.createElement("style");f.textContent=c,o.push(n.appendChild(f))})}addHost(e){const n=[];this._addStylesToHost(this._stylesSet,e,n),this._hostNodes.set(e,n)}removeHost(e){const n=this._hostNodes.get(e);n&&n.forEach(IA),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((n,o)=>{this._addStylesToHost(e,o,n)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(IA))}}return i.\u0275fac=function(e){return new(e||i)(Pt(Pn))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})();function IA(i){_h().remove(i)}const LC={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},FC=/%COMP%/g;function Dx(i,t,e){for(let n=0;n<t.length;n++){let o=t[n];Array.isArray(o)?Dx(i,o,e):(o=o.replace(FC,i),e.push(o))}return e}function RA(i){return t=>{if("__ngUnwrap__"===t)return i;!1===i(t)&&(t.preventDefault(),t.returnValue=!1)}}let Ax=(()=>{class i{constructor(e,n,o){this.eventManager=e,this.sharedStylesHost=n,this.appId=o,this.rendererByCompId=new Map,this.defaultRenderer=new NC(e)}createRenderer(e,n){if(!e||!n)return this.defaultRenderer;switch(n.encapsulation){case Os.Emulated:{let o=this.rendererByCompId.get(n.id);return o||(o=new Dz(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,o)),o.applyToHost(e),o}case 1:case Os.ShadowDom:return new Az(this.eventManager,this.sharedStylesHost,e,n);default:if(!this.rendererByCompId.has(n.id)){const o=Dx(n.id,n.styles,[]);this.sharedStylesHost.addStyles(o),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return i.\u0275fac=function(e){return new(e||i)(Pt(Tx),Pt(Ty),Pt(yy))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})();class NC{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(LC[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){(FA(t)?t.content:t).appendChild(e)}insertBefore(t,e,n){t&&(FA(t)?t.content:t).insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,o){if(o){e=o+":"+e;const c=LC[o];c?t.setAttributeNS(c,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const o=LC[n];o?t.removeAttributeNS(o,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,o){o&(zs.DashCase|zs.Important)?t.style.setProperty(e,n,o&zs.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&zs.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,RA(n)):this.eventManager.addEventListener(t,e,RA(n))}}function FA(i){return"TEMPLATE"===i.tagName&&void 0!==i.content}class Dz extends NC{constructor(t,e,n,o){super(t),this.component=n;const c=Dx(o+"-"+n.id,n.styles,[]);e.addStyles(c),this.contentAttr=function Mz(i){return"_ngcontent-%COMP%".replace(FC,i)}(o+"-"+n.id),this.hostAttr=function Sz(i){return"_nghost-%COMP%".replace(FC,i)}(o+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class Az extends NC{constructor(t,e,n,o){super(t),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const c=Dx(o.id,o.styles,[]);for(let f=0;f<c.length;f++){const y=document.createElement("style");y.textContent=c[f],this.shadowRoot.appendChild(y)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let kz=(()=>{class i extends AA{constructor(e){super(e)}supports(e){return!0}addEventListener(e,n,o){return e.addEventListener(n,o,!1),()=>this.removeEventListener(e,n,o)}removeEventListener(e,n,o){return e.removeEventListener(n,o)}}return i.\u0275fac=function(e){return new(e||i)(Pt(Pn))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})();const NA=["alt","control","meta","shift"],Iz={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Pz={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let Oz=(()=>{class i extends AA{constructor(e){super(e)}supports(e){return null!=i.parseEventName(e)}addEventListener(e,n,o){const c=i.parseEventName(n),f=i.eventCallback(c.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>_h().onAndCancel(e,c.domEventName,f))}static parseEventName(e){const n=e.toLowerCase().split("."),o=n.shift();if(0===n.length||"keydown"!==o&&"keyup"!==o)return null;const c=i._normalizeKey(n.pop());let f="",y=n.indexOf("code");if(y>-1&&(n.splice(y,1),f="code."),NA.forEach(L=>{const le=n.indexOf(L);le>-1&&(n.splice(le,1),f+=L+".")}),f+=c,0!=n.length||0===c.length)return null;const w={};return w.domEventName=o,w.fullKey=f,w}static matchEventFullKeyCode(e,n){let o=Iz[e.key]||e.key,c="";return n.indexOf("code.")>-1&&(o=e.code,c="code."),!(null==o||!o)&&(o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),NA.forEach(f=>{f!==o&&(0,Pz[f])(e)&&(c+=f+".")}),c+=o,c===n)}static eventCallback(e,n,o){return c=>{i.matchEventFullKeyCode(c,e)&&o.runGuarded(()=>n(c))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return i.\u0275fac=function(e){return new(e||i)(Pt(Pn))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})();const Nz=RD(SN,"browser",[{provide:lx,useValue:wA},{provide:ED,useValue:function Rz(){RC.makeCurrent()},multi:!0},{provide:Pn,useFactory:function Fz(){return function Ov(i){$f=i}(document),document},deps:[]}]),VA=new ui(""),jA=[{provide:cx,useClass:class bz{addToWindow(t){wr.getAngularTestability=(n,o=!0)=>{const c=t.findTestabilityInTree(n,o);if(null==c)throw new Error("Could not find testability for element.");return c},wr.getAllAngularTestabilities=()=>t.getAllTestabilities(),wr.getAllAngularRootElements=()=>t.getAllRootElements(),wr.frameworkStabilizers||(wr.frameworkStabilizers=[]),wr.frameworkStabilizers.push(n=>{const o=wr.getAllAngularTestabilities();let c=o.length,f=!1;const y=function(w){f=f||w,c--,0==c&&n(f)};o.forEach(function(w){w.whenStable(y)})})}findTestabilityInTree(t,e,n){return null==e?null:t.getTestability(e)??(n?_h().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:kD,useClass:sC,deps:[En,aC,cx]},{provide:sC,useClass:sC,deps:[En,aC,cx]}],UA=[{provide:sd,useValue:"root"},{provide:$r,useFactory:function Lz(){return new $r},deps:[]},{provide:Sx,useClass:kz,multi:!0,deps:[Pn,En,lx]},{provide:Sx,useClass:Oz,multi:!0,deps:[Pn]},{provide:Ax,useClass:Ax,deps:[Tx,Ty,yy]},{provide:ad,useExisting:Ax},{provide:kA,useExisting:Ty},{provide:Ty,useClass:Ty,deps:[Pn]},{provide:Tx,useClass:Tx,deps:[Sx,En]},{provide:EA,useClass:wz,deps:[]},[]];let HA=(()=>{class i{constructor(e){}static withServerTransition(e){return{ngModule:i,providers:[{provide:yy,useValue:e.appId},{provide:DA,useExisting:yy},xz]}}}return i.\u0275fac=function(e){return new(e||i)(Pt(VA,12))},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({providers:[...UA,...jA],imports:[rf,TN]}),i})(),GA=(()=>{class i{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return i.\u0275fac=function(e){return new(e||i)(Pt(Pn))},i.\u0275prov=hi({token:i,factory:function(e){let n=null;return n=e?new e:function zz(){return new GA(Pt(Pn))}(),n},providedIn:"root"}),i})();typeof window<"u"&&window;let VC=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=hi({token:i,factory:function(e){let n=null;return n=e?new(e||i):Pt(XA),n},providedIn:"root"}),i})(),XA=(()=>{class i extends VC{constructor(e){super(),this._doc=e}sanitize(e,n){if(null==n)return null;switch(e){case hr.NONE:return n;case hr.HTML:return Bs(n,"HTML")?hs(n):i_(this._doc,String(n)).toString();case hr.STYLE:return Bs(n,"Style")?hs(n):n;case hr.SCRIPT:if(Bs(n,"Script"))return hs(n);throw new Error("unsafe value used in a script context");case hr.URL:return Bs(n,"URL")?hs(n):td(String(n));case hr.RESOURCE_URL:if(Bs(n,"ResourceURL"))return hs(n);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function Kg(i){return new Nv(i)}(e)}bypassSecurityTrustStyle(e){return function Vv(i){return new Bv(i)}(e)}bypassSecurityTrustScript(e){return function fp(i){return new Mw(i)}(e)}bypassSecurityTrustUrl(e){return function mp(i){return new Zg(i)}(e)}bypassSecurityTrustResourceUrl(e){return function ba(i){return new zv(i)}(e)}}return i.\u0275fac=function(e){return new(e||i)(Pt(Pn))},i.\u0275prov=hi({token:i,factory:function(e){let n=null;return n=e?new e:function Wz(i){return new XA(i.get(Pn))}(Pt(Wr)),n},providedIn:"root"}),i})();function $i(...i){return xr(i,dn(i))}class Kl extends ue{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:n}=this;if(t)throw e;return this._throwIfClosed(),n}next(t){super.next(this._value=t)}}const kx=lo(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:Xz}=Array,{getPrototypeOf:qz,prototype:Yz,keys:Zz}=Object;function qA(i){if(1===i.length){const t=i[0];if(Xz(t))return{args:t,keys:null};if(function Kz(i){return i&&"object"==typeof i&&qz(i)===Yz}(t)){const e=Zz(t);return{args:e.map(n=>t[n]),keys:e}}}return{args:i,keys:null}}const{isArray:Qz}=Array;function jC(i){return Ie(t=>function Jz(i,t){return Qz(t)?i(...t):i(t)}(i,t))}function YA(i,t){return i.reduce((e,n,o)=>(e[n]=t[o],e),{})}function UC(...i){const t=dn(i),e=Yi(i),{args:n,keys:o}=qA(i);if(0===n.length)return xr([],t);const c=new S(function e3(i,t,e=A){return n=>{ZA(t,()=>{const{length:o}=i,c=new Array(o);let f=o,y=o;for(let w=0;w<o;w++)ZA(t,()=>{const L=xr(i[w],t);let le=!1;L.subscribe(de(n,ye=>{c[w]=ye,le||(le=!0,y--),y||n.next(e(c.slice()))},()=>{--f||n.complete()}))},n)},n)}}(n,t,o?f=>YA(o,f):A));return e?c.pipe(jC(e)):c}function ZA(i,t,e){i?Et(e,i,t):t()}function Dy(...i){return function t3(){return Yt(1)}()(xr(i,dn(i)))}function sg(i){return new S(t=>{_o(i()).subscribe(t)})}function ag(i,t){const e=Mn(i)?i:()=>i,n=o=>o.error(e());return new S(t?o=>t.schedule(n,0,o):n)}function HC(){return $((i,t)=>{let e=null;i._refCount++;const n=de(t,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(e=null);const o=i._connection,c=e;e=null,o&&(!c||o===c)&&o.unsubscribe(),t.unsubscribe()});i.subscribe(n),n.closed||(e=i.connect())})}class KA extends S{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,V(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new re;const e=this.getSubject();t.add(this.source.subscribe(de(e,void 0,()=>{this._teardown(),e.complete()},n=>{this._teardown(),e.error(n)},()=>this._teardown()))),t.closed&&(this._connection=null,t=re.EMPTY)}return t}refCount(){return HC()(this)}}function Us(i,t){return $((e,n)=>{let o=null,c=0,f=!1;const y=()=>f&&!o&&n.complete();e.subscribe(de(n,w=>{o?.unsubscribe();let L=0;const le=c++;_o(i(w,le)).subscribe(o=de(n,ye=>n.next(t?t(w,ye,le,L++):ye),()=>{o=null,y()}))},()=>{f=!0,y()}))})}function eo(i){return i<=0?()=>gi:$((t,e)=>{let n=0;t.subscribe(de(e,o=>{++n<=i&&(e.next(o),i<=n&&e.complete())}))})}function gl(...i){const t=dn(i);return $((e,n)=>{(t?Dy(i,e,t):Dy(i,e)).subscribe(n)})}function to(i,t){return $((e,n)=>{let o=0;e.subscribe(de(n,c=>i.call(t,c,o++)&&n.next(c)))})}function Ix(i){return $((t,e)=>{let n=!1;t.subscribe(de(e,o=>{n=!0,e.next(o)},()=>{n||e.next(i),e.complete()}))})}function QA(i=i3){return $((t,e)=>{let n=!1;t.subscribe(de(e,o=>{n=!0,e.next(o)},()=>n?e.complete():e.error(i())))})}function i3(){return new kx}function Ad(i,t){const e=arguments.length>=2;return n=>n.pipe(i?to((o,c)=>i(o,c,n)):A,eo(1),e?Ix(t):QA(()=>new kx))}function kd(i,t){return Mn(t)?Mt(i,t,1):Mt(i,1)}function zo(i,t,e){const n=Mn(i)||t||e?{next:i,error:t,complete:e}:i;return n?$((o,c)=>{var f;null===(f=n.subscribe)||void 0===f||f.call(n);let y=!0;o.subscribe(de(c,w=>{var L;null===(L=n.next)||void 0===L||L.call(n,w),c.next(w)},()=>{var w;y=!1,null===(w=n.complete)||void 0===w||w.call(n),c.complete()},w=>{var L;y=!1,null===(L=n.error)||void 0===L||L.call(n,w),c.error(w)},()=>{var w,L;y&&(null===(w=n.unsubscribe)||void 0===w||w.call(n)),null===(L=n.finalize)||void 0===L||L.call(n)}))}):A}function du(i){return $((t,e)=>{let c,n=null,o=!1;n=t.subscribe(de(e,void 0,void 0,f=>{c=_o(i(f,du(i)(t))),n?(n.unsubscribe(),n=null,c.subscribe(e)):o=!0})),o&&(n.unsubscribe(),n=null,c.subscribe(e))})}function n3(i,t,e,n,o){return(c,f)=>{let y=e,w=t,L=0;c.subscribe(de(f,le=>{const ye=L++;w=y?i(w,le,ye):(y=!0,le),n&&f.next(w)},o&&(()=>{y&&f.next(w),f.complete()})))}}function JA(i,t){return $(n3(i,t,arguments.length>=2,!0))}function GC(i){return i<=0?()=>gi:$((t,e)=>{let n=[];t.subscribe(de(e,o=>{n.push(o),i<n.length&&n.shift()},()=>{for(const o of n)e.next(o);e.complete()},void 0,()=>{n=null}))})}function ek(i,t){const e=arguments.length>=2;return n=>n.pipe(i?to((o,c)=>i(o,c,n)):A,GC(1),e?Ix(t):QA(()=>new kx))}function tk(i,t=!1){return $((e,n)=>{let o=0;e.subscribe(de(n,c=>{const f=i(c,o++);(f||t)&&n.next(c),!f&&n.complete()}))})}function ik(i){return Ie(()=>i)}function Px(i){return $((t,e)=>{try{t.subscribe(e)}finally{e.add(i)}})}const Gn="primary",Ay=Symbol("RouteTitle");class r3{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function lg(i){return new r3(i)}function o3(i,t,e){const n=e.path.split("/");if(n.length>i.length||"full"===e.pathMatch&&(t.hasChildren()||n.length<i.length))return null;const o={};for(let c=0;c<n.length;c++){const f=n[c],y=i[c];if(f.startsWith(":"))o[f.substring(1)]=y;else if(f!==y.path)return null}return{consumed:i.slice(0,n.length),posParams:o}}function yh(i,t){const e=i?Object.keys(i):void 0,n=t?Object.keys(t):void 0;if(!e||!n||e.length!=n.length)return!1;let o;for(let c=0;c<e.length;c++)if(o=e[c],!nk(i[o],t[o]))return!1;return!0}function nk(i,t){if(Array.isArray(i)&&Array.isArray(t)){if(i.length!==t.length)return!1;const e=[...i].sort(),n=[...t].sort();return e.every((o,c)=>n[c]===o)}return i===t}function rk(i){return Array.prototype.concat.apply([],i)}function ok(i){return i.length>0?i[i.length-1]:null}function Hs(i,t){for(const e in i)i.hasOwnProperty(e)&&t(i[e],e)}function Id(i){return k1(i)?i:cy(i)?xr(Promise.resolve(i)):$i(i)}const l3={exact:function lk(i,t,e){if(!af(i.segments,t.segments)||!Ox(i.segments,t.segments,e)||i.numberOfChildren!==t.numberOfChildren)return!1;for(const n in t.children)if(!i.children[n]||!lk(i.children[n],t.children[n],e))return!1;return!0},subset:ck},sk={exact:function c3(i,t){return yh(i,t)},subset:function h3(i,t){return Object.keys(t).length<=Object.keys(i).length&&Object.keys(t).every(e=>nk(i[e],t[e]))},ignored:()=>!0};function ak(i,t,e){return l3[e.paths](i.root,t.root,e.matrixParams)&&sk[e.queryParams](i.queryParams,t.queryParams)&&!("exact"===e.fragment&&i.fragment!==t.fragment)}function ck(i,t,e){return hk(i,t,t.segments,e)}function hk(i,t,e,n){if(i.segments.length>e.length){const o=i.segments.slice(0,e.length);return!(!af(o,e)||t.hasChildren()||!Ox(o,e,n))}if(i.segments.length===e.length){if(!af(i.segments,e)||!Ox(i.segments,e,n))return!1;for(const o in t.children)if(!i.children[o]||!ck(i.children[o],t.children[o],n))return!1;return!0}{const o=e.slice(0,i.segments.length),c=e.slice(i.segments.length);return!!(af(i.segments,o)&&Ox(i.segments,o,n)&&i.children[Gn])&&hk(i.children[Gn],t,c,n)}}function Ox(i,t,e){return t.every((n,o)=>sk[e](i[o].parameters,n.parameters))}class sf{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=lg(this.queryParams)),this._queryParamMap}toString(){return p3.serialize(this)}}class qn{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Hs(e,(n,o)=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Rx(this)}}class ky{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=lg(this.parameters)),this._parameterMap}toString(){return fk(this)}}function af(i,t){return i.length===t.length&&i.every((e,n)=>e.path===t[n].path)}let uk=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=hi({token:i,factory:function(){return new WC},providedIn:"root"}),i})();class WC{parse(t){const e=new w3(t);return new sf(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${Iy(t.root,!0)}`,n=function g3(i){const t=Object.keys(i).map(e=>{const n=i[e];return Array.isArray(n)?n.map(o=>`${Lx(e)}=${Lx(o)}`).join("&"):`${Lx(e)}=${Lx(n)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${n}${"string"==typeof t.fragment?`#${function f3(i){return encodeURI(i)}(t.fragment)}`:""}`}}const p3=new WC;function Rx(i){return i.segments.map(t=>fk(t)).join("/")}function Iy(i,t){if(!i.hasChildren())return Rx(i);if(t){const e=i.children[Gn]?Iy(i.children[Gn],!1):"",n=[];return Hs(i.children,(o,c)=>{c!==Gn&&n.push(`${c}:${Iy(o,!1)}`)}),n.length>0?`${e}(${n.join("//")})`:e}{const e=function d3(i,t){let e=[];return Hs(i.children,(n,o)=>{o===Gn&&(e=e.concat(t(n,o)))}),Hs(i.children,(n,o)=>{o!==Gn&&(e=e.concat(t(n,o)))}),e}(i,(n,o)=>o===Gn?[Iy(i.children[Gn],!1)]:[`${o}:${Iy(n,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[Gn]?`${Rx(i)}/${e[0]}`:`${Rx(i)}/(${e.join("//")})`}}function dk(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Lx(i){return dk(i).replace(/%3B/gi,";")}function XC(i){return dk(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Fx(i){return decodeURIComponent(i)}function pk(i){return Fx(i.replace(/\+/g,"%20"))}function fk(i){return`${XC(i.path)}${function m3(i){return Object.keys(i).map(t=>`;${XC(t)}=${XC(i[t])}`).join("")}(i.parameters)}`}const _3=/^[^\/()?;=#]+/;function Nx(i){const t=i.match(_3);return t?t[0]:""}const y3=/^[^=?&#]+/,x3=/^[^&#]+/;class w3{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new qn([],{}):new qn([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n[Gn]=new qn(t,e)),n}parseSegment(){const t=Nx(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new ti(4009,!1);return this.capture(t),new ky(Fx(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=Nx(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const o=Nx(this.remaining);o&&(n=o,this.capture(n))}t[Fx(e)]=Fx(n)}parseQueryParam(t){const e=function v3(i){const t=i.match(y3);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const f=function b3(i){const t=i.match(x3);return t?t[0]:""}(this.remaining);f&&(n=f,this.capture(n))}const o=pk(e),c=pk(n);if(t.hasOwnProperty(o)){let f=t[o];Array.isArray(f)||(f=[f],t[o]=f),f.push(c)}else t[o]=c}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=Nx(this.remaining),o=this.remaining[n.length];if("/"!==o&&")"!==o&&";"!==o)throw new ti(4010,!1);let c;n.indexOf(":")>-1?(c=n.slice(0,n.indexOf(":")),this.capture(c),this.capture(":")):t&&(c=Gn);const f=this.parseChildren();e[c]=1===Object.keys(f).length?f[Gn]:new qn([],f),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new ti(4011,!1)}}function qC(i){return i.segments.length>0?new qn([],{[Gn]:i}):i}function Bx(i){const t={};for(const n of Object.keys(i.children)){const c=Bx(i.children[n]);(c.segments.length>0||c.hasChildren())&&(t[n]=c)}return function C3(i){if(1===i.numberOfChildren&&i.children[Gn]){const t=i.children[Gn];return new qn(i.segments.concat(t.segments),t.children)}return i}(new qn(i.segments,t))}function lf(i){return i instanceof sf}function S3(i,t,e,n,o){if(0===e.length)return cg(t.root,t.root,t.root,n,o);const c=function _k(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new gk(!0,0,i);let t=0,e=!1;const n=i.reduce((o,c,f)=>{if("object"==typeof c&&null!=c){if(c.outlets){const y={};return Hs(c.outlets,(w,L)=>{y[L]="string"==typeof w?w.split("/"):w}),[...o,{outlets:y}]}if(c.segmentPath)return[...o,c.segmentPath]}return"string"!=typeof c?[...o,c]:0===f?(c.split("/").forEach((y,w)=>{0==w&&"."===y||(0==w&&""===y?e=!0:".."===y?t++:""!=y&&o.push(y))}),o):[...o,c]},[]);return new gk(e,t,n)}(e);return c.toRoot()?cg(t.root,t.root,new qn([],{}),n,o):function f(w){const L=function D3(i,t,e,n){if(i.isAbsolute)return new hg(t.root,!0,0);if(-1===n)return new hg(e,e===t.root,0);return function yk(i,t,e){let n=i,o=t,c=e;for(;c>o;){if(c-=o,n=n.parent,!n)throw new ti(4005,!1);o=n.segments.length}return new hg(n,!1,o-c)}(e,n+(Py(i.commands[0])?0:1),i.numberOfDoubleDots)}(c,t,i.snapshot?._urlSegment,w),le=L.processChildren?Ry(L.segmentGroup,L.index,c.commands):ZC(L.segmentGroup,L.index,c.commands);return cg(t.root,L.segmentGroup,le,n,o)}(i.snapshot?._lastPathIndex)}function Py(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function Oy(i){return"object"==typeof i&&null!=i&&i.outlets}function cg(i,t,e,n,o){let f,c={};n&&Hs(n,(w,L)=>{c[L]=Array.isArray(w)?w.map(le=>`${le}`):`${w}`}),f=i===t?e:mk(i,t,e);const y=qC(Bx(f));return new sf(y,c,o)}function mk(i,t,e){const n={};return Hs(i.children,(o,c)=>{n[c]=o===t?e:mk(o,t,e)}),new qn(i.segments,n)}class gk{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&Py(n[0]))throw new ti(4003,!1);const o=n.find(Oy);if(o&&o!==ok(n))throw new ti(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class hg{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function ZC(i,t,e){if(i||(i=new qn([],{})),0===i.segments.length&&i.hasChildren())return Ry(i,t,e);const n=function k3(i,t,e){let n=0,o=t;const c={match:!1,pathIndex:0,commandIndex:0};for(;o<i.segments.length;){if(n>=e.length)return c;const f=i.segments[o],y=e[n];if(Oy(y))break;const w=`${y}`,L=n<e.length-1?e[n+1]:null;if(o>0&&void 0===w)break;if(w&&L&&"object"==typeof L&&void 0===L.outlets){if(!xk(w,L,f))return c;n+=2}else{if(!xk(w,{},f))return c;n++}o++}return{match:!0,pathIndex:o,commandIndex:n}}(i,t,e),o=e.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){const c=new qn(i.segments.slice(0,n.pathIndex),{});return c.children[Gn]=new qn(i.segments.slice(n.pathIndex),i.children),Ry(c,0,o)}return n.match&&0===o.length?new qn(i.segments,{}):n.match&&!i.hasChildren()?KC(i,t,e):n.match?Ry(i,0,o):KC(i,t,e)}function Ry(i,t,e){if(0===e.length)return new qn(i.segments,{});{const n=function A3(i){return Oy(i[0])?i[0].outlets:{[Gn]:i}}(e),o={};return Hs(n,(c,f)=>{"string"==typeof c&&(c=[c]),null!==c&&(o[f]=ZC(i.children[f],t,c))}),Hs(i.children,(c,f)=>{void 0===n[f]&&(o[f]=c)}),new qn(i.segments,o)}}function KC(i,t,e){const n=i.segments.slice(0,t);let o=0;for(;o<e.length;){const c=e[o];if(Oy(c)){const w=I3(c.outlets);return new qn(n,w)}if(0===o&&Py(e[0])){n.push(new ky(i.segments[t].path,vk(e[0]))),o++;continue}const f=Oy(c)?c.outlets[Gn]:`${c}`,y=o<e.length-1?e[o+1]:null;f&&y&&Py(y)?(n.push(new ky(f,vk(y))),o+=2):(n.push(new ky(f,{})),o++)}return new qn(n,{})}function I3(i){const t={};return Hs(i,(e,n)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[n]=KC(new qn([],{}),0,e))}),t}function vk(i){const t={};return Hs(i,(e,n)=>t[n]=`${e}`),t}function xk(i,t,e){return i==e.path&&yh(t,e.parameters)}class pu{constructor(t,e){this.id=t,this.url=e}}class QC extends pu{constructor(t,e,n="imperative",o=null){super(t,e),this.type=0,this.navigationTrigger=n,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class cf extends pu{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class zx extends pu{constructor(t,e,n,o){super(t,e),this.reason=n,this.code=o,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class bk extends pu{constructor(t,e,n,o){super(t,e),this.error=n,this.target=o,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class P3 extends pu{constructor(t,e,n,o){super(t,e),this.urlAfterRedirects=n,this.state=o,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class O3 extends pu{constructor(t,e,n,o){super(t,e),this.urlAfterRedirects=n,this.state=o,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class R3 extends pu{constructor(t,e,n,o,c){super(t,e),this.urlAfterRedirects=n,this.state=o,this.shouldActivate=c,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class L3 extends pu{constructor(t,e,n,o){super(t,e),this.urlAfterRedirects=n,this.state=o,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class F3 extends pu{constructor(t,e,n,o){super(t,e),this.urlAfterRedirects=n,this.state=o,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class N3{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class B3{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class z3{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class V3{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class j3{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class U3{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class wk{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Ck{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=JC(t,this._root);return e?e.children.map(n=>n.value):[]}firstChild(t){const e=JC(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=eE(t,this._root);return e.length<2?[]:e[e.length-2].children.map(o=>o.value).filter(o=>o!==t)}pathFromRoot(t){return eE(t,this._root).map(e=>e.value)}}function JC(i,t){if(i===t.value)return t;for(const e of t.children){const n=JC(i,e);if(n)return n}return null}function eE(i,t){if(i===t.value)return[t];for(const e of t.children){const n=eE(i,e);if(n.length)return n.unshift(t),n}return[]}class fu{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function ug(i){const t={};return i&&i.children.forEach(e=>t[e.value.outlet]=e),t}class Ek extends Ck{constructor(t,e){super(t),this.snapshot=e,tE(this,t)}toString(){return this.snapshot.toString()}}function Mk(i,t){const e=function G3(i,t){const f=new Vx([],{},{},"",{},Gn,t,null,i.root,-1,{});return new Tk("",new fu(f,[]))}(i,t),n=new Kl([new ky("",{})]),o=new Kl({}),c=new Kl({}),f=new Kl({}),y=new Kl(""),w=new Pd(n,o,f,y,c,Gn,t,e.root);return w.snapshot=e.root,new Ek(new fu(w,[]),e)}class Pd{constructor(t,e,n,o,c,f,y,w){this.url=t,this.params=e,this.queryParams=n,this.fragment=o,this.data=c,this.outlet=f,this.component=y,this.title=this.data?.pipe(Ie(L=>L[Ay]))??$i(void 0),this._futureSnapshot=w}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Ie(t=>lg(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Ie(t=>lg(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Sk(i,t="emptyOnly"){const e=i.pathFromRoot;let n=0;if("always"!==t)for(n=e.length-1;n>=1;){const o=e[n],c=e[n-1];if(o.routeConfig&&""===o.routeConfig.path)n--;else{if(c.component)break;n--}}return function $3(i){return i.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(n))}class Vx{constructor(t,e,n,o,c,f,y,w,L,le,ye,Be){this.url=t,this.params=e,this.queryParams=n,this.fragment=o,this.data=c,this.outlet=f,this.component=y,this.title=this.data?.[Ay],this.routeConfig=w,this._urlSegment=L,this._lastPathIndex=le,this._correctedLastPathIndex=Be??le,this._resolve=ye}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=lg(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=lg(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Tk extends Ck{constructor(t,e){super(e),this.url=t,tE(this,e)}toString(){return Dk(this._root)}}function tE(i,t){t.value._routerState=i,t.children.forEach(e=>tE(i,e))}function Dk(i){const t=i.children.length>0?` { ${i.children.map(Dk).join(", ")} } `:"";return`${i.value}${t}`}function iE(i){if(i.snapshot){const t=i.snapshot,e=i._futureSnapshot;i.snapshot=e,yh(t.queryParams,e.queryParams)||i.queryParams.next(e.queryParams),t.fragment!==e.fragment&&i.fragment.next(e.fragment),yh(t.params,e.params)||i.params.next(e.params),function s3(i,t){if(i.length!==t.length)return!1;for(let e=0;e<i.length;++e)if(!yh(i[e],t[e]))return!1;return!0}(t.url,e.url)||i.url.next(e.url),yh(t.data,e.data)||i.data.next(e.data)}else i.snapshot=i._futureSnapshot,i.data.next(i._futureSnapshot.data)}function nE(i,t){const e=yh(i.params,t.params)&&function u3(i,t){return af(i,t)&&i.every((e,n)=>yh(e.parameters,t[n].parameters))}(i.url,t.url);return e&&!(!i.parent!=!t.parent)&&(!i.parent||nE(i.parent,t.parent))}function Ly(i,t,e){if(e&&i.shouldReuseRoute(t.value,e.value.snapshot)){const n=e.value;n._futureSnapshot=t.value;const o=function X3(i,t,e){return t.children.map(n=>{for(const o of e.children)if(i.shouldReuseRoute(n.value,o.value.snapshot))return Ly(i,n,o);return Ly(i,n)})}(i,t,e);return new fu(n,o)}{if(i.shouldAttach(t.value)){const c=i.retrieve(t.value);if(null!==c){const f=c.route;return f.value._futureSnapshot=t.value,f.children=t.children.map(y=>Ly(i,y)),f}}const n=function q3(i){return new Pd(new Kl(i.url),new Kl(i.params),new Kl(i.queryParams),new Kl(i.fragment),new Kl(i.data),i.outlet,i.component,i)}(t.value),o=t.children.map(c=>Ly(i,c));return new fu(n,o)}}const rE="ngNavigationCancelingError";function Ak(i,t){const{redirectTo:e,navigationBehaviorOptions:n}=lf(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,o=kk(!1,0,t);return o.url=e,o.navigationBehaviorOptions=n,o}function kk(i,t,e){const n=new Error("NavigationCancelingError: "+(i||""));return n[rE]=!0,n.cancellationCode=t,e&&(n.url=e),n}function Ik(i){return Pk(i)&&lf(i.url)}function Pk(i){return i&&i[rE]}class Y3{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Fy,this.attachRef=null}}let Fy=(()=>{class i{constructor(){this.contexts=new Map}onChildOutletCreated(e,n){const o=this.getOrCreateContext(e);o.outlet=n,this.contexts.set(e,o)}onChildOutletDestroyed(e){const n=this.getContext(e);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let n=this.getContext(e);return n||(n=new Y3,this.contexts.set(e,n)),n}getContext(e){return this.contexts.get(e)||null}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const jx=!1;let Ux=(()=>{class i{constructor(e,n,o,c,f){this.parentContexts=e,this.location=n,this.changeDetector=c,this.environmentInjector=f,this.activated=null,this._activatedRoute=null,this.activateEvents=new Fn,this.deactivateEvents=new Fn,this.attachEvents=new Fn,this.detachEvents=new Fn,this.name=o||Gn,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ti(4012,jx);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ti(4012,jx);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ti(4012,jx);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,n){this.activated=e,this._activatedRoute=n,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,n){if(this.isActivated)throw new ti(4013,jx);this._activatedRoute=e;const o=this.location,f=e._futureSnapshot.component,y=this.parentContexts.getOrCreateContext(this.name).children,w=new Z3(e,y,o.injector);if(n&&function K3(i){return!!i.resolveComponentFactory}(n)){const L=n.resolveComponentFactory(f);this.activated=o.createComponent(L,o.length,w)}else this.activated=o.createComponent(f,{index:o.length,injector:w,environmentInjector:n??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return i.\u0275fac=function(e){return new(e||i)(ft(Fy),ft(Sa),po("name"),ft(Wa),ft(Ul))},i.\u0275dir=ci({type:i,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),i})();class Z3{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===Pd?this.route:t===Fy?this.childContexts:this.parent.get(t,e)}}let oE=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=Cr({type:i,selectors:[["ng-component"]],standalone:!0,features:[BT],decls:1,vars:0,template:function(e,n){1&e&&zn(0,"router-outlet")},dependencies:[Ux],encapsulation:2}),i})();function Ok(i,t){return i.providers&&!i._injector&&(i._injector=ix(i.providers,t,`Route: ${i.path}`)),i._injector??t}function aE(i){const t=i.children&&i.children.map(aE),e=t?{...i,children:t}:{...i};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==Gn&&(e.component=oE),e}function Ql(i){return i.outlet||Gn}function Rk(i,t){const e=i.filter(n=>Ql(n)===t);return e.push(...i.filter(n=>Ql(n)!==t)),e}function Ny(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let t=i.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class iV{constructor(t,e,n,o){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=o}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),iE(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const o=ug(e);t.children.forEach(c=>{const f=c.value.outlet;this.deactivateRoutes(c,o[f],n),delete o[f]}),Hs(o,(c,f)=>{this.deactivateRouteAndItsChildren(c,n)})}deactivateRoutes(t,e,n){const o=t.value,c=e?e.value:null;if(o===c)if(o.component){const f=n.getContext(o.outlet);f&&this.deactivateChildRoutes(t,e,f.children)}else this.deactivateChildRoutes(t,e,n);else c&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet),o=n&&t.value.component?n.children:e,c=ug(t);for(const f of Object.keys(c))this.deactivateRouteAndItsChildren(c[f],o);if(n&&n.outlet){const f=n.outlet.detach(),y=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:f,route:t,contexts:y})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet),o=n&&t.value.component?n.children:e,c=ug(t);for(const f of Object.keys(c))this.deactivateRouteAndItsChildren(c[f],o);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(t,e,n){const o=ug(e);t.children.forEach(c=>{this.activateRoutes(c,o[c.value.outlet],n),this.forwardEvent(new U3(c.value.snapshot))}),t.children.length&&this.forwardEvent(new V3(t.value.snapshot))}activateRoutes(t,e,n){const o=t.value,c=e?e.value:null;if(iE(o),o===c)if(o.component){const f=n.getOrCreateContext(o.outlet);this.activateChildRoutes(t,e,f.children)}else this.activateChildRoutes(t,e,n);else if(o.component){const f=n.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){const y=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),f.children.onOutletReAttached(y.contexts),f.attachRef=y.componentRef,f.route=y.route.value,f.outlet&&f.outlet.attach(y.componentRef,y.route.value),iE(y.route.value),this.activateChildRoutes(t,null,f.children)}else{const y=Ny(o.snapshot),w=y?.get(Xh)??null;f.attachRef=null,f.route=o,f.resolver=w,f.injector=y,f.outlet&&f.outlet.activateWith(o,f.injector),this.activateChildRoutes(t,null,f.children)}}else this.activateChildRoutes(t,null,n)}}class Lk{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Hx{constructor(t,e){this.component=t,this.route=e}}function nV(i,t,e){const n=i._root;return By(n,t?t._root:null,e,[n.value])}function dg(i,t){const e=Symbol(),n=t.get(i,e);return n===e?"function"!=typeof i||function Sh(i){return null!==Ys(i)}(i)?t.get(i):i:n}function By(i,t,e,n,o={canDeactivateChecks:[],canActivateChecks:[]}){const c=ug(t);return i.children.forEach(f=>{(function oV(i,t,e,n,o={canDeactivateChecks:[],canActivateChecks:[]}){const c=i.value,f=t?t.value:null,y=e?e.getContext(i.value.outlet):null;if(f&&c.routeConfig===f.routeConfig){const w=function sV(i,t,e){if("function"==typeof e)return e(i,t);switch(e){case"pathParamsChange":return!af(i.url,t.url);case"pathParamsOrQueryParamsChange":return!af(i.url,t.url)||!yh(i.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!nE(i,t)||!yh(i.queryParams,t.queryParams);default:return!nE(i,t)}}(f,c,c.routeConfig.runGuardsAndResolvers);w?o.canActivateChecks.push(new Lk(n)):(c.data=f.data,c._resolvedData=f._resolvedData),By(i,t,c.component?y?y.children:null:e,n,o),w&&y&&y.outlet&&y.outlet.isActivated&&o.canDeactivateChecks.push(new Hx(y.outlet.component,f))}else f&&zy(t,y,o),o.canActivateChecks.push(new Lk(n)),By(i,null,c.component?y?y.children:null:e,n,o)})(f,c[f.value.outlet],e,n.concat([f.value]),o),delete c[f.value.outlet]}),Hs(c,(f,y)=>zy(f,e.getContext(y),o)),o}function zy(i,t,e){const n=ug(i),o=i.value;Hs(n,(c,f)=>{zy(c,o.component?t?t.children.getContext(f):null:t,e)}),e.canDeactivateChecks.push(new Hx(o.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,o))}function Vy(i){return"function"==typeof i}function lE(i){return i instanceof kx||"EmptyError"===i?.name}const Gx=Symbol("INITIAL_VALUE");function pg(){return Us(i=>UC(i.map(t=>t.pipe(eo(1),gl(Gx)))).pipe(Ie(t=>{for(const e of t)if(!0!==e){if(e===Gx)return Gx;if(!1===e||e instanceof sf)return e}return!0}),to(t=>t!==Gx),eo(1)))}function Fk(i){return function U(...i){return T(i)}(zo(t=>{if(lf(t))throw Ak(0,t)}),Ie(t=>!0===t))}const cE={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Nk(i,t,e,n,o){const c=hE(i,t,e);return c.matched?function CV(i,t,e,n){const o=t.canMatch;return o&&0!==o.length?$i(o.map(f=>{const y=dg(f,i);return Id(function dV(i){return i&&Vy(i.canMatch)}(y)?y.canMatch(t,e):i.runInContext(()=>y(t,e)))})).pipe(pg(),Fk()):$i(!0)}(n=Ok(t,n),t,e).pipe(Ie(f=>!0===f?c:{...cE})):$i(c)}function hE(i,t,e){if(""===t.path)return"full"===t.pathMatch&&(i.hasChildren()||e.length>0)?{...cE}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const o=(t.matcher||o3)(e,i,t);if(!o)return{...cE};const c={};Hs(o.posParams,(y,w)=>{c[w]=y.path});const f=o.consumed.length>0?{...c,...o.consumed[o.consumed.length-1].parameters}:c;return{matched:!0,consumedSegments:o.consumed,remainingSegments:e.slice(o.consumed.length),parameters:f,positionalParamSegments:o.posParams??{}}}function $x(i,t,e,n,o="corrected"){if(e.length>0&&function SV(i,t,e){return e.some(n=>Wx(i,t,n)&&Ql(n)!==Gn)}(i,e,n)){const f=new qn(t,function MV(i,t,e,n){const o={};o[Gn]=n,n._sourceSegment=i,n._segmentIndexShift=t.length;for(const c of e)if(""===c.path&&Ql(c)!==Gn){const f=new qn([],{});f._sourceSegment=i,f._segmentIndexShift=t.length,o[Ql(c)]=f}return o}(i,t,n,new qn(e,i.children)));return f._sourceSegment=i,f._segmentIndexShift=t.length,{segmentGroup:f,slicedSegments:[]}}if(0===e.length&&function TV(i,t,e){return e.some(n=>Wx(i,t,n))}(i,e,n)){const f=new qn(i.segments,function EV(i,t,e,n,o,c){const f={};for(const y of n)if(Wx(i,e,y)&&!o[Ql(y)]){const w=new qn([],{});w._sourceSegment=i,w._segmentIndexShift="legacy"===c?i.segments.length:t.length,f[Ql(y)]=w}return{...o,...f}}(i,t,e,n,i.children,o));return f._sourceSegment=i,f._segmentIndexShift=t.length,{segmentGroup:f,slicedSegments:e}}const c=new qn(i.segments,i.children);return c._sourceSegment=i,c._segmentIndexShift=t.length,{segmentGroup:c,slicedSegments:e}}function Wx(i,t,e){return(!(i.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function Bk(i,t,e,n){return!!(Ql(i)===n||n!==Gn&&Wx(t,e,i))&&("**"===i.path||hE(t,i,e).matched)}function zk(i,t,e){return 0===t.length&&!i.children[e]}const Xx=!1;class qx{constructor(t){this.segmentGroup=t||null}}class Vk{constructor(t){this.urlTree=t}}function jy(i){return ag(new qx(i))}function jk(i){return ag(new Vk(i))}class IV{constructor(t,e,n,o,c){this.injector=t,this.configLoader=e,this.urlSerializer=n,this.urlTree=o,this.config=c,this.allowRedirects=!0}apply(){const t=$x(this.urlTree.root,[],[],this.config).segmentGroup,e=new qn(t.segments,t.children);return this.expandSegmentGroup(this.injector,this.config,e,Gn).pipe(Ie(c=>this.createUrlTree(Bx(c),this.urlTree.queryParams,this.urlTree.fragment))).pipe(du(c=>{if(c instanceof Vk)return this.allowRedirects=!1,this.match(c.urlTree);throw c instanceof qx?this.noMatchError(c):c}))}match(t){return this.expandSegmentGroup(this.injector,this.config,t.root,Gn).pipe(Ie(o=>this.createUrlTree(Bx(o),t.queryParams,t.fragment))).pipe(du(o=>{throw o instanceof qx?this.noMatchError(o):o}))}noMatchError(t){return new ti(4002,Xx)}createUrlTree(t,e,n){const o=qC(t);return new sf(o,e,n)}expandSegmentGroup(t,e,n,o){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe(Ie(c=>new qn([],c))):this.expandSegment(t,n,e,n.segments,o,!0)}expandChildren(t,e,n){const o=[];for(const c of Object.keys(n.children))"primary"===c?o.unshift(c):o.push(c);return xr(o).pipe(kd(c=>{const f=n.children[c],y=Rk(e,c);return this.expandSegmentGroup(t,y,f,c).pipe(Ie(w=>({segment:w,outlet:c})))}),JA((c,f)=>(c[f.outlet]=f.segment,c),{}),ek())}expandSegment(t,e,n,o,c,f){return xr(n).pipe(kd(y=>this.expandSegmentAgainstRoute(t,e,n,y,o,c,f).pipe(du(L=>{if(L instanceof qx)return $i(null);throw L}))),Ad(y=>!!y),du((y,w)=>{if(lE(y))return zk(e,o,c)?$i(new qn([],{})):jy(e);throw y}))}expandSegmentAgainstRoute(t,e,n,o,c,f,y){return Bk(o,e,c,f)?void 0===o.redirectTo?this.matchSegmentAgainstRoute(t,e,o,c,f):y&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,o,c,f):jy(e):jy(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,o,c,f){return"**"===o.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,o,f):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,o,c,f)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,o){const c=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?jk(c):this.lineralizeSegments(n,c).pipe(Mt(f=>{const y=new qn(f,{});return this.expandSegment(t,y,e,f,o,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,o,c,f){const{matched:y,consumedSegments:w,remainingSegments:L,positionalParamSegments:le}=hE(e,o,c);if(!y)return jy(e);const ye=this.applyRedirectCommands(w,o.redirectTo,le);return o.redirectTo.startsWith("/")?jk(ye):this.lineralizeSegments(o,ye).pipe(Mt(Be=>this.expandSegment(t,e,n,Be.concat(L),f,!1)))}matchSegmentAgainstRoute(t,e,n,o,c){return"**"===n.path?(t=Ok(n,t),n.loadChildren?(n._loadedRoutes?$i({routes:n._loadedRoutes,injector:n._loadedInjector}):this.configLoader.loadChildren(t,n)).pipe(Ie(y=>(n._loadedRoutes=y.routes,n._loadedInjector=y.injector,new qn(o,{})))):$i(new qn(o,{}))):Nk(e,n,o,t).pipe(Us(({matched:f,consumedSegments:y,remainingSegments:w})=>f?this.getChildConfig(t=n._injector??t,n,o).pipe(Mt(le=>{const ye=le.injector??t,Be=le.routes,{segmentGroup:Xe,slicedSegments:ot}=$x(e,y,w,Be),yt=new qn(Xe.segments,Xe.children);if(0===ot.length&&yt.hasChildren())return this.expandChildren(ye,Be,yt).pipe(Ie(qt=>new qn(y,qt)));if(0===Be.length&&0===ot.length)return $i(new qn(y,{}));const jt=Ql(n)===c;return this.expandSegment(ye,yt,Be,ot,jt?Gn:c,!0).pipe(Ie(fi=>new qn(y.concat(fi.segments),fi.children)))})):jy(e)))}getChildConfig(t,e,n){return e.children?$i({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?$i({routes:e._loadedRoutes,injector:e._loadedInjector}):function wV(i,t,e,n){const o=t.canLoad;return void 0===o||0===o.length?$i(!0):$i(o.map(f=>{const y=dg(f,i);return Id(function lV(i){return i&&Vy(i.canLoad)}(y)?y.canLoad(t,e):i.runInContext(()=>y(t,e)))})).pipe(pg(),Fk())}(t,e,n).pipe(Mt(o=>o?this.configLoader.loadChildren(t,e).pipe(zo(c=>{e._loadedRoutes=c.routes,e._loadedInjector=c.injector})):function AV(i){return ag(kk(Xx,3))}())):$i({routes:[],injector:t})}lineralizeSegments(t,e){let n=[],o=e.root;for(;;){if(n=n.concat(o.segments),0===o.numberOfChildren)return $i(n);if(o.numberOfChildren>1||!o.children[Gn])return ag(new ti(4e3,Xx));o=o.children[Gn]}}applyRedirectCommands(t,e,n){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreateUrlTree(t,e,n,o){const c=this.createSegmentGroup(t,e.root,n,o);return new sf(c,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return Hs(t,(o,c)=>{if("string"==typeof o&&o.startsWith(":")){const y=o.substring(1);n[c]=e[y]}else n[c]=o}),n}createSegmentGroup(t,e,n,o){const c=this.createSegments(t,e.segments,n,o);let f={};return Hs(e.children,(y,w)=>{f[w]=this.createSegmentGroup(t,y,n,o)}),new qn(c,f)}createSegments(t,e,n,o){return e.map(c=>c.path.startsWith(":")?this.findPosParam(t,c,o):this.findOrReturn(c,n))}findPosParam(t,e,n){const o=n[e.path.substring(1)];if(!o)throw new ti(4001,Xx);return o}findOrReturn(t,e){let n=0;for(const o of e){if(o.path===t.path)return e.splice(n),o;n++}return t}}class OV{}class FV{constructor(t,e,n,o,c,f,y,w){this.injector=t,this.rootComponentType=e,this.config=n,this.urlTree=o,this.url=c,this.paramsInheritanceStrategy=f,this.relativeLinkResolution=y,this.urlSerializer=w}recognize(){const t=$x(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,Gn).pipe(Ie(e=>{if(null===e)return null;const n=new Vx([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Gn,this.rootComponentType,null,this.urlTree.root,-1,{}),o=new fu(n,e),c=new Tk(this.url,o);return this.inheritParamsAndData(c._root),c}))}inheritParamsAndData(t){const e=t.value,n=Sk(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(o=>this.inheritParamsAndData(o))}processSegmentGroup(t,e,n,o){return 0===n.segments.length&&n.hasChildren()?this.processChildren(t,e,n):this.processSegment(t,e,n,n.segments,o)}processChildren(t,e,n){return xr(Object.keys(n.children)).pipe(kd(o=>{const c=n.children[o],f=Rk(e,o);return this.processSegmentGroup(t,f,c,o)}),JA((o,c)=>o&&c?(o.push(...c),o):null),tk(o=>null!==o),Ix(null),ek(),Ie(o=>{if(null===o)return null;const c=Uk(o);return function NV(i){i.sort((t,e)=>t.value.outlet===Gn?-1:e.value.outlet===Gn?1:t.value.outlet.localeCompare(e.value.outlet))}(c),c}))}processSegment(t,e,n,o,c){return xr(e).pipe(kd(f=>this.processSegmentAgainstRoute(f._injector??t,f,n,o,c)),Ad(f=>!!f),du(f=>{if(lE(f))return zk(n,o,c)?$i([]):$i(null);throw f}))}processSegmentAgainstRoute(t,e,n,o,c){if(e.redirectTo||!Bk(e,n,o,c))return $i(null);let f;if("**"===e.path){const y=o.length>0?ok(o).parameters:{},w=Gk(n)+o.length;f=$i({snapshot:new Vx(o,y,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Wk(e),Ql(e),e.component??e._loadedComponent??null,e,Hk(n),w,Xk(e),w),consumedSegments:[],remainingSegments:[]})}else f=Nk(n,e,o,t).pipe(Ie(({matched:y,consumedSegments:w,remainingSegments:L,parameters:le})=>{if(!y)return null;const ye=Gk(n)+w.length;return{snapshot:new Vx(w,le,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Wk(e),Ql(e),e.component??e._loadedComponent??null,e,Hk(n),ye,Xk(e),ye),consumedSegments:w,remainingSegments:L}}));return f.pipe(Us(y=>{if(null===y)return $i(null);const{snapshot:w,consumedSegments:L,remainingSegments:le}=y;t=e._injector??t;const ye=e._loadedInjector??t,Be=function BV(i){return i.children?i.children:i.loadChildren?i._loadedRoutes:[]}(e),{segmentGroup:Xe,slicedSegments:ot}=$x(n,L,le,Be.filter(jt=>void 0===jt.redirectTo),this.relativeLinkResolution);if(0===ot.length&&Xe.hasChildren())return this.processChildren(ye,Be,Xe).pipe(Ie(jt=>null===jt?null:[new fu(w,jt)]));if(0===Be.length&&0===ot.length)return $i([new fu(w,[])]);const yt=Ql(e)===c;return this.processSegment(ye,Be,Xe,ot,yt?Gn:c).pipe(Ie(jt=>null===jt?null:[new fu(w,jt)]))}))}}function zV(i){const t=i.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function Uk(i){const t=[],e=new Set;for(const n of i){if(!zV(n)){t.push(n);continue}const o=t.find(c=>n.value.routeConfig===c.value.routeConfig);void 0!==o?(o.children.push(...n.children),e.add(o)):t.push(n)}for(const n of e){const o=Uk(n.children);t.push(new fu(n.value,o))}return t.filter(n=>!e.has(n))}function Hk(i){let t=i;for(;t._sourceSegment;)t=t._sourceSegment;return t}function Gk(i){let t=i,e=t._segmentIndexShift??0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift??0;return e-1}function Wk(i){return i.data||{}}function Xk(i){return i.resolve||{}}function qk(i){return"string"==typeof i.title||null===i.title}function uE(i){return Us(t=>{const e=i(t);return e?xr(e).pipe(Ie(()=>t)):$i(t)})}let Yk=(()=>{class i{buildTitle(e){let n,o=e.root;for(;void 0!==o;)n=this.getResolvedTitleForRoute(o)??n,o=o.children.find(c=>c.outlet===Gn);return n}getResolvedTitleForRoute(e){return e.data[Ay]}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=hi({token:i,factory:function(){return nr(Zk)},providedIn:"root"}),i})(),Zk=(()=>{class i extends Yk{constructor(e){super(),this.title=e}updateTitle(e){const n=this.buildTitle(e);void 0!==n&&this.title.setTitle(n)}}return i.\u0275fac=function(e){return new(e||i)(Pt(GA))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class XV{}class YV extends class qV{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const Zx=new ui("",{providedIn:"root",factory:()=>({})}),dE=new ui("ROUTES");let pE=(()=>{class i{constructor(e,n){this.injector=e,this.compiler=n,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return $i(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const n=Id(e.loadComponent()).pipe(zo(c=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=c}),Px(()=>{this.componentLoaders.delete(e)})),o=new KA(n,()=>new ue).pipe(HC());return this.componentLoaders.set(e,o),o}loadChildren(e,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return $i({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);const c=this.loadModuleFactoryOrRoutes(n.loadChildren).pipe(Ie(y=>{this.onLoadEndListener&&this.onLoadEndListener(n);let w,L,le=!1;Array.isArray(y)?L=y:(w=y.create(e).injector,L=rk(w.get(dE,[],nn.Self|nn.Optional)));return{routes:L.map(aE),injector:w}}),Px(()=>{this.childrenLoaders.delete(n)})),f=new KA(c,()=>new ue).pipe(HC());return this.childrenLoaders.set(n,f),f}loadModuleFactoryOrRoutes(e){return Id(e()).pipe(Mt(n=>n instanceof FT||Array.isArray(n)?$i(n):xr(this.compiler.compileModuleAsync(n))))}}return i.\u0275fac=function(e){return new(e||i)(Pt(Wr),Pt(iC))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class KV{}class QV{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function JV(i){throw i}function ej(i,t,e){return t.parse("/")}const tj={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},ij={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function Qk(){const i=nr(uk),t=nr(Fy),e=nr(xy),n=nr(Wr),o=nr(iC),c=nr(dE,{optional:!0})??[],f=nr(Zx,{optional:!0})??{},y=nr(Zk),w=nr(Yk,{optional:!0}),L=nr(KV,{optional:!0}),le=nr(XV,{optional:!0}),ye=new gs(null,i,t,e,n,o,rk(c));return L&&(ye.urlHandlingStrategy=L),le&&(ye.routeReuseStrategy=le),ye.titleStrategy=w??y,function nj(i,t){i.errorHandler&&(t.errorHandler=i.errorHandler),i.malformedUriErrorHandler&&(t.malformedUriErrorHandler=i.malformedUriErrorHandler),i.onSameUrlNavigation&&(t.onSameUrlNavigation=i.onSameUrlNavigation),i.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=i.paramsInheritanceStrategy),i.relativeLinkResolution&&(t.relativeLinkResolution=i.relativeLinkResolution),i.urlUpdateStrategy&&(t.urlUpdateStrategy=i.urlUpdateStrategy),i.canceledNavigationResolution&&(t.canceledNavigationResolution=i.canceledNavigationResolution)}(f,ye),ye}let gs=(()=>{class i{constructor(e,n,o,c,f,y,w){this.rootComponentType=e,this.urlSerializer=n,this.rootContexts=o,this.location=c,this.config=w,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new ue,this.errorHandler=JV,this.malformedUriErrorHandler=ej,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>$i(void 0),this.urlHandlingStrategy=new QV,this.routeReuseStrategy=new YV,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=f.get(pE),this.configLoader.onLoadEndListener=Be=>this.triggerEvent(new B3(Be)),this.configLoader.onLoadStartListener=Be=>this.triggerEvent(new N3(Be)),this.ngModule=f.get(ef),this.console=f.get(WF);const ye=f.get(En);this.isNgZoneEnabled=ye instanceof En&&En.isInAngularZone(),this.resetConfig(w),this.currentUrlTree=function a3(){return new sf(new qn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Mk(this.currentUrlTree,this.rootComponentType),this.transitions=new Kl({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(e){const n=this.events;return e.pipe(to(o=>0!==o.id),Ie(o=>({...o,extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Us(o=>{let c=!1,f=!1;return $i(o).pipe(zo(y=>{this.currentNavigation={id:y.id,initialUrl:y.rawUrl,extractedUrl:y.extractedUrl,trigger:y.source,extras:y.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Us(y=>{const w=this.browserUrlTree.toString(),L=!this.navigated||y.extractedUrl.toString()!==w||w!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||L)&&this.urlHandlingStrategy.shouldProcessUrl(y.rawUrl))return Jk(y.source)&&(this.browserUrlTree=y.extractedUrl),$i(y).pipe(Us(ye=>{const Be=this.transitions.getValue();return n.next(new QC(ye.id,this.serializeUrl(ye.extractedUrl),ye.source,ye.restoredState)),Be!==this.transitions.getValue()?gi:Promise.resolve(ye)}),function PV(i,t,e,n){return Us(o=>function kV(i,t,e,n,o){return new IV(i,t,e,n,o).apply()}(i,t,e,o.extractedUrl,n).pipe(Ie(c=>({...o,urlAfterRedirects:c}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),zo(ye=>{this.currentNavigation={...this.currentNavigation,finalUrl:ye.urlAfterRedirects},o.urlAfterRedirects=ye.urlAfterRedirects}),function jV(i,t,e,n,o,c){return Mt(f=>function LV(i,t,e,n,o,c,f="emptyOnly",y="legacy"){return new FV(i,t,e,n,o,f,y,c).recognize().pipe(Us(w=>null===w?function RV(i){return new S(t=>t.error(i))}(new OV):$i(w)))}(i,t,e,f.urlAfterRedirects,n.serialize(f.urlAfterRedirects),n,o,c).pipe(Ie(y=>({...f,targetSnapshot:y}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),zo(ye=>{if(o.targetSnapshot=ye.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!ye.extras.skipLocationChange){const Xe=this.urlHandlingStrategy.merge(ye.urlAfterRedirects,ye.rawUrl);this.setBrowserUrl(Xe,ye)}this.browserUrlTree=ye.urlAfterRedirects}const Be=new P3(ye.id,this.serializeUrl(ye.extractedUrl),this.serializeUrl(ye.urlAfterRedirects),ye.targetSnapshot);n.next(Be)}));if(L&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:Be,extractedUrl:Xe,source:ot,restoredState:yt,extras:jt}=y,Gt=new QC(Be,this.serializeUrl(Xe),ot,yt);n.next(Gt);const fi=Mk(Xe,this.rootComponentType).snapshot;return $i(o={...y,targetSnapshot:fi,urlAfterRedirects:Xe,extras:{...jt,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=y.rawUrl,y.resolve(null),gi}),zo(y=>{const w=new O3(y.id,this.serializeUrl(y.extractedUrl),this.serializeUrl(y.urlAfterRedirects),y.targetSnapshot);this.triggerEvent(w)}),Ie(y=>o={...y,guards:nV(y.targetSnapshot,y.currentSnapshot,this.rootContexts)}),function fV(i,t){return Mt(e=>{const{targetSnapshot:n,currentSnapshot:o,guards:{canActivateChecks:c,canDeactivateChecks:f}}=e;return 0===f.length&&0===c.length?$i({...e,guardsResult:!0}):function mV(i,t,e,n){return xr(i).pipe(Mt(o=>function bV(i,t,e,n,o){const c=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return c&&0!==c.length?$i(c.map(y=>{const w=Ny(t)??o,L=dg(y,w);return Id(function uV(i){return i&&Vy(i.canDeactivate)}(L)?L.canDeactivate(i,t,e,n):w.runInContext(()=>L(i,t,e,n))).pipe(Ad())})).pipe(pg()):$i(!0)}(o.component,o.route,e,t,n)),Ad(o=>!0!==o,!0))}(f,n,o,i).pipe(Mt(y=>y&&function aV(i){return"boolean"==typeof i}(y)?function gV(i,t,e,n){return xr(t).pipe(kd(o=>Dy(function yV(i,t){return null!==i&&t&&t(new z3(i)),$i(!0)}(o.route.parent,n),function _V(i,t){return null!==i&&t&&t(new j3(i)),$i(!0)}(o.route,n),function xV(i,t,e){const n=t[t.length-1],c=t.slice(0,t.length-1).reverse().map(f=>function rV(i){const t=i.routeConfig?i.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:i,guards:t}:null}(f)).filter(f=>null!==f).map(f=>sg(()=>$i(f.guards.map(w=>{const L=Ny(f.node)??e,le=dg(w,L);return Id(function hV(i){return i&&Vy(i.canActivateChild)}(le)?le.canActivateChild(n,i):L.runInContext(()=>le(n,i))).pipe(Ad())})).pipe(pg())));return $i(c).pipe(pg())}(i,o.path,e),function vV(i,t,e){const n=t.routeConfig?t.routeConfig.canActivate:null;if(!n||0===n.length)return $i(!0);const o=n.map(c=>sg(()=>{const f=Ny(t)??e,y=dg(c,f);return Id(function cV(i){return i&&Vy(i.canActivate)}(y)?y.canActivate(t,i):f.runInContext(()=>y(t,i))).pipe(Ad())}));return $i(o).pipe(pg())}(i,o.route,e))),Ad(o=>!0!==o,!0))}(n,c,i,t):$i(y)),Ie(y=>({...e,guardsResult:y})))})}(this.ngModule.injector,y=>this.triggerEvent(y)),zo(y=>{if(o.guardsResult=y.guardsResult,lf(y.guardsResult))throw Ak(0,y.guardsResult);const w=new R3(y.id,this.serializeUrl(y.extractedUrl),this.serializeUrl(y.urlAfterRedirects),y.targetSnapshot,!!y.guardsResult);this.triggerEvent(w)}),to(y=>!!y.guardsResult||(this.restoreHistory(y),this.cancelNavigationTransition(y,"",3),!1)),uE(y=>{if(y.guards.canActivateChecks.length)return $i(y).pipe(zo(w=>{const L=new L3(w.id,this.serializeUrl(w.extractedUrl),this.serializeUrl(w.urlAfterRedirects),w.targetSnapshot);this.triggerEvent(L)}),Us(w=>{let L=!1;return $i(w).pipe(function UV(i,t){return Mt(e=>{const{targetSnapshot:n,guards:{canActivateChecks:o}}=e;if(!o.length)return $i(e);let c=0;return xr(o).pipe(kd(f=>function HV(i,t,e,n){const o=i.routeConfig,c=i._resolve;return void 0!==o?.title&&!qk(o)&&(c[Ay]=o.title),function GV(i,t,e,n){const o=function $V(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}(i);if(0===o.length)return $i({});const c={};return xr(o).pipe(Mt(f=>function WV(i,t,e,n){const o=Ny(t)??n,c=dg(i,o);return Id(c.resolve?c.resolve(t,e):o.runInContext(()=>c(t,e)))}(i[f],t,e,n).pipe(Ad(),zo(y=>{c[f]=y}))),GC(1),ik(c),du(f=>lE(f)?gi:ag(f)))}(c,i,t,n).pipe(Ie(f=>(i._resolvedData=f,i.data=Sk(i,e).resolve,o&&qk(o)&&(i.data[Ay]=o.title),null)))}(f.route,n,i,t)),zo(()=>c++),GC(1),Mt(f=>c===o.length?$i(e):gi))})}(this.paramsInheritanceStrategy,this.ngModule.injector),zo({next:()=>L=!0,complete:()=>{L||(this.restoreHistory(w),this.cancelNavigationTransition(w,"",2))}}))}),zo(w=>{const L=new F3(w.id,this.serializeUrl(w.extractedUrl),this.serializeUrl(w.urlAfterRedirects),w.targetSnapshot);this.triggerEvent(L)}))}),uE(y=>{const w=L=>{const le=[];L.routeConfig?.loadComponent&&!L.routeConfig._loadedComponent&&le.push(this.configLoader.loadComponent(L.routeConfig).pipe(zo(ye=>{L.component=ye}),Ie(()=>{})));for(const ye of L.children)le.push(...w(ye));return le};return UC(w(y.targetSnapshot.root)).pipe(Ix(),eo(1))}),uE(()=>this.afterPreactivation()),Ie(y=>{const w=function W3(i,t,e){const n=Ly(i,t._root,e?e._root:void 0);return new Ek(n,t)}(this.routeReuseStrategy,y.targetSnapshot,y.currentRouterState);return o={...y,targetRouterState:w}}),zo(y=>{this.currentUrlTree=y.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(y.urlAfterRedirects,y.rawUrl),this.routerState=y.targetRouterState,"deferred"===this.urlUpdateStrategy&&(y.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,y),this.browserUrlTree=y.urlAfterRedirects)}),((i,t,e)=>Ie(n=>(new iV(t,n.targetRouterState,n.currentRouterState,e).activate(i),n)))(this.rootContexts,this.routeReuseStrategy,y=>this.triggerEvent(y)),zo({next(){c=!0},complete(){c=!0}}),Px(()=>{c||f||this.cancelNavigationTransition(o,"",1),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),du(y=>{if(f=!0,Pk(y)){Ik(y)||(this.navigated=!0,this.restoreHistory(o,!0));const w=new zx(o.id,this.serializeUrl(o.extractedUrl),y.message,y.cancellationCode);if(n.next(w),Ik(y)){const L=this.urlHandlingStrategy.merge(y.url,this.rawUrlTree),le={skipLocationChange:o.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Jk(o.source)};this.scheduleNavigation(L,"imperative",null,le,{resolve:o.resolve,reject:o.reject,promise:o.promise})}else o.resolve(!1)}else{this.restoreHistory(o,!0);const w=new bk(o.id,this.serializeUrl(o.extractedUrl),y,o.targetSnapshot??void 0);n.next(w);try{o.resolve(this.errorHandler(y))}catch(L){o.reject(L)}}return gi}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next({...this.transitions.value,...e})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const n="popstate"===e.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{const o={replaceUrl:!0},c=e.state?.navigationId?e.state:null;if(c){const y={...c};delete y.navigationId,delete y.\u0275routerPageId,0!==Object.keys(y).length&&(o.state=y)}const f=this.parseUrl(e.url);this.scheduleNavigation(f,n,c,o)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){this.config=e.map(aE),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,n={}){const{relativeTo:o,queryParams:c,fragment:f,queryParamsHandling:y,preserveFragment:w}=n,L=o||this.routerState.root,le=w?this.currentUrlTree.fragment:f;let ye=null;switch(y){case"merge":ye={...this.currentUrlTree.queryParams,...c};break;case"preserve":ye=this.currentUrlTree.queryParams;break;default:ye=c||null}return null!==ye&&(ye=this.removeEmptyProps(ye)),S3(L,this.currentUrlTree,e,ye,le??null)}navigateByUrl(e,n={skipLocationChange:!1}){const o=lf(e)?e:this.parseUrl(e),c=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(c,"imperative",null,n)}navigate(e,n={skipLocationChange:!1}){return function rj(i){for(let t=0;t<i.length;t++){if(null==i[t])throw new ti(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,n),n)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let n;try{n=this.urlSerializer.parse(e)}catch(o){n=this.malformedUriErrorHandler(o,this.urlSerializer,e)}return n}isActive(e,n){let o;if(o=!0===n?{...tj}:!1===n?{...ij}:n,lf(e))return ak(this.currentUrlTree,e,o);const c=this.parseUrl(e);return ak(this.currentUrlTree,c,o)}removeEmptyProps(e){return Object.keys(e).reduce((n,o)=>{const c=e[o];return null!=c&&(n[o]=c),n},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new cf(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,n,o,c,f){if(this.disposed)return Promise.resolve(!1);let y,w,L;f?(y=f.resolve,w=f.reject,L=f.promise):L=new Promise((Be,Xe)=>{y=Be,w=Xe});const le=++this.navigationId;let ye;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(o=this.location.getState()),ye=o&&o.\u0275routerPageId?o.\u0275routerPageId:c.replaceUrl||c.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):ye=0,this.setTransition({id:le,targetPageId:ye,source:n,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:c,resolve:y,reject:w,promise:L,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),L.catch(Be=>Promise.reject(Be))}setBrowserUrl(e,n){const o=this.urlSerializer.serialize(e),c={...n.extras.state,...this.generateNgRouterState(n.id,n.targetPageId)};this.location.isCurrentPathEqualTo(o)||n.extras.replaceUrl?this.location.replaceState(o,"",c):this.location.go(o,"",c)}restoreHistory(e,n=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===o?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===o&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(o)}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,n,o){const c=new zx(e.id,this.serializeUrl(e.extractedUrl),n,o);this.triggerEvent(c),e.resolve(!1)}generateNgRouterState(e,n){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:n}:{navigationId:e}}}return i.\u0275fac=function(e){iu()},i.\u0275prov=hi({token:i,factory:function(){return Qk()},providedIn:"root"}),i})();function Jk(i){return"imperative"!==i}let Uy=(()=>{class i{constructor(e,n,o,c,f){this.router=e,this.route=n,this.tabIndexAttribute=o,this.renderer=c,this.el=f,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.onChanges=new ue,this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=cu(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=cu(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=cu(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){if(null!=this.tabIndexAttribute)return;const n=this.renderer,o=this.el.nativeElement;null!==e?n.setAttribute(o,"tabindex",e):n.removeAttribute(o,"tabindex")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){return null===this.urlTree||this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return i.\u0275fac=function(e){return new(e||i)(ft(gs),ft(Pd),po("tabindex"),ft(Hl),ft(Zn))},i.\u0275dir=ci({type:i,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,n){1&e&&Rn("click",function(){return n.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[no]}),i})(),fE=(()=>{class i{constructor(e,n,o){this.router=e,this.route=n,this.locationStrategy=o,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.href=null,this.onChanges=new ue,this.subscription=e.events.subscribe(c=>{c instanceof cf&&this.updateTargetUrlAndHref()})}set preserveFragment(e){this._preserveFragment=cu(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=cu(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=cu(e)}get replaceUrl(){return this._replaceUrl}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:null}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,n,o,c,f){return!!(0!==e||n||o||c||f||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!1)}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return i.\u0275fac=function(e){return new(e||i)(ft(gs),ft(Pd),ft(nf))},i.\u0275dir=ci({type:i,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,n){1&e&&Rn("click",function(c){return n.onClick(c.button,c.ctrlKey,c.shiftKey,c.altKey,c.metaKey)}),2&e&&Ir("target",n.target)("href",n.href,Jf)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[no]}),i})(),mE=(()=>{class i{constructor(e,n,o,c,f,y){this.router=e,this.element=n,this.renderer=o,this.cdr=c,this.link=f,this.linkWithHref=y,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new Fn,this.routerEventsSubscription=e.events.subscribe(w=>{w instanceof cf&&this.update()})}ngAfterContentInit(){$i(this.links.changes,this.linksWithHrefs.changes,$i(null)).pipe(Yt()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const e=[...this.links.toArray(),...this.linksWithHrefs.toArray(),this.link,this.linkWithHref].filter(n=>!!n).map(n=>n.onChanges);this.linkInputChangesSubscription=xr(e).pipe(Yt()).subscribe(n=>{this.isActive!==this.isLinkActive(this.router)(n)&&this.update()})}set routerLinkActive(e){const n=Array.isArray(e)?e:e.split(" ");this.classes=n.filter(o=>!!o)}ngOnChanges(e){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.linksWithHrefs||!this.router.navigated||Promise.resolve().then(()=>{const e=this.hasActiveLinks();this.isActive!==e&&(this.isActive=e,this.cdr.markForCheck(),this.classes.forEach(n=>{e?this.renderer.addClass(this.element.nativeElement,n):this.renderer.removeClass(this.element.nativeElement,n)}),e&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(e))})}isLinkActive(e){const n=function oj(i){return!!i.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return o=>!!o.urlTree&&e.isActive(o.urlTree,n)}hasActiveLinks(){const e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.linkWithHref&&e(this.linkWithHref)||this.links.some(e)||this.linksWithHrefs.some(e)}}return i.\u0275fac=function(e){return new(e||i)(ft(gs),ft(Zn),ft(Hl),ft(Wa),ft(Uy,8),ft(fE,8))},i.\u0275dir=ci({type:i,selectors:[["","routerLinkActive",""]],contentQueries:function(e,n,o){if(1&e&&(Ds(o,Uy,5),Ds(o,fE,5)),2&e){let c;Dr(c=Ar())&&(n.links=c),Dr(c=Ar())&&(n.linksWithHrefs=c)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[no]}),i})();class eI{}let sj=(()=>{class i{constructor(e,n,o,c,f){this.router=e,this.injector=o,this.preloadingStrategy=c,this.loader=f}setUpPreloading(){this.subscription=this.router.events.pipe(to(e=>e instanceof cf),kd(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,n){const o=[];for(const c of n){c.providers&&!c._injector&&(c._injector=ix(c.providers,e,`Route: ${c.path}`));const f=c._injector??e,y=c._loadedInjector??f;c.loadChildren&&!c._loadedRoutes&&void 0===c.canLoad||c.loadComponent&&!c._loadedComponent?o.push(this.preloadConfig(f,c)):(c.children||c._loadedRoutes)&&o.push(this.processRoutes(y,c.children??c._loadedRoutes))}return xr(o).pipe(Yt())}preloadConfig(e,n){return this.preloadingStrategy.preload(n,()=>{let o;o=n.loadChildren&&void 0===n.canLoad?this.loader.loadChildren(e,n):$i(null);const c=o.pipe(Mt(f=>null===f?$i(void 0):(n._loadedRoutes=f.routes,n._loadedInjector=f.injector,this.processRoutes(f.injector??e,f.routes))));return n.loadComponent&&!n._loadedComponent?xr([c,this.loader.loadComponent(n)]).pipe(Yt()):c})}}return i.\u0275fac=function(e){return new(e||i)(Pt(gs),Pt(iC),Pt(Ul),Pt(eI),Pt(pE))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const gE=new ui("");let tI=(()=>{class i{constructor(e,n,o={}){this.router=e,this.viewportScroller=n,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof QC?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof cf&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof wk&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,n){this.router.triggerEvent(new wk(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return i.\u0275fac=function(e){iu()},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})();function fg(i,t){return{\u0275kind:i,\u0275providers:t}}function _E(i){return[{provide:dE,multi:!0,useValue:i}]}function nI(){const i=nr(Wr);return t=>{const e=i.get(og);if(t!==e.components[0])return;const n=i.get(gs),o=i.get(rI);1===i.get(yE)&&n.initialNavigation(),i.get(oI,null,nn.Optional)?.setUpPreloading(),i.get(gE,null,nn.Optional)?.init(),n.resetRootComponentType(e.componentTypes[0]),o.next(),o.complete()}}const rI=new ui("",{factory:()=>new ue}),yE=new ui("",{providedIn:"root",factory:()=>1});const oI=new ui("");function hj(i){return fg(0,[{provide:oI,useExisting:sj},{provide:eI,useExisting:i}])}const sI=new ui("ROUTER_FORROOT_GUARD"),uj=[xy,{provide:uk,useClass:WC},{provide:gs,useFactory:Qk},Fy,{provide:Pd,useFactory:function iI(i){return i.routerState.root},deps:[gs]},pE];function dj(){return new PD("Router",gs)}let aI=(()=>{class i{constructor(e){}static forRoot(e,n){return{ngModule:i,providers:[uj,[],_E(e),{provide:sI,useFactory:gj,deps:[[gs,new xa,new Uh]]},{provide:Zx,useValue:n||{}},n?.useHash?{provide:nf,useClass:RN}:{provide:nf,useClass:nA},{provide:gE,useFactory:()=>{const i=nr(gs),t=nr(ZB),e=nr(Zx);return e.scrollOffset&&t.setOffset(e.scrollOffset),new tI(i,t,e)}},n?.preloadingStrategy?hj(n.preloadingStrategy).\u0275providers:[],{provide:PD,multi:!0,useFactory:dj},n?.initialNavigation?_j(n):[],[{provide:lI,useFactory:nI},{provide:MD,multi:!0,useExisting:lI}]]}}static forChild(e){return{ngModule:i,providers:[_E(e)]}}}return i.\u0275fac=function(e){return new(e||i)(Pt(sI,8))},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[oE]}),i})();function gj(i){return"guarded"}function _j(i){return["disabled"===i.initialNavigation?fg(3,[{provide:sx,multi:!0,useFactory:()=>{const t=nr(gs);return()=>{t.setUpLocationChangeListener()}}},{provide:yE,useValue:2}]).\u0275providers:[],"enabledBlocking"===i.initialNavigation?fg(2,[{provide:yE,useValue:0},{provide:sx,multi:!0,deps:[Wr],useFactory:t=>{const e=t.get(PN,Promise.resolve());let n=!1;return()=>e.then(()=>new Promise(c=>{const f=t.get(gs),y=t.get(rI);(function o(c){t.get(gs).events.pipe(to(y=>y instanceof cf||y instanceof zx||y instanceof bk),Ie(y=>y instanceof cf||y instanceof zx&&(0===y.code||1===y.code)&&null),to(y=>null!==y),eo(1)).subscribe(()=>{c()})})(()=>{c(!0),n=!0}),f.afterPreactivation=()=>(c(!0),n||y.closed?$i(void 0):y),f.initialNavigation()}))}}]).\u0275providers:[]]}const lI=new ui("");function cI(i,t,e,n,o,c,f){try{var y=i[c](f),w=y.value}catch(L){return void e(L)}y.done?t(w):Promise.resolve(w).then(n,o)}var Od=Is(470);function hI(...i){const t=Yi(i),{args:e,keys:n}=qA(i),o=new S(c=>{const{length:f}=e;if(!f)return void c.complete();const y=new Array(f);let w=f,L=f;for(let le=0;le<f;le++){let ye=!1;_o(e[le]).subscribe(de(c,Be=>{ye||(ye=!0,L--),y[le]=Be},()=>w--,void 0,()=>{(!w||!ye)&&(L||c.next(n?YA(n,y):y),c.complete())}))}});return t?o.pipe(jC(t)):o}let uI=(()=>{class i{constructor(e,n){this._renderer=e,this._elementRef=n,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(e,n){this._renderer.setProperty(this._elementRef.nativeElement,e,n)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return i.\u0275fac=function(e){return new(e||i)(ft(Hl),ft(Zn))},i.\u0275dir=ci({type:i}),i})(),hf=(()=>{class i extends uI{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Hn(i)))(n||i)}}(),i.\u0275dir=ci({type:i,features:[en]}),i})();const Jl=new ui("NgValueAccessor"),bj={provide:Jl,useExisting:On(()=>vE),multi:!0},Cj=new ui("CompositionEventMode");let vE=(()=>{class i extends uI{constructor(e,n,o){super(e,n),this._compositionMode=o,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function wj(){const i=_h()?_h().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return i.\u0275fac=function(e){return new(e||i)(ft(Hl),ft(Zn),ft(Cj,8))},i.\u0275dir=ci({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,n){1&e&&Rn("input",function(c){return n._handleInput(c.target.value)})("blur",function(){return n.onTouched()})("compositionstart",function(){return n._compositionStart()})("compositionend",function(c){return n._compositionEnd(c.target.value)})},features:[Tr([bj]),en]}),i})();function Rd(i){return null==i||("string"==typeof i||Array.isArray(i))&&0===i.length}function pI(i){return null!=i&&"number"==typeof i.length}const Gs=new ui("NgValidators"),Ld=new ui("NgAsyncValidators"),Mj=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class fI{static min(t){return function mI(i){return t=>{if(Rd(t.value)||Rd(i))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<i?{min:{min:i,actual:t.value}}:null}}(t)}static max(t){return function gI(i){return t=>{if(Rd(t.value)||Rd(i))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>i?{max:{max:i,actual:t.value}}:null}}(t)}static required(t){return function _I(i){return Rd(i.value)?{required:!0}:null}(t)}static requiredTrue(t){return function yI(i){return!0===i.value?null:{required:!0}}(t)}static email(t){return function vI(i){return Rd(i.value)||Mj.test(i.value)?null:{email:!0}}(t)}static minLength(t){return function xI(i){return t=>Rd(t.value)||!pI(t.value)?null:t.value.length<i?{minlength:{requiredLength:i,actualLength:t.value.length}}:null}(t)}static maxLength(t){return function bI(i){return t=>pI(t.value)&&t.value.length>i?{maxlength:{requiredLength:i,actualLength:t.value.length}}:null}(t)}static pattern(t){return function wI(i){if(!i)return eb;let t,e;return"string"==typeof i?(e="","^"!==i.charAt(0)&&(e+="^"),e+=i,"$"!==i.charAt(i.length-1)&&(e+="$"),t=new RegExp(e)):(e=i.toString(),t=i),n=>{if(Rd(n.value))return null;const o=n.value;return t.test(o)?null:{pattern:{requiredPattern:e,actualValue:o}}}}(t)}static nullValidator(t){return null}static compose(t){return DI(t)}static composeAsync(t){return AI(t)}}function eb(i){return null}function CI(i){return null!=i}function EI(i){return cy(i)?xr(i):i}function MI(i){let t={};return i.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function SI(i,t){return t.map(e=>e(i))}function TI(i){return i.map(t=>function Sj(i){return!i.validate}(t)?t:e=>t.validate(e))}function DI(i){if(!i)return null;const t=i.filter(CI);return 0==t.length?null:function(e){return MI(SI(e,t))}}function xE(i){return null!=i?DI(TI(i)):null}function AI(i){if(!i)return null;const t=i.filter(CI);return 0==t.length?null:function(e){return hI(SI(e,t).map(EI)).pipe(Ie(MI))}}function bE(i){return null!=i?AI(TI(i)):null}function kI(i,t){return null===i?[t]:Array.isArray(i)?[...i,t]:[i,t]}function II(i){return i._rawValidators}function PI(i){return i._rawAsyncValidators}function wE(i){return i?Array.isArray(i)?i:[i]:[]}function tb(i,t){return Array.isArray(i)?i.includes(t):i===t}function OI(i,t){const e=wE(t);return wE(i).forEach(o=>{tb(e,o)||e.push(o)}),e}function RI(i,t){return wE(t).filter(e=>!tb(i,e))}class LI{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=xE(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=bE(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class Da extends LI{get formDirective(){return null}get path(){return null}}class vh extends LI{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}let NI=(()=>{class i extends class FI{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}{constructor(e){super(e)}}return i.\u0275fac=function(e){return new(e||i)(ft(vh,2))},i.\u0275dir=ci({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,n){2&e&&fs("ng-untouched",n.isUntouched)("ng-touched",n.isTouched)("ng-pristine",n.isPristine)("ng-dirty",n.isDirty)("ng-valid",n.isValid)("ng-invalid",n.isInvalid)("ng-pending",n.isPending)},features:[en]}),i})();const Hy="VALID",nb="INVALID",mg="PENDING",Gy="DISABLED";function SE(i){return(rb(i)?i.validators:i)||null}function zI(i){return Array.isArray(i)?xE(i):i||null}function TE(i,t){return(rb(t)?t.asyncValidators:i)||null}function VI(i){return Array.isArray(i)?bE(i):i||null}function rb(i){return null!=i&&!Array.isArray(i)&&"object"==typeof i}class HI{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=zI(this._rawValidators),this._composedAsyncValidatorFn=VI(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===Hy}get invalid(){return this.status===nb}get pending(){return this.status==mg}get disabled(){return this.status===Gy}get enabled(){return this.status!==Gy}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=zI(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=VI(t)}addValidators(t){this.setValidators(OI(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(OI(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(RI(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(RI(t,this._rawAsyncValidators))}hasValidator(t){return tb(this._rawValidators,t)}hasAsyncValidator(t){return tb(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=mg,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Gy,this.errors=null,this._forEachChild(n=>{n.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(n=>n(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Hy,this._forEachChild(n=>{n.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Hy||this.status===mg)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Gy:Hy}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=mg,this._hasOwnPendingAsyncValidator=!0;const e=EI(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((n,o)=>n&&n._find(o),this)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Fn,this.statusChanges=new Fn}_calculateStatus(){return this._allControlsDisabled()?Gy:this.errors?nb:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(mg)?mg:this._anyControlsHaveStatus(nb)?nb:Hy}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){rb(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}}class ob extends HI{constructor(t,e,n){super(SE(e),TE(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,n={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){(function UI(i,t,e){i._forEachChild((n,o)=>{if(void 0===e[o])throw new ti(1002,"")})})(this,0,t),Object.keys(t).forEach(n=>{(function jI(i,t,e){const n=i.controls;if(!(t?Object.keys(n):n).length)throw new ti(1e3,"");if(!n[e])throw new ti(1001,"")})(this,!0,n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(n=>{const o=this.controls[n];o&&o.patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((n,o)=>{n.reset(t[o],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,n)=>!!n._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const n=this.controls[e];n&&t(n,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,n]of Object.entries(this.controls))if(this.contains(e)&&t(n))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,n,o)=>((n.enabled||this.disabled)&&(e[o]=n.value),e))}_reduceChildren(t,e){let n=t;return this._forEachChild((o,c)=>{n=e(n,o,c)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}function $y(i,t){DE(i,t),t.valueAccessor.writeValue(i.value),i.disabled&&t.valueAccessor.setDisabledState?.(!0),function Fj(i,t){t.valueAccessor.registerOnChange(e=>{i._pendingValue=e,i._pendingChange=!0,i._pendingDirty=!0,"change"===i.updateOn&&GI(i,t)})}(i,t),function Bj(i,t){const e=(n,o)=>{t.valueAccessor.writeValue(n),o&&t.viewToModelUpdate(n)};i.registerOnChange(e),t._registerOnDestroy(()=>{i._unregisterOnChange(e)})}(i,t),function Nj(i,t){t.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,"blur"===i.updateOn&&i._pendingChange&&GI(i,t),"submit"!==i.updateOn&&i.markAsTouched()})}(i,t),function Lj(i,t){if(t.valueAccessor.setDisabledState){const e=n=>{t.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(e),t._registerOnDestroy(()=>{i._unregisterOnDisabledChange(e)})}}(i,t)}function ab(i,t,e=!0){const n=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),cb(i,t),i&&(t._invokeOnDestroyCallbacks(),i._registerOnCollectionChange(()=>{}))}function lb(i,t){i.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function DE(i,t){const e=II(i);null!==t.validator?i.setValidators(kI(e,t.validator)):"function"==typeof e&&i.setValidators([e]);const n=PI(i);null!==t.asyncValidator?i.setAsyncValidators(kI(n,t.asyncValidator)):"function"==typeof n&&i.setAsyncValidators([n]);const o=()=>i.updateValueAndValidity();lb(t._rawValidators,o),lb(t._rawAsyncValidators,o)}function cb(i,t){let e=!1;if(null!==i){if(null!==t.validator){const o=II(i);if(Array.isArray(o)&&o.length>0){const c=o.filter(f=>f!==t.validator);c.length!==o.length&&(e=!0,i.setValidators(c))}}if(null!==t.asyncValidator){const o=PI(i);if(Array.isArray(o)&&o.length>0){const c=o.filter(f=>f!==t.asyncValidator);c.length!==o.length&&(e=!0,i.setAsyncValidators(c))}}}const n=()=>{};return lb(t._rawValidators,n),lb(t._rawAsyncValidators,n),e}function GI(i,t){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function $I(i,t){DE(i,t)}function AE(i,t){if(!i.hasOwnProperty("model"))return!1;const e=i.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}function XI(i,t){i._syncPendingControls(),t.forEach(e=>{const n=e.control;"submit"===n.updateOn&&n._pendingChange&&(e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function kE(i,t){if(!t)return null;let e,n,o;return Array.isArray(t),t.forEach(c=>{c.constructor===vE?e=c:function jj(i){return Object.getPrototypeOf(i.constructor)===hf}(c)?n=c:o=c}),o||n||e||null}const Hj={provide:Da,useExisting:On(()=>Xy)},Wy=(()=>Promise.resolve())();let Xy=(()=>{class i extends Da{constructor(e,n){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new Fn,this.form=new ob({},xE(e),bE(n))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Wy.then(()=>{const n=this._findContainer(e.path);e.control=n.registerControl(e.name,e.control),$y(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Wy.then(()=>{const n=this._findContainer(e.path);n&&n.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Wy.then(()=>{const n=this._findContainer(e.path),o=new ob({});$I(o,e),n.registerControl(e.name,o),o.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Wy.then(()=>{const n=this._findContainer(e.path);n&&n.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,n){Wy.then(()=>{this.form.get(e.path).setValue(n)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,XI(this.form,this._directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return i.\u0275fac=function(e){return new(e||i)(ft(Gs,10),ft(Ld,10))},i.\u0275dir=ci({type:i,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,n){1&e&&Rn("submit",function(c){return n.onSubmit(c)})("reset",function(){return n.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Tr([Hj]),en]}),i})();function qI(i,t){const e=i.indexOf(t);e>-1&&i.splice(e,1)}function YI(i){return"object"==typeof i&&null!==i&&2===Object.keys(i).length&&"value"in i&&"disabled"in i}const hb=class extends HI{constructor(t=null,e,n){super(SE(e),TE(n,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),rb(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=YI(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){qI(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){qI(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){YI(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},Wj={provide:vh,useExisting:On(()=>IE)},QI=(()=>Promise.resolve())();let IE=(()=>{class i extends vh{constructor(e,n,o,c,f){super(),this._changeDetectorRef=f,this.control=new hb,this._registered=!1,this.update=new Fn,this._parent=e,this._setValidators(n),this._setAsyncValidators(o),this.valueAccessor=kE(0,c)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const n=e.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),AE(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){$y(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){QI.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const n=e.isDisabled.currentValue,o=0!==n&&cu(n);QI.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?function sb(i,t){return[...t.path,i]}(e,this._parent):[e]}}return i.\u0275fac=function(e){return new(e||i)(ft(Da,9),ft(Gs,10),ft(Ld,10),ft(Jl,10),ft(Wa,8))},i.\u0275dir=ci({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Tr([Wj]),en,no]}),i})(),eP=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({}),i})();const PE=new ui("NgModelWithFormControlWarning"),Qj={provide:vh,useExisting:On(()=>OE)};let OE=(()=>{class i extends vh{constructor(e,n,o,c){super(),this._ngModelWarningConfig=c,this.update=new Fn,this._ngModelWarningSent=!1,this._setValidators(e),this._setAsyncValidators(n),this.valueAccessor=kE(0,o)}set isDisabled(e){}ngOnChanges(e){if(this._isControlChanged(e)){const n=e.form.previousValue;n&&ab(n,this,!1),$y(this.form,this),this.form.updateValueAndValidity({emitEvent:!1})}AE(e,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&ab(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_isControlChanged(e){return e.hasOwnProperty("form")}}return i._ngModelWarningSentOnce=!1,i.\u0275fac=function(e){return new(e||i)(ft(Gs,10),ft(Ld,10),ft(Jl,10),ft(PE,8))},i.\u0275dir=ci({type:i,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[Tr([Qj]),en,no]}),i})();const Jj={provide:Da,useExisting:On(()=>qy)};let qy=(()=>{class i extends Da{constructor(e,n){super(),this.validators=e,this.asyncValidators=n,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Fn,this._setValidators(e),this._setAsyncValidators(n)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(cb(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const n=this.form.get(e.path);return $y(n,e),n.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),n}getControl(e){return this.form.get(e.path)}removeControl(e){ab(e.control||null,e,!1),function Uj(i,t){const e=i.indexOf(t);e>-1&&i.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,n){this.form.get(e.path).setValue(n)}onSubmit(e){return this.submitted=!0,XI(this.form,this.directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const n=e.control,o=this.form.get(e.path);n!==o&&(ab(n||null,e),(i=>i instanceof hb)(o)&&($y(o,e),e.control=o))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const n=this.form.get(e.path);$I(n,e),n.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const n=this.form.get(e.path);n&&function zj(i,t){return cb(i,t)}(n,e)&&n.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){DE(this.form,this),this._oldForm&&cb(this._oldForm,this)}_checkFormPresent(){}}return i.\u0275fac=function(e){return new(e||i)(ft(Gs,10),ft(Ld,10))},i.\u0275dir=ci({type:i,selectors:[["","formGroup",""]],hostBindings:function(e,n){1&e&&Rn("submit",function(c){return n.onSubmit(c)})("reset",function(){return n.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Tr([Jj]),en,no]}),i})(),mP=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[eP]}),i})(),_5=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[mP]}),i})(),y5=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:PE,useValue:e.warnOnNgModelWithFormControl}]}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[mP]}),i})();class gP{}class _P{}class mu{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const n=e.indexOf(":");if(n>0){const o=e.slice(0,n),c=o.toLowerCase(),f=e.slice(n+1).trim();this.maybeSetNormalizedName(o,c),this.headers.has(c)?this.headers.get(c).push(f):this.headers.set(c,[f])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let n=t[e];const o=e.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(o,n),this.maybeSetNormalizedName(e,o))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof mu?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new mu;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof mu?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);const o=("a"===t.op?this.headers.get(e):void 0)||[];o.push(...n),this.headers.set(e,o);break;case"d":const c=t.value;if(c){let f=this.headers.get(e);if(!f)return;f=f.filter(y=>-1===c.indexOf(y)),0===f.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,f)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class x5{encodeKey(t){return yP(t)}encodeValue(t){return yP(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const w5=/%(\d[a-f0-9])/gi,C5={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function yP(i){return encodeURIComponent(i).replace(w5,(t,e)=>C5[e]??t)}function ub(i){return`${i}`}class Fd{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new x5,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function b5(i,t){const e=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(o=>{const c=o.indexOf("="),[f,y]=-1==c?[t.decodeKey(o),""]:[t.decodeKey(o.slice(0,c)),t.decodeValue(o.slice(c+1))],w=e.get(f)||[];w.push(y),e.set(f,w)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const n=t.fromObject[e],o=Array.isArray(n)?n.map(ub):[ub(n)];this.map.set(e,o)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(n=>{const o=t[n];Array.isArray(o)?o.forEach(c=>{e.push({param:n,value:c,op:"a"})}):e.push({param:n,value:o,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(n=>e+"="+this.encoder.encodeValue(n)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new Fd({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(ub(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let n=this.map.get(t.param)||[];const o=n.indexOf(ub(t.value));-1!==o&&n.splice(o,1),n.length>0?this.map.set(t.param,n):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class E5{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function vP(i){return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer}function xP(i){return typeof Blob<"u"&&i instanceof Blob}function bP(i){return typeof FormData<"u"&&i instanceof FormData}class Yy{constructor(t,e,n,o){let c;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function M5(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||o?(this.body=void 0!==n?n:null,c=o):c=n,c&&(this.reportProgress=!!c.reportProgress,this.withCredentials=!!c.withCredentials,c.responseType&&(this.responseType=c.responseType),c.headers&&(this.headers=c.headers),c.context&&(this.context=c.context),c.params&&(this.params=c.params)),this.headers||(this.headers=new mu),this.context||(this.context=new E5),this.params){const f=this.params.toString();if(0===f.length)this.urlWithParams=e;else{const y=e.indexOf("?");this.urlWithParams=e+(-1===y?"?":y<e.length-1?"&":"")+f}}else this.params=new Fd,this.urlWithParams=e}serializeBody(){return null===this.body?null:vP(this.body)||xP(this.body)||bP(this.body)||function S5(i){return typeof URLSearchParams<"u"&&i instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Fd?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||bP(this.body)?null:xP(this.body)?this.body.type||null:vP(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Fd?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,n=t.url||this.url,o=t.responseType||this.responseType,c=void 0!==t.body?t.body:this.body,f=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,y=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let w=t.headers||this.headers,L=t.params||this.params;const le=t.context??this.context;return void 0!==t.setHeaders&&(w=Object.keys(t.setHeaders).reduce((ye,Be)=>ye.set(Be,t.setHeaders[Be]),w)),t.setParams&&(L=Object.keys(t.setParams).reduce((ye,Be)=>ye.set(Be,t.setParams[Be]),L)),new Yy(e,n,c,{params:L,headers:w,context:le,reportProgress:y,responseType:o,withCredentials:f})}}var Jo=(()=>((Jo=Jo||{})[Jo.Sent=0]="Sent",Jo[Jo.UploadProgress=1]="UploadProgress",Jo[Jo.ResponseHeader=2]="ResponseHeader",Jo[Jo.DownloadProgress=3]="DownloadProgress",Jo[Jo.Response=4]="Response",Jo[Jo.User=5]="User",Jo))();class VE{constructor(t,e=200,n="OK"){this.headers=t.headers||new mu,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class jE extends VE{constructor(t={}){super(t),this.type=Jo.ResponseHeader}clone(t={}){return new jE({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class db extends VE{constructor(t={}){super(t),this.type=Jo.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new db({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class wP extends VE{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function UE(i,t){return{body:t,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials}}let pb=(()=>{class i{constructor(e){this.handler=e}request(e,n,o={}){let c;if(e instanceof Yy)c=e;else{let w,L;w=o.headers instanceof mu?o.headers:new mu(o.headers),o.params&&(L=o.params instanceof Fd?o.params:new Fd({fromObject:o.params})),c=new Yy(e,n,void 0!==o.body?o.body:null,{headers:w,context:o.context,params:L,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials})}const f=$i(c).pipe(kd(w=>this.handler.handle(w)));if(e instanceof Yy||"events"===o.observe)return f;const y=f.pipe(to(w=>w instanceof db));switch(o.observe||"body"){case"body":switch(c.responseType){case"arraybuffer":return y.pipe(Ie(w=>{if(null!==w.body&&!(w.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return w.body}));case"blob":return y.pipe(Ie(w=>{if(null!==w.body&&!(w.body instanceof Blob))throw new Error("Response is not a Blob.");return w.body}));case"text":return y.pipe(Ie(w=>{if(null!==w.body&&"string"!=typeof w.body)throw new Error("Response is not a string.");return w.body}));default:return y.pipe(Ie(w=>w.body))}case"response":return y;default:throw new Error(`Unreachable: unhandled observe type ${o.observe}}`)}}delete(e,n={}){return this.request("DELETE",e,n)}get(e,n={}){return this.request("GET",e,n)}head(e,n={}){return this.request("HEAD",e,n)}jsonp(e,n){return this.request("JSONP",e,{params:(new Fd).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,n={}){return this.request("OPTIONS",e,n)}patch(e,n,o={}){return this.request("PATCH",e,UE(o,n))}post(e,n,o={}){return this.request("POST",e,UE(o,n))}put(e,n,o={}){return this.request("PUT",e,UE(o,n))}}return i.\u0275fac=function(e){return new(e||i)(Pt(gP))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})();class CP{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const EP=new ui("HTTP_INTERCEPTORS");let T5=(()=>{class i{intercept(e,n){return n.handle(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})();const D5=/^\)\]\}',?\n/;let MP=(()=>{class i{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new S(n=>{const o=this.xhrFactory.build();if(o.open(e.method,e.urlWithParams),e.withCredentials&&(o.withCredentials=!0),e.headers.forEach((Xe,ot)=>o.setRequestHeader(Xe,ot.join(","))),e.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const Xe=e.detectContentTypeHeader();null!==Xe&&o.setRequestHeader("Content-Type",Xe)}if(e.responseType){const Xe=e.responseType.toLowerCase();o.responseType="json"!==Xe?Xe:"text"}const c=e.serializeBody();let f=null;const y=()=>{if(null!==f)return f;const Xe=o.statusText||"OK",ot=new mu(o.getAllResponseHeaders()),yt=function A5(i){return"responseURL"in i&&i.responseURL?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):null}(o)||e.url;return f=new jE({headers:ot,status:o.status,statusText:Xe,url:yt}),f},w=()=>{let{headers:Xe,status:ot,statusText:yt,url:jt}=y(),Gt=null;204!==ot&&(Gt=typeof o.response>"u"?o.responseText:o.response),0===ot&&(ot=Gt?200:0);let fi=ot>=200&&ot<300;if("json"===e.responseType&&"string"==typeof Gt){const qt=Gt;Gt=Gt.replace(D5,"");try{Gt=""!==Gt?JSON.parse(Gt):null}catch(Mi){Gt=qt,fi&&(fi=!1,Gt={error:Mi,text:Gt})}}fi?(n.next(new db({body:Gt,headers:Xe,status:ot,statusText:yt,url:jt||void 0})),n.complete()):n.error(new wP({error:Gt,headers:Xe,status:ot,statusText:yt,url:jt||void 0}))},L=Xe=>{const{url:ot}=y(),yt=new wP({error:Xe,status:o.status||0,statusText:o.statusText||"Unknown Error",url:ot||void 0});n.error(yt)};let le=!1;const ye=Xe=>{le||(n.next(y()),le=!0);let ot={type:Jo.DownloadProgress,loaded:Xe.loaded};Xe.lengthComputable&&(ot.total=Xe.total),"text"===e.responseType&&!!o.responseText&&(ot.partialText=o.responseText),n.next(ot)},Be=Xe=>{let ot={type:Jo.UploadProgress,loaded:Xe.loaded};Xe.lengthComputable&&(ot.total=Xe.total),n.next(ot)};return o.addEventListener("load",w),o.addEventListener("error",L),o.addEventListener("timeout",L),o.addEventListener("abort",L),e.reportProgress&&(o.addEventListener("progress",ye),null!==c&&o.upload&&o.upload.addEventListener("progress",Be)),o.send(c),n.next({type:Jo.Sent}),()=>{o.removeEventListener("error",L),o.removeEventListener("abort",L),o.removeEventListener("load",w),o.removeEventListener("timeout",L),e.reportProgress&&(o.removeEventListener("progress",ye),null!==c&&o.upload&&o.upload.removeEventListener("progress",Be)),o.readyState!==o.DONE&&o.abort()}})}}return i.\u0275fac=function(e){return new(e||i)(Pt(EA))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})();const HE=new ui("XSRF_COOKIE_NAME"),GE=new ui("XSRF_HEADER_NAME");class SP{}let XE,k5=(()=>{class i{constructor(e,n,o){this.doc=e,this.platform=n,this.cookieName=o,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=pA(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return i.\u0275fac=function(e){return new(e||i)(Pt(Pn),Pt(lx),Pt(HE))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})(),$E=(()=>{class i{constructor(e,n){this.tokenService=e,this.headerName=n}intercept(e,n){const o=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||o.startsWith("http://")||o.startsWith("https://"))return n.handle(e);const c=this.tokenService.getToken();return null!==c&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,c)})),n.handle(e)}}return i.\u0275fac=function(e){return new(e||i)(Pt(SP),Pt(GE))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})(),I5=(()=>{class i{constructor(e,n){this.backend=e,this.injector=n,this.chain=null}handle(e){if(null===this.chain){const n=this.injector.get(EP,[]);this.chain=n.reduceRight((o,c)=>new CP(o,c),this.backend)}return this.chain.handle(e)}}return i.\u0275fac=function(e){return new(e||i)(Pt(_P),Pt(Wr))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})(),P5=(()=>{class i{static disable(){return{ngModule:i,providers:[{provide:$E,useClass:T5}]}}static withOptions(e={}){return{ngModule:i,providers:[e.cookieName?{provide:HE,useValue:e.cookieName}:[],e.headerName?{provide:GE,useValue:e.headerName}:[]]}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({providers:[$E,{provide:EP,useExisting:$E,multi:!0},{provide:SP,useClass:k5},{provide:HE,useValue:"XSRF-TOKEN"},{provide:GE,useValue:"X-XSRF-TOKEN"}]}),i})(),O5=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({providers:[pb,{provide:gP,useClass:I5},MP,{provide:_P,useExisting:MP}],imports:[P5.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),i})(),WE=(()=>{class i{constructor(e){this.httpClient=e}getPosts(e=0,n=0,o){let c="";return o&&(c="temperature_unit=fahrenheit&"),this.httpClient.get(`http://api.open-meteo.com/v1/forecast/?latitude=${e}&longitude=${n}&hourly=temperature_2m,relativehumidity_2m,rain,snowfall,precipitation,cloudcover,surface_pressure,windspeed_10m,winddirection_10m&windspeed_unit=ms&${c}timeformat=unixtime&timezone=auto`)}getCityJson(){return this.httpClient.get("https://raw.githubusercontent.com/lutangar/cities.json/master/cities.json")}getCounryCSV(){return this.httpClient.get("https://pkgstore.datahub.io/core/country-list/data_csv/data/d7c9d7cfb42cb69f4422dec222dbbaa8/data_csv.csv",{responseType:"text"})}}return i.\u0275fac=function(e){return new(e||i)(Pt(pb))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();try{XE=typeof Intl<"u"&&Intl.v8BreakIterator}catch{XE=!1}let gg,Aa=(()=>{class i{constructor(e){this._platformId=e,this.isBrowser=this._platformId?function YB(i){return i===wA}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!XE)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return i.\u0275fac=function(e){return new(e||i)(Pt(lx))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const TP=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function DP(){if(gg)return gg;if("object"!=typeof document||!document)return gg=new Set(TP),gg;let i=document.createElement("input");return gg=new Set(TP.filter(t=>(i.setAttribute("type",t),i.type===t))),gg}let Zy,df,qE;function Ky(i){return function R5(){if(null==Zy&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Zy=!0}))}finally{Zy=Zy||!1}return Zy}()?i:!!i.capture}function L5(){if(null==df){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return df=!1,df;if("scrollBehavior"in document.documentElement.style)df=!0;else{const i=Element.prototype.scrollTo;df=!!i&&!/\{\s*\[native code\]\s*\}/.test(i.toString())}}return df}function YE(){let i=typeof document<"u"&&document?document.activeElement:null;for(;i&&i.shadowRoot;){const t=i.shadowRoot.activeElement;if(t===i)break;i=t}return i}function Nd(i){return i.composedPath?i.composedPath()[0]:i.target}function ZE(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Oc(i,...t){return t.length?t.some(e=>i[e]):i.altKey||i.shiftKey||i.ctrlKey||i.metaKey}class q5 extends re{constructor(t,e){super()}schedule(t,e=0){return this}}const yb={setInterval(i,t,...e){const{delegate:n}=yb;return n?.setInterval?n.setInterval(i,t,...e):setInterval(i,t,...e)},clearInterval(i){const{delegate:t}=yb;return(t?.clearInterval||clearInterval)(i)},delegate:void 0};class KE extends q5{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var n;if(this.closed)return this;this.state=t;const o=this.id,c=this.scheduler;return null!=o&&(this.id=this.recycleAsyncId(c,o,e)),this.pending=!0,this.delay=e,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(c,this.id,e),this}requestAsyncId(t,e,n=0){return yb.setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return e;null!=e&&yb.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let o,n=!1;try{this.work(t)}catch(c){n=!0,o=c||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),o}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:n}=e;this.work=this.state=this.scheduler=null,this.pending=!1,u(n,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const IP={now:()=>(IP.delegate||Date).now(),delegate:void 0};class ev{constructor(t,e=ev.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,n){return new this.schedulerActionCtor(this,t).schedule(n,e)}}ev.now=IP.now;class QE extends ev{constructor(t,e=ev.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let n;this._active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}const vb=new QE(KE),Y5=vb;function JE(i,t=vb){return $((e,n)=>{let o=null,c=null,f=null;const y=()=>{if(o){o.unsubscribe(),o=null;const L=c;c=null,n.next(L)}};function w(){const L=f+i,le=t.now();if(le<L)return o=this.schedule(void 0,L-le),void n.add(o);y()}e.subscribe(de(n,L=>{c=L,f=t.now(),o||(o=t.schedule(w,i),n.add(o))},()=>{y(),n.complete()},void 0,()=>{c=o=null}))})}function PP(i){return to((t,e)=>i<=e)}function OP(i,t=A){return i=i??Z5,$((e,n)=>{let o,c=!0;e.subscribe(de(n,f=>{const y=t(f);(c||!i(o,y))&&(c=!1,o=y,n.next(f))}))})}function Z5(i,t){return i===t}function As(i){return $((t,e)=>{_o(i).subscribe(de(e,()=>e.complete(),ne)),!e.closed&&t.subscribe(e)})}function so(i){return null!=i&&"false"!=`${i}`}function eM(i,t=0){return function K5(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}(i)?Number(i):t}function xb(i){return Array.isArray(i)?i:[i]}function es(i){return null==i?"":"string"==typeof i?i:`${i}px`}function gu(i){return i instanceof Zn?i.nativeElement:i}let RP=(()=>{class i{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Q5=(()=>{class i{constructor(e){this._mutationObserverFactory=e,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((e,n)=>this._cleanupObserver(n))}observe(e){const n=gu(e);return new S(o=>{const f=this._observeElement(n).subscribe(o);return()=>{f.unsubscribe(),this._unobserveElement(n)}})}_observeElement(e){if(this._observedElements.has(e))this._observedElements.get(e).count++;else{const n=new ue,o=this._mutationObserverFactory.create(c=>n.next(c));o&&o.observe(e,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(e,{observer:o,stream:n,count:1})}return this._observedElements.get(e).stream}_unobserveElement(e){this._observedElements.has(e)&&(this._observedElements.get(e).count--,this._observedElements.get(e).count||this._cleanupObserver(e))}_cleanupObserver(e){if(this._observedElements.has(e)){const{observer:n,stream:o}=this._observedElements.get(e);n&&n.disconnect(),o.complete(),this._observedElements.delete(e)}}}return i.\u0275fac=function(e){return new(e||i)(Pt(RP))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),LP=(()=>{class i{constructor(e,n,o){this._contentObserver=e,this._elementRef=n,this._ngZone=o,this.event=new Fn,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(e){this._disabled=so(e),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(e){this._debounce=eM(e),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const e=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?e.pipe(JE(this.debounce)):e).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(ft(Q5),ft(Zn),ft(En))},i.\u0275dir=ci({type:i,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),i})(),tM=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({providers:[RP]}),i})();const FP=new Set;let vg,J5=(()=>{class i{constructor(e){this._platform=e,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):tU}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function eU(i){if(!FP.has(i))try{vg||(vg=document.createElement("style"),vg.setAttribute("type","text/css"),document.head.appendChild(vg)),vg.sheet&&(vg.sheet.insertRule(`@media ${i} {body{ }}`,0),FP.add(i))}catch(t){console.error(t)}}(e),this._matchMedia(e)}}return i.\u0275fac=function(e){return new(e||i)(Pt(Aa))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function tU(i){return{matches:"all"===i||""===i,media:i,addListener:()=>{},removeListener:()=>{}}}let iM=(()=>{class i{constructor(e,n){this._mediaMatcher=e,this._zone=n,this._queries=new Map,this._destroySubject=new ue}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return NP(xb(e)).some(o=>this._registerQuery(o).mql.matches)}observe(e){let c=UC(NP(xb(e)).map(f=>this._registerQuery(f).observable));return c=Dy(c.pipe(eo(1)),c.pipe(PP(1),JE(0))),c.pipe(Ie(f=>{const y={matches:!1,breakpoints:{}};return f.forEach(({matches:w,query:L})=>{y.matches=y.matches||w,y.breakpoints[L]=w}),y}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const n=this._mediaMatcher.matchMedia(e),c={observable:new S(f=>{const y=w=>this._zone.run(()=>f.next(w));return n.addListener(y),()=>{n.removeListener(y)}}).pipe(gl(n),Ie(({matches:f})=>({query:e,matches:f})),As(this._destroySubject)),mql:n};return this._queries.set(e,c),c}}return i.\u0275fac=function(e){return new(e||i)(Pt(J5),Pt(En))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function NP(i){return i.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}class VP{constructor(t){this._items=t,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new ue,this._typeaheadSubscription=re.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._skipPredicateFn=e=>e.disabled,this._pressedLetters=[],this.tabOut=new ue,this.change=new ue,t instanceof ig&&t.changes.subscribe(e=>{if(this._activeItem){const o=e.toArray().indexOf(this._activeItem);o>-1&&o!==this._activeItemIndex&&(this._activeItemIndex=o)}})}skipPredicate(t){return this._skipPredicateFn=t,this}withWrap(t=!0){return this._wrap=t,this}withVerticalOrientation(t=!0){return this._vertical=t,this}withHorizontalOrientation(t){return this._horizontal=t,this}withAllowedModifierKeys(t){return this._allowedModifierKeys=t,this}withTypeAhead(t=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(zo(e=>this._pressedLetters.push(e)),JE(t),to(()=>this._pressedLetters.length>0),Ie(()=>this._pressedLetters.join(""))).subscribe(e=>{const n=this._getItemsArray();for(let o=1;o<n.length+1;o++){const c=(this._activeItemIndex+o)%n.length,f=n[c];if(!this._skipPredicateFn(f)&&0===f.getLabel().toUpperCase().trim().indexOf(e)){this.setActiveItem(c);break}}this._pressedLetters=[]}),this}withHomeAndEnd(t=!0){return this._homeAndEnd=t,this}setActiveItem(t){const e=this._activeItem;this.updateActiveItem(t),this._activeItem!==e&&this.change.next(this._activeItemIndex)}onKeydown(t){const e=t.keyCode,o=["altKey","ctrlKey","metaKey","shiftKey"].every(c=>!t[c]||this._allowedModifierKeys.indexOf(c)>-1);switch(e){case 9:return void this.tabOut.next();case 40:if(this._vertical&&o){this.setNextItemActive();break}return;case 38:if(this._vertical&&o){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&o){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&o){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&o){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&o){this.setLastItemActive();break}return;default:return void((o||Oc(t,"shiftKey"))&&(t.key&&1===t.key.length?this._letterKeyStream.next(t.key.toLocaleUpperCase()):(e>=65&&e<=90||e>=48&&e<=57)&&this._letterKeyStream.next(String.fromCharCode(e))))}this._pressedLetters=[],t.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(t){const e=this._getItemsArray(),n="number"==typeof t?t:e.indexOf(t);this._activeItem=e[n]??null,this._activeItemIndex=n}_setActiveItemByDelta(t){this._wrap?this._setActiveInWrapMode(t):this._setActiveInDefaultMode(t)}_setActiveInWrapMode(t){const e=this._getItemsArray();for(let n=1;n<=e.length;n++){const o=(this._activeItemIndex+t*n+e.length)%e.length;if(!this._skipPredicateFn(e[o]))return void this.setActiveItem(o)}}_setActiveInDefaultMode(t){this._setActiveItemByIndex(this._activeItemIndex+t,t)}_setActiveItemByIndex(t,e){const n=this._getItemsArray();if(n[t]){for(;this._skipPredicateFn(n[t]);)if(!n[t+=e])return;this.setActiveItem(t)}}_getItemsArray(){return this._items instanceof ig?this._items.toArray():this._items}}class oU extends VP{setActiveItem(t){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(t),this.activeItem&&this.activeItem.setActiveStyles()}}class sU extends VP{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(t){return this._origin=t,this}setActiveItem(t){super.setActiveItem(t),this.activeItem&&this.activeItem.focus(this._origin)}}let bb=(()=>{class i{constructor(e){this._platform=e}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function lU(i){return!!(i.offsetWidth||i.offsetHeight||"function"==typeof i.getClientRects&&i.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const n=function aU(i){try{return i.frameElement}catch{return null}}(function gU(i){return i.ownerDocument&&i.ownerDocument.defaultView||window}(e));if(n&&(-1===UP(n)||!this.isVisible(n)))return!1;let o=e.nodeName.toLowerCase(),c=UP(e);return e.hasAttribute("contenteditable")?-1!==c:!("iframe"===o||"object"===o||this._platform.WEBKIT&&this._platform.IOS&&!function fU(i){let t=i.nodeName.toLowerCase(),e="input"===t&&i.type;return"text"===e||"password"===e||"select"===t||"textarea"===t}(e))&&("audio"===o?!!e.hasAttribute("controls")&&-1!==c:"video"===o?-1!==c&&(null!==c||this._platform.FIREFOX||e.hasAttribute("controls")):e.tabIndex>=0)}isFocusable(e,n){return function mU(i){return!function hU(i){return function dU(i){return"input"==i.nodeName.toLowerCase()}(i)&&"hidden"==i.type}(i)&&(function cU(i){let t=i.nodeName.toLowerCase();return"input"===t||"select"===t||"button"===t||"textarea"===t}(i)||function uU(i){return function pU(i){return"a"==i.nodeName.toLowerCase()}(i)&&i.hasAttribute("href")}(i)||i.hasAttribute("contenteditable")||jP(i))}(e)&&!this.isDisabled(e)&&(n?.ignoreVisibility||this.isVisible(e))}}return i.\u0275fac=function(e){return new(e||i)(Pt(Aa))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function jP(i){if(!i.hasAttribute("tabindex")||void 0===i.tabIndex)return!1;let t=i.getAttribute("tabindex");return!(!t||isNaN(parseInt(t,10)))}function UP(i){if(!jP(i))return null;const t=parseInt(i.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}class _U{constructor(t,e,n,o,c=!1){this._element=t,this._checker=e,this._ngZone=n,this._document=o,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,c||this.attachAnchors()}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}destroy(){const t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){const e=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return"start"==t?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){const n=this._getFirstTabbableElement(e);return n?.focus(t),!!n}return e.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){const e=this._getRegionBoundary("start");return e&&e.focus(t),!!e}focusLastTabbableElement(t){const e=this._getRegionBoundary("end");return e&&e.focus(t),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let n=0;n<e.length;n++){const o=e[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[n]):null;if(o)return o}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let n=e.length-1;n>=0;n--){const o=e[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[n]):null;if(o)return o}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.pipe(eo(1)).subscribe(t)}}let nM=(()=>{class i{constructor(e,n,o){this._checker=e,this._ngZone=n,this._document=o}create(e,n=!1){return new _U(e,this._checker,this._ngZone,this._document,n)}}return i.\u0275fac=function(e){return new(e||i)(Pt(bb),Pt(En),Pt(Pn))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function rM(i){return 0===i.buttons||0===i.offsetX&&0===i.offsetY}function oM(i){const t=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}const yU=new ui("cdk-input-modality-detector-options"),vU={ignoreKeys:[18,17,224,91,16]},xg=Ky({passive:!0,capture:!0});let xU=(()=>{class i{constructor(e,n,o,c){this._platform=e,this._mostRecentTarget=null,this._modality=new Kl(null),this._lastTouchMs=0,this._onKeydown=f=>{this._options?.ignoreKeys?.some(y=>y===f.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Nd(f))},this._onMousedown=f=>{Date.now()-this._lastTouchMs<650||(this._modality.next(rM(f)?"keyboard":"mouse"),this._mostRecentTarget=Nd(f))},this._onTouchstart=f=>{oM(f)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Nd(f))},this._options={...vU,...c},this.modalityDetected=this._modality.pipe(PP(1)),this.modalityChanged=this.modalityDetected.pipe(OP()),e.isBrowser&&n.runOutsideAngular(()=>{o.addEventListener("keydown",this._onKeydown,xg),o.addEventListener("mousedown",this._onMousedown,xg),o.addEventListener("touchstart",this._onTouchstart,xg)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,xg),document.removeEventListener("mousedown",this._onMousedown,xg),document.removeEventListener("touchstart",this._onTouchstart,xg))}}return i.\u0275fac=function(e){return new(e||i)(Pt(Aa),Pt(En),Pt(Pn),Pt(yU,8))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const bU=new ui("liveAnnouncerElement",{providedIn:"root",factory:function wU(){return null}}),CU=new ui("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let sM=(()=>{class i{constructor(e,n,o,c){this._ngZone=n,this._defaultOptions=c,this._document=o,this._liveElement=e||this._createLiveElement()}announce(e,...n){const o=this._defaultOptions;let c,f;return 1===n.length&&"number"==typeof n[0]?f=n[0]:[c,f]=n,this.clear(),clearTimeout(this._previousTimeout),c||(c=o&&o.politeness?o.politeness:"polite"),null==f&&o&&(f=o.duration),this._liveElement.setAttribute("aria-live",c),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(y=>this._currentResolve=y)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=e,"number"==typeof f&&(this._previousTimeout=setTimeout(()=>this.clear(),f)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const e="cdk-live-announcer-element",n=this._document.getElementsByClassName(e),o=this._document.createElement("div");for(let c=0;c<n.length;c++)n[c].remove();return o.classList.add(e),o.classList.add("cdk-visually-hidden"),o.setAttribute("aria-atomic","true"),o.setAttribute("aria-live","polite"),this._document.body.appendChild(o),o}}return i.\u0275fac=function(e){return new(e||i)(Pt(bU,8),Pt(En),Pt(Pn),Pt(CU,8))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const EU=new ui("cdk-focus-monitor-default-options"),wb=Ky({passive:!0,capture:!0});let pf=(()=>{class i{constructor(e,n,o,c,f){this._ngZone=e,this._platform=n,this._inputModalityDetector=o,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new ue,this._rootNodeFocusAndBlurListener=y=>{for(let L=Nd(y);L;L=L.parentElement)"focus"===y.type?this._onFocus(y,L):this._onBlur(y,L)},this._document=c,this._detectionMode=f?.detectionMode||0}monitor(e,n=!1){const o=gu(e);if(!this._platform.isBrowser||1!==o.nodeType)return $i(null);const c=function N5(i){if(function F5(){if(null==qE){const i=typeof document<"u"?document.head:null;qE=!(!i||!i.createShadowRoot&&!i.attachShadow)}return qE}()){const t=i.getRootNode?i.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}(o)||this._getDocument(),f=this._elementInfo.get(o);if(f)return n&&(f.checkChildren=!0),f.subject;const y={checkChildren:n,subject:new ue,rootNode:c};return this._elementInfo.set(o,y),this._registerGlobalListeners(y),y.subject}stopMonitoring(e){const n=gu(e),o=this._elementInfo.get(n);o&&(o.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(o))}focusVia(e,n,o){const c=gu(e);c===this._getDocument().activeElement?this._getClosestElementsInfo(c).forEach(([y,w])=>this._originChanged(y,n,w)):(this._setOrigin(n),"function"==typeof c.focus&&c.focus(o))}ngOnDestroy(){this._elementInfo.forEach((e,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return 1===this._detectionMode||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,n){e.classList.toggle("cdk-focused",!!n),e.classList.toggle("cdk-touch-focused","touch"===n),e.classList.toggle("cdk-keyboard-focused","keyboard"===n),e.classList.toggle("cdk-mouse-focused","mouse"===n),e.classList.toggle("cdk-program-focused","program"===n)}_setOrigin(e,n=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&n,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,n){const o=this._elementInfo.get(n),c=Nd(e);!o||!o.checkChildren&&n!==c||this._originChanged(n,this._getFocusOrigin(c),o)}_onBlur(e,n){const o=this._elementInfo.get(n);!o||o.checkChildren&&e.relatedTarget instanceof Node&&n.contains(e.relatedTarget)||(this._setClasses(n),this._emitOrigin(o,null))}_emitOrigin(e,n){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(n))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const n=e.rootNode,o=this._rootNodeFocusListenerCount.get(n)||0;o||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,wb),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,wb)}),this._rootNodeFocusListenerCount.set(n,o+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(As(this._stopInputModalityDetector)).subscribe(c=>{this._setOrigin(c,!0)}))}_removeGlobalListeners(e){const n=e.rootNode;if(this._rootNodeFocusListenerCount.has(n)){const o=this._rootNodeFocusListenerCount.get(n);o>1?this._rootNodeFocusListenerCount.set(n,o-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,wb),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,wb),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,n,o){this._setClasses(e,n),this._emitOrigin(o,n),this._lastFocusOrigin=n}_getClosestElementsInfo(e){const n=[];return this._elementInfo.forEach((o,c)=>{(c===e||o.checkChildren&&c.contains(e))&&n.push([c,o])}),n}_isLastInteractionFromInputLabel(e){const{_mostRecentTarget:n,mostRecentModality:o}=this._inputModalityDetector;if("mouse"!==o||!n||n===e||"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName||e.disabled)return!1;const c=e.labels;if(c)for(let f=0;f<c.length;f++)if(c[f].contains(n))return!0;return!1}}return i.\u0275fac=function(e){return new(e||i)(Pt(En),Pt(Aa),Pt(xU),Pt(Pn,8),Pt(EU,8))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const GP="cdk-high-contrast-black-on-white",$P="cdk-high-contrast-white-on-black",aM="cdk-high-contrast-active";let WP=(()=>{class i{constructor(e,n){this._platform=e,this._document=n,this._breakpointSubscription=nr(iM).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const n=this._document.defaultView||window,o=n&&n.getComputedStyle?n.getComputedStyle(e):null,c=(o&&o.backgroundColor||"").replace(/ /g,"");switch(e.remove(),c){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(aM,GP,$P),this._hasCheckedHighContrastMode=!0;const n=this.getHighContrastMode();1===n?e.add(aM,GP):2===n&&e.add(aM,$P)}}}return i.\u0275fac=function(e){return new(e||i)(Pt(Aa),Pt(Pn))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),MU=(()=>{class i{constructor(e){e._applyBodyHighContrastModeCssClasses()}}return i.\u0275fac=function(e){return new(e||i)(Pt(WP))},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[tM]}),i})();const SU=["addListener","removeListener"],TU=["addEventListener","removeEventListener"],DU=["on","off"];function ff(i,t,e,n){if(Mn(e)&&(n=e,e=void 0),n)return ff(i,t,e).pipe(jC(n));const[o,c]=function IU(i){return Mn(i.addEventListener)&&Mn(i.removeEventListener)}(i)?TU.map(f=>y=>i[f](t,y,e)):function AU(i){return Mn(i.addListener)&&Mn(i.removeListener)}(i)?SU.map(XP(i,t)):function kU(i){return Mn(i.on)&&Mn(i.off)}(i)?DU.map(XP(i,t)):[];if(!o&&Qi(i))return Mt(f=>ff(f,t,e))(_o(i));if(!o)throw new TypeError("Invalid event target");return new S(f=>{const y=(...w)=>f.next(1<w.length?w:w[0]);return o(y),()=>c(y)})}function XP(i,t){return e=>n=>i[e](t,n)}const tv={schedule(i){let t=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:n}=tv;n&&(t=n.requestAnimationFrame,e=n.cancelAnimationFrame);const o=t(c=>{e=void 0,i(c)});return new re(()=>e?.(o))},requestAnimationFrame(...i){const{delegate:t}=tv;return(t?.requestAnimationFrame||requestAnimationFrame)(...i)},cancelAnimationFrame(...i){const{delegate:t}=tv;return(t?.cancelAnimationFrame||cancelAnimationFrame)(...i)},delegate:void 0};new class OU extends QE{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let o;t=t||n.shift();do{if(o=t.execute(t.state,t.delay))break}while((t=n[0])&&t.id===e&&n.shift());if(this._active=!1,o){for(;(t=n[0])&&t.id===e&&n.shift();)t.unsubscribe();throw o}}}(class PU extends KE{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t._scheduled||(t._scheduled=tv.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,e,n=0){var o;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(t,e,n);const{actions:c}=t;null!=e&&(null===(o=c[c.length-1])||void 0===o?void 0:o.id)!==e&&(tv.cancelAnimationFrame(e),t._scheduled=void 0)}});let lM,LU=1;const Cb={};function qP(i){return i in Cb&&(delete Cb[i],!0)}const FU={setImmediate(i){const t=LU++;return Cb[t]=!0,lM||(lM=Promise.resolve()),lM.then(()=>qP(t)&&i()),t},clearImmediate(i){qP(i)}},{setImmediate:NU,clearImmediate:BU}=FU,Eb={setImmediate(...i){const{delegate:t}=Eb;return(t?.setImmediate||NU)(...i)},clearImmediate(i){const{delegate:t}=Eb;return(t?.clearImmediate||BU)(i)},delegate:void 0},cM=new class VU extends QE{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let o;t=t||n.shift();do{if(o=t.execute(t.state,t.delay))break}while((t=n[0])&&t.id===e&&n.shift());if(this._active=!1,o){for(;(t=n[0])&&t.id===e&&n.shift();)t.unsubscribe();throw o}}}(class zU extends KE{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t._scheduled||(t._scheduled=Eb.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,e,n=0){var o;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(t,e,n);const{actions:c}=t;null!=e&&(null===(o=c[c.length-1])||void 0===o?void 0:o.id)!==e&&(Eb.clearImmediate(e),t._scheduled=void 0)}});function YP(i=0,t,e=Y5){let n=-1;return null!=t&&(zi(t)?e=t:n=t),new S(o=>{let c=function UU(i){return i instanceof Date&&!isNaN(i)}(i)?+i-e.now():i;c<0&&(c=0);let f=0;return e.schedule(function(){o.closed||(o.next(f++),0<=n?this.schedule(void 0,n):o.complete())},c)})}function ZP(i,t=vb){return function jU(i){return $((t,e)=>{let n=!1,o=null,c=null,f=!1;const y=()=>{if(c?.unsubscribe(),c=null,n){n=!1;const L=o;o=null,e.next(L)}f&&e.complete()},w=()=>{c=null,f&&e.complete()};t.subscribe(de(e,L=>{n=!0,o=L,c||_o(i(L)).subscribe(c=de(e,y,w))},()=>{f=!0,(!n||!c||c.closed)&&e.complete()}))})}(()=>YP(i,t))}const HU=new ui("cdk-dir-doc",{providedIn:"root",factory:function GU(){return nr(Pn)}}),$U=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Bd=(()=>{class i{constructor(e){if(this.value="ltr",this.change=new Fn,e){const o=e.documentElement?e.documentElement.dir:null;this.value=function WU(i){const t=i?.toLowerCase()||"";return"auto"===t&&typeof navigator<"u"&&navigator?.language?$U.test(navigator.language)?"rtl":"ltr":"rtl"===t?"rtl":"ltr"}((e.body?e.body.dir:null)||o||"ltr")}}ngOnDestroy(){this.change.complete()}}return i.\u0275fac=function(e){return new(e||i)(Pt(HU,8))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),iv=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({}),i})(),qU=(()=>{class i{constructor(e,n,o){this._ngZone=e,this._platform=n,this._scrolled=new ue,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=o}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const n=this.scrollContainers.get(e);n&&(n.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new S(n=>{this._globalSubscription||this._addGlobalListener();const o=e>0?this._scrolled.pipe(ZP(e)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{o.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):$i()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(e,n){const o=this.getAncestorScrollContainers(e);return this.scrolled(n).pipe(to(c=>!c||o.indexOf(c)>-1))}getAncestorScrollContainers(e){const n=[];return this.scrollContainers.forEach((o,c)=>{this._scrollableContainsElement(c,e)&&n.push(c)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,n){let o=gu(n),c=e.getElementRef().nativeElement;do{if(o==c)return!0}while(o=o.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>ff(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return i.\u0275fac=function(e){return new(e||i)(Pt(En),Pt(Aa),Pt(Pn,8))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Mb=(()=>{class i{constructor(e,n,o){this._platform=e,this._change=new ue,this._changeListener=c=>{this._change.next(c)},this._document=o,n.runOutsideAngular(()=>{if(e.isBrowser){const c=this._getWindow();c.addEventListener("resize",this._changeListener),c.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:n,height:o}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+o,right:e.left+n,height:o,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,n=this._getWindow(),o=e.documentElement,c=o.getBoundingClientRect();return{top:-c.top||e.body.scrollTop||n.scrollY||o.scrollTop||0,left:-c.left||e.body.scrollLeft||n.scrollX||o.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(ZP(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return i.\u0275fac=function(e){return new(e||i)(Pt(Aa),Pt(En),Pt(Pn,8))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),nv=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({}),i})(),KP=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[iv,nv,iv,nv]}),i})();class hM{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null!=t&&(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class rv extends hM{constructor(t,e,n,o){super(),this.component=t,this.viewContainerRef=e,this.injector=n,this.componentFactoryResolver=o}}class bg extends hM{constructor(t,e,n,o){super(),this.templateRef=t,this.viewContainerRef=e,this.context=n,this.injector=o}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class ZU extends hM{constructor(t){super(),this.element=t instanceof Zn?t.nativeElement:t}}class Sb{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t instanceof rv?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof bg?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof ZU?(this._attachedPortal=t,this.attachDomPortal(t)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class KU extends Sb{constructor(t,e,n,o,c){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=n,this._defaultInjector=o,this.attachDomPortal=f=>{const y=f.element,w=this._document.createComment("dom-portal");y.parentNode.insertBefore(w,y),this.outletElement.appendChild(y),this._attachedPortal=f,super.setDisposeFn(()=>{w.parentNode&&w.parentNode.replaceChild(y,w)})},this._document=c}attachComponentPortal(t){const n=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let o;return t.viewContainerRef?(o=t.viewContainerRef.createComponent(n,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector),this.setDisposeFn(()=>o.destroy())):(o=n.create(t.injector||this._defaultInjector||Wr.NULL),this._appRef.attachView(o.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(o.hostView),o.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(o)),this._attachedPortal=t,o}attachTemplatePortal(t){let e=t.viewContainerRef,n=e.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return n.rootNodes.forEach(o=>this.outletElement.appendChild(o)),n.detectChanges(),this.setDisposeFn(()=>{let o=e.indexOf(n);-1!==o&&e.remove(o)}),this._attachedPortal=t,n}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let ov=(()=>{class i extends Sb{constructor(e,n,o){super(),this._componentFactoryResolver=e,this._viewContainerRef=n,this._isInitialized=!1,this.attached=new Fn,this.attachDomPortal=c=>{const f=c.element,y=this._document.createComment("dom-portal");c.setAttachedHost(this),f.parentNode.insertBefore(y,f),this._getRootNode().appendChild(f),this._attachedPortal=c,super.setDisposeFn(()=>{y.parentNode&&y.parentNode.replaceChild(f,y)})},this._document=o}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(e){e.setAttachedHost(this);const n=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,c=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),f=n.createComponent(c,n.length,e.injector||n.injector);return n!==this._viewContainerRef&&this._getRootNode().appendChild(f.hostView.rootNodes[0]),super.setDisposeFn(()=>f.destroy()),this._attachedPortal=e,this._attachedRef=f,this.attached.emit(f),f}attachTemplatePortal(e){e.setAttachedHost(this);const n=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=n,this.attached.emit(n),n}_getRootNode(){const e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}}return i.\u0275fac=function(e){return new(e||i)(ft(Xh),ft(Sa),ft(Pn))},i.\u0275dir=ci({type:i,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[en]}),i})(),sv=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({}),i})();const QP=L5();class QU{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=es(-this._previousScrollPosition.left),t.style.top=es(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,n=t.style,o=this._document.body.style,c=n.scrollBehavior||"",f=o.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),QP&&(n.scrollBehavior=o.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),QP&&(n.scrollBehavior=c,o.scrollBehavior=f)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const e=this._document.body,n=this._viewportRuler.getViewportSize();return e.scrollHeight>n.height||e.scrollWidth>n.width}}class JU{constructor(t,e,n,o){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=n,this._config=o,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class JP{enable(){}disable(){}attach(){}}function uM(i,t){return t.some(e=>i.bottom<e.top||i.top>e.bottom||i.right<e.left||i.left>e.right)}function e2(i,t){return t.some(e=>i.top<e.top||i.bottom>e.bottom||i.left<e.left||i.right>e.right)}class e4{constructor(t,e,n,o){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this._config=o,this._scrollSubscription=null}attach(t){this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:o}=this._viewportRuler.getViewportSize();uM(e,[{width:n,height:o,bottom:o,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let t4=(()=>{class i{constructor(e,n,o,c){this._scrollDispatcher=e,this._viewportRuler=n,this._ngZone=o,this.noop=()=>new JP,this.close=f=>new JU(this._scrollDispatcher,this._ngZone,this._viewportRuler,f),this.block=()=>new QU(this._viewportRuler,this._document),this.reposition=f=>new e4(this._scrollDispatcher,this._viewportRuler,this._ngZone,f),this._document=c}}return i.\u0275fac=function(e){return new(e||i)(Pt(qU),Pt(Mb),Pt(En),Pt(Pn))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class wg{constructor(t){if(this.scrollStrategy=new JP,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const n of e)void 0!==t[n]&&(this[n]=t[n])}}}class i4{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}let t2=(()=>{class i{constructor(e){this._attachedOverlays=[],this._document=e}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){const n=this._attachedOverlays.indexOf(e);n>-1&&this._attachedOverlays.splice(n,1),0===this._attachedOverlays.length&&this.detach()}}return i.\u0275fac=function(e){return new(e||i)(Pt(Pn))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),n4=(()=>{class i extends t2{constructor(e,n){super(e),this._ngZone=n,this._keydownListener=o=>{const c=this._attachedOverlays;for(let f=c.length-1;f>-1;f--)if(c[f]._keydownEvents.observers.length>0){const y=c[f]._keydownEvents;this._ngZone?this._ngZone.run(()=>y.next(o)):y.next(o);break}}}add(e){super.add(e),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return i.\u0275fac=function(e){return new(e||i)(Pt(Pn),Pt(En,8))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),r4=(()=>{class i extends t2{constructor(e,n,o){super(e),this._platform=n,this._ngZone=o,this._cursorStyleIsSet=!1,this._pointerDownListener=c=>{this._pointerDownEventTarget=Nd(c)},this._clickListener=c=>{const f=Nd(c),y="click"===c.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:f;this._pointerDownEventTarget=null;const w=this._attachedOverlays.slice();for(let L=w.length-1;L>-1;L--){const le=w[L];if(le._outsidePointerEvents.observers.length<1||!le.hasAttached())continue;if(le.overlayElement.contains(f)||le.overlayElement.contains(y))break;const ye=le._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>ye.next(c)):ye.next(c)}}}add(e){if(super.add(e),!this._isAttached){const n=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(n)):this._addEventListeners(n),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const e=this._document.body;e.removeEventListener("pointerdown",this._pointerDownListener,!0),e.removeEventListener("click",this._clickListener,!0),e.removeEventListener("auxclick",this._clickListener,!0),e.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(e.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(e){e.addEventListener("pointerdown",this._pointerDownListener,!0),e.addEventListener("click",this._clickListener,!0),e.addEventListener("auxclick",this._clickListener,!0),e.addEventListener("contextmenu",this._clickListener,!0)}}return i.\u0275fac=function(e){return new(e||i)(Pt(Pn),Pt(Aa),Pt(En,8))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Tb=(()=>{class i{constructor(e,n){this._platform=n,this._document=e}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const e="cdk-overlay-container";if(this._platform.isBrowser||ZE()){const o=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let c=0;c<o.length;c++)o[c].remove()}const n=this._document.createElement("div");n.classList.add(e),ZE()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}}return i.\u0275fac=function(e){return new(e||i)(Pt(Pn),Pt(Aa))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class av{constructor(t,e,n,o,c,f,y,w,L,le=!1){this._portalOutlet=t,this._host=e,this._pane=n,this._config=o,this._ngZone=c,this._keyboardDispatcher=f,this._document=y,this._location=w,this._outsideClickDispatcher=L,this._animationsDisabled=le,this._backdropElement=null,this._backdropClick=new ue,this._attachments=new ue,this._detachments=new ue,this._locationChanges=re.EMPTY,this._backdropClickHandler=ye=>this._backdropClick.next(ye),this._backdropTransitionendHandler=ye=>{this._disposeBackdrop(ye.target)},this._keydownEvents=new ue,this._outsidePointerEvents=new ue,o.scrollStrategy&&(this._scrollStrategy=o.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=o.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const e=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(eo(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof e?.onDestroy&&e.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config={...this._config,...t},this._updateElementSize()}setDirection(t){this._config={...this._config,direction:t},this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=es(this._config.width),t.height=es(this._config.height),t.minWidth=es(this._config.minWidth),t.minHeight=es(this._config.minHeight),t.maxWidth=es(this._config.maxWidth),t.maxHeight=es(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){const t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const t=this._backdropElement;if(t){if(this._animationsDisabled)return void this._disposeBackdrop(t);t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500))}}_toggleClasses(t,e,n){const o=xb(e||[]).filter(c=>!!c);o.length&&(n?t.classList.add(...o):t.classList.remove(...o))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.pipe(As(ys(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const n2="cdk-overlay-connected-position-bounding-box",o4=/([A-Za-z%]+)$/;class s4{constructor(t,e,n,o,c){this._viewportRuler=e,this._document=n,this._platform=o,this._overlayContainer=c,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new ue,this._resizeSubscription=re.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}get positions(){return this._preferredPositions}attach(t){this._validatePositions(),t.hostElement.classList.add(n2),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._originRect,e=this._overlayRect,n=this._viewportRect,o=this._containerRect,c=[];let f;for(let y of this._preferredPositions){let w=this._getOriginPoint(t,o,y),L=this._getOverlayPoint(w,e,y),le=this._getOverlayFit(L,e,n,y);if(le.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(y,w);this._canFitWithFlexibleDimensions(le,L,n)?c.push({position:y,origin:w,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(w,y)}):(!f||f.overlayFit.visibleArea<le.visibleArea)&&(f={overlayFit:le,overlayPoint:L,originPoint:w,position:y,overlayRect:e})}if(c.length){let y=null,w=-1;for(const L of c){const le=L.boundingBoxRect.width*L.boundingBoxRect.height*(L.position.weight||1);le>w&&(w=le,y=L)}return this._isPushed=!1,void this._applyPosition(y.position,y.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(f.position,f.originPoint);this._applyPosition(f.position,f.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&mf(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(n2),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,e)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e,n){let o,c;if("center"==n.originX)o=t.left+t.width/2;else{const f=this._isRtl()?t.right:t.left,y=this._isRtl()?t.left:t.right;o="start"==n.originX?f:y}return e.left<0&&(o-=e.left),c="center"==n.originY?t.top+t.height/2:"top"==n.originY?t.top:t.bottom,e.top<0&&(c-=e.top),{x:o,y:c}}_getOverlayPoint(t,e,n){let o,c;return o="center"==n.overlayX?-e.width/2:"start"===n.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,c="center"==n.overlayY?-e.height/2:"top"==n.overlayY?0:-e.height,{x:t.x+o,y:t.y+c}}_getOverlayFit(t,e,n,o){const c=o2(e);let{x:f,y}=t,w=this._getOffset(o,"x"),L=this._getOffset(o,"y");w&&(f+=w),L&&(y+=L);let Be=0-y,Xe=y+c.height-n.height,ot=this._subtractOverflows(c.width,0-f,f+c.width-n.width),yt=this._subtractOverflows(c.height,Be,Xe),jt=ot*yt;return{visibleArea:jt,isCompletelyWithinViewport:c.width*c.height===jt,fitsInViewportVertically:yt===c.height,fitsInViewportHorizontally:ot==c.width}}_canFitWithFlexibleDimensions(t,e,n){if(this._hasFlexibleDimensions){const o=n.bottom-e.y,c=n.right-e.x,f=r2(this._overlayRef.getConfig().minHeight),y=r2(this._overlayRef.getConfig().minWidth),L=t.fitsInViewportHorizontally||null!=y&&y<=c;return(t.fitsInViewportVertically||null!=f&&f<=o)&&L}return!1}_pushOverlayOnScreen(t,e,n){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const o=o2(e),c=this._viewportRect,f=Math.max(t.x+o.width-c.width,0),y=Math.max(t.y+o.height-c.height,0),w=Math.max(c.top-n.top-t.y,0),L=Math.max(c.left-n.left-t.x,0);let le=0,ye=0;return le=o.width<=c.width?L||-f:t.x<this._viewportMargin?c.left-n.left-t.x:0,ye=o.height<=c.height?w||-y:t.y<this._viewportMargin?c.top-n.top-t.y:0,this._previousPushAmount={x:le,y:ye},{x:t.x+le,y:t.y+ye}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const n=this._getScrollVisibility(),o=new i4(t,n);this._positionChanges.next(o)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,o=t.overlayY;n="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let c=0;c<e.length;c++)e[c].style.transformOrigin=`${n} ${o}`}_calculateBoundingBoxRect(t,e){const n=this._viewportRect,o=this._isRtl();let c,f,y,le,ye,Be;if("top"===e.overlayY)f=t.y,c=n.height-f+this._viewportMargin;else if("bottom"===e.overlayY)y=n.height-t.y+2*this._viewportMargin,c=n.height-y+this._viewportMargin;else{const Xe=Math.min(n.bottom-t.y+n.top,t.y),ot=this._lastBoundingBoxSize.height;c=2*Xe,f=t.y-Xe,c>ot&&!this._isInitialRender&&!this._growAfterOpen&&(f=t.y-ot/2)}if("end"===e.overlayX&&!o||"start"===e.overlayX&&o)Be=n.width-t.x+this._viewportMargin,le=t.x-this._viewportMargin;else if("start"===e.overlayX&&!o||"end"===e.overlayX&&o)ye=t.x,le=n.right-t.x;else{const Xe=Math.min(n.right-t.x+n.left,t.x),ot=this._lastBoundingBoxSize.width;le=2*Xe,ye=t.x-Xe,le>ot&&!this._isInitialRender&&!this._growAfterOpen&&(ye=t.x-ot/2)}return{top:f,left:ye,bottom:y,right:Be,width:le,height:c}}_setBoundingBoxStyles(t,e){const n=this._calculateBoundingBoxRect(t,e);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const o={};if(this._hasExactPosition())o.top=o.left="0",o.bottom=o.right=o.maxHeight=o.maxWidth="",o.width=o.height="100%";else{const c=this._overlayRef.getConfig().maxHeight,f=this._overlayRef.getConfig().maxWidth;o.height=es(n.height),o.top=es(n.top),o.bottom=es(n.bottom),o.width=es(n.width),o.left=es(n.left),o.right=es(n.right),o.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",o.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",c&&(o.maxHeight=es(c)),f&&(o.maxWidth=es(f))}this._lastBoundingBoxSize=n,mf(this._boundingBox.style,o)}_resetBoundingBoxStyles(){mf(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){mf(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const n={},o=this._hasExactPosition(),c=this._hasFlexibleDimensions,f=this._overlayRef.getConfig();if(o){const le=this._viewportRuler.getViewportScrollPosition();mf(n,this._getExactOverlayY(e,t,le)),mf(n,this._getExactOverlayX(e,t,le))}else n.position="static";let y="",w=this._getOffset(e,"x"),L=this._getOffset(e,"y");w&&(y+=`translateX(${w}px) `),L&&(y+=`translateY(${L}px)`),n.transform=y.trim(),f.maxHeight&&(o?n.maxHeight=es(f.maxHeight):c&&(n.maxHeight="")),f.maxWidth&&(o?n.maxWidth=es(f.maxWidth):c&&(n.maxWidth="")),mf(this._pane.style,n)}_getExactOverlayY(t,e,n){let o={top:"",bottom:""},c=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(c=this._pushOverlayOnScreen(c,this._overlayRect,n)),"bottom"===t.overlayY?o.bottom=this._document.documentElement.clientHeight-(c.y+this._overlayRect.height)+"px":o.top=es(c.y),o}_getExactOverlayX(t,e,n){let f,o={left:"",right:""},c=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(c=this._pushOverlayOnScreen(c,this._overlayRect,n)),f=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===f?o.right=this._document.documentElement.clientWidth-(c.x+this._overlayRect.width)+"px":o.left=es(c.x),o}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),n=this._scrollables.map(o=>o.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:e2(t,n),isOriginOutsideView:uM(t,n),isOverlayClipped:e2(e,n),isOverlayOutsideView:uM(e,n)}}_subtractOverflows(t,...e){return e.reduce((n,o)=>n-Math.max(o,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+t-this._viewportMargin,bottom:n.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?t.offsetX??this._offsetX:t.offsetY??this._offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&xb(t).forEach(e=>{""!==e&&-1===this._appliedPanelClasses.indexOf(e)&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof Zn)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const e=t.width||0,n=t.height||0;return{top:t.y,bottom:t.y+n,left:t.x,right:t.x+e,height:n,width:e}}}function mf(i,t){for(let e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i}function r2(i){if("number"!=typeof i&&null!=i){const[t,e]=i.split(o4);return e&&"px"!==e?null:parseFloat(t)}return i||null}function o2(i){return{top:Math.floor(i.top),right:Math.floor(i.right),bottom:Math.floor(i.bottom),left:Math.floor(i.left),width:Math.floor(i.width),height:Math.floor(i.height)}}const s2="cdk-global-overlay-wrapper";class a4{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(s2),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:o,height:c,maxWidth:f,maxHeight:y}=n,w=!("100%"!==o&&"100vw"!==o||f&&"100%"!==f&&"100vw"!==f),L=!("100%"!==c&&"100vh"!==c||y&&"100%"!==y&&"100vh"!==y),le=this._xPosition,ye=this._xOffset,Be="rtl"===this._overlayRef.getConfig().direction;let Xe="",ot="",yt="";w?yt="flex-start":"center"===le?(yt="center",Be?ot=ye:Xe=ye):Be?"left"===le||"end"===le?(yt="flex-end",Xe=ye):("right"===le||"start"===le)&&(yt="flex-start",ot=ye):"left"===le||"start"===le?(yt="flex-start",Xe=ye):("right"===le||"end"===le)&&(yt="flex-end",ot=ye),t.position=this._cssPosition,t.marginLeft=w?"0":Xe,t.marginTop=L?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=w?"0":ot,e.justifyContent=yt,e.alignItems=L?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,n=e.style;e.classList.remove(s2),n.justifyContent=n.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let l4=(()=>{class i{constructor(e,n,o,c){this._viewportRuler=e,this._document=n,this._platform=o,this._overlayContainer=c}global(){return new a4}flexibleConnectedTo(e){return new s4(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return i.\u0275fac=function(e){return new(e||i)(Pt(Mb),Pt(Pn),Pt(Aa),Pt(Tb))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),c4=0,qa=(()=>{class i{constructor(e,n,o,c,f,y,w,L,le,ye,Be,Xe){this.scrollStrategies=e,this._overlayContainer=n,this._componentFactoryResolver=o,this._positionBuilder=c,this._keyboardDispatcher=f,this._injector=y,this._ngZone=w,this._document=L,this._directionality=le,this._location=ye,this._outsideClickDispatcher=Be,this._animationsModuleType=Xe}create(e){const n=this._createHostElement(),o=this._createPaneElement(n),c=this._createPortalOutlet(o),f=new wg(e);return f.direction=f.direction||this._directionality.value,new av(c,n,o,f,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(e){const n=this._document.createElement("div");return n.id="cdk-overlay-"+c4++,n.classList.add("cdk-overlay-pane"),e.appendChild(n),n}_createHostElement(){const e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get(og)),new KU(e,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return i.\u0275fac=function(e){return new(e||i)(Pt(t4),Pt(Tb),Pt(Xh),Pt(l4),Pt(n4),Pt(Wr),Pt(En),Pt(Pn),Pt(Bd),Pt(xy),Pt(r4),Pt(mh,8))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})();const h4=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],a2=new ui("cdk-connected-overlay-scroll-strategy");let l2=(()=>{class i{constructor(e){this.elementRef=e}}return i.\u0275fac=function(e){return new(e||i)(ft(Zn))},i.\u0275dir=ci({type:i,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"]}),i})(),c2=(()=>{class i{constructor(e,n,o,c,f){this._overlay=e,this._dir=f,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=re.EMPTY,this._attachSubscription=re.EMPTY,this._detachSubscription=re.EMPTY,this._positionSubscription=re.EMPTY,this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.backdropClick=new Fn,this.positionChange=new Fn,this.attach=new Fn,this.detach=new Fn,this.overlayKeydown=new Fn,this.overlayOutsideClick=new Fn,this._templatePortal=new bg(n,o),this._scrollStrategyFactory=c,this.scrollStrategy=this._scrollStrategyFactory()}get offsetX(){return this._offsetX}set offsetX(e){this._offsetX=e,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY=e,this._position&&this._updatePositionStrategy(this._position)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(e){this._hasBackdrop=so(e)}get lockPosition(){return this._lockPosition}set lockPosition(e){this._lockPosition=so(e)}get flexibleDimensions(){return this._flexibleDimensions}set flexibleDimensions(e){this._flexibleDimensions=so(e)}get growAfterOpen(){return this._growAfterOpen}set growAfterOpen(e){this._growAfterOpen=so(e)}get push(){return this._push}set push(e){this._push=so(e)}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(e){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),e.origin&&this.open&&this._position.apply()),e.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=h4);const e=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=e.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=e.detachments().subscribe(()=>this.detach.emit()),e.keydownEvents().subscribe(n=>{this.overlayKeydown.next(n),27===n.keyCode&&!this.disableClose&&!Oc(n)&&(n.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(n=>{this.overlayOutsideClick.next(n)})}_buildConfig(){const e=this._position=this.positionStrategy||this._createPositionStrategy(),n=new wg({direction:this._dir,positionStrategy:e,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(n.width=this.width),(this.height||0===this.height)&&(n.height=this.height),(this.minWidth||0===this.minWidth)&&(n.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(n.minHeight=this.minHeight),this.backdropClass&&(n.backdropClass=this.backdropClass),this.panelClass&&(n.panelClass=this.panelClass),n}_updatePositionStrategy(e){const n=this.positions.map(o=>({originX:o.originX,originY:o.originY,overlayX:o.overlayX,overlayY:o.overlayY,offsetX:o.offsetX||this.offsetX,offsetY:o.offsetY||this.offsetY,panelClass:o.panelClass||void 0}));return e.setOrigin(this._getFlexibleConnectedPositionStrategyOrigin()).withPositions(n).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const e=this._overlay.position().flexibleConnectedTo(this._getFlexibleConnectedPositionStrategyOrigin());return this._updatePositionStrategy(e),e}_getFlexibleConnectedPositionStrategyOrigin(){return this.origin instanceof l2?this.origin.elementRef:this.origin}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(e=>{this.backdropClick.emit(e)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(tk(()=>this.positionChange.observers.length>0)).subscribe(e=>{this.positionChange.emit(e),0===this.positionChange.observers.length&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(ft(qa),ft(ml),ft(Sa),ft(a2),ft(Bd,8))},i.\u0275dir=ci({type:i,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:["cdkConnectedOverlayOrigin","origin"],positions:["cdkConnectedOverlayPositions","positions"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:["cdkConnectedOverlayOpen","open"],disableClose:["cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],features:[no]}),i})();const d4={provide:a2,deps:[qa],useFactory:function u4(i){return()=>i.scrollStrategies.reposition()}};let Cg=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({providers:[qa,d4],imports:[iv,sv,KP,KP]}),i})();function p4(i,t){}class Db{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0}}let h2=(()=>{class i extends Sb{constructor(e,n,o,c,f,y,w,L){super(),this._elementRef=e,this._focusTrapFactory=n,this._config=c,this._interactivityChecker=f,this._ngZone=y,this._overlayRef=w,this._focusMonitor=L,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=le=>{this._portalOutlet.hasAttached();const ye=this._portalOutlet.attachDomPortal(le);return this._contentAttached(),ye},this._ariaLabelledBy=this._config.ariaLabelledBy||null,this._document=o}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(e){this._portalOutlet.hasAttached();const n=this._portalOutlet.attachComponentPortal(e);return this._contentAttached(),n}attachTemplatePortal(e){this._portalOutlet.hasAttached();const n=this._portalOutlet.attachTemplatePortal(e);return this._contentAttached(),n}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(e,n){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const o=()=>{e.removeEventListener("blur",o),e.removeEventListener("mousedown",o),e.removeAttribute("tabindex")};e.addEventListener("blur",o),e.addEventListener("mousedown",o)})),e.focus(n)}_focusByCssSelector(e,n){let o=this._elementRef.nativeElement.querySelector(e);o&&this._forceFocus(o,n)}_trapFocus(){const e=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||e.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(n=>{n||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const e=this._config.restoreFocus;let n=null;if("string"==typeof e?n=this._document.querySelector(e):"boolean"==typeof e?n=e?this._elementFocusedBeforeDialogWasOpened:null:e&&(n=e),this._config.restoreFocus&&n&&"function"==typeof n.focus){const o=YE(),c=this._elementRef.nativeElement;(!o||o===this._document.body||o===c||c.contains(o))&&(this._focusMonitor?(this._focusMonitor.focusVia(n,this._closeInteractionType),this._closeInteractionType=null):n.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const e=this._elementRef.nativeElement,n=YE();return e===n||e.contains(n)}_initializeFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=YE())}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}}return i.\u0275fac=function(e){return new(e||i)(ft(Zn),ft(nM),ft(Pn,8),ft(Db),ft(bb),ft(En),ft(av),ft(pf))},i.\u0275cmp=Cr({type:i,selectors:[["cdk-dialog-container"]],viewQuery:function(e,n){if(1&e&&$a(ov,7),2&e){let o;Dr(o=Ar())&&(n._portalOutlet=o.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(e,n){2&e&&Ir("id",n._config.id||null)("role",n._config.role)("aria-modal",n._config.ariaModal)("aria-labelledby",n._config.ariaLabel?null:n._ariaLabelledBy)("aria-label",n._config.ariaLabel)("aria-describedby",n._config.ariaDescribedBy||null)},features:[en],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,n){1&e&&Pr(0,p4,0,0,"ng-template",0)},dependencies:[ov],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2}),i})();class dM{constructor(t,e){this.overlayRef=t,this.config=e,this.closed=new ue,this.disableClose=e.disableClose,this.backdropClick=t.backdropClick(),this.keydownEvents=t.keydownEvents(),this.outsidePointerEvents=t.outsidePointerEvents(),this.id=e.id,this.keydownEvents.subscribe(n=>{27===n.keyCode&&!this.disableClose&&!Oc(n)&&(n.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})})}close(t,e){if(this.containerInstance){const n=this.closed;this.containerInstance._closeInteractionType=e?.focusOrigin||"program",this.overlayRef.dispose(),n.next(t),n.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(t="",e=""){return this.overlayRef.updateSize({width:t,height:e}),this}addPanelClass(t){return this.overlayRef.addPanelClass(t),this}removePanelClass(t){return this.overlayRef.removePanelClass(t),this}}const u2=new ui("DialogScrollStrategy"),f4=new ui("DialogData"),m4=new ui("DefaultDialogConfig"),_4={provide:u2,deps:[qa],useFactory:function g4(i){return()=>i.scrollStrategies.block()}};let y4=0,d2=(()=>{class i{constructor(e,n,o,c,f,y){this._overlay=e,this._injector=n,this._defaultOptions=o,this._parentDialog=c,this._overlayContainer=f,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new ue,this._afterOpenedAtThisLevel=new ue,this._ariaHiddenElements=new Map,this.afterAllClosed=sg(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(gl(void 0))),this._scrollStrategy=y}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}open(e,n){(n={...this._defaultOptions||new Db,...n}).id=n.id||"cdk-dialog-"+y4++,n.id&&this.getDialogById(n.id);const c=this._getOverlayConfig(n),f=this._overlay.create(c),y=new dM(f,n),w=this._attachContainer(f,y,n);return y.containerInstance=w,this._attachDialogContent(e,y,w,n),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(y),y.closed.subscribe(()=>this._removeOpenDialog(y,!0)),this.afterOpened.next(y),y}closeAll(){pM(this.openDialogs,e=>e.close())}getDialogById(e){return this.openDialogs.find(n=>n.id===e)}ngOnDestroy(){pM(this._openDialogsAtThisLevel,e=>{!1===e.config.closeOnDestroy&&this._removeOpenDialog(e,!1)}),pM(this._openDialogsAtThisLevel,e=>e.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(e){const n=new wg({positionStrategy:e.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:e.scrollStrategy||this._scrollStrategy(),panelClass:e.panelClass,hasBackdrop:e.hasBackdrop,direction:e.direction,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,width:e.width,height:e.height,disposeOnNavigation:e.closeOnNavigation});return e.backdropClass&&(n.backdropClass=e.backdropClass),n}_attachContainer(e,n,o){const c=o.injector||o.viewContainerRef?.injector,f=[{provide:Db,useValue:o},{provide:dM,useValue:n},{provide:av,useValue:e}];let y;o.container?"function"==typeof o.container?y=o.container:(y=o.container.type,f.push(...o.container.providers(o))):y=h2;const w=new rv(y,o.viewContainerRef,Wr.create({parent:c||this._injector,providers:f}),o.componentFactoryResolver);return e.attach(w).instance}_attachDialogContent(e,n,o,c){if(e instanceof ml){const f=this._createInjector(c,n,o,void 0);let y={$implicit:c.data,dialogRef:n};c.templateContext&&(y={...y,..."function"==typeof c.templateContext?c.templateContext():c.templateContext}),o.attachTemplatePortal(new bg(e,null,y,f))}else{const f=this._createInjector(c,n,o,this._injector),y=o.attachComponentPortal(new rv(e,c.viewContainerRef,f,c.componentFactoryResolver));n.componentInstance=y.instance}}_createInjector(e,n,o,c){const f=e.injector||e.viewContainerRef?.injector,y=[{provide:f4,useValue:e.data},{provide:dM,useValue:n}];return e.providers&&("function"==typeof e.providers?y.push(...e.providers(n,e,o)):y.push(...e.providers)),e.direction&&(!f||!f.get(Bd,null,nn.Optional))&&y.push({provide:Bd,useValue:{value:e.direction,change:$i()}}),Wr.create({parent:f||c,providers:y})}_removeOpenDialog(e,n){const o=this.openDialogs.indexOf(e);o>-1&&(this.openDialogs.splice(o,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((c,f)=>{c?f.setAttribute("aria-hidden",c):f.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),n&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const e=this._overlayContainer.getContainerElement();if(e.parentElement){const n=e.parentElement.children;for(let o=n.length-1;o>-1;o--){const c=n[o];c!==e&&"SCRIPT"!==c.nodeName&&"STYLE"!==c.nodeName&&!c.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(c,c.getAttribute("aria-hidden")),c.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}}return i.\u0275fac=function(e){return new(e||i)(Pt(qa),Pt(Wr),Pt(m4,8),Pt(i,12),Pt(Tb),Pt(u2))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})();function pM(i,t){let e=i.length;for(;e--;)t(i[e])}let v4=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({providers:[d2,_4],imports:[Cg,sv,MU,sv]}),i})();function x4(i,t){if(1&i&&zn(0,"mat-pseudo-checkbox",4),2&i){const e=Jr();on("state",e.selected?"checked":"unchecked")("disabled",e.disabled)}}function b4(i,t){if(1&i&&(pi(0,"span",5),vn(1),xi()),2&i){const e=Jr();Ni(1),fh("(",e.group.label,")")}}const w4=["*"],E4=new ui("mat-sanity-checks",{providedIn:"root",factory:function C4(){return!0}});let Lr=(()=>{class i{constructor(e,n,o){this._sanityChecks=n,this._document=o,this._hasDoneGlobalChecks=!1,e._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!ZE()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[e])}}return i.\u0275fac=function(e){return new(e||i)(Pt(WP),Pt(E4,8),Pt(Pn))},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[iv,iv]}),i})();function Ab(i){return class extends i{constructor(...t){super(...t),this._disabled=!1}get disabled(){return this._disabled}set disabled(t){this._disabled=so(t)}}}function kb(i,t){return class extends i{constructor(...e){super(...e),this.defaultColor=t,this.color=t}get color(){return this._color}set color(e){const n=e||this.defaultColor;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}}}function Ib(i){return class extends i{constructor(...t){super(...t),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=so(t)}}}function m2(i,t=0){return class extends i{constructor(...e){super(...e),this._tabIndex=t,this.defaultTabIndex=t}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(e){this._tabIndex=null!=e?eM(e):this.defaultTabIndex}}}function g2(i){return class extends i{constructor(...t){super(...t),this.errorState=!1}updateErrorState(){const t=this.errorState,c=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);c!==t&&(this.errorState=c,this.stateChanges.next())}}}let fM=(()=>{class i{isErrorState(e,n){return!!(e&&e.invalid&&(e.touched||n&&n.submitted))}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),_2=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[Lr,Lr]}),i})();class S4{constructor(t,e,n,o=!1){this._renderer=t,this.element=e,this.config=n,this._animationForciblyDisabledThroughCss=o,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const y2={enterDuration:225,exitDuration:150},mM=Ky({passive:!0}),v2=["mousedown","touchstart"],x2=["mouseup","mouseleave","touchend","touchcancel"];class D4{constructor(t,e,n,o){this._target=t,this._ngZone=e,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,o.isBrowser&&(this._containerElement=gu(n))}fadeInRipple(t,e,n={}){const o=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),c={...y2,...n.animation};n.centered&&(t=o.left+o.width/2,e=o.top+o.height/2);const f=n.radius||function A4(i,t,e){const n=Math.max(Math.abs(i-e.left),Math.abs(i-e.right)),o=Math.max(Math.abs(t-e.top),Math.abs(t-e.bottom));return Math.sqrt(n*n+o*o)}(t,e,o),y=t-o.left,w=e-o.top,L=c.enterDuration,le=document.createElement("div");le.classList.add("mat-ripple-element"),le.style.left=y-f+"px",le.style.top=w-f+"px",le.style.height=2*f+"px",le.style.width=2*f+"px",null!=n.color&&(le.style.backgroundColor=n.color),le.style.transitionDuration=`${L}ms`,this._containerElement.appendChild(le);const ye=window.getComputedStyle(le),Xe=ye.transitionDuration,ot="none"===ye.transitionProperty||"0s"===Xe||"0s, 0s"===Xe,yt=new S4(this,le,n,ot);le.style.transform="scale3d(1, 1, 1)",yt.state=0,n.persistent||(this._mostRecentTransientRipple=yt);let jt=null;return!ot&&(L||c.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const Gt=()=>this._finishRippleTransition(yt),fi=()=>this._destroyRipple(yt);le.addEventListener("transitionend",Gt),le.addEventListener("transitioncancel",fi),jt={onTransitionEnd:Gt,onTransitionCancel:fi}}),this._activeRipples.set(yt,jt),(ot||!L)&&this._finishRippleTransition(yt),yt}fadeOutRipple(t){if(2===t.state||3===t.state)return;const e=t.element,n={...y2,...t.config.animation};e.style.transitionDuration=`${n.exitDuration}ms`,e.style.opacity="0",t.state=2,(t._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const e=gu(t);!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,this._registerEvents(v2))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(x2),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){0===t.state?this._startFadeOutTransition(t):2===t.state&&this._destroyRipple(t)}_startFadeOutTransition(t){const e=t===this._mostRecentTransientRipple,{persistent:n}=t.config;t.state=1,!n&&(!e||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){const e=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=3,null!==e&&(t.element.removeEventListener("transitionend",e.onTransitionEnd),t.element.removeEventListener("transitioncancel",e.onTransitionCancel)),t.element.remove()}_onMousedown(t){const e=rM(t),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!n&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!oM(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;for(let n=0;n<e.length;n++)this.fadeInRipple(e[n].clientX,e[n].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_registerEvents(t){this._ngZone.runOutsideAngular(()=>{t.forEach(e=>{this._triggerElement.addEventListener(e,this,mM)})})}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){this._triggerElement&&(v2.forEach(t=>{this._triggerElement.removeEventListener(t,this,mM)}),this._pointerUpEventsRegistered&&x2.forEach(t=>{this._triggerElement.removeEventListener(t,this,mM)}))}}const k4=new ui("mat-ripple-global-options");let Eg=(()=>{class i{constructor(e,n,o,c,f){this._elementRef=e,this._animationMode=f,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=c||{},this._rippleRenderer=new D4(this,n,e,o)}get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,n=0,o){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,n,{...this.rippleConfig,...o}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...e})}}return i.\u0275fac=function(e){return new(e||i)(ft(Zn),ft(En),ft(Aa),ft(k4,8),ft(mh,8))},i.\u0275dir=ci({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(e,n){2&e&&fs("mat-ripple-unbounded",n.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),i})(),Pb=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[Lr,Lr]}),i})(),I4=(()=>{class i{constructor(e){this._animationMode=e,this.state="unchecked",this.disabled=!1}}return i.\u0275fac=function(e){return new(e||i)(ft(mh,8))},i.\u0275cmp=Cr({type:i,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:8,hostBindings:function(e,n){2&e&&fs("mat-pseudo-checkbox-indeterminate","indeterminate"===n.state)("mat-pseudo-checkbox-checked","checked"===n.state)("mat-pseudo-checkbox-disabled",n.disabled)("_mat-animation-noopable","NoopAnimations"===n._animationMode)},inputs:{state:"state",disabled:"disabled"},decls:0,vars:0,template:function(e,n){},styles:['.mat-pseudo-checkbox{width:16px;height:16px;border:2px solid;border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox.mat-pseudo-checkbox-indeterminate{border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{top:5px;left:1px;width:10px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{top:2.4px;left:1px;width:8px;height:3px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}'],encapsulation:2,changeDetection:0}),i})(),P4=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[Lr]}),i})();const b2=new ui("MAT_OPTION_PARENT_COMPONENT"),w2=new ui("MatOptgroup");let O4=0;class C2{constructor(t,e=!1){this.source=t,this.isUserInput=e}}let R4=(()=>{class i{constructor(e,n,o,c){this._element=e,this._changeDetectorRef=n,this._parent=o,this.group=c,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+O4++,this.onSelectionChange=new Fn,this._stateChanges=new ue}get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(e){this._disabled=so(e)}get disableRipple(){return!(!this._parent||!this._parent.disableRipple)}get active(){return this._active}get viewValue(){return(this._getHostElement().textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(e,n){const o=this._getHostElement();"function"==typeof o.focus&&o.focus(n)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(e){(13===e.keyCode||32===e.keyCode)&&!Oc(e)&&(this._selectViaInteraction(),e.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getAriaSelected(){return this.selected||!this.multiple&&null}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const e=this.viewValue;e!==this._mostRecentViewValue&&(this._mostRecentViewValue=e,this._stateChanges.next())}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(e=!1){this.onSelectionChange.emit(new C2(this,e))}}return i.\u0275fac=function(e){iu()},i.\u0275dir=ci({type:i,inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}}),i})(),E2=(()=>{class i extends R4{constructor(e,n,o,c){super(e,n,o,c)}}return i.\u0275fac=function(e){return new(e||i)(ft(Zn),ft(Wa),ft(b2,8),ft(w2,8))},i.\u0275cmp=Cr({type:i,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-option","mat-focus-indicator"],hostVars:12,hostBindings:function(e,n){1&e&&Rn("click",function(){return n._selectViaInteraction()})("keydown",function(c){return n._handleKeydown(c)}),2&e&&(Qm("id",n.id),Ir("tabindex",n._getTabIndex())("aria-selected",n._getAriaSelected())("aria-disabled",n.disabled.toString()),fs("mat-selected",n.selected)("mat-option-multiple",n.multiple)("mat-active",n.active)("mat-option-disabled",n.disabled))},exportAs:["matOption"],features:[en],ngContentSelectors:w4,decls:5,vars:4,consts:[["class","mat-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mat-option-text"],["class","cdk-visually-hidden",4,"ngIf"],["mat-ripple","",1,"mat-option-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-option-pseudo-checkbox",3,"state","disabled"],[1,"cdk-visually-hidden"]],template:function(e,n){1&e&&(dh(),Pr(0,x4,1,2,"mat-pseudo-checkbox",0),pi(1,"span",1),ds(2),xi(),Pr(3,b4,2,1,"span",2),zn(4,"div",3)),2&e&&(on("ngIf",n.multiple),Ni(3),on("ngIf",n.group&&n.group._inert),Ni(1),on("matRippleTrigger",n._getHostElement())("matRippleDisabled",n.disabled||n.disableRipple))},dependencies:[Eg,Cy,I4],styles:['.mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative;cursor:pointer;outline:none;display:flex;flex-direction:row;max-width:100%;box-sizing:border-box;align-items:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px;vertical-align:middle}.mat-option .mat-icon svg{vertical-align:top}[dir=rtl] .mat-option .mat-icon{margin-left:16px;margin-right:0}.mat-option[aria-disabled=true]{-webkit-user-select:none;user-select:none;cursor:default}.mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:32px}[dir=rtl] .mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:16px;padding-right:32px}.mat-option.mat-active::before{content:""}.cdk-high-contrast-active .mat-option[aria-disabled=true]{opacity:.5}.cdk-high-contrast-active .mat-option.mat-selected:not(.mat-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-option.mat-selected:not(.mat-option-multiple)::after{right:auto;left:16px}.mat-option-text{display:inline-block;flex-grow:1;overflow:hidden;text-overflow:ellipsis}.mat-option .mat-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}'],encapsulation:2,changeDetection:0}),i})();function gM(i,t,e){if(e.length){let n=t.toArray(),o=e.toArray(),c=0;for(let f=0;f<i+1;f++)n[f].group&&n[f].group===o[c]&&c++;return c}return 0}let Ob=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[Pb,rf,Lr,P4]}),i})();class S2{}const _u="*";function gf(i,t){return{type:7,name:i,definitions:t,options:{}}}function xh(i,t=null){return{type:4,styles:t,timings:i}}function T2(i,t=null){return{type:3,steps:i,options:t}}function D2(i,t=null){return{type:2,steps:i,options:t}}function ts(i){return{type:6,styles:i,offset:null}}function bh(i,t,e){return{type:0,name:i,styles:t,options:e}}function Rc(i,t,e=null){return{type:1,expr:i,animation:t,options:e}}function _M(i=null){return{type:9,options:i}}function yM(i,t,e=null){return{type:11,selector:i,animation:t,options:e}}function A2(i){Promise.resolve().then(i)}class cv{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){A2(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}class k2{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,o=0;const c=this.players.length;0==c?A2(()=>this._onFinish()):this.players.forEach(f=>{f.onDone(()=>{++e==c&&this._onFinish()}),f.onDestroy(()=>{++n==c&&this._onDestroy()}),f.onStart(()=>{++o==c&&this._onStart()})}),this.totalTime=this.players.reduce((f,y)=>Math.max(f,y.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(n=>{const o=n.totalTime?Math.min(1,e/n.totalTime):1;n.setPosition(o)})}getPosition(){const t=this.players.reduce((e,n)=>null===e||n.totalTime>e.totalTime?n:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}function F4(i,t){}const Mg={params:{enterAnimationDuration:"150ms",exitAnimationDuration:"75ms"}},N4={dialogContainer:gf("dialogContainer",[bh("void, exit",ts({opacity:0,transform:"scale(0.7)"})),bh("enter",ts({transform:"none"})),Rc("* => enter",T2([xh("{{enterAnimationDuration}} cubic-bezier(0, 0, 0.2, 1)",ts({transform:"none",opacity:1})),yM("@*",_M(),{optional:!0})]),Mg),Rc("* => void, * => exit",T2([xh("{{exitAnimationDuration}} cubic-bezier(0.4, 0.0, 0.2, 1)",ts({opacity:0})),yM("@*",_M(),{optional:!0})]),Mg)])};class Rb{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0,this.enterAnimationDuration=Mg.params.enterAnimationDuration,this.exitAnimationDuration=Mg.params.exitAnimationDuration}}let B4=(()=>{class i extends h2{constructor(e,n,o,c,f,y,w,L){super(e,n,o,c,f,y,w,L),this._animationStateChanged=new Fn}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(e){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:e})}}return i.\u0275fac=function(e){return new(e||i)(ft(Zn),ft(nM),ft(Pn,8),ft(Rb),ft(bb),ft(En),ft(av),ft(pf))},i.\u0275cmp=Cr({type:i,selectors:[["ng-component"]],features:[en],decls:0,vars:0,template:function(e,n){},encapsulation:2}),i})(),z4=(()=>{class i extends B4{constructor(e,n,o,c,f,y,w,L,le){super(e,n,o,c,f,y,w,le),this._changeDetectorRef=L,this._state="enter"}_onAnimationDone({toState:e,totalTime:n}){"enter"===e?this._openAnimationDone(n):"exit"===e&&this._animationStateChanged.next({state:"closed",totalTime:n})}_onAnimationStart({toState:e,totalTime:n}){"enter"===e?this._animationStateChanged.next({state:"opening",totalTime:n}):("exit"===e||"void"===e)&&this._animationStateChanged.next({state:"closing",totalTime:n})}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}_getAnimationState(){return{value:this._state,params:{enterAnimationDuration:this._config.enterAnimationDuration||Mg.params.enterAnimationDuration,exitAnimationDuration:this._config.exitAnimationDuration||Mg.params.exitAnimationDuration}}}}return i.\u0275fac=function(e){return new(e||i)(ft(Zn),ft(nM),ft(Pn,8),ft(Rb),ft(bb),ft(En),ft(av),ft(Wa),ft(pf))},i.\u0275cmp=Cr({type:i,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-dialog-container"],hostVars:7,hostBindings:function(e,n){1&e&&q0("@dialogContainer.start",function(c){return n._onAnimationStart(c)})("@dialogContainer.done",function(c){return n._onAnimationDone(c)}),2&e&&(Qm("id",n._config.id),Ir("aria-modal",n._config.ariaModal)("role",n._config.role)("aria-labelledby",n._config.ariaLabel?null:n._ariaLabelledBy)("aria-label",n._config.ariaLabel)("aria-describedby",n._config.ariaDescribedBy||null),K0("@dialogContainer",n._getAnimationState()))},features:[en],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,n){1&e&&Pr(0,F4,0,0,"ng-template",0)},dependencies:[ov],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;box-sizing:content-box;margin-bottom:-24px}.mat-dialog-actions.mat-dialog-actions-align-center,.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions.mat-dialog-actions-align-end,.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}"],encapsulation:2,data:{animation:[N4.dialogContainer]}}),i})();class I2{constructor(t,e,n){this._ref=t,this._containerInstance=n,this._afterOpened=new ue,this._beforeClosed=new ue,this._state=0,this.disableClose=e.disableClose,this.id=t.id,n._animationStateChanged.pipe(to(o=>"opened"===o.state),eo(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),n._animationStateChanged.pipe(to(o=>"closed"===o.state),eo(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),t.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),ys(this.backdropClick(),this.keydownEvents().pipe(to(o=>27===o.keyCode&&!this.disableClose&&!Oc(o)))).subscribe(o=>{this.disableClose||(o.preventDefault(),function V4(i,t,e){i._closeInteractionType=t,i.close(e)}(this,"keydown"===o.type?"keyboard":"mouse"))})}close(t){this._result=t,this._containerInstance._animationStateChanged.pipe(to(e=>"closing"===e.state),eo(1)).subscribe(e=>{this._beforeClosed.next(t),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),e.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(t){let e=this._ref.config.positionStrategy;return t&&(t.left||t.right)?t.left?e.left(t.left):e.right(t.right):e.centerHorizontally(),t&&(t.top||t.bottom)?t.top?e.top(t.top):e.bottom(t.bottom):e.centerVertically(),this._ref.updatePosition(),this}updateSize(t="",e=""){return this._ref.updateSize(t,e),this}addPanelClass(t){return this._ref.addPanelClass(t),this}removePanelClass(t){return this._ref.removePanelClass(t),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const j4=new ui("MatDialogData"),U4=new ui("mat-dialog-default-options"),P2=new ui("mat-dialog-scroll-strategy"),G4={provide:P2,deps:[qa],useFactory:function H4(i){return()=>i.scrollStrategies.block()}};let $4=0,W4=(()=>{class i{constructor(e,n,o,c,f,y,w,L,le,ye){this._overlay=e,this._defaultOptions=o,this._parentDialog=c,this._dialogRefConstructor=w,this._dialogContainerType=L,this._dialogDataToken=le,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new ue,this._afterOpenedAtThisLevel=new ue,this._idPrefix="mat-dialog-",this.afterAllClosed=sg(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(gl(void 0))),this._scrollStrategy=y,this._dialog=n.get(d2)}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(e,n){let o;(n={...this._defaultOptions||new Rb,...n}).id=n.id||`${this._idPrefix}${$4++}`,n.scrollStrategy=n.scrollStrategy||this._scrollStrategy();const c=this._dialog.open(e,{...n,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:Rb,useValue:n},{provide:Db,useValue:n}]},templateContext:()=>({dialogRef:o}),providers:(f,y,w)=>(o=new this._dialogRefConstructor(f,n,w),o.updatePosition(n?.position),[{provide:this._dialogContainerType,useValue:w},{provide:this._dialogDataToken,useValue:y.data},{provide:this._dialogRefConstructor,useValue:o}])});return o.componentInstance=c.componentInstance,this.openDialogs.push(o),this.afterOpened.next(o),o.afterClosed().subscribe(()=>{const f=this.openDialogs.indexOf(o);f>-1&&(this.openDialogs.splice(f,1),this.openDialogs.length||this._getAfterAllClosed().next())}),o}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(e){return this.openDialogs.find(n=>n.id===e)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(e){let n=e.length;for(;n--;)e[n].close()}}return i.\u0275fac=function(e){iu()},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})(),O2=(()=>{class i extends W4{constructor(e,n,o,c,f,y,w,L){super(e,n,c,y,w,f,I2,z4,j4,L)}}return i.\u0275fac=function(e){return new(e||i)(Pt(qa),Pt(Wr),Pt(xy,8),Pt(U4,8),Pt(P2),Pt(i,12),Pt(Tb),Pt(mh,8))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})(),X4=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=ci({type:i,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-dialog-content"]}),i})(),q4=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({providers:[O2,G4],imports:[v4,Cg,sv,Lr,Lr]}),i})();const Y4=["mat-button",""],Z4=["*"],Q4=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],J4=kb(Ab(Ib(class{constructor(i){this._elementRef=i}})));let Lb=(()=>{class i extends J4{constructor(e,n,o){super(e),this._focusMonitor=n,this._animationMode=o,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const c of Q4)this._hasHostAttributes(c)&&this._getHostElement().classList.add(c);e.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(e,n){e?this._focusMonitor.focusVia(this._getHostElement(),e,n):this._getHostElement().focus(n)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...e){return e.some(n=>this._getHostElement().hasAttribute(n))}}return i.\u0275fac=function(e){return new(e||i)(ft(Zn),ft(pf),ft(mh,8))},i.\u0275cmp=Cr({type:i,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(e,n){if(1&e&&$a(Eg,5),2&e){let o;Dr(o=Ar())&&(n.ripple=o.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(e,n){2&e&&(Ir("disabled",n.disabled||null),fs("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-button-disabled",n.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[en],attrs:Y4,ngContentSelectors:Z4,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(e,n){1&e&&(dh(),pi(0,"span",0),ds(1),xi(),zn(2,"span",1)(3,"span",2)),2&e&&(Ni(2),fs("mat-button-ripple-round",n.isRoundButton||n.isIconButton),on("matRippleDisabled",n._isRippleDisabled())("matRippleCentered",n.isIconButton)("matRippleTrigger",n._getHostElement()))},dependencies:[Eg],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}.mat-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.mat-flat-button::before,.mat-raised-button::before,.mat-fab::before,.mat-mini-fab::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-stroked-button::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}"],encapsulation:2,changeDetection:0}),i})(),R2=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[Pb,Lr,Lr]}),i})();function eH(i,t){if(1&i){const e=Qp();pi(0,"div",2)(1,"button",3),Rn("click",function(){return Io(e),lr(Jr().action())}),vn(2),xi()()}if(2&i){const e=Jr();Ni(2),Ac(e.data.action)}}function tH(i,t){}const L2=new ui("MatSnackBarData");class Fb{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}const iH=Math.pow(2,31)-1;class xM{constructor(t,e){this._overlayRef=e,this._afterDismissed=new ue,this._afterOpened=new ue,this._onAction=new ue,this._dismissedByAction=!1,this.containerInstance=t,t._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(t){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(t,iH))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}let nH=(()=>{class i{constructor(e,n){this.snackBarRef=e,this.data=n}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}}return i.\u0275fac=function(e){return new(e||i)(ft(xM),ft(L2))},i.\u0275cmp=Cr({type:i,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-simple-snackbar"],decls:3,vars:2,consts:[[1,"mat-simple-snack-bar-content"],["class","mat-simple-snackbar-action",4,"ngIf"],[1,"mat-simple-snackbar-action"],["mat-button","",3,"click"]],template:function(e,n){1&e&&(pi(0,"span",0),vn(1),xi(),Pr(2,eH,3,1,"div",1)),2&e&&(Ni(1),Ac(n.data.message),Ni(1),on("ngIf",n.hasAction))},dependencies:[Cy,Lb],styles:[".mat-simple-snackbar{display:flex;justify-content:space-between;align-items:center;line-height:20px;opacity:1}.mat-simple-snackbar-action{flex-shrink:0;margin:-8px -8px -8px 8px}.mat-simple-snackbar-action button{max-height:36px;min-width:0}[dir=rtl] .mat-simple-snackbar-action{margin-left:-8px;margin-right:8px}.mat-simple-snack-bar-content{overflow:hidden;text-overflow:ellipsis}"],encapsulation:2,changeDetection:0}),i})();const rH={snackBarState:gf("state",[bh("void, hidden",ts({transform:"scale(0.8)",opacity:0})),bh("visible",ts({transform:"scale(1)",opacity:1})),Rc("* => visible",xh("150ms cubic-bezier(0, 0, 0.2, 1)")),Rc("* => void, * => hidden",xh("75ms cubic-bezier(0.4, 0.0, 1, 1)",ts({opacity:0})))])};let oH=(()=>{class i extends Sb{constructor(e,n,o,c,f){super(),this._ngZone=e,this._elementRef=n,this._changeDetectorRef=o,this._platform=c,this.snackBarConfig=f,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new ue,this._onExit=new ue,this._onEnter=new ue,this._animationState="void",this.attachDomPortal=y=>{this._assertNotAttached();const w=this._portalOutlet.attachDomPortal(y);return this._afterPortalAttached(),w},this._live="assertive"!==f.politeness||f.announcementMessage?"off"===f.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(e){this._assertNotAttached();const n=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),n}attachTemplatePortal(e){this._assertNotAttached();const n=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),n}onAnimationEnd(e){const{fromState:n,toState:o}=e;if(("void"===o&&"void"!==n||"hidden"===o)&&this._completeExit(),"visible"===o){const c=this._onEnter;this._ngZone.run(()=>{c.next(),c.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._ngZone.run(()=>{this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId)}),this._onExit}ngOnDestroy(){this._destroyed=!0,this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.pipe(eo(1)).subscribe(()=>{this._ngZone.run(()=>{this._onExit.next(),this._onExit.complete()})})}_afterPortalAttached(){const e=this._elementRef.nativeElement,n=this.snackBarConfig.panelClass;n&&(Array.isArray(n)?n.forEach(o=>e.classList.add(o)):e.classList.add(n))}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{const e=this._elementRef.nativeElement.querySelector("[aria-hidden]"),n=this._elementRef.nativeElement.querySelector("[aria-live]");if(e&&n){let o=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&e.contains(document.activeElement)&&(o=document.activeElement),e.removeAttribute("aria-hidden"),n.appendChild(e),o?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}}return i.\u0275fac=function(e){return new(e||i)(ft(En),ft(Zn),ft(Wa),ft(Aa),ft(Fb))},i.\u0275dir=ci({type:i,viewQuery:function(e,n){if(1&e&&$a(ov,7),2&e){let o;Dr(o=Ar())&&(n._portalOutlet=o.first)}},features:[en]}),i})(),sH=(()=>{class i extends oH{_afterPortalAttached(){super._afterPortalAttached(),"center"===this.snackBarConfig.horizontalPosition&&this._elementRef.nativeElement.classList.add("mat-snack-bar-center"),"top"===this.snackBarConfig.verticalPosition&&this._elementRef.nativeElement.classList.add("mat-snack-bar-top")}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Hn(i)))(n||i)}}(),i.\u0275cmp=Cr({type:i,selectors:[["snack-bar-container"]],hostAttrs:[1,"mat-snack-bar-container"],hostVars:1,hostBindings:function(e,n){1&e&&q0("@state.done",function(c){return n.onAnimationEnd(c)}),2&e&&K0("@state",n._animationState)},features:[en],decls:3,vars:2,consts:[["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(e,n){1&e&&(pi(0,"div",0),Pr(1,tH,0,0,"ng-template",1),xi(),zn(2,"div")),2&e&&(Ni(2),Ir("aria-live",n._live)("role",n._role))},dependencies:[ov],styles:[".mat-snack-bar-container{border-radius:4px;box-sizing:border-box;display:block;margin:24px;max-width:33vw;min-width:344px;padding:14px 16px;min-height:48px;transform-origin:center}.cdk-high-contrast-active .mat-snack-bar-container{border:solid 1px}.mat-snack-bar-handset{width:100%}.mat-snack-bar-handset .mat-snack-bar-container{margin:8px;max-width:100%;min-width:0;width:100%}"],encapsulation:2,data:{animation:[rH.snackBarState]}}),i})(),F2=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[Cg,sv,rf,R2,Lr,Lr]}),i})();const N2=new ui("mat-snack-bar-default-options",{providedIn:"root",factory:function aH(){return new Fb}});let lH=(()=>{class i{constructor(e,n,o,c,f,y){this._overlay=e,this._live=n,this._injector=o,this._breakpointObserver=c,this._parentSnackBar=f,this._defaultConfig=y,this._snackBarRefAtThisLevel=null}get _openedSnackBarRef(){const e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}openFromComponent(e,n){return this._attach(e,n)}openFromTemplate(e,n){return this._attach(e,n)}open(e,n="",o){const c={...this._defaultConfig,...o};return c.data={message:e,action:n},c.announcementMessage===e&&(c.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,c)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,n){const c=Wr.create({parent:n&&n.viewContainerRef&&n.viewContainerRef.injector||this._injector,providers:[{provide:Fb,useValue:n}]}),f=new rv(this.snackBarContainerComponent,n.viewContainerRef,c),y=e.attach(f);return y.instance.snackBarConfig=n,y.instance}_attach(e,n){const o={...new Fb,...this._defaultConfig,...n},c=this._createOverlay(o),f=this._attachSnackBarContainer(c,o),y=new xM(f,c);if(e instanceof ml){const w=new bg(e,null,{$implicit:o.data,snackBarRef:y});y.instance=f.attachTemplatePortal(w)}else{const w=this._createInjector(o,y),L=new rv(e,void 0,w),le=f.attachComponentPortal(L);y.instance=le.instance}return this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait)").pipe(As(c.detachments())).subscribe(w=>{c.overlayElement.classList.toggle(this.handsetCssClass,w.matches)}),o.announcementMessage&&f._onAnnounce.subscribe(()=>{this._live.announce(o.announcementMessage,o.politeness)}),this._animateSnackBar(y,o),this._openedSnackBarRef=y,this._openedSnackBarRef}_animateSnackBar(e,n){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),n.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter(),n.duration&&n.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(n.duration))}_createOverlay(e){const n=new wg;n.direction=e.direction;let o=this._overlay.position().global();const c="rtl"===e.direction,f="left"===e.horizontalPosition||"start"===e.horizontalPosition&&!c||"end"===e.horizontalPosition&&c,y=!f&&"center"!==e.horizontalPosition;return f?o.left("0"):y?o.right("0"):o.centerHorizontally(),"top"===e.verticalPosition?o.top("0"):o.bottom("0"),n.positionStrategy=o,this._overlay.create(n)}_createInjector(e,n){return Wr.create({parent:e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,providers:[{provide:xM,useValue:n},{provide:L2,useValue:e.data}]})}}return i.\u0275fac=function(e){return new(e||i)(Pt(qa),Pt(sM),Pt(Wr),Pt(iM),Pt(i,12),Pt(N2))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})(),B2=(()=>{class i extends lH{constructor(e,n,o,c,f,y){super(e,n,o,c,f,y),this.simpleSnackBarComponent=nH,this.snackBarContainerComponent=sH,this.handsetCssClass="mat-snack-bar-handset"}}return i.\u0275fac=function(e){return new(e||i)(Pt(qa),Pt(sM),Pt(Wr),Pt(iM),Pt(i,12),Pt(N2))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:F2}),i})();const cH=["*",[["mat-card-footer"]]],hH=["*","mat-card-footer"];let hv,uv,z2=(()=>{class i{constructor(e){this._animationMode=e}}return i.\u0275fac=function(e){return new(e||i)(ft(mh,8))},i.\u0275cmp=Cr({type:i,selectors:[["mat-card"]],hostAttrs:[1,"mat-card","mat-focus-indicator"],hostVars:2,hostBindings:function(e,n){2&e&&fs("_mat-animation-noopable","NoopAnimations"===n._animationMode)},exportAs:["matCard"],ngContentSelectors:hH,decls:2,vars:0,template:function(e,n){1&e&&(dh(cH),ds(0),ds(1,1))},styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:block;position:relative;padding:16px;border-radius:4px}.mat-card._mat-animation-noopable{transition:none !important;animation:none !important}.mat-card>.mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card>.mat-divider-horizontal{left:auto;right:0}.mat-card>.mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card>.mat-divider-horizontal.mat-divider-inset{margin-right:0}.cdk-high-contrast-active .mat-card{outline:solid 1px}.mat-card-actions,.mat-card-subtitle,.mat-card-content{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px;display:block;overflow:hidden}.mat-card-image img{width:100%}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media(max-width: 599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card>:first-child,.mat-card-content>:first-child{margin-top:0}.mat-card>:last-child:not(.mat-card-footer),.mat-card-content>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions:not(.mat-card-actions-align-end) .mat-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-raised-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-actions-align-end .mat-button:last-child,.mat-card-actions-align-end .mat-raised-button:last-child,.mat-card-actions-align-end .mat-stroked-button:last-child{margin-left:0;margin-right:0}.mat-card-title:not(:first-child),.mat-card-subtitle:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}"],encapsulation:2,changeDetection:0}),i})(),uH=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[Lr,Lr]}),i})();function dH(i,t){if(1&i&&(pi(0,"th"),vn(1),xi()),2&i){const e=t.$implicit;Ni(1),Ac(e)}}function pH(i,t){if(1&i&&(pi(0,"td"),zn(1,"span",15)(2,"br"),pi(3,"span",16),vn(4),xi(),zn(5,"br"),pi(6,"span"),vn(7),xi(),zn(8,"br"),pi(9,"div"),zn(10,"span",17),pi(11,"span",18),vn(12),xi()(),zn(13,"br"),pi(14,"span"),vn(15),xi()()),2&i){const e=t.$implicit;Ni(1),fl(e.iconStyle),Ni(3),fh("",e.temp," \xb0C"),Ni(3),fh("",e.rain," mm"),Ni(3),fl(e.windDirStyle),Ni(2),Ac(e.windDir),Ni(3),fh("",e.windSpeed," m/s")}}Is(407)(Od),Is(761)(Od),hv="Moscow",uv="RU";let dv=(()=>{class i{constructor(e,n,o,c,f){this.service=e,this.dialog=n,this._snackBar=o,this.router=c,this.Route=f,this.cities=[{country:"RU",name:"Moscow"},{country:"ES",name:"Madrid"},{country:"AM",name:"Yerevan"},{country:"DE",name:"Berlin"},{country:"GB",name:"London"},{country:"US",name:"New York City"},{country:"JP",name:"Kyoto"},{country:"CA",name:"Ottawa"},{country:"IT",name:"Rome"},{country:"GE",name:"Tbilisi"},{country:"JP",name:"Tokyo"}],this.selected=this.cities[0],this.change_wind_check=!0,this.selectedType_form=new hb("spline"),this.selectedType="spline",this.longitude=0,this.latitude=0,this.menu_text="Extended query by parameters",this.selected_temp=new hb("C"),this.selected_unit_celsius=!1,this.countries_list=[[],[]],this.cities_list=[[],[]],this.check_box=!1,this.humidity_chartOptions_area={chart:{type:"areaspline",backgroundColor:"transparent",style:{fontFamily:'Roboto, "Helvetica Neue", sans-serif',fontWeight:"lighter"},height:"100%"},credits:{enabled:!1},data:{dateFormat:"dd/mm/YYYY"},title:{align:"left",useHTML:!0,text:"<img class='chart_title_icon' src='https://www.svgrepo.com/show/12100/drop.svg' alt='' /><p>Humidity</p>",y:4},yAxis:{max:100,gridLineColor:"rgba(20,20,20,.3)",title:{text:""},labels:{enabled:!0}},xAxis:{type:"datetime",crosshair:{color:"rgb(240, 175, 0)",width:2},plotLines:[{zIndex:9,color:"#14143d",width:2,value:0}],labels:{enabled:!0}},tooltip:{valueSuffix:" %"},legend:{enabled:!1},series:[{name:"Humidity",data:0}],plotOptions:{areaspline:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"rgba(50, 88, 227, 1)"],[1,"rgba(184, 197, 242, .8)"]]}},line:{dataLabels:{enabled:!0}},series:{color:"#444",threshold:-1/0,marker:{enabled:!1}}}},this.pressure_chartOptions_area={chart:{type:"areaspline",backgroundColor:"transparent",style:{fontFamily:'Roboto, "Helvetica Neue", sans-serif',fontWeight:"lighter"},height:"100%"},credits:{enabled:!1},data:{dateFormat:"dd/mm/YYYY"},title:{align:"left",useHTML:!0,text:"<img class='chart_title_icon' src='https://www.svgrepo.com/show/41424/barometer.svg' alt='' /><p>Pressure</p>",y:4},yAxis:{gridLineColor:"rgba(20,20,20,.3)",title:{text:""},labels:{enabled:!0}},xAxis:{type:"datetime",crosshair:{color:"rgb(240, 175, 0)",width:2},plotLines:[{zIndex:9,color:"#14143d",width:2,value:0}],labels:{enabled:!0}},tooltip:{valueSuffix:" mm Hg"},legend:{enabled:!1},series:[{name:"Surface pressure",data:700}],plotOptions:{areaspline:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"rgba(50, 88, 227, 1)"],[1,"rgba(184, 197, 242, .8)"]]}},line:{dataLabels:{enabled:!0}},series:{color:"#444",threshold:-1/0,marker:{enabled:!1}}}},this.wind_chartOptions_area={chart:{type:"areaspline",backgroundColor:"transparent",style:{fontFamily:'Roboto, "Helvetica Neue", sans-serif',fontWeight:"lighter"},height:"100%"},credits:{enabled:!1},data:{dateFormat:"dd/mm/YYYY"},title:{align:"left",useHTML:!0,text:"<img class='chart_title_icon' src='https://www.svgrepo.com/show/76131/wind.svg' alt='' /><p>Wind speed</p>",y:4},yAxis:{gridLineColor:"rgba(20,20,20,.3)",title:{text:""},labels:{enabled:!0}},tooltip:{valueSuffix:" m/s"},xAxis:{type:"datetime",crosshair:{color:"rgb(240, 175, 0)",width:2},plotLines:[{zIndex:9,color:"#14143d",width:2,value:0}],labels:{enabled:!0}},legend:{enabled:!1},series:[{name:"Wind speed",data:0,tooltip:{valueSuffix:" m/s"}},{type:"scatter",name:"Wind direction",data:0,tooltip:{valueSuffix:" *"},pointWidth:200,borderColor:"transparent"}],plotOptions:{areaspline:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"rgba(50, 88, 227, 1)"],[1,"rgba(184, 197, 242, .8)"]]}},line:{dataLabels:{enabled:!0}},scatter:{marker:{enabled:!0}},series:{color:"#444",threshold:-1/0,marker:{enabled:!1}}}},this.chartOptions={chart:{type:this.selectedType,zoomType:"x",backgroundColor:"transparent",style:{fontFamily:'Roboto, "Helvetica Neue", sans-serif',fontWeight:"lighter"}},annotations:[{labels:[{point:{x:0,y:0},text:"Label",backgroundColor:"greenyellow",style:{color:"black"}}]}],credits:{enabled:!1},data:{dateFormat:"dd/mm/YYYY"},title:{align:"left",useHTML:!0,text:"",y:4},xAxis:{lineColor:"rgba(20,20,20,.5)",type:"datetime",crosshair:{color:"rgb(240, 175, 0)",width:2},plotLines:[{zIndex:9,color:"#FF0000",width:2,value:0}]},yAxis:{gridLineColor:"rgba(20,20,20,.3)",title:{text:"Temperature \xb0C"}},tooltip:{valueSuffix:" \xb0C"},legend:{enabled:!1},series:[{name:"Tokyo",data:0}],plotOptions:{areaspline:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"rgb(233, 75, 75)"],[1,"rgba(79, 98, 204, 0.7)"]]}},line:{dataLabels:{enabled:!0}},series:{color:"rgba(20,20,20,.5)",borderColor:"transparent",threshold:-1/0,marker:{enabled:!1}}}},this.wind_chartOptions_gauge={chart:{height:"100%",type:"gauge",backgroundColor:"transparent",style:{fontFamily:'Roboto, "Helvetica Neue", sans-serif',fontWeight:"lighter"}},credits:{enabled:!1},title:{align:"left",useHTML:!0,text:"<img class='chart_title_icon' src='https://www.svgrepo.com/show/76131/wind.svg' alt='' /><p>Wind speed and direction</p>",y:4},pane:{startAngle:0,endAngle:360,background:null,center:["50%","50%"],size:"80%"},series:[{name:"",type:"gauge",data:[82],tooltip:{valueSuffix:""},dataLabels:{enabled:!1,borderWidth:0},dial:{backgroundColor:"white",borderWidth:1,borderColor:"black",radius:"90%",topWidth:1,baseWidth:30,rearLength:-60,baseLength:60}},{name:"Wind speed",dataLabels:{zIndex:9,format:"{y} m/s",borderWidth:0,y:-14,color:"#FFFFFF",style:{fontSize:"14px"}},dial:{radius:0}}],plotOptions:{series:{type:"gauge"},gauge:{pivot:{radius:0}}},yAxis:[{offset:-10,lineWidth:0,min:0,max:360,minorTicks:!0,tickColor:"rgba(20,20,20,.5)",tickPixelInterval:5,tickPositions:[0,20,40,60,80,100,120,140,160,180,200,220,240,260,280,300,320,340],tickPosition:"outside",minorTickPosition:"outside",minorTickLength:10,tickLength:20,tickWidth:3,rotation:15,labels:{enabled:!0,distance:30}},{lineWidth:0,min:0,max:4,tickWidth:0,categories:["N","E","S","W"],tickPositions:[0,1,2,3]}]},this.RouteLat=0,this.RouteLon=0,this.table_header_time=[],this.table_body_temp=[],this.table_body_rain=[],this.table_body_rain_pers=[],this.table_body_wind_speed=[],this.table_body_wind_direction=[],this.table_body_cloud=[],this.table_array=[],this.table_array_class=[],this.form=new ob({}),this.weather_icon_style={"background-image":"url(https://cdn-icons-png.flaticon.com/512/869/869869.png)"},this.style_hourly_weather={display:"none"}}ngOnInit(){this.RouteLat=Number(this.Route.snapshot.paramMap.get("latitude")),this.RouteLon=Number(this.Route.snapshot.paramMap.get("longitude")),hv="Moscow",uv="RU",this.style_hourly_weather={display:"block"},this.Route.component==i?this.get_forecast(this.RouteLat,this.RouteLon,"",this.selected_unit_celsius):(this.style_hourly_weather={display:"none"},this.getUpToData(uv,hv,this.selected_unit_celsius))}ngAfterViewInit(){}getUpToData(e,n,o){let c,f;this.service.getCityJson().subscribe(y=>{let w=JSON.stringify(y);for(let L of JSON.parse(w))L.name==n&&L.country==e&&(c=L.lat,f=L.lng);null!=c||null!=f?this.get_forecast(c,f,n,o):this._snackBar.open("No Such country","Ok")})}get_forecast(e,n,o,c){this.service.getPosts(e,n,c).subscribe({next:f=>{let y,ye,Be,Xe,yt,Gt,fi,Xi,w=[],L=[],le=(new Date).toUTCString(),ot=[],jt=[],qt=[],Mi=[];ye=""!==o?`<img class='chart_title_icon' src='https://www.svgrepo.com/show/199819/thermometer-temperature.svg' alt='' /><p>Temperature in ${o}</p>`:`<img class='chart_title_icon' src='https://www.svgrepo.com/show/199819/thermometer-temperature.svg' alt='' /><p>Temperature by ${e}\xb0N ${n}\xb0E</p>`;let $s,zr=!1;y=f,w=y.hourly,Xi=Date.parse(le)+1e3*y.utc_offset_seconds,$s=y.utc_offset_seconds>=0?"+"+String(y.utc_offset_seconds/3600):String(y.utc_offset_seconds/3600),this.localTimezone=y.timezone+" (UTC"+$s+")",console.log(this.localTimezone),this.latitudeS=y.latitude,this.longitudeS=y.longitude;let ka=new Date(Xi).getUTCHours().toString().padStart(2,"0"),Ia=new Date(Xi).getUTCMinutes().toString().padStart(2,"0"),Ud=new Date(Xi).getUTCDate().toString().padStart(2,"0"),Lc=new Date(Xi).getUTCMonth().toString().padStart(2,"0"),vl=new Date(Xi).getUTCFullYear().toString().padStart(4,"0");this.localTime=`${ka}:${Ia} ${Ud}.${Lc}.${vl}`;let Hd=36e5*Math.round(Xi/36e5),Ch=1e4,Bi=1e4,_i=0,ln=0;for(let Vr of w.time){if(L[_i]=[1e3*(Vr+y.utc_offset_seconds)],zr&&(Ch=_i+24,zr=!1),_i<=Ch&&(ot[_i]=[1e3*(Vr+y.utc_offset_seconds)],jt[_i]=[1e3*(Vr+y.utc_offset_seconds)],qt[_i]=[1e3*(Vr+y.utc_offset_seconds)],Mi[_i]=[1e3*(Vr+y.utc_offset_seconds)]),Number(L[_i][0])==Hd&&(Be=w.temperature_2m[_i],Xe=w.relativehumidity_2m[_i],yt=Math.round(w.surface_pressure[_i]/1.333),Gt=w.windspeed_10m[_i],fi=w.winddirection_10m[_i],zr=!0,Bi=_i),_i>=Bi&&_i<=Ch){let ao=new Date(1e3*(Vr+y.utc_offset_seconds)),xl=new Date(ao.getTime()+6e4*ao.getTimezoneOffset()),jr=xl.getHours(),lw=xl.getMinutes(),ZM=xl.getDate(),ks=xl.getMonth()+1,yu=`${ZM.toString().padStart(2,"0")}.${ks.toString().padStart(2,"0")}\n${jr.toString().padStart(2,"0")}:${lw.toString().padStart(2,"0")}`;this.table_header_time[ln]=[yu];let aa=this.calc_wind_dir(w.winddirection_10m[_i]),Fc=0,Dg=!1,YO=!1,Gd="",xv="";switch((jr>=21||jr<=7)&&(xv="-night"),w.cloudcover[_i]>=25&&(Fc=1),w.cloudcover[_i]>=60&&(Fc=2),w.rain[_i]>0&&(Dg=!0),w.snowfall[_i]>0&&(YO=!0),!0){case Dg:Gd=1==(2==Fc)?"background-image: url(assets/rain.png)":`background-image: url(assets/clear-rain${xv}.png)`;break;case YO:Gd=1==(2==Fc)?"background-image: url(assets/snow.png)":`background-image: url(assets/clear-snow${xv}.png)`;break;case 2==Fc:Gd="background-image: url(assets/cloud.png)";break;case 1==Fc:Gd=`background-image: url(assets/clear-cloud${xv}.png)`;break;default:Gd=`background-image: url(assets/clear${xv}.png); background-size: 80%;`}this.table_array_class[ln]={temp:w.temperature_2m[_i],rain:w.precipitation[_i],cloud:w.cloudcover[_i],windDir:aa[0],windDirStyle:aa[1],windSpeed:w.windspeed_10m[_i],iconStyle:Gd},ln++}_i++}_i=0;for(let Vr of w.temperature_2m)L[_i].push(Vr),_i++;_i=0;for(let Vr of w.relativehumidity_2m){if(_i==ot.length)break;ot[_i].push(Vr),_i++}_i=0;for(let Vr of w.surface_pressure){if(_i==ot.length)break;jt[_i].push(Math.round(Vr/1.333)),_i++}_i=0;for(let Vr of w.windspeed_10m){if(_i==ot.length)break;qt[_i].push(Vr),_i++}_i=0;for(let Vr of w.winddirection_10m){if(_i==ot.length)break;Mi[_i].push(Vr),_i++}let Wn="";Wn=c?" \xb0F":" \xb0C",this.chartOptions.yAxis.title.text=`Temperature${Wn}`,this.chartOptions.tooltip.valueSuffix=Wn,this.chartOptions.xAxis.plotLines[0].value=Xi,this.chartOptions.series[0].data=L,this.chartOptions.series[0].name=o,this.chartOptions.title.text=ye,this.chartOptions.annotations=[{labelOptions:{backgroundColor:"rgba(255,255,255,0.5)",verticalAlign:"top",x:120},labels:[{point:{xAxis:0,yAxis:0,x:Xi,y:Be},text:`Local time: ${new Date(Xi).toUTCString()} <br/> Temperature: ${Be}${Wn}`}]}],this.humidity_chartOptions_area.xAxis.plotLines[0].value=Xi,this.humidity_chartOptions_area.series[0].data=ot,this.humidity_chartOptions_area.annotations=[{labelOptions:{backgroundColor:"rgba(255,255,255,0.5)",verticalAlign:"top",x:50,y:-12},labels:[{point:{xAxis:0,yAxis:0,x:Xi,y:Xe},text:`Humidity: ${Xe} %`}]}],this.pressure_chartOptions_area.xAxis.plotLines[0].value=Xi,this.pressure_chartOptions_area.series[0].data=jt,this.pressure_chartOptions_area.annotations=[{labelOptions:{backgroundColor:"rgba(255,255,255,0.5)",verticalAlign:"top",x:65,y:-12},labels:[{point:{xAxis:0,yAxis:0,x:Xi,y:yt},text:`Pressure: ${yt} mm Hg`}]}],this.wind_chartOptions_area.xAxis.plotLines[0].value=Xi,this.wind_chartOptions_area.series[0].data=qt,this.wind_chartOptions_gauge.series[0].data=[fi],this.wind_chartOptions_gauge.series[1].data=[Gt],this.wind_chartOptions_area.annotations=[{labelOptions:{backgroundColor:"rgba(255,255,255,0.5)",verticalAlign:"top",x:55,y:-20},labels:[{point:{xAxis:0,yAxis:0,x:Xi,y:Gt},text:`Speed: ${Gt} m/s <br/> Direction ${fi} \xb0`}]}],this.humidity_chart_gauge=Od.chart("container-humidity-chart",this.humidity_chartOptions_area),this.pressure_chart_area=Od.chart("container-pressure-chart",this.pressure_chartOptions_area),this.wind_chart_area=Od.chart("container-wind-chart",this.wind_chartOptions_area),this.highcharts=Od.chart("container-chart",this.chartOptions);let is=document.body.getElementsByClassName("container-panel")[0].getBoundingClientRect();this.check_type(this.selectedType),window.scrollBy({left:0,top:is.top,behavior:"smooth"})},error:f=>{console.log(f),this._snackBar.open("Sorry, no data","Ok")}})}calc_wind_dir(e){let n,o;switch(!0){case e<23:o="N",n="transform: rotate(90deg)";break;case e<68:o="NE",n="transform: rotate(135deg)";break;case e<113:o="E",n="transform: rotate(180deg)";break;case e<158:o="SE",n="transform: rotate(225deg)";break;case e<203:o="S",n="transform: rotate(270deg)";break;case e<248:o="SW",n="transform: rotate(315deg)";break;case e<293:o="W",n="transform: rotate(0deg)";break;case e<338:o="NW",n="transform: rotate(45deg)";break;default:o="N",n="transform: rotate(90deg)"}return[o,n]}Submit_by_params(e,n){this.RouteLat=Number(e),this.RouteLon=Number(n),this.get_forecast(e,n,"",this.selected_unit_celsius)}Check_value(e,n){let o,c;1==n?(o=-90,c=90):(o=-180,c=180),""==e.value&&(e.value=0),!(e.value>=o&&e.value<=c)&&(this._snackBar.open(`${e.name} must be in ${e.placeholder} but got ${e.value}`,"Ok"),e.value=0)}change_method(e,n,o){"enabled"==n.id?(this.menu_text="Query by city",n.id="disabled",o.id="enabled"):(this.menu_text="Extended query by parameters",o.id="disabled",n.id="enabled")}change_unit(e,n,o,c){this.selected_unit_celsius="C"!=e,"enabled"==n.id||this.check_box?this.getUpToData(uv,hv,this.selected_unit_celsius):this.get_forecast(o,c,"",this.selected_unit_celsius)}switch_country_select(e,n,o){var c=this;return function vj(i){return function(){var t=this,e=arguments;return new Promise(function(n,o){var c=i.apply(t,e);function f(w){cI(c,n,o,f,y,"next",w)}function y(w){cI(c,n,o,f,y,"throw",w)}f(void 0)})}}(function*(){e.checked?(yield c.openDialog())?(n.disabled=!1,o.disabled=!1):c.check_box=!1:(n.disabled=!0,o.disabled=!0)})()}openDialog(){return this.dialog.open(fH,{width:"250px"}).afterClosed().toPromise().then(n=>Promise.resolve(n))}change_chart_type(e){this.selectedType=e,this.check_type(this.selectedType)}check_type(e){this.highcharts.update("column"==e?{chart:{type:e},plotOptions:{series:{threshold:0}}}:{chart:{type:e},plotOptions:{series:{threshold:-1/0}}})}change_wind_chart(){this.change_wind_check?this.wind_chart_gauge=Od.chart("container-wind-chart",this.wind_chartOptions_gauge):this.wind_chart_area=Od.chart("container-wind-chart",this.wind_chartOptions_area),this.change_wind_check=!this.change_wind_check}}return i.\u0275fac=function(e){return new(e||i)(ft(WE),ft(O2),ft(B2),ft(gs),ft(Pd))},i.\u0275cmp=Cr({type:i,selectors:[["app-chart"]],decls:29,vars:10,consts:[[1,"container-panel"],[1,"container-weather-panels"],[1,"header-weather-panel"],[3,"href"],[1,"weather-panels"],[1,"table-weather"],[4,"ngFor","ngForOf"],["id","container-charts"],[1,"charts-card"],["id","container-chart"],["id","container-ad-charts"],["id","charts-card-ad",1,"charts-card"],["id","container-humidity-chart"],["id","container-pressure-chart"],["id","container-wind-chart",3,"click"],[1,"weather-icon"],["id","table-temp-span"],["id","arrow"],["id","span-wind-dir"]],template:function(e,n){1&e&&(pi(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),vn(4,"Show on google maps"),xi(),zn(5,"br"),pi(6,"span"),vn(7),xi(),zn(8,"br"),pi(9,"span"),vn(10),xi()(),pi(11,"mat-card",4)(12,"table",5)(13,"thead")(14,"tr"),Pr(15,dH,2,1,"th",6),xi()(),pi(16,"tbody")(17,"tr"),Pr(18,pH,16,8,"td",6),xi()()()()(),pi(19,"div",7)(20,"mat-card",8),zn(21,"div",9),xi(),pi(22,"div",10)(23,"mat-card",11),zn(24,"div",12),xi(),pi(25,"mat-card",11),zn(26,"div",13),xi(),pi(27,"mat-card",11)(28,"div",14),Rn("click",function(){return n.change_wind_chart()}),xi()()()()()),2&e&&(Ni(1),fl(n.style_hourly_weather),Ni(2),P1("href","https://www.google.com/maps/@",n.latitudeS,",",n.longitudeS,",15z",Jf),Ni(4),Z0("Latitude: ",n.RouteLat," / Longitude: ",n.RouteLon,""),Ni(3),Z0("Timezone: ",n.localTimezone," / Local time: ",n.localTime,""),Ni(5),on("ngForOf",n.table_header_time),Ni(3),on("ngForOf",n.table_array_class))},dependencies:[TC,z2],styles:['input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;appearance:none;margin:0}a[_ngcontent-%COMP%]{text-decoration:none;font-weight:lighter;color:#6a6aff}.container-panel[_ngcontent-%COMP%]{display:flex;width:100%}.weather-panels[_ngcontent-%COMP%]{width:inherit;aspect-ratio:2/1;margin:10px;overflow-x:auto}.header-weather-panel[_ngcontent-%COMP%]{width:100%;height:100%;margin:10px}.header-weather-panel[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:lighter;color:#333}.header-weather-panel[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{content:"";display:inline-block;margin-bottom:-2px;width:14px;height:14px;background:url(https://iconmonstr.com/wp-content/g/gd/makefg.php?i=../releases/preview/2018/png/iconmonstr-location-pin-thin.png&r=106&g=106&b=255) no-repeat;background-size:100%}.weather-panels[_ngcontent-%COMP%]::-webkit-scrollbar{display:block;width:100%;height:18px;background:rgb(226,226,226)}.weather-panels[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:rgb(191,191,191)}.weather-panels[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:rgb(145,145,145)}.table-weather[_ngcontent-%COMP%]{color:#6a6aff;height:100%;width:100%}.table-weather[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#5c5c65}.table-weather[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{text-align:center;min-width:70px}#table-temp-span[_ngcontent-%COMP%]{font-size:18px}.weather-icon[_ngcontent-%COMP%]{display:block;width:60px;height:60px;background-size:cover;background-position:center;background-repeat:no-repeat;margin:auto}#container-charts[_ngcontent-%COMP%]{width:100%;height:100%;margin:10px}#container-chart[_ngcontent-%COMP%]{width:100%;aspect-ratio:1/1}.charts-card[_ngcontent-%COMP%]{margin:0 0 10px;aspect-ratio:1/1}#charts-card-ad[_ngcontent-%COMP%]{width:calc(30% - 16px);margin:0;aspect-ratio:1/1}#charts-card-ad[_ngcontent-%COMP%]:nth-child(2n){margin:0 auto}#container-ad-charts[_ngcontent-%COMP%]{display:flex}  .chart_title_icon{width:18px;height:18px;margin:4px}  .highcharts-title{display:flex!important}  .highcharts-title p{margin:auto;font-weight:lighter}#arrow[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;background-image:url(https://iconmonstr.com/wp-content/g/gd/makefg.php?i=../releases/preview/7.0.0/png/iconmonstr-arrow-left-lined.png&r=106&g=106&b=255);background-size:cover;background-repeat:no-repeat}@media (max-width: 22200px){.container-panel[_ngcontent-%COMP%]{display:block}#container-charts[_ngcontent-%COMP%]{width:auto;height:auto;margin:10px}}@media (max-width: 22200px){#container-charts[_ngcontent-%COMP%]{width:auto;height:auto;margin:5px}.charts-card[_ngcontent-%COMP%]{margin:5px}#container-ad-charts[_ngcontent-%COMP%]{display:block}#charts-card-ad[_ngcontent-%COMP%]{width:auto;margin:5px!important}}']}),i})(),fH=(()=>{class i{constructor(e){this.dialogRef=e}onNoClick(){this.dialogRef.close(!1)}onYesClick(){this.dialogRef.close(!0)}}return i.\u0275fac=function(e){return new(e||i)(ft(I2))},i.\u0275cmp=Cr({type:i,selectors:[["dialog-overview-example-dialog"]],decls:10,vars:0,consts:[["mat-dialog-content",""],["mat-dialog-overview","",2,"display","flex"],["mat-button","","mat-raised-button","","type","button",2,"margin","auto",3,"click"]],template:function(e,n){1&e&&(pi(0,"h1"),vn(1,"Are you sure about that?"),xi(),pi(2,"div",0)(3,"p"),vn(4,"It may cause high load"),xi()(),pi(5,"div",1)(6,"button",2),Rn("click",function(){return n.onNoClick()}),vn(7,"No"),xi(),pi(8,"button",2),Rn("click",function(){return n.onYesClick()}),vn(9,"Yes"),xi()())},dependencies:[Lb,X4],encapsulation:2}),i})(),mH=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=Cr({type:i,selectors:[["app-bottom"]],decls:23,vars:0,consts:[[1,"bottom-panel"],[1,"container-panel"],[1,"container-contacts"],[1,"link-group"],[1,"container-link"],["href","https://github.com/idrankabeeronce/"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24"],["d","M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"],["href","https://www.linkedin.com/in/re-pack-768352253/"],["d","M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"],["href","mailto:mrhuk06@gmail.com"],["d","M13.718 10.528c0 .792-.268 1.829-.684 2.642-1.009 1.98-3.063 1.967-3.063-.14 0-.786.27-1.799.687-2.58 1.021-1.925 3.06-1.624 3.06.078zm10.282 1.472c0 6.627-5.373 12-12 12s-12-5.373-12-12 5.373-12 12-12 12 5.373 12 12zm-5-1.194c0-3.246-2.631-5.601-6.256-5.601-4.967 0-7.744 3.149-7.744 7.073 0 3.672 2.467 6.517 7.024 6.517 2.52 0 4.124-.726 5.122-1.288l-.687-.991c-1.022.593-2.251 1.136-4.256 1.136-3.429 0-5.733-2.199-5.733-5.473 0-5.714 6.401-6.758 9.214-5.071 2.624 1.642 2.524 5.578.582 7.083-1.034.826-2.199.799-1.821-.756 0 0 1.212-4.489 1.354-4.975h-1.364l-.271.952c-.278-.785-.943-1.295-1.911-1.295-2.018 0-3.722 2.19-3.722 4.783 0 1.73.913 2.804 2.38 2.804 1.283 0 1.95-.726 2.364-1.373-.3 2.898 5.725 1.557 5.725-3.525z"]],template:function(e,n){1&e&&(zn(0,"hr"),pi(1,"div",0)(2,"div",1)(3,"div",2)(4,"h2"),vn(5,"Contacts"),xi(),pi(6,"div",3)(7,"div",4)(8,"div")(9,"a",5),l(),pi(10,"svg",6),zn(11,"path",7),xi(),vn(12," GitHub"),xi()()(),_(),pi(13,"div",4)(14,"a",8),l(),pi(15,"svg",6),zn(16,"path",9),xi(),vn(17," LinkedIn"),xi()(),_(),pi(18,"div",4)(19,"a",10),l(),pi(20,"svg",6),zn(21,"path",11),xi(),vn(22," EMail"),xi()()()()()())},styles:["a[_ngcontent-%COMP%], h2[_ngcontent-%COMP%]{text-decoration:none;color:#323232;font-weight:lighter}hr[_ngcontent-%COMP%]{width:80%;margin:40px auto}.bottom-panel[_ngcontent-%COMP%]{text-align:center;display:block;width:100%;height:200px}.container-panel[_ngcontent-%COMP%]{width:80%;margin:0 auto;height:200px;display:flex}.link-group[_ngcontent-%COMP%]{width:80vw;display:flex;height:20%;vertical-align:middle}.container-contacts[_ngcontent-%COMP%]{display:block;margin:0 auto}.container-link[_ngcontent-%COMP%]{display:flex;margin:auto;width:30%;justify-content:center}.container-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;line-height:24px}.container-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-right:8px}"]}),i})(),gH=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=Cr({type:i,selectors:[["app-header"]],decls:6,vars:0,consts:[[1,"header-panel"],[1,"header-panel-header"],[1,"header-panel-img"],["src","https://img.icons8.com/dotty/344/sun.png"]],template:function(e,n){1&e&&(pi(0,"div",0)(1,"div",1)(2,"div",2),zn(3,"img",3),xi(),pi(4,"h1"),vn(5,"Weather Forecast"),xi()()())},styles:["h1[_ngcontent-%COMP%]{color:#fff;text-shadow:2px 2px 2px black;font-size:2em;font-weight:lighter;text-align:center}.header-panel[_ngcontent-%COMP%]{left:0;top:0;width:100%;height:400px;background-image:url(https://images.theconversation.com/files/232705/original/file-20180820-30593-1nxanpj.jpg?ixlib=rb-1.1.0&q=45&auto=format&w=4800&h=3600.0);background-size:cover}.header-panel-header[_ngcontent-%COMP%]{width:400px;padding:50px 0;margin:0 auto;height:300px}.header-panel-img[_ngcontent-%COMP%]{filter:drop-shadow(2px 2px 2px black);margin:0 auto;height:200px;width:200px}.header-panel-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:invert(1);height:200px;width:200px}"]}),i})();const _H=["connectionContainer"],yH=["inputContainer"],vH=["label"];function xH(i,t){1&i&&(ay(0),pi(1,"div",14),zn(2,"div",15)(3,"div",16)(4,"div",17),xi(),pi(5,"div",18),zn(6,"div",15)(7,"div",16)(8,"div",17),xi(),ly())}function bH(i,t){if(1&i){const e=Qp();pi(0,"div",19),Rn("cdkObserveContent",function(){return Io(e),lr(Jr().updateOutlineGap())}),ds(1,1),xi()}2&i&&on("cdkObserveContentDisabled","outline"!=Jr().appearance)}function wH(i,t){if(1&i&&(ay(0),ds(1,2),pi(2,"span"),vn(3),xi(),ly()),2&i){const e=Jr(2);Ni(3),Ac(e._control.placeholder)}}function CH(i,t){1&i&&ds(0,3,["*ngSwitchCase","true"])}function EH(i,t){1&i&&(pi(0,"span",23),vn(1," *"),xi())}function MH(i,t){if(1&i){const e=Qp();pi(0,"label",20,21),Rn("cdkObserveContent",function(){return Io(e),lr(Jr().updateOutlineGap())}),Pr(2,wH,4,1,"ng-container",12),Pr(3,CH,1,0,"ng-content",12),Pr(4,EH,2,0,"span",22),xi()}if(2&i){const e=Jr();fs("mat-empty",e._control.empty&&!e._shouldAlwaysFloat())("mat-form-field-empty",e._control.empty&&!e._shouldAlwaysFloat())("mat-accent","accent"==e.color)("mat-warn","warn"==e.color),on("cdkObserveContentDisabled","outline"!=e.appearance)("id",e._labelId)("ngSwitch",e._hasLabel()),Ir("for",e._control.id)("aria-owns",e._control.id),Ni(2),on("ngSwitchCase",!1),Ni(1),on("ngSwitchCase",!0),Ni(1),on("ngIf",!e.hideRequiredMarker&&e._control.required&&!e._control.disabled)}}function SH(i,t){1&i&&(pi(0,"div",24),ds(1,4),xi())}function TH(i,t){if(1&i&&(pi(0,"div",25),zn(1,"span",26),xi()),2&i){const e=Jr();Ni(1),fs("mat-accent","accent"==e.color)("mat-warn","warn"==e.color)}}function DH(i,t){1&i&&(pi(0,"div"),ds(1,5),xi()),2&i&&on("@transitionMessages",Jr()._subscriptAnimationState)}function AH(i,t){if(1&i&&(pi(0,"div",30),vn(1),xi()),2&i){const e=Jr(2);on("id",e._hintLabelId),Ni(1),Ac(e.hintLabel)}}function kH(i,t){if(1&i&&(pi(0,"div",27),Pr(1,AH,2,2,"div",28),ds(2,6),zn(3,"div",29),ds(4,7),xi()),2&i){const e=Jr();on("@transitionMessages",e._subscriptAnimationState),Ni(1),on("ngIf",e.hintLabel)}}const IH=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],PH=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"],OH=new ui("MatError"),RH={transitionMessages:gf("transitionMessages",[bh("enter",ts({opacity:1,transform:"translateY(0%)"})),Rc("void => enter",[ts({opacity:0,transform:"translateY(-5px)"}),xh("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let Nb=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=ci({type:i}),i})();const LH=new ui("MatHint");let bM=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=ci({type:i,selectors:[["mat-label"]]}),i})(),FH=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=ci({type:i,selectors:[["mat-placeholder"]]}),i})();const NH=new ui("MatPrefix"),BH=new ui("MatSuffix");let V2=0;const VH=kb(class{constructor(i){this._elementRef=i}},"primary"),jH=new ui("MAT_FORM_FIELD_DEFAULT_OPTIONS"),Bb=new ui("MatFormField");let UH=(()=>{class i extends VH{constructor(e,n,o,c,f,y,w){super(e),this._changeDetectorRef=n,this._dir=o,this._defaults=c,this._platform=f,this._ngZone=y,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new ue,this._hideRequiredMarker=!1,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId="mat-hint-"+V2++,this._labelId="mat-form-field-label-"+V2++,this.floatLabel=this._getDefaultFloatLabelState(),this._animationsEnabled="NoopAnimations"!==w,this.appearance=c?.appearance||"legacy",c&&(this._hideRequiredMarker=Boolean(c.hideRequiredMarker),c.color&&(this.color=this.defaultColor=c.color))}get appearance(){return this._appearance}set appearance(e){const n=this._appearance;this._appearance=e||this._defaults?.appearance||"legacy","outline"===this._appearance&&n!==e&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(e){this._hideRequiredMarker=so(e)}_shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}_canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(e){this._hintLabel=e,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(e){e!==this._floatLabel&&(this._floatLabel=e||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(e){this._explicitFormFieldControl=e}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const e=this._control;e.controlType&&this._elementRef.nativeElement.classList.add(`mat-form-field-type-${e.controlType}`),e.stateChanges.pipe(gl(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),e.ngControl&&e.ngControl.valueChanges&&e.ngControl.valueChanges.pipe(As(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(As(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),ys(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe(gl(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe(gl(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe(As(this._destroyed)).subscribe(()=>{"function"==typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this.updateOutlineGap())}):this.updateOutlineGap()})}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(e){const n=this._control?this._control.ngControl:null;return n&&n[e]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!(!this._labelChildNonStatic&&!this._labelChildStatic)}_shouldLabelFloat(){return this._canLabelFloat()&&(this._control&&this._control.shouldLabelFloat||this._shouldAlwaysFloat())}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat()&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,ff(this._label.nativeElement,"transitionend").pipe(eo(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_getDefaultFloatLabelState(){return this._defaults&&this._defaults.floatLabel||"auto"}_syncDescribedByIds(){if(this._control){let e=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&e.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const n=this._hintChildren?this._hintChildren.find(c=>"start"===c.align):null,o=this._hintChildren?this._hintChildren.find(c=>"end"===c.align):null;n?e.push(n.id):this._hintLabel&&e.push(this._hintLabelId),o&&e.push(o.id)}else this._errorChildren&&e.push(...this._errorChildren.map(n=>n.id));this._control.setDescribedByIds(e)}}_validateControlChild(){}updateOutlineGap(){const e=this._label?this._label.nativeElement:null,n=this._connectionContainerRef.nativeElement,o=".mat-form-field-outline-start",c=".mat-form-field-outline-gap";if("outline"!==this.appearance||!this._platform.isBrowser)return;if(!e||!e.children.length||!e.textContent.trim()){const le=n.querySelectorAll(`${o}, ${c}`);for(let ye=0;ye<le.length;ye++)le[ye].style.width="0";return}if(!this._isAttachedToDOM())return void(this._outlineGapCalculationNeededImmediately=!0);let f=0,y=0;const w=n.querySelectorAll(o),L=n.querySelectorAll(c);if(this._label&&this._label.nativeElement.children.length){const le=n.getBoundingClientRect();if(0===le.width&&0===le.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const ye=this._getStartEnd(le),Be=e.children,Xe=this._getStartEnd(Be[0].getBoundingClientRect());let ot=0;for(let yt=0;yt<Be.length;yt++)ot+=Be[yt].offsetWidth;f=Math.abs(Xe-ye)-5,y=ot>0?.75*ot+10:0}for(let le=0;le<w.length;le++)w[le].style.width=`${f}px`;for(let le=0;le<L.length;le++)L[le].style.width=`${y}px`;this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(e){return this._dir&&"rtl"===this._dir.value?e.right:e.left}_isAttachedToDOM(){const e=this._elementRef.nativeElement;if(e.getRootNode){const n=e.getRootNode();return n&&n!==e}return document.documentElement.contains(e)}}return i.\u0275fac=function(e){return new(e||i)(ft(Zn),ft(Wa),ft(Bd,8),ft(jH,8),ft(Aa),ft(En),ft(mh,8))},i.\u0275cmp=Cr({type:i,selectors:[["mat-form-field"]],contentQueries:function(e,n,o){if(1&e&&(Ds(o,Nb,5),Ds(o,Nb,7),Ds(o,bM,5),Ds(o,bM,7),Ds(o,FH,5),Ds(o,OH,5),Ds(o,LH,5),Ds(o,NH,5),Ds(o,BH,5)),2&e){let c;Dr(c=Ar())&&(n._controlNonStatic=c.first),Dr(c=Ar())&&(n._controlStatic=c.first),Dr(c=Ar())&&(n._labelChildNonStatic=c.first),Dr(c=Ar())&&(n._labelChildStatic=c.first),Dr(c=Ar())&&(n._placeholderChild=c.first),Dr(c=Ar())&&(n._errorChildren=c),Dr(c=Ar())&&(n._hintChildren=c),Dr(c=Ar())&&(n._prefixChildren=c),Dr(c=Ar())&&(n._suffixChildren=c)}},viewQuery:function(e,n){if(1&e&&($a(_H,7),$a(yH,5),$a(vH,5)),2&e){let o;Dr(o=Ar())&&(n._connectionContainerRef=o.first),Dr(o=Ar())&&(n._inputContainerRef=o.first),Dr(o=Ar())&&(n._label=o.first)}},hostAttrs:[1,"mat-form-field"],hostVars:40,hostBindings:function(e,n){2&e&&fs("mat-form-field-appearance-standard","standard"==n.appearance)("mat-form-field-appearance-fill","fill"==n.appearance)("mat-form-field-appearance-outline","outline"==n.appearance)("mat-form-field-appearance-legacy","legacy"==n.appearance)("mat-form-field-invalid",n._control.errorState)("mat-form-field-can-float",n._canLabelFloat())("mat-form-field-should-float",n._shouldLabelFloat())("mat-form-field-has-label",n._hasFloatingLabel())("mat-form-field-hide-placeholder",n._hideControlPlaceholder())("mat-form-field-disabled",n._control.disabled)("mat-form-field-autofilled",n._control.autofilled)("mat-focused",n._control.focused)("ng-untouched",n._shouldForward("untouched"))("ng-touched",n._shouldForward("touched"))("ng-pristine",n._shouldForward("pristine"))("ng-dirty",n._shouldForward("dirty"))("ng-valid",n._shouldForward("valid"))("ng-invalid",n._shouldForward("invalid"))("ng-pending",n._shouldForward("pending"))("_mat-animation-noopable",!n._animationsEnabled)},inputs:{color:"color",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel",floatLabel:"floatLabel"},exportAs:["matFormField"],features:[Tr([{provide:Bb,useExisting:i}]),en],ngContentSelectors:PH,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(e,n){1&e&&(dh(IH),pi(0,"div",0)(1,"div",1,2),Rn("click",function(c){return n._control.onContainerClick&&n._control.onContainerClick(c)}),Pr(3,xH,9,0,"ng-container",3),Pr(4,bH,2,1,"div",4),pi(5,"div",5,6),ds(7),pi(8,"span",7),Pr(9,MH,5,16,"label",8),xi()(),Pr(10,SH,2,0,"div",9),xi(),Pr(11,TH,2,4,"div",10),pi(12,"div",11),Pr(13,DH,2,1,"div",12),Pr(14,kH,5,2,"div",13),xi()()),2&e&&(Ni(3),on("ngIf","outline"==n.appearance),Ni(1),on("ngIf",n._prefixChildren.length),Ni(5),on("ngIf",n._hasFloatingLabel()),Ni(1),on("ngIf",n._suffixChildren.length),Ni(1),on("ngIf","outline"!=n.appearance),Ni(1),on("ngSwitch",n._getDisplayedMessages()),Ni(1),on("ngSwitchCase","error"),Ni(1),on("ngSwitchCase","hint"))},dependencies:[Cy,Ey,AC,LP],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.cdk-high-contrast-active .mat-form-field-disabled .mat-form-field-label{color:GrayText}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:none;transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field-hint-end{order:1}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-form-field-flex{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-form-field-flex{outline:dashed 3px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}','.mat-input-element{font:inherit;background:rgba(0,0,0,0);color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit;box-sizing:content-box}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element:not([type=password])::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{opacity:0}._mat-animation-noopable .mat-input-element::placeholder{transition:none}._mat-animation-noopable .mat-input-element::-moz-placeholder{transition:none}._mat-animation-noopable .mat-input-element::-webkit-input-placeholder{transition:none}._mat-animation-noopable .mat-input-element:-ms-input-placeholder{transition:none}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px)}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px;border-top-color:GrayText}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:rgba(0,0,0,0)}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick{border:3px dashed}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-form-field-disabled .mat-form-field-outline{color:GrayText}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}"],encapsulation:2,data:{animation:[RH.transitionMessages]},changeDetection:0}),i})(),wM=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[rf,Lr,tM,Lr]}),i})();class HH{constructor(t=!1,e,n=!0,o){this._multiple=t,this._emitChanges=n,this.compareWith=o,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new ue,e&&e.length&&(t?e.forEach(c=>this._markSelected(c)):this._markSelected(e[0]),this._selectedToEmit.length=0)}get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}select(...t){this._verifyValueAssignment(t),t.forEach(n=>this._markSelected(n));const e=this._hasQueuedChanges();return this._emitChangeEvent(),e}deselect(...t){this._verifyValueAssignment(t),t.forEach(n=>this._unmarkSelected(n));const e=this._hasQueuedChanges();return this._emitChangeEvent(),e}setSelection(...t){this._verifyValueAssignment(t);const e=this.selected,n=new Set(t);t.forEach(c=>this._markSelected(c)),e.filter(c=>!n.has(c)).forEach(c=>this._unmarkSelected(c));const o=this._hasQueuedChanges();return this._emitChangeEvent(),o}toggle(t){return this.isSelected(t)?this.deselect(t):this.select(t)}clear(t=!0){this._unmarkAll();const e=this._hasQueuedChanges();return t&&this._emitChangeEvent(),e}isSelected(t){if(this.compareWith){for(const e of this._selection)if(this.compareWith(e,t))return!0;return!1}return this._selection.has(t)}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(t){this._multiple&&this.selected&&this._selected.sort(t)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(t){this.isSelected(t)||(this._multiple||this._unmarkAll(),this.isSelected(t)||this._selection.add(t),this._emitChanges&&this._selectedToEmit.push(t))}_unmarkSelected(t){this.isSelected(t)&&(this._selection.delete(t),this._emitChanges&&this._deselectedToEmit.push(t))}_unmarkAll(){this.isEmpty()||this._selection.forEach(t=>this._unmarkSelected(t))}_verifyValueAssignment(t){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}}const GH=["trigger"],$H=["panel"];function WH(i,t){if(1&i&&(pi(0,"span",8),vn(1),xi()),2&i){const e=Jr();Ni(1),Ac(e.placeholder)}}function XH(i,t){if(1&i&&(pi(0,"span",12),vn(1),xi()),2&i){const e=Jr(2);Ni(1),Ac(e.triggerValue)}}function qH(i,t){1&i&&ds(0,0,["*ngSwitchCase","true"])}function YH(i,t){1&i&&(pi(0,"span",9),Pr(1,XH,2,1,"span",10),Pr(2,qH,1,0,"ng-content",11),xi()),2&i&&(on("ngSwitch",!!Jr().customTrigger),Ni(2),on("ngSwitchCase",!0))}function ZH(i,t){if(1&i){const e=Qp();pi(0,"div",13)(1,"div",14,15),Rn("@transformPanel.done",function(o){return Io(e),lr(Jr()._panelDoneAnimatingStream.next(o.toState))})("keydown",function(o){return Io(e),lr(Jr()._handleKeydown(o))}),ds(3,1),xi()()}if(2&i){const e=Jr();on("@transformPanelWrap",void 0),Ni(1),function QS(i,t,e){Dc(ya,ph,Hm(ai(),i,t,e),!0)}("mat-select-panel ",e._getPanelTheme(),""),O1("transform-origin",e._transformOrigin)("font-size",e._triggerFontSize,"px"),on("ngClass",e.panelClass)("@transformPanel",e.multiple?"showing-multiple":"showing"),Ir("id",e.id+"-panel")("aria-multiselectable",e.multiple)("aria-label",e.ariaLabel||null)("aria-labelledby",e._getPanelAriaLabelledby())}}const KH=[[["mat-select-trigger"]],"*"],QH=["mat-select-trigger","*"],U2={transformPanelWrap:gf("transformPanelWrap",[Rc("* => void",yM("@transformPanel",[_M()],{optional:!0}))]),transformPanel:gf("transformPanel",[bh("void",ts({transform:"scaleY(0.8)",minWidth:"100%",opacity:0})),bh("showing",ts({opacity:1,minWidth:"calc(100% + 32px)",transform:"scaleY(1)"})),bh("showing-multiple",ts({opacity:1,minWidth:"calc(100% + 64px)",transform:"scaleY(1)"})),Rc("void => *",xh("120ms cubic-bezier(0, 0, 0.2, 1)")),Rc("* => void",xh("100ms 25ms linear",ts({opacity:0})))])};let H2=0;const $2=new ui("mat-select-scroll-strategy"),iG=new ui("MAT_SELECT_CONFIG"),nG={provide:$2,deps:[qa],useFactory:function tG(i){return()=>i.scrollStrategies.reposition()}};class rG{constructor(t,e){this.source=t,this.value=e}}const oG=Ib(m2(Ab(g2(class{constructor(i,t,e,n,o){this._elementRef=i,this._defaultErrorStateMatcher=t,this._parentForm=e,this._parentFormGroup=n,this.ngControl=o,this.stateChanges=new ue}})))),sG=new ui("MatSelectTrigger");let aG=(()=>{class i extends oG{constructor(e,n,o,c,f,y,w,L,le,ye,Be,Xe,ot,yt){super(f,c,w,L,ye),this._viewportRuler=e,this._changeDetectorRef=n,this._ngZone=o,this._dir=y,this._parentFormField=le,this._liveAnnouncer=ot,this._defaultOptions=yt,this._panelOpen=!1,this._compareWith=(jt,Gt)=>jt===Gt,this._uid="mat-select-"+H2++,this._triggerAriaLabelledBy=null,this._destroy=new ue,this._onChange=()=>{},this._onTouched=()=>{},this._valueId="mat-select-value-"+H2++,this._panelDoneAnimatingStream=new ue,this._overlayPanelClass=this._defaultOptions?.overlayPanelClass||"",this._focused=!1,this.controlType="mat-select",this._multiple=!1,this._disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1,this.ariaLabel="",this.optionSelectionChanges=sg(()=>{const jt=this.options;return jt?jt.changes.pipe(gl(jt),Us(()=>ys(...jt.map(Gt=>Gt.onSelectionChange)))):this._ngZone.onStable.pipe(eo(1),Us(()=>this.optionSelectionChanges))}),this.openedChange=new Fn,this._openedStream=this.openedChange.pipe(to(jt=>jt),Ie(()=>{})),this._closedStream=this.openedChange.pipe(to(jt=>!jt),Ie(()=>{})),this.selectionChange=new Fn,this.valueChange=new Fn,this.ngControl&&(this.ngControl.valueAccessor=this),null!=yt?.typeaheadDebounceInterval&&(this._typeaheadDebounceInterval=yt.typeaheadDebounceInterval),this._scrollStrategyFactory=Xe,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(Be)||0,this.id=this.id}get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.stateChanges.next()}get required(){return this._required??this.ngControl?.control?.hasValidator(fI.required)??!1}set required(e){this._required=so(e),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(e){this._multiple=so(e)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(e){this._disableOptionCentering=so(e)}get compareWith(){return this._compareWith}set compareWith(e){this._compareWith=e,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(e){this._assignValue(e)&&this._onChange(e)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(e){this._typeaheadDebounceInterval=eM(e)}get id(){return this._id}set id(e){this._id=e||this._uid,this.stateChanges.next()}ngOnInit(){this._selectionModel=new HH(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(OP(),As(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen))}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe(As(this._destroy)).subscribe(e=>{e.added.forEach(n=>n.select()),e.removed.forEach(n=>n.deselect())}),this.options.changes.pipe(gl(null),As(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){const e=this._getTriggerAriaLabelledby(),n=this.ngControl;if(e!==this._triggerAriaLabelledBy){const o=this._elementRef.nativeElement;this._triggerAriaLabelledBy=e,e?o.setAttribute("aria-labelledby",e):o.removeAttribute("aria-labelledby")}n&&(this._previousControl!==n.control&&(void 0!==this._previousControl&&null!==n.disabled&&n.disabled!==this.disabled&&(this.disabled=n.disabled),this._previousControl=n.control),this.updateErrorState())}ngOnChanges(e){(e.disabled||e.userAriaDescribedBy)&&this.stateChanges.next(),e.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._destroy.next(),this._destroy.complete(),this.stateChanges.complete()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck())}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(e){this._assignValue(e)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const e=this._selectionModel.selected.map(n=>n.viewValue);return this._isRtl()&&e.reverse(),e.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(e){this.disabled||(this.panelOpen?this._handleOpenKeydown(e):this._handleClosedKeydown(e))}_handleClosedKeydown(e){const n=e.keyCode,o=40===n||38===n||37===n||39===n,c=13===n||32===n,f=this._keyManager;if(!f.isTyping()&&c&&!Oc(e)||(this.multiple||e.altKey)&&o)e.preventDefault(),this.open();else if(!this.multiple){const y=this.selected;f.onKeydown(e);const w=this.selected;w&&y!==w&&this._liveAnnouncer.announce(w.viewValue,1e4)}}_handleOpenKeydown(e){const n=this._keyManager,o=e.keyCode,c=40===o||38===o,f=n.isTyping();if(c&&e.altKey)e.preventDefault(),this.close();else if(f||13!==o&&32!==o||!n.activeItem||Oc(e))if(!f&&this._multiple&&65===o&&e.ctrlKey){e.preventDefault();const y=this.options.some(w=>!w.disabled&&!w.selected);this.options.forEach(w=>{w.disabled||(y?w.select():w.deselect())})}else{const y=n.activeItemIndex;n.onKeydown(e),this._multiple&&c&&e.shiftKey&&n.activeItem&&n.activeItemIndex!==y&&n.activeItem._selectViaInteraction()}else e.preventDefault(),n.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe(eo(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(e){if(this._selectionModel.selected.forEach(n=>n.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&e)Array.isArray(e),e.forEach(n=>this._selectOptionByValue(n)),this._sortValues();else{const n=this._selectOptionByValue(e);n?this._keyManager.updateActiveItem(n):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(e){const n=this.options.find(o=>{if(this._selectionModel.isSelected(o))return!1;try{return null!=o.value&&this._compareWith(o.value,e)}catch{return!1}});return n&&this._selectionModel.select(n),n}_assignValue(e){return!!(e!==this._value||this._multiple&&Array.isArray(e))&&(this.options&&this._setSelectionByValue(e),this._value=e,!0)}_initKeyManager(){this._keyManager=new oU(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withAllowedModifierKeys(["shiftKey"]),this._keyManager.tabOut.pipe(As(this._destroy)).subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.pipe(As(this._destroy)).subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const e=ys(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(As(e)).subscribe(n=>{this._onSelect(n.source,n.isUserInput),n.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),ys(...this.options.map(n=>n._stateChanges)).pipe(As(e)).subscribe(()=>{this._changeDetectorRef.markForCheck(),this.stateChanges.next()})}_onSelect(e,n){const o=this._selectionModel.isSelected(e);null!=e.value||this._multiple?(o!==e.selected&&(e.selected?this._selectionModel.select(e):this._selectionModel.deselect(e)),n&&this._keyManager.setActiveItem(e),this.multiple&&(this._sortValues(),n&&this.focus())):(e.deselect(),this._selectionModel.clear(),null!=this.value&&this._propagateChanges(e.value)),o!==this._selectionModel.isSelected(e)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const e=this.options.toArray();this._selectionModel.sort((n,o)=>this.sortComparator?this.sortComparator(n,o,e):e.indexOf(n)-e.indexOf(o)),this.stateChanges.next()}}_propagateChanges(e){let n=null;n=this.multiple?this.selected.map(o=>o.value):this.selected?this.selected.value:e,this._value=n,this.valueChange.emit(n),this._onChange(n),this.selectionChange.emit(this._getChangeEvent(n)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(e){this._elementRef.nativeElement.focus(e)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;const e=this._parentFormField?.getLabelId();return this.ariaLabelledby?(e?e+" ":"")+this.ariaLabelledby:e}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;const e=this._parentFormField?.getLabelId();let n=(e?e+" ":"")+this._valueId;return this.ariaLabelledby&&(n+=" "+this.ariaLabelledby),n}_panelDoneAnimating(e){this.openedChange.emit(e)}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty||this._focused&&!!this._placeholder}}return i.\u0275fac=function(e){return new(e||i)(ft(Mb),ft(Wa),ft(En),ft(fM),ft(Zn),ft(Bd,8),ft(Xy,8),ft(qy,8),ft(Bb,8),ft(vh,10),po("tabindex"),ft($2),ft(sM),ft(iG,8))},i.\u0275dir=ci({type:i,viewQuery:function(e,n){if(1&e&&($a(GH,5),$a($H,5),$a(c2,5)),2&e){let o;Dr(o=Ar())&&(n.trigger=o.first),Dr(o=Ar())&&(n.panel=o.first),Dr(o=Ar())&&(n._overlayDir=o.first)}},inputs:{userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",placeholder:"placeholder",required:"required",multiple:"multiple",disableOptionCentering:"disableOptionCentering",compareWith:"compareWith",value:"value",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:"typeaheadDebounceInterval",sortComparator:"sortComparator",id:"id"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},features:[en,no]}),i})(),lG=(()=>{class i extends aG{constructor(){super(...arguments),this._scrollTop=0,this._triggerFontSize=0,this._transformOrigin="top",this._offsetY=0,this._positions=[{originX:"start",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"bottom",overlayX:"start",overlayY:"bottom"}]}_calculateOverlayScroll(e,n,o){const c=this._getItemHeight();return Math.min(Math.max(0,c*e-n+c/2),o)}ngOnInit(){super.ngOnInit(),this._viewportRuler.change().pipe(As(this._destroy)).subscribe(()=>{this.panelOpen&&(this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._changeDetectorRef.markForCheck())})}open(){super._canOpen()&&(super.open(),this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._triggerFontSize=parseInt(getComputedStyle(this.trigger.nativeElement).fontSize||"0"),this._calculateOverlayPosition(),this._ngZone.onStable.pipe(eo(1)).subscribe(()=>{this._triggerFontSize&&this._overlayDir.overlayRef&&this._overlayDir.overlayRef.overlayElement&&(this._overlayDir.overlayRef.overlayElement.style.fontSize=`${this._triggerFontSize}px`)}))}_scrollOptionIntoView(e){const n=gM(e,this.options,this.optionGroups),o=this._getItemHeight();this.panel.nativeElement.scrollTop=0===e&&1===n?0:function M2(i,t,e,n){return i<e?i:i+t>e+n?Math.max(0,i-n+t):e}((e+n)*o,o,this.panel.nativeElement.scrollTop,256)}_positioningSettled(){this._calculateOverlayOffsetX(),this.panel.nativeElement.scrollTop=this._scrollTop}_panelDoneAnimating(e){this.panelOpen?this._scrollTop=0:(this._overlayDir.offsetX=0,this._changeDetectorRef.markForCheck()),super._panelDoneAnimating(e)}_getChangeEvent(e){return new rG(this,e)}_calculateOverlayOffsetX(){const e=this._overlayDir.overlayRef.overlayElement.getBoundingClientRect(),n=this._viewportRuler.getViewportSize(),o=this._isRtl(),c=this.multiple?56:32;let f;if(this.multiple)f=40;else if(this.disableOptionCentering)f=16;else{let L=this._selectionModel.selected[0]||this.options.first;f=L&&L.group?32:16}o||(f*=-1);const y=0-(e.left+f-(o?c:0)),w=e.right+f-n.width+(o?0:c);y>0?f+=y+8:w>0&&(f-=w+8),this._overlayDir.offsetX=Math.round(f),this._overlayDir.overlayRef.updatePosition()}_calculateOverlayOffsetY(e,n,o){const c=this._getItemHeight(),f=(c-this._triggerRect.height)/2,y=Math.floor(256/c);let w;return this.disableOptionCentering?0:(w=0===this._scrollTop?e*c:this._scrollTop===o?(e-(this._getItemCount()-y))*c+(c-(this._getItemCount()*c-256)%c):n-c/2,Math.round(-1*w-f))}_checkOverlayWithinViewport(e){const n=this._getItemHeight(),o=this._viewportRuler.getViewportSize(),c=this._triggerRect.top-8,f=o.height-this._triggerRect.bottom-8,y=Math.abs(this._offsetY),L=Math.min(this._getItemCount()*n,256)-y-this._triggerRect.height;L>f?this._adjustPanelUp(L,f):y>c?this._adjustPanelDown(y,c,e):this._transformOrigin=this._getOriginBasedOnOption()}_adjustPanelUp(e,n){const o=Math.round(e-n);this._scrollTop-=o,this._offsetY-=o,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop<=0&&(this._scrollTop=0,this._offsetY=0,this._transformOrigin="50% bottom 0px")}_adjustPanelDown(e,n,o){const c=Math.round(e-n);if(this._scrollTop+=c,this._offsetY+=c,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop>=o)return this._scrollTop=o,this._offsetY=0,void(this._transformOrigin="50% top 0px")}_calculateOverlayPosition(){const e=this._getItemHeight(),n=this._getItemCount(),o=Math.min(n*e,256),f=n*e-o;let y;y=this.empty?0:Math.max(this.options.toArray().indexOf(this._selectionModel.selected[0]),0),y+=gM(y,this.options,this.optionGroups);const w=o/2;this._scrollTop=this._calculateOverlayScroll(y,w,f),this._offsetY=this._calculateOverlayOffsetY(y,w,f),this._checkOverlayWithinViewport(f)}_getOriginBasedOnOption(){const e=this._getItemHeight(),n=(e-this._triggerRect.height)/2;return`50% ${Math.abs(this._offsetY)-n+e/2}px 0px`}_getItemHeight(){return 3*this._triggerFontSize}_getItemCount(){return this.options.length+this.optionGroups.length}}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Hn(i)))(n||i)}}(),i.\u0275cmp=Cr({type:i,selectors:[["mat-select"]],contentQueries:function(e,n,o){if(1&e&&(Ds(o,sG,5),Ds(o,E2,5),Ds(o,w2,5)),2&e){let c;Dr(c=Ar())&&(n.customTrigger=c.first),Dr(c=Ar())&&(n.options=c),Dr(c=Ar())&&(n.optionGroups=c)}},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","true",1,"mat-select"],hostVars:19,hostBindings:function(e,n){1&e&&Rn("keydown",function(c){return n._handleKeydown(c)})("focus",function(){return n._onFocus()})("blur",function(){return n._onBlur()}),2&e&&(Ir("id",n.id)("tabindex",n.tabIndex)("aria-controls",n.panelOpen?n.id+"-panel":null)("aria-expanded",n.panelOpen)("aria-label",n.ariaLabel||null)("aria-required",n.required.toString())("aria-disabled",n.disabled.toString())("aria-invalid",n.errorState)("aria-activedescendant",n._getAriaActiveDescendant()),fs("mat-select-disabled",n.disabled)("mat-select-invalid",n.errorState)("mat-select-required",n.required)("mat-select-empty",n.empty)("mat-select-multiple",n.multiple))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex"},exportAs:["matSelect"],features:[Tr([{provide:Nb,useExisting:i},{provide:b2,useExisting:i}]),en],ngContentSelectors:QH,decls:9,vars:12,consts:[["cdk-overlay-origin","",1,"mat-select-trigger",3,"click"],["origin","cdkOverlayOrigin","trigger",""],[1,"mat-select-value",3,"ngSwitch"],["class","mat-select-placeholder mat-select-min-line",4,"ngSwitchCase"],["class","mat-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayMinWidth","cdkConnectedOverlayOffsetY","backdropClick","attach","detach"],[1,"mat-select-placeholder","mat-select-min-line"],[1,"mat-select-value-text",3,"ngSwitch"],["class","mat-select-min-line",4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-select-min-line"],[1,"mat-select-panel-wrap"],["role","listbox","tabindex","-1",3,"ngClass","keydown"],["panel",""]],template:function(e,n){if(1&e&&(dh(KH),pi(0,"div",0,1),Rn("click",function(){return n.toggle()}),pi(3,"div",2),Pr(4,WH,2,1,"span",3),Pr(5,YH,3,2,"span",4),xi(),pi(6,"div",5),zn(7,"div",6),xi()(),Pr(8,ZH,4,14,"ng-template",7),Rn("backdropClick",function(){return n.close()})("attach",function(){return n._onAttached()})("detach",function(){return n.close()})),2&e){const o=js(1);Ir("aria-owns",n.panelOpen?n.id+"-panel":null),Ni(3),on("ngSwitch",n.empty),Ir("id",n._valueId),Ni(1),on("ngSwitchCase",!0),Ni(1),on("ngSwitchCase",!1),Ni(3),on("cdkConnectedOverlayPanelClass",n._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",n._scrollStrategy)("cdkConnectedOverlayOrigin",o)("cdkConnectedOverlayOpen",n.panelOpen)("cdkConnectedOverlayPositions",n._positions)("cdkConnectedOverlayMinWidth",null==n._triggerRect?null:n._triggerRect.width)("cdkConnectedOverlayOffsetY",n._offsetY)}},dependencies:[SC,Ey,AC,yA,c2,l2],styles:['.mat-select{display:inline-block;width:100%;outline:none}.mat-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-select-disabled .mat-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-select-arrow-wrapper{height:16px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-outline .mat-select-arrow-wrapper{transform:translateY(-25%)}.mat-form-field-appearance-standard.mat-form-field-has-label .mat-select:not(.mat-select-empty) .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:none}.mat-select-arrow{width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;margin:0 4px}.mat-form-field.mat-focused .mat-select-arrow{transform:translateX(0)}.mat-select-panel-wrap{flex-basis:100%}.mat-select-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;padding-top:0;padding-bottom:0;max-height:256px;min-width:100%;border-radius:4px;outline:0}.cdk-high-contrast-active .mat-select-panel{outline:solid 1px}.mat-select-panel .mat-optgroup-label,.mat-select-panel .mat-option{font-size:inherit;line-height:3em;height:3em}.mat-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-form-field-flex{cursor:pointer}.mat-form-field-type-mat-select .mat-form-field-label{width:calc(100% - 18px)}.mat-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable .mat-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}'],encapsulation:2,data:{animation:[U2.transformPanelWrap,U2.transformPanel]},changeDetection:0}),i})(),cG=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({providers:[nG],imports:[rf,Cg,Ob,Lr,nv,wM,Ob,Lr]}),i})();const W2=Ky({passive:!0});let hG=(()=>{class i{constructor(e,n){this._platform=e,this._ngZone=n,this._monitoredElements=new Map}monitor(e){if(!this._platform.isBrowser)return gi;const n=gu(e),o=this._monitoredElements.get(n);if(o)return o.subject;const c=new ue,f="cdk-text-field-autofilled",y=w=>{"cdk-text-field-autofill-start"!==w.animationName||n.classList.contains(f)?"cdk-text-field-autofill-end"===w.animationName&&n.classList.contains(f)&&(n.classList.remove(f),this._ngZone.run(()=>c.next({target:w.target,isAutofilled:!1}))):(n.classList.add(f),this._ngZone.run(()=>c.next({target:w.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{n.addEventListener("animationstart",y,W2),n.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(n,{subject:c,unlisten:()=>{n.removeEventListener("animationstart",y,W2)}}),c}stopMonitoring(e){const n=gu(e),o=this._monitoredElements.get(n);o&&(o.unlisten(),o.subject.complete(),n.classList.remove("cdk-text-field-autofill-monitored"),n.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(n))}ngOnDestroy(){this._monitoredElements.forEach((e,n)=>this.stopMonitoring(n))}}return i.\u0275fac=function(e){return new(e||i)(Pt(Aa),Pt(En))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),X2=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({}),i})();const uG=new ui("MAT_INPUT_VALUE_ACCESSOR"),dG=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let pG=0;const fG=g2(class{constructor(i,t,e,n){this._defaultErrorStateMatcher=i,this._parentForm=t,this._parentFormGroup=e,this.ngControl=n,this.stateChanges=new ue}});let mG=(()=>{class i extends fG{constructor(e,n,o,c,f,y,w,L,le,ye){super(y,c,f,o),this._elementRef=e,this._platform=n,this._autofillMonitor=L,this._formField=ye,this._uid="mat-input-"+pG++,this.focused=!1,this.stateChanges=new ue,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(ot=>DP().has(ot)),this._iOSKeyupListener=ot=>{const yt=ot.target;!yt.value&&0===yt.selectionStart&&0===yt.selectionEnd&&(yt.setSelectionRange(1,1),yt.setSelectionRange(0,0))};const Be=this._elementRef.nativeElement,Xe=Be.nodeName.toLowerCase();this._inputValueAccessor=w||Be,this._previousNativeValue=this.value,this.id=this.id,n.IOS&&le.runOutsideAngular(()=>{e.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===Xe,this._isTextarea="textarea"===Xe,this._isInFormField=!!ye,this._isNativeSelect&&(this.controlType=Be.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(e){this._disabled=so(e),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(e){this._id=e||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(fI.required)??!1}set required(e){this._required=so(e)}get type(){return this._type}set type(e){this._type=e||"text",this._validateType(),!this._isTextarea&&DP().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(e){e!==this.value&&(this._inputValueAccessor.value=e,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(e){this._readonly=so(e)}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(e=>{this.autofilled=e.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(e){this._elementRef.nativeElement.focus(e)}_focusChanged(e){e!==this.focused&&(this.focused=e,this.stateChanges.next())}_onInput(){}_dirtyCheckPlaceholder(){const e=this._formField,n=e&&"legacy"===e.appearance&&!e._hasLabel?.()?null:this.placeholder;if(n!==this._previousPlaceholder){const o=this._elementRef.nativeElement;this._previousPlaceholder=n,n?o.setAttribute("placeholder",n):o.removeAttribute("placeholder")}}_dirtyCheckNativeValue(){const e=this._elementRef.nativeElement.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())}_validateType(){dG.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let e=this._elementRef.nativeElement.validity;return e&&e.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const e=this._elementRef.nativeElement,n=e.options[0];return this.focused||e.multiple||!this.empty||!!(e.selectedIndex>-1&&n&&n.label)}return this.focused||!this.empty}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const e=this._elementRef.nativeElement;return this._isNativeSelect&&(e.multiple||e.size>1)}}return i.\u0275fac=function(e){return new(e||i)(ft(Zn),ft(Aa),ft(vh,10),ft(Xy,8),ft(qy,8),ft(fM),ft(uG,10),ft(hG),ft(En),ft(Bb,8))},i.\u0275dir=ci({type:i,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:12,hostBindings:function(e,n){1&e&&Rn("focus",function(){return n._focusChanged(!0)})("blur",function(){return n._focusChanged(!1)})("input",function(){return n._onInput()}),2&e&&(Qm("disabled",n.disabled)("required",n.required),Ir("id",n.id)("data-placeholder",n.placeholder)("name",n.name||null)("readonly",n.readonly&&!n._isNativeSelect||null)("aria-invalid",n.empty&&n.required?null:n.errorState)("aria-required",n.required),fs("mat-input-server",n._isServer)("mat-native-select-inline",n._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[Tr([{provide:Nb,useExisting:i}]),en,no]}),i})(),gG=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({providers:[fM],imports:[X2,wM,Lr,X2,wM]}),i})();const _G=["*"];let Vb;function fv(i){return function yG(){if(void 0===Vb&&(Vb=null,typeof window<"u")){const i=window;void 0!==i.trustedTypes&&(Vb=i.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return Vb}()?.createHTML(i)||i}function q2(i){return Error(`Unable to find icon with the name "${i}"`)}function Y2(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function Z2(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}class _f{constructor(t,e,n){this.url=t,this.svgText=e,this.options=n}}let jb=(()=>{class i{constructor(e,n,o,c){this._httpClient=e,this._sanitizer=n,this._errorHandler=c,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=o}addSvgIcon(e,n,o){return this.addSvgIconInNamespace("",e,n,o)}addSvgIconLiteral(e,n,o){return this.addSvgIconLiteralInNamespace("",e,n,o)}addSvgIconInNamespace(e,n,o,c){return this._addSvgIconConfig(e,n,new _f(o,null,c))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,n,o,c){const f=this._sanitizer.sanitize(hr.HTML,o);if(!f)throw Z2(o);const y=fv(f);return this._addSvgIconConfig(e,n,new _f("",y,c))}addSvgIconSet(e,n){return this.addSvgIconSetInNamespace("",e,n)}addSvgIconSetLiteral(e,n){return this.addSvgIconSetLiteralInNamespace("",e,n)}addSvgIconSetInNamespace(e,n,o){return this._addSvgIconSetConfig(e,new _f(n,null,o))}addSvgIconSetLiteralInNamespace(e,n,o){const c=this._sanitizer.sanitize(hr.HTML,n);if(!c)throw Z2(n);const f=fv(c);return this._addSvgIconSetConfig(e,new _f("",f,o))}registerFontClassAlias(e,n=e){return this._fontCssClassesByAlias.set(e,n),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){const n=this._sanitizer.sanitize(hr.RESOURCE_URL,e);if(!n)throw Y2(e);const o=this._cachedIconsByUrl.get(n);return o?$i(Ub(o)):this._loadSvgIconFromConfig(new _f(e,null)).pipe(zo(c=>this._cachedIconsByUrl.set(n,c)),Ie(c=>Ub(c)))}getNamedSvgIcon(e,n=""){const o=K2(n,e);let c=this._svgIconConfigs.get(o);if(c)return this._getSvgFromConfig(c);if(c=this._getIconConfigFromResolvers(n,e),c)return this._svgIconConfigs.set(o,c),this._getSvgFromConfig(c);const f=this._iconSetConfigs.get(n);return f?this._getSvgFromIconSetConfigs(e,f):ag(q2(o))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?$i(Ub(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(Ie(n=>Ub(n)))}_getSvgFromIconSetConfigs(e,n){const o=this._extractIconWithNameFromAnySet(e,n);return o?$i(o):hI(n.filter(f=>!f.svgText).map(f=>this._loadSvgIconSetFromConfig(f).pipe(du(y=>{const L=`Loading icon set URL: ${this._sanitizer.sanitize(hr.RESOURCE_URL,f.url)} failed: ${y.message}`;return this._errorHandler.handleError(new Error(L)),$i(null)})))).pipe(Ie(()=>{const f=this._extractIconWithNameFromAnySet(e,n);if(!f)throw q2(e);return f}))}_extractIconWithNameFromAnySet(e,n){for(let o=n.length-1;o>=0;o--){const c=n[o];if(c.svgText&&c.svgText.toString().indexOf(e)>-1){const f=this._svgElementFromConfig(c),y=this._extractSvgIconFromSet(f,e,c.options);if(y)return y}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(zo(n=>e.svgText=n),Ie(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?$i(null):this._fetchIcon(e).pipe(zo(n=>e.svgText=n))}_extractSvgIconFromSet(e,n,o){const c=e.querySelector(`[id="${n}"]`);if(!c)return null;const f=c.cloneNode(!0);if(f.removeAttribute("id"),"svg"===f.nodeName.toLowerCase())return this._setSvgAttributes(f,o);if("symbol"===f.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(f),o);const y=this._svgElementFromString(fv("<svg></svg>"));return y.appendChild(f),this._setSvgAttributes(y,o)}_svgElementFromString(e){const n=this._document.createElement("DIV");n.innerHTML=e;const o=n.querySelector("svg");if(!o)throw Error("<svg> tag not found");return o}_toSvgElement(e){const n=this._svgElementFromString(fv("<svg></svg>")),o=e.attributes;for(let c=0;c<o.length;c++){const{name:f,value:y}=o[c];"id"!==f&&n.setAttribute(f,y)}for(let c=0;c<e.childNodes.length;c++)e.childNodes[c].nodeType===this._document.ELEMENT_NODE&&n.appendChild(e.childNodes[c].cloneNode(!0));return n}_setSvgAttributes(e,n){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),n&&n.viewBox&&e.setAttribute("viewBox",n.viewBox),e}_fetchIcon(e){const{url:n,options:o}=e,c=o?.withCredentials??!1;if(!this._httpClient)throw function vG(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==n)throw Error(`Cannot fetch icon from URL "${n}".`);const f=this._sanitizer.sanitize(hr.RESOURCE_URL,n);if(!f)throw Y2(n);const y=this._inProgressUrlFetches.get(f);if(y)return y;const w=this._httpClient.get(f,{responseType:"text",withCredentials:c}).pipe(Ie(L=>fv(L)),Px(()=>this._inProgressUrlFetches.delete(f)),vs());return this._inProgressUrlFetches.set(f,w),w}_addSvgIconConfig(e,n,o){return this._svgIconConfigs.set(K2(e,n),o),this}_addSvgIconSetConfig(e,n){const o=this._iconSetConfigs.get(e);return o?o.push(n):this._iconSetConfigs.set(e,[n]),this}_svgElementFromConfig(e){if(!e.svgElement){const n=this._svgElementFromString(e.svgText);this._setSvgAttributes(n,e.options),e.svgElement=n}return e.svgElement}_getIconConfigFromResolvers(e,n){for(let o=0;o<this._resolvers.length;o++){const c=this._resolvers[o](n,e);if(c)return bG(c)?new _f(c.url,null,c.options):new _f(c,null)}}}return i.\u0275fac=function(e){return new(e||i)(Pt(pb,8),Pt(VC),Pt(Pn,8),Pt($r))},i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function Ub(i){return i.cloneNode(!0)}function K2(i,t){return i+":"+t}function bG(i){return!(!i.url||!i.options)}const wG=kb(class{constructor(i){this._elementRef=i}}),CG=new ui("MAT_ICON_DEFAULT_OPTIONS"),EG=new ui("mat-icon-location",{providedIn:"root",factory:function MG(){const i=nr(Pn),t=i?i.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}}),Q2=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],SG=Q2.map(i=>`[${i}]`).join(", "),TG=/^url\(['"]?#(.*?)['"]?\)$/;let DG=(()=>{class i extends wG{constructor(e,n,o,c,f,y){super(e),this._iconRegistry=n,this._location=c,this._errorHandler=f,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=re.EMPTY,y&&(y.color&&(this.color=this.defaultColor=y.color),y.fontSet&&(this.fontSet=y.fontSet)),o||e.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(e){this._inline=so(e)}get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}get fontSet(){return this._fontSet}set fontSet(e){const n=this._cleanupFontValue(e);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(e){const n=this._cleanupFontValue(e);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}_splitIconName(e){if(!e)return["",""];const n=e.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const e=this._elementsWithExternalReferences;if(e&&e.size){const n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();const n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){const e=this._elementRef.nativeElement;let n=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){const o=e.childNodes[n];(1!==o.nodeType||"svg"===o.nodeName.toLowerCase())&&o.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const e=this._elementRef.nativeElement,n=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(o=>o.length>0);this._previousFontSetClass.forEach(o=>e.classList.remove(o)),n.forEach(o=>e.classList.add(o)),this._previousFontSetClass=n,this.fontIcon!==this._previousFontIconClass&&!n.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return"string"==typeof e?e.trim().split(" ")[0]:e}_prependPathToReferences(e){const n=this._elementsWithExternalReferences;n&&n.forEach((o,c)=>{o.forEach(f=>{c.setAttribute(f.name,`url('${e}#${f.value}')`)})})}_cacheChildrenWithExternalReferences(e){const n=e.querySelectorAll(SG),o=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let c=0;c<n.length;c++)Q2.forEach(f=>{const y=n[c],w=y.getAttribute(f),L=w?w.match(TG):null;if(L){let le=o.get(y);le||(le=[],o.set(y,le)),le.push({name:f,value:L[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){const[n,o]=this._splitIconName(e);n&&(this._svgNamespace=n),o&&(this._svgName=o),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(o,n).pipe(eo(1)).subscribe(c=>this._setSvgElement(c),c=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${n}:${o}! ${c.message}`))})}}}return i.\u0275fac=function(e){return new(e||i)(ft(Zn),ft(jb),po("aria-hidden"),ft(EG),ft($r),ft(CG,8))},i.\u0275cmp=Cr({type:i,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(e,n){2&e&&(Ir("data-mat-icon-type",n._usingFontIcon()?"font":"svg")("data-mat-icon-name",n._svgName||n.fontIcon)("data-mat-icon-namespace",n._svgNamespace||n.fontSet)("fontIcon",n._usingFontIcon()?n.fontIcon:null),fs("mat-icon-inline",n.inline)("mat-icon-no-color","primary"!==n.color&&"accent"!==n.color&&"warn"!==n.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[en],ngContentSelectors:_G,decls:1,vars:0,template:function(e,n){1&e&&(dh(),ds(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),i})(),AG=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[Lr,Lr]}),i})();function J2(i,t){return t?e=>Dy(t.pipe(eo(1),function kG(){return $((i,t)=>{i.subscribe(de(t,ne))})}()),e.pipe(J2(i))):Mt((e,n)=>i(e,n).pipe(eo(1),ik(e)))}function CM(i,t=vb){const e=YP(i,t);return J2(()=>e)}const IG=["mat-menu-item",""];function PG(i,t){1&i&&(l(),pi(0,"svg",2),zn(1,"polygon",3),xi())}const eO=["*"];function OG(i,t){if(1&i){const e=Qp();pi(0,"div",0),Rn("keydown",function(o){return Io(e),lr(Jr()._handleKeydown(o))})("click",function(){return Io(e),lr(Jr().closed.emit("click"))})("@transformMenu.start",function(o){return Io(e),lr(Jr()._onAnimationStart(o))})("@transformMenu.done",function(o){return Io(e),lr(Jr()._onAnimationDone(o))}),pi(1,"div",1),ds(2),xi()()}if(2&i){const e=Jr();on("id",e.panelId)("ngClass",e._classList)("@transformMenu",e._panelAnimationState),Ir("aria-label",e.ariaLabel||null)("aria-labelledby",e.ariaLabelledby||null)("aria-describedby",e.ariaDescribedby||null)}}const Hb={transformMenu:gf("transformMenu",[bh("void",ts({opacity:0,transform:"scale(0.8)"})),Rc("void => enter",xh("120ms cubic-bezier(0, 0, 0.2, 1)",ts({opacity:1,transform:"scale(1)"}))),Rc("* => void",xh("100ms 25ms linear",ts({opacity:0})))]),fadeInItems:gf("fadeInItems",[bh("showing",ts({opacity:1})),Rc("void => *",[ts({opacity:0}),xh("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},RG=new ui("MatMenuContent"),EM=new ui("MAT_MENU_PANEL"),LG=Ib(Ab(class{}));let Gb=(()=>{class i extends LG{constructor(e,n,o,c,f){super(),this._elementRef=e,this._document=n,this._focusMonitor=o,this._parentMenu=c,this._changeDetectorRef=f,this.role="menuitem",this._hovered=new ue,this._focused=new ue,this._highlighted=!1,this._triggersSubmenu=!1,c?.addItem?.(this)}focus(e,n){this._focusMonitor&&e?this._focusMonitor.focusVia(this._getHostElement(),e,n):this._getHostElement().focus(n),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(e){this.disabled&&(e.preventDefault(),e.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){const e=this._elementRef.nativeElement.cloneNode(!0),n=e.querySelectorAll("mat-icon, .material-icons");for(let o=0;o<n.length;o++)n[o].remove();return e.textContent?.trim()||""}_setHighlighted(e){this._highlighted=e,this._changeDetectorRef?.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}}return i.\u0275fac=function(e){return new(e||i)(ft(Zn),ft(Pn),ft(pf),ft(EM,8),ft(Wa))},i.\u0275cmp=Cr({type:i,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-focus-indicator"],hostVars:10,hostBindings:function(e,n){1&e&&Rn("click",function(c){return n._checkDisabled(c)})("mouseenter",function(){return n._handleMouseEnter()}),2&e&&(Ir("role",n.role)("tabindex",n._getTabIndex())("aria-disabled",n.disabled.toString())("disabled",n.disabled||null),fs("mat-menu-item",!0)("mat-menu-item-highlighted",n._highlighted)("mat-menu-item-submenu-trigger",n._triggersSubmenu))},inputs:{disabled:"disabled",disableRipple:"disableRipple",role:"role"},exportAs:["matMenuItem"],features:[en],attrs:IG,ngContentSelectors:eO,decls:3,vars:3,consts:[["matRipple","",1,"mat-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["class","mat-menu-submenu-icon","viewBox","0 0 5 10","focusable","false",4,"ngIf"],["viewBox","0 0 5 10","focusable","false",1,"mat-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(e,n){1&e&&(dh(),ds(0),zn(1,"div",0),Pr(2,PG,2,0,"svg",1)),2&e&&(Ni(1),on("matRippleDisabled",n.disableRipple||n.disabled)("matRippleTrigger",n._getHostElement()),Ni(1),on("ngIf",n._triggersSubmenu))},dependencies:[Cy,Eg],encapsulation:2,changeDetection:0}),i})();const tO=new ui("mat-menu-default-options",{providedIn:"root",factory:function FG(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let NG=0,mv=(()=>{class i{constructor(e,n,o,c){this._elementRef=e,this._ngZone=n,this._defaultOptions=o,this._changeDetectorRef=c,this._xPosition=this._defaultOptions.xPosition,this._yPosition=this._defaultOptions.yPosition,this._directDescendantItems=new ig,this._tabSubscription=re.EMPTY,this._classList={},this._panelAnimationState="void",this._animationDone=new ue,this.overlayPanelClass=this._defaultOptions.overlayPanelClass||"",this.backdropClass=this._defaultOptions.backdropClass,this._overlapTrigger=this._defaultOptions.overlapTrigger,this._hasBackdrop=this._defaultOptions.hasBackdrop,this.closed=new Fn,this.close=this.closed,this.panelId="mat-menu-panel-"+NG++}get xPosition(){return this._xPosition}set xPosition(e){this._xPosition=e,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(e){this._yPosition=e,this.setPositionClasses()}get overlapTrigger(){return this._overlapTrigger}set overlapTrigger(e){this._overlapTrigger=so(e)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(e){this._hasBackdrop=so(e)}set panelClass(e){const n=this._previousPanelClass;n&&n.length&&n.split(" ").forEach(o=>{this._classList[o]=!1}),this._previousPanelClass=e,e&&e.length&&(e.split(" ").forEach(o=>{this._classList[o]=!0}),this._elementRef.nativeElement.className="")}get classList(){return this.panelClass}set classList(e){this.panelClass=e}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new sU(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._tabSubscription=this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(gl(this._directDescendantItems),Us(e=>ys(...e.map(n=>n._focused)))).subscribe(e=>this._keyManager.updateActiveItem(e)),this._directDescendantItems.changes.subscribe(e=>{const n=this._keyManager;if("enter"===this._panelAnimationState&&n.activeItem?._hasFocus()){const o=e.toArray(),c=Math.max(0,Math.min(o.length-1,n.activeItemIndex||0));o[c]&&!o[c].disabled?n.setActiveItem(c):n.setNextItemActive()}})}ngOnDestroy(){this._directDescendantItems.destroy(),this._tabSubscription.unsubscribe(),this.closed.complete()}_hovered(){return this._directDescendantItems.changes.pipe(gl(this._directDescendantItems),Us(n=>ys(...n.map(o=>o._hovered))))}addItem(e){}removeItem(e){}_handleKeydown(e){const n=e.keyCode,o=this._keyManager;switch(n){case 27:Oc(e)||(e.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case 39:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:return(38===n||40===n)&&o.setFocusOrigin("keyboard"),void o.onKeydown(e)}e.stopPropagation()}focusFirstItem(e="program"){this._ngZone.onStable.pipe(eo(1)).subscribe(()=>{let n=null;if(this._directDescendantItems.length&&(n=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),!n||!n.contains(document.activeElement)){const o=this._keyManager;o.setFocusOrigin(e).setFirstItemActive(),!o.activeItem&&n&&n.focus()}})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(e){const n=Math.min(this._baseElevation+e,24),o=`${this._elevationPrefix}${n}`,c=Object.keys(this._classList).find(f=>f.startsWith(this._elevationPrefix));(!c||c===this._previousElevation)&&(this._previousElevation&&(this._classList[this._previousElevation]=!1),this._classList[o]=!0,this._previousElevation=o)}setPositionClasses(e=this.xPosition,n=this.yPosition){const o=this._classList;o["mat-menu-before"]="before"===e,o["mat-menu-after"]="after"===e,o["mat-menu-above"]="above"===n,o["mat-menu-below"]="below"===n,this._changeDetectorRef?.markForCheck()}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(e){this._animationDone.next(e),this._isAnimating=!1}_onAnimationStart(e){this._isAnimating=!0,"enter"===e.toState&&0===this._keyManager.activeItemIndex&&(e.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe(gl(this._allItems)).subscribe(e=>{this._directDescendantItems.reset(e.filter(n=>n._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}}return i.\u0275fac=function(e){return new(e||i)(ft(Zn),ft(En),ft(tO),ft(Wa))},i.\u0275dir=ci({type:i,contentQueries:function(e,n,o){if(1&e&&(Ds(o,RG,5),Ds(o,Gb,5),Ds(o,Gb,4)),2&e){let c;Dr(c=Ar())&&(n.lazyContent=c.first),Dr(c=Ar())&&(n._allItems=c),Dr(c=Ar())&&(n.items=c)}},viewQuery:function(e,n){if(1&e&&$a(ml,5),2&e){let o;Dr(o=Ar())&&(n.templateRef=o.first)}},inputs:{backdropClass:"backdropClass",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:"overlapTrigger",hasBackdrop:"hasBackdrop",panelClass:["class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"}}),i})(),BG=(()=>{class i extends mv{constructor(e,n,o,c){super(e,n,o,c),this._elevationPrefix="mat-elevation-z",this._baseElevation=4}}return i.\u0275fac=function(e){return new(e||i)(ft(Zn),ft(En),ft(tO),ft(Wa))},i.\u0275cmp=Cr({type:i,selectors:[["mat-menu"]],hostVars:3,hostBindings:function(e,n){2&e&&Ir("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},exportAs:["matMenu"],features:[Tr([{provide:EM,useExisting:i}]),en],ngContentSelectors:eO,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-menu-panel",3,"id","ngClass","keydown","click"],[1,"mat-menu-content"]],template:function(e,n){1&e&&(dh(),Pr(0,OG,3,6,"ng-template"))},dependencies:[SC],styles:['mat-menu{display:none}.mat-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;max-height:calc(100vh - 48px);border-radius:4px;outline:0;min-height:64px;position:relative}.mat-menu-panel.ng-animating{pointer-events:none}.cdk-high-contrast-active .mat-menu-panel{outline:solid 1px}.mat-menu-content:not(:empty){padding-top:8px;padding-bottom:8px}.mat-menu-item{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative}.mat-menu-item::-moz-focus-inner{border:0}.mat-menu-item[disabled]{cursor:default}[dir=rtl] .mat-menu-item{text-align:right}.mat-menu-item .mat-icon{margin-right:16px;vertical-align:middle}.mat-menu-item .mat-icon svg{vertical-align:top}[dir=rtl] .mat-menu-item .mat-icon{margin-left:16px;margin-right:0}.mat-menu-item[disabled]::after{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.cdk-high-contrast-active .mat-menu-item{margin-top:1px}.mat-menu-item-submenu-trigger{padding-right:32px}[dir=rtl] .mat-menu-item-submenu-trigger{padding-right:16px;padding-left:32px}.mat-menu-submenu-icon{position:absolute;top:50%;right:16px;transform:translateY(-50%);width:5px;height:10px;fill:currentColor}[dir=rtl] .mat-menu-submenu-icon{right:auto;left:16px;transform:translateY(-50%) scaleX(-1)}.cdk-high-contrast-active .mat-menu-submenu-icon{fill:CanvasText}button.mat-menu-item{width:100%}.mat-menu-item .mat-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}'],encapsulation:2,data:{animation:[Hb.transformMenu,Hb.fadeInItems]},changeDetection:0}),i})();const iO=new ui("mat-menu-scroll-strategy"),VG={provide:iO,deps:[qa],useFactory:function zG(i){return()=>i.scrollStrategies.reposition()}},nO=Ky({passive:!0});let jG=(()=>{class i{constructor(e,n,o,c,f,y,w,L,le){this._overlay=e,this._element=n,this._viewContainerRef=o,this._menuItemInstance=y,this._dir=w,this._focusMonitor=L,this._ngZone=le,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=re.EMPTY,this._hoverSubscription=re.EMPTY,this._menuCloseSubscription=re.EMPTY,this._handleTouchStart=ye=>{oM(ye)||(this._openedBy="touch")},this._openedBy=void 0,this.restoreFocus=!0,this.menuOpened=new Fn,this.onMenuOpen=this.menuOpened,this.menuClosed=new Fn,this.onMenuClose=this.menuClosed,this._scrollStrategy=c,this._parentMaterialMenu=f instanceof mv?f:void 0,n.nativeElement.addEventListener("touchstart",this._handleTouchStart,nO),y&&(y._triggersSubmenu=this.triggersSubmenu())}get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(e){this.menu=e}get menu(){return this._menu}set menu(e){e!==this._menu&&(this._menu=e,this._menuCloseSubscription.unsubscribe(),e&&(this._menuCloseSubscription=e.close.subscribe(n=>{this._destroyMenu(n),("click"===n||"tab"===n)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(n)})))}ngAfterContentInit(){this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,nO),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!(!this._menuItemInstance||!this._parentMaterialMenu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){const e=this.menu;if(this._menuOpen||!e)return;const n=this._createOverlay(e),o=n.getConfig(),c=o.positionStrategy;this._setPosition(e,c),o.hasBackdrop=e.hasBackdrop??!this.triggersSubmenu(),n.attach(this._getPortal(e)),e.lazyContent&&e.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(e),e instanceof mv&&(e._startAnimation(),e._directDescendantItems.changes.pipe(As(e.close)).subscribe(()=>{c.withLockedPosition(!1).reapplyLastPosition(),c.withLockedPosition(!0)}))}closeMenu(){this.menu?.close.emit()}focus(e,n){this._focusMonitor&&e?this._focusMonitor.focusVia(this._element,e,n):this._element.nativeElement.focus(n)}updatePosition(){this._overlayRef?.updatePosition()}_destroyMenu(e){if(!this._overlayRef||!this.menuOpen)return;const n=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===e||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,n instanceof mv?(n._resetAnimation(),n.lazyContent?n._animationDone.pipe(to(o=>"void"===o.toState),eo(1),As(n.lazyContent._attached)).subscribe({next:()=>n.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),n?.lazyContent?.detach())}_initMenu(e){e.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,e.direction=this.dir,this._setMenuElevation(e),e.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(e){if(e.setElevation){let n=0,o=e.parentMenu;for(;o;)n++,o=o.parentMenu;e.setElevation(n)}}_setIsMenuOpen(e){this._menuOpen=e,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(e)}_createOverlay(e){if(!this._overlayRef){const n=this._getOverlayConfig(e);this._subscribeToPositions(e,n.positionStrategy),this._overlayRef=this._overlay.create(n),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(e){return new wg({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:e.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:e.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(e,n){e.setPositionClasses&&n.positionChanges.subscribe(o=>{const c="start"===o.connectionPair.overlayX?"after":"before",f="top"===o.connectionPair.overlayY?"below":"above";this._ngZone?this._ngZone.run(()=>e.setPositionClasses(c,f)):e.setPositionClasses(c,f)})}_setPosition(e,n){let[o,c]="before"===e.xPosition?["end","start"]:["start","end"],[f,y]="above"===e.yPosition?["bottom","top"]:["top","bottom"],[w,L]=[f,y],[le,ye]=[o,c],Be=0;if(this.triggersSubmenu()){if(ye=o="before"===e.xPosition?"start":"end",c=le="end"===o?"start":"end",this._parentMaterialMenu){if(null==this._parentInnerPadding){const Xe=this._parentMaterialMenu.items.first;this._parentInnerPadding=Xe?Xe._getHostElement().offsetTop:0}Be="bottom"===f?this._parentInnerPadding:-this._parentInnerPadding}}else e.overlapTrigger||(w="top"===f?"bottom":"top",L="top"===y?"bottom":"top");n.withPositions([{originX:o,originY:w,overlayX:le,overlayY:f,offsetY:Be},{originX:c,originY:w,overlayX:ye,overlayY:f,offsetY:Be},{originX:o,originY:L,overlayX:le,overlayY:y,offsetY:-Be},{originX:c,originY:L,overlayX:ye,overlayY:y,offsetY:-Be}])}_menuClosingActions(){const e=this._overlayRef.backdropClick(),n=this._overlayRef.detachments();return ys(e,this._parentMaterialMenu?this._parentMaterialMenu.closed:$i(),this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(to(f=>f!==this._menuItemInstance),to(()=>this._menuOpen)):$i(),n)}_handleMousedown(e){rM(e)||(this._openedBy=0===e.button?"mouse":void 0,this.triggersSubmenu()&&e.preventDefault())}_handleKeydown(e){const n=e.keyCode;(13===n||32===n)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(39===n&&"ltr"===this.dir||37===n&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(e){this.triggersSubmenu()?(e.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe(to(e=>e===this._menuItemInstance&&!e.disabled),CM(0,cM)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof mv&&this.menu._isAnimating?this.menu._animationDone.pipe(eo(1),CM(0,cM),As(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(e){return(!this._portal||this._portal.templateRef!==e.templateRef)&&(this._portal=new bg(e.templateRef,this._viewContainerRef)),this._portal}}return i.\u0275fac=function(e){return new(e||i)(ft(qa),ft(Zn),ft(Sa),ft(iO),ft(EM,8),ft(Gb,10),ft(Bd,8),ft(pf),ft(En))},i.\u0275dir=ci({type:i,hostVars:3,hostBindings:function(e,n){1&e&&Rn("click",function(c){return n._handleClick(c)})("mousedown",function(c){return n._handleMousedown(c)})("keydown",function(c){return n._handleKeydown(c)}),2&e&&Ir("aria-haspopup",n.menu?"menu":null)("aria-expanded",n.menuOpen||null)("aria-controls",n.menuOpen?n.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:["mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:["matMenuTriggerFor","menu"],menuData:["matMenuTriggerData","menuData"],restoreFocus:["matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"}}),i})(),UG=(()=>{class i extends jG{}return i.\u0275fac=function(){let t;return function(n){return(t||(t=Hn(i)))(n||i)}}(),i.\u0275dir=ci({type:i,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-menu-trigger"],exportAs:["matMenuTrigger"],features:[en]}),i})(),HG=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({providers:[VG],imports:[rf,Lr,Pb,Cg,nv,Lr]}),i})();const GG=["input"],$G=["label"],WG=function(i){return{enterDuration:i}},XG=["*"],qG=new ui("mat-checkbox-default-options",{providedIn:"root",factory:rO});function rO(){return{color:"accent",clickAction:"check-indeterminate"}}let YG=0;const oO=rO(),ZG={provide:Jl,useExisting:On(()=>sO),multi:!0};class KG{}const QG=m2(kb(Ib(Ab(class{constructor(i){this._elementRef=i}}))));let JG=(()=>{class i extends QG{constructor(e,n,o,c,f,y,w){super(n),this._changeDetectorRef=o,this._ngZone=c,this._animationMode=y,this._options=w,this.ariaLabel="",this.ariaLabelledby=null,this.labelPosition="after",this.name=null,this.change=new Fn,this.indeterminateChange=new Fn,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=0,this._controlValueAccessorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||oO,this.color=this.defaultColor=this._options.color||oO.color,this.tabIndex=parseInt(f)||0,this.id=this._uniqueId=`${e}${++YG}`}get inputId(){return`${this.id||this._uniqueId}-input`}get required(){return this._required}set required(e){this._required=so(e)}ngAfterViewInit(){this._syncIndeterminate(this._indeterminate)}get checked(){return this._checked}set checked(e){const n=so(e);n!=this.checked&&(this._checked=n,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(e){const n=so(e);n!==this.disabled&&(this._disabled=n,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(e){const n=e!=this._indeterminate;this._indeterminate=so(e),n&&(this._transitionCheckState(this._indeterminate?3:this.checked?1:2),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(e){this.checked=!!e}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_getAriaChecked(){return this.checked?"true":this.indeterminate?"mixed":"false"}_transitionCheckState(e){let n=this._currentCheckState,o=this._getAnimationTargetElement();if(n!==e&&o&&(this._currentAnimationClass&&o.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(n,e),this._currentCheckState=e,this._currentAnimationClass.length>0)){o.classList.add(this._currentAnimationClass);const c=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{o.classList.remove(c)},1e3)})}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.checked),this.change.emit(this._createChangeEvent(this.checked)),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_handleInputClick(){const e=this._options?.clickAction;this.disabled||"noop"===e?!this.disabled&&"noop"===e&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate):(this.indeterminate&&"check"!==e&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?1:2),this._emitChangeEvent())}_onInteractionEvent(e){e.stopPropagation()}_onBlur(){Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}_getAnimationClassForCheckStateTransition(e,n){if("NoopAnimations"===this._animationMode)return"";switch(e){case 0:if(1===n)return this._animationClasses.uncheckedToChecked;if(3==n)return this._checked?this._animationClasses.checkedToIndeterminate:this._animationClasses.uncheckedToIndeterminate;break;case 2:return 1===n?this._animationClasses.uncheckedToChecked:this._animationClasses.uncheckedToIndeterminate;case 1:return 2===n?this._animationClasses.checkedToUnchecked:this._animationClasses.checkedToIndeterminate;case 3:return 1===n?this._animationClasses.indeterminateToChecked:this._animationClasses.indeterminateToUnchecked}return""}_syncIndeterminate(e){const n=this._inputElement;n&&(n.nativeElement.indeterminate=e)}}return i.\u0275fac=function(e){iu()},i.\u0275dir=ci({type:i,viewQuery:function(e,n){if(1&e&&($a(GG,5),$a($G,5),$a(Eg,5)),2&e){let o;Dr(o=Ar())&&(n._inputElement=o.first),Dr(o=Ar())&&(n._labelElement=o.first),Dr(o=Ar())&&(n.ripple=o.first)}},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],id:"id",required:"required",labelPosition:"labelPosition",name:"name",value:"value",checked:"checked",disabled:"disabled",indeterminate:"indeterminate"},outputs:{change:"change",indeterminateChange:"indeterminateChange"},features:[en]}),i})(),sO=(()=>{class i extends JG{constructor(e,n,o,c,f,y,w){super("mat-checkbox-",e,n,c,f,y,w),this._focusMonitor=o,this._animationClasses={uncheckedToChecked:"mat-checkbox-anim-unchecked-checked",uncheckedToIndeterminate:"mat-checkbox-anim-unchecked-indeterminate",checkedToUnchecked:"mat-checkbox-anim-checked-unchecked",checkedToIndeterminate:"mat-checkbox-anim-checked-indeterminate",indeterminateToChecked:"mat-checkbox-anim-indeterminate-checked",indeterminateToUnchecked:"mat-checkbox-anim-indeterminate-unchecked"}}_createChangeEvent(e){const n=new KG;return n.source=this,n.checked=e,n}_getAnimationTargetElement(){return this._elementRef.nativeElement}ngAfterViewInit(){super.ngAfterViewInit(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{e||this._onBlur()})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}_onInputClick(e){e.stopPropagation(),super._handleInputClick()}focus(e,n){e?this._focusMonitor.focusVia(this._inputElement,e,n):this._inputElement.nativeElement.focus(n)}}return i.\u0275fac=function(e){return new(e||i)(ft(Zn),ft(Wa),ft(pf),ft(En),po("tabindex"),ft(mh,8),ft(qG,8))},i.\u0275cmp=Cr({type:i,selectors:[["mat-checkbox"]],hostAttrs:[1,"mat-checkbox"],hostVars:14,hostBindings:function(e,n){2&e&&(Qm("id",n.id),Ir("tabindex",null)("aria-label",null)("aria-labelledby",null),fs("mat-checkbox-indeterminate",n.indeterminate)("mat-checkbox-checked",n.checked)("mat-checkbox-disabled",n.disabled)("mat-checkbox-label-before","before"==n.labelPosition)("_mat-animation-noopable","NoopAnimations"===n._animationMode))},inputs:{disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matCheckbox"],features:[Tr([ZG]),en],ngContentSelectors:XG,decls:17,vars:21,consts:[[1,"mat-checkbox-layout"],["label",""],[1,"mat-checkbox-inner-container"],["type","checkbox",1,"mat-checkbox-input","cdk-visually-hidden",3,"id","required","checked","disabled","tabIndex","change","click"],["input",""],["matRipple","",1,"mat-checkbox-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleRadius","matRippleCentered","matRippleAnimation"],[1,"mat-ripple-element","mat-checkbox-persistent-ripple"],[1,"mat-checkbox-frame"],[1,"mat-checkbox-background"],["version","1.1","focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mat-checkbox-checkmark"],["fill","none","stroke","white","d","M4.1,12.7 9,17.6 20.3,6.3",1,"mat-checkbox-checkmark-path"],[1,"mat-checkbox-mixedmark"],[1,"mat-checkbox-label",3,"cdkObserveContent"],["checkboxLabel",""],[2,"display","none"]],template:function(e,n){if(1&e&&(dh(),pi(0,"label",0,1)(2,"span",2)(3,"input",3,4),Rn("change",function(c){return n._onInteractionEvent(c)})("click",function(c){return n._onInputClick(c)}),xi(),pi(5,"span",5),zn(6,"span",6),xi(),zn(7,"span",7),pi(8,"span",8),l(),pi(9,"svg",9),zn(10,"path",10),xi(),_(),zn(11,"span",11),xi()(),pi(12,"span",12,13),Rn("cdkObserveContent",function(){return n._onLabelTextChange()}),pi(14,"span",14),vn(15,"\xa0"),xi(),ds(16),xi()()),2&e){const o=js(1),c=js(13);Ir("for",n.inputId),Ni(2),fs("mat-checkbox-inner-container-no-side-margin",!c.textContent||!c.textContent.trim()),Ni(1),on("id",n.inputId)("required",n.required)("checked",n.checked)("disabled",n.disabled)("tabIndex",n.tabIndex),Ir("value",n.value)("name",n.name)("aria-label",n.ariaLabel||null)("aria-labelledby",n.ariaLabelledby)("aria-checked",n._getAriaChecked())("aria-describedby",n.ariaDescribedby),Ni(2),on("matRippleTrigger",o)("matRippleDisabled",n._isRippleDisabled())("matRippleRadius",20)("matRippleCentered",!0)("matRippleAnimation",$T(19,WG,"NoopAnimations"===n._animationMode?0:150))}},dependencies:[Eg,LP],styles:['@keyframes mat-checkbox-fade-in-background{0%{opacity:0}50%{opacity:1}}@keyframes mat-checkbox-fade-out-background{0%,50%{opacity:1}100%{opacity:0}}@keyframes mat-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:22.910259}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 0.1)}100%{stroke-dashoffset:0}}@keyframes mat-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mat-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);stroke-dashoffset:0}to{stroke-dashoffset:-22.910259}}@keyframes mat-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 0.1);opacity:1;transform:rotate(0deg)}to{opacity:0;transform:rotate(45deg)}}@keyframes mat-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);opacity:0;transform:rotate(45deg)}to{opacity:1;transform:rotate(360deg)}}@keyframes mat-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 0.1);opacity:0;transform:rotate(-45deg)}to{opacity:1;transform:rotate(0deg)}}@keyframes mat-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);opacity:1;transform:rotate(0deg)}to{opacity:0;transform:rotate(315deg)}}@keyframes mat-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;opacity:1;transform:scaleX(1)}32.8%,100%{opacity:0;transform:scaleX(0)}}.mat-checkbox-background,.mat-checkbox-frame{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:2px;box-sizing:border-box;pointer-events:none}.mat-checkbox{display:inline-block;transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);position:relative}.mat-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-checkbox .mat-ripple-element:not(.mat-checkbox-persistent-ripple){opacity:.16}.mat-checkbox .mat-checkbox-ripple{position:absolute;left:calc(50% - 20px);top:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-checkbox-layout{-webkit-user-select:none;user-select:none;cursor:inherit;align-items:baseline;vertical-align:middle;display:inline-flex;white-space:nowrap}.mat-checkbox-label{-webkit-user-select:auto;user-select:auto}.mat-checkbox-inner-container{display:inline-block;height:16px;line-height:0;margin:auto;margin-right:8px;order:0;position:relative;vertical-align:middle;white-space:nowrap;width:16px;flex-shrink:0}[dir=rtl] .mat-checkbox-inner-container{margin-left:8px;margin-right:auto}.mat-checkbox-inner-container-no-side-margin{margin-left:0;margin-right:0}.mat-checkbox-frame{background-color:rgba(0,0,0,0);transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1);border-width:2px;border-style:solid}._mat-animation-noopable .mat-checkbox-frame{transition:none}.mat-checkbox-background{align-items:center;display:inline-flex;justify-content:center;transition:background-color 90ms cubic-bezier(0, 0, 0.2, 0.1),opacity 90ms cubic-bezier(0, 0, 0.2, 0.1);-webkit-print-color-adjust:exact;color-adjust:exact}._mat-animation-noopable .mat-checkbox-background{transition:none}.cdk-high-contrast-active .mat-checkbox .mat-checkbox-background{background:none}.mat-checkbox-persistent-ripple{display:block;width:100%;height:100%;transform:none}.mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{opacity:.04}.mat-checkbox.cdk-keyboard-focused .mat-checkbox-persistent-ripple{opacity:.12}.mat-checkbox-persistent-ripple,.mat-checkbox.mat-checkbox-disabled .mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{opacity:0}@media(hover: none){.mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{display:none}}.mat-checkbox-checkmark{top:0;left:0;right:0;bottom:0;position:absolute;width:100%}.mat-checkbox-checkmark-path{stroke-dashoffset:22.910259;stroke-dasharray:22.910259;stroke-width:2.1333333333px}.cdk-high-contrast-black-on-white .mat-checkbox-checkmark-path{stroke:#000 !important}.mat-checkbox-mixedmark{width:calc(100% - 6px);height:2px;opacity:0;transform:scaleX(0) rotate(0deg);border-radius:2px}.cdk-high-contrast-active .mat-checkbox-mixedmark{height:0;border-top:solid 2px;margin-top:2px}.mat-checkbox-label-before .mat-checkbox-inner-container{order:1;margin-left:8px;margin-right:auto}[dir=rtl] .mat-checkbox-label-before .mat-checkbox-inner-container{margin-left:auto;margin-right:8px}.mat-checkbox-checked .mat-checkbox-checkmark{opacity:1}.mat-checkbox-checked .mat-checkbox-checkmark-path{stroke-dashoffset:0}.mat-checkbox-checked .mat-checkbox-mixedmark{transform:scaleX(1) rotate(-45deg)}.mat-checkbox-indeterminate .mat-checkbox-checkmark{opacity:0;transform:rotate(45deg)}.mat-checkbox-indeterminate .mat-checkbox-checkmark-path{stroke-dashoffset:0}.mat-checkbox-indeterminate .mat-checkbox-mixedmark{opacity:1;transform:scaleX(1) rotate(0deg)}.mat-checkbox-unchecked .mat-checkbox-background{background-color:rgba(0,0,0,0)}.mat-checkbox-disabled{cursor:default}.cdk-high-contrast-active .mat-checkbox-disabled{opacity:.5}.mat-checkbox-anim-unchecked-checked .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-in-background}.mat-checkbox-anim-unchecked-checked .mat-checkbox-checkmark-path{animation:180ms linear 0ms mat-checkbox-unchecked-checked-checkmark-path}.mat-checkbox-anim-unchecked-indeterminate .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-in-background}.mat-checkbox-anim-unchecked-indeterminate .mat-checkbox-mixedmark{animation:90ms linear 0ms mat-checkbox-unchecked-indeterminate-mixedmark}.mat-checkbox-anim-checked-unchecked .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-out-background}.mat-checkbox-anim-checked-unchecked .mat-checkbox-checkmark-path{animation:90ms linear 0ms mat-checkbox-checked-unchecked-checkmark-path}.mat-checkbox-anim-checked-indeterminate .mat-checkbox-checkmark{animation:90ms linear 0ms mat-checkbox-checked-indeterminate-checkmark}.mat-checkbox-anim-checked-indeterminate .mat-checkbox-mixedmark{animation:90ms linear 0ms mat-checkbox-checked-indeterminate-mixedmark}.mat-checkbox-anim-indeterminate-checked .mat-checkbox-checkmark{animation:500ms linear 0ms mat-checkbox-indeterminate-checked-checkmark}.mat-checkbox-anim-indeterminate-checked .mat-checkbox-mixedmark{animation:500ms linear 0ms mat-checkbox-indeterminate-checked-mixedmark}.mat-checkbox-anim-indeterminate-unchecked .mat-checkbox-background{animation:180ms linear 0ms mat-checkbox-fade-out-background}.mat-checkbox-anim-indeterminate-unchecked .mat-checkbox-mixedmark{animation:300ms linear 0ms mat-checkbox-indeterminate-unchecked-mixedmark}.mat-checkbox-input{bottom:0;left:50%}.mat-checkbox-input:focus~.mat-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0}),i})(),aO=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({}),i})(),i6=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[Pb,Lr,tM,aO,Lr,aO]}),i})();function n6(i,t){if(1&i&&(pi(0,"mat-option",36),vn(1),xi()),2&i){const e=t.$implicit;on("value",e),Ni(1),fh(" ",e.name," ")}}const lO=function(i,t){return[i,t]};function r6(i,t){if(1&i&&(pi(0,"mat-option",37),vn(1),xi()),2&i){const e=t.$implicit;on("value",H1(2,lO,e[0],e[1])),Ni(1),fh(" ",e[0]," ")}}function o6(i,t){if(1&i&&(pi(0,"mat-option",36),vn(1),xi()),2&i){const e=t.$implicit;on("value",H1(2,lO,e[0],e[1])),Ni(1),fh(" ",e[0]," ")}}let s6=(()=>{class i{constructor(e,n){this.service=e,this.chart=n}ngOnInit(){this.get_country()}get_country(){this.service.getCounryCSV().subscribe(e=>{const n=e.split("\n");let o=0;n.slice(1).forEach(c=>{if(""!=c){let f=(c=c.replace("\r","")).split(",");this.chart.countries_list[o]=[f[0]],this.chart.countries_list[o].push(f[1]),o++}})})}find_cities(e){this.service.getCityJson().subscribe(n=>{let o=JSON.stringify(n),c=0;this.chart.cities_list=[];for(let f of JSON.parse(o))f.country==e[1]&&(this.chart.cities_list[c]=[f.name],this.chart.cities_list[c].push(f.country),c++);this.chart.cities_list=this.chart.cities_list.reverse()})}city_selected(e){let n="",o="";e.name?(n=e.name,o=e.country):(n=e[0],o=e[1]),this.chart.getUpToData(o,n,this.chart.selected_unit_celsius)}}return i.\u0275fac=function(e){return new(e||i)(ft(WE),ft(dv))},i.\u0275cmp=Cr({type:i,selectors:[["app-chart-settings"]],decls:71,vars:11,consts:[["id","container-settings"],[2,"text-align","right"],["routerLink","/","routerLinkActive","active","ariaCurrentWhenActive","page","id","route-button","mat-icon-button","","type","button"],["fontIcon","home"],["id","menu_button","type","button","mat-icon-button","",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["id","type-of-fetch",1,"container-tile"],["id","enabled"],["default_method",""],[3,"value","valueChange"],["name","city",3,"value",4,"ngFor","ngForOf"],["id","disabled"],["modify_method",""],["id","content-box"],["id","mat-field-modify-params"],["name","Latitude","type","number","step","0.01","matInput","","placeholder","range of -90 to 90","value","0",3,"change"],["lat",""],["name","Longitude","type","number","step","0.01","matInput","","placeholder","range of -180 to 180","value","0",3,"change"],["lon",""],["id","raised-button","mat-raised-button","","type","button","mat-button","",3,"ngModel","click"],["id","check_box_country","color","primary",3,"ngModel","ngModelChange","change"],["id","form_queary_params"],[3,"disabled","valueChange"],["country_select",""],["name","country",3,"value",4,"ngFor","ngForOf"],["city_select",""],[1,"container-extra-params"],["id","units-section"],[3,"formControl","valueChange"],["value","C"],["value","F"],["id","chart-type-section"],["value","spline"],["value","areaspline"],["value","column"],["name","city",3,"value"],["name","country",3,"value"]],template:function(e,n){if(1&e){const o=Qp();pi(0,"mat-card",0)(1,"div",1)(2,"button",2)(3,"mat-icon",3),vn(4,"Home"),xi()(),pi(5,"button",4)(6,"mat-icon"),vn(7,"menu"),xi(),pi(8,"mat-menu",null,5)(10,"button",6),Rn("click",function(){Io(o);const f=js(9),y=js(14),w=js(21);return lr(n.chart.change_method(f,y,w))}),vn(11),xi()()()(),pi(12,"div",7)(13,"div",8,9)(15,"mat-form-field")(16,"mat-label"),vn(17,"Choose city"),xi(),pi(18,"mat-select",10),Rn("valueChange",function(f){return n.city_selected(f)})("valueChange",function(f){return n.chart.selected=f}),Pr(19,n6,2,2,"mat-option",11),xi()()(),pi(20,"div",12,13)(22,"div",14)(23,"mat-form-field",15)(24,"mat-label"),vn(25,"Type latitude"),xi(),pi(26,"input",16,17),Rn("change",function(){Io(o);const f=js(27);return lr(n.chart.Check_value(f,1))}),xi()(),pi(28,"mat-form-field",15)(29,"mat-label"),vn(30,"Type longitude"),xi(),pi(31,"input",18,19),Rn("change",function(){Io(o);const f=js(32);return lr(n.chart.Check_value(f,0))}),xi()(),pi(33,"button",20),Rn("ngModel",function(){return n.chart.button_model})("click",function(){Io(o);const f=js(27),y=js(32);return lr(n.chart.Submit_by_params(f.value,y.value))}),vn(34,"Submit"),xi()(),pi(35,"div",14)(36,"mat-checkbox",21),Rn("ngModelChange",function(f){return n.chart.check_box=f})("change",function(f){Io(o);const y=js(42),w=js(48);return lr(n.chart.switch_country_select(f,y,w))}),vn(37,"Try search by country "),xi(),pi(38,"mat-form-field",22)(39,"mat-label"),vn(40,"Choose country"),xi(),pi(41,"mat-select",23,24),Rn("valueChange",function(f){return n.find_cities(f)}),Pr(43,r6,2,5,"mat-option",25),xi()(),pi(44,"mat-form-field",22)(45,"mat-label"),vn(46,"Choose city"),xi(),pi(47,"mat-select",23,26),Rn("valueChange",function(f){return n.city_selected(f)}),Pr(49,o6,2,5,"mat-option",11),xi()()()()(),pi(50,"div",27)(51,"div",28)(52,"mat-form-field")(53,"mat-label"),vn(54,"Temperature unit"),xi(),pi(55,"mat-select",29),Rn("valueChange",function(f){Io(o);const y=js(14),w=js(27),L=js(32);return lr(n.chart.change_unit(f,y,w.value,L.value))}),pi(56,"mat-option",30),vn(57,"\xb0C"),xi(),pi(58,"mat-option",31),vn(59,"\xb0F"),xi()()()(),pi(60,"div",32)(61,"mat-form-field")(62,"mat-label"),vn(63,"Chart type"),xi(),pi(64,"mat-select",29),Rn("valueChange",function(f){return n.chart.change_chart_type(f)}),pi(65,"mat-option",33),vn(66,"Line"),xi(),pi(67,"mat-option",34),vn(68,"Area"),xi(),pi(69,"mat-option",35),vn(70,"Column"),xi()()()()()()}if(2&e){const o=js(9);Ni(5),on("matMenuTriggerFor",o),Ni(6),Ac(n.chart.menu_text),Ni(7),on("value",n.chart.selected),Ni(1),on("ngForOf",n.chart.cities),Ni(17),on("ngModel",n.chart.check_box),Ni(5),on("disabled",!0),Ni(2),on("ngForOf",n.chart.countries_list),Ni(4),on("disabled",!0),Ni(2),on("ngForOf",n.chart.cities_list),Ni(6),on("formControl",n.chart.selected_temp),Ni(9),on("formControl",n.chart.selectedType_form)}},dependencies:[TC,Uy,mE,UH,bM,lG,E2,mG,Lb,DG,z2,BG,Gb,UG,sO,NI,IE,OE],styles:["input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;appearance:none;margin:0}  .mat-select-panel::-webkit-scrollbar{display:none}.background-img[_ngcontent-%COMP%]{width:100%;height:100%;z-index:-1}#container-settings[_ngcontent-%COMP%]{width:auto;height:auto}.container-tile[_ngcontent-%COMP%]{display:flex}#enabled[_ngcontent-%COMP%]{display:flex;width:100%}#disabled[_ngcontent-%COMP%]{display:none;width:100%}#raised-button[_ngcontent-%COMP%]{margin-right:0;width:100%;margin-bottom:10px}mat-form-field[_ngcontent-%COMP%]{width:100%}#form_queary_params[_ngcontent-%COMP%]{margin:10px 0}#content-box[_ngcontent-%COMP%]{padding:0 5px;width:calc(50% - 10px)}mat-card[_ngcontent-%COMP%]{margin:10px}@media (max-width: 700px){mat-form-field[_ngcontent-%COMP%]{padding:0 5px;width:calc(100% - 10px)}#container-settings[_ngcontent-%COMP%]{padding:0}  .mat-checkbox-layout .mat-checkbox-label{line-height:12px;white-space:break-spaces}}"]}),i})(),a6=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=Cr({type:i,selectors:[["app-charts-page"]],decls:5,vars:0,consts:[[1,"main-container-charts"]],template:function(e,n){1&e&&(zn(0,"app-header"),pi(1,"div",0),zn(2,"app-chart-settings")(3,"app-chart"),xi(),zn(4,"app-bottom"))},dependencies:[dv,mH,gH,s6],styles:["[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.main-container-charts[_ngcontent-%COMP%]{width:50vw;margin:auto}@media (max-width:1200px){.main-container-charts[_ngcontent-%COMP%]{width:80vw}}@media (max-width:800px){.main-container-charts[_ngcontent-%COMP%]{width:100vw}}"]}),i})();var gv=Is(898);const cO_mapbox_accessToken="pk.eyJ1Ijoiem9vbW5payIsImEiOiJjbGRyZGhvbXIxa2c0M3ZxZ2xvdGwzMHo5In0.xRY-iHH4ZrgO24zscCL0dg",l6=[{path:"",title:"World map",component:(()=>{class i{constructor(e,n){this._snackBar=e,this.router=n,this.style="mapbox://styles/mapbox/streets-v11",this.lat=45,this.lng=90,this.zoom=0,this.xCoord=0,this.yCoord=0,this.current_location=[],this.xStartCoord=0,this.yStartCoord=0,this.markerStyle={"left.%":this.xCoord,"top.%":this.yCoord,display:"none"},this.labelStyle={display:"none"},this.chartsStyle={opacity:"0","-webkit-transform":"translate(100%, 0)",transition:"opacity 0s, transform 1s"},this.marker_init=!1,this.xMarkerCoord=0,this.yMarkerCoord=0,this.check=!1,gv.accessToken=cO_mapbox_accessToken}ngOnInit(){this.buildMap(),this.marker=new gv.Marker}buildMap(){new gv.NavigationControl({visualizePitch:!0}),this.map=new gv.Map({container:"map",style:this.style,zoom:this.zoom,center:[this.lng,this.lat],attributionControl:!1}),this.map.addControl(new gv.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0,showUserLocation:!0})),this.map.on("click",this.show.bind(this))}show(e){console.log(e.lngLat);let n=e.lngLat;this.marker.setLngLat(n).addTo(this.map),this.get_charts(n)}get_charts(e){this.change_display_charts(!0),this.router.navigateByUrl("/",{skipLocationChange:!0}).then(()=>this.router.navigate(["/weather-local",{latitude:e.lat,longitude:e.lng}]))}changeRoute(){this.change_display_charts(!1),this.router.navigate(["/"])}change_display_charts(e){this.chartsStyle=e?{opacity:"1","-webkit-transform":"translate(0)",transition:"opacity 0s, transform 1s"}:{opacity:"0","-webkit-transform":"translate(100%, 0)",transition:"opacity 0s 1s, transform .5s"}}}return i.\u0275fac=function(e){return new(e||i)(ft(B2),ft(gs))},i.\u0275cmp=Cr({type:i,selectors:[["app-map"]],decls:12,vars:2,consts:[["href","http://api.mapbox.com/mapbox-gl-js/v2.9.2/mapbox-gl.css","rel","stylesheet"],["id","map",1,"map-container"],[1,"details-container",3,"ngStyle"],[1,"control-panel"],["id","buttons-panel"],["routerLink","/weather-forecast","routerLinkActive","active","ariaCurrentWhenActive","page","id","route-button","mat-flat-button","","type","button","mat-button",""],["id","close-charts","mat-button","","type","button","mat-flat-button","",3,"click"],[1,"charts-container"]],template:function(e,n){1&e&&(zn(0,"link",0)(1,"div",1),pi(2,"div")(3,"div",2)(4,"div",3)(5,"h2"),vn(6,"Location"),xi(),pi(7,"div",4),zn(8,"button",5),pi(9,"button",6),Rn("click",function(){return n.changeRoute()}),xi()()(),pi(10,"div",7),zn(11,"router-outlet"),xi()()()),2&e&&(Ni(1),on("@map",void 0),Ni(2),on("ngStyle",n.chartsStyle))},dependencies:[xA,Ux,Uy,mE,Lb],styles:["html[_ngcontent-%COMP%]{overflow:auto}body[_ngcontent-%COMP%]{height:100%}p[_ngcontent-%COMP%], span[_ngcontent-%COMP%]{font-weight:lighter;-webkit-user-select:none;user-select:none;pointer-events:none;-webkit-user-drag:none}.map-container[_ngcontent-%COMP%]{width:100vw;height:100vh}.details-container[_ngcontent-%COMP%]{position:fixed;right:0;top:0;height:100vh;width:500px;z-index:10;overflow:scroll;background:white;transition-property:display,transform;transition-delay:2s,0s}.control-panel[_ngcontent-%COMP%]{width:100%;justify-content:space-between;padding:5px 10px;box-sizing:border-box;display:flex}#buttons-panel[_ngcontent-%COMP%]{display:flex}.control-panel[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], a[_ngcontent-%COMP%]{margin:auto 0}.control-panel[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;color:#6a6aff}#route-button[_ngcontent-%COMP%]{margin:auto 20px auto 0;background:rgb(183 183 250);background-size:50%;width:40px;height:40px;padding:0;border-radius:50%;min-width:0;background-position:center;background-image:url(https://img.icons8.com/material-rounded/344/combo-chart.png);background-repeat:no-repeat}#route-button[_ngcontent-%COMP%]:hover{background:rgb(240,175,0);background-size:50%;background-position:center;background-image:url(https://img.icons8.com/material-rounded/344/combo-chart.png);background-repeat:no-repeat}#close-charts[_ngcontent-%COMP%]{margin:auto 0;background:rgb(183 183 250);background-size:50%;width:40px;height:40px;padding:0;border-radius:50%;min-width:0;background-position:center;background-image:url(https://www.svgrepo.com/show/30681/close.svg);background-repeat:no-repeat}#close-charts[_ngcontent-%COMP%]:hover{background:rgb(240,175,0);background-size:50%;background-position:center;background-image:url(https://www.svgrepo.com/show/30681/close.svg);background-repeat:no-repeat}@media (max-width: 700px){.details-container[_ngcontent-%COMP%]{width:100vw;left:0}.control-panel[_ngcontent-%COMP%]{width:100%;padding:0}}"]}),i})(),children:[{path:"weather-local",component:dv}]},{path:"local",component:dv},{path:"weather-forecast",title:"Weather Forecast",component:a6},{path:"**",redirectTo:"/"}];let c6=(()=>{class i{resolve(){return Promise.resolve("child a")}}return i.\u0275prov=hi({token:i,factory:i.\u0275fac,providedIn:"root"}),i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[aI.forRoot(l6),aI]}),i})(),h6=(()=>{class i{constructor(){this.title="Weather forecast"}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=Cr({type:i,selectors:[["app-root"]],decls:1,vars:0,template:function(e,n){1&e&&zn(0,"router-outlet")},dependencies:[Ux]}),i})(),u6=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({}),i})();function hO(i){return new ti(3e3,!1)}function W6(){return typeof window<"u"&&typeof window.document<"u"}function MM(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function zd(i){switch(i.length){case 0:return new cv;case 1:return i[0];default:return new k2(i)}}function uO(i,t,e,n,o=new Map,c=new Map){const f=[],y=[];let w=-1,L=null;if(n.forEach(le=>{const ye=le.get("offset"),Be=ye==w,Xe=Be&&L||new Map;le.forEach((ot,yt)=>{let jt=yt,Gt=ot;if("offset"!==yt)switch(jt=t.normalizePropertyName(jt,f),Gt){case"!":Gt=o.get(yt);break;case _u:Gt=c.get(yt);break;default:Gt=t.normalizeStyleValue(yt,jt,Gt,f)}Xe.set(jt,Gt)}),Be||y.push(Xe),L=Xe,w=ye}),f.length)throw function R6(i){return new ti(3502,!1)}();return y}function SM(i,t,e,n){switch(t){case"start":i.onStart(()=>n(e&&TM(e,"start",i)));break;case"done":i.onDone(()=>n(e&&TM(e,"done",i)));break;case"destroy":i.onDestroy(()=>n(e&&TM(e,"destroy",i)))}}function TM(i,t,e){const c=DM(i.element,i.triggerName,i.fromState,i.toState,t||i.phaseName,e.totalTime??i.totalTime,!!e.disabled),f=i._data;return null!=f&&(c._data=f),c}function DM(i,t,e,n,o="",c=0,f){return{element:i,triggerName:t,fromState:e,toState:n,phaseName:o,totalTime:c,disabled:!!f}}function _l(i,t,e){let n=i.get(t);return n||i.set(t,n=e),n}function dO(i){const t=i.indexOf(":");return[i.substring(1,t),i.slice(t+1)]}let AM=(i,t)=>!1,pO=(i,t,e)=>[],fO=null;function kM(i){const t=i.parentNode||i.host;return t===fO?null:t}(MM()||typeof Element<"u")&&(W6()?(fO=(()=>document.documentElement)(),AM=(i,t)=>{for(;t;){if(t===i)return!0;t=kM(t)}return!1}):AM=(i,t)=>i.contains(t),pO=(i,t,e)=>{if(e)return Array.from(i.querySelectorAll(t));const n=i.querySelector(t);return n?[n]:[]});let yf=null,mO=!1;const gO=AM,_O=pO;let yO=(()=>{class i{validateStyleProperty(e){return function q6(i){yf||(yf=function Y6(){return typeof document<"u"?document.body:null}()||{},mO=!!yf.style&&"WebkitAppearance"in yf.style);let t=!0;return yf.style&&!function X6(i){return"ebkit"==i.substring(1,6)}(i)&&(t=i in yf.style,!t&&mO&&(t="Webkit"+i.charAt(0).toUpperCase()+i.slice(1)in yf.style)),t}(e)}matchesElement(e,n){return!1}containsElement(e,n){return gO(e,n)}getParentElement(e){return kM(e)}query(e,n,o){return _O(e,n,o)}computeStyle(e,n,o){return o||""}animate(e,n,o,c,f,y=[],w){return new cv(o,c)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})(),IM=(()=>{class i{}return i.NOOP=new yO,i})();const PM="ng-enter",$b="ng-leave",Wb="ng-trigger",Xb=".ng-trigger",xO="ng-animating",OM=".ng-animating";function Vd(i){if("number"==typeof i)return i;const t=i.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:RM(parseFloat(t[1]),t[2])}function RM(i,t){return"s"===t?1e3*i:i}function qb(i,t,e){return i.hasOwnProperty("duration")?i:function Q6(i,t,e){let o,c=0,f="";if("string"==typeof i){const y=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===y)return t.push(hO()),{duration:0,delay:0,easing:""};o=RM(parseFloat(y[1]),y[2]);const w=y[3];null!=w&&(c=RM(parseFloat(w),y[4]));const L=y[5];L&&(f=L)}else o=i;if(!e){let y=!1,w=t.length;o<0&&(t.push(function d6(){return new ti(3100,!1)}()),y=!0),c<0&&(t.push(function p6(){return new ti(3101,!1)}()),y=!0),y&&t.splice(w,0,hO())}return{duration:o,delay:c,easing:f}}(i,t,e)}function _v(i,t={}){return Object.keys(i).forEach(e=>{t[e]=i[e]}),t}function bO(i){const t=new Map;return Object.keys(i).forEach(e=>{t.set(e,i[e])}),t}function jd(i,t=new Map,e){if(e)for(let[n,o]of e)t.set(n,o);for(let[n,o]of i)t.set(n,o);return t}function CO(i,t,e){return e?t+":"+e+";":""}function EO(i){let t="";for(let e=0;e<i.style.length;e++){const n=i.style.item(e);t+=CO(0,n,i.style.getPropertyValue(n))}for(const e in i.style)i.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=CO(0,i$(e),i.style[e]));i.setAttribute("style",t)}function wh(i,t,e){i.style&&(t.forEach((n,o)=>{const c=FM(o);e&&!e.has(o)&&e.set(o,i.style[c]),i.style[c]=n}),MM()&&EO(i))}function vf(i,t){i.style&&(t.forEach((e,n)=>{const o=FM(n);i.style[o]=""}),MM()&&EO(i))}function yv(i){return Array.isArray(i)?1==i.length?i[0]:D2(i):i}const LM=new RegExp("{{\\s*(.+?)\\s*}}","g");function MO(i){let t=[];if("string"==typeof i){let e;for(;e=LM.exec(i);)t.push(e[1]);LM.lastIndex=0}return t}function Yb(i,t,e){const n=i.toString(),o=n.replace(LM,(c,f)=>{let y=t[f];return null==y&&(e.push(function m6(i){return new ti(3003,!1)}()),y=""),y.toString()});return o==n?i:o}function Zb(i){const t=[];let e=i.next();for(;!e.done;)t.push(e.value),e=i.next();return t}const t$=/-+([a-z0-9])/g;function FM(i){return i.replace(t$,(...t)=>t[1].toUpperCase())}function i$(i){return i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function yl(i,t,e){switch(t.type){case 7:return i.visitTrigger(t,e);case 0:return i.visitState(t,e);case 1:return i.visitTransition(t,e);case 2:return i.visitSequence(t,e);case 3:return i.visitGroup(t,e);case 4:return i.visitAnimate(t,e);case 5:return i.visitKeyframes(t,e);case 6:return i.visitStyle(t,e);case 8:return i.visitReference(t,e);case 9:return i.visitAnimateChild(t,e);case 10:return i.visitAnimateRef(t,e);case 11:return i.visitQuery(t,e);case 12:return i.visitStagger(t,e);default:throw function g6(i){return new ti(3004,!1)}()}}function SO(i,t){return window.getComputedStyle(i)[t]}function l$(i,t){const e=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(n=>function c$(i,t,e){if(":"==i[0]){const w=function h$(i,t){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,n)=>parseFloat(n)>parseFloat(e);case":decrement":return(e,n)=>parseFloat(n)<parseFloat(e);default:return t.push(function k6(i){return new ti(3016,!1)}()),"* => *"}}(i,e);if("function"==typeof w)return void t.push(w);i=w}const n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return e.push(function A6(i){return new ti(3015,!1)}()),t;const o=n[1],c=n[2],f=n[3];t.push(TO(o,f));"<"==c[0]&&!("*"==o&&"*"==f)&&t.push(TO(f,o))}(n,e,t)):e.push(i),e}const ew=new Set(["true","1"]),tw=new Set(["false","0"]);function TO(i,t){const e=ew.has(i)||tw.has(i),n=ew.has(t)||tw.has(t);return(o,c)=>{let f="*"==i||i==o,y="*"==t||t==c;return!f&&e&&"boolean"==typeof o&&(f=o?ew.has(i):tw.has(i)),!y&&n&&"boolean"==typeof c&&(y=c?ew.has(t):tw.has(t)),f&&y}}const u$=new RegExp("s*:selfs*,?","g");function NM(i,t,e,n){return new d$(i).build(t,e,n)}class d${constructor(t){this._driver=t}build(t,e,n){const o=new m$(e);return this._resetContextStyleTimingState(o),yl(this,yv(t),o)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,o=e.depCount=0;const c=[],f=[];return"@"==t.name.charAt(0)&&e.errors.push(function y6(){return new ti(3006,!1)}()),t.definitions.forEach(y=>{if(this._resetContextStyleTimingState(e),0==y.type){const w=y,L=w.name;L.toString().split(/\s*,\s*/).forEach(le=>{w.name=le,c.push(this.visitState(w,e))}),w.name=L}else if(1==y.type){const w=this.visitTransition(y,e);n+=w.queryCount,o+=w.depCount,f.push(w)}else e.errors.push(function v6(){return new ti(3007,!1)}())}),{type:7,name:t.name,states:c,transitions:f,queryCount:n,depCount:o,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),o=t.options&&t.options.params||null;if(n.containsDynamicStyles){const c=new Set,f=o||{};n.styles.forEach(y=>{y instanceof Map&&y.forEach(w=>{MO(w).forEach(L=>{f.hasOwnProperty(L)||c.add(L)})})}),c.size&&(Zb(c.values()),e.errors.push(function x6(i,t){return new ti(3008,!1)}()))}return{type:0,name:t.name,style:n,options:o?{params:o}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=yl(this,yv(t.animation),e);return{type:1,matchers:l$(t.expr,e.errors),animation:n,queryCount:e.queryCount,depCount:e.depCount,options:xf(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(n=>yl(this,n,e)),options:xf(t.options)}}visitGroup(t,e){const n=e.currentTime;let o=0;const c=t.steps.map(f=>{e.currentTime=n;const y=yl(this,f,e);return o=Math.max(o,e.currentTime),y});return e.currentTime=o,{type:3,steps:c,options:xf(t.options)}}visitAnimate(t,e){const n=function _$(i,t){if(i.hasOwnProperty("duration"))return i;if("number"==typeof i)return BM(qb(i,t).duration,0,"");const e=i;if(e.split(/\s+/).some(c=>"{"==c.charAt(0)&&"{"==c.charAt(1))){const c=BM(0,0,"");return c.dynamic=!0,c.strValue=e,c}const o=qb(e,t);return BM(o.duration,o.delay,o.easing)}(t.timings,e.errors);e.currentAnimateTimings=n;let o,c=t.styles?t.styles:ts({});if(5==c.type)o=this.visitKeyframes(c,e);else{let f=t.styles,y=!1;if(!f){y=!0;const L={};n.easing&&(L.easing=n.easing),f=ts(L)}e.currentTime+=n.duration+n.delay;const w=this.visitStyle(f,e);w.isEmptyStep=y,o=w}return e.currentAnimateTimings=null,{type:4,timings:n,style:o,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[],o=Array.isArray(t.styles)?t.styles:[t.styles];for(let y of o)"string"==typeof y?y===_u?n.push(y):e.errors.push(new ti(3002,!1)):n.push(bO(y));let c=!1,f=null;return n.forEach(y=>{if(y instanceof Map&&(y.has("easing")&&(f=y.get("easing"),y.delete("easing")),!c))for(let w of y.values())if(w.toString().indexOf("{{")>=0){c=!0;break}}),{type:6,styles:n,easing:f,offset:t.offset,containsDynamicStyles:c,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let o=e.currentTime,c=e.currentTime;n&&c>0&&(c-=n.duration+n.delay),t.styles.forEach(f=>{"string"!=typeof f&&f.forEach((y,w)=>{const L=e.collectedStyles.get(e.currentQuerySelector),le=L.get(w);let ye=!0;le&&(c!=o&&c>=le.startTime&&o<=le.endTime&&(e.errors.push(function w6(i,t,e,n,o){return new ti(3010,!1)}()),ye=!1),c=le.startTime),ye&&L.set(w,{startTime:c,endTime:o}),e.options&&function e$(i,t,e){const n=t.params||{},o=MO(i);o.length&&o.forEach(c=>{n.hasOwnProperty(c)||e.push(function f6(i){return new ti(3001,!1)}())})}(y,e.options,e.errors)})})}visitKeyframes(t,e){const n={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function C6(){return new ti(3011,!1)}()),n;let c=0;const f=[];let y=!1,w=!1,L=0;const le=t.steps.map(Gt=>{const fi=this._makeStyleAst(Gt,e);let qt=null!=fi.offset?fi.offset:function g$(i){if("string"==typeof i)return null;let t=null;if(Array.isArray(i))i.forEach(e=>{if(e instanceof Map&&e.has("offset")){const n=e;t=parseFloat(n.get("offset")),n.delete("offset")}});else if(i instanceof Map&&i.has("offset")){const e=i;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(fi.styles),Mi=0;return null!=qt&&(c++,Mi=fi.offset=qt),w=w||Mi<0||Mi>1,y=y||Mi<L,L=Mi,f.push(Mi),fi});w&&e.errors.push(function E6(){return new ti(3012,!1)}()),y&&e.errors.push(function M6(){return new ti(3200,!1)}());const ye=t.steps.length;let Be=0;c>0&&c<ye?e.errors.push(function S6(){return new ti(3202,!1)}()):0==c&&(Be=1/(ye-1));const Xe=ye-1,ot=e.currentTime,yt=e.currentAnimateTimings,jt=yt.duration;return le.forEach((Gt,fi)=>{const qt=Be>0?fi==Xe?1:Be*fi:f[fi],Mi=qt*jt;e.currentTime=ot+yt.delay+Mi,yt.duration=Mi,this._validateStyleAst(Gt,e),Gt.offset=qt,n.styles.push(Gt)}),n}visitReference(t,e){return{type:8,animation:yl(this,yv(t.animation),e),options:xf(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:xf(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:xf(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,o=t.options||{};e.queryCount++,e.currentQuery=t;const[c,f]=function p$(i){const t=!!i.split(/\s*,\s*/).find(e=>":self"==e);return t&&(i=i.replace(u$,"")),i=i.replace(/@\*/g,Xb).replace(/@\w+/g,e=>Xb+"-"+e.slice(1)).replace(/:animating/g,OM),[i,t]}(t.selector);e.currentQuerySelector=n.length?n+" "+c:c,_l(e.collectedStyles,e.currentQuerySelector,new Map);const y=yl(this,yv(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:c,limit:o.limit||0,optional:!!o.optional,includeSelf:f,animation:y,originalSelector:t.selector,options:xf(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function T6(){return new ti(3013,!1)}());const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:qb(t.timings,e.errors,!0);return{type:12,animation:yl(this,yv(t.animation),e),timings:n,options:null}}}class m${constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function xf(i){return i?(i=_v(i)).params&&(i.params=function f$(i){return i?_v(i):null}(i.params)):i={},i}function BM(i,t,e){return{duration:i,delay:t,easing:e}}function zM(i,t,e,n,o,c,f=null,y=!1){return{type:1,element:i,keyframes:t,preStyleProps:e,postStyleProps:n,duration:o,delay:c,totalTime:o+c,easing:f,subTimeline:y}}class iw{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const x$=new RegExp(":enter","g"),w$=new RegExp(":leave","g");function VM(i,t,e,n,o,c=new Map,f=new Map,y,w,L=[]){return(new C$).buildKeyframes(i,t,e,n,o,c,f,y,w,L)}class C${buildKeyframes(t,e,n,o,c,f,y,w,L,le=[]){L=L||new iw;const ye=new jM(t,e,L,o,c,le,[]);ye.options=w;const Be=w.delay?Vd(w.delay):0;ye.currentTimeline.delayNextStep(Be),ye.currentTimeline.setStyles([f],null,ye.errors,w),yl(this,n,ye);const Xe=ye.timelines.filter(ot=>ot.containsAnimation());if(Xe.length&&y.size){let ot;for(let yt=Xe.length-1;yt>=0;yt--){const jt=Xe[yt];if(jt.element===e){ot=jt;break}}ot&&!ot.allowOnlyTimelineStyles()&&ot.setStyles([y],null,ye.errors,w)}return Xe.length?Xe.map(ot=>ot.buildKeyframes()):[zM(e,[],[],[],0,Be,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.get(e.element);if(n){const o=e.createSubContext(t.options),c=e.currentTimeline.currentTime,f=this._visitSubInstructions(n,o,o.options);c!=f&&e.transformIntoNewTimeline(f)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,n){let c=e.currentTimeline.currentTime;const f=null!=n.duration?Vd(n.duration):null,y=null!=n.delay?Vd(n.delay):null;return 0!==f&&t.forEach(w=>{const L=e.appendInstructionToTimeline(w,f,y);c=Math.max(c,L.duration+L.delay)}),c}visitReference(t,e){e.updateOptions(t.options,!0),yl(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let o=e;const c=t.options;if(c&&(c.params||c.delay)&&(o=e.createSubContext(c),o.transformIntoNewTimeline(),null!=c.delay)){6==o.previousNode.type&&(o.currentTimeline.snapshotCurrentStyles(),o.previousNode=nw);const f=Vd(c.delay);o.delayNextStep(f)}t.steps.length&&(t.steps.forEach(f=>yl(this,f,o)),o.currentTimeline.applyStylesToKeyframe(),o.subContextCount>n&&o.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let o=e.currentTimeline.currentTime;const c=t.options&&t.options.delay?Vd(t.options.delay):0;t.steps.forEach(f=>{const y=e.createSubContext(t.options);c&&y.delayNextStep(c),yl(this,f,y),o=Math.max(o,y.currentTimeline.currentTime),n.push(y.currentTimeline)}),n.forEach(f=>e.currentTimeline.mergeTimelineCollectedStyles(f)),e.transformIntoNewTimeline(o),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return qb(e.params?Yb(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),o=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),o.snapshotCurrentStyles());const c=t.style;5==c.type?this.visitKeyframes(c,e):(e.incrementTime(n.duration),this.visitStyle(c,e),o.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,o=e.currentAnimateTimings;!o&&n.hasCurrentStyleProperties()&&n.forwardFrame();const c=o&&o.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(c):n.setStyles(t.styles,c,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,o=e.currentTimeline.duration,c=n.duration,y=e.createSubContext().currentTimeline;y.easing=n.easing,t.styles.forEach(w=>{y.forwardTime((w.offset||0)*c),y.setStyles(w.styles,w.easing,e.errors,e.options),y.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(y),e.transformIntoNewTimeline(o+c),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,o=t.options||{},c=o.delay?Vd(o.delay):0;c&&(6===e.previousNode.type||0==n&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=nw);let f=n;const y=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!o.optional,e.errors);e.currentQueryTotal=y.length;let w=null;y.forEach((L,le)=>{e.currentQueryIndex=le;const ye=e.createSubContext(t.options,L);c&&ye.delayNextStep(c),L===e.element&&(w=ye.currentTimeline),yl(this,t.animation,ye),ye.currentTimeline.applyStylesToKeyframe(),f=Math.max(f,ye.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(f),w&&(e.currentTimeline.mergeTimelineCollectedStyles(w),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,o=e.currentTimeline,c=t.timings,f=Math.abs(c.duration),y=f*(e.currentQueryTotal-1);let w=f*e.currentQueryIndex;switch(c.duration<0?"reverse":c.easing){case"reverse":w=y-w;break;case"full":w=n.currentStaggerTime}const le=e.currentTimeline;w&&le.delayNextStep(w);const ye=le.currentTime;yl(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=o.currentTime-ye+(o.startTime-n.currentTimeline.startTime)}}const nw={};class jM{constructor(t,e,n,o,c,f,y,w){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=o,this._leaveClassName=c,this.errors=f,this.timelines=y,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=nw,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=w||new rw(this._driver,e,0),y.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let o=this.options;null!=n.duration&&(o.duration=Vd(n.duration)),null!=n.delay&&(o.delay=Vd(n.delay));const c=n.params;if(c){let f=o.params;f||(f=this.options.params={}),Object.keys(c).forEach(y=>{(!e||!f.hasOwnProperty(y))&&(f[y]=Yb(c[y],f,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(o=>{n[o]=e[o]})}}return t}createSubContext(t=null,e,n){const o=e||this.element,c=new jM(this._driver,o,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(o,n||0));return c.previousNode=this.previousNode,c.currentAnimateTimings=this.currentAnimateTimings,c.options=this._copyOptions(),c.updateOptions(t),c.currentQueryIndex=this.currentQueryIndex,c.currentQueryTotal=this.currentQueryTotal,c.parentContext=this,this.subContextCount++,c}transformIntoNewTimeline(t){return this.previousNode=nw,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const o={duration:e??t.duration,delay:this.currentTimeline.currentTime+(n??0)+t.delay,easing:""},c=new E$(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,o,t.stretchStartingKeyframe);return this.timelines.push(c),o}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,o,c,f){let y=[];if(o&&y.push(this.element),t.length>0){t=(t=t.replace(x$,"."+this._enterClassName)).replace(w$,"."+this._leaveClassName);let L=this._driver.query(this.element,t,1!=n);0!==n&&(L=n<0?L.slice(L.length+n,L.length):L.slice(0,n)),y.push(...L)}return!c&&0==y.length&&f.push(function D6(i){return new ti(3014,!1)}()),y}}class rw{constructor(t,e,n,o){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=o,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new rw(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,n]of this._globalTimelineStyles)this._backFill.set(e,n||_u),this._currentKeyframe.set(e,_u);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,o){e&&this._previousKeyframe.set("easing",e);const c=o&&o.params||{},f=function M$(i,t){const e=new Map;let n;return i.forEach(o=>{if("*"===o){n=n||t.keys();for(let c of n)e.set(c,_u)}else jd(o,e)}),e}(t,this._globalTimelineStyles);for(let[y,w]of f){const L=Yb(w,c,n);this._pendingStyles.set(y,L),this._localTimelineStyles.has(y)||this._backFill.set(y,this._globalTimelineStyles.get(y)??_u),this._updateStyle(y,L)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,n)=>{const o=this._styleSummary.get(n);(!o||e.time>o.time)&&this._updateStyle(n,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let o=[];this._keyframes.forEach((y,w)=>{const L=jd(y,new Map,this._backFill);L.forEach((le,ye)=>{"!"===le?t.add(ye):le===_u&&e.add(ye)}),n||L.set("offset",w/this.duration),o.push(L)});const c=t.size?Zb(t.values()):[],f=e.size?Zb(e.values()):[];if(n){const y=o[0],w=new Map(y);y.set("offset",0),w.set("offset",1),o=[y,w]}return zM(this.element,o,c,f,this.duration,this.startTime,this.easing,!1)}}class E$ extends rw{constructor(t,e,n,o,c,f,y=!1){super(t,e,f.delay),this.keyframes=n,this.preStyleProps=o,this.postStyleProps=c,this._stretchStartingKeyframe=y,this.timings={duration:f.duration,delay:f.delay,easing:f.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:o}=this.timings;if(this._stretchStartingKeyframe&&e){const c=[],f=n+e,y=e/f,w=jd(t[0]);w.set("offset",0),c.push(w);const L=jd(t[0]);L.set("offset",kO(y)),c.push(L);const le=t.length-1;for(let ye=1;ye<=le;ye++){let Be=jd(t[ye]);const Xe=Be.get("offset");Be.set("offset",kO((e+Xe*n)/f)),c.push(Be)}n=f,e=0,o="",t=c}return zM(this.element,t,this.preStyleProps,this.postStyleProps,n,e,o,!0)}}function kO(i,t=3){const e=Math.pow(10,t-1);return Math.round(i*e)/e}class UM{}const S$=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class T$ extends UM{normalizePropertyName(t,e){return FM(t)}normalizeStyleValue(t,e,n,o){let c="";const f=n.toString().trim();if(S$.has(e)&&0!==n&&"0"!==n)if("number"==typeof n)c="px";else{const y=n.match(/^[+-]?[\d\.]+([a-z]*)$/);y&&0==y[1].length&&o.push(function _6(i,t){return new ti(3005,!1)}())}return f+c}}function IO(i,t,e,n,o,c,f,y,w,L,le,ye,Be){return{type:0,element:i,triggerName:t,isRemovalTransition:o,fromState:e,fromStyles:c,toState:n,toStyles:f,timelines:y,queriedElements:w,preStyleProps:L,postStyleProps:le,totalTime:ye,errors:Be}}const HM={};class PO{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,o){return function D$(i,t,e,n,o){return i.some(c=>c(t,e,n,o))}(this.ast.matchers,t,e,n,o)}buildStyles(t,e,n){let o=this._stateStyles.get("*");return void 0!==t&&(o=this._stateStyles.get(t?.toString())||o),o?o.buildStyles(e,n):new Map}build(t,e,n,o,c,f,y,w,L,le){const ye=[],Be=this.ast.options&&this.ast.options.params||HM,ot=this.buildStyles(n,y&&y.params||HM,ye),yt=w&&w.params||HM,jt=this.buildStyles(o,yt,ye),Gt=new Set,fi=new Map,qt=new Map,Mi="void"===o,Xi={params:A$(yt,Be),delay:this.ast.options?.delay},$n=le?[]:VM(t,e,this.ast.animation,c,f,ot,jt,Xi,L,ye);let zr=0;if($n.forEach(ka=>{zr=Math.max(ka.duration+ka.delay,zr)}),ye.length)return IO(e,this._triggerName,n,o,Mi,ot,jt,[],[],fi,qt,zr,ye);$n.forEach(ka=>{const Ia=ka.element,Ud=_l(fi,Ia,new Set);ka.preStyleProps.forEach(vl=>Ud.add(vl));const Lc=_l(qt,Ia,new Set);ka.postStyleProps.forEach(vl=>Lc.add(vl)),Ia!==e&&Gt.add(Ia)});const $s=Zb(Gt.values());return IO(e,this._triggerName,n,o,Mi,ot,jt,$n,$s,fi,qt,zr)}}function A$(i,t){const e=_v(t);for(const n in i)i.hasOwnProperty(n)&&null!=i[n]&&(e[n]=i[n]);return e}class k${constructor(t,e,n){this.styles=t,this.defaultParams=e,this.normalizer=n}buildStyles(t,e){const n=new Map,o=_v(this.defaultParams);return Object.keys(t).forEach(c=>{const f=t[c];null!==f&&(o[c]=f)}),this.styles.styles.forEach(c=>{"string"!=typeof c&&c.forEach((f,y)=>{f&&(f=Yb(f,o,e));const w=this.normalizer.normalizePropertyName(y,e);f=this.normalizer.normalizeStyleValue(y,w,f,e),n.set(w,f)})}),n}}class P${constructor(t,e,n){this.name=t,this.ast=e,this._normalizer=n,this.transitionFactories=[],this.states=new Map,e.states.forEach(o=>{this.states.set(o.name,new k$(o.style,o.options&&o.options.params||{},n))}),OO(this.states,"true","1"),OO(this.states,"false","0"),e.transitions.forEach(o=>{this.transitionFactories.push(new PO(t,o,this.states))}),this.fallbackTransition=function O$(i,t,e){return new PO(i,{type:1,animation:{type:2,steps:[],options:null},matchers:[(f,y)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,o){return this.transitionFactories.find(f=>f.match(t,e,n,o))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function OO(i,t,e){i.has(t)?i.has(e)||i.set(e,i.get(t)):i.has(e)&&i.set(t,i.get(e))}const R$=new iw;class L${constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const n=[],c=NM(this._driver,e,n,[]);if(n.length)throw function L6(i){return new ti(3503,!1)}();this._animations.set(t,c)}_buildPlayer(t,e,n){const o=t.element,c=uO(0,this._normalizer,0,t.keyframes,e,n);return this._driver.animate(o,c,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const o=[],c=this._animations.get(t);let f;const y=new Map;if(c?(f=VM(this._driver,e,c,PM,$b,new Map,new Map,n,R$,o),f.forEach(le=>{const ye=_l(y,le.element,new Map);le.postStyleProps.forEach(Be=>ye.set(Be,null))})):(o.push(function F6(){return new ti(3300,!1)}()),f=[]),o.length)throw function N6(i){return new ti(3504,!1)}();y.forEach((le,ye)=>{le.forEach((Be,Xe)=>{le.set(Xe,this._driver.computeStyle(ye,Xe,_u))})});const L=zd(f.map(le=>{const ye=y.get(le.element);return this._buildPlayer(le,new Map,ye)}));return this._playersById.set(t,L),L.onDestroy(()=>this.destroy(t)),this.players.push(L),L}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function B6(i){return new ti(3301,!1)}();return e}listen(t,e,n,o){const c=DM(e,"","","");return SM(this._getPlayer(t),n,c,o),()=>{}}command(t,e,n,o){if("register"==n)return void this.register(t,o[0]);if("create"==n)return void this.create(t,e,o[0]||{});const c=this._getPlayer(t);switch(n){case"play":c.play();break;case"pause":c.pause();break;case"reset":c.reset();break;case"restart":c.restart();break;case"finish":c.finish();break;case"init":c.init();break;case"setPosition":c.setPosition(parseFloat(o[0]));break;case"destroy":this.destroy(t)}}}const RO="ng-animate-queued",GM="ng-animate-disabled",V$=[],LO={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},j$={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ec="__ng_removed";class $M{constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=function $$(i){return i??null}(n?t.value:t),n){const c=_v(t);delete c.value,this.options=c}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const n=this.options.params;Object.keys(e).forEach(o=>{null==n[o]&&(n[o]=e[o])})}}}const vv="void",WM=new $M(vv);class U${constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,tc(e,this._hostClassName)}listen(t,e,n,o){if(!this._triggers.has(e))throw function z6(i,t){return new ti(3302,!1)}();if(null==n||0==n.length)throw function V6(i){return new ti(3303,!1)}();if(!function W$(i){return"start"==i||"done"==i}(n))throw function j6(i,t){return new ti(3400,!1)}();const c=_l(this._elementListeners,t,[]),f={name:e,phase:n,callback:o};c.push(f);const y=_l(this._engine.statesByElement,t,new Map);return y.has(e)||(tc(t,Wb),tc(t,Wb+"-"+e),y.set(e,WM)),()=>{this._engine.afterFlush(()=>{const w=c.indexOf(f);w>=0&&c.splice(w,1),this._triggers.has(e)||y.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function U6(i){return new ti(3401,!1)}();return e}trigger(t,e,n,o=!0){const c=this._getTrigger(e),f=new XM(this.id,e,t);let y=this._engine.statesByElement.get(t);y||(tc(t,Wb),tc(t,Wb+"-"+e),this._engine.statesByElement.set(t,y=new Map));let w=y.get(e);const L=new $M(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&w&&L.absorbOptions(w.options),y.set(e,L),w||(w=WM),L.value!==vv&&w.value===L.value){if(!function Y$(i,t){const e=Object.keys(i),n=Object.keys(t);if(e.length!=n.length)return!1;for(let o=0;o<e.length;o++){const c=e[o];if(!t.hasOwnProperty(c)||i[c]!==t[c])return!1}return!0}(w.params,L.params)){const yt=[],jt=c.matchStyles(w.value,w.params,yt),Gt=c.matchStyles(L.value,L.params,yt);yt.length?this._engine.reportError(yt):this._engine.afterFlush(()=>{vf(t,jt),wh(t,Gt)})}return}const Be=_l(this._engine.playersByElement,t,[]);Be.forEach(yt=>{yt.namespaceId==this.id&&yt.triggerName==e&&yt.queued&&yt.destroy()});let Xe=c.matchTransition(w.value,L.value,t,L.params),ot=!1;if(!Xe){if(!o)return;Xe=c.fallbackTransition,ot=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:Xe,fromState:w,toState:L,player:f,isFallbackTransition:ot}),ot||(tc(t,RO),f.onStart(()=>{Tg(t,RO)})),f.onDone(()=>{let yt=this.players.indexOf(f);yt>=0&&this.players.splice(yt,1);const jt=this._engine.playersByElement.get(t);if(jt){let Gt=jt.indexOf(f);Gt>=0&&jt.splice(Gt,1)}}),this.players.push(f),Be.push(f),f}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(o=>o.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(n=>n.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const n=this._engine.driver.query(t,Xb,!0);n.forEach(o=>{if(o[ec])return;const c=this._engine.fetchNamespacesByElement(o);c.size?c.forEach(f=>f.triggerLeaveAnimation(o,e,!1,!0)):this.clearElementCache(o)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(o=>this.clearElementCache(o)))}triggerLeaveAnimation(t,e,n,o){const c=this._engine.statesByElement.get(t),f=new Map;if(c){const y=[];if(c.forEach((w,L)=>{if(f.set(L,w.value),this._triggers.has(L)){const le=this.trigger(t,L,vv,o);le&&y.push(le)}}),y.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,f),n&&zd(y).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),n=this._engine.statesByElement.get(t);if(e&&n){const o=new Set;e.forEach(c=>{const f=c.name;if(o.has(f))return;o.add(f);const w=this._triggers.get(f).fallbackTransition,L=n.get(f)||WM,le=new $M(vv),ye=new XM(this.id,f,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:f,transition:w,fromState:L,toState:le,player:ye,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let o=!1;if(n.totalAnimations){const c=n.players.length?n.playersByQueriedElement.get(t):[];if(c&&c.length)o=!0;else{let f=t;for(;f=f.parentNode;)if(n.statesByElement.get(f)){o=!0;break}}}if(this.prepareLeaveAnimationListeners(t),o)n.markElementAsRemoved(this.id,t,!1,e);else{const c=t[ec];(!c||c===LO)&&(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}}insertNode(t,e){tc(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const o=n.player;if(o.destroyed)return;const c=n.element,f=this._elementListeners.get(c);f&&f.forEach(y=>{if(y.name==n.triggerName){const w=DM(c,n.triggerName,n.fromState.value,n.toState.value);w._data=t,SM(n.player,y.phase,w,y.callback)}}),o.markedForDestroy?this._engine.afterFlush(()=>{o.destroy()}):e.push(n)}),this._queue=[],e.sort((n,o)=>{const c=n.transition.ast.depCount,f=o.transition.ast.depCount;return 0==c||0==f?c-f:this._engine.driver.containsElement(n.element,o.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(n=>n.element===t)||e,e}}class H${constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(o,c)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(n=>{n.queued&&t.push(n)})}),t}createNamespace(t,e){const n=new U$(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList,o=this.namespacesByHostElement;if(n.length-1>=0){let f=!1,y=this.driver.getParentElement(e);for(;y;){const w=o.get(y);if(w){const L=n.indexOf(w);n.splice(L+1,0,t),f=!0;break}y=this.driver.getParentElement(y)}f||n.unshift(t)}else n.push(t);return o.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let o=this._namespaceLookup[t];o&&o.register(e,n)&&this.totalAnimations++}destroy(t,e){if(!t)return;const n=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[t];const o=this._namespaceList.indexOf(n);o>=0&&this._namespaceList.splice(o,1)}),this.afterFlushAnimationsDone(()=>n.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n)for(let o of n.values())if(o.namespaceId){const c=this._fetchNamespace(o.namespaceId);c&&e.add(c)}return e}trigger(t,e,n,o){if(ow(e)){const c=this._fetchNamespace(t);if(c)return c.trigger(e,n,o),!0}return!1}insertNode(t,e,n,o){if(!ow(e))return;const c=e[ec];if(c&&c.setForRemoval){c.setForRemoval=!1,c.setForMove=!0;const f=this.collectedLeaveElements.indexOf(e);f>=0&&this.collectedLeaveElements.splice(f,1)}if(t){const f=this._fetchNamespace(t);f&&f.insertNode(e,n)}o&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),tc(t,GM)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Tg(t,GM))}removeNode(t,e,n,o){if(ow(e)){const c=t?this._fetchNamespace(t):null;if(c?c.removeNode(e,o):this.markElementAsRemoved(t,e,!1,o),n){const f=this.namespacesByHostElement.get(e);f&&f.id!==t&&f.removeNode(e,o)}}else this._onRemovalComplete(e,o)}markElementAsRemoved(t,e,n,o,c){this.collectedLeaveElements.push(e),e[ec]={namespaceId:t,setForRemoval:o,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:c}}listen(t,e,n,o,c){return ow(e)?this._fetchNamespace(t).listen(e,n,o,c):()=>{}}_buildInstruction(t,e,n,o,c){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,o,t.fromState.options,t.toState.options,e,c)}destroyInnerAnimations(t){let e=this.driver.query(t,Xb,!0);e.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,OM,!0),e.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return zd(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[ec];if(e&&e.setForRemoval){if(t[ec]=LO,e.namespaceId){this.destroyInnerAnimations(t);const n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(GM)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,o)=>this._balanceNamespaceList(n,o)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)tc(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let o=0;o<n.length;o++)n[o]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],e.length?zd(e).onDone(()=>{n.forEach(o=>o())}):n.forEach(o=>o())}}reportError(t){throw function H6(i){return new ti(3402,!1)}()}_flushAnimations(t,e){const n=new iw,o=[],c=new Map,f=[],y=new Map,w=new Map,L=new Map,le=new Set;this.disabledNodes.forEach(Bi=>{le.add(Bi);const _i=this.driver.query(Bi,".ng-animate-queued",!0);for(let ln=0;ln<_i.length;ln++)le.add(_i[ln])});const ye=this.bodyNode,Be=Array.from(this.statesByElement.keys()),Xe=BO(Be,this.collectedEnterElements),ot=new Map;let yt=0;Xe.forEach((Bi,_i)=>{const ln=PM+yt++;ot.set(_i,ln),Bi.forEach(Wn=>tc(Wn,ln))});const jt=[],Gt=new Set,fi=new Set;for(let Bi=0;Bi<this.collectedLeaveElements.length;Bi++){const _i=this.collectedLeaveElements[Bi],ln=_i[ec];ln&&ln.setForRemoval&&(jt.push(_i),Gt.add(_i),ln.hasAnimation?this.driver.query(_i,".ng-star-inserted",!0).forEach(Wn=>Gt.add(Wn)):fi.add(_i))}const qt=new Map,Mi=BO(Be,Array.from(Gt));Mi.forEach((Bi,_i)=>{const ln=$b+yt++;qt.set(_i,ln),Bi.forEach(Wn=>tc(Wn,ln))}),t.push(()=>{Xe.forEach((Bi,_i)=>{const ln=ot.get(_i);Bi.forEach(Wn=>Tg(Wn,ln))}),Mi.forEach((Bi,_i)=>{const ln=qt.get(_i);Bi.forEach(Wn=>Tg(Wn,ln))}),jt.forEach(Bi=>{this.processLeaveNode(Bi)})});const Xi=[],$n=[];for(let Bi=this._namespaceList.length-1;Bi>=0;Bi--)this._namespaceList[Bi].drainQueuedTransitions(e).forEach(ln=>{const Wn=ln.player,is=ln.element;if(Xi.push(Wn),this.collectedEnterElements.length){const ks=is[ec];if(ks&&ks.setForMove){if(ks.previousTriggersValues&&ks.previousTriggersValues.has(ln.triggerName)){const yu=ks.previousTriggersValues.get(ln.triggerName),aa=this.statesByElement.get(ln.element);if(aa&&aa.has(ln.triggerName)){const Fc=aa.get(ln.triggerName);Fc.value=yu,aa.set(ln.triggerName,Fc)}}return void Wn.destroy()}}const Vr=!ye||!this.driver.containsElement(ye,is),ao=qt.get(is),xl=ot.get(is),jr=this._buildInstruction(ln,n,xl,ao,Vr);if(jr.errors&&jr.errors.length)return void $n.push(jr);if(Vr)return Wn.onStart(()=>vf(is,jr.fromStyles)),Wn.onDestroy(()=>wh(is,jr.toStyles)),void o.push(Wn);if(ln.isFallbackTransition)return Wn.onStart(()=>vf(is,jr.fromStyles)),Wn.onDestroy(()=>wh(is,jr.toStyles)),void o.push(Wn);const lw=[];jr.timelines.forEach(ks=>{ks.stretchStartingKeyframe=!0,this.disabledNodes.has(ks.element)||lw.push(ks)}),jr.timelines=lw,n.append(is,jr.timelines),f.push({instruction:jr,player:Wn,element:is}),jr.queriedElements.forEach(ks=>_l(y,ks,[]).push(Wn)),jr.preStyleProps.forEach((ks,yu)=>{if(ks.size){let aa=w.get(yu);aa||w.set(yu,aa=new Set),ks.forEach((Fc,Dg)=>aa.add(Dg))}}),jr.postStyleProps.forEach((ks,yu)=>{let aa=L.get(yu);aa||L.set(yu,aa=new Set),ks.forEach((Fc,Dg)=>aa.add(Dg))})});if($n.length){const Bi=[];$n.forEach(_i=>{Bi.push(function G6(i,t){return new ti(3505,!1)}())}),Xi.forEach(_i=>_i.destroy()),this.reportError(Bi)}const zr=new Map,$s=new Map;f.forEach(Bi=>{const _i=Bi.element;n.has(_i)&&($s.set(_i,_i),this._beforeAnimationBuild(Bi.player.namespaceId,Bi.instruction,zr))}),o.forEach(Bi=>{const _i=Bi.element;this._getPreviousPlayers(_i,!1,Bi.namespaceId,Bi.triggerName,null).forEach(Wn=>{_l(zr,_i,[]).push(Wn),Wn.destroy()})});const ka=jt.filter(Bi=>VO(Bi,w,L)),Ia=new Map;NO(Ia,this.driver,fi,L,_u).forEach(Bi=>{VO(Bi,w,L)&&ka.push(Bi)});const Lc=new Map;Xe.forEach((Bi,_i)=>{NO(Lc,this.driver,new Set(Bi),w,"!")}),ka.forEach(Bi=>{const _i=Ia.get(Bi),ln=Lc.get(Bi);Ia.set(Bi,new Map([...Array.from(_i?.entries()??[]),...Array.from(ln?.entries()??[])]))});const vl=[],Hd=[],Ch={};f.forEach(Bi=>{const{element:_i,player:ln,instruction:Wn}=Bi;if(n.has(_i)){if(le.has(_i))return ln.onDestroy(()=>wh(_i,Wn.toStyles)),ln.disabled=!0,ln.overrideTotalTime(Wn.totalTime),void o.push(ln);let is=Ch;if($s.size>1){let ao=_i;const xl=[];for(;ao=ao.parentNode;){const jr=$s.get(ao);if(jr){is=jr;break}xl.push(ao)}xl.forEach(jr=>$s.set(jr,is))}const Vr=this._buildAnimation(ln.namespaceId,Wn,zr,c,Lc,Ia);if(ln.setRealPlayer(Vr),is===Ch)vl.push(ln);else{const ao=this.playersByElement.get(is);ao&&ao.length&&(ln.parentPlayer=zd(ao)),o.push(ln)}}else vf(_i,Wn.fromStyles),ln.onDestroy(()=>wh(_i,Wn.toStyles)),Hd.push(ln),le.has(_i)&&o.push(ln)}),Hd.forEach(Bi=>{const _i=c.get(Bi.element);if(_i&&_i.length){const ln=zd(_i);Bi.setRealPlayer(ln)}}),o.forEach(Bi=>{Bi.parentPlayer?Bi.syncPlayerEvents(Bi.parentPlayer):Bi.destroy()});for(let Bi=0;Bi<jt.length;Bi++){const _i=jt[Bi],ln=_i[ec];if(Tg(_i,$b),ln&&ln.hasAnimation)continue;let Wn=[];if(y.size){let Vr=y.get(_i);Vr&&Vr.length&&Wn.push(...Vr);let ao=this.driver.query(_i,OM,!0);for(let xl=0;xl<ao.length;xl++){let jr=y.get(ao[xl]);jr&&jr.length&&Wn.push(...jr)}}const is=Wn.filter(Vr=>!Vr.destroyed);is.length?X$(this,_i,is):this.processLeaveNode(_i)}return jt.length=0,vl.forEach(Bi=>{this.players.push(Bi),Bi.onDone(()=>{Bi.destroy();const _i=this.players.indexOf(Bi);this.players.splice(_i,1)}),Bi.play()}),vl}elementContainsData(t,e){let n=!1;const o=e[ec];return o&&o.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(t).elementContainsData(e)||n}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,o,c){let f=[];if(e){const y=this.playersByQueriedElement.get(t);y&&(f=y)}else{const y=this.playersByElement.get(t);if(y){const w=!c||c==vv;y.forEach(L=>{L.queued||!w&&L.triggerName!=o||f.push(L)})}}return(n||o)&&(f=f.filter(y=>!(n&&n!=y.namespaceId||o&&o!=y.triggerName))),f}_beforeAnimationBuild(t,e,n){const c=e.element,f=e.isRemovalTransition?void 0:t,y=e.isRemovalTransition?void 0:e.triggerName;for(const w of e.timelines){const L=w.element,le=L!==c,ye=_l(n,L,[]);this._getPreviousPlayers(L,le,f,y,e.toState).forEach(Xe=>{const ot=Xe.getRealPlayer();ot.beforeDestroy&&ot.beforeDestroy(),Xe.destroy(),ye.push(Xe)})}vf(c,e.fromStyles)}_buildAnimation(t,e,n,o,c,f){const y=e.triggerName,w=e.element,L=[],le=new Set,ye=new Set,Be=e.timelines.map(ot=>{const yt=ot.element;le.add(yt);const jt=yt[ec];if(jt&&jt.removedBeforeQueried)return new cv(ot.duration,ot.delay);const Gt=yt!==w,fi=function q$(i){const t=[];return zO(i,t),t}((n.get(yt)||V$).map(zr=>zr.getRealPlayer())).filter(zr=>!!zr.element&&zr.element===yt),qt=c.get(yt),Mi=f.get(yt),Xi=uO(0,this._normalizer,0,ot.keyframes,qt,Mi),$n=this._buildPlayer(ot,Xi,fi);if(ot.subTimeline&&o&&ye.add(yt),Gt){const zr=new XM(t,y,yt);zr.setRealPlayer($n),L.push(zr)}return $n});L.forEach(ot=>{_l(this.playersByQueriedElement,ot.element,[]).push(ot),ot.onDone(()=>function G$(i,t,e){let n=i.get(t);if(n){if(n.length){const o=n.indexOf(e);n.splice(o,1)}0==n.length&&i.delete(t)}return n}(this.playersByQueriedElement,ot.element,ot))}),le.forEach(ot=>tc(ot,xO));const Xe=zd(Be);return Xe.onDestroy(()=>{le.forEach(ot=>Tg(ot,xO)),wh(w,e.toStyles)}),ye.forEach(ot=>{_l(o,ot,[]).push(Xe)}),Xe}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new cv(t.duration,t.delay)}}class XM{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new cv,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,n)=>{e.forEach(o=>SM(t,n,void 0,o))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){_l(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function ow(i){return i&&1===i.nodeType}function FO(i,t){const e=i.style.display;return i.style.display=t??"none",e}function NO(i,t,e,n,o){const c=[];e.forEach(w=>c.push(FO(w)));const f=[];n.forEach((w,L)=>{const le=new Map;w.forEach(ye=>{const Be=t.computeStyle(L,ye,o);le.set(ye,Be),(!Be||0==Be.length)&&(L[ec]=j$,f.push(L))}),i.set(L,le)});let y=0;return e.forEach(w=>FO(w,c[y++])),f}function BO(i,t){const e=new Map;if(i.forEach(y=>e.set(y,[])),0==t.length)return e;const o=new Set(t),c=new Map;function f(y){if(!y)return 1;let w=c.get(y);if(w)return w;const L=y.parentNode;return w=e.has(L)?L:o.has(L)?1:f(L),c.set(y,w),w}return t.forEach(y=>{const w=f(y);1!==w&&e.get(w).push(y)}),e}function tc(i,t){i.classList?.add(t)}function Tg(i,t){i.classList?.remove(t)}function X$(i,t,e){zd(e).onDone(()=>i.processLeaveNode(t))}function zO(i,t){for(let e=0;e<i.length;e++){const n=i[e];n instanceof k2?zO(n.players,t):t.push(n)}}function VO(i,t,e){const n=e.get(i);if(!n)return!1;let o=t.get(i);return o?n.forEach(c=>o.add(c)):t.set(i,n),e.delete(i),!0}class sw{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(o,c)=>{},this._transitionEngine=new H$(t,e,n),this._timelineEngine=new L$(t,e,n),this._transitionEngine.onRemovalComplete=(o,c)=>this.onRemovalComplete(o,c)}registerTrigger(t,e,n,o,c){const f=t+"-"+o;let y=this._triggerCache[f];if(!y){const w=[],le=NM(this._driver,c,w,[]);if(w.length)throw function O6(i,t){return new ti(3404,!1)}();y=function I$(i,t,e){return new P$(i,t,e)}(o,le,this._normalizer),this._triggerCache[f]=y}this._transitionEngine.registerTrigger(e,o,y)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,o){this._transitionEngine.insertNode(t,e,n,o)}onRemove(t,e,n,o){this._transitionEngine.removeNode(t,e,o||!1,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,o){if("@"==n.charAt(0)){const[c,f]=dO(n);this._timelineEngine.command(c,e,f,o)}else this._transitionEngine.trigger(t,e,n,o)}listen(t,e,n,o,c){if("@"==n.charAt(0)){const[f,y]=dO(n);return this._timelineEngine.listen(f,e,y,c)}return this._transitionEngine.listen(t,e,n,o,c)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let K$=(()=>{class i{constructor(e,n,o){this._element=e,this._startStyles=n,this._endStyles=o,this._state=0;let c=i.initialStylesByElement.get(e);c||i.initialStylesByElement.set(e,c=new Map),this._initialStyles=c}start(){this._state<1&&(this._startStyles&&wh(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(wh(this._element,this._initialStyles),this._endStyles&&(wh(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(vf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(vf(this._element,this._endStyles),this._endStyles=null),wh(this._element,this._initialStyles),this._state=3)}}return i.initialStylesByElement=new WeakMap,i})();function qM(i){let t=null;return i.forEach((e,n)=>{(function Q$(i){return"display"===i||"position"===i})(n)&&(t=t||new Map,t.set(n,e))}),t}class jO{constructor(t,e,n,o){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=o,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(n=>{e.push(Object.fromEntries(n))}),e}_triggerWebAnimation(t,e,n){return t.animate(this._convertKeyframesToObject(e),n)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,o)=>{"offset"!==o&&t.set(o,this._finished?n:SO(this.element,o))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}class J${validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return gO(t,e)}getParentElement(t){return kM(t)}query(t,e,n){return _O(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}animate(t,e,n,o,c,f=[]){const w={duration:n,delay:o,fill:0==o?"both":"forwards"};c&&(w.easing=c);const L=new Map,le=f.filter(Xe=>Xe instanceof jO);(function n$(i,t){return 0===i||0===t})(n,o)&&le.forEach(Xe=>{Xe.currentSnapshot.forEach((ot,yt)=>L.set(yt,ot))});let ye=function J6(i){return i.length?i[0]instanceof Map?i:i.map(t=>bO(t)):[]}(e).map(Xe=>jd(Xe));ye=function r$(i,t,e){if(e.size&&t.length){let n=t[0],o=[];if(e.forEach((c,f)=>{n.has(f)||o.push(f),n.set(f,c)}),o.length)for(let c=1;c<t.length;c++){let f=t[c];o.forEach(y=>f.set(y,SO(i,y)))}}return t}(t,ye,L);const Be=function Z$(i,t){let e=null,n=null;return Array.isArray(t)&&t.length?(e=qM(t[0]),t.length>1&&(n=qM(t[t.length-1]))):t instanceof Map&&(e=qM(t)),e||n?new K$(i,e,n):null}(t,ye);return new jO(t,ye,w,Be)}}let e8=(()=>{class i extends S2{constructor(e,n){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(n.body,{id:"0",encapsulation:Os.None,styles:[],data:{animation:[]}})}build(e){const n=this._nextAnimationId.toString();this._nextAnimationId++;const o=Array.isArray(e)?D2(e):e;return UO(this._renderer,null,n,"register",[o]),new t8(n,this._renderer)}}return i.\u0275fac=function(e){return new(e||i)(Pt(ad),Pt(Pn))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})();class t8 extends class L4{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new i8(this._id,t,e||{},this._renderer)}}class i8{constructor(t,e,n,o){this.id=t,this.element=e,this._renderer=o,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return UO(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function UO(i,t,e,n,o){return i.setProperty(t,`@@${e}:${n}`,o)}const HO="@.disabled";let n8=(()=>{class i{constructor(e,n,o){this.delegate=e,this.engine=n,this._zone=o,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(c,f)=>{const y=f?.parentNode(c);y&&f.removeChild(y,c)}}createRenderer(e,n){const c=this.delegate.createRenderer(e,n);if(!(e&&n&&n.data&&n.data.animation)){let le=this._rendererCache.get(c);return le||(le=new GO("",c,this.engine),this._rendererCache.set(c,le)),le}const f=n.id,y=n.id+"-"+this._currentId;this._currentId++,this.engine.register(y,e);const w=le=>{Array.isArray(le)?le.forEach(w):this.engine.registerTrigger(f,y,e,le.name,le)};return n.data.animation.forEach(w),new r8(this,y,c,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,n,o){e>=0&&e<this._microtaskId?this._zone.run(()=>n(o)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(c=>{const[f,y]=c;f(y)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,o]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return i.\u0275fac=function(e){return new(e||i)(Pt(ad),Pt(sw),Pt(En))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})();class GO{constructor(t,e,n){this.namespaceId=t,this.delegate=e,this.engine=n,this.destroyNode=this.delegate.destroyNode?o=>e.destroyNode(o):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n,o=!0){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,o)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate,n)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,o){this.delegate.setAttribute(t,e,n,o)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,o){this.delegate.setStyle(t,e,n,o)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){"@"==e.charAt(0)&&e==HO?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class r8 extends GO{constructor(t,e,n,o){super(e,n,o),this.factory=t,this.namespaceId=e}setProperty(t,e,n){"@"==e.charAt(0)?"."==e.charAt(1)&&e==HO?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.slice(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if("@"==e.charAt(0)){const o=function o8(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(t);let c=e.slice(1),f="";return"@"!=c.charAt(0)&&([c,f]=function s8(i){const t=i.indexOf(".");return[i.substring(0,t),i.slice(t+1)]}(c)),this.engine.listen(this.namespaceId,o,c,f,y=>{this.factory.scheduleListenerCallback(y._data||-1,n,y)})}return this.delegate.listen(t,e,n)}}const $O=[{provide:S2,useClass:e8},{provide:UM,useFactory:function l8(){return new T$}},{provide:sw,useClass:(()=>{class i extends sw{constructor(e,n,o,c){super(e.body,n,o)}ngOnDestroy(){this.flush()}}return i.\u0275fac=function(e){return new(e||i)(Pt(Pn),Pt(IM),Pt(UM),Pt(og))},i.\u0275prov=hi({token:i,factory:i.\u0275fac}),i})()},{provide:ad,useFactory:function c8(i,t,e){return new n8(i,t,e)},deps:[Ax,sw,En]}],YM=[{provide:IM,useFactory:()=>new J$},{provide:mh,useValue:"BrowserAnimations"},...$O],WO=[{provide:IM,useClass:yO},{provide:mh,useValue:"NoopAnimations"},...$O];let h8=(()=>{class i{static withConfig(e){return{ngModule:i,providers:e.disableAnimations?WO:YM}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({providers:YM,imports:[HA]}),i})(),p8=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({imports:[_2,Lr,_2,Lr]}),i})();const _8={provide:new ui("mat-autocomplete-scroll-strategy"),deps:[qa],useFactory:function g8(i){return()=>i.scrollStrategies.reposition()}};let b8=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i}),i.\u0275inj=fn({providers:[_8],imports:[Cg,Ob,Lr,rf,nv,Ob,Lr]}),i})(),w8=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=mn({type:i,bootstrap:[h6]}),i.\u0275inj=fn({providers:[WE,dv],imports:[HA,c6,O5,u6,h8,cG,gG,R2,AG,uH,HG,p8,i6,q4,b8,F2,_5,y5]}),i})();(function uN(){UD=!1})(),Nz().bootstrapModule(w8).catch(i=>console.error(i))},407:(_s,la,Is)=>{var Mn,lo,Ge;Ge=function(Ge){function u(re,me,Te,Ce){re.hasOwnProperty(me)||(re[me]=Ce.apply(null,Te),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:me,module:re[me]}})))}u(Ge=Ge?Ge._modules:{},"Extensions/Pane.js",[Ge["Core/Chart/Chart.js"],Ge["Series/CenteredUtilities.js"],Ge["Core/Globals.js"],Ge["Core/Pointer.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce,Se){function be(N,R,I){return Math.sqrt(Math.pow(N-I[0],2)+Math.pow(R-I[1],2))<=I[2]/2}var ce=Se.addEvent,ne=Se.extend,K=Se.merge,Y=Se.pick,j=Se.splat;return re.prototype.collectionsWithUpdate.push("pane"),Se=function(){function N(R,I){this.options=this.chart=this.center=this.background=void 0,this.coll="pane",this.defaultOptions={center:["50%","50%"],size:"85%",innerSize:"0%",startAngle:0},this.defaultBackgroundOptions={shape:"circle",borderWidth:1,borderColor:"#cccccc",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#ffffff"],[1,"#e6e6e6"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"},this.init(R,I)}return N.prototype.init=function(R,I){this.chart=I,this.background=[],I.pane.push(this),this.setOptions(R)},N.prototype.setOptions=function(R){this.options=K(this.defaultOptions,this.chart.angular?{background:{}}:void 0,R)},N.prototype.render=function(){var R=this.options,I=this.options.background,B=this.chart.renderer;if(this.group||(this.group=B.g("pane-group").attr({zIndex:R.zIndex||0}).add()),this.updateCenter(),I)for(I=j(I),R=Math.max(I.length,this.background.length||0),B=0;B<R;B++)I[B]&&this.axis?this.renderBackground(K(this.defaultBackgroundOptions,I[B]),B):this.background[B]&&(this.background[B]=this.background[B].destroy(),this.background.splice(B,1))},N.prototype.renderBackground=function(R,I){var B="animate",P={class:"highcharts-pane "+(R.className||"")};this.chart.styledMode||ne(P,{fill:R.backgroundColor,stroke:R.borderColor,"stroke-width":R.borderWidth}),this.background[I]||(this.background[I]=this.chart.renderer.path().add(this.group),B="attr"),this.background[I][B]({d:this.axis.getPlotBandPath(R.from,R.to,R)}).attr(P)},N.prototype.updateCenter=function(R){this.center=(R||this.axis||{}).center=me.getCenter.call(this)},N.prototype.update=function(R,I){K(!0,this.options,R),this.setOptions(this.options),this.render(),this.chart.axes.forEach(function(B){B.pane===this&&(B.pane=null,B.update({},I))},this)},N}(),re.prototype.getHoverPane=function(N){var I,R=this;return N&&R.pane.forEach(function(B){var P=N.chartX-R.plotLeft,H=N.chartY-R.plotTop;be(R.inverted?H:P,R.inverted?P:H,B.center)&&(I=B)}),I},ce(re,"afterIsInsidePlot",function(N){this.polar&&(N.isInsidePlot=this.pane.some(function(R){return be(N.x,N.y,R.center)}))}),ce(Ce,"beforeGetHoverData",function(N){var R=this.chart;R.polar?(R.hoverPane=R.getHoverPane(N),N.filter=function(I){return I.visible&&!(!N.shared&&I.directTouch)&&Y(I.options.enableMouseTracking,!0)&&(!R.hoverPane||I.xAxis.pane===R.hoverPane)}):R.hoverPane=void 0}),ce(Ce,"afterGetHoverData",function(N){var R=this.chart;N.hoverPoint&&N.hoverPoint.plotX&&N.hoverPoint.plotY&&R.hoverPane&&!be(N.hoverPoint.plotX,N.hoverPoint.plotY,R.hoverPane.center)&&(N.hoverPoint=void 0)}),Te.Pane=Se,Te.Pane}),u(Ge,"Series/AreaRange/AreaRangePoint.js",[Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"]],function(re,me){var ce,Te=this&&this.__extends||(ce=function(ne,K){return(ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Y,j){Y.__proto__=j}||function(Y,j){for(var N in j)j.hasOwnProperty(N)&&(Y[N]=j[N])})(ne,K)},function(ne,K){function Y(){this.constructor=ne}ce(ne,K),ne.prototype=null===K?Object.create(K):(Y.prototype=K.prototype,new Y)}),Ce=(re=re.seriesTypes.area.prototype).pointClass.prototype,Se=me.defined,be=me.isNumber;return function(ce){function ne(){var K=null!==ce&&ce.apply(this,arguments)||this;return K.high=void 0,K.low=void 0,K.options=void 0,K.plotHigh=void 0,K.plotLow=void 0,K.plotHighX=void 0,K.plotLowX=void 0,K.plotX=void 0,K.series=void 0,K}return Te(ne,ce),ne.prototype.setState=function(){var K=this.state,Y=this.series,j=Y.chart.polar;Se(this.plotHigh)||(this.plotHigh=Y.yAxis.toPixels(this.high,!0)),Se(this.plotLow)||(this.plotLow=this.plotY=Y.yAxis.toPixels(this.low,!0)),Y.stateMarkerGraphic&&(Y.lowerStateMarkerGraphic=Y.stateMarkerGraphic,Y.stateMarkerGraphic=Y.upperStateMarkerGraphic),this.graphic=this.upperGraphic,this.plotY=this.plotHigh,j&&(this.plotX=this.plotHighX),Ce.setState.apply(this,arguments),this.state=K,this.plotY=this.plotLow,this.graphic=this.lowerGraphic,j&&(this.plotX=this.plotLowX),Y.stateMarkerGraphic&&(Y.upperStateMarkerGraphic=Y.stateMarkerGraphic,Y.stateMarkerGraphic=Y.lowerStateMarkerGraphic,Y.lowerStateMarkerGraphic=void 0),Ce.setState.apply(this,arguments)},ne.prototype.haloPath=function(){var K=this.series.chart.polar,Y=[];return this.plotY=this.plotLow,K&&(this.plotX=this.plotLowX),this.isInside&&(Y=Ce.haloPath.apply(this,arguments)),this.plotY=this.plotHigh,K&&(this.plotX=this.plotHighX),this.isTopInside&&(Y=Y.concat(Ce.haloPath.apply(this,arguments))),Y},ne.prototype.isValid=function(){return be(this.low)&&be(this.high)},ne}(re.pointClass)}),u(Ge,"Series/AreaRange/AreaRangeSeries.js",[Ge["Series/AreaRange/AreaRangePoint.js"],Ge["Core/Globals.js"],Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce){var P,Se=this&&this.__extends||(P=function(H,W){return(P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ie,te){ie.__proto__=te}||function(ie,te){for(var ee in te)te.hasOwnProperty(ee)&&(ie[ee]=te[ee])})(H,W)},function(H,W){function ie(){this.constructor=H}P(H,W),H.prototype=null===W?Object.create(W):(ie.prototype=W.prototype,new ie)});me=me.noop;var be=Te.seriesTypes,ce=be.area,ne=be.area.prototype,K=be.column.prototype,Y=Ce.defined,j=Ce.extend,N=Ce.isArray,R=Ce.pick,I=Ce.merge,B={lineWidth:1,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">\u25cf</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},trackByArea:!0,dataLabels:{align:void 0,verticalAlign:void 0,xLow:0,xHigh:0,yLow:0,yHigh:0}};return Ce=function(P){function H(){var W=null!==P&&P.apply(this,arguments)||this;return W.data=void 0,W.options=void 0,W.points=void 0,W.lowerStateMarkerGraphic=void 0,W.xAxis=void 0,W}return Se(H,P),H.prototype.toYData=function(W){return[W.low,W.high]},H.prototype.highToXY=function(W){var ie=this.chart,te=this.xAxis.postTranslate(W.rectPlotX||0,this.yAxis.len-W.plotHigh);W.plotHighX=te.x-ie.plotLeft,W.plotHigh=te.y-ie.plotTop,W.plotLowX=W.plotX},H.prototype.translate=function(){var W=this;ne.translate.apply(W),W.points.forEach(function(ie,te){var ee=ie.high,J=ie.plotY;ie.isNull?ie.plotY=null:(te=W.chart.hasParallelCoordinates?W.chart.yAxis[te]:W.yAxis,ie.plotLow=J,ie.plotHigh=te.translate(W.dataModify?W.dataModify.modifyValue(ee):ee,0,1,0,1),W.dataModify&&(ie.yBottom=ie.plotHigh))}),this.chart.polar&&this.points.forEach(function(ie){W.highToXY(ie),ie.tooltipPos=[(ie.plotHighX+ie.plotLowX)/2,(ie.plotHigh+ie.plotLow)/2]})},H.prototype.getGraphPath=function(W){var A,ie=[],te=[],ee=ne.getGraphPath,J=this.options,q=this.chart.polar,D=q&&!1!==J.connectEnds,z=J.connectNulls,U=J.step;for(A=(W=W||this.points).length;A--;){var T=W[A],S=q?{plotX:T.rectPlotX,plotY:T.yBottom,doCurve:!1}:{plotX:T.plotX,plotY:T.plotY,doCurve:!1};T.isNull||D||z||W[A+1]&&!W[A+1].isNull||te.push(S);var O={polarPlotY:T.polarPlotY,rectPlotX:T.rectPlotX,yBottom:T.yBottom,plotX:R(T.plotHighX,T.plotX),plotY:T.plotHigh,isNull:T.isNull};te.push(O),ie.push(O),T.isNull||D||z||W[A-1]&&!W[A-1].isNull||te.push(S)}return W=ee.call(this,W),U&&(!0===U&&(U="left"),J.step={left:"right",center:"center",right:"left"}[U]),ie=ee.call(this,ie),te=ee.call(this,te),J.step=U,J=[].concat(W,ie),!this.chart.polar&&te[0]&&"M"===te[0][0]&&(te[0]=["L",te[0][1],te[0][2]]),this.graphPath=J,this.areaPath=W.concat(te),J.isArea=!0,J.xMap=W.xMap,this.areaPath.xMap=W.xMap,J},H.prototype.drawDataLabels=function(){var q,D,W=this.points,ie=W.length,te=[],ee=this.options.dataLabels,J=this.chart.inverted;if(ee){if(N(ee))var z=ee[0]||{enabled:!1},A=ee[1]||{enabled:!1};else(z=j({},ee)).x=ee.xHigh,z.y=ee.yHigh,(A=j({},ee)).x=ee.xLow,A.y=ee.yLow;if(z.enabled||this._hasPointLabels){for(q=ie;q--;)if(D=W[q]){var U=z.inside?D.plotHigh<D.plotLow:D.plotHigh>D.plotLow;D.y=D.high,D._plotY=D.plotY,D.plotY=D.plotHigh,te[q]=D.dataLabel,D.dataLabel=D.dataLabelUpper,D.below=U,J?z.align||(z.align=U?"right":"left"):z.verticalAlign||(z.verticalAlign=U?"top":"bottom")}for(this.options.dataLabels=z,ne.drawDataLabels&&ne.drawDataLabels.apply(this,arguments),q=ie;q--;)(D=W[q])&&(D.dataLabelUpper=D.dataLabel,D.dataLabel=te[q],delete D.dataLabels,D.y=D.low,D.plotY=D._plotY)}if(A.enabled||this._hasPointLabels){for(q=ie;q--;)(D=W[q])&&(D.below=!(U=A.inside?D.plotHigh<D.plotLow:D.plotHigh>D.plotLow),J?A.align||(A.align=U?"left":"right"):A.verticalAlign||(A.verticalAlign=U?"bottom":"top"));this.options.dataLabels=A,ne.drawDataLabels&&ne.drawDataLabels.apply(this,arguments)}if(z.enabled)for(q=ie;q--;)(D=W[q])&&(D.dataLabels=[D.dataLabelUpper,D.dataLabel].filter(function(T){return!!T}));this.options.dataLabels=ee}},H.prototype.alignDataLabel=function(){K.alignDataLabel.apply(this,arguments)},H.prototype.drawPoints=function(){var ie,W=this.points.length;for(ne.drawPoints.apply(this,arguments),ie=0;ie<W;){var te=this.points[ie];te.origProps={plotY:te.plotY,plotX:te.plotX,isInside:te.isInside,negative:te.negative,zone:te.zone,y:te.y},te.lowerGraphic=te.graphic,te.graphic=te.upperGraphic,te.plotY=te.plotHigh,Y(te.plotHighX)&&(te.plotX=te.plotHighX),te.y=R(te.high,te.origProps.y),te.negative=te.y<(this.options.threshold||0),this.zones.length&&(te.zone=te.getZone()),this.chart.polar||(te.isInside=te.isTopInside=typeof te.plotY<"u"&&0<=te.plotY&&te.plotY<=this.yAxis.len&&0<=te.plotX&&te.plotX<=this.xAxis.len),ie++}for(ne.drawPoints.apply(this,arguments),ie=0;ie<W;)(te=this.points[ie]).upperGraphic=te.graphic,te.graphic=te.lowerGraphic,te.origProps&&(j(te,te.origProps),delete te.origProps),ie++},H.defaultOptions=I(ce.defaultOptions,B),H}(ce),j(Ce.prototype,{deferTranslatePolar:!0,pointArrayMap:["low","high"],pointClass:re,pointValKey:"low",setStackedPoints:me}),Te.registerSeriesType("arearange",Ce),Ce}),u(Ge,"Series/AreaSplineRange/AreaSplineRangeSeries.js",[Ge["Series/AreaRange/AreaRangeSeries.js"],Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"]],function(re,me,Te){var ne,Ce=this&&this.__extends||(ne=function(K,Y){return(ne=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(j,N){j.__proto__=N}||function(j,N){for(var R in N)N.hasOwnProperty(R)&&(j[R]=N[R])})(K,Y)},function(K,Y){function j(){this.constructor=K}ne(K,Y),K.prototype=null===Y?Object.create(Y):(j.prototype=Y.prototype,new j)}),Se=me.seriesTypes.spline.prototype,be=Te.merge;Te=Te.extend;var ce=function(ne){function K(){var Y=null!==ne&&ne.apply(this,arguments)||this;return Y.options=void 0,Y.data=void 0,Y.points=void 0,Y}return Ce(K,ne),K.defaultOptions=be(re.defaultOptions),K}(re);return Te(ce.prototype,{getPointSpline:Se.getPointSpline}),me.registerSeriesType("areasplinerange",ce),ce}),u(Ge,"Series/BoxPlot/BoxPlotSeries.js",[Ge["Series/Column/ColumnSeries.js"],Ge["Core/Globals.js"],Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce){var K,Se=this&&this.__extends||(K=function(Y,j){return(K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,R){N.__proto__=R}||function(N,R){for(var I in R)R.hasOwnProperty(I)&&(N[I]=R[I])})(Y,j)},function(Y,j){function N(){this.constructor=Y}K(Y,j),Y.prototype=null===j?Object.create(j):(N.prototype=j.prototype,new N)});me=me.noop;var be=Ce.extend,ce=Ce.merge,ne=Ce.pick;return Ce=function(K){function Y(){var j=null!==K&&K.apply(this,arguments)||this;return j.data=void 0,j.options=void 0,j.points=void 0,j}return Se(Y,K),Y.prototype.pointAttribs=function(){return{}},Y.prototype.translate=function(){var j=this.yAxis,N=this.pointArrayMap;K.prototype.translate.apply(this),this.points.forEach(function(R){N.forEach(function(I){null!==R[I]&&(R[I+"Plot"]=j.translate(R[I],0,1,0,1))}),R.plotHigh=R.highPlot})},Y.prototype.drawPoints=function(){var B,P,H,W,ie,te,J,q,D,z,U,j=this,N=j.options,R=j.chart,I=R.renderer,ee=0,A=!1!==j.doQuartiles,T=j.options.whiskerLength;j.points.forEach(function(S){var O=S.graphic,M=O?"animate":"attr",Z=S.shapeArgs,ae={},ue={},ge={},V={},$=S.color||j.color;typeof S.plotY<"u"&&(J=Math.round(Z.width),q=Math.floor(Z.x),D=q+J,z=Math.round(J/2),B=Math.floor(A?S.q1Plot:S.lowPlot),P=Math.floor(A?S.q3Plot:S.lowPlot),H=Math.floor(S.highPlot),W=Math.floor(S.lowPlot),O||(S.graphic=O=I.g("point").add(j.group),S.stem=I.path().addClass("highcharts-boxplot-stem").add(O),T&&(S.whiskers=I.path().addClass("highcharts-boxplot-whisker").add(O)),A&&(S.box=I.path(void 0).addClass("highcharts-boxplot-box").add(O)),S.medianShape=I.path(void 0).addClass("highcharts-boxplot-median").add(O)),R.styledMode||(ue.stroke=S.stemColor||N.stemColor||$,ue["stroke-width"]=ne(S.stemWidth,N.stemWidth,N.lineWidth),ue.dashstyle=S.stemDashStyle||N.stemDashStyle||N.dashStyle,S.stem.attr(ue),T&&(ge.stroke=S.whiskerColor||N.whiskerColor||$,ge["stroke-width"]=ne(S.whiskerWidth,N.whiskerWidth,N.lineWidth),ge.dashstyle=S.whiskerDashStyle||N.whiskerDashStyle||N.dashStyle,S.whiskers.attr(ge)),A&&(ae.fill=S.fillColor||N.fillColor||$,ae.stroke=N.lineColor||$,ae["stroke-width"]=N.lineWidth||0,ae.dashstyle=S.boxDashStyle||N.boxDashStyle||N.dashStyle,S.box.attr(ae)),V.stroke=S.medianColor||N.medianColor||$,V["stroke-width"]=ne(S.medianWidth,N.medianWidth,N.lineWidth),V.dashstyle=S.medianDashStyle||N.medianDashStyle||N.dashStyle,S.medianShape.attr(V)),te=S.stem.strokeWidth()%2/2,S.stem[M]({d:O=[["M",ee=q+z+te,P],["L",ee,H],["M",ee,B],["L",ee,W]]}),A&&(te=S.box.strokeWidth()%2/2,B=Math.floor(B)+te,P=Math.floor(P)+te,S.box[M]({d:O=[["M",q+=te,P],["L",q,B],["L",D+=te,B],["L",D,P],["L",q,P],["Z"]]})),T&&(te=S.whiskers.strokeWidth()%2/2,H+=te,W+=te,U=/%$/.test(T)?z*parseFloat(T)/100:T/2,S.whiskers[M]({d:O=[["M",ee-U,H],["L",ee+U,H],["M",ee-U,W],["L",ee+U,W]]})),ie=Math.round(S.medianPlot),te=S.medianShape.strokeWidth()%2/2,S.medianShape[M]({d:O=[["M",q,ie+=te],["L",D,ie]]}))})},Y.prototype.toYData=function(j){return[j.low,j.q1,j.median,j.q3,j.high]},Y.defaultOptions=ce(re.defaultOptions,{threshold:null,tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> <b> {series.name}</b><br/>Maximum: {point.high}<br/>Upper quartile: {point.q3}<br/>Median: {point.median}<br/>Lower quartile: {point.q1}<br/>Minimum: {point.low}<br/>'},whiskerLength:"50%",fillColor:"#ffffff",lineWidth:1,medianWidth:2,whiskerWidth:2}),Y}(re),be(Ce.prototype,{pointArrayMap:["low","q1","median","q3","high"],pointValKey:"high",drawDataLabels:me,setStackedPoints:me}),Te.registerSeriesType("boxplot",Ce),Ce}),u(Ge,"Series/Bubble/BubbleLegendDefaults.js",[],function(){return{borderColor:void 0,borderWidth:2,className:void 0,color:void 0,connectorClassName:void 0,connectorColor:void 0,connectorDistance:60,connectorWidth:1,enabled:!1,labels:{className:void 0,allowOverlap:!1,format:"",formatter:void 0,align:"right",style:{fontSize:"10px",color:"#000000"},x:0,y:0},maxSize:60,minSize:10,legendIndex:0,ranges:{value:void 0,borderColor:void 0,color:void 0,connectorColor:void 0},sizeBy:"area",sizeByAbsoluteValue:!1,zIndex:1,zThreshold:0}}),u(Ge,"Series/Bubble/BubbleLegendItem.js",[Ge["Core/Color/Color.js"],Ge["Core/FormatUtilities.js"],Ge["Core/Globals.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce){var Se=re.parse,be=Te.noop,ce=Ce.arrayMax,ne=Ce.arrayMin,K=Ce.isNumber,Y=Ce.merge,j=Ce.pick,N=Ce.stableSort;return function(){function R(I,B){this.options=this.symbols=this.visible=this.selected=this.ranges=this.movementX=this.maxLabel=this.legendSymbol=this.legendItemWidth=this.legendItemHeight=this.legendItem=this.legendGroup=this.legend=this.fontMetrics=this.chart=void 0,this.setState=be,this.init(I,B)}return R.prototype.init=function(I,B){this.options=I,this.visible=!0,this.chart=B.chart,this.legend=B},R.prototype.addToLegend=function(I){I.splice(this.options.legendIndex,0,this)},R.prototype.drawLegendSymbol=function(I){var B=this.chart,P=this.options,H=j(I.options.itemDistance,20),W=P.ranges,ie=P.connectorDistance;this.fontMetrics=B.renderer.fontMetrics(P.labels.style.fontSize),W&&W.length&&K(W[0].value)?(N(W,function(te,ee){return ee.value-te.value}),this.ranges=W,this.setOptions(),this.render(),I=this.getMaxLabelSize(),B=2*(W=this.ranges[0].radius),ie=0<(ie=ie-W+I.width)?ie:0,this.maxLabel=I,this.movementX="left"===P.labels.align?ie:0,this.legendItemWidth=B+ie+H,this.legendItemHeight=B+this.fontMetrics.h/2):I.options.bubbleLegend.autoRanges=!0},R.prototype.setOptions=function(){var I=this.ranges,B=this.options,P=this.chart.series[B.seriesIndex],H=this.legend.baseline,W={zIndex:B.zIndex,"stroke-width":B.borderWidth},ie={zIndex:B.zIndex,"stroke-width":B.connectorWidth},te={align:this.legend.options.rtl||"left"===B.labels.align?"right":"left",zIndex:B.zIndex},ee=P.options.marker.fillOpacity,J=this.chart.styledMode;I.forEach(function(q,D){J||(W.stroke=j(q.borderColor,B.borderColor,P.color),W.fill=j(q.color,B.color,1!==ee?Se(P.color).setOpacity(ee).get("rgba"):P.color),ie.stroke=j(q.connectorColor,B.connectorColor,P.color)),I[D].radius=this.getRangeRadius(q.value),I[D]=Y(I[D],{center:I[0].radius-I[D].radius+H}),J||Y(!0,I[D],{bubbleAttribs:Y(W),connectorAttribs:Y(ie),labelAttribs:te})},this)},R.prototype.getRangeRadius=function(I){var B=this.options;return this.chart.series[this.options.seriesIndex].getRadius.call(this,B.ranges[B.ranges.length-1].value,B.ranges[0].value,B.minSize,B.maxSize,I)},R.prototype.render=function(){var I=this.chart.renderer,B=this.options.zThreshold;this.symbols||(this.symbols={connectors:[],bubbleItems:[],labels:[]}),this.legendSymbol=I.g("bubble-legend"),this.legendItem=I.g("bubble-legend-item"),this.legendSymbol.translateX=0,this.legendSymbol.translateY=0,this.ranges.forEach(function(P){P.value>=B&&this.renderRange(P)},this),this.legendSymbol.add(this.legendItem),this.legendItem.add(this.legendGroup),this.hideOverlappingLabels()},R.prototype.renderRange=function(I){var B=this.options,P=B.labels,H=this.chart,W=H.series[B.seriesIndex],ie=H.renderer,te=this.symbols;H=te.labels;var ee=I.center,J=Math.abs(I.radius),q=B.connectorDistance||0,D=P.align,z=B.connectorWidth,A=this.ranges[0].radius||0,U=ee-J-B.borderWidth/2+z/2,T=this.fontMetrics;T=T.f/2-(T.h-T.f)/2;var S=ie.styledMode;q=this.legend.options.rtl||"left"===D?-q:q,"center"===D&&(q=0,B.connectorDistance=0,I.labelAttribs.align="center"),D=U+B.labels.y;var O=A+q+B.labels.x;te.bubbleItems.push(ie.circle(A,ee+((U%1?1:.5)-(z%2?0:.5)),J).attr(S?{}:I.bubbleAttribs).addClass((S?"highcharts-color-"+W.colorIndex+" ":"")+"highcharts-bubble-legend-symbol "+(B.className||"")).add(this.legendSymbol)),te.connectors.push(ie.path(ie.crispLine([["M",A,U],["L",A+q,U]],B.connectorWidth)).attr(S?{}:I.connectorAttribs).addClass((S?"highcharts-color-"+this.options.seriesIndex+" ":"")+"highcharts-bubble-legend-connectors "+(B.connectorClassName||"")).add(this.legendSymbol)),I=ie.text(this.formatLabel(I),O,D+T).attr(S?{}:I.labelAttribs).css(S?{}:P.style).addClass("highcharts-bubble-legend-labels "+(B.labels.className||"")).add(this.legendSymbol),H.push(I),I.placed=!0,I.alignAttr={x:O,y:D+T}},R.prototype.getMaxLabelSize=function(){var I,B;return this.symbols.labels.forEach(function(P){B=P.getBBox(!0),I=I?B.width>I.width?B:I:B}),I||{}},R.prototype.formatLabel=function(I){var B=this.options,P=B.labels.formatter,H=this.chart.numberFormatter;return(B=B.labels.format)?me.format(B,I):P?P.call(I):H(I.value,1)},R.prototype.hideOverlappingLabels=function(){var B=this.symbols;!this.options.labels.allowOverlap&&B&&(this.chart.hideOverlappingLabels(B.labels),B.labels.forEach(function(P,H){P.newOpacity?P.newOpacity!==P.oldOpacity&&B.connectors[H].show():B.connectors[H].hide()}))},R.prototype.getRanges=function(){var P,I=this.legend.bubbleLegend,B=I.options.ranges,H=Number.MAX_VALUE,W=-Number.MAX_VALUE;I.chart.series.forEach(function(te){te.isBubble&&!te.ignoreSeries&&(P=te.zData.filter(K)).length&&(H=j(te.options.zMin,Math.min(H,Math.max(ne(P),!1===te.options.displayNegative?te.options.zThreshold:-Number.MAX_VALUE))),W=j(te.options.zMax,Math.max(W,ce(P))))});var ie=H===W?[{value:W}]:[{value:H},{value:(H+W)/2},{value:W,autoRanges:!0}];return B.length&&B[0].radius&&ie.reverse(),ie.forEach(function(te,ee){B&&B[ee]&&(ie[ee]=Y(B[ee],te))}),ie},R.prototype.predictBubbleSizes=function(){var I=this.chart,B=this.fontMetrics,P=I.legend.options,H=P.floating,W=(P="horizontal"===P.layout)?I.legend.lastLineHeight:0,ie=I.plotSizeX,te=I.plotSizeY,ee=I.series[this.options.seriesIndex],J=ee.getPxExtremes();I=Math.ceil(J.minPxSize),J=Math.ceil(J.maxPxSize);var q=Math.min(te,ie);return ee=ee.options.maxSize,H||!/%$/.test(ee)?B=J:(ee=parseFloat(ee),B=(q+W-B.h/2)*ee/100/(ee/100+1),(P&&te-B>=ie||!P&&ie-B>=te)&&(B=J)),[I,Math.ceil(B)]},R.prototype.updateRanges=function(I,B){var P=this.legend.options.bubbleLegend;P.minSize=I,P.maxSize=B,P.ranges=this.getRanges()},R.prototype.correctSizes=function(){var I=this.legend,B=this.chart.series[this.options.seriesIndex].getPxExtremes();1<Math.abs(Math.ceil(B.maxPxSize)-this.options.maxSize)&&(this.updateRanges(this.options.minSize,B.maxPxSize),I.render())},R}()}),u(Ge,"Series/Bubble/BubbleLegendComposition.js",[Ge["Series/Bubble/BubbleLegendDefaults.js"],Ge["Series/Bubble/BubbleLegendItem.js"],Ge["Core/DefaultOptions.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce){function Se(P,H,W){var ie=this.legend,te=0<=be(this);if(ie&&ie.options.enabled&&ie.bubbleLegend&&ie.options.bubbleLegend.autoRanges&&te){var ee=ie.bubbleLegend.options;te=ie.bubbleLegend.predictBubbleSizes(),ie.bubbleLegend.updateRanges(te[0],te[1]),ee.placed||(ie.group.placed=!1,ie.allItems.forEach(function(J){J.legendGroup.translateY=null})),ie.render(),this.getMargins(),this.axes.forEach(function(J){J.visible&&J.render(),ee.placed||(J.setScale(),J.updateNames(),R(J.ticks,function(q){q.isNew=!0,q.isNewLabel=!0}))}),ee.placed=!0,this.getMargins(),P.call(this,H,W),ie.bubbleLegend.correctSizes(),Y(ie,ce(ie))}else P.call(this,H,W),ie&&ie.options.enabled&&ie.bubbleLegend&&(ie.render(),Y(ie,ce(ie)))}function be(P){P=P.series;for(var H=0;H<P.length;){if(P[H]&&P[H].isBubble&&P[H].visible&&P[H].zData.length)return H;H++}return-1}function ce(P){var ie,H=[],W=(P=P.allItems).length,te=0;for(ie=0;ie<W;ie++)if(P[ie].legendItemHeight&&(P[ie].itemHeight=P[ie].legendItemHeight),P[ie]===P[W-1]||P[ie+1]&&P[ie]._legendItemPos[1]!==P[ie+1]._legendItemPos[1]){H.push({height:0});for(var ee=H[H.length-1];te<=ie;te++)P[te].itemHeight>ee.height&&(ee.height=P[te].itemHeight);ee.step=ie}return H}function ne(P){var H=this.bubbleLegend,W=this.options,ie=W.bubbleLegend,te=be(this.chart);H&&H.ranges&&H.ranges.length&&(ie.ranges.length&&(ie.autoRanges=!!ie.ranges[0].autoRanges),this.destroyItem(H)),0<=te&&W.enabled&&ie.enabled&&(ie.seriesIndex=te,this.bubbleLegend=new me(ie,this),this.bubbleLegend.addToLegend(P.allItems))}function K(){var P=this.chart,H=this.visible,W=this.chart.legend;W&&W.bubbleLegend&&(this.visible=!H,this.ignoreSeries=H,P=0<=be(P),W.bubbleLegend.visible!==P&&(W.update({bubbleLegend:{enabled:P}}),W.bubbleLegend.visible=P),this.visible=H)}function Y(P,H){var ie,te,ee,W=P.options.rtl,J=0;P.allItems.forEach(function(q,D){ie=q.legendGroup.translateX,te=q._legendItemPos[1],((ee=q.movementX)||W&&q.ranges)&&q.legendGroup.attr({translateX:ee=W?ie-q.options.maxSize/2:ie+ee}),D>H[J].step&&J++,q.legendGroup.attr({translateY:Math.round(te+H[J].height/2)}),q._legendItemPos[1]=te+H[J].height/2})}var j=Te.setOptions,N=Ce.addEvent,R=Ce.objectEach,I=Ce.wrap,B=[];return{compose:function(P,H,W){-1===B.indexOf(P)&&(B.push(P),j({legend:{bubbleLegend:re}}),I(P.prototype,"drawChartBox",Se)),-1===B.indexOf(H)&&(B.push(H),N(H,"afterGetAllItems",ne)),-1===B.indexOf(W)&&(B.push(W),N(W,"legendItemClick",K))}}}),u(Ge,"Series/Bubble/BubblePoint.js",[Ge["Core/Series/Point.js"],Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"]],function(re,me,Te){var Se,Ce=this&&this.__extends||(Se=function(be,ce){return(Se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ne,K){ne.__proto__=K}||function(ne,K){for(var Y in K)K.hasOwnProperty(Y)&&(ne[Y]=K[Y])})(be,ce)},function(be,ce){function ne(){this.constructor=be}Se(be,ce),be.prototype=null===ce?Object.create(ce):(ne.prototype=ce.prototype,new ne)});return Te=Te.extend,me=function(Se){function be(){var ce=null!==Se&&Se.apply(this,arguments)||this;return ce.options=void 0,ce.series=void 0,ce}return Ce(be,Se),be.prototype.haloPath=function(ce){return re.prototype.haloPath.call(this,0===ce?0:(this.marker&&this.marker.radius||0)+ce)},be}(me.seriesTypes.scatter.prototype.pointClass),Te(me.prototype,{ttBelow:!1}),me}),u(Ge,"Series/Bubble/BubbleSeries.js",[Ge["Series/Bubble/BubbleLegendComposition.js"],Ge["Series/Bubble/BubblePoint.js"],Ge["Core/Color/Color.js"],Ge["Core/Globals.js"],Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce,Se,be){function ce(){var M,ee=this,J=this.len,q=this.chart,D=this.isXAxis,z=D?"xData":"yData",A=this.min,U=this.max-A,T=0,S=J,O=J/U;this.series.forEach(function(Z){if(Z.bubblePadding&&(Z.visible||!q.options.chart.ignoreHiddenSeries)){M=ee.allowZoomOutside=!0;var ae=Z[z];if(D&&((Z.onPoint||Z).getRadii(0,0,Z),Z.onPoint&&(Z.radii=Z.onPoint.radii)),0<U)for(var ue=ae.length;ue--;)if(H(ae[ue])&&ee.dataMin<=ae[ue]&&ae[ue]<=ee.max){var ge=Z.radii&&Z.radii[ue]||0;T=Math.min((ae[ue]-A)*O-ge,T),S=Math.max((ae[ue]-A)*O+ge,S)}}}),M&&0<U&&!this.logarithmic&&(S-=J,O*=(J+Math.max(0,T)-Math.min(S,J))/J,[["min","userMin",T],["max","userMax",S]].forEach(function(Z){typeof ie(ee.options[Z[0]],ee[Z[1]])>"u"&&(ee[Z[0]]+=Z[2]/O)}))}var ee,ne=this&&this.__extends||(ee=function(J,q){return(ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(D,z){D.__proto__=z}||function(D,z){for(var A in z)z.hasOwnProperty(A)&&(D[A]=z[A])})(J,q)},function(J,q){function D(){this.constructor=J}ee(J,q),J.prototype=null===q?Object.create(q):(D.prototype=q.prototype,new D)}),K=Te.parse;Te=Ce.noop;var Y=Se.series,j=Se.seriesTypes;Ce=j.column.prototype;var N=j.scatter;j=be.addEvent;var R=be.arrayMax,I=be.arrayMin,B=be.clamp,P=be.extend,H=be.isNumber,W=be.merge,ie=be.pick,te=[];return be=function(ee){function J(){var q=null!==ee&&ee.apply(this,arguments)||this;return q.data=void 0,q.maxPxSize=void 0,q.minPxSize=void 0,q.options=void 0,q.points=void 0,q.radii=void 0,q.yData=void 0,q.zData=void 0,q}return ne(J,ee),J.compose=function(q,D,z,A){re.compose(D,z,A),-1===te.indexOf(q)&&(te.push(q),q.prototype.beforePadding=ce)},J.prototype.animate=function(q){!q&&this.points.length<this.options.animationLimit&&this.points.forEach(function(D){var z=D.graphic;z&&z.width&&(this.hasRendered||z.attr({x:D.plotX,y:D.plotY,width:1,height:1}),z.animate(this.markerAttribs(D),this.options.animation))},this)},J.prototype.getRadii=function(){var q=this,D=this.zData,z=this.yData,A=[],U=this.chart.bubbleZExtremes,T=this.getPxExtremes(),S=T.minPxSize,O=T.maxPxSize;if(!U){var ae,M=Number.MAX_VALUE,Z=-Number.MAX_VALUE;this.chart.series.forEach(function(V){V.bubblePadding&&(V.visible||!q.chart.options.chart.ignoreHiddenSeries)&&(V=(V.onPoint||V).getZExtremes())&&(M=Math.min(M||V.zMin,V.zMin),Z=Math.max(Z||V.zMax,V.zMax),ae=!0)}),ae?this.chart.bubbleZExtremes=U={zMin:M,zMax:Z}:U={zMin:0,zMax:0}}var ue=0;for(T=D.length;ue<T;ue++)A.push(this.getRadius(U.zMin,U.zMax,S,O,D[ue],z&&z[ue]));this.radii=A},J.prototype.getRadius=function(q,D,z,A,U,T){var S=this.options,O="width"!==S.sizeBy,M=S.zThreshold,Z=D-q,ae=.5;if(null===T||null===U)return null;if(H(U)){if(S.sizeByAbsoluteValue&&(U=Math.abs(U-M),Z=Math.max(D-M,Math.abs(q-M)),q=0),U<q)return z/2-1;0<Z&&(ae=(U-q)/Z)}return O&&0<=ae&&(ae=Math.sqrt(ae)),Math.ceil(z+ae*(A-z))/2},J.prototype.hasData=function(){return!!this.processedXData.length},J.prototype.pointAttribs=function(q,D){var z=this.options.marker.fillOpacity;return q=Y.prototype.pointAttribs.call(this,q,D),1!==z&&(q.fill=K(q.fill).setOpacity(z).get("rgba")),q},J.prototype.translate=function(){ee.prototype.translate.call(this),this.getRadii(),this.translateBubble()},J.prototype.translateBubble=function(){for(var q=this.data,D=this.radii,z=this.getPxExtremes().minPxSize,A=q.length;A--;){var U=q[A],T=D?D[A]:0;H(T)&&T>=z/2?(U.marker=P(U.marker,{radius:T,width:2*T,height:2*T}),U.dlBox={x:U.plotX-T,y:U.plotY-T,width:2*T,height:2*T}):(U.shapeArgs=U.dlBox=void 0,U.plotY=0,U.marker={width:0,height:0})}},J.prototype.getPxExtremes=function(){var q=Math.min(this.chart.plotWidth,this.chart.plotHeight),D=function(A){if("string"==typeof A){var U=/%$/.test(A);A=parseInt(A,10)}return U?q*A/100:A},z=D(ie(this.options.minSize,8));return{minPxSize:z,maxPxSize:D=Math.max(D(ie(this.options.maxSize,"20%")),z)}},J.prototype.getZExtremes=function(){var q=this.options,D=(this.zData||[]).filter(H);if(D.length){var z=ie(q.zMin,B(I(D),!1===q.displayNegative?q.zThreshold||0:-Number.MAX_VALUE,Number.MAX_VALUE));if(q=ie(q.zMax,R(D)),H(z)&&H(q))return{zMin:z,zMax:q}}},J.defaultOptions=W(N.defaultOptions,{dataLabels:{formatter:function(){var q=this.series.chart.numberFormatter,D=this.point.z;return H(D)?q(D,-1):""},inside:!0,verticalAlign:"middle"},animationLimit:250,marker:{lineColor:null,lineWidth:1,fillOpacity:.5,radius:null,states:{hover:{radiusPlus:0}},symbol:"circle"},minSize:8,maxSize:"20%",softThreshold:!1,states:{hover:{halo:{size:5}}},tooltip:{pointFormat:"({point.x}, {point.y}), Size: {point.z}"},turboThreshold:0,zThreshold:0,zoneAxis:"z"}),J}(N),P(be.prototype,{alignDataLabel:Ce.alignDataLabel,applyZones:Te,bubblePadding:!0,buildKDTree:Te,directTouch:!0,isBubble:!0,pointArrayMap:["y","z"],pointClass:me,parallelArrays:["x","y","z"],trackerGroups:["group","dataLabelsGroup"],specialGroup:"group",zoneAxis:"z"}),j(be,"updatedData",function(ee){delete ee.target.chart.bubbleZExtremes}),j(be,"remove",function(ee){delete ee.target.chart.bubbleZExtremes}),Se.registerSeriesType("bubble",be),be}),u(Ge,"Series/ColumnRange/ColumnRangePoint.js",[Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"]],function(re,me){var ce,Te=this&&this.__extends||(ce=function(ne,K){return(ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Y,j){Y.__proto__=j}||function(Y,j){for(var N in j)j.hasOwnProperty(N)&&(Y[N]=j[N])})(ne,K)},function(ne,K){function Y(){this.constructor=ne}ce(ne,K),ne.prototype=null===K?Object.create(K):(Y.prototype=K.prototype,new Y)}),Ce=re.seriesTypes;re=Ce.column.prototype.pointClass.prototype;var Se=me.extend,be=me.isNumber;return me=function(ce){function ne(){var K=null!==ce&&ce.apply(this,arguments)||this;return K.options=void 0,K.series=void 0,K}return Te(ne,ce),ne.prototype.isValid=function(){return be(this.low)},ne}(Ce.arearange.prototype.pointClass),Se(me.prototype,{setState:re.setState}),me}),u(Ge,"Series/ColumnRange/ColumnRangeSeries.js",[Ge["Series/ColumnRange/ColumnRangePoint.js"],Ge["Core/Globals.js"],Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce){var I,Se=this&&this.__extends||(I=function(B,P){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,W){H.__proto__=W}||function(H,W){for(var ie in W)W.hasOwnProperty(ie)&&(H[ie]=W[ie])})(B,P)},function(B,P){function H(){this.constructor=B}I(B,P),B.prototype=null===P?Object.create(P):(H.prototype=P.prototype,new H)});me=me.noop;var be=Te.seriesTypes,ce=be.arearange,ne=be.column,K=be.column.prototype,Y=Ce.clamp;be=Ce.extend;var j=Ce.merge,N=Ce.pick,R={pointRange:null,marker:null,states:{hover:{halo:!1}}};return Ce=function(I){function B(){return null!==I&&I.apply(this,arguments)||this}return Se(B,I),B.prototype.setOptions=function(){return j(!0,arguments[0],{stacking:void 0}),ce.prototype.setOptions.apply(this,arguments)},B.prototype.translate=function(){var q,D,z,A,U,P=this,H=this.yAxis,W=this.xAxis,ie=W.startAngleRad,te=this.chart,ee=this.xAxis.isRadial,J=Math.max(te.chartWidth,te.chartHeight)+999;K.translate.apply(this),this.points.forEach(function(T){var S=T.shapeArgs||{},O=P.options.minPointLength;T.plotHigh=A=Y(H.translate(T.high,0,1,0,1),-J,J),T.plotLow=Y(T.plotY,-J,J),U=A,q=N(T.rectPlotY,T.plotY)-A,Math.abs(q)<O?(q+=D=O-q,U-=D/2):0>q&&(U-=q*=-1),ee&&P.polar?(z=T.barX+ie,T.shapeType="arc",T.shapeArgs=P.polar.arc(U+q,U,z,z+T.pointWidth)):(S.height=q,S.y=U,O=void 0===(O=S.x)?0:O,S=void 0===(S=S.width)?0:S,T.tooltipPos=te.inverted?[H.len+H.pos-te.plotLeft-U-q/2,W.len+W.pos-te.plotTop-O-S/2,q]:[W.left-te.plotLeft+O+S/2,H.pos-te.plotTop+U+q/2,q])})},B.prototype.pointAttribs=function(){return K.pointAttribs.apply(this,arguments)},B.prototype.translate3dPoints=function(){return K.translate3dPoints.apply(this,arguments)},B.prototype.translate3dShapes=function(){return K.translate3dShapes.apply(this,arguments)},B.defaultOptions=j(ne.defaultOptions,ce.defaultOptions,R),B}(ce),be(Ce.prototype,{directTouch:!0,pointClass:re,trackerGroups:["group","dataLabelsGroup"],adjustForMissingColumns:K.adjustForMissingColumns,animate:K.animate,crispCol:K.crispCol,drawGraph:me,drawPoints:K.drawPoints,getSymbol:me,drawTracker:K.drawTracker,getColumnMetrics:K.getColumnMetrics}),Te.registerSeriesType("columnrange",Ce),Ce}),u(Ge,"Series/ColumnPyramid/ColumnPyramidSeries.js",[Ge["Series/Column/ColumnSeries.js"],Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"]],function(re,me,Te){var K,Ce=this&&this.__extends||(K=function(Y,j){return(K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,R){N.__proto__=R}||function(N,R){for(var I in R)R.hasOwnProperty(I)&&(N[I]=R[I])})(Y,j)},function(Y,j){function N(){this.constructor=Y}K(Y,j),Y.prototype=null===j?Object.create(j):(N.prototype=j.prototype,new N)}),Se=re.prototype,be=Te.clamp,ce=Te.merge,ne=Te.pick;return Te=function(K){function Y(){var j=null!==K&&K.apply(this,arguments)||this;return j.data=void 0,j.options=void 0,j.points=void 0,j}return Ce(Y,K),Y.prototype.translate=function(){var j=this,N=j.chart,R=j.options,I=j.dense=2>j.closestPointRange*j.xAxis.transA;I=j.borderWidth=ne(R.borderWidth,I?0:1);var B=j.yAxis,P=R.threshold,H=j.translatedThreshold=B.getThreshold(P),W=ne(R.minPointLength,5),ie=j.getColumnMetrics(),te=ie.width,ee=j.barW=Math.max(te,1+2*I),J=j.pointXOffset=ie.offset;N.inverted&&(H-=.5),R.pointPadding&&(ee=Math.ceil(ee)),Se.translate.apply(j),j.points.forEach(function(q){var D=ne(q.yBottom,H),z=999+Math.abs(D),A=be(q.plotY,-z,B.len+z);z=q.plotX+J;var S,U=ee/2,T=Math.min(A,D);D=Math.max(A,D)-T,q.barX=z,q.pointWidth=te,q.tooltipPos=N.inverted?[B.len+B.pos-N.plotLeft-A,j.xAxis.len-z-U,D]:[z+U,A+B.pos-N.plotTop,D],A=P+(q.total||q.y),"percent"===R.stacking&&(A=P+(0>q.y)?-100:100),A=B.toPixels(A,!0);var O=(S=N.plotHeight-A-(N.plotHeight-H))?U*(T-A)/S:0,M=S?U*(T+D-A)/S:0;S=z-O+U,O=z+O+U;var Z=z+M+U;M=z-M+U;var ae=T-W,ue=T+D;0>q.y&&(ae=T,ue=T+D+W),N.inverted&&(M=U*(A-((Z=B.width-T)-D))/(S=A-(B.width-H)),O=(S=z+U+(O=U*(A-Z)/S))-2*O,Z=z-M+U,M=z+M+U,ae=T,ue=T+D-W,0>q.y&&(ue=T+D+W)),q.shapeType="path",q.shapeArgs={x:S,y:ae,width:O-S,height:D,d:[["M",S,ae],["L",O,ae],["L",Z,ue],["L",M,ue],["Z"]]}})},Y.defaultOptions=ce(re.defaultOptions,{}),Y}(re),me.registerSeriesType("columnpyramid",Te),Te}),u(Ge,"Series/ErrorBar/ErrorBarSeries.js",[Ge["Series/BoxPlot/BoxPlotSeries.js"],Ge["Series/Column/ColumnSeries.js"],Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce){var K,Se=this&&this.__extends||(K=function(Y,j){return(K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,R){N.__proto__=R}||function(N,R){for(var I in R)R.hasOwnProperty(I)&&(N[I]=R[I])})(Y,j)},function(Y,j){function N(){this.constructor=Y}K(Y,j),Y.prototype=null===j?Object.create(j):(N.prototype=j.prototype,new N)}),be=Te.seriesTypes.arearange,ce=Ce.merge;Ce=Ce.extend;var ne=function(K){function Y(){var j=null!==K&&K.apply(this,arguments)||this;return j.data=void 0,j.options=void 0,j.points=void 0,j}return Se(Y,K),Y.prototype.getColumnMetrics=function(){return this.linkedParent&&this.linkedParent.columnMetrics||me.prototype.getColumnMetrics.call(this)},Y.prototype.drawDataLabels=function(){var j=this.pointValKey;be&&(be.prototype.drawDataLabels.call(this),this.data.forEach(function(N){N.y=N[j]}))},Y.prototype.toYData=function(j){return[j.low,j.high]},Y.defaultOptions=ce(re.defaultOptions,{color:"#000000",grouping:!1,linkedTo:":previous",tooltip:{pointFormat:'<span style="color:{point.color}">\u25cf</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},whiskerWidth:null}),Y}(re);return Ce(ne.prototype,{pointArrayMap:["low","high"],pointValKey:"high",doQuartiles:!1}),Te.registerSeriesType("errorbar",ne),ne}),u(Ge,"Series/Gauge/GaugePoint.js",[Ge["Core/Series/SeriesRegistry.js"]],function(re){var Te,me=this&&this.__extends||(Te=function(Ce,Se){return(Te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(be,ce){be.__proto__=ce}||function(be,ce){for(var ne in ce)ce.hasOwnProperty(ne)&&(be[ne]=ce[ne])})(Ce,Se)},function(Ce,Se){function be(){this.constructor=Ce}Te(Ce,Se),Ce.prototype=null===Se?Object.create(Se):(be.prototype=Se.prototype,new be)});return function(Te){function Ce(){var Se=null!==Te&&Te.apply(this,arguments)||this;return Se.options=void 0,Se.series=void 0,Se.shapeArgs=void 0,Se}return me(Ce,Te),Ce.prototype.setState=function(Se){this.state=Se},Ce}(re.series.prototype.pointClass)}),u(Ge,"Series/Gauge/GaugeSeries.js",[Ge["Series/Gauge/GaugePoint.js"],Ge["Core/Globals.js"],Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce){var I,Se=this&&this.__extends||(I=function(B,P){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,W){H.__proto__=W}||function(H,W){for(var ie in W)W.hasOwnProperty(ie)&&(H[ie]=W[ie])})(B,P)},function(B,P){function H(){this.constructor=B}I(B,P),B.prototype=null===P?Object.create(P):(H.prototype=P.prototype,new H)});me=me.noop;var be=Te.series,ce=Te.seriesTypes.column,ne=Ce.clamp,K=Ce.isNumber,Y=Ce.extend,j=Ce.merge,N=Ce.pick,R=Ce.pInt;return Ce=function(I){function B(){var P=null!==I&&I.apply(this,arguments)||this;return P.data=void 0,P.points=void 0,P.options=void 0,P.yAxis=void 0,P}return Se(B,I),B.prototype.translate=function(){var P=this.yAxis,H=this.options,W=P.center;this.generatePoints(),this.points.forEach(function(ie){var te=j(H.dial,ie.dial),ee=R(te.radius)*W[2]/200,J=R(te.baseLength)*ee/100,q=R(te.rearLength)*ee/100,D=te.baseWidth,z=te.topWidth,A=H.overshoot,U=P.startAngleRad+P.translate(ie.y,void 0,void 0,void 0,!0);(K(A)||!1===H.wrap)&&(A=K(A)?A/180*Math.PI:0,U=ne(U,P.startAngleRad-A,P.endAngleRad+A)),U=180*U/Math.PI,ie.shapeType="path",ie.shapeArgs={d:te.path||[["M",-q,-D/2],["L",J,-D/2],["L",ee,-z/2],["L",ee,z/2],["L",J,D/2],["L",-q,D/2],["Z"]],translateX:W[0],translateY:W[1],rotation:U},ie.plotX=W[0],ie.plotY=W[1]})},B.prototype.drawPoints=function(){var P=this,H=P.chart,W=P.yAxis.center,ie=P.pivot,te=P.options,ee=te.pivot,J=H.renderer;P.points.forEach(function(q){var D=q.graphic,z=q.shapeArgs,A=z.d,U=j(te.dial,q.dial);D?(D.animate(z),z.d=A):q.graphic=J[q.shapeType](z).attr({rotation:z.rotation,zIndex:1}).addClass("highcharts-dial").add(P.group),H.styledMode||q.graphic[D?"animate":"attr"]({stroke:U.borderColor,"stroke-width":U.borderWidth,fill:U.backgroundColor})}),ie?ie.animate({translateX:W[0],translateY:W[1]}):ee&&(P.pivot=J.circle(0,0,ee.radius).attr({zIndex:2}).addClass("highcharts-pivot").translate(W[0],W[1]).add(P.group),H.styledMode||P.pivot.attr({fill:ee.backgroundColor,stroke:ee.borderColor,"stroke-width":ee.borderWidth}))},B.prototype.animate=function(P){var H=this;P||H.points.forEach(function(W){var ie=W.graphic;ie&&(ie.attr({rotation:180*H.yAxis.startAngleRad/Math.PI}),ie.animate({rotation:W.shapeArgs.rotation},H.options.animation))})},B.prototype.render=function(){this.group=this.plotGroup("group","series",this.visible?"inherit":"hidden",this.options.zIndex,this.chart.seriesGroup),be.prototype.render.call(this),this.group.clip(this.chart.clipRect)},B.prototype.setData=function(P,H){be.prototype.setData.call(this,P,!1),this.processData(),this.generatePoints(),N(H,!0)&&this.chart.redraw()},B.prototype.hasData=function(){return!!this.points.length},B.defaultOptions=j(be.defaultOptions,{dataLabels:{borderColor:"#cccccc",borderRadius:3,borderWidth:1,crop:!1,defer:!1,enabled:!0,verticalAlign:"top",y:15,zIndex:2},dial:{backgroundColor:"#000000",baseLength:"70%",baseWidth:3,borderColor:"#cccccc",borderWidth:0,radius:"80%",rearLength:"10%",topWidth:1},pivot:{radius:5,borderWidth:0,borderColor:"#cccccc",backgroundColor:"#000000"},tooltip:{headerFormat:""},showInLegend:!1}),B}(be),Y(Ce.prototype,{angular:!0,directTouch:!0,drawGraph:me,drawTracker:ce.prototype.drawTracker,fixedBox:!0,forceDL:!0,noSharedTooltip:!0,pointClass:re,trackerGroups:["group","dataLabelsGroup"]}),Te.registerSeriesType("gauge",Ce),Ce}),u(Ge,"Series/DragNodesComposition.js",[Ge["Core/Utilities.js"]],function(re){function me(){var be,ce,ne,Se=this;Se.container&&(be=Te(Se.container,"mousedown",function(K){var Y=Se.hoverPoint;Y&&Y.series&&Y.series.hasDraggableNodes&&Y.series.options.draggable&&(Y.series.onMouseDown(Y,K),ce=Te(Se.container,"mousemove",function(j){return Y&&Y.series&&Y.series.onMouseMove(Y,j)}),ne=Te(Se.container.ownerDocument,"mouseup",function(j){return ce(),ne(),Y&&Y.series&&Y.series.onMouseUp(Y,j)}))})),Te(Se,"destroy",function(){be()})}var Te=re.addEvent,Ce=[];return{compose:function(Se){-1===Ce.indexOf(Se)&&(Ce.push(Se),Te(Se,"load",me))},onMouseDown:function(Se,be){be=this.chart.pointer.normalize(be),Se.fixedPosition={chartX:be.chartX,chartY:be.chartY,plotX:Se.plotX,plotY:Se.plotY},Se.inDragMode=!0},onMouseMove:function(Se,be){if(Se.fixedPosition&&Se.inDragMode){var ce=this.chart,ne=ce.pointer.normalize(be);be=Se.fixedPosition.chartX-ne.chartX,ne=Se.fixedPosition.chartY-ne.chartY;var K=ce.graphLayoutsLookup,Y=void 0,j=void 0;(5<Math.abs(be)||5<Math.abs(ne))&&ce.isInsidePlot(Y=Se.fixedPosition.plotX-be,j=Se.fixedPosition.plotY-ne)&&(Se.plotX=Y,Se.plotY=j,Se.hasDragged=!0,this.redrawHalo(Se),K.forEach(function(N){N.restartSimulation()}))}},onMouseUp:function(Se,be){Se.fixedPosition&&(Se.hasDragged&&(this.layout.enableSimulation?this.layout.start():this.chart.redraw()),Se.inDragMode=Se.hasDragged=!1,this.options.fixedDraggable||delete Se.fixedPosition)},redrawHalo:function(Se){Se&&this.halo&&this.halo.attr({d:Se.haloPath(this.options.states.hover.halo.size)})}}}),u(Ge,"Series/GraphLayoutComposition.js",[Ge["Core/Animation/AnimationUtilities.js"],Ge["Core/Utilities.js"]],function(re,me){function Te(){this.graphLayoutsLookup&&(this.graphLayoutsLookup.forEach(function(Y){Y.updateSimulation()}),this.redraw())}function Ce(){this.graphLayoutsLookup&&(this.graphLayoutsLookup.forEach(function(Y){Y.updateSimulation(!1)}),this.redraw())}function Se(){this.graphLayoutsLookup&&this.graphLayoutsLookup.forEach(function(Y){Y.stop()})}function be(){var Y=!1,j=function(R){R.maxIterations--&&isFinite(R.temperature)&&!R.isStable()&&!R.enableSimulation&&(R.beforeStep&&R.beforeStep(),R.step(),N=!1,Y=!0)};if(this.graphLayoutsLookup){for(ce(!1,this),this.graphLayoutsLookup.forEach(function(R){return R.start()});!N;){var N=!0;this.graphLayoutsLookup.forEach(j)}Y&&this.series.forEach(function(R){R&&R.layout&&R.render()})}}var ce=re.setAnimation,ne=me.addEvent,K=[];return{compose:function(Y){K.indexOf(Y)&&(K.push(Y),ne(Y,"afterPrint",Te),ne(Y,"beforePrint",Ce),ne(Y,"predraw",Se),ne(Y,"render",be))},integrations:{},layouts:{}}}),u(Ge,"Series/PackedBubble/PackedBubblePoint.js",[Ge["Core/Chart/Chart.js"],Ge["Core/Series/Point.js"],Ge["Core/Series/SeriesRegistry.js"]],function(re,me,Te){var Se,Ce=this&&this.__extends||(Se=function(be,ce){return(Se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ne,K){ne.__proto__=K}||function(ne,K){for(var Y in K)K.hasOwnProperty(Y)&&(ne[Y]=K[Y])})(be,ce)},function(be,ce){function ne(){this.constructor=be}Se(be,ce),be.prototype=null===ce?Object.create(ce):(ne.prototype=ce.prototype,new ne)});return function(Se){function be(){var ce=null!==Se&&Se.apply(this,arguments)||this;return ce.degree=NaN,ce.mass=NaN,ce.radius=NaN,ce.options=void 0,ce.series=void 0,ce.value=null,ce}return Ce(be,Se),be.prototype.destroy=function(){return this.series.layout&&this.series.layout.removeElementFromCollection(this,this.series.layout.nodes),me.prototype.destroy.apply(this,arguments)},be.prototype.firePointEvent=function(){var ce=this.series.options;if(this.isParentNode&&ce.parentNode){var ne=ce.allowPointSelect;ce.allowPointSelect=ce.parentNode.allowPointSelect,me.prototype.firePointEvent.apply(this,arguments),ce.allowPointSelect=ne}else me.prototype.firePointEvent.apply(this,arguments)},be.prototype.select=function(){var ce=this.series.chart;this.isParentNode?(ce.getSelectedPoints=ce.getSelectedParentNodes,me.prototype.select.apply(this,arguments),ce.getSelectedPoints=re.prototype.getSelectedPoints):me.prototype.select.apply(this,arguments)},be}(Te.seriesTypes.bubble.prototype.pointClass)}),u(Ge,"Series/PackedBubble/PackedBubbleSeriesDefaults.js",[Ge["Core/Utilities.js"]],function(re){var me=re.isNumber;return{minSize:"10%",maxSize:"50%",sizeBy:"area",zoneAxis:"y",crisp:!1,tooltip:{pointFormat:"Value: {point.value}"},draggable:!0,useSimulation:!0,parentNode:{allowPointSelect:!1},dataLabels:{formatter:function(){var Te=this.series.chart.numberFormatter,Ce=this.point.value;return me(Ce)?Te(Ce,-1):""},parentNodeFormatter:function(){return this.name},parentNodeTextPath:{enabled:!0},padding:0,style:{transition:"opacity 2000ms"}},layoutAlgorithm:{initialPositions:"circle",initialPositionRadius:20,bubblePadding:5,parentNodeLimit:!1,seriesInteraction:!0,dragBetweenSeries:!1,parentNodeOptions:{maxIterations:400,gravitationalConstant:.03,maxSpeed:50,initialPositionRadius:100,seriesInteraction:!0,marker:{fillColor:null,fillOpacity:1,lineWidth:null,lineColor:null,symbol:"circle"}},enableSimulation:!0,type:"packedbubble",integration:"packedbubble",maxIterations:1e3,splitSeries:!1,maxSpeed:5,gravitationalConstant:.01,friction:-.981}}}),u(Ge,"Series/Networkgraph/VerletIntegration.js",[],function(){return{attractive:function(re,me,Te){var Ce=re.getMass(),Se=-Te.x*me*this.diffTemperature;me=-Te.y*me*this.diffTemperature,re.fromNode.fixedPosition||(re.fromNode.plotX-=Se*Ce.fromNode/re.fromNode.degree,re.fromNode.plotY-=me*Ce.fromNode/re.fromNode.degree),re.toNode.fixedPosition||(re.toNode.plotX+=Se*Ce.toNode/re.toNode.degree,re.toNode.plotY+=me*Ce.toNode/re.toNode.degree)},attractiveForceFunction:function(re,me){return(me-re)/re},barycenter:function(){var re=this.options.gravitationalConstant,me=this.barycenter.xFactor,Te=this.barycenter.yFactor;me=(me-(this.box.left+this.box.width)/2)*re,Te=(Te-(this.box.top+this.box.height)/2)*re,this.nodes.forEach(function(Ce){Ce.fixedPosition||(Ce.plotX-=me/Ce.mass/Ce.degree,Ce.plotY-=Te/Ce.mass/Ce.degree)})},getK:function(re){return Math.pow(re.box.width*re.box.height/re.nodes.length,.5)},integrate:function(re,me){var Te=-re.options.friction,Ce=re.options.maxSpeed,Se=(me.plotX+me.dispX-me.prevX)*Te;Te*=me.plotY+me.dispY-me.prevY;var be=Math.abs,ce=be(Se)/(Se||1);be=be(Te)/(Te||1),Se=ce*Math.min(Ce,Math.abs(Se)),Te=be*Math.min(Ce,Math.abs(Te)),me.prevX=me.plotX+me.dispX,me.prevY=me.plotY+me.dispY,me.plotX+=Se,me.plotY+=Te,me.temperature=re.vectorLength({x:Se,y:Te})},repulsive:function(re,me,Te){me=me*this.diffTemperature/re.mass/re.degree,re.fixedPosition||(re.plotX+=Te.x*me,re.plotY+=Te.y*me)},repulsiveForceFunction:function(re,me){return(me-re)/re*(me>re?1:0)}}}),u(Ge,"Series/PackedBubble/PackedBubbleIntegration.js",[Ge["Core/Globals.js"],Ge["Series/Networkgraph/VerletIntegration.js"]],function(re,me){return{barycenter:function(){for(var be,ce,Te=this.options.gravitationalConstant,Ce=this.box,Se=this.nodes,ne=0;ne<Se.length;ne++){var K=Se[ne];this.options.splitSeries&&!K.isParentNode?(be=K.series.parentNode.plotX,ce=K.series.parentNode.plotY):(be=Ce.width/2,ce=Ce.height/2),K.fixedPosition||(K.plotX-=(K.plotX-be)*Te/(K.mass*Math.sqrt(Se.length)),K.plotY-=(K.plotY-ce)*Te/(K.mass*Math.sqrt(Se.length)))}},getK:re.noop,integrate:me.integrate,repulsive:function(Te,Ce,Se,be){var ce=Ce*this.diffTemperature/Te.mass/Te.degree;Ce=Se.x*ce,Se=Se.y*ce,Te.fixedPosition||(Te.plotX+=Ce,Te.plotY+=Se),be.fixedPosition||(be.plotX-=Ce,be.plotY-=Se)},repulsiveForceFunction:function(Te,Ce,Se,be){return Math.min(Te,(Se.marker.radius+be.marker.radius)/2)}}}),u(Ge,"Series/Networkgraph/EulerIntegration.js",[],function(){return{attractive:function(re,me,Te,Ce){var Se=re.getMass(),be=Te.x/Ce*me;me*=Te.y/Ce,re.fromNode.fixedPosition||(re.fromNode.dispX-=be*Se.fromNode/re.fromNode.degree,re.fromNode.dispY-=me*Se.fromNode/re.fromNode.degree),re.toNode.fixedPosition||(re.toNode.dispX+=be*Se.toNode/re.toNode.degree,re.toNode.dispY+=me*Se.toNode/re.toNode.degree)},attractiveForceFunction:function(re,me){return re*re/me},barycenter:function(){var re=this.options.gravitationalConstant,me=this.barycenter.xFactor,Te=this.barycenter.yFactor;this.nodes.forEach(function(Ce){if(!Ce.fixedPosition){var Se=Ce.getDegree();Ce.dispX+=(me-Ce.plotX)*re*(Se*=1+Se/2)/Ce.degree,Ce.dispY+=(Te-Ce.plotY)*re*Se/Ce.degree}})},getK:function(re){return Math.pow(re.box.width*re.box.height/re.nodes.length,.3)},integrate:function(re,me){me.dispX+=me.dispX*re.options.friction,me.dispY+=me.dispY*re.options.friction;var Te=me.temperature=re.vectorLength({x:me.dispX,y:me.dispY});0!==Te&&(me.plotX+=me.dispX/Te*Math.min(Math.abs(me.dispX),re.temperature),me.plotY+=me.dispY/Te*Math.min(Math.abs(me.dispY),re.temperature))},repulsive:function(re,me,Te,Ce){re.dispX+=Te.x/Ce*me/re.degree,re.dispY+=Te.y/Ce*me/re.degree},repulsiveForceFunction:function(re,me){return me*me/re}}}),u(Ge,"Series/Networkgraph/QuadTreeNode.js",[],function(){return function(){function re(me){this.isInternal=this.isEmpty=this.body=!1,this.nodes=[],this.box=me,this.boxSize=Math.min(me.width,me.height)}return re.prototype.divideBox=function(){var me=this.box.width/2,Te=this.box.height/2;this.nodes[0]=new re({left:this.box.left,top:this.box.top,width:me,height:Te}),this.nodes[1]=new re({left:this.box.left+me,top:this.box.top,width:me,height:Te}),this.nodes[2]=new re({left:this.box.left+me,top:this.box.top+Te,width:me,height:Te}),this.nodes[3]=new re({left:this.box.left,top:this.box.top+Te,width:me,height:Te})},re.prototype.getBoxPosition=function(me){var Te=me.plotY<this.box.top+this.box.height/2;return me.plotX<this.box.left+this.box.width/2?Te?0:3:Te?1:2},re.prototype.insert=function(me,Te){this.isInternal?this.nodes[this.getBoxPosition(me)].insert(me,Te-1):(this.isEmpty=!1,this.body?Te?(this.isInternal=!0,this.divideBox(),!0!==this.body&&(this.nodes[this.getBoxPosition(this.body)].insert(this.body,Te-1),this.body=!0),this.nodes[this.getBoxPosition(me)].insert(me,Te-1)):((Te=new re({top:me.plotX||NaN,left:me.plotY||NaN,width:.1,height:.1})).body=me,Te.isInternal=!1,this.nodes.push(Te)):(this.isInternal=!1,this.body=me))},re.prototype.updateMassAndCenter=function(){var me=0,Te=0,Ce=0;if(this.isInternal){for(var Se=0,be=this.nodes;Se<be.length;Se++){var ce=be[Se];ce.isEmpty||(me+=ce.mass,Te+=ce.plotX*ce.mass,Ce+=ce.plotY*ce.mass)}Te/=me,Ce/=me}else this.body&&(me=this.body.mass,Te=this.body.plotX,Ce=this.body.plotY);this.mass=me,this.plotX=Te,this.plotY=Ce},re}()}),u(Ge,"Series/Networkgraph/QuadTree.js",[Ge["Series/Networkgraph/QuadTreeNode.js"]],function(re){return function(){function me(Te,Ce,Se,be){this.box={left:Te,top:Ce,width:Se,height:be},this.maxDepth=25,this.root=new re(this.box),this.root.isInternal=!0,this.root.isRoot=!0,this.root.divideBox()}return me.prototype.calculateMassAndCenter=function(){this.visitNodeRecursive(null,null,function(Te){Te.updateMassAndCenter()})},me.prototype.insertNodes=function(Te){for(var Ce=0;Ce<Te.length;Ce++)this.root.insert(Te[Ce],this.maxDepth)},me.prototype.visitNodeRecursive=function(Te,Ce,Se){var be;if(Te||(Te=this.root),Te===this.root&&Ce&&(be=Ce(Te)),!1!==be){for(var ce=0,ne=Te.nodes;ce<ne.length;ce++){var K=ne[ce];if(K.isInternal){if(Ce&&(be=Ce(K)),!1===be)continue;this.visitNodeRecursive(K,Ce,Se)}else K.body&&Ce&&Ce(K.body);Se&&Se(K)}Te===this.root&&Se&&Se(Te)}},me}()}),u(Ge,"Series/Networkgraph/ReingoldFruchtermanLayout.js",[Ge["Series/Networkgraph/EulerIntegration.js"],Ge["Core/Globals.js"],Ge["Series/GraphLayoutComposition.js"],Ge["Series/Networkgraph/QuadTree.js"],Ge["Core/Utilities.js"],Ge["Series/Networkgraph/VerletIntegration.js"]],function(re,me,Te,Ce,Se,be){var ce=me.win,ne=Se.clamp,K=Se.defined,Y=Se.isFunction,j=Se.pick;return function(){function N(){this.attractiveForce=void 0,this.box={},this.currentStep=0,this.initialRendering=!0,this.integration=void 0,this.links=[],this.nodes=[],this.repulsiveForce=this.quadTree=this.options=void 0,this.series=[],this.simulation=!1}return N.compose=function(R){Te.compose(R),Te.integrations.euler=re,Te.integrations.verlet=be,Te.layouts["reingold-fruchterman"]=N},N.prototype.init=function(R){this.options=R,this.nodes=[],this.links=[],this.series=[],this.box={x:0,y:0,width:0,height:0},this.setInitialRendering(!0),this.integration=Te.integrations[R.integration],this.enableSimulation=R.enableSimulation,this.attractiveForce=j(R.attractiveForce,this.integration.attractiveForceFunction),this.repulsiveForce=j(R.repulsiveForce,this.integration.repulsiveForceFunction),this.approximation=R.approximation},N.prototype.updateSimulation=function(R){this.enableSimulation=j(R,this.options.enableSimulation)},N.prototype.start=function(){var R=this.series,I=this.options;this.currentStep=0,this.forces=R[0]&&R[0].forces||[],this.chart=R[0]&&R[0].chart,this.initialRendering&&(this.initPositions(),R.forEach(function(B){B.finishedAnimating=!0,B.render()})),this.setK(),this.resetSimulation(I),this.enableSimulation&&this.step()},N.prototype.step=function(){var R=this,I=this.series;this.currentStep++,"barnes-hut"===this.approximation&&(this.createQuadTree(),this.quadTree.calculateMassAndCenter());for(var B=0,P=this.forces||[];B<P.length;B++)this[P[B]+"Forces"](this.temperature);if(this.applyLimits(),this.temperature=this.coolDown(this.startTemperature,this.diffTemperature,this.currentStep),this.prevSystemTemperature=this.systemTemperature,this.systemTemperature=this.getSystemTemperature(),this.enableSimulation){for(B=0;B<I.length;B++)(P=I[B]).chart&&P.render();this.maxIterations--&&isFinite(this.temperature)&&!this.isStable()?(this.simulation&&ce.cancelAnimationFrame(this.simulation),this.simulation=ce.requestAnimationFrame(function(){return R.step()})):this.simulation=!1}},N.prototype.stop=function(){this.simulation&&ce.cancelAnimationFrame(this.simulation)},N.prototype.setArea=function(R,I,B,P){this.box={left:R,top:I,width:B,height:P}},N.prototype.setK=function(){this.k=this.options.linkLength||this.integration.getK(this)},N.prototype.addElementsToCollection=function(R,I){for(var B=0;B<R.length;B++){var P=R[B];-1===I.indexOf(P)&&I.push(P)}},N.prototype.removeElementFromCollection=function(R,I){-1!==(R=I.indexOf(R))&&I.splice(R,1)},N.prototype.clear=function(){this.nodes.length=0,this.links.length=0,this.series.length=0,this.resetSimulation()},N.prototype.resetSimulation=function(){this.forcedStop=!1,this.systemTemperature=0,this.setMaxIterations(),this.setTemperature(),this.setDiffTemperature()},N.prototype.restartSimulation=function(){this.simulation?this.resetSimulation():(this.setInitialRendering(!1),this.enableSimulation?this.start():this.setMaxIterations(1),this.chart&&this.chart.redraw(),this.setInitialRendering(!0))},N.prototype.setMaxIterations=function(R){this.maxIterations=j(R,this.options.maxIterations)},N.prototype.setTemperature=function(){this.temperature=this.startTemperature=Math.sqrt(this.nodes.length)},N.prototype.setDiffTemperature=function(){this.diffTemperature=this.startTemperature/(this.options.maxIterations+1)},N.prototype.setInitialRendering=function(R){this.initialRendering=R},N.prototype.createQuadTree=function(){this.quadTree=new Ce(this.box.left,this.box.top,this.box.width,this.box.height),this.quadTree.insertNodes(this.nodes)},N.prototype.initPositions=function(){var R=this.options.initialPositions;if(Y(R)){R.call(this),R=0;for(var I=this.nodes;R<I.length;R++){var B=I[R];K(B.prevX)||(B.prevX=B.plotX),K(B.prevY)||(B.prevY=B.plotY),B.dispX=0,B.dispY=0}}else"circle"===R?this.setCircularPositions():this.setRandomPositions()},N.prototype.setCircularPositions=function(){for(var R=this.box,I=this.nodes,B=2*Math.PI/(I.length+1),P=I.filter(function(q){return 0===q.linksTo.length}),H={},W=this.options.initialPositionRadius,ie=function(q){var D=0;for(q=q.linksFrom||[];D<q.length;D++){var z=q[D];H[z.toNode.id]||(H[z.toNode.id]=!0,te.push(z.toNode),ie(z.toNode))}},te=[],ee=0;ee<P.length;ee++){var J=P[ee];te.push(J),ie(J)}if(te.length)for(P=0;P<I.length;P++)-1===te.indexOf(ee=I[P])&&te.push(ee);else te=I;for(P=0,ee=te.length;P<ee;++P)(I=te[P]).plotX=I.prevX=j(I.plotX,R.width/2+W*Math.cos(P*B)),I.plotY=I.prevY=j(I.plotY,R.height/2+W*Math.sin(P*B)),I.dispX=0,I.dispY=0},N.prototype.setRandomPositions=function(){for(var H,R=this.box,I=this.nodes,B=I.length+1,P=function(te){return(te=te*te/Math.PI)-Math.floor(te)},W=0,ie=I.length;W<ie;++W)(H=I[W]).plotX=H.prevX=j(H.plotX,R.width*P(W)),H.plotY=H.prevY=j(H.plotY,R.height*P(B+W)),H.dispX=0,H.dispY=0},N.prototype.force=function(R){for(var I=[],B=1;B<arguments.length;B++)I[B-1]=arguments[B];this.integration[R].apply(this,I)},N.prototype.barycenterForces=function(){this.getBarycenter(),this.force("barycenter")},N.prototype.getBarycenter=function(){for(var R=0,I=0,B=0,P=0,H=this.nodes;P<H.length;P++){var W=H[P];I+=W.plotX*W.mass,B+=W.plotY*W.mass,R+=W.mass}return this.barycenter={x:I,y:B,xFactor:I/R,yFactor:B/R}},N.prototype.barnesHutApproximation=function(R,I){var B=this.getDistXY(R,I),P=this.vectorLength(B);if(R!==I&&0!==P)if(I.isInternal)if(I.boxSize/P<this.options.theta&&0!==P){var H=this.repulsiveForce(P,this.k);this.force("repulsive",R,H*I.mass,B,P);var W=!1}else W=!0;else H=this.repulsiveForce(P,this.k),this.force("repulsive",R,H*I.mass,B,P);return W},N.prototype.repulsiveForces=function(){var R=this;if("barnes-hut"===this.approximation)for(var I=function(D){B.quadTree.visitNodeRecursive(null,function(z){return R.barnesHutApproximation(D,z)})},B=this,P=0,H=this.nodes;P<H.length;P++){var W=H[P];I(W)}else{H=P=I=void 0;for(var ie=0,te=this.nodes;ie<te.length;ie++){W=te[ie];for(var ee=0,J=this.nodes;ee<J.length;ee++){var q=J[ee];W===q||W.fixedPosition||(H=this.getDistXY(W,q),0!==(P=this.vectorLength(H))&&(I=this.repulsiveForce(P,this.k),this.force("repulsive",W,I*q.mass,H,P)))}}}},N.prototype.attractiveForces=function(){for(var R,I,B,P=0,H=this.links;P<H.length;P++){var W=H[P];W.fromNode&&W.toNode&&(R=this.getDistXY(W.fromNode,W.toNode),0!==(I=this.vectorLength(R))&&(B=this.attractiveForce(I,this.k),this.force("attractive",W,B,R,I)))}},N.prototype.applyLimits=function(){for(var R=0,I=this.nodes;R<I.length;R++){var B=I[R];if(B.fixedPosition)break;this.integration.integrate(this,B),this.applyLimitBox(B,this.box),B.dispX=0,B.dispY=0}},N.prototype.applyLimitBox=function(R,I){var B=R.radius;R.plotX=ne(R.plotX,I.left+B,I.width-B),R.plotY=ne(R.plotY,I.top+B,I.height-B)},N.prototype.coolDown=function(R,I,B){return R-I*B},N.prototype.isStable=function(){return 1e-5>Math.abs(this.systemTemperature-this.prevSystemTemperature)||0>=this.temperature},N.prototype.getSystemTemperature=function(){for(var R=0,I=0,B=this.nodes;I<B.length;I++)R+=B[I].temperature;return R},N.prototype.vectorLength=function(R){return Math.sqrt(R.x*R.x+R.y*R.y)},N.prototype.getDistR=function(R,I){return R=this.getDistXY(R,I),this.vectorLength(R)},N.prototype.getDistXY=function(R,I){var B=R.plotX-I.plotX;return{x:B,y:R=R.plotY-I.plotY,absX:Math.abs(B),absY:Math.abs(R)}},N}()}),u(Ge,"Series/PackedBubble/PackedBubbleLayout.js",[Ge["Series/GraphLayoutComposition.js"],Ge["Series/PackedBubble/PackedBubbleIntegration.js"],Ge["Series/Networkgraph/ReingoldFruchtermanLayout.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce){function Se(){var j=[];return this.series.forEach(function(N){N.parentNode&&N.parentNode.selected&&j.push(N.parentNode)}),j}function be(){this.allDataPoints&&delete this.allDataPoints}var j,ce=this&&this.__extends||(j=function(N,R){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,B){I.__proto__=B}||function(I,B){for(var P in B)B.hasOwnProperty(P)&&(I[P]=B[P])})(N,R)},function(N,R){function I(){this.constructor=N}j(N,R),N.prototype=null===R?Object.create(R):(I.prototype=R.prototype,new I)}),ne=Ce.addEvent,K=Ce.pick,Y=[];return Ce=function(j){function N(){var R=null!==j&&j.apply(this,arguments)||this;return R.index=NaN,R.nodes=[],R.options=void 0,R.series=[],R}return ce(N,j),N.compose=function(R){Te.compose(R),re.integrations.packedbubble=me,re.layouts.packedbubble=N,-1===Y.indexOf(R)&&(Y.push(R),ne(R,"beforeRedraw",be),R.prototype.getSelectedParentNodes=Se)},N.prototype.beforeStep=function(){this.options.marker&&this.series.forEach(function(R){R&&R.calculateParentRadius()})},N.prototype.isStable=function(){var R=Math.abs(this.prevSystemTemperature-this.systemTemperature);return 1>Math.abs(10*this.systemTemperature/Math.sqrt(this.nodes.length))&&1e-5>R||0>=this.temperature},N.prototype.setCircularPositions=function(){for(var H,W,R=this.box,I=this.nodes,B=2*Math.PI/(I.length+1),P=this.options.initialPositionRadius,ie=0,te=0;te<I.length;te++){var ee=I[te];this.options.splitSeries&&!ee.isParentNode?(H=ee.series.parentNode.plotX,W=ee.series.parentNode.plotY):(H=R.width/2,W=R.height/2),ee.plotX=ee.prevX=K(ee.plotX,H+P*Math.cos(ee.index||ie*B)),ee.plotY=ee.prevY=K(ee.plotY,W+P*Math.sin(ee.index||ie*B)),ee.dispX=0,ee.dispY=0,ie++}},N.prototype.repulsiveForces=function(){var B,P,H,R=this,I=R.options.bubblePadding;R.nodes.forEach(function(W){W.degree=W.mass,W.neighbours=0,R.nodes.forEach(function(ie){B=0,W===ie||W.fixedPosition||!R.options.seriesInteraction&&W.series!==ie.series||(H=R.getDistXY(W,ie),0>(P=R.vectorLength(H)-(W.marker.radius+ie.marker.radius+I))&&(W.degree+=.01,W.neighbours++,B=R.repulsiveForce(-P/Math.sqrt(W.neighbours),R.k,W,ie)),R.force("repulsive",W,B*ie.mass,H,ie,P))})})},N.prototype.applyLimitBox=function(R,I){if(this.options.splitSeries&&!R.isParentNode&&this.options.parentNodeLimit){var B=this.getDistXY(R,R.series.parentNode),P=R.series.parentNodeRadius-R.marker.radius-this.vectorLength(B);0>P&&P>-2*R.marker.radius&&(R.plotX-=.01*B.x,R.plotY-=.01*B.y)}j.prototype.applyLimitBox.call(this,R,I)},N}(Te),re.layouts.packedbubble=Ce}),u(Ge,"Series/PackedBubble/PackedBubbleSeries.js",[Ge["Core/Color/Color.js"],Ge["Series/DragNodesComposition.js"],Ge["Series/GraphLayoutComposition.js"],Ge["Core/Globals.js"],Ge["Series/PackedBubble/PackedBubblePoint.js"],Ge["Series/PackedBubble/PackedBubbleSeriesDefaults.js"],Ge["Series/PackedBubble/PackedBubbleLayout.js"],Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce,Se,be,ce,ne,K){var q,Y=this&&this.__extends||(q=function(D,z){return(q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,U){A.__proto__=U}||function(A,U){for(var T in U)U.hasOwnProperty(T)&&(A[T]=U[T])})(D,z)},function(D,z){function A(){this.constructor=D}q(D,z),D.prototype=null===z?Object.create(z):(A.prototype=z.prototype,new A)}),j=re.parse;re=Ce.noop;var N=ne.series.prototype,R=ne.seriesTypes.bubble,I=K.addEvent,B=K.clamp,P=K.defined,H=K.extend,W=K.fireEvent,ie=K.isArray,te=K.isNumber,ee=K.merge,J=K.pick;return K=function(q){function D(){var z=null!==q&&q.apply(this,arguments)||this;return z.chart=void 0,z.data=void 0,z.layout=void 0,z.options=void 0,z.parentNodeMass=0,z.points=void 0,z.xData=void 0,z}return Y(D,q),D.compose=function(z,A,U,T){R.compose(z,A,U,T),ce.compose(A)},D.prototype.accumulateAllPoints=function(){for(var U,z=this.chart,A=[],T=0,S=z.series;T<S.length;T++){var O=S[T];if(O.is("packedbubble")&&O.visible||!z.options.chart.ignoreHiddenSeries){U=O.yData||[];for(var M=0;M<U.length;M++)A.push([null,null,U[M],O.index,M,{id:M,marker:{radius:0}}])}}return A},D.prototype.addLayout=function(){var z=this.options.layoutAlgorithm=this.options.layoutAlgorithm||{},A=z.type||"packedbubble",U=this.chart.options.chart,T=this.chart.graphLayoutsStorage,S=this.chart.graphLayoutsLookup;T||(this.chart.graphLayoutsStorage=T={},this.chart.graphLayoutsLookup=S=[]);var O=T[A];O||(z.enableSimulation=P(U.forExport)?!U.forExport:z.enableSimulation,T[A]=O=new Te.layouts[A],O.init(z),S.splice(O.index,0,O)),this.layout=O,this.points.forEach(function(M){M.mass=2,M.degree=1,M.collisionNmb=1}),O.setArea(0,0,this.chart.plotWidth,this.chart.plotHeight),O.addElementsToCollection([this],O.series),O.addElementsToCollection(this.points,O.nodes)},D.prototype.addSeriesLayout=function(){var z=this.options.layoutAlgorithm=this.options.layoutAlgorithm||{},A=z.type||"packedbubble",U=this.chart.graphLayoutsStorage,T=this.chart.graphLayoutsLookup;z=ee(z,z.parentNodeOptions,{enableSimulation:this.layout.options.enableSimulation});var S=U[A+"-series"];S||(U[A+"-series"]=S=new Te.layouts[A],S.init(z),T.splice(S.index,0,S)),this.parentNodeLayout=S,this.createParentNodes()},D.prototype.calculateParentRadius=function(){var z=this.seriesBox();this.parentNodeRadius=B(Math.sqrt(2*this.parentNodeMass/Math.PI)+20,20,z?Math.max(Math.sqrt(Math.pow(z.width,2)+Math.pow(z.height,2))/2+20,20):Math.sqrt(2*this.parentNodeMass/Math.PI)+20),this.parentNode&&(this.parentNode.marker.radius=this.parentNode.radius=this.parentNodeRadius)},D.prototype.calculateZExtremes=function(){var z=this.options.zMin,A=this.options.zMax,U=1/0,T=-1/0;return z&&A||(this.chart.series.forEach(function(S){S.yData.forEach(function(O){P(O)&&(O>T&&(T=O),O<U&&(U=O))})}),z=J(z,U),A=J(A,T)),[z,A]},D.prototype.checkOverlap=function(z,A){var U=z[0]-A[0],T=z[1]-A[1];return-.001>Math.sqrt(U*U+T*T)-Math.abs(z[2]+A[2])},D.prototype.createParentNodes=function(){var O,z=this,A=this.pointClass,U=this.chart,T=this.parentNodeLayout,S=this.layout.options,M=this.parentNode,Z={radius:this.parentNodeRadius,lineColor:this.color,fillColor:j(this.color).brighten(.4).get()};S.parentNodeOptions&&(Z=ee(S.parentNodeOptions.marker||{},Z)),this.parentNodeMass=0,this.points.forEach(function(ae){z.parentNodeMass+=Math.PI*Math.pow(ae.marker.radius,2)}),this.calculateParentRadius(),T.nodes.forEach(function(ae){ae.seriesIndex===z.index&&(O=!0)}),T.setArea(0,0,U.plotWidth,U.plotHeight),O||(M||(M=(new A).init(this,{mass:this.parentNodeRadius/2,marker:Z,dataLabels:{inside:!1},states:{normal:{marker:Z},hover:{marker:Z}},dataLabelOnNull:!0,degree:this.parentNodeRadius,isParentNode:!0,seriesIndex:this.index})),this.parentNode&&(M.plotX=this.parentNode.plotX,M.plotY=this.parentNode.plotY),this.parentNode=M,T.addElementsToCollection([this],T.series),T.addElementsToCollection([M],T.nodes))},D.prototype.deferLayout=function(){var z=this.options.layoutAlgorithm;this.visible&&(this.addLayout(),z.splitSeries&&this.addSeriesLayout())},D.prototype.destroy=function(){var z=this;this.chart.graphLayoutsLookup&&this.chart.graphLayoutsLookup.forEach(function(A){A.removeElementFromCollection(z,A.series)},this),this.parentNode&&this.parentNodeLayout&&(this.parentNodeLayout.removeElementFromCollection(this.parentNode,this.parentNodeLayout.nodes),this.parentNode.dataLabel&&(this.parentNode.dataLabel=this.parentNode.dataLabel.destroy())),N.destroy.apply(this,arguments)},D.prototype.drawDataLabels=function(){var z=this.options.dataLabels.textPath,A=this.points;N.drawDataLabels.apply(this,arguments),this.parentNode&&(this.parentNode.formatPrefix="parentNode",this.points=[this.parentNode],this.options.dataLabels.textPath=this.options.dataLabels.parentNodeTextPath,N.drawDataLabels.apply(this,arguments),this.points=A,this.options.dataLabels.textPath=z)},D.prototype.drawGraph=function(){if(this.layout&&this.layout.options.splitSeries){var z=this.chart,A=this.layout.options.parentNodeOptions.marker;A={fill:A.fillColor||j(this.color).brighten(.4).get(),opacity:A.fillOpacity,stroke:A.lineColor||this.color,"stroke-width":J(A.lineWidth,this.options.lineWidth)},this.parentNodesGroup||(this.parentNodesGroup=this.plotGroup("parentNodesGroup","parentNode",this.visible?"inherit":"hidden",.1,z.seriesGroup),this.group.attr({zIndex:2})),this.calculateParentRadius();var U=ee({x:this.parentNode.plotX-this.parentNodeRadius,y:this.parentNode.plotY-this.parentNodeRadius,width:2*this.parentNodeRadius,height:2*this.parentNodeRadius},A);this.parentNode.graphic||(this.graph=this.parentNode.graphic=z.renderer.symbol(A.symbol).add(this.parentNodesGroup)),this.parentNode.graphic.attr(U)}},D.prototype.drawTracker=function(){var z=this.parentNode;if(q.prototype.drawTracker.call(this),z){var A=ie(z.dataLabels)?z.dataLabels:z.dataLabel?[z.dataLabel]:[];z.graphic&&(z.graphic.element.point=z),A.forEach(function(U){U.div?U.div.point=z:U.element.point=z})}},D.prototype.getPointRadius=function(){var ue,ge,V,$,z=this,A=this.chart,U=this.options,T=U.useSimulation,S=Math.min(A.plotWidth,A.plotHeight),O={},M=[],Z=A.allDataPoints||[],ae=Z.length;["minSize","maxSize"].forEach(function(Me){var Ie=parseInt(U[Me],10),De=/%$/.test(U[Me]);O[Me]=De?S*Ie/100:Ie*Math.sqrt(ae)}),A.minRadius=ue=O.minSize/Math.sqrt(ae),A.maxRadius=ge=O.maxSize/Math.sqrt(ae);var de=T?this.calculateZExtremes():[ue,ge];Z.forEach(function(Me,Ie){V=T?B(Me[2],de[0],de[1]):Me[2],0===($=z.getRadius(de[0],de[1],ue,ge,V))&&($=null),Z[Ie][2]=$,M.push($)}),this.radii=M},D.prototype.init=function(){return N.init.apply(this,arguments),this.eventsToUnbind.push(I(this,"updatedData",function(){var z=this;this.chart.series.forEach(function(A){A.type===z.type&&(A.isDirty=!0)},this)})),this},D.prototype.onMouseUp=function(z){var A=z;if(A.fixedPosition&&!A.removed){var S,U=this.layout,T=this.parentNodeLayout;T&&U.options.dragBetweenSeries&&T.nodes.forEach(function(M){A&&A.marker&&M!==A.series.parentNode&&(S=U.getDistXY(A,M),0>U.vectorLength(S)-M.marker.radius-A.marker.radius&&(M.series.addPoint(ee(A.options,{plotX:A.plotX,plotY:A.plotY}),!1),U.removeElementFromCollection(A,U.nodes),A.remove()))}),me.onMouseUp.apply(this,arguments)}},D.prototype.placeBubbles=function(z){var ae,A=this.checkOverlap,U=this.positionBubble,T=[],S=1,O=0,M=0,Z=[];if((z=z.sort(function(ue,ge){return ge[2]-ue[2]})).length){if(T.push([[0,0,z[0][2],z[0][3],z[0][4]]]),1<z.length)for(T.push([[0,0-z[1][2]-z[0][2],z[1][2],z[1][3],z[1][4]]]),ae=2;ae<z.length;ae++)z[ae][2]=z[ae][2]||1,A(Z=U(T[S][O],T[S-1][M],z[ae]),T[S][0])?(T.push([]),M=0,T[S+1].push(U(T[S][O],T[S][0],z[ae])),S++,O=0):1<S&&T[S-1][M+1]&&A(Z,T[S-1][M+1])?(M++,T[S].push(U(T[S][O],T[S-1][M],z[ae])),O++):(O++,T[S].push(Z));this.chart.stages=T,this.chart.rawPositions=[].concat.apply([],T),this.resizeRadius(),Z=this.chart.rawPositions}return Z},D.prototype.pointAttribs=function(z,A){var U=this.options,T=U.marker;return z&&z.isParentNode&&U.layoutAlgorithm&&U.layoutAlgorithm.parentNodeOptions&&(T=U.layoutAlgorithm.parentNodeOptions.marker),U=T.fillOpacity,z=N.pointAttribs.call(this,z,A),1!==U&&(z["fill-opacity"]=U),z},D.prototype.positionBubble=function(z,A,U){var T=Math.sqrt,S=Math.asin,O=Math.acos,M=Math.pow,Z=Math.abs;return T=T(M(z[0]-A[0],2)+M(z[1]-A[1],2)),O=O((M(T,2)+M(U[2]+A[2],2)-M(U[2]+z[2],2))/(2*(U[2]+A[2])*T)),S=S(Z(z[0]-A[0])/T),z=(0>z[1]-A[1]?0:Math.PI)+O+S*(0>(z[0]-A[0])*(z[1]-A[1])?1:-1),[A[0]+(A[2]+U[2])*Math.sin(z),A[1]-(A[2]+U[2])*Math.cos(z),U[2],U[3],U[4]]},D.prototype.render=function(){var z=[];N.render.apply(this,arguments),this.options.dataLabels.allowOverlap||(this.data.forEach(function(A){ie(A.dataLabels)&&A.dataLabels.forEach(function(U){z.push(U)})}),this.options.useSimulation&&this.chart.hideOverlappingLabels(z))},D.prototype.resizeRadius=function(){for(var ae,ue,z=this.chart,A=z.rawPositions,U=Math.min,T=Math.max,S=z.plotLeft,O=z.plotTop,M=z.plotHeight,Z=z.plotWidth,ge=ae=Number.POSITIVE_INFINITY,V=ue=Number.NEGATIVE_INFINITY,$=0;$<A.length;$++){var de=A[$],Me=de[2];ge=U(ge,de[0]-Me),V=T(V,de[0]+Me),ae=U(ae,de[1]-Me),ue=T(ue,de[1]+Me)}if(U=U.apply([],[(Z-S)/(de=[V-ge,ue-ae])[0],(M-O)/de[1]]),1e-10<Math.abs(U-1)){for(z=0;z<A.length;z++)(de=A[z])[2]*=U;this.placeBubbles(A)}else z.diffY=M/2+O-ae-(ue-ae)/2,z.diffX=Z/2+S-ge-(V-ge)/2},D.prototype.seriesBox=function(){var S,z=this.chart,A=Math.max,U=Math.min,T=[z.plotLeft,z.plotLeft+z.plotWidth,z.plotTop,z.plotTop+z.plotHeight];return this.data.forEach(function(O){P(O.plotX)&&P(O.plotY)&&O.marker.radius&&(T[0]=U(T[0],O.plotX-(S=O.marker.radius)),T[1]=A(T[1],O.plotX+S),T[2]=U(T[2],O.plotY-S),T[3]=A(T[3],O.plotY+S))}),te(T.width/T.height)?T:null},D.prototype.setVisible=function(){var z=this;N.setVisible.apply(z,arguments),z.parentNodeLayout&&z.graph?z.visible?(z.graph.show(),z.parentNode.dataLabel&&z.parentNode.dataLabel.show()):(z.graph.hide(),z.parentNodeLayout.removeElementFromCollection(z.parentNode,z.parentNodeLayout.nodes),z.parentNode.dataLabel&&z.parentNode.dataLabel.hide()):z.layout&&(z.visible?z.layout.addElementsToCollection(z.points,z.layout.nodes):z.points.forEach(function(A){z.layout.removeElementFromCollection(A,z.layout.nodes)}))},D.prototype.translate=function(){var z=this.chart,A=this.data,U=this.index,T=this.options.useSimulation;if(this.processedXData=this.xData,this.generatePoints(),P(z.allDataPoints)||(z.allDataPoints=this.accumulateAllPoints(),this.getPointRadius()),T)var S=z.allDataPoints;else S=this.placeBubbles(z.allDataPoints),this.options.draggable=!1;for(var O=0,M=S;O<M.length;O++){var Z=M[O];if(Z[3]===U){S=A[Z[4]];var ae=J(Z[2],void 0);T||(S.plotX=Z[0]-z.plotLeft+z.diffX,S.plotY=Z[1]-z.plotTop+z.diffY),te(ae)&&(S.marker=H(S.marker,{radius:ae,width:2*ae,height:2*ae}),S.radius=ae)}}T&&this.deferLayout(),W(this,"afterTranslate")},D.defaultOptions=ee(R.defaultOptions,be),D}(R),H(K.prototype,{pointClass:Se,axisTypes:[],directTouch:!0,forces:["barycenter","repulsive"],hasDraggableNodes:!0,isCartesian:!1,noSharedTooltip:!0,pointArrayMap:["value"],pointValKey:"value",requireSorting:!1,trackerGroups:["group","dataLabelsGroup","parentNodesGroup"],alignDataLabel:N.alignDataLabel,indexateNodes:re,onMouseDown:me.onMouseDown,onMouseMove:me.onMouseMove,redrawHalo:me.redrawHalo,searchPoint:re}),ne.registerSeriesType("packedbubble",K),K}),u(Ge,"Series/Polygon/PolygonSeries.js",[Ge["Core/Globals.js"],Ge["Core/Legend/LegendSymbol.js"],Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce){var N,Se=this&&this.__extends||(N=function(R,I){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(B,P){B.__proto__=P}||function(B,P){for(var H in P)P.hasOwnProperty(H)&&(B[H]=P[H])})(R,I)},function(R,I){function B(){this.constructor=R}N(R,I),R.prototype=null===I?Object.create(I):(B.prototype=I.prototype,new B)});re=re.noop;var be=Te.series,ce=Te.seriesTypes,ne=ce.area,K=ce.line,Y=ce.scatter;ce=Ce.extend;var j=Ce.merge;return Ce=function(N){function R(){var I=null!==N&&N.apply(this,arguments)||this;return I.data=void 0,I.options=void 0,I.points=void 0,I}return Se(R,N),R.prototype.getGraphPath=function(){for(var I=K.prototype.getGraphPath.call(this),B=I.length+1;B--;)(B===I.length||"M"===I[B][0])&&0<B&&I.splice(B,0,["Z"]);return this.areaPath=I},R.prototype.drawGraph=function(){this.options.fillColor=this.color,ne.prototype.drawGraph.call(this)},R.defaultOptions=j(Y.defaultOptions,{marker:{enabled:!1,states:{hover:{enabled:!1}}},stickyTracking:!1,tooltip:{followPointer:!0,pointFormat:""},trackByArea:!0}),R}(Y),ce(Ce.prototype,{type:"polygon",drawLegendSymbol:me.drawRectangle,drawTracker:be.prototype.drawTracker,setStackedPoints:re}),Te.registerSeriesType("polygon",Ce),Ce}),u(Ge,"Core/Axis/WaterfallAxis.js",[Ge["Core/Axis/Stacking/StackItem.js"],Ge["Core/Utilities.js"]],function(re,me){var Se,Te=me.addEvent,Ce=me.objectEach;return function(be){function ce(){var N=this.waterfall.stacks;N&&(N.changed=!1,delete N.alreadyChanged)}function ne(){var N=this.options.stackLabels;N&&N.enabled&&this.waterfall.stacks&&this.waterfall.renderStackTotals()}function K(){for(var N=this.axes,R=this.series,I=R.length;I--;)R[I].options.stacking&&(N.forEach(function(B){B.isXAxis||(B.waterfall.stacks.changed=!0)}),I=0)}function Y(){this.waterfall||(this.waterfall=new j(this))}var j=function(){function N(R){this.axis=R,this.stacks={changed:!1}}return N.prototype.renderStackTotals=function(){var R=this.axis,I=R.waterfall.stacks,B=R.stacking&&R.stacking.stackTotalGroup,P=new re(R,R.options.stackLabels,!1,0,void 0);this.dummyStackItem=P,Ce(I,function(H){Ce(H,function(W){P.total=W.stackTotal,W.label&&(P.label=W.label),re.prototype.render.call(P,B),W.label=P.label,delete P.label})}),P.total=null},N}();be.Composition=j,be.compose=function(N,R){Te(N,"init",Y),Te(N,"afterBuildStacks",ce),Te(N,"afterRender",ne),Te(R,"beforeRedraw",K)}}(Se||(Se={})),Se}),u(Ge,"Series/Waterfall/WaterfallPoint.js",[Ge["Series/Column/ColumnSeries.js"],Ge["Core/Series/Point.js"],Ge["Core/Utilities.js"]],function(re,me,Te){var be,Ce=this&&this.__extends||(be=function(ce,ne){return(be=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(K,Y){K.__proto__=Y}||function(K,Y){for(var j in Y)Y.hasOwnProperty(j)&&(K[j]=Y[j])})(ce,ne)},function(ce,ne){function K(){this.constructor=ce}be(ce,ne),ce.prototype=null===ne?Object.create(ne):(K.prototype=ne.prototype,new K)}),Se=Te.isNumber;return function(be){function ce(){var ne=null!==be&&be.apply(this,arguments)||this;return ne.options=void 0,ne.series=void 0,ne}return Ce(ce,be),ce.prototype.getClassName=function(){var ne=me.prototype.getClassName.call(this);return this.isSum?ne+=" highcharts-sum":this.isIntermediateSum&&(ne+=" highcharts-intermediate-sum"),ne},ce.prototype.isValid=function(){return Se(this.y)||this.isSum||!!this.isIntermediateSum},ce}(re.prototype.pointClass)}),u(Ge,"Series/Waterfall/WaterfallSeries.js",[Ge["Core/Axis/Axis.js"],Ge["Core/Chart/Chart.js"],Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"],Ge["Core/Axis/WaterfallAxis.js"],Ge["Series/Waterfall/WaterfallPoint.js"]],function(re,me,Te,Ce,Se,be){var W,ce=this&&this.__extends||(W=function(ie,te){return(W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ee,J){ee.__proto__=J}||function(ee,J){for(var q in J)J.hasOwnProperty(q)&&(ee[q]=J[q])})(ie,te)},function(ie,te){function ee(){this.constructor=ie}W(ie,te),ie.prototype=null===te?Object.create(te):(ee.prototype=te.prototype,new ee)}),ne=Te.seriesTypes,K=ne.column,Y=ne.line,j=Ce.arrayMax,N=Ce.arrayMin,R=Ce.correctFloat;ne=Ce.extend;var I=Ce.isNumber,B=Ce.merge,P=Ce.objectEach,H=Ce.pick;return Ce=function(W){function ie(){var te=null!==W&&W.apply(this,arguments)||this;return te.chart=void 0,te.data=void 0,te.options=void 0,te.points=void 0,te.stackedYNeg=void 0,te.stackedYPos=void 0,te.stackKey=void 0,te.xData=void 0,te.yAxis=void 0,te.yData=void 0,te}return ce(ie,W),ie.prototype.generatePoints=function(){var te;K.prototype.generatePoints.apply(this);var ee=0;for(te=this.points.length;ee<te;ee++){var J=this.points[ee];(J.isIntermediateSum||J.isSum)&&(J.y=R(this.processedYData[ee]))}},ie.prototype.translate=function(){var te=this.options,ee=this.yAxis,J=H(te.minPointLength,5),q=J/2,D=te.threshold||0,z=D,A=D;te=te.stacking;var U=ee.waterfall.stacks[this.stackKey];K.prototype.translate.apply(this);for(var T=this.points,S=0;S<T.length;S++){var O=T[S],M=this.processedYData[S],Z=O.shapeArgs;if(Z&&I(M)){var ae=[0,M],ue=O.y;if(te){if(U){if(ae=U[S],"overlap"===te){var ge=ae.stackState[ae.stateIndex--];ge=0<=ue?ge:ge-ue,Object.hasOwnProperty.call(ae,"absolutePos")&&delete ae.absolutePos,Object.hasOwnProperty.call(ae,"absoluteNeg")&&delete ae.absoluteNeg}else 0<=ue?(ge=ae.threshold+ae.posTotal,ae.posTotal-=ue):(ge=ae.threshold+ae.negTotal,ae.negTotal-=ue,ge-=ue),!ae.posTotal&&Object.hasOwnProperty.call(ae,"absolutePos")&&(ae.posTotal=ae.absolutePos,delete ae.absolutePos),!ae.negTotal&&Object.hasOwnProperty.call(ae,"absoluteNeg")&&(ae.negTotal=ae.absoluteNeg,delete ae.absoluteNeg);O.isSum||(ae.connectorThreshold=ae.threshold+ae.stackTotal),ee.reversed?(M=0<=ue?ge-ue:ge+ue,ue=ge):(M=ge,ue=ge-ue),O.below=M<=D,Z.y=ee.translate(M,!1,!0,!1,!0),Z.height=Math.abs(Z.y-ee.translate(ue,!1,!0,!1,!0)),(ue=ee.waterfall.dummyStackItem)&&(ue.x=S,ue.label=U[S].label,ue.setOffset(this.pointXOffset||0,this.barW||0,this.stackedYNeg[S],this.stackedYPos[S]))}}else ge=Math.max(z,z+ue)+ae[0],Z.y=ee.translate(ge,!1,!0,!1,!0),O.isSum?(Z.y=ee.translate(ae[1],!1,!0,!1,!0),Z.height=Math.min(ee.translate(ae[0],!1,!0,!1,!0),ee.len)-Z.y,O.below=ae[1]<=D):O.isIntermediateSum?(0<=ue?(M=ae[1]+A,ue=A):(M=A,ue=ae[1]+A),ee.reversed&&(M^=ue,M^=ue^=M),Z.y=ee.translate(M,!1,!0,!1,!0),Z.height=Math.abs(Z.y-Math.min(ee.translate(ue,!1,!0,!1,!0),ee.len)),A+=ae[1],O.below=M<=D):(Z.height=0<M?ee.translate(z,!1,!0,!1,!0)-Z.y:ee.translate(z,!1,!0,!1,!0)-ee.translate(z-M,!1,!0,!1,!0),O.below=(z+=M)<D),0>Z.height&&(Z.y+=Z.height,Z.height*=-1);O.plotY=Z.y=Math.round(Z.y||0)-this.borderWidth%2/2,Z.height=Math.max(Math.round(Z.height||0),.001),O.yBottom=Z.y+Z.height,Z.height<=J&&!O.isNull?(Z.height=J,Z.y-=q,O.plotY=Z.y,O.minPointLengthOffset=0>O.y?-q:q):(O.isNull&&(Z.width=0),O.minPointLengthOffset=0),ue=O.plotY+(O.negative?Z.height:0),O.below&&(O.plotY+=Z.height),O.tooltipPos&&(this.chart.inverted?O.tooltipPos[0]=ee.len-ue:O.tooltipPos[1]=ue),O.isInside=this.isPointInside(O)}}},ie.prototype.processData=function(te){var A,U,T,S,O,ee=this.options,J=this.yData,q=ee.data,D=J.length,z=ee.threshold||0;for(O=U=A=T=S=0;O<D;O++){var M=J[O],Z=q&&q[O]?q[O]:{};"sum"===M||Z.isSum?J[O]=R(U):"intermediateSum"===M||Z.isIntermediateSum?(J[O]=R(A),A=0):(U+=M,A+=M),T=Math.min(U,T),S=Math.max(U,S)}W.prototype.processData.call(this,te),ee.stacking||(this.dataMin=T+z,this.dataMax=S)},ie.prototype.toYData=function(te){return te.isSum?"sum":te.isIntermediateSum?"intermediateSum":te.y},ie.prototype.updateParallelArrays=function(te,ee){W.prototype.updateParallelArrays.call(this,te,ee),("sum"===this.yData[0]||"intermediateSum"===this.yData[0])&&(this.yData[0]=null)},ie.prototype.pointAttribs=function(te,ee){var J=this.options.upColor;return J&&!te.options.color&&(te.color=0<te.y?J:null),delete(te=K.prototype.pointAttribs.call(this,te,ee)).dashstyle,te},ie.prototype.getGraphPath=function(){return[["M",0,0]]},ie.prototype.getCrispPath=function(){var S,te=this.data,ee=this.yAxis,J=te.length,q=Math.round(this.graph.strokeWidth())%2/2,D=Math.round(this.borderWidth)%2/2,z=this.xAxis.reversed,A=this.yAxis.reversed,U=this.options.stacking,T=[];for(S=1;S<J;S++){var O=te[S].shapeArgs,M=te[S-1],Z=te[S-1].shapeArgs,ae=ee.waterfall.stacks[this.stackKey],ue=0<M.y?-Z.height:0;ae&&Z&&O&&(ae=ae[S-1],U?(ae=ae.connectorThreshold,ue=Math.round(ee.translate(ae,0,1,0,1)+(A?ue:0))-q):ue=Z.y+M.minPointLengthOffset+D-q,T.push(["M",(Z.x||0)+(z?0:Z.width||0),ue],["L",(O.x||0)+(z&&O.width||0),ue])),Z&&T.length&&(!U&&0>M.y&&!A||0<M.y&&A)&&((M=T[T.length-2])&&"number"==typeof M[2]&&(M[2]+=Z.height||0),(M=T[T.length-1])&&"number"==typeof M[2]&&(M[2]+=Z.height||0))}return T},ie.prototype.drawGraph=function(){Y.prototype.drawGraph.call(this),this.graph.attr({d:this.getCrispPath()})},ie.prototype.setStackedPoints=function(){function te(De,oe,ve,xe){if(Ie)for(;ve<Ie;ve++)V.stackState[ve]+=xe;else V.stackState[0]=De,Ie=V.stackState.length;V.stackState.push(V.stackState[Ie-1]+oe)}var S,O,M,ee=this.options,J=this.yAxis.waterfall.stacks,q=ee.threshold,D=q||0,z=D,A=this.stackKey,U=this.xData,T=U.length;this.yAxis.stacking.usePercentage=!1;var Z=O=M=D;if(this.visible||!this.chart.options.chart.ignoreHiddenSeries){var ae=J.changed;(S=J.alreadyChanged)&&0>S.indexOf(A)&&(ae=!0),J[A]||(J[A]={}),S=J[A];for(var ue=0;ue<T;ue++){var ge=U[ue];(!S[ge]||ae)&&(S[ge]={negTotal:0,posTotal:0,stackTotal:0,threshold:0,stateIndex:0,stackState:[],label:ae&&S[ge]?S[ge].label:void 0});var V=S[ge],$=this.yData[ue];0<=$?V.posTotal+=$:V.negTotal+=$;var de=ee.data[ue];ge=V.absolutePos=V.posTotal;var Me=V.absoluteNeg=V.negTotal;V.stackTotal=ge+Me;var Ie=V.stackState.length;de&&de.isIntermediateSum?(te(M,O,0,M),M=O,O=q,D^=z,D^=z^=D):de&&de.isSum?(te(q,Z,Ie),D=q):(te(D,$,0,Z),de&&(Z+=$,O+=$)),V.stateIndex++,V.threshold=D,D+=V.stackTotal}J.changed=!1,J.alreadyChanged||(J.alreadyChanged=[]),J.alreadyChanged.push(A)}},ie.prototype.getExtremes=function(){var te=this.options.stacking;if(te){var ee=this.yAxis;ee=ee.waterfall.stacks;var J=this.stackedYNeg=[],q=this.stackedYPos=[];return P(ee[this.stackKey],"overlap"===te?function(D){J.push(N(D.stackState)),q.push(j(D.stackState))}:function(D){J.push(D.negTotal+D.threshold),q.push(D.posTotal+D.threshold)}),{dataMin:N(J),dataMax:j(q)}}return{dataMin:this.dataMin,dataMax:this.dataMax}},ie.defaultOptions=B(K.defaultOptions,{dataLabels:{inside:!0},lineWidth:1,lineColor:"#333333",dashStyle:"Dot",borderColor:"#333333",states:{hover:{lineWidthPlus:0}}}),ie}(K),ne(Ce.prototype,{getZonesGraphs:Y.prototype.getZonesGraphs,pointValKey:"y",showLine:!0,pointClass:be}),Te.registerSeriesType("waterfall",Ce),Se.compose(re,me),Ce}),u(Ge,"Core/Axis/RadialAxis.js",[Ge["Core/Axis/AxisDefaults.js"],Ge["Core/DefaultOptions.js"],Ge["Core/Globals.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce){var P,Se=me.defaultOptions,be=Te.noop,ce=Ce.addEvent,ne=Ce.correctFloat,K=Ce.defined,Y=Ce.extend,j=Ce.fireEvent,N=Ce.merge,R=Ce.pick,I=Ce.relativeLength,B=Ce.wrap;return function(H){function W(){this.autoConnect=this.isCircular&&typeof R(this.userMax,this.options.max)>"u"&&ne(this.endAngleRad-this.startAngleRad)===ne(2*Math.PI),!this.isCircular&&this.chart.inverted&&this.max++,this.autoConnect&&(this.max+=(this.categories?1:this.pointRange)||this.closestPointRange||0)}function ie(){var we=this;return function(){if(we.isRadial&&we.tickPositions&&we.options.labels&&!0!==we.options.labels.allowOverlap)return we.tickPositions.map(function(Le){return we.ticks[Le]&&we.ticks[Le].label}).filter(function(Le){return!!Le})}}function te(){return be}function ee(we,Le,Ne){var Ze=this.pane.center,at=we.value;if(this.isCircular){if(K(at))we.point&&(wt=we.point.shapeArgs||{}).start&&(at=this.chart.inverted?this.translate(we.point.rectPlotY,!0):we.point.x);else{var wt=we.chartX||0,Tt=we.chartY||0;at=this.translate(Math.atan2(Tt-Ne,wt-Le)-this.startAngleRad,!0)}wt=(we=this.getPosition(at)).x,Tt=we.y}else K(at)||(wt=we.chartX,Tt=we.chartY),K(wt)&&K(Tt)&&(Ne=Ze[1]+this.chart.plotTop,at=this.translate(Math.min(Math.sqrt(Math.pow(wt-Le,2)+Math.pow(Tt-Ne,2)),Ze[2]/2)-Ze[3]/2,!0));return[at,wt||0,Tt||0]}function J(we,Le,Ne){var Ze=this.chart,at=this.left||0,wt=this.top||0,Tt=R(Le,(we=this.pane.center)[2]/2-this.offset);return typeof Ne>"u"&&(Ne=this.horiz?0:this.center&&-this.center[3]/2),Ne&&(Tt+=Ne),this.isCircular||typeof Le<"u"?((Le=this.chart.renderer.symbols.arc(at+we[0],wt+we[1],Tt,Tt,{start:this.startAngleRad,end:this.endAngleRad,open:!0,innerR:0})).xBounds=[at+we[0]],Le.yBounds=[wt+we[1]-Tt]):(Le=this.postTranslate(this.angleRad,Tt),Le=[["M",this.center[0]+Ze.plotLeft,this.center[1]+Ze.plotTop],["L",Le.x,Le.y]]),Le}function q(){this.constructor.prototype.getOffset.call(this),this.chart.axisOffset[this.side]=0}function D(we,Le,Ne){var Ze=this.chart,at=function(Kt){if("string"==typeof Kt){var vi=parseInt(Kt,10);return je.test(Kt)&&(vi=vi*Ut/100),vi}return Kt},wt=this.center,Tt=this.startAngleRad,Ut=wt[2]/2,bt=Math.min(this.offset,0),lt=this.left||0,Pe=this.top||0,je=/%$/,it=this.isCircular,ct=R(at(Ne.outerRadius),Ut),vt=at(Ne.innerRadius);if(at=R(at(Ne.thickness),10),"polygon"===this.options.gridLineInterpolation)bt=this.getPlotLinePath({value:we}).concat(this.getPlotLinePath({value:Le,reverse:!0}));else{if(we=Math.max(we,this.min),Le=Math.min(Le,this.max),we=this.translate(we),Le=this.translate(Le),it||(ct=we||0,vt=Le||0),"circle"!==Ne.shape&&it)Ne=Tt+(we||0),Tt+=Le||0;else{Ne=-Math.PI/2,Tt=1.5*Math.PI;var Nt=!0}bt=Ze.renderer.symbols.arc(lt+wt[0],Pe+wt[1],ct-=bt,ct,{start:Math.min(Ne,Tt),end:Math.max(Ne,Tt),innerR:R(vt,ct-(at-bt)),open:Nt}),it&&(it=(Tt+Ne)/2,lt=lt+wt[0]+wt[2]/2*Math.cos(it),bt.xBounds=it>-Math.PI/2&&it<Math.PI/2?[lt,Ze.plotWidth]:[0,lt],bt.yBounds=[Pe+wt[1]+wt[2]/2*Math.sin(it)],bt.yBounds[0]+=it>-Math.PI&&0>it||it>Math.PI?-10:10)}return bt}function z(we){var Le=this,Ne=this.pane.center,Ze=this.chart,at=Ze.inverted,wt=we.reverse,Tt=this.pane.options.background?this.pane.options.background[0]||this.pane.options.background:{},Ut=Tt.innerRadius||"0%",bt=Tt.outerRadius||"100%",lt=Ne[0]+Ze.plotLeft,Pe=Ne[1]+Ze.plotTop,je=this.height,it=we.isCrosshair;Tt=Ne[3]/2;var vt,ct=we.value,Nt=this.getPosition(ct),Kt=Nt.x;if(Nt=Nt.y,it&&(ct=(Nt=this.getCrosshairPosition(we,lt,Pe))[0],Kt=Nt[1],Nt=Nt[2]),this.isCircular)ct=Math.sqrt(Math.pow(Kt-lt,2)+Math.pow(Nt-Pe,2)),wt="string"==typeof Ut?I(Ut,1):Ut/ct,Ze="string"==typeof bt?I(bt,1):bt/ct,Ne&&Tt&&(wt<(Tt/=ct)&&(wt=Tt),Ze<Tt&&(Ze=Tt)),Ne=[["M",lt+wt*(Kt-lt),Pe-wt*(Pe-Nt)],["L",Kt-(1-Ze)*(Kt-lt),Nt+(1-Ze)*(Pe-Nt)]];else if((ct=this.translate(ct))&&(0>ct||ct>je)&&(ct=0),"circle"===this.options.gridLineInterpolation)Ne=this.getLinePath(0,ct,Tt);else if(Ne=[],Ze[at?"yAxis":"xAxis"].forEach(function(vi){vi.pane===Le.pane&&(vt=vi)}),vt)for(lt=vt.tickPositions,vt.autoConnect&&(lt=lt.concat([lt[0]])),wt&&(lt=lt.slice().reverse()),ct&&(ct+=Tt),Pe=0;Pe<lt.length;Pe++)Tt=vt.getPosition(lt[Pe],ct),Ne.push(Pe?["L",Tt.x,Tt.y]:["M",Tt.x,Tt.y]);return Ne}function A(we,Le){return we=this.translate(we),this.postTranslate(this.isCircular?we:this.angleRad,R(this.isCircular?Le:0>we?0:we,this.center[2]/2)-this.offset)}function U(){var we=this.center,Le=this.chart,Ne=this.options.title;return{x:Le.plotLeft+we[0]+(Ne.x||0),y:Le.plotTop+we[1]-{high:.5,middle:.25,low:0}[Ne.align]*we[2]+(Ne.y||0)}}function T(we){we.beforeSetTickPositions=W,we.createLabelCollector=ie,we.getCrosshairPosition=ee,we.getLinePath=J,we.getOffset=q,we.getPlotBandPath=D,we.getPlotLinePath=z,we.getPosition=A,we.getTitlePosition=U,we.postTranslate=V,we.setAxisSize=de,we.setAxisTranslation=Me,we.setOptions=Ie}function S(){var we=this.chart,Le=this.options,Ne=this.pane,Ze=Ne&&Ne.options;we.angular&&this.isXAxis||!Ne||!we.angular&&!we.polar||(this.angleRad=(Le.angle||0)*Math.PI/180,this.startAngleRad=(Ze.startAngle-90)*Math.PI/180,this.endAngleRad=(R(Ze.endAngle,Ze.startAngle+360)-90)*Math.PI/180,this.offset=Le.offset||0)}function O(we){this.isRadial&&(we.align=void 0,we.preventDefault())}function M(){if(this.chart&&this.chart.labelCollectors){var we=this.labelCollector?this.chart.labelCollectors.indexOf(this.labelCollector):-1;0<=we&&this.chart.labelCollectors.splice(we,1)}}function Z(we){var lt,Le=this.chart,Ne=Le.inverted,Ze=Le.angular,at=Le.polar,wt=this.isXAxis,Tt=this.coll,Ut=Ze&&wt,bt=Le.options;we=we.userOptions.pane||0,we=this.pane=Le.pane&&Le.pane[we],"colorAxis"===Tt?this.isRadial=!1:(Ze?(Ut?(this.isHidden=!0,this.createLabelCollector=te,this.getOffset=be,this.render=this.redraw=$,this.setTitle=this.setCategories=this.setScale=be):T(this),(lt=!wt)&&(this.defaultPolarOptions=xe)):at&&(T(this),this.defaultPolarOptions=(lt=this.horiz)?ve:N("xAxis"===Tt?re.defaultXAxisOptions:re.defaultYAxisOptions,Re),Ne&&"yAxis"===Tt&&(this.defaultPolarOptions.stackLabels=re.defaultYAxisOptions.stackLabels,this.defaultPolarOptions.reversedStacks=!0)),Ze||at?(this.isRadial=!0,bt.chart.zooming.type=null,this.labelCollector||(this.labelCollector=this.createLabelCollector()),this.labelCollector&&Le.labelCollectors.push(this.labelCollector)):this.isRadial=!1,we&&lt&&(we.axis=this),this.isCircular=lt)}function ae(){this.isRadial&&this.beforeSetTickPositions()}function ue(we){var Le=this.label;if(Le){var Ne=this.axis,Ze=Le.getBBox(),at=Ne.options.labels,wt=(Ne.translate(this.pos)+Ne.startAngleRad+Math.PI/2)/Math.PI*180%360,Tt=Math.round(wt),Ut=K(at.y)?0:.3*-Ze.height,bt=at.y,lt=20,Pe=at.align,je="end",it=0>Tt?Tt+360:Tt,ct=it,vt=0,Nt=0;if(Ne.isRadial){var Kt=Ne.getPosition(this.pos,Ne.center[2]/2+I(R(at.distance,-25),Ne.center[2]/2,-Ne.center[2]/2));"auto"===at.rotation?Le.attr({rotation:wt}):K(bt)||(bt=Ne.chart.renderer.fontMetrics(Le.styles&&Le.styles.fontSize).b-Ze.height/2),K(Pe)||(Ne.isCircular?(Ze.width>Ne.len*Ne.tickInterval/(Ne.max-Ne.min)&&(lt=0),Pe=wt>lt&&wt<180-lt?"left":wt>180+lt&&wt<360-lt?"right":"center"):Pe="center",Le.attr({align:Pe})),"auto"===Pe&&2===Ne.tickPositions.length&&Ne.isCircular&&(90<it&&180>it?it=180-it:270<it&&360>=it&&(it=540-it),180<ct&&360>=ct&&(ct=360-ct),(Ne.pane.options.startAngle===Tt||Ne.pane.options.startAngle===Tt+360||Ne.pane.options.startAngle===Tt-360)&&(je="start"),Pe=-90<=Tt&&90>=Tt||-360<=Tt&&-270>=Tt||270<=Tt&&360>=Tt?"start"===je?"right":"left":"start"===je?"left":"right",70<ct&&110>ct&&(Pe="center"),15>it||180<=it&&195>it?vt=.3*Ze.height:15<=it&&35>=it?vt="start"===je?0:.75*Ze.height:195<=it&&215>=it?vt="start"===je?.75*Ze.height:0:35<it&&90>=it?vt="start"===je?.25*-Ze.height:Ze.height:215<it&&270>=it&&(vt="start"===je?Ze.height:.25*-Ze.height),15>ct?Nt="start"===je?.15*-Ze.height:.15*Ze.height:165<ct&&180>=ct&&(Nt="start"===je?.15*Ze.height:.15*-Ze.height),Le.attr({align:Pe}),Le.translate(Nt,vt+Ut)),we.pos.x=Kt.x+(at.x||0),we.pos.y=Kt.y+(bt||0)}}}function ge(we){this.axis.getPosition&&Y(we.pos,this.axis.getPosition(this.pos))}function V(we,Le){var Ne=this.chart,Ze=this.center;return we=this.startAngleRad+we,{x:Ne.plotLeft+Ze[0]+Math.cos(we)*Le,y:Ne.plotTop+Ze[1]+Math.sin(we)*Le}}function $(){this.isDirty=!1}function de(){if(this.constructor.prototype.setAxisSize.call(this),this.isRadial){this.pane.updateCenter(this);var we=this.center=this.pane.center.slice();if(this.isCircular)this.sector=this.endAngleRad-this.startAngleRad;else{var Le=this.postTranslate(this.angleRad,we[3]/2);we[0]=Le.x-this.chart.plotLeft,we[1]=Le.y-this.chart.plotTop}this.len=this.width=this.height=(we[2]-we[3])*R(this.sector,1)/2}}function Me(){this.constructor.prototype.setAxisTranslation.call(this),this.center&&(this.transA=this.isCircular?(this.endAngleRad-this.startAngleRad)/(this.max-this.min||1):(this.center[2]-this.center[3])/2/(this.max-this.min||1),this.minPixelPadding=this.isXAxis?this.transA*this.minPointOffset:0)}function Ie(we){(we=this.options=N(this.constructor.defaultOptions,this.defaultPolarOptions,Se[this.coll],we)).plotBands||(we.plotBands=[]),j(this,"afterSetOptions")}function De(we,Le,Ne,Ze,at,wt,Tt){var Ut=this.axis;return Ut.isRadial?["M",Le,Ne,"L",(we=Ut.getPosition(this.pos,Ut.center[2]/2+Ze)).x,we.y]:we.call(this,Le,Ne,Ze,at,wt,Tt)}var oe=[],ve={gridLineWidth:1,labels:{align:void 0,distance:15,x:0,y:void 0,style:{textOverflow:"none"}},maxPadding:0,minPadding:0,showLastLabel:!1,tickLength:0},xe={labels:{align:"center",x:0,y:void 0},minorGridLineWidth:0,minorTickInterval:"auto",minorTickLength:10,minorTickPosition:"inside",minorTickWidth:1,tickLength:10,tickPosition:"inside",tickWidth:2,title:{rotation:0},zIndex:2},Re={gridLineInterpolation:"circle",gridLineWidth:1,labels:{align:"right",x:-3,y:-2},showLastLabel:!1,title:{x:4,text:null,rotation:90}};H.compose=function(we,Le){return-1===oe.indexOf(we)&&(oe.push(we),ce(we,"afterInit",S),ce(we,"autoLabelAlign",O),ce(we,"destroy",M),ce(we,"init",Z),ce(we,"initialAxisTranslation",ae)),-1===oe.indexOf(Le)&&(oe.push(Le),ce(Le,"afterGetLabelPosition",ue),ce(Le,"afterGetPosition",ge),B(Le.prototype,"getMarkPath",De)),we}}(P||(P={})),P}),u(Ge,"Series/PolarComposition.js",[Ge["Core/Animation/AnimationUtilities.js"],Ge["Core/Globals.js"],Ge["Extensions/Pane.js"],Ge["Core/Axis/RadialAxis.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce,Se){function be(O,M,Z,ae){var ue=ae?1:0,ge=0<=M&&M<=O.length-1?M:0>M?O.length-1+M:0,V=O[M=0>ge-1?O.length-(1+ue):ge-1],$=V.plotY,de=(ue=O[ge+1>O.length-1?ue:ge+1]).plotX,Me=ue.plotY;V=(1.5*(ue=O[ge].plotX)+V.plotX)/2.5,$=(1.5*(ge=O[ge].plotY)+$)/2.5,de=(1.5*ue+de)/2.5;var Ie=(1.5*ge+Me)/2.5;Me=Math.sqrt(Math.pow(V-ue,2)+Math.pow($-ge,2));var De=Math.sqrt(Math.pow(de-ue,2)+Math.pow(Ie-ge,2));return V=Math.atan2($-ge,V-ue),Ie=Math.PI/2+(V+Math.atan2(Ie-ge,de-ue))/2,Math.abs(V-Ie)>Math.PI/2&&(Ie-=Math.PI),V=ue+Math.cos(Ie)*Me,$=ge+Math.sin(Ie)*Me,ue={rightContX:de=ue+Math.cos(Math.PI+Ie)*De,rightContY:Ie=ge+Math.sin(Math.PI+Ie)*De,leftContX:V,leftContY:$,plotX:ue,plotY:ge},Z&&(ue.prevPointCont=be(O,M,!1,ae)),ue}function ce(){(this.pane||[]).forEach(function(O){O.render()})}function ne(){var O=this;this.pane||(this.pane=[]),this.options.pane=z(this.options.pane),this.options.pane.forEach(function(M){new Te(M,O)},this)}function K(){var O=this.chart;O.polar&&(this.polar=new S(this),O.inverted&&(this.isRadialSeries=!0,this.is("column")&&(this.isRadialBar=!0)))}function Y(){if(this.chart.polar&&this.xAxis){var O=this.chart;if((this.kdByAngle=O.tooltip&&O.tooltip.shared)?this.searchPoint=j:this.options.findNearestPointBy="xy",!this.preventPostTranslate)for(var M=this.points,Z=M.length,ae=void 0;Z--;)this.polar.toXY(ae=M[Z]),!O.hasParallelCoordinates&&!this.yAxis.reversed&&ae.y<this.yAxis.min&&(ae.isNull=!0);this.hasClipCircleSetter||(this.hasClipCircleSetter=!!this.eventsToUnbind.push(te(this,"afterRender",function(){if(O.polar){var ue=this.yAxis.pane.center;if(this.clipCircle)this.clipCircle.animate({x:ue[0],y:ue[1],r:ue[2]/2,innerR:ue[3]/2});else{var ge=O.renderer,V=ue[0],$=ue[1],de=ue[2]/2,Me=ue[3]/2;ue=A();var Ie=ge.createElement("clipPath").attr({id:ue}).add(ge.defs);(ge=Me?ge.arc(V,$,de,Me,0,2*Math.PI).add(Ie):ge.circle(V,$,de).add(Ie)).id=ue,ge.clipPath=Ie,this.clipCircle=ge}this.group.clip(this.clipCircle),this.setClip=me.noop}})))}}function j(O){var M=this.chart,Z=this.xAxis;return Z=Z.pane&&Z.pane.center,this.searchKDTree({clientX:180+-180/Math.PI*Math.atan2(O.chartX-(Z&&Z[0]||0)-M.plotLeft,O.chartY-(Z&&Z[1]||0)-M.plotTop)})}function N(O,M){return J(this.pane||[],function(Z){return Z.options.id===M})||O.call(this,M)}function R(O,M,Z,ae,ue,ge){var V=this.chart,$=D(ae.inside,!!this.options.stacking);V.polar?(O=M.rectPlotX/Math.PI*180,V.inverted?(this.forceDL=V.isInsidePlot(M.plotX,Math.round(M.plotY)),$&&M.shapeArgs?ue={x:(ue=this.yAxis.postTranslate((((ue=M.shapeArgs).start||0)+(ue.end||0))/2-this.xAxis.startAngleRad,M.barX+M.pointWidth/2)).x-V.plotLeft,y:ue.y-V.plotTop}:M.tooltipPos&&(ue={x:M.tooltipPos[0],y:M.tooltipPos[1]}),ae.align=D(ae.align,"center"),ae.verticalAlign=D(ae.verticalAlign,"middle")):(null===ae.align&&(ae.align=20<O&&160>O?"left":200<O&&340>O?"right":"center"),null===ae.verticalAlign&&(ae.verticalAlign=45>O||315<O?"bottom":135<O&&225>O?"top":"middle")),Object.getPrototypeOf(Object.getPrototypeOf(this)).alignDataLabel.call(this,M,Z,ae,ue,ge),this.isRadialBar&&M.shapeArgs&&M.shapeArgs.start===M.shapeArgs.end?Z.hide():Z.show()):O.call(this,M,Z,ae,ue,ge)}function I(O){var M=this.options,Z=M.stacking,ae=this.chart,ue=this.xAxis,ge=this.yAxis,V=ge.reversed,$=ge.center,de=ue.startAngleRad,Me=ue.endAngleRad-de,Ie=0,De=0,oe=0;if(this.preventPostTranslate=!0,O.call(this),ue.isRadial){ue=(O=this.points).length;var ve=ge.translate(ge.min),xe=ge.translate(ge.max);for(M=M.threshold||0,ae.inverted&&q(M)&&(Ie=ge.translate(M),ee(Ie)&&(0>Ie?Ie=0:Ie>Me&&(Ie=Me),this.translatedThreshold=Ie+de));ue--;){var Re=(M=O[ue]).barX,we=M.x,Le=M.y;M.shapeType="arc",ae.inverted?(M.plotY=ge.translate(Le),Z&&ge.stacking?(Le=ge.stacking.stacks[(0>Le?"-":"")+this.stackKey],this.visible&&Le&&Le[we]&&!M.isNull&&(oe=Le[we].points[this.getStackIndicator(void 0,we,this.index).key],De=ge.translate(oe[0]),oe=ge.translate(oe[1]),ee(De)&&(De=Se.clamp(De,0,Me)))):(De=Ie,oe=M.plotY),De>oe&&(oe=[De,De=oe][0]),V?oe>ve?oe=ve:De<xe?De=xe:(De>ve||oe<xe)&&(De=oe=Me):De<ve?De=ve:oe>xe?oe=xe:(oe<ve||De>xe)&&(De=oe=0),ge.min>ge.max&&(De=oe=V?Me:0),De+=de,oe+=de,$&&(M.barX=Re+=$[3]/2),we=Math.max(Re,0),Le=Math.max(Re+M.pointWidth,0),M.shapeArgs={x:$&&$[0],y:$&&$[1],r:Le,innerR:we,start:De,end:oe},M.opacity=De===oe?0:void 0,M.plotY=(ee(this.translatedThreshold)&&(De<this.translatedThreshold?De:oe))-de):M.shapeArgs=this.polar.arc(M.yBottom,M.plotY,De=Re+de,De+M.pointWidth),this.polar.toXY(M),ae.inverted?(Re=ge.postTranslate(M.rectPlotY,Re+M.pointWidth/2),M.tooltipPos=[Re.x-ae.plotLeft,Re.y-ae.plotTop]):M.tooltipPos=[M.plotX,M.plotY],$&&(M.ttBelow=M.plotY>$[1])}}}function B(O,M){var Z=this;if(this.chart.polar){M=M||this.points;for(var ae=0;ae<M.length;ae++)if(!M[ae].isNull){var ue=ae;break}if(!1!==this.options.connectEnds&&typeof ue<"u"){this.connectEnds=!0,M.splice(M.length,0,M[ue]);var ge=!0}M.forEach(function(V){typeof V.polarPlotY>"u"&&Z.polar.toXY(V)})}return ue=O.apply(this,[].slice.call(arguments,1)),ge&&M.pop(),ue}function P(O,M){var Z=this.chart,ae={xAxis:[],yAxis:[]};return Z.polar?Z.axes.forEach(function(ue){if("colorAxis"!==ue.coll){var ge=ue.isXAxis,V=ue.center,$=M.chartX-V[0]-Z.plotLeft;V=M.chartY-V[1]-Z.plotTop,ae[ge?"xAxis":"yAxis"].push({axis:ue,value:ue.translate(ge?Math.PI-Math.atan2($,V):Math.sqrt(Math.pow($,2)+Math.pow(V,2)),!0)})}}):ae=O.call(this,M),ae}function H(O,M){var Ie,De,oe,ve,Z=this,ae=this.chart,ue=this.group,ge=this.markerGroup,V=this.xAxis&&this.xAxis.center,$=ae.plotLeft,de=ae.plotTop,Me=this.options.animation;if(ae.polar){if(Z.isRadialBar)M||(Z.startAngleRad=D(Z.translatedThreshold,Z.xAxis.startAngleRad),me.seriesTypes.pie.prototype.animate.call(Z,M));else if(ae.renderer.isSVG)if(Me=ie(Me),Z.is("column")){if(!M){var xe=V[3]/2;Z.points.forEach(function(Re){oe=(De=Re.shapeArgs)&&De.r,ve=De&&De.innerR,(Ie=Re.graphic)&&De&&(Ie.attr({r:xe,innerR:xe}),Ie.animate({r:oe,innerR:ve},Z.options.animation))})}}else M?(ue.attr(O={translateX:V[0]+$,translateY:V[1]+de,scaleX:.001,scaleY:.001}),ge&&ge.attr(O)):(ue.animate(O={translateX:$,translateY:de,scaleX:1,scaleY:1},Me),ge&&ge.animate(O,Me))}else O.call(this,M)}function W(O,M,Z,ae){return this.chart.polar?ae?(Z=(O=be(M,ae,!0,this.connectEnds)).prevPointCont&&O.prevPointCont.rightContY,O=["C",q(M=O.prevPointCont&&O.prevPointCont.rightContX)?M:O.plotX,q(Z)?Z:O.plotY,q(O.leftContX)?O.leftContX:O.plotX,q(O.leftContY)?O.leftContY:O.plotY,O.plotX,O.plotY]):O=["M",Z.plotX,Z.plotY]:O=O.call(this,M,Z,ae),O}var ie=re.animObject,te=Se.addEvent,ee=Se.defined,J=Se.find,q=Se.isNumber,D=Se.pick,z=Se.splat,A=Se.uniqueKey,U=Se.wrap,T=[],S=function(){function O(M){this.series=M}return O.compose=function(M,Z,ae,ue,ge,V,$,de,Me){Ce.compose(M,ge),-1===T.indexOf(Z)&&(T.push(Z),te(Z,"afterDrawChartBox",ce),te(Z,"getAxes",ne),U(Z.prototype,"get",N)),-1===T.indexOf(ae)&&(T.push(ae),U(ae.prototype,"getCoordinates",P)),-1===T.indexOf(ue)&&(T.push(ue),te(ue,"afterInit",K),te(ue,"afterTranslate",Y,{order:2}),U(ue.prototype,"animate",H)),$&&-1===T.indexOf($)&&(T.push($),U(M=$.prototype,"alignDataLabel",R),U(M,"animate",H),U(M,"translate",I)),de&&-1===T.indexOf(de)&&(T.push(de),U(de.prototype,"getGraphPath",B)),Me&&-1===T.indexOf(Me)&&(T.push(Me),U(de=Me.prototype,"getPointSpline",W),V&&-1===T.indexOf(V)&&(T.push(V),V.prototype.getPointSpline=de.getPointSpline))},O.prototype.arc=function(M,Z,ae,ue){var ge=this.series,V=ge.xAxis.center,$=ge.yAxis.len,de=V[3]/2;return Z=$-Z+de,M=$-D(M,$)+de,ge.yAxis.reversed&&(0>Z&&(Z=de),0>M&&(M=de)),{x:V[0],y:V[1],r:Z,innerR:M,start:ae,end:ue}},O.prototype.toXY=function(M){var Z=this.series,ae=Z.chart,ue=Z.xAxis,ge=Z.yAxis,V=M.plotX,$=ae.inverted,de=M.y,Me=M.plotY,Ie=$?V:ge.len-Me;$&&Z&&!Z.isRadialBar&&(M.plotY=Me=q(de)?ge.translate(de):0),M.rectPlotX=V,M.rectPlotY=Me,ge.center&&(Ie+=ge.center[3]/2),q(Me)&&(ge=$?ge.postTranslate(Me,Ie):ue.postTranslate(V,Ie),M.plotX=M.polarPlotX=ge.x-ae.plotLeft,M.plotY=M.polarPlotY=ge.y-ae.plotTop),Z.kdByAngle?(0>(Z=(V/Math.PI*180+ue.pane.options.startAngle)%360)&&(Z+=360),M.clientX=Z):M.clientX=M.plotX},O}();return S}),u(Ge,"masters/highcharts-more.src.js",[Ge["Core/Globals.js"],Ge["Core/Series/SeriesRegistry.js"],Ge["Series/Bubble/BubbleSeries.js"],Ge["Series/PackedBubble/PackedBubbleSeries.js"],Ge["Series/PolarComposition.js"]],function(re,me,Te,Ce,Se){Te.compose(re.Axis,re.Chart,re.Legend,re.Series),Ce.compose(re.Axis,re.Chart,re.Legend,re.Series),Se.compose(re.Axis,re.Chart,re.Pointer,re.Series,re.Tick,me.seriesTypes.areasplinerange,me.seriesTypes.column,me.seriesTypes.line,me.seriesTypes.spline)})},_s.exports?(Ge.default=Ge,_s.exports=Ge):(Mn=[Is(470)],void 0!==(lo=function(u){return Ge(u),Ge.Highcharts=u,Ge}.apply(la,Mn))&&(_s.exports=lo))},470:function(_s,la,Is){var Mn,lo,Ge;lo=typeof window<"u"?window:this,Ge=function(lo){function Ge(re,me,Te,Ce){re.hasOwnProperty(me)||(re[me]=Ce.apply(null,Te),"function"==typeof CustomEvent&&lo.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:me,module:re[me]}})))}var u={};return Ge(u,"Core/Globals.js",[],function(){var re,me;return(me=re||(re={})).SVG_NS="http://www.w3.org/2000/svg",me.product="Highcharts",me.version="10.2.1",me.win=typeof lo<"u"?lo:{},me.doc=me.win.document,me.svg=me.doc&&me.doc.createElementNS&&!!me.doc.createElementNS(me.SVG_NS,"svg").createSVGRect,me.userAgent=me.win.navigator&&me.win.navigator.userAgent||"",me.isChrome=-1!==me.userAgent.indexOf("Chrome"),me.isFirefox=-1!==me.userAgent.indexOf("Firefox"),me.isMS=/(edge|msie|trident)/i.test(me.userAgent)&&!me.win.opera,me.isSafari=!me.isChrome&&-1!==me.userAgent.indexOf("Safari"),me.isTouchDevice=/(Mobile|Android|Windows Phone)/.test(me.userAgent),me.isWebKit=-1!==me.userAgent.indexOf("AppleWebKit"),me.deg2rad=2*Math.PI/360,me.hasBidiBug=me.isFirefox&&4>parseInt(me.userAgent.split("Firefox/")[1],10),me.hasTouch=!!me.win.TouchEvent,me.marginNames=["plotTop","marginRight","marginBottom","plotLeft"],me.noop=function(){},me.supportsPassiveEvents=function(){var Te=!1;if(!me.isMS){var Ce=Object.defineProperty({},"passive",{get:function(){Te=!0}});me.win.addEventListener&&me.win.removeEventListener&&(me.win.addEventListener("testPassive",me.noop,Ce),me.win.removeEventListener("testPassive",me.noop,Ce))}return Te}(),me.charts=[],me.dateFormats={},me.seriesTypes={},me.symbolSizes={},me.chartCount=0,re}),Ge(u,"Core/Utilities.js",[u["Core/Globals.js"]],function(re){function me(T,S,O,M){var Z=S?"Highcharts error":"Highcharts warning";32===T&&(T=Z+": Deprecated member");var ae=Y(T),ue=ae?Z+" #"+T+": www.highcharts.com/errors/"+T+"/":T.toString();if(typeof M<"u"){var ge="";ae&&(ue+="?"),ie(M,function(V,$){ge+="\n - ".concat($,": ").concat(V),ae&&(ue+=encodeURI($)+"="+encodeURI(V))}),ue+=ge}ee(re,"displayError",{chart:O,code:T,message:ue,params:M},function(){if(S)throw Error(ue);D.console&&-1===me.messages.indexOf(ue)&&console.warn(ue)}),me.messages.push(ue)}function Ce(T,S){return parseInt(T,S||10)}function Se(T){return"string"==typeof T}function be(T){return"[object Array]"===(T=Object.prototype.toString.call(T))||"[object Array Iterator]"===T}function ce(T,S){return!(!T||"object"!=typeof T||S&&be(T))}function ne(T){return ce(T)&&"number"==typeof T.nodeType}function K(T){var S=T&&T.constructor;return!(!ce(T,!0)||ne(T)||!S||!S.name||"Object"===S.name)}function Y(T){return"number"==typeof T&&!isNaN(T)&&1/0>T&&-1/0<T}function j(T){return typeof T<"u"&&null!==T}function N(T,S,O){var Z,M=Se(S)&&!j(O),ae=function(ue,ge){j(ue)?T.setAttribute(ge,ue):M?(Z=T.getAttribute(ge))||"class"!==ge||(Z=T.getAttribute(ge+"Name")):T.removeAttribute(ge)};return Se(S)?ae(O,S):ie(S,ae),Z}function R(T,S){var O;for(O in T||(T={}),S)T[O]=S[O];return T}function I(){for(var T=arguments,S=T.length,O=0;O<S;O++){var M=T[O];if(typeof M<"u"&&null!==M)return M}}function B(T,S){re.isMS&&!re.svg&&S&&j(S.opacity)&&(S.filter="alpha(opacity=".concat(100*S.opacity,")")),R(T.style,S)}function P(T){return Math.pow(10,Math.floor(Math.log(T)/Math.LN10))}function H(T,S){return 1e14<T?T:parseFloat(T.toPrecision(S||14))}function ie(T,S,O){for(var M in T)Object.hasOwnProperty.call(T,M)&&S.call(O||T[M],T[M],M,T)}function te(T,S,O){function M(ge,V){var $=T.removeEventListener||re.removeEventListenerPolyfill;$&&$.call(T,ge,V,!1)}function Z(ge){var V;if(T.nodeName){if(S){var $={};$[S]=!0}else $=ge;ie($,function(de,Me){if(ge[Me])for(V=ge[Me].length;V--;)M(Me,ge[Me][V].fn)})}}var ae="function"==typeof T&&T.prototype||T;if(Object.hasOwnProperty.call(ae,"hcEvents")){var ue=ae.hcEvents;S?(ae=ue[S]||[],O?(ue[S]=ae.filter(function(ge){return O!==ge.fn}),M(S,O)):(Z(ue),ue[S]=[])):(Z(ue),delete ae.hcEvents)}}function ee(T,S,O,M){if(O=O||{},q.createEvent&&(T.dispatchEvent||T.fireEvent&&T!==re)){var Z=q.createEvent("Events");Z.initEvent(S,!0,!0),O=R(Z,O),T.dispatchEvent?T.dispatchEvent(O):T.fireEvent(S,O)}else if(T.hcEvents){O.target||R(O,{preventDefault:function(){O.defaultPrevented=!0},target:T,type:S}),Z=[];for(var ae=T,ue=!1;ae.hcEvents;)Object.hasOwnProperty.call(ae,"hcEvents")&&ae.hcEvents[S]&&(Z.length&&(ue=!0),Z.unshift.apply(Z,ae.hcEvents[S])),ae=Object.getPrototypeOf(ae);ue&&Z.sort(function(ge,V){return ge.order-V.order}),Z.forEach(function(ge){!1===ge.fn.call(T,O)&&O.preventDefault()})}M&&!O.defaultPrevented&&M.call(T,O)}var J=re.charts,q=re.doc,D=re.win;(me||(me={})).messages=[],Math.easeInOutSine=function(T){return-.5*(Math.cos(Math.PI*T)-1)};var z=Array.prototype.find?function(T,S){return T.find(S)}:function(T,S){var O,M=T.length;for(O=0;O<M;O++)if(S(T[O],O))return T[O]};ie({map:"map",each:"forEach",grep:"filter",reduce:"reduce",some:"some"},function(T,S){re[S]=function(O){var M;return me(32,!1,void 0,((M={})["Highcharts.".concat(S)]="use Array.".concat(T),M)),Array.prototype[T].apply(O,[].slice.call(arguments,1))}});var A,T,S,U=(T=Math.random().toString(36).substring(2,9)+"-",S=0,function(){return"highcharts-"+(A?"":T)+S++});return D.jQuery&&(D.jQuery.fn.highcharts=function(){var T=[].slice.call(arguments);if(this[0])return T[0]?(new(re[Se(T[0])?T.shift():"Chart"])(this[0],T[0],T[1]),this):J[N(this[0],"data-highcharts-chart")]}),z={addEvent:function(T,S,O,M){void 0===M&&(M={});var Z="function"==typeof T&&T.prototype||T;Object.hasOwnProperty.call(Z,"hcEvents")||(Z.hcEvents={}),Z=Z.hcEvents,re.Point&&T instanceof re.Point&&T.series&&T.series.chart&&(T.series.chart.runTrackerClick=!0);var ae=T.addEventListener||re.addEventListenerPolyfill;return ae&&ae.call(T,S,O,!!re.supportsPassiveEvents&&{passive:void 0===M.passive?-1!==S.indexOf("touch"):M.passive,capture:!1}),Z[S]||(Z[S]=[]),Z[S].push({fn:O,order:"number"==typeof M.order?M.order:1/0}),Z[S].sort(function(ue,ge){return ue.order-ge.order}),function(){te(T,S,O)}},arrayMax:function(T){for(var S=T.length,O=T[0];S--;)T[S]>O&&(O=T[S]);return O},arrayMin:function(T){for(var S=T.length,O=T[0];S--;)T[S]<O&&(O=T[S]);return O},attr:N,clamp:function(T,S,O){return T>S?T<O?T:O:S},cleanRecursively:function Te(T,S){var O={};return ie(T,function(M,Z){ce(T[Z],!0)&&!T.nodeType&&S[Z]?(M=Te(T[Z],S[Z]),Object.keys(M).length&&(O[Z]=M)):(ce(T[Z])||T[Z]!==S[Z]||Z in T&&!(Z in S))&&(O[Z]=T[Z])}),O},clearTimeout:function(T){j(T)&&clearTimeout(T)},correctFloat:H,createElement:function(T,S,O,M,Z){return T=q.createElement(T),S&&R(T,S),Z&&B(T,{padding:"0",border:"none",margin:"0"}),O&&B(T,O),M&&M.appendChild(T),T},css:B,defined:j,destroyObjectProperties:function(T,S){ie(T,function(O,M){O&&O!==S&&O.destroy&&O.destroy(),delete T[M]})},discardElement:function(T){T&&T.parentElement&&T.parentElement.removeChild(T)},erase:function(T,S){for(var O=T.length;O--;)if(T[O]===S){T.splice(O,1);break}},error:me,extend:R,extendClass:function(T,S){var O=function(){};return R(O.prototype=new T,S),O},find:z,fireEvent:ee,getMagnitude:P,getNestedProperty:function(T,S){for(T=T.split(".");T.length&&j(S);){var O=T.shift();if(typeof O>"u"||"__proto__"===O||!j(S=S[O])||"function"==typeof S||"number"==typeof S.nodeType||S===D)return}return S},getStyle:function W(T,S,O){var M=re.getStyle||W;if("width"===S)return S=Math.min(T.offsetWidth,T.scrollWidth),(O=T.getBoundingClientRect&&T.getBoundingClientRect().width)<S&&O>=S-1&&(S=Math.floor(O)),Math.max(0,S-(M(T,"padding-left",!0)||0)-(M(T,"padding-right",!0)||0));if("height"===S)return Math.max(0,Math.min(T.offsetHeight,T.scrollHeight)-(M(T,"padding-top",!0)||0)-(M(T,"padding-bottom",!0)||0));if(D.getComputedStyle||me(27,!0),T=D.getComputedStyle(T,void 0)){var Z=T.getPropertyValue(S);I(O,"opacity"!==S)&&(Z=Ce(Z))}return Z},inArray:function(T,S,O){return me(32,!1,void 0,{"Highcharts.inArray":"use Array.indexOf"}),S.indexOf(T,O)},isArray:be,isClass:K,isDOMElement:ne,isFunction:function(T){return"function"==typeof T},isNumber:Y,isObject:ce,isString:Se,keys:function(T){return me(32,!1,void 0,{"Highcharts.keys":"use Object.keys"}),Object.keys(T)},merge:function(){var T,S=arguments,O={},M=function(ae,ue){return"object"!=typeof ae&&(ae={}),ie(ue,function(ge,V){"__proto__"!==V&&"constructor"!==V&&(ae[V]=!ce(ge,!0)||K(ge)||ne(ge)?ue[V]:M(ae[V]||{},ge))}),ae};!0===S[0]&&(O=S[1],S=Array.prototype.slice.call(S,2));var Z=S.length;for(T=0;T<Z;T++)O=M(O,S[T]);return O},normalizeTickInterval:function(T,S,O,M,Z){var ae=T,ue=T/(O=I(O,P(T)));for(S||(S=Z?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],!1===M&&(1===O?S=S.filter(function(ge){return ge%1==0}):.1>=O&&(S=[1/O]))),M=0;M<S.length&&(ae=S[M],!(Z&&ae*O>=T||!Z&&ue<=(S[M]+(S[M+1]||S[M]))/2));M++);return H(ae*O,-Math.round(Math.log(.001)/Math.LN10))},objectEach:ie,offset:function(T){var S=q.documentElement;return{top:(T=T.parentElement||T.parentNode?T.getBoundingClientRect():{top:0,left:0,width:0,height:0}).top+(D.pageYOffset||S.scrollTop)-(S.clientTop||0),left:T.left+(D.pageXOffset||S.scrollLeft)-(S.clientLeft||0),width:T.width,height:T.height}},pad:function(T,S,O){return Array((S||2)+1-String(T).replace("-","").length).join(O||"0")+T},pick:I,pInt:Ce,relativeLength:function(T,S,O){return/%$/.test(T)?S*parseFloat(T)/100+(O||0):parseFloat(T)},removeEvent:te,splat:function(T){return be(T)?T:[T]},stableSort:function(T,S){var M,Z,O=T.length;for(Z=0;Z<O;Z++)T[Z].safeI=Z;for(T.sort(function(ae,ue){return 0===(M=S(ae,ue))?ae.safeI-ue.safeI:M}),Z=0;Z<O;Z++)delete T[Z].safeI},syncTimeout:function(T,S,O){return 0<S?setTimeout(T,S,O):(T.call(0,O),-1)},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},uniqueKey:U,useSerialIds:function(T){return A=I(T,A)},wrap:function(T,S,O){var M=T[S];T[S]=function(){var Z=Array.prototype.slice.call(arguments),ae=arguments,ue=this;return ue.proceed=function(){M.apply(ue,arguments.length?arguments:ae)},Z.unshift(M),Z=O.apply(this,Z),ue.proceed=null,Z}}},z}),Ge(u,"Core/Chart/ChartDefaults.js",[],function(){return{alignThresholds:!1,panning:{enabled:!1,type:"x"},styledMode:!1,borderRadius:0,colorCount:10,allowMutatingData:!0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}},zoomBySingleTouch:!1,zooming:{singleTouch:!1,resetButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}}},width:null,height:null,borderColor:"#335cad",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"}}),Ge(u,"Core/Color/Color.js",[u["Core/Globals.js"],u["Core/Utilities.js"]],function(re,me){var Te=me.isNumber,Ce=me.merge,Se=me.pInt;return function(){function be(ce){this.rgba=[NaN,NaN,NaN,NaN],this.input=ce;var ne=re.Color;return ne&&ne!==be?new ne(ce):this instanceof be?void this.init(ce):new be(ce)}return be.parse=function(ce){return ce?new be(ce):be.None},be.prototype.init=function(ce){var ne;if("object"==typeof ce&&typeof ce.stops<"u")this.stops=ce.stops.map(function(N){return new be(N[1])});else if("string"==typeof ce){if(this.input=ce=be.names[ce.toLowerCase()]||ce,"#"===ce.charAt(0)){var K=ce.length,Y=parseInt(ce.substr(1),16);7===K?ne=[(16711680&Y)>>16,(65280&Y)>>8,255&Y,1]:4===K&&(ne=[(3840&Y)>>4|(3840&Y)>>8,(240&Y)>>4|240&Y,(15&Y)<<4|15&Y,1])}if(!ne)for(Y=be.parsers.length;Y--&&!ne;){var j=be.parsers[Y];(K=j.regex.exec(ce))&&(ne=j.parse(K))}}ne&&(this.rgba=ne)},be.prototype.get=function(ce){var ne=this.input,K=this.rgba;if("object"==typeof ne&&typeof this.stops<"u"){var Y=Ce(ne);return Y.stops=[].slice.call(Y.stops),this.stops.forEach(function(j,N){Y.stops[N]=[Y.stops[N][0],j.get(ce)]}),Y}return K&&Te(K[0])?"rgb"===ce||!ce&&1===K[3]?"rgb("+K[0]+","+K[1]+","+K[2]+")":"a"===ce?"".concat(K[3]):"rgba("+K.join(",")+")":ne},be.prototype.brighten=function(ce){var ne=this.rgba;if(this.stops)this.stops.forEach(function(Y){Y.brighten(ce)});else if(Te(ce)&&0!==ce)for(var K=0;3>K;K++)ne[K]+=Se(255*ce),0>ne[K]&&(ne[K]=0),255<ne[K]&&(ne[K]=255);return this},be.prototype.setOpacity=function(ce){return this.rgba[3]=ce,this},be.prototype.tweenTo=function(ce,ne){var K=this.rgba,Y=ce.rgba;return Te(K[0])&&Te(Y[0])?((ce=1!==Y[3]||1!==K[3])?"rgba(":"rgb(")+Math.round(Y[0]+(K[0]-Y[0])*(1-ne))+","+Math.round(Y[1]+(K[1]-Y[1])*(1-ne))+","+Math.round(Y[2]+(K[2]-Y[2])*(1-ne))+(ce?","+(Y[3]+(K[3]-Y[3])*(1-ne)):"")+")":ce.input||"none"},be.names={white:"#ffffff",black:"#000000"},be.parsers=[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(ce){return[Se(ce[1]),Se(ce[2]),Se(ce[3]),parseFloat(ce[4],10)]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(ce){return[Se(ce[1]),Se(ce[2]),Se(ce[3]),1]}}],be.None=new be(""),be}()}),Ge(u,"Core/Color/Palettes.js",[],function(){return{colors:"#7cb5ec #434348 #90ed7d #f7a35c #8085e9 #f15c80 #e4d354 #2b908f #f45b5b #91e8e1".split(" ")}}),Ge(u,"Core/Time.js",[u["Core/Globals.js"],u["Core/Utilities.js"]],function(re,me){var Te=re.win,Ce=me.defined,Se=me.error,be=me.extend,ce=me.isObject,ne=me.merge,K=me.objectEach,Y=me.pad,j=me.pick,N=me.splat,R=me.timeUnits,I=re.isSafari&&Te.Intl&&Te.Intl.DateTimeFormat.prototype.formatRange,B=re.isSafari&&Te.Intl&&!Te.Intl.DateTimeFormat.prototype.formatRange;return me=function(){function P(H){this.options={},this.variableTimezone=this.useUTC=!1,this.Date=Te.Date,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.update(H)}return P.prototype.get=function(H,W){if(this.variableTimezone||this.timezoneOffset){var ie=W.getTime(),te=ie-this.getTimezoneOffset(W);return W.setTime(te),H=W["getUTC"+H](),W.setTime(ie),H}return this.useUTC?W["getUTC"+H]():W["get"+H]()},P.prototype.set=function(H,W,ie){if(this.variableTimezone||this.timezoneOffset){if("Milliseconds"===H||"Seconds"===H||"Minutes"===H&&this.getTimezoneOffset(W)%36e5==0)return W["setUTC"+H](ie);var te=this.getTimezoneOffset(W);return te=W.getTime()-te,W.setTime(te),W["setUTC"+H](ie),H=this.getTimezoneOffset(W),te=W.getTime()+H,W.setTime(te)}return this.useUTC||I&&"FullYear"===H?W["setUTC"+H](ie):W["set"+H](ie)},P.prototype.update=function(H){var W=j(H&&H.useUTC,!0);this.options=H=ne(!0,this.options||{},H),this.Date=H.Date||Te.Date||Date,this.timezoneOffset=(this.useUTC=W)&&H.timezoneOffset||void 0,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.variableTimezone=W&&!(!H.getTimezoneOffset&&!H.timezone)},P.prototype.makeTime=function(H,W,ie,te,ee,J){if(this.useUTC){var q=this.Date.UTC.apply(0,arguments),D=this.getTimezoneOffset(q),z=this.getTimezoneOffset(q+=D);D!==z?q+=z-D:D-36e5!==this.getTimezoneOffset(q-36e5)||B||(q-=36e5)}else q=new this.Date(H,W,j(ie,1),j(te,0),j(ee,0),j(J,0)).getTime();return q},P.prototype.timezoneOffsetFunction=function(){var H=this,W=this.options,ie=W.getTimezoneOffset,te=W.moment||Te.moment;if(!this.useUTC)return function(ee){return 6e4*new Date(ee.toString()).getTimezoneOffset()};if(W.timezone){if(te)return function(ee){return 6e4*-te.tz(ee,W.timezone).utcOffset()};Se(25)}return this.useUTC&&ie?function(ee){return 6e4*ie(ee.valueOf())}:function(){return 6e4*(H.timezoneOffset||0)}},P.prototype.dateFormat=function(H,W,ie){if(!Ce(W)||isNaN(W))return re.defaultOptions.lang&&re.defaultOptions.lang.invalidDate||"";H=j(H,"%Y-%m-%d %H:%M:%S");var te=this,ee=new this.Date(W),J=this.get("Hours",ee),q=this.get("Day",ee),D=this.get("Date",ee),z=this.get("Month",ee),A=this.get("FullYear",ee),U=re.defaultOptions.lang,T=U&&U.weekdays,S=U&&U.shortWeekdays;return ee=be({a:S?S[q]:T[q].substr(0,3),A:T[q],d:Y(D),e:Y(D,2," "),w:q,b:U.shortMonths[z],B:U.months[z],m:Y(z+1),o:z+1,y:A.toString().substr(2,2),Y:A,H:Y(J),k:J,I:Y(J%12||12),l:J%12||12,M:Y(this.get("Minutes",ee)),p:12>J?"AM":"PM",P:12>J?"am":"pm",S:Y(ee.getSeconds()),L:Y(Math.floor(W%1e3),3)},re.dateFormats),K(ee,function(O,M){for(;-1!==H.indexOf("%"+M);)H=H.replace("%"+M,"function"==typeof O?O.call(te,W):O)}),ie?H.substr(0,1).toUpperCase()+H.substr(1):H},P.prototype.resolveDTLFormat=function(H){return ce(H,!0)?H:{main:(H=N(H))[0],from:H[1],to:H[2]}},P.prototype.getTimeTicks=function(H,W,ie,te){var U,ee=this,J=[],q={},D=new ee.Date(W),z=H.unitRange,A=H.count||1;if(te=j(te,1),Ce(W)){if(ee.set("Milliseconds",D,z>=R.second?0:A*Math.floor(ee.get("Milliseconds",D)/A)),z>=R.second&&ee.set("Seconds",D,z>=R.minute?0:A*Math.floor(ee.get("Seconds",D)/A)),z>=R.minute&&ee.set("Minutes",D,z>=R.hour?0:A*Math.floor(ee.get("Minutes",D)/A)),z>=R.hour&&ee.set("Hours",D,z>=R.day?0:A*Math.floor(ee.get("Hours",D)/A)),z>=R.day&&ee.set("Date",D,z>=R.month?1:Math.max(1,A*Math.floor(ee.get("Date",D)/A))),z>=R.month){ee.set("Month",D,z>=R.year?0:A*Math.floor(ee.get("Month",D)/A));var T=ee.get("FullYear",D)}z>=R.year&&ee.set("FullYear",D,T-T%A),z===R.week&&(T=ee.get("Day",D),ee.set("Date",D,ee.get("Date",D)-T+te+(T<te?-7:0))),T=ee.get("FullYear",D),te=ee.get("Month",D);var S=ee.get("Date",D),O=ee.get("Hours",D);for(W=D.getTime(),!ee.variableTimezone&&ee.useUTC||!Ce(ie)||(U=ie-W>4*R.month||ee.getTimezoneOffset(W)!==ee.getTimezoneOffset(ie)),W=D.getTime(),D=1;W<ie;)J.push(W),W=z===R.year?ee.makeTime(T+D*A,0):z===R.month?ee.makeTime(T,te+D*A):!U||z!==R.day&&z!==R.week?U&&z===R.hour&&1<A?ee.makeTime(T,te,S,O+D*A):W+z*A:ee.makeTime(T,te,S+D*A*(z===R.day?1:7)),D++;J.push(W),z<=R.hour&&1e4>J.length&&J.forEach(function(M){M%18e5==0&&"000000000"===ee.dateFormat("%H%M%S%L",M)&&(q[M]="day")})}return J.info=be(H,{higherRanks:q,totalRange:z*A}),J},P.prototype.getDateFormat=function(H,W,ie,te){var ee=this.dateFormat("%m-%d %H:%M:%S.%L",W),J={millisecond:15,second:12,minute:9,hour:6,day:3},q="millisecond";for(D in R){if(H===R.week&&+this.dateFormat("%w",W)===ie&&"00:00:00.000"===ee.substr(6)){var D="week";break}if(R[D]>H){D=q;break}if(J[D]&&ee.substr(J[D])!=="01-01 00:00:00.000".substr(J[D]))break;"week"!==D&&(q=D)}return this.resolveDTLFormat(te[D]).main},P}(),me}),Ge(u,"Core/DefaultOptions.js",[u["Core/Chart/ChartDefaults.js"],u["Core/Color/Color.js"],u["Core/Globals.js"],u["Core/Color/Palettes.js"],u["Core/Time.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce,Se,be){me=me.parse;var ce=be.merge,ne={colors:Ce.colors,symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January February March April May June July August September October November December".split(" "),shortMonths:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),decimalPoint:".",numericSymbols:"kMGTPE".split(""),resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{},time:{Date:void 0,getTimezoneOffset:void 0,timezone:void 0,timezoneOffset:0,useUTC:!0},chart:re,title:{text:"Chart title",align:"center",margin:15,widthAdjust:-44},subtitle:{text:"",align:"center",widthAdjust:-44},caption:{margin:15,text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},labels:{style:{position:"absolute",color:"#333333"}},legend:{enabled:!0,align:"center",alignColumns:!0,className:"highcharts-no-tooltip",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{activeColor:"#003399",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"12px",fontWeight:"bold",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#cccccc"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:Te.svg,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerShape:"callout",hideDelay:500,padding:8,shape:"callout",shared:!1,snap:Te.isTouchDevice?25:10,headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">\u25cf</span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:me("#f7f7f7").setOpacity(.85).get(),borderWidth:1,shadow:!0,stickOnContact:!1,style:{color:"#333333",cursor:"default",fontSize:"12px",whiteSpace:"nowrap"},useHTML:!1},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"9px"},text:"Highcharts.com"}};ne.chart.styledMode=!1;var K=new Se(ce(ne.global,ne.time));return{defaultOptions:ne,defaultTime:K,getOptions:function(){return ne},setOptions:function(Y){return ce(!0,ne,Y),(Y.time||Y.global)&&(Te.time?Te.time.update(ce(ne.global,ne.time,Y.global,Y.time)):Te.time=K),ne}}}),Ge(u,"Core/Animation/Fx.js",[u["Core/Color/Color.js"],u["Core/Globals.js"],u["Core/Utilities.js"]],function(re,me,Te){var Ce=re.parse,Se=me.win,be=Te.isNumber,ce=Te.objectEach;return function(){function ne(K,Y,j){this.pos=NaN,this.options=Y,this.elem=K,this.prop=j}return ne.prototype.dSetter=function(){var K=this.paths,Y=K&&K[0];K=K&&K[1];var j=this.now||0,N=[];if(1!==j&&Y&&K)if(Y.length===K.length&&1>j)for(var R=0;R<K.length;R++){for(var I=Y[R],B=K[R],P=[],H=0;H<B.length;H++){var W=I[H],ie=B[H];P[H]=be(W)&&be(ie)&&("A"!==B[0]||4!==H&&5!==H)?W+j*(ie-W):ie}N.push(P)}else N=K;else N=this.toD||[];this.elem.attr("d",N,void 0,!0)},ne.prototype.update=function(){var K=this.elem,Y=this.prop,j=this.now,N=this.options.step;this[Y+"Setter"]?this[Y+"Setter"]():K.attr?K.element&&K.attr(Y,j,null,!0):K.style[Y]=j+this.unit,N&&N.call(K,j,this)},ne.prototype.run=function(K,Y,j){var N=this,R=N.options,I=function(H){return!I.stopped&&N.step(H)},B=Se.requestAnimationFrame||function(H){setTimeout(H,13)},P=function(){for(var H=0;H<ne.timers.length;H++)ne.timers[H]()||ne.timers.splice(H--,1);ne.timers.length&&B(P)};K!==Y||this.elem["forceAnimate:"+this.prop]?(this.startTime=+new Date,this.start=K,this.end=Y,this.unit=j,this.now=this.start,this.pos=0,I.elem=this.elem,I.prop=this.prop,I()&&1===ne.timers.push(I)&&B(P)):(delete R.curAnim[this.prop],R.complete&&0===Object.keys(R.curAnim).length&&R.complete.call(this.elem))},ne.prototype.step=function(K){var Y=+new Date,j=this.options,N=this.elem,R=j.complete,I=j.duration,B=j.curAnim;if(N.attr&&!N.element)K=!1;else if(K||Y>=I+this.startTime){this.now=this.end,this.pos=1,this.update();var P=B[this.prop]=!0;ce(B,function(H){!0!==H&&(P=!1)}),P&&R&&R.call(N),K=!1}else this.pos=j.easing((Y-this.startTime)/I),this.now=this.start+(this.end-this.start)*this.pos,this.update(),K=!0;return K},ne.prototype.initPath=function(K,Y,j){function N(ee,J){for(;ee.length<te;){var q=ee[0],D=J[te-ee.length];D&&"M"===q[0]&&(ee[0]="C"===D[0]?["C",q[1],q[2],q[1],q[2],q[1],q[2]]:["L",q[1],q[2]]),ee.unshift(q),P&&(q=ee.pop(),ee.push(ee[ee.length-1],q))}}function R(ee,J){for(;ee.length<te;)if("C"===(J=ee[Math.floor(ee.length/H)-1].slice())[0]&&(J[1]=J[5],J[2]=J[6]),P){var q=ee[Math.floor(ee.length/H)].slice();ee.splice(ee.length/2,0,J,q)}else ee.push(J)}var I=K.startX,B=K.endX;j=j.slice();var P=K.isArea,H=P?2:1;if(!(Y=Y&&Y.slice()))return[j,j];if(I&&B&&B.length){for(K=0;K<I.length;K++){if(I[K]===B[0]){var W=K;break}if(I[0]===B[B.length-I.length+K]){W=K;var ie=!0;break}if(I[I.length-1]===B[B.length-I.length+K]){W=I.length-K;break}}typeof W>"u"&&(Y=[])}if(Y.length&&be(W)){var te=j.length+W*H;ie?(N(Y,j),R(j,Y)):(N(j,Y),R(Y,j))}return[Y,j]},ne.prototype.fillSetter=function(){ne.prototype.strokeSetter.apply(this,arguments)},ne.prototype.strokeSetter=function(){this.elem.attr(this.prop,Ce(this.start).tweenTo(Ce(this.end),this.pos),void 0,!0)},ne.timers=[],ne}()}),Ge(u,"Core/Animation/AnimationUtilities.js",[u["Core/Animation/Fx.js"],u["Core/Utilities.js"]],function(re,me){function Te(R){return K(R)?Y({duration:500,defer:0},R):{duration:R?500:0,defer:0}}function Ce(R,I){for(var B=re.timers.length;B--;)re.timers[B].elem!==R||I&&I!==re.timers[B].prop||(re.timers[B].stopped=!0)}var Se=me.defined,be=me.getStyle,ce=me.isArray,ne=me.isNumber,K=me.isObject,Y=me.merge,j=me.objectEach,N=me.pick;return{animate:function(R,I,B){var P,W,ie,H="";if(!K(B)){var te=arguments;B={duration:te[2],easing:te[3],complete:te[4]}}ne(B.duration)||(B.duration=400),B.easing="function"==typeof B.easing?B.easing:Math[B.easing]||Math.easeInOutSine,B.curAnim=Y(I),j(I,function(ee,J){Ce(R,J),ie=new re(R,B,J),W=void 0,"d"===J&&ce(I.d)?(ie.paths=ie.initPath(R,R.pathArray,I.d),ie.toD=I.d,P=0,W=1):R.attr?P=R.attr(J):(P=parseFloat(be(R,J))||0,"opacity"!==J&&(H="px")),W||(W=ee),"string"==typeof W&&W.match("px")&&(W=W.replace(/px/g,"")),ie.run(P,W,H)})},animObject:Te,getDeferredAnimation:function(R,I,B){var P=Te(I),H=0,W=0;return(B?[B]:R.series).forEach(function(ie){ie=Te(ie.options.animation),H=I&&Se(I.defer)?P.defer:Math.max(H,ie.duration+ie.defer),W=Math.min(P.duration,ie.duration)}),R.renderer.forExport&&(H=0),{defer:Math.max(0,H-W),duration:Math.min(H,W)}},setAnimation:function(R,I){I.renderer.globalAnimation=N(R,I.options.chart.animation,!0)},stop:Ce}}),Ge(u,"Core/Renderer/HTML/AST.js",[u["Core/Globals.js"],u["Core/Utilities.js"]],function(re,me){var Te=re.SVG_NS,Ce=me.attr,Se=me.createElement,be=me.css,ce=me.error,ne=me.isFunction,K=me.isString,Y=me.objectEach,j=me.splat,N=(me=re.win.trustedTypes)&&ne(me.createPolicy)&&me.createPolicy("highcharts",{createHTML:function(B){return B}}),R=N?N.createHTML(""):"";try{var I=!!(new DOMParser).parseFromString(R,"text/html")}catch{I=!1}return function(){function B(P){this.nodes="string"==typeof P?this.parseMarkup(P):P}return B.filterUserAttributes=function(P){return Y(P,function(H,W){var ie=!0;-1===B.allowedAttributes.indexOf(W)&&(ie=!1),-1!==["background","dynsrc","href","lowsrc","src"].indexOf(W)&&(ie=K(H)&&B.allowedReferences.some(function(te){return 0===H.indexOf(te)})),ie||(ce(33,!1,void 0,{"Invalid attribute in config":"".concat(W)}),delete P[W])}),P},B.parseStyle=function(P){return P.split(";").reduce(function(H,W){var ie=(W=W.split(":").map(function(te){return te.trim()})).shift();return ie&&W.length&&(H[ie.replace(/-([a-z])/g,function(te){return te[1].toUpperCase()})]=W.join(":")),H},{})},B.setElementHTML=function(P,H){P.innerHTML=B.emptyHTML,H&&new B(H).addToDOM(P)},B.prototype.addToDOM=function(P){return function H(W,ie){var te;return j(W).forEach(function(ee){var J=ee.tagName,q=ee.textContent?re.doc.createTextNode(ee.textContent):void 0,D=B.bypassHTMLFiltering;if(J)if("#text"===J)var z=q;else if(-1!==B.allowedTags.indexOf(J)||D){J=re.doc.createElementNS("svg"===J?Te:ie.namespaceURI||Te,J);var A=ee.attributes||{};Y(ee,function(U,T){"tagName"!==T&&"attributes"!==T&&"children"!==T&&"style"!==T&&"textContent"!==T&&(A[T]=U)}),Ce(J,D?A:B.filterUserAttributes(A)),ee.style&&be(J,ee.style),q&&J.appendChild(q),H(ee.children||[],J),z=J}else ce(33,!1,void 0,{"Invalid tagName in config":J});z&&ie.appendChild(z),te=z}),te}(this.nodes,P)},B.prototype.parseMarkup=function(P){var H=[];if(P=P.trim().replace(/ style=(["'])/g," data-style=$1"),I)P=(new DOMParser).parseFromString(N?N.createHTML(P):P,"text/html");else{var W=Se("div");W.innerHTML=P,P={body:W}}var ie=function(te,ee){var J=te.nodeName.toLowerCase(),q={tagName:J};if("#text"===J&&(q.textContent=te.textContent||""),J=te.attributes){var D={};[].forEach.call(J,function(A){"data-style"===A.name?q.style=B.parseStyle(A.value):D[A.name]=A.value}),q.attributes=D}if(te.childNodes.length){var z=[];[].forEach.call(te.childNodes,function(A){ie(A,z)}),z.length&&(q.children=z)}ee.push(q)};return[].forEach.call(P.body.childNodes,function(te){return ie(te,H)}),H},B.allowedAttributes="aria-controls aria-describedby aria-expanded aria-haspopup aria-hidden aria-label aria-labelledby aria-live aria-pressed aria-readonly aria-roledescription aria-selected class clip-path color colspan cx cy d dx dy disabled fill height href id in markerHeight markerWidth offset opacity orient padding paddingLeft paddingRight patternUnits r refX refY role scope slope src startOffset stdDeviation stroke stroke-linecap stroke-width style tableValues result rowspan summary target tabindex text-align text-anchor textAnchor textLength title type valign width x x1 x2 y y1 y2 zIndex".split(" "),B.allowedReferences="https:// http:// mailto: / ../ ./ #".split(" "),B.allowedTags="a abbr b br button caption circle clipPath code dd defs div dl dt em feComponentTransfer feFuncA feFuncB feFuncG feFuncR feGaussianBlur feOffset feMerge feMergeNode filter h1 h2 h3 h4 h5 h6 hr i img li linearGradient marker ol p path pattern pre rect small span stop strong style sub sup svg table text textPath thead tbody tspan td th tr u ul #text".split(" "),B.emptyHTML=R,B.bypassHTMLFiltering=!1,B}()}),Ge(u,"Core/FormatUtilities.js",[u["Core/DefaultOptions.js"],u["Core/Utilities.js"]],function(re,me){function Te(Y,j,N,R){j=+j;var I=Ce.lang,B=((Y=+Y||0).toString().split(".")[1]||"").split("e")[0].length,P=Y.toString().split("e"),H=j;if(-1===j)j=Math.min(B,20);else if(ce(j)){if(j&&P[1]&&0>P[1]){var W=j+ +P[1];0<=W?(P[0]=(+P[0]).toExponential(W).split("e")[0],j=W):(P[0]=P[0].split(".")[0]||0,Y=20>j?(P[0]*Math.pow(10,P[1])).toFixed(j):0,P[1]=0)}}else j=2;W=(Math.abs(P[1]?P[0]:Y)+Math.pow(10,-Math.max(j,B)-1)).toFixed(j);var ie=3<(B=String(K(W))).length?B.length%3:0;return N=ne(N,I.decimalPoint),R=ne(R,I.thousandsSep),Y=(0>Y?"-":"")+(ie?B.substr(0,ie)+R:""),Y=0>+P[1]&&!H?"0":Y+B.substr(ie).replace(/(\d{3})(?=\d)/g,"$1"+R),j&&(Y+=N+W.slice(-j)),P[1]&&0!=+Y&&(Y+="e"+P[1]),Y}var Ce=re.defaultOptions,Se=re.defaultTime,be=me.getNestedProperty,ce=me.isNumber,ne=me.pick,K=me.pInt;return{dateFormat:function(Y,j,N){return Se.dateFormat(Y,j,N)},format:function(Y,j,N){var R="{",I=!1,B=/f$/,P=/\.([0-9])/,H=Ce.lang,W=N&&N.time||Se;N=N&&N.numberFormatter||Te;for(var ie=[];Y;){var te=Y.indexOf(R);if(-1===te)break;var ee=Y.slice(0,te);if(I){if(ee=ee.split(":"),R=be(ee.shift()||"",j),ee.length&&"number"==typeof R)if(ee=ee.join(":"),B.test(ee)){var J=parseInt((ee.match(P)||["","-1"])[1],10);null!==R&&(R=N(R,J,H.decimalPoint,-1<ee.indexOf(",")?H.thousandsSep:""))}else R=W.dateFormat(ee,R);ie.push(R)}else ie.push(ee);Y=Y.slice(te+1),R=(I=!I)?"}":"{"}return ie.push(Y),ie.join("")},numberFormat:Te}}),Ge(u,"Core/Renderer/RendererUtilities.js",[u["Core/Utilities.js"]],function(re){var Se,me=re.clamp,Te=re.pick,Ce=re.stableSort;return(Se||(Se={})).distribute=function ce(ne,K,Y){var B,j=ne,N=j.reducedLen||K,R=function(ie,te){return(te.rank||0)-(ie.rank||0)},I=function(ie,te){return ie.target-te.target},P=!0,H=[],W=0;for(B=ne.length;B--;)W+=ne[B].size;if(W>N){for(Ce(ne,R),W=B=0;W<=N;)W+=ne[B].size,B++;H=ne.splice(B-1,ne.length)}for(Ce(ne,I),ne=ne.map(function(ie){return{size:ie.size,targets:[ie.target],align:Te(ie.align,.5)}});P;){for(B=ne.length;B--;)N=ne[B],R=(Math.min.apply(0,N.targets)+Math.max.apply(0,N.targets))/2,N.pos=me(R-N.size*N.align,0,K-N.size);for(B=ne.length,P=!1;B--;)0<B&&ne[B-1].pos+ne[B-1].size>ne[B].pos&&(ne[B-1].size+=ne[B].size,ne[B-1].targets=ne[B-1].targets.concat(ne[B].targets),ne[B-1].align=.5,ne[B-1].pos+ne[B-1].size>K&&(ne[B-1].pos=K-ne[B-1].size),ne.splice(B,1),P=!0)}return j.push.apply(j,H),B=0,ne.some(function(ie){var te=0;return(ie.targets||[]).some(function(){return j[B].pos=ie.pos+te,typeof Y<"u"&&Math.abs(j[B].pos-j[B].target)>Y?(j.slice(0,B+1).forEach(function(ee){return delete ee.pos}),j.reducedLen=(j.reducedLen||K)-.1*K,j.reducedLen>.1*K&&ce(j,K,Y),!0):(te+=j[B].size,B++,!1)})}),Ce(j,I),j},Se}),Ge(u,"Core/Renderer/SVG/SVGElement.js",[u["Core/Animation/AnimationUtilities.js"],u["Core/Color/Color.js"],u["Core/Globals.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce){var Se=re.animate,be=re.animObject,ce=re.stop,ne=Te.deg2rad,K=Te.doc,Y=Te.svg,j=Te.SVG_NS,N=Te.win,R=Ce.addEvent,I=Ce.attr,B=Ce.createElement,P=Ce.css,H=Ce.defined,W=Ce.erase,ie=Ce.extend,te=Ce.fireEvent,ee=Ce.isArray,J=Ce.isFunction,q=Ce.isString,D=Ce.merge,z=Ce.objectEach,A=Ce.pick,U=Ce.pInt,T=Ce.syncTimeout,S=Ce.uniqueKey;return re=function(){function O(){this.element=void 0,this.onEvents={},this.opacity=1,this.renderer=void 0,this.SVG_NS=j,this.symbolCustomAttribs="x y width height r start end innerR anchorX anchorY rounded".split(" ")}return O.prototype._defaultGetter=function(M){return M=A(this[M+"Value"],this[M],this.element?this.element.getAttribute(M):null,0),/^[\-0-9\.]+$/.test(M)&&(M=parseFloat(M)),M},O.prototype._defaultSetter=function(M,Z,ae){ae.setAttribute(Z,M)},O.prototype.add=function(M){var Z=this.renderer,ae=this.element;if(M&&(this.parentGroup=M),this.parentInverted=M&&M.inverted,typeof this.textStr<"u"&&"text"===this.element.nodeName&&Z.buildText(this),this.added=!0,!M||M.handleZ||this.zIndex)var ue=this.zIndexSetter();return ue||(M?M.element:Z.box).appendChild(ae),this.onAdd&&this.onAdd(),this},O.prototype.addClass=function(M,Z){var ae=Z?"":this.attr("class")||"";return(M=(M||"").split(/ /g).reduce(function(ue,ge){return-1===ae.indexOf(ge)&&ue.push(ge),ue},ae?[ae]:[]).join(" "))!==ae&&this.attr("class",M),this},O.prototype.afterSetters=function(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)},O.prototype.align=function(M,Z,ae){var $,de,Me,ue={},ge=this.renderer,V=ge.alignedObjects;M?(this.alignOptions=M,this.alignByTranslate=Z,(!ae||q(ae))&&(this.alignTo=$=ae||"renderer",W(V,this),V.push(this),ae=void 0)):(M=this.alignOptions,Z=this.alignByTranslate,$=this.alignTo),ae=A(ae,ge[$],"scrollablePlotBox"===$?ge.plotBox:void 0,ge);var Ie=M.verticalAlign;return ge=(ae.x||0)+(M.x||0),V=(ae.y||0)+(M.y||0),"right"===($=M.align)?de=1:"center"===$&&(de=2),de&&(ge+=(ae.width-(M.width||0))/de),ue[Z?"translateX":"x"]=Math.round(ge),"bottom"===Ie?Me=1:"middle"===Ie&&(Me=2),Me&&(V+=(ae.height-(M.height||0))/Me),ue[Z?"translateY":"y"]=Math.round(V),this[this.placed?"animate":"attr"](ue),this.placed=!0,this.alignAttr=ue,this},O.prototype.alignSetter=function(M){var Z={left:"start",center:"middle",right:"end"};Z[M]&&(this.alignValue=M,this.element.setAttribute("text-anchor",Z[M]))},O.prototype.animate=function(M,Z,ae){var ue=this,ge=be(A(Z,this.renderer.globalAnimation,!0));return Z=ge.defer,A(K.hidden,K.msHidden,K.webkitHidden,!1)&&(ge.duration=0),0!==ge.duration?(ae&&(ge.complete=ae),T(function(){ue.element&&Se(ue,M,ge)},Z)):(this.attr(M,void 0,ae||ge.complete),z(M,function(V,$){ge.step&&ge.step.call(this,V,{prop:$,pos:1,elem:this})},this)),this},O.prototype.applyTextOutline=function(M){var Z=this.element;-1!==M.indexOf("contrast")&&(M=M.replace(/contrast/g,this.renderer.getContrast(Z.style.fill)));var ae=M.split(" ");if(M=ae[ae.length-1],(ae=ae[0])&&"none"!==ae&&Te.svg){this.fakeTS=!0,this.ySetter=this.xSetter,ae=ae.replace(/(^[\d\.]+)(.*?)$/g,function(V,$,de){return 2*Number($)+de}),this.removeTextOutline();var ue=K.createElementNS(j,"tspan");I(ue,{class:"highcharts-text-outline",fill:M,stroke:M,"stroke-width":ae,"stroke-linejoin":"round"}),M=Z.querySelector("textPath")||Z,[].forEach.call(M.childNodes,function(V){var $=V.cloneNode(!0);$.removeAttribute&&["fill","stroke","stroke-width","stroke"].forEach(function(de){return $.removeAttribute(de)}),ue.appendChild($)});var ge=0;[].forEach.call(M.querySelectorAll("text tspan"),function(V){ge+=Number(V.getAttribute("dy"))}),(ae=K.createElementNS(j,"tspan")).textContent="\u200b",I(ae,{x:Number(Z.getAttribute("x")),dy:-ge}),ue.appendChild(ae),M.insertBefore(ue,M.firstChild)}},O.prototype.attr=function(M,Z,ae,ue){var $,Me,Ie,ge=this.element,V=this.symbolCustomAttribs,de=this;if("string"==typeof M&&typeof Z<"u"){var De=M;(M={})[De]=Z}return"string"==typeof M?de=(this[M+"Getter"]||this._defaultGetter).call(this,M,ge):(z(M,function(oe,ve){Me=!1,ue||ce(this,ve),this.symbolName&&-1!==V.indexOf(ve)&&($||(this.symbolAttr(M),$=!0),Me=!0),!this.rotation||"x"!==ve&&"y"!==ve||(this.doTransform=!0),Me||((Ie=this[ve+"Setter"]||this._defaultSetter).call(this,oe,ve,ge),!this.styledMode&&this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(ve)&&this.updateShadows(ve,oe,Ie))},this),this.afterSetters()),ae&&ae.call(this),de},O.prototype.clip=function(M){return this.attr("clip-path",M?"url("+this.renderer.url+"#"+M.id+")":"none")},O.prototype.crisp=function(M,Z){Z=Z||M.strokeWidth||0;var ae=Math.round(Z)%2/2;return M.x=Math.floor(M.x||this.x||0)+ae,M.y=Math.floor(M.y||this.y||0)+ae,M.width=Math.floor((M.width||this.width||0)-2*ae),M.height=Math.floor((M.height||this.height||0)-2*ae),H(M.strokeWidth)&&(M.strokeWidth=Z),M},O.prototype.complexColor=function(M,Z,ae){var ge,V,$,de,Me,Ie,De,oe,ve,xe,we,ue=this.renderer,Re=[];te(this.renderer,"complexColor",{args:arguments},function(){if(M.radialGradient?V="radialGradient":M.linearGradient&&(V="linearGradient"),V){if(Me=ue.gradients,Ie=M.stops,ve=ae.radialReference,ee($=M[V])&&(M[V]=$={x1:$[0],y1:$[1],x2:$[2],y2:$[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===V&&ve&&!H($.gradientUnits)&&($=D($,ue.getRadialAttr(ve,de=$),{gradientUnits:"userSpaceOnUse"})),z($,function(Ne,Ze){"id"!==Ze&&Re.push(Ze,Ne)}),z(Ie,function(Ne){Re.push(Ne)}),Re=Re.join(","),Me[Re])xe=Me[Re].attr("id");else{$.id=xe=S();var Le=Me[Re]=ue.createElement(V).attr($).add(ue.defs);Le.radAttr=de,Le.stops=[],Ie.forEach(function(Ne){0===Ne[1].indexOf("rgba")?(ge=me.parse(Ne[1]),De=ge.get("rgb"),oe=ge.get("a")):(De=Ne[1],oe=1),Ne=ue.createElement("stop").attr({offset:Ne[0],"stop-color":De,"stop-opacity":oe}).add(Le),Le.stops.push(Ne)})}ae.setAttribute(Z,we="url("+ue.url+"#"+xe+")"),ae.gradient=Re,M.toString=function(){return we}}})},O.prototype.css=function(M){var Z=this.styles,ae={},ue=this.element,ge=!Z;if(M.color&&(M.fill=M.color),Z&&z(M,function(de,Me){Z&&Z[Me]!==de&&(ae[Me]=de,ge=!0)}),ge){if(Z&&(M=ie(Z,ae)),null===M.width||"auto"===M.width)delete this.textWidth;else if("text"===ue.nodeName.toLowerCase()&&M.width)var V=this.textWidth=U(M.width);this.styles=M,V&&!Y&&this.renderer.forExport&&delete M.width;var $=D(M);ue.namespaceURI===this.SVG_NS&&["textOutline","textOverflow","width"].forEach(function(de){return $&&delete $[de]}),P(ue,$),this.added&&("text"===this.element.nodeName&&this.renderer.buildText(this),M.textOutline&&this.applyTextOutline(M.textOutline))}return this},O.prototype.dashstyleSetter=function(M){var Z=this["stroke-width"];if("inherit"===Z&&(Z=1),M=M&&M.toLowerCase()){var ae=M.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(M=ae.length;M--;)ae[M]=""+U(ae[M])*A(Z,NaN);M=ae.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",M)}},O.prototype.destroy=function(){var M=this,Z=M.element||{},ae=M.renderer,ue=Z.ownerSVGElement,ge=ae.isSVG&&"SPAN"===Z.nodeName&&M.parentGroup||void 0;if(Z.onclick=Z.onmouseout=Z.onmouseover=Z.onmousemove=Z.point=null,ce(M),M.clipPath&&ue){var V=M.clipPath;[].forEach.call(ue.querySelectorAll("[clip-path],[CLIP-PATH]"),function($){-1<$.getAttribute("clip-path").indexOf(V.element.id)&&$.removeAttribute("clip-path")}),M.clipPath=V.destroy()}if(M.stops){for(ue=0;ue<M.stops.length;ue++)M.stops[ue].destroy();M.stops.length=0,M.stops=void 0}for(M.safeRemoveChild(Z),ae.styledMode||M.destroyShadows();ge&&ge.div&&0===ge.div.childNodes.length;)Z=ge.parentGroup,M.safeRemoveChild(ge.div),delete ge.div,ge=Z;M.alignTo&&W(ae.alignedObjects,M),z(M,function($,de){M[de]&&M[de].parentGroup===M&&M[de].destroy&&M[de].destroy(),delete M[de]})},O.prototype.destroyShadows=function(){(this.shadows||[]).forEach(function(M){this.safeRemoveChild(M)},this),this.shadows=void 0},O.prototype.dSetter=function(M,Z,ae){ee(M)&&("string"==typeof M[0]&&(M=this.renderer.pathToSegments(M)),this.pathArray=M,M=M.reduce(function(ue,ge,V){return ge&&ge.join?(V?ue+" ":"")+ge.join(" "):(ge||"").toString()},"")),/(NaN| {2}|^$)/.test(M)&&(M="M 0 0"),this[Z]!==M&&(ae.setAttribute(Z,M),this[Z]=M)},O.prototype.fadeOut=function(M){var Z=this;Z.animate({opacity:0},{duration:A(M,150),complete:function(){Z.hide()}})},O.prototype.fillSetter=function(M,Z,ae){"string"==typeof M?ae.setAttribute(Z,M):M&&this.complexColor(M,Z,ae)},O.prototype.getBBox=function(M,Z){var ae=this.alignValue,ue=this.element,ge=this.renderer,V=this.styles,$=this.textStr,de=ge.cache,Me=ge.cacheKeys,Ie=ue.namespaceURI===this.SVG_NS;Z=A(Z,this.rotation,0);var oe,De=ge.styledMode?ue&&O.prototype.getStyle.call(ue,"font-size"):V&&V.fontSize;if(H($)){var ve=$.toString();-1===ve.indexOf("<")&&(ve=ve.replace(/[0-9]/g,"0")),ve+=["",Z,De,this.textWidth,ae,V&&V.textOverflow,V&&V.fontWeight].join()}if(ve&&!M&&(oe=de[ve]),!oe){if(Ie||ge.forExport){try{var xe=this.fakeTS&&function(we){var Le=ue.querySelector(".highcharts-text-outline");Le&&P(Le,{display:we})};J(xe)&&xe("none"),oe=ue.getBBox?ie({},ue.getBBox()):{width:ue.offsetWidth,height:ue.offsetHeight,x:0,y:0},J(xe)&&xe("")}catch{}(!oe||0>oe.width)&&(oe={x:0,y:0,width:0,height:0})}else oe=this.htmlGetBBox();if(ge.isSVG&&(ge=oe.width,M=oe.height,Ie&&(oe.height=M={"11px,17":14,"13px,20":16}[""+(De||"")+",".concat(Math.round(M))]||M),Z)){Ie=Number(ue.getAttribute("y")||0)-oe.y,ae={right:1,center:.5}[ae||0]||0,V=Z*ne,De=(Z-90)*ne;var Re=ge*Math.cos(V);Z=ge*Math.sin(V),xe=Math.cos(De),V=Math.sin(De),Re=(xe=(De=(ge=oe.x+ae*(ge-Re)+Ie*xe)+Re)-M*xe)-Re,Z=(M=(ae=(Ie=oe.y+Ie-ae*Z+Ie*V)+Z)-M*V)-Z,oe.x=Math.min(ge,De,xe,Re),oe.y=Math.min(Ie,ae,M,Z),oe.width=Math.max(ge,De,xe,Re)-oe.x,oe.height=Math.max(Ie,ae,M,Z)-oe.y}if(ve&&(""===$||0<oe.height)){for(;250<Me.length;)delete de[Me.shift()];de[ve]||Me.push(ve),de[ve]=oe}}return oe},O.prototype.getStyle=function(M){return N.getComputedStyle(this.element||this,"").getPropertyValue(M)},O.prototype.hasClass=function(M){return-1!==(""+this.attr("class")).split(" ").indexOf(M)},O.prototype.hide=function(){return this.attr({visibility:"hidden"})},O.prototype.htmlGetBBox=function(){return{height:0,width:0,x:0,y:0}},O.prototype.init=function(M,Z){this.element="span"===Z?B(Z):K.createElementNS(this.SVG_NS,Z),this.renderer=M,te(this,"afterInit")},O.prototype.invert=function(M){return this.inverted=M,this.updateTransform(),this},O.prototype.on=function(M,Z){var ae=this.onEvents;return ae[M]&&ae[M](),ae[M]=R(this.element,M,Z),this},O.prototype.opacitySetter=function(M,Z,ae){this.opacity=M=Number(Number(M).toFixed(3)),ae.setAttribute(Z,M)},O.prototype.removeClass=function(M){return this.attr("class",(""+this.attr("class")).replace(q(M)?new RegExp("(^| )".concat(M,"( |$)")):M," ").replace(/ +/g," ").trim())},O.prototype.removeTextOutline=function(){var M=this.element.querySelector("tspan.highcharts-text-outline");M&&this.safeRemoveChild(M)},O.prototype.safeRemoveChild=function(M){var Z=M.parentNode;Z&&Z.removeChild(M)},O.prototype.setRadialReference=function(M){var Z=this.element.gradient&&this.renderer.gradients[this.element.gradient];return this.element.radialReference=M,Z&&Z.radAttr&&Z.animate(this.renderer.getRadialAttr(M,Z.radAttr)),this},O.prototype.setTextPath=function(M,Z){var ae=this;Z=D(!0,{enabled:!0,attributes:{dy:-5,startOffset:"50%",textAnchor:"middle"}},Z);var ue=this.renderer.url,ge=this.text||this,V=ge.textPath,$=Z.attributes,de=Z.enabled;return M=M||V&&V.path,V&&V.undo(),M&&de?(Z=R(ge,"afterModifyTree",function(Me){if(M&&de){var Ie=M.attr("id");Ie||M.attr("id",Ie=S());var De={x:0,y:0};H($.dx)&&(De.dx=$.dx,delete $.dx),H($.dy)&&(De.dy=$.dy,delete $.dy),ge.attr(De),ae.attr({transform:""}),ae.box&&(ae.box=ae.box.destroy()),De=Me.nodes.slice(0),Me.nodes.length=0,Me.nodes[0]={tagName:"textPath",attributes:ie($,{"text-anchor":$.textAnchor,href:""+ue+"#".concat(Ie)}),children:De}}}),ge.textPath={path:M,undo:Z}):(ge.attr({dx:0,dy:0}),delete ge.textPath),this.added&&(ge.textCache="",this.renderer.buildText(ge)),this},O.prototype.shadow=function(M,Z,ae){var Me,ue=[],ge=this.element,V=this.oldShadowOptions,$={color:"#000000",offsetX:this.parentInverted?-1:1,offsetY:this.parentInverted?-1:1,opacity:.15,width:3},de=!1;if(!0===M?Me=$:"object"==typeof M&&(Me=ie($,M)),Me&&(Me&&V&&z(Me,function(xe,Re){xe!==V[Re]&&(de=!0)}),de&&this.destroyShadows(),this.oldShadowOptions=Me),Me){if(!this.shadows){var Ie=Me.opacity/Me.width,De=this.parentInverted?"translate(".concat(Me.offsetY,", ").concat(Me.offsetX,")"):"translate(".concat(Me.offsetX,", ").concat(Me.offsetY,")");for($=1;$<=Me.width;$++){var oe=ge.cloneNode(!1),ve=2*Me.width+1-2*$;I(oe,{stroke:M.color||"#000000","stroke-opacity":Ie*$,"stroke-width":ve,transform:De,fill:"none"}),oe.setAttribute("class",(oe.getAttribute("class")||"")+" highcharts-shadow"),ae&&(I(oe,"height",Math.max(I(oe,"height")-ve,0)),oe.cutHeight=ve),Z?Z.element.appendChild(oe):ge.parentNode&&ge.parentNode.insertBefore(oe,ge),ue.push(oe)}this.shadows=ue}}else this.destroyShadows();return this},O.prototype.show=function(M){return void 0===M&&(M=!0),this.attr({visibility:M?"inherit":"visible"})},O.prototype.strokeSetter=function(M,Z,ae){this[Z]=M,this.stroke&&this["stroke-width"]?(O.prototype.fillSetter.call(this,this.stroke,"stroke",ae),ae.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0):"stroke-width"===Z&&0===M&&this.hasStroke?(ae.removeAttribute("stroke"),this.hasStroke=!1):this.renderer.styledMode&&this["stroke-width"]&&(ae.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0)},O.prototype.strokeWidth=function(){if(!this.renderer.styledMode)return this["stroke-width"]||0;var M=this.getStyle("stroke-width"),Z=0;if(M.indexOf("px")===M.length-2)Z=U(M);else if(""!==M){var ae=K.createElementNS(j,"rect");I(ae,{width:M,"stroke-width":0}),this.element.parentNode.appendChild(ae),Z=ae.getBBox().width,ae.parentNode.removeChild(ae)}return Z},O.prototype.symbolAttr=function(M){var Z=this;"x y r start end width height innerR anchorX anchorY clockwise".split(" ").forEach(function(ae){Z[ae]=A(M[ae],Z[ae])}),Z.attr({d:Z.renderer.symbols[Z.symbolName](Z.x,Z.y,Z.width,Z.height,Z)})},O.prototype.textSetter=function(M){M!==this.textStr&&(delete this.textPxLength,this.textStr=M,this.added&&this.renderer.buildText(this))},O.prototype.titleSetter=function(M){var Z=this.element,ae=Z.getElementsByTagName("title")[0]||K.createElementNS(this.SVG_NS,"title");Z.insertBefore?Z.insertBefore(ae,Z.firstChild):Z.appendChild(ae),ae.textContent=String(A(M,"")).replace(/<[^>]*>/g,"").replace(/&lt;/g,"<").replace(/&gt;/g,">")},O.prototype.toFront=function(){var M=this.element;return M.parentNode.appendChild(M),this},O.prototype.translate=function(M,Z){return this.attr({translateX:M,translateY:Z})},O.prototype.updateShadows=function(M,Z,ae){var ue=this.shadows;if(ue)for(var ge=ue.length;ge--;)ae.call(ue[ge],"height"===M?Math.max(Z-(ue[ge].cutHeight||0),0):"d"===M?this.d:Z,M,ue[ge])},O.prototype.updateTransform=function(){var M=this.scaleX,Z=this.scaleY,ae=this.inverted,ue=this.rotation,ge=this.matrix,V=this.element,$=this.translateX||0,de=this.translateY||0;ae&&($+=this.width,de+=this.height),$=["translate("+$+","+de+")"],H(ge)&&$.push("matrix("+ge.join(",")+")"),ae?$.push("rotate(90) scale(-1,1)"):ue&&$.push("rotate("+ue+" "+A(this.rotationOriginX,V.getAttribute("x"),0)+" "+A(this.rotationOriginY,V.getAttribute("y")||0)+")"),(H(M)||H(Z))&&$.push("scale("+A(M,1)+" "+A(Z,1)+")"),$.length&&!(this.text||this).textPath&&V.setAttribute("transform",$.join(" "))},O.prototype.visibilitySetter=function(M,Z,ae){"inherit"===M?ae.removeAttribute(Z):this[Z]!==M&&ae.setAttribute(Z,M),this[Z]=M},O.prototype.xGetter=function(M){return"circle"===this.element.nodeName&&("x"===M?M="cx":"y"===M&&(M="cy")),this._defaultGetter(M)},O.prototype.zIndexSetter=function(M,Z){var ae=this.renderer,ue=this.parentGroup,ge=(ue||ae).element||ae.box,V=this.element;ae=ge===ae.box;var Me,$=!1,de=this.added;if(H(M)?(V.setAttribute("data-z-index",M),this[Z]===(M=+M)&&(de=!1)):H(this[Z])&&V.removeAttribute("data-z-index"),this[Z]=M,de){for((M=this.zIndex)&&ue&&(ue.handleZ=!0),Me=(Z=ge.childNodes).length-1;0<=Me&&!$;Me--){de=(ue=Z[Me]).getAttribute("data-z-index");var Ie=!H(de);ue!==V&&(0>M&&Ie&&!ae&&!Me?(ge.insertBefore(V,Z[Me]),$=!0):(U(de)<=M||Ie&&(!H(M)||0<=M))&&(ge.insertBefore(V,Z[Me+1]||null),$=!0))}$||(ge.insertBefore(V,Z[ae?3:0]||null),$=!0)}return $},O}(),re.prototype["stroke-widthSetter"]=re.prototype.strokeSetter,re.prototype.yGetter=re.prototype.xGetter,re.prototype.matrixSetter=re.prototype.rotationOriginXSetter=re.prototype.rotationOriginYSetter=re.prototype.rotationSetter=re.prototype.scaleXSetter=re.prototype.scaleYSetter=re.prototype.translateXSetter=re.prototype.translateYSetter=re.prototype.verticalAlignSetter=function(O,M){this[M]=O,this.doTransform=!0},re}),Ge(u,"Core/Renderer/RendererRegistry.js",[u["Core/Globals.js"]],function(re){var me,Te,Ce;return(Te=me||(me={})).rendererTypes={},Te.getRendererType=function(Se){return void 0===Se&&(Se=Ce),Te.rendererTypes[Se]||Te.rendererTypes[Ce]},Te.registerRendererType=function(Se,be,ce){Te.rendererTypes[Se]=be,(!Ce||ce)&&(Ce=Se,re.Renderer=be)},me}),Ge(u,"Core/Renderer/SVG/SVGLabel.js",[u["Core/Renderer/SVG/SVGElement.js"],u["Core/Utilities.js"]],function(re,me){var Y,Te=this&&this.__extends||(Y=function(j,N){return(Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,I){R.__proto__=I}||function(R,I){for(var B in I)I.hasOwnProperty(B)&&(R[B]=I[B])})(j,N)},function(j,N){function R(){this.constructor=j}Y(j,N),j.prototype=null===N?Object.create(N):(R.prototype=N.prototype,new R)}),Ce=me.defined,Se=me.extend,be=me.isNumber,ce=me.merge,ne=me.pick,K=me.removeEvent;return function(Y){function j(N,R,I,B,P,H,W,ie,te,ee){var q,J=Y.call(this)||this;return J.paddingLeftSetter=J.paddingSetter,J.paddingRightSetter=J.paddingSetter,J.init(N,"g"),J.textStr=R,J.x=I,J.y=B,J.anchorX=H,J.anchorY=W,J.baseline=te,J.className=ee,J.addClass("button"===ee?"highcharts-no-tooltip":"highcharts-label"),ee&&J.addClass("highcharts-"+ee),J.text=N.text(void 0,0,0,ie).attr({zIndex:1}),"string"==typeof P&&((q=/^url\((.*?)\)$/.test(P))||J.renderer.symbols[P])&&(J.symbolKey=P),J.bBox=j.emptyBBox,J.padding=3,J.baselineOffset=0,J.needsBox=N.styledMode||q,J.deferredAttr={},J.alignFactor=0,J}return Te(j,Y),j.prototype.alignSetter=function(N){(N={left:0,center:.5,right:1}[N])!==this.alignFactor&&(this.alignFactor=N,this.bBox&&be(this.xSetting)&&this.attr({x:this.xSetting}))},j.prototype.anchorXSetter=function(N,R){this.anchorX=N,this.boxAttr(R,Math.round(N)-this.getCrispAdjust()-this.xSetting)},j.prototype.anchorYSetter=function(N,R){this.anchorY=N,this.boxAttr(R,N-this.ySetting)},j.prototype.boxAttr=function(N,R){this.box?this.box.attr(N,R):this.deferredAttr[N]=R},j.prototype.css=function(N){if(N){var R={};N=ce(N),j.textProps.forEach(function(B){typeof N[B]<"u"&&(R[B]=N[B],delete N[B])}),this.text.css(R);var I="width"in R;"fontSize"in R||"fontWeight"in R?this.updateTextPadding():I&&this.updateBoxSize()}return re.prototype.css.call(this,N)},j.prototype.destroy=function(){K(this.element,"mouseenter"),K(this.element,"mouseleave"),this.text&&this.text.destroy(),this.box&&(this.box=this.box.destroy()),re.prototype.destroy.call(this)},j.prototype.fillSetter=function(N,R){N&&(this.needsBox=!0),this.fill=N,this.boxAttr(R,N)},j.prototype.getBBox=function(){this.textStr&&0===this.bBox.width&&0===this.bBox.height&&this.updateBoxSize();var N=this.padding,R=ne(this.paddingLeft,N);return{width:this.width,height:this.height,x:this.bBox.x-R,y:this.bBox.y-N}},j.prototype.getCrispAdjust=function(){return this.renderer.styledMode&&this.box?this.box.strokeWidth()%2/2:(this["stroke-width"]?parseInt(this["stroke-width"],10):0)%2/2},j.prototype.heightSetter=function(N){this.heightSetting=N},j.prototype.onAdd=function(){var N=this.textStr;this.text.add(this),this.attr({text:Ce(N)?N:"",x:this.x,y:this.y}),this.box&&Ce(this.anchorX)&&this.attr({anchorX:this.anchorX,anchorY:this.anchorY})},j.prototype.paddingSetter=function(N,R){be(N)?N!==this[R]&&(this[R]=N,this.updateTextPadding()):this[R]=void 0},j.prototype.rSetter=function(N,R){this.boxAttr(R,N)},j.prototype.shadow=function(N){return N&&!this.renderer.styledMode&&(this.updateBoxSize(),this.box&&this.box.shadow(N)),this},j.prototype.strokeSetter=function(N,R){this.stroke=N,this.boxAttr(R,N)},j.prototype["stroke-widthSetter"]=function(N,R){N&&(this.needsBox=!0),this["stroke-width"]=N,this.boxAttr(R,N)},j.prototype["text-alignSetter"]=function(N){this.textAlign=N},j.prototype.textSetter=function(N){typeof N<"u"&&this.text.attr({text:N}),this.updateTextPadding()},j.prototype.updateBoxSize=function(){var N=this.text,R=N.element.style,I={},B=this.padding,P=this.bBox=be(this.widthSetting)&&be(this.heightSetting)&&!this.textAlign||!Ce(N.textStr)?j.emptyBBox:N.getBBox();this.width=this.getPaddedWidth(),this.height=(this.heightSetting||P.height||0)+2*B,R=this.renderer.fontMetrics(R&&R.fontSize,N),this.baselineOffset=B+Math.min((this.text.firstLineMetrics||R).b,P.height||1/0),this.heightSetting&&(this.baselineOffset+=(this.heightSetting-R.h)/2),this.needsBox&&!N.textPath&&(this.box||((N=this.box=this.symbolKey?this.renderer.symbol(this.symbolKey):this.renderer.rect()).addClass(("button"===this.className?"":"highcharts-label-box")+(this.className?" highcharts-"+this.className+"-box":"")),N.add(this)),N=this.getCrispAdjust(),I.x=N,I.y=(this.baseline?-this.baselineOffset:0)+N,I.width=Math.round(this.width),I.height=Math.round(this.height),this.box.attr(Se(I,this.deferredAttr)),this.deferredAttr={})},j.prototype.updateTextPadding=function(){var N=this.text;if(!N.textPath){this.updateBoxSize();var R=this.baseline?0:this.baselineOffset,I=ne(this.paddingLeft,this.padding);Ce(this.widthSetting)&&this.bBox&&("center"===this.textAlign||"right"===this.textAlign)&&(I+={center:.5,right:1}[this.textAlign]*(this.widthSetting-this.bBox.width)),(I!==N.x||R!==N.y)&&(N.attr("x",I),N.hasBoxWidthChanged&&(this.bBox=N.getBBox(!0)),typeof R<"u"&&N.attr("y",R)),N.x=I,N.y=R}},j.prototype.widthSetter=function(N){this.widthSetting=be(N)?N:void 0},j.prototype.getPaddedWidth=function(){var N=this.padding,R=ne(this.paddingLeft,N);return N=ne(this.paddingRight,N),(this.widthSetting||this.bBox.width||0)+R+N},j.prototype.xSetter=function(N){this.x=N,this.alignFactor&&(N-=this.alignFactor*this.getPaddedWidth(),this["forceAnimate:x"]=!0),this.xSetting=Math.round(N),this.attr("translateX",this.xSetting)},j.prototype.ySetter=function(N){this.ySetting=this.y=Math.round(N),this.attr("translateY",this.ySetting)},j.emptyBBox={width:0,height:0,x:0,y:0},j.textProps="color direction fontFamily fontSize fontStyle fontWeight lineHeight textAlign textDecoration textOutline textOverflow width".split(" "),j}(re)}),Ge(u,"Core/Renderer/SVG/Symbols.js",[u["Core/Utilities.js"]],function(re){function me(ne,K,Y,j,N){var R=[];if(N){var I=N.start||0,B=ce(N.r,Y);Y=ce(N.r,j||Y);var P=(N.end||0)-.001;j=N.innerR;var H=ce(N.open,.001>Math.abs((N.end||0)-I-2*Math.PI)),W=Math.cos(I),ie=Math.sin(I),te=Math.cos(P),ee=Math.sin(P);I=ce(N.longArc,.001>P-I-Math.PI?0:1),R.push(["M",ne+B*W,K+Y*ie],["A",B,Y,0,I,ce(N.clockwise,1),ne+B*te,K+Y*ee]),Se(j)&&R.push(H?["M",ne+j*te,K+j*ee]:["L",ne+j*te,K+j*ee],["A",j,j,0,I,Se(N.clockwise)?1-N.clockwise:0,ne+j*W,K+j*ie]),H||R.push(["Z"])}return R}function Te(ne,K,Y,j,N){return N&&N.r?Ce(ne,K,Y,j,N):[["M",ne,K],["L",ne+Y,K],["L",ne+Y,K+j],["L",ne,K+j],["Z"]]}function Ce(ne,K,Y,j,N){return[["M",ne+(N=N&&N.r||0),K],["L",ne+Y-N,K],["C",ne+Y,K,ne+Y,K,ne+Y,K+N],["L",ne+Y,K+j-N],["C",ne+Y,K+j,ne+Y,K+j,ne+Y-N,K+j],["L",ne+N,K+j],["C",ne,K+j,ne,K+j,ne,K+j-N],["L",ne,K+N],["C",ne,K,ne,K,ne+N,K]]}var Se=re.defined,be=re.isNumber,ce=re.pick;return{arc:me,callout:function(ne,K,Y,j,N){var R=Math.min(N&&N.r||0,Y,j),I=R+6,B=N&&N.anchorX;N=N&&N.anchorY||0;var P=Ce(ne,K,Y,j,{r:R});return be(B)&&(ne+B>=Y?N>K+I&&N<K+j-I?P.splice(3,1,["L",ne+Y,N-6],["L",ne+Y+6,N],["L",ne+Y,N+6],["L",ne+Y,K+j-R]):P.splice(3,1,["L",ne+Y,j/2],["L",B,N],["L",ne+Y,j/2],["L",ne+Y,K+j-R]):0>=ne+B?N>K+I&&N<K+j-I?P.splice(7,1,["L",ne,N+6],["L",ne-6,N],["L",ne,N-6],["L",ne,K+R]):P.splice(7,1,["L",ne,j/2],["L",B,N],["L",ne,j/2],["L",ne,K+R]):N&&N>j&&B>ne+I&&B<ne+Y-I?P.splice(5,1,["L",B+6,K+j],["L",B,K+j+6],["L",B-6,K+j],["L",ne+R,K+j]):N&&0>N&&B>ne+I&&B<ne+Y-I&&P.splice(1,1,["L",B-6,K],["L",B,K-6],["L",B+6,K],["L",Y-R,K])),P},circle:function(ne,K,Y,j){return me(ne+Y/2,K+j/2,Y/2,j/2,{start:.5*Math.PI,end:2.5*Math.PI,open:!1})},diamond:function(ne,K,Y,j){return[["M",ne+Y/2,K],["L",ne+Y,K+j/2],["L",ne+Y/2,K+j],["L",ne,K+j/2],["Z"]]},rect:Te,roundedRect:Ce,square:Te,triangle:function(ne,K,Y,j){return[["M",ne+Y/2,K],["L",ne+Y,K+j],["L",ne,K+j],["Z"]]},"triangle-down":function(ne,K,Y,j){return[["M",ne,K],["L",ne+Y,K],["L",ne+Y/2,K+j],["Z"]]}}}),Ge(u,"Core/Renderer/SVG/TextBuilder.js",[u["Core/Renderer/HTML/AST.js"],u["Core/Globals.js"],u["Core/Utilities.js"]],function(re,me,Te){var Ce=me.doc,Se=me.SVG_NS,be=me.win,ce=Te.attr,ne=Te.extend,K=Te.fireEvent,Y=Te.isString,j=Te.objectEach,N=Te.pick;return function(){function R(I){var B=I.styles;this.renderer=I.renderer,this.svgElement=I,this.width=I.textWidth,this.textLineHeight=B&&B.lineHeight,this.textOutline=B&&B.textOutline,this.ellipsis=!(!B||"ellipsis"!==B.textOverflow),this.noWrap=!(!B||"nowrap"!==B.whiteSpace),this.fontSize=B&&B.fontSize}return R.prototype.buildSVG=function(){var I=this.svgElement,B=I.element,P=I.renderer,H=N(I.textStr,"").toString(),W=-1!==H.indexOf("<"),ie=B.childNodes;P=this.width&&!I.added&&P.box;var ee=[H,this.ellipsis,this.noWrap,this.textLineHeight,this.textOutline,this.fontSize,this.width].join();if(ee!==I.textCache){for(I.textCache=ee,delete I.actualWidth,ee=ie.length;ee--;)B.removeChild(ie[ee]);W||this.ellipsis||this.width||I.textPath||-1!==H.indexOf(" ")&&(!this.noWrap||/<br.*?>/g.test(H))?""!==H&&(P&&P.appendChild(B),H=new re(H),this.modifyTree(H.nodes),H.addToDOM(B),this.modifyDOM(),this.ellipsis&&-1!==(B.textContent||"").indexOf("\u2026")&&I.attr("title",this.unescapeEntities(I.textStr||"",["&lt;","&gt;"])),P&&P.removeChild(B)):B.appendChild(Ce.createTextNode(this.unescapeEntities(H))),Y(this.textOutline)&&I.applyTextOutline&&I.applyTextOutline(this.textOutline)}},R.prototype.modifyDOM=function(){var H,I=this,B=this.svgElement,P=ce(B.element,"x");for(B.firstLineMetrics=void 0;(H=B.element.firstChild)&&/^[\s\u200B]*$/.test(H.textContent||" ");)B.element.removeChild(H);[].forEach.call(B.element.querySelectorAll("tspan.highcharts-br"),function(ee,J){ee.nextSibling&&ee.previousSibling&&(0===J&&1===ee.previousSibling.nodeType&&(B.firstLineMetrics=B.renderer.fontMetrics(void 0,ee.previousSibling)),ce(ee,{dy:I.getLineHeight(ee.nextSibling),x:P}))});var W=this.width||0;if(W){var te=function(ee){[].slice.call(ee.childNodes).forEach(function(J){J.nodeType===be.Node.TEXT_NODE?function(ee,J){var q=ee.textContent||"",D=q.replace(/([^\^])-/g,"$1- ").split(" "),z=!I.noWrap&&(1<D.length||1<B.element.childNodes.length),A=I.getLineHeight(J),U=0,T=B.actualWidth;if(I.ellipsis)q&&I.truncate(ee,q,void 0,0,Math.max(0,W-parseInt(I.fontSize||12,10)),function(S,O){return S.substring(0,O)+"\u2026"});else if(z){for(q=[],z=[];J.firstChild&&J.firstChild!==ee;)z.push(J.firstChild),J.removeChild(J.firstChild);for(;D.length;)D.length&&!I.noWrap&&0<U&&(q.push(ee.textContent||""),ee.textContent=D.join(" ").replace(/- /g,"-")),I.truncate(ee,void 0,D,0===U&&T||0,W,function(S,O){return D.slice(0,O).join(" ").replace(/- /g,"-")}),T=B.actualWidth,U++;z.forEach(function(S){J.insertBefore(S,ee)}),q.forEach(function(S){J.insertBefore(Ce.createTextNode(S),ee),(S=Ce.createElementNS(Se,"tspan")).textContent="\u200b",ce(S,{dy:A,x:P}),J.insertBefore(S,ee)})}}(J,ee):(-1!==J.className.baseVal.indexOf("highcharts-br")&&(B.actualWidth=0),te(J))})};te(B.element)}},R.prototype.getLineHeight=function(I){var B;return I=I.nodeType===be.Node.TEXT_NODE?I.parentElement:I,this.renderer.styledMode||(B=I&&/(px|em)$/.test(I.style.fontSize)?I.style.fontSize:this.fontSize||this.renderer.style.fontSize||12),this.textLineHeight?parseInt(this.textLineHeight.toString(),10):this.renderer.fontMetrics(B,I||this.svgElement.element).h},R.prototype.modifyTree=function(I){var B=this,P=function(H,W){var ie=H.attributes;ie=void 0===ie?{}:ie;var te=H.children,ee=H.style;ee=void 0===ee?{}:ee;var J=H.tagName,q=B.renderer.styledMode;"b"===J||"strong"===J?q?ie.class="highcharts-strong":ee.fontWeight="bold":("i"===J||"em"===J)&&(q?ie.class="highcharts-emphasized":ee.fontStyle="italic"),ee&&ee.color&&(ee.fill=ee.color),"br"===J?(ie.class="highcharts-br",H.textContent="\u200b",(W=I[W+1])&&W.textContent&&(W.textContent=W.textContent.replace(/^ +/gm,""))):"a"===J&&te&&te.some(function(D){return"#text"===D.tagName})&&(H.children=[{children:te,tagName:"tspan"}]),"#text"!==J&&"a"!==J&&(H.tagName="tspan"),ne(H,{attributes:ie,style:ee}),te&&te.filter(function(D){return"#text"!==D.tagName}).forEach(P)};I.forEach(P),K(this.svgElement,"afterModifyTree",{nodes:I})},R.prototype.truncate=function(I,B,P,H,W,ie){var U,te=this.svgElement,ee=te.renderer,J=te.rotation,q=[],D=P?1:0,z=(B||P||"").length,A=z,T=function(O,M){M=M||O;var Z=I.parentNode;if(Z&&typeof q[M]>"u")if(Z.getSubStringLength)try{q[M]=H+Z.getSubStringLength(0,P?M+1:M)}catch{}else ee.getSpanWidth&&(I.textContent=ie(B||P,O),q[M]=H+ee.getSpanWidth(te,I));return q[M]};te.rotation=0;var S=T(I.textContent.length);if(H+S>W){for(;D<=z;)A=Math.ceil((D+z)/2),P&&(U=ie(P,A)),S=T(A,U&&U.length-1),D===z?D=z+1:S>W?z=A-1:D=A;0===z?I.textContent="":B&&z===B.length-1||(I.textContent=U||ie(B||P,A))}P&&P.splice(0,A),te.actualWidth=S,te.rotation=J},R.prototype.unescapeEntities=function(I,B){return j(this.renderer.escapes,function(P,H){B&&-1!==B.indexOf(P)||(I=I.toString().replace(new RegExp(P,"g"),H))}),I},R}()}),Ge(u,"Core/Renderer/SVG/SVGRenderer.js",[u["Core/Renderer/HTML/AST.js"],u["Core/Color/Color.js"],u["Core/Globals.js"],u["Core/Renderer/RendererRegistry.js"],u["Core/Renderer/SVG/SVGElement.js"],u["Core/Renderer/SVG/SVGLabel.js"],u["Core/Renderer/SVG/Symbols.js"],u["Core/Renderer/SVG/TextBuilder.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce,Se,be,ce,ne,K){var ge,Y=Te.charts,j=Te.deg2rad,N=Te.doc,R=Te.isFirefox,I=Te.isMS,B=Te.isWebKit,P=Te.noop,H=Te.SVG_NS,W=Te.symbolSizes,ie=Te.win,te=K.addEvent,ee=K.attr,J=K.createElement,q=K.css,D=K.defined,z=K.destroyObjectProperties,A=K.extend,U=K.isArray,T=K.isNumber,S=K.isObject,O=K.isString,M=K.merge,Z=K.pick,ae=K.pInt,ue=K.uniqueKey;return Te=function(){function V($,de,Me,Ie,De,oe,ve){this.width=this.url=this.style=this.isSVG=this.imgCount=this.height=this.gradients=this.globalAnimation=this.defs=this.chartIndex=this.cacheKeys=this.cache=this.boxWrapper=this.box=this.alignedObjects=void 0,this.init($,de,Me,Ie,De,oe,ve)}return V.prototype.init=function($,de,Me,Ie,De,oe,ve){var we,xe=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}),Re=xe.element;ve||xe.css(this.getStyle(Ie)),$.appendChild(Re),ee($,"dir","ltr"),-1===$.innerHTML.indexOf("xmlns")&&ee(Re,"xmlns",this.SVG_NS),this.isSVG=!0,this.box=Re,this.boxWrapper=xe,this.alignedObjects=[],this.url=this.getReferenceURL(),this.createElement("desc").add().element.appendChild(N.createTextNode("Created with Highcharts 10.2.1")),this.defs=this.createElement("defs").add(),this.allowHTML=oe,this.forExport=De,this.styledMode=ve,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.setSize(de,Me,!1),R&&$.getBoundingClientRect&&((de=function(){q($,{left:0,top:0}),we=$.getBoundingClientRect(),q($,{left:Math.ceil(we.left)-we.left+"px",top:Math.ceil(we.top)-we.top+"px"})})(),this.unSubPixelFix=te(ie,"resize",de))},V.prototype.definition=function($){return new re([$]).addToDOM(this.defs.element)},V.prototype.getReferenceURL=function(){if((R||B)&&N.getElementsByTagName("base").length){if(!D(ge)){var $=ue();$=new re([{tagName:"svg",attributes:{width:8,height:8},children:[{tagName:"defs",children:[{tagName:"clipPath",attributes:{id:$},children:[{tagName:"rect",attributes:{width:4,height:4}}]}]},{tagName:"rect",attributes:{id:"hitme",width:8,height:8,"clip-path":"url(#".concat($,")"),fill:"rgba(0,0,0,0.001)"}}]}]).addToDOM(N.body),q($,{position:"fixed",top:0,left:0,zIndex:9e5});var de=N.elementFromPoint(6,6);ge="hitme"===(de&&de.id),N.body.removeChild($)}if(ge)return ie.location.href.split("#")[0].replace(/<[^>]*>/g,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20")}return""},V.prototype.getStyle=function($){return this.style=A({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},$)},V.prototype.setStyle=function($){this.boxWrapper.css(this.getStyle($))},V.prototype.isHidden=function(){return!this.boxWrapper.getBBox().width},V.prototype.destroy=function(){var $=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),z(this.gradients||{}),this.gradients=null,$&&(this.defs=$.destroy()),this.unSubPixelFix&&this.unSubPixelFix(),this.alignedObjects=null},V.prototype.createElement=function($){var de=new this.Element;return de.init(this,$),de},V.prototype.getRadialAttr=function($,de){return{cx:$[0]-$[2]/2+(de.cx||0)*$[2],cy:$[1]-$[2]/2+(de.cy||0)*$[2],r:(de.r||0)*$[2]}},V.prototype.buildText=function($){new ne($).buildSVG()},V.prototype.getContrast=function($){return 1.05/(.05+($=.2126*($=me.parse($).rgba.map(function(de){return.03928>=(de/=255)?de/12.92:Math.pow((de+.055)/1.055,2.4)}))[0]+.7152*$[1]+.0722*$[2]))>($+.05)/.05?"#FFFFFF":"#000000"},V.prototype.button=function($,de,Me,Ie,De,oe,ve,xe,Re,we){void 0===De&&(De={});var Le=this.label($,de,Me,Re,void 0,void 0,we,void 0,"button"),Ne=this.styledMode;$=De.states||{};var Ze=0;delete(De=M(De)).states;var at=M({color:"#333333",cursor:"pointer",fontWeight:"normal"},De.style);delete De.style;var wt=re.filterUserAttributes(De);if(Le.attr(M({padding:8,r:2},wt)),!Ne){wt=M({fill:"#f7f7f7",stroke:"#cccccc","stroke-width":1},wt);var Tt=(oe=M(wt,{fill:"#e6e6e6"},re.filterUserAttributes(oe||$.hover||{}))).style;delete oe.style;var Ut=(ve=M(wt,{fill:"#e6ebf5",style:{color:"#000000",fontWeight:"bold"}},re.filterUserAttributes(ve||$.select||{}))).style;delete ve.style;var bt=(xe=M(wt,{style:{color:"#cccccc"}},re.filterUserAttributes(xe||$.disabled||{}))).style;delete xe.style}return te(Le.element,I?"mouseover":"mouseenter",function(){3!==Ze&&Le.setState(1)}),te(Le.element,I?"mouseout":"mouseleave",function(){3!==Ze&&Le.setState(Ze)}),Le.setState=function(lt){1!==lt&&(Le.state=Ze=lt),Le.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][lt||0]),Ne||(Le.attr([wt,oe,ve,xe][lt||0]),S(lt=[at,Tt,Ut,bt][lt||0])&&Le.css(lt))},Ne||Le.attr(wt).css(A({cursor:"default"},at)),Le.on("touchstart",function(lt){return lt.stopPropagation()}).on("click",function(lt){3!==Ze&&Ie.call(Le,lt)})},V.prototype.crispLine=function($,de,Me){void 0===Me&&(Me="round");var Ie=$[0],De=$[1];return D(Ie[1])&&Ie[1]===De[1]&&(Ie[1]=De[1]=Math[Me](Ie[1])-de%2/2),D(Ie[2])&&Ie[2]===De[2]&&(Ie[2]=De[2]=Math[Me](Ie[2])+de%2/2),$},V.prototype.path=function($){var de=this.styledMode?{}:{fill:"none"};return U($)?de.d=$:S($)&&A(de,$),this.createElement("path").attr(de)},V.prototype.circle=function($,de,Me){return $=S($)?$:typeof $>"u"?{}:{x:$,y:de,r:Me},(de=this.createElement("circle")).xSetter=de.ySetter=function(Ie,De,oe){oe.setAttribute("c"+De,Ie)},de.attr($)},V.prototype.arc=function($,de,Me,Ie,De,oe){return S($)?(de=(Ie=$).y,Me=Ie.r,$=Ie.x):Ie={innerR:Ie,start:De,end:oe},($=this.symbol("arc",$,de,Me,Me,Ie)).r=Me,$},V.prototype.rect=function($,de,Me,Ie,De,oe){De=S($)?$.r:De;var ve=this.createElement("rect");return $=S($)?$:typeof $>"u"?{}:{x:$,y:de,width:Math.max(Me,0),height:Math.max(Ie,0)},this.styledMode||(typeof oe<"u"&&($["stroke-width"]=oe,$=ve.crisp($)),$.fill="none"),De&&($.r=De),ve.rSetter=function(xe,Re,we){ve.r=xe,ee(we,{rx:xe,ry:xe})},ve.rGetter=function(){return ve.r||0},ve.attr($)},V.prototype.setSize=function($,de,Me){this.width=$,this.height=de,this.boxWrapper.animate({width:$,height:de},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:Z(Me,!0)?void 0:0}),this.alignElements()},V.prototype.g=function($){var de=this.createElement("g");return $?de.attr({class:"highcharts-"+$}):de},V.prototype.image=function($,de,Me,Ie,De,oe){var ve={preserveAspectRatio:"none"},xe=function(we,Le){we.setAttributeNS?we.setAttributeNS("http://www.w3.org/1999/xlink","href",Le):we.setAttribute("hc-svg-href",Le)};T(de)&&(ve.x=de),T(Me)&&(ve.y=Me),T(Ie)&&(ve.width=Ie),T(De)&&(ve.height=De);var Re=this.createElement("image").attr(ve);return de=function(we){xe(Re.element,$),oe.call(Re,we)},oe?(xe(Re.element,"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),Me=new ie.Image,te(Me,"load",de),Me.src=$,Me.complete&&de({})):xe(Re.element,$),Re},V.prototype.symbol=function($,de,Me,Ie,De,oe){var Ne,ve=this,xe=/^url\((.*?)\)$/,Re=xe.test($),we=!Re&&(this.symbols[$]?$:"circle"),Le=we&&this.symbols[we];if(Le){"number"==typeof de&&(Ne=Le.call(this.symbols,Math.round(de||0),Math.round(Me||0),Ie||0,De||0,oe));var Ze=this.path(Ne);ve.styledMode||Ze.attr("fill","none"),A(Ze,{symbolName:we||void 0,x:de,y:Me,width:Ie,height:De}),oe&&A(Ze,oe)}else if(Re){var at=$.match(xe)[1],wt=Ze=this.image(at);wt.imgwidth=Z(W[at]&&W[at].width,oe&&oe.width),wt.imgheight=Z(W[at]&&W[at].height,oe&&oe.height);var Tt=function(Ut){return Ut.attr({width:Ut.width,height:Ut.height})};["width","height"].forEach(function(Ut){wt[Ut+"Setter"]=function(bt,lt){var Pe=this["img"+lt];this[lt]=bt,D(Pe)&&(oe&&"within"===oe.backgroundSize&&this.width&&this.height&&(Pe=Math.round(Pe*Math.min(this.width/this.imgwidth,this.height/this.imgheight))),this.element&&this.element.setAttribute(lt,Pe),this.alignByTranslate||(bt=((this[lt]||0)-Pe)/2,this.attr("width"===lt?{translateX:bt}:{translateY:bt})))}}),D(de)&&wt.attr({x:de,y:Me}),wt.isImg=!0,D(wt.imgwidth)&&D(wt.imgheight)?Tt(wt):(wt.attr({width:0,height:0}),J("img",{onload:function(){var Ut=Y[ve.chartIndex];0===this.width&&(q(this,{position:"absolute",top:"-999em"}),N.body.appendChild(this)),W[at]={width:this.width,height:this.height},wt.imgwidth=this.width,wt.imgheight=this.height,wt.element&&Tt(wt),this.parentNode&&this.parentNode.removeChild(this),ve.imgCount--,!ve.imgCount&&Ut&&!Ut.hasLoaded&&Ut.onload()},src:at}),this.imgCount++)}return Ze},V.prototype.clipRect=function($,de,Me,Ie){var De=ue()+"-",oe=this.createElement("clipPath").attr({id:De}).add(this.defs);return($=this.rect($,de,Me,Ie,0).add(oe)).id=De,$.clipPath=oe,$.count=0,$},V.prototype.text=function($,de,Me,Ie){var De={};return!Ie||!this.allowHTML&&this.forExport?(De.x=Math.round(de||0),Me&&(De.y=Math.round(Me)),D($)&&(De.text=$),$=this.createElement("text").attr(De),(!Ie||this.forExport&&!this.allowHTML)&&($.xSetter=function(oe,ve,xe){for(var Ne,Re=xe.getElementsByTagName("tspan"),we=xe.getAttribute(ve),Le=0;Le<Re.length;Le++)(Ne=Re[Le]).getAttribute(ve)===we&&Ne.setAttribute(ve,oe);xe.setAttribute(ve,oe)}),$):this.html($,de,Me)},V.prototype.fontMetrics=function($,de){return $=!this.styledMode&&/px/.test($)||!ie.getComputedStyle?$||de&&de.style&&de.style.fontSize||this.style&&this.style.fontSize:de&&Se.prototype.getStyle.call(de,"font-size"),{h:de=24>($=/px/.test($)?ae($):12)?$+3:Math.round(1.2*$),b:Math.round(.8*de),f:$}},V.prototype.rotCorr=function($,de,Me){var Ie=$;return de&&Me&&(Ie=Math.max(Ie*Math.cos(de*j),4)),{x:-$/3*Math.sin(de*j),y:Ie}},V.prototype.pathToSegments=function($){for(var de=[],Me=[],Ie={A:8,C:7,H:2,L:3,M:3,Q:5,S:5,T:3,V:2},De=0;De<$.length;De++)O(Me[0])&&T($[De])&&Me.length===Ie[Me[0].toUpperCase()]&&$.splice(De,0,Me[0].replace("M","L").replace("m","l")),"string"==typeof $[De]&&(Me.length&&de.push(Me.slice(0)),Me.length=0),Me.push($[De]);return de.push(Me.slice(0)),de},V.prototype.label=function($,de,Me,Ie,De,oe,ve,xe,Re){return new be(this,$,de,Me,Ie,De,oe,ve,xe,Re)},V.prototype.alignElements=function(){this.alignedObjects.forEach(function($){return $.align()})},V}(),A(Te.prototype,{Element:Se,SVG_NS:H,escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},symbols:ce,draw:P}),Ce.registerRendererType("svg",Te,!0),Te}),Ge(u,"Core/Renderer/HTML/HTMLElement.js",[u["Core/Globals.js"],u["Core/Renderer/SVG/SVGElement.js"],u["Core/Utilities.js"]],function(re,me,Te){var I,Ce=this&&this.__extends||(I=function(B,P){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,W){H.__proto__=W}||function(H,W){for(var ie in W)W.hasOwnProperty(ie)&&(H[ie]=W[ie])})(B,P)},function(B,P){function H(){this.constructor=B}I(B,P),B.prototype=null===P?Object.create(P):(H.prototype=P.prototype,new H)}),Se=re.isFirefox,be=re.isMS,ce=re.isWebKit,ne=re.win,K=Te.css,Y=Te.defined,j=Te.extend,N=Te.pick,R=Te.pInt;return function(I){function B(){return null!==I&&I.apply(this,arguments)||this}return Ce(B,I),B.compose=function(P){if(-1===B.composedClasses.indexOf(P)){B.composedClasses.push(P);var H=B.prototype,W=P.prototype;W.getSpanCorrection=H.getSpanCorrection,W.htmlCss=H.htmlCss,W.htmlGetBBox=H.htmlGetBBox,W.htmlUpdateTransform=H.htmlUpdateTransform,W.setSpanRotation=H.setSpanRotation}return P},B.prototype.getSpanCorrection=function(P,H,W){this.xCorr=-P*W,this.yCorr=-H},B.prototype.htmlCss=function(P){var H="SPAN"===this.element.tagName&&P&&"width"in P,W=N(H&&P.width,void 0);if(H){delete P.width,this.textWidth=W;var ie=!0}return P&&"ellipsis"===P.textOverflow&&(P.whiteSpace="nowrap",P.overflow="hidden"),this.styles=j(this.styles,P),K(this.element,P),ie&&this.htmlUpdateTransform(),this},B.prototype.htmlGetBBox=function(){var P=this.element;return{x:P.offsetLeft,y:P.offsetTop,width:P.offsetWidth,height:P.offsetHeight}},B.prototype.htmlUpdateTransform=function(){if(this.added){var P=this.renderer,H=this.element,W=this.translateX||0,ie=this.translateY||0,te=this.x||0,ee=this.y||0,J=this.textAlign||"left",q={left:0,center:.5,right:1}[J],D=this.styles;if(D=D&&D.whiteSpace,K(H,{marginLeft:W,marginTop:ie}),!P.styledMode&&this.shadows&&this.shadows.forEach(function(O){K(O,{marginLeft:W+1,marginTop:ie+1})}),this.inverted&&[].forEach.call(H.childNodes,function(O){P.invertChild(O,H)}),"SPAN"===H.tagName){var z=this.rotation,A=this.textWidth&&R(this.textWidth),U=[z,J,H.innerHTML,this.textWidth,this.textAlign].join(),T=void 0;if(T=!1,A!==this.oldTextWidth){if(this.textPxLength)var S=this.textPxLength;else K(H,{width:"",whiteSpace:D||"nowrap"}),S=H.offsetWidth;(A>this.oldTextWidth||S>A)&&(/[ \-]/.test(H.textContent||H.innerText)||"ellipsis"===H.style.textOverflow)&&(K(H,{width:S>A||z?A+"px":"auto",display:"block",whiteSpace:D||"normal"}),this.oldTextWidth=A,T=!0)}this.hasBoxWidthChanged=T,U!==this.cTT&&(T=P.fontMetrics(H.style.fontSize,H).b,!Y(z)||z===(this.oldRotation||0)&&J===this.oldAlign||this.setSpanRotation(z,q,T),this.getSpanCorrection(!Y(z)&&this.textPxLength||H.offsetWidth,T,q,z,J)),K(H,{left:te+(this.xCorr||0)+"px",top:ee+(this.yCorr||0)+"px"}),this.cTT=U,this.oldRotation=z,this.oldAlign=J}}else this.alignOnAdd=!0},B.prototype.setSpanRotation=function(P,H,W){var ie={},te=be&&!/Edge/.test(ne.navigator.userAgent)?"-ms-transform":ce?"-webkit-transform":Se?"MozTransform":ne.opera?"-o-transform":void 0;te&&(ie[te]=ie.transform="rotate("+P+"deg)",ie[te+(Se?"Origin":"-origin")]=ie.transformOrigin=100*H+"% "+W+"px",K(this.element,ie))},B.composedClasses=[],B}(me)}),Ge(u,"Core/Renderer/HTML/HTMLRenderer.js",[u["Core/Renderer/HTML/AST.js"],u["Core/Renderer/SVG/SVGElement.js"],u["Core/Renderer/SVG/SVGRenderer.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce){var Y,Se=this&&this.__extends||(Y=function(j,N){return(Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,I){R.__proto__=I}||function(R,I){for(var B in I)I.hasOwnProperty(B)&&(R[B]=I[B])})(j,N)},function(j,N){function R(){this.constructor=j}Y(j,N),j.prototype=null===N?Object.create(N):(R.prototype=N.prototype,new R)}),be=Ce.attr,ce=Ce.createElement,ne=Ce.extend,K=Ce.pick;return function(Y){function j(){return null!==Y&&Y.apply(this,arguments)||this}return Se(j,Y),j.compose=function(N){return-1===j.composedClasses.indexOf(N)&&(j.composedClasses.push(N),N.prototype.html=j.prototype.html),N},j.prototype.html=function(N,R,I){var B=this.createElement("span"),P=B.element,H=B.renderer,W=H.isSVG,ie=function(te,ee){["opacity","visibility"].forEach(function(J){te[J+"Setter"]=function(q,D,z){var A=te.div?te.div.style:ee;me.prototype[J+"Setter"].call(this,q,D,z),A&&(A[D]=q)}}),te.addedSetters=!0};return B.textSetter=function(te){te!==this.textStr&&(delete this.bBox,delete this.oldTextWidth,re.setElementHTML(this.element,K(te,"")),this.textStr=te,B.doTransform=!0)},W&&ie(B,B.element.style),B.xSetter=B.ySetter=B.alignSetter=B.rotationSetter=function(te,ee){"align"===ee?B.alignValue=B.textAlign=te:B[ee]=te,B.doTransform=!0},B.afterSetters=function(){this.doTransform&&(this.htmlUpdateTransform(),this.doTransform=!1)},B.attr({text:N,x:Math.round(R),y:Math.round(I)}).css({position:"absolute"}),H.styledMode||B.css({fontFamily:this.style.fontFamily,fontSize:this.style.fontSize}),P.style.whiteSpace="nowrap",B.css=B.htmlCss,W&&(B.add=function(te){var ee=H.box.parentNode,J=[];if(this.parentGroup=te){var q=te.div;if(!q){for(;te;)J.push(te),te=te.parentGroup;J.reverse().forEach(function(D){function z(S,O){D[O]=S,"translateX"===O?T.left=S+"px":T.top=S+"px",D.doTransform=!0}var S,A=be(D.element,"class"),U=D.styles||{},T=(q=D.div=D.div||ce("div",A?{className:A}:void 0,{position:"absolute",left:(D.translateX||0)+"px",top:(D.translateY||0)+"px",display:D.display,opacity:D.opacity,cursor:U.cursor,pointerEvents:U.pointerEvents,visibility:D.visibility},q||ee)).style;ne(D,{classSetter:(S=q,function(O){this.element.setAttribute("class",O),S.className=O}),on:function(){return J[0].div&&B.on.apply({element:J[0].div,onEvents:D.onEvents},arguments),D},translateXSetter:z,translateYSetter:z}),D.addedSetters||ie(D)})}}else q=ee;return q.appendChild(P),B.added=!0,B.alignOnAdd&&B.htmlUpdateTransform(),B}),B},j.composedClasses=[],j}(Te)}),Ge(u,"Core/Axis/AxisDefaults.js",[],function(){var re=(()=>{return(me=re||(re={})).defaultXAxisOptions={alignTicks:!0,allowDecimals:void 0,panningEnabled:!0,zIndex:2,zoomEnabled:!0,dateTimeLabelFormats:{millisecond:{main:"%H:%M:%S.%L",range:!1},second:{main:"%H:%M:%S",range:!1},minute:{main:"%H:%M",range:!1},hour:{main:"%H:%M",range:!1},day:{main:"%e. %b"},week:{main:"%e. %b"},month:{main:"%b '%y"},year:{main:"%Y"}},endOnTick:!1,gridLineDashStyle:"Solid",gridZIndex:1,labels:{autoRotation:void 0,autoRotationLimit:80,distance:void 0,enabled:!0,indentation:10,overflow:"justify",padding:5,reserveSpace:void 0,rotation:void 0,staggerLines:0,step:0,useHTML:!1,x:0,zIndex:7,style:{color:"#666666",cursor:"default",fontSize:"11px"}},maxPadding:.01,minorGridLineDashStyle:"Solid",minorTickLength:2,minorTickPosition:"outside",minPadding:.01,offset:void 0,opposite:!1,reversed:void 0,reversedStacks:!1,showEmpty:!0,showFirstLabel:!0,showLastLabel:!0,startOfWeek:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickmarkPlacement:"between",tickPosition:"outside",title:{align:"middle",rotation:0,useHTML:!1,x:0,y:0,style:{color:"#666666"}},type:"linear",uniqueNames:!0,visible:!0,minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#ccd6eb",lineWidth:1,gridLineColor:"#e6e6e6",gridLineWidth:void 0,tickColor:"#ccd6eb"},me.defaultYAxisOptions={reversedStacks:!0,endOnTick:!0,maxPadding:.05,minPadding:.05,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{animation:{},allowOverlap:!1,enabled:!1,crop:!0,overflow:"justify",formatter:function(){return(0,this.axis.chart.numberFormatter)(this.total||0,-1)},style:{color:"#000000",fontSize:"11px",fontWeight:"bold",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0},me.defaultLeftAxisOptions={labels:{x:-15},title:{rotation:270}},me.defaultRightAxisOptions={labels:{x:15},title:{rotation:90}},me.defaultBottomAxisOptions={labels:{autoRotation:[-45],x:0},margin:15,title:{rotation:0}},me.defaultTopAxisOptions={labels:{autoRotation:[-45],x:0},margin:15,title:{rotation:0}},re;var me})();return re}),Ge(u,"Core/Foundation.js",[u["Core/Utilities.js"]],function(re){var be,me=re.addEvent,Te=re.isFunction,Ce=re.objectEach,Se=re.removeEvent;return(be||(be={})).registerEventOptions=function(ne,K){ne.eventOptions=ne.eventOptions||{},Ce(K.events,function(Y,j){ne.eventOptions[j]!==Y&&(ne.eventOptions[j]&&(Se(ne,j,ne.eventOptions[j]),delete ne.eventOptions[j]),Te(Y)&&(ne.eventOptions[j]=Y,me(ne,j,Y)))})},be}),Ge(u,"Core/Axis/Tick.js",[u["Core/FormatUtilities.js"],u["Core/Globals.js"],u["Core/Utilities.js"]],function(re,me,Te){var Ce=me.deg2rad,Se=Te.clamp,be=Te.correctFloat,ce=Te.defined,ne=Te.destroyObjectProperties,K=Te.extend,Y=Te.fireEvent,j=Te.isNumber,N=Te.merge,R=Te.objectEach,I=Te.pick;return function(){function B(P,H,W,ie,te){this.isNewLabel=this.isNew=!0,this.axis=P,this.pos=H,this.type=W||"",this.parameters=te||{},this.tickmarkOffset=this.parameters.tickmarkOffset,this.options=this.parameters.options,Y(this,"init"),W||ie||this.addLabel()}return B.prototype.addLabel=function(){var P=this,H=P.axis,W=H.options,ie=H.chart,te=H.categories,ee=H.logarithmic,J=H.names,q=P.pos,D=I(P.options&&P.options.labels,W.labels),z=H.tickPositions,A=q===z[0],U=q===z[z.length-1],T=(!D.step||1===D.step)&&1===H.tickInterval;z=z.info;var O,S=P.label;if(te=this.parameters.category||(te?I(te[q],J[q],q):q),ee&&j(te)&&(te=be(ee.lin2log(te))),H.dateTime)if(z)var M=ie.time.resolveDTLFormat(W.dateTimeLabelFormats[!W.grid&&z.higherRanks[q]||z.unitName]),Z=M.main;else j(te)&&(Z=H.dateTime.getXDateFormat(te,W.dateTimeLabelFormats||{}));P.isFirst=A,P.isLast=U;var ae={axis:H,chart:ie,dateTimeLabelFormat:Z,isFirst:A,isLast:U,pos:q,tick:P,tickPositionInfo:z,value:te};Y(this,"labelFormat",ae);var ue=function(V){return D.formatter?D.formatter.call(V,V):D.format?(V.text=H.defaultLabelFormatter.call(V),re.format(D.format,V,ie)):H.defaultLabelFormatter.call(V,V)};W=ue.call(ae,ae);var ge=M&&M.list;P.shortenLabel=ge?function(){for(O=0;O<ge.length;O++)if(K(ae,{dateTimeLabelFormat:ge[O]}),S.attr({text:ue.call(ae,ae)}),S.getBBox().width<H.getSlotWidth(P)-2*D.padding)return;S.attr({text:""})}:void 0,T&&H._addedPlotLB&&P.moveLabel(W,D),ce(S)||P.movedLabel?S&&S.textStr!==W&&!T&&(!S.textWidth||D.style.width||S.styles.width||S.css({width:null}),S.attr({text:W}),S.textPxLength=S.getBBox().width):(P.label=S=P.createLabel({x:0,y:0},W,D),P.rotation=0)},B.prototype.createLabel=function(P,H,W){var ie=this.axis,te=ie.chart;return(P=ce(H)&&W.enabled?te.renderer.text(H,P.x,P.y,W.useHTML).add(ie.labelGroup):null)&&(te.styledMode||P.css(N(W.style)),P.textPxLength=P.getBBox().width),P},B.prototype.destroy=function(){ne(this,this.axis)},B.prototype.getPosition=function(P,H,W,ie){var te=this.axis,ee=te.chart,J=ie&&ee.oldChartHeight||ee.chartHeight;return(P={x:P?be(te.translate(H+W,void 0,void 0,ie)+te.transB):te.left+te.offset+(te.opposite?(ie&&ee.oldChartWidth||ee.chartWidth)-te.right-te.left:0),y:P?J-te.bottom+te.offset-(te.opposite?te.height:0):be(J-te.translate(H+W,void 0,void 0,ie)-te.transB)}).y=Se(P.y,-1e5,1e5),Y(this,"afterGetPosition",{pos:P}),P},B.prototype.getLabelPosition=function(P,H,W,ie,te,ee,J,q){var D=this.axis,z=D.transA,A=D.isLinked&&D.linkedParent?D.linkedParent.reversed:D.reversed,U=D.staggerLines,T=D.tickRotCorr||{x:0,y:0},S=ie||D.reserveSpaceDefault?0:-D.labelOffset*("center"===D.labelAlign?.5:1),O={};return W=0===D.side?W.rotation?-8:-W.getBBox().height:2===D.side?T.y+8:Math.cos(W.rotation*Ce)*(T.y-W.getBBox(!1,0).height/2),ce(te.y)&&(W=0===D.side&&D.horiz?te.y+W:te.y),P=P+te.x+S+T.x-(ee&&ie?ee*z*(A?-1:1):0),H=H+W-(ee&&!ie?ee*z*(A?1:-1):0),U&&(ie=J/(q||1)%U,D.opposite&&(ie=U-ie-1),H+=D.labelOffset/U*ie),O.x=P,O.y=Math.round(H),Y(this,"afterGetLabelPosition",{pos:O,tickmarkOffset:ee,index:J}),O},B.prototype.getLabelSize=function(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0},B.prototype.getMarkPath=function(P,H,W,ie,te,ee){return ee.crispLine([["M",P,H],["L",P+(te?0:-W),H+(te?W:0)]],ie)},B.prototype.handleOverflow=function(P){var H=this.axis,W=H.options.labels,ie=P.x,te=H.chart.chartWidth,ee=H.chart.spacing,J=I(H.labelLeft,Math.min(H.pos,ee[3]));ee=I(H.labelRight,Math.max(H.isRadial?0:H.pos+H.len,te-ee[1]));var M,q=this.label,D=this.rotation,z={left:0,center:.5,right:1}[H.labelAlign||q.attr("align")],A=q.getBBox().width,U=H.getSlotWidth(this),T={},S=U,O=1;D||"justify"!==W.overflow?0>D&&ie-z*A<J?M=Math.round(ie/Math.cos(D*Ce)-J):0<D&&ie+z*A>ee&&(M=Math.round((te-ie)/Math.cos(D*Ce))):(te=ie+(1-z)*A,ie-z*A<J?S=P.x+S*(1-z)-J:te>ee&&(S=ee-P.x+S*z,O=-1),(S=Math.min(U,S))<U&&"center"===H.labelAlign&&(P.x+=O*(U-S-z*(U-Math.min(A,S)))),(A>S||H.autoRotation&&(q.styles||{}).width)&&(M=S)),M&&(this.shortenLabel?this.shortenLabel():(T.width=Math.floor(M)+"px",(W.style||{}).textOverflow||(T.textOverflow="ellipsis"),q.css(T)))},B.prototype.moveLabel=function(P,H){var W=this,ie=W.label,te=W.axis,ee=te.reversed,J=!1;if(ie&&ie.textStr===P?(W.movedLabel=ie,J=!0,delete W.label):R(te.ticks,function(D){J||D.isNew||D===W||!D.label||D.label.textStr!==P||(W.movedLabel=D.label,J=!0,D.labelPos=W.movedLabel.xy,delete D.label)}),!J&&(W.labelPos||ie)){var q=W.labelPos||ie.xy;W.movedLabel=W.createLabel({x:ie=te.horiz?ee?0:te.width+te.left:q.x,y:te=te.horiz?q.y:ee?te.width+te.left:0},P,H),W.movedLabel&&W.movedLabel.attr({opacity:0})}},B.prototype.render=function(P,H,W){var ie=this.axis,te=ie.horiz,ee=this.pos,J=I(this.tickmarkOffset,ie.tickmarkOffset);J=(ee=this.getPosition(te,ee,J,H)).x,ie=te&&J===ie.pos+ie.len||!te&&ee.y===ie.pos?-1:1,te=I(W,this.label&&this.label.newOpacity,1),W=I(W,1),this.isActive=!0,this.renderGridLine(H,W,ie),this.renderMark(ee,W,ie),this.renderLabel(ee,H,te,P),this.isNew=!1,Y(this,"afterRender")},B.prototype.renderGridLine=function(P,H,W){var ie=this.axis,te=ie.options,ee={},J=this.pos,q=this.type,D=I(this.tickmarkOffset,ie.tickmarkOffset),z=ie.chart.renderer,A=this.gridLine,U=te.gridLineWidth,T=te.gridLineColor,S=te.gridLineDashStyle;"minor"===this.type&&(U=te.minorGridLineWidth,T=te.minorGridLineColor,S=te.minorGridLineDashStyle),A||(ie.chart.styledMode||(ee.stroke=T,ee["stroke-width"]=U||0,ee.dashstyle=S),q||(ee.zIndex=1),P&&(H=0),this.gridLine=A=z.path().attr(ee).addClass("highcharts-"+(q?q+"-":"")+"grid-line").add(ie.gridGroup)),A&&(W=ie.getPlotLinePath({value:J+D,lineWidth:A.strokeWidth()*W,force:"pass",old:P}))&&A[P||this.isNew?"attr":"animate"]({d:W,opacity:H})},B.prototype.renderMark=function(P,H,W){var ie=this.axis,te=ie.options,ee=ie.chart.renderer,J=this.type,q=ie.tickSize(J?J+"Tick":"tick"),D=P.x;P=P.y;var z=I(te["minor"!==J?"tickWidth":"minorTickWidth"],!J&&ie.isXAxis?1:0);te=te["minor"!==J?"tickColor":"minorTickColor"];var A=this.mark,U=!A;q&&(ie.opposite&&(q[0]=-q[0]),A||(this.mark=A=ee.path().addClass("highcharts-"+(J?J+"-":"")+"tick").add(ie.axisGroup),ie.chart.styledMode||A.attr({stroke:te,"stroke-width":z})),A[U?"attr":"animate"]({d:this.getMarkPath(D,P,q[0],A.strokeWidth()*W,ie.horiz,ee),opacity:H}))},B.prototype.renderLabel=function(P,H,W,ie){var te=this.axis,ee=te.horiz,J=te.options,q=this.label,D=J.labels,z=D.step;te=I(this.tickmarkOffset,te.tickmarkOffset);var A=P.x;P=P.y;var U=!0;q&&j(A)&&(q.xy=P=this.getLabelPosition(A,P,q,ee,D,te,ie,z),this.isFirst&&!this.isLast&&!J.showFirstLabel||this.isLast&&!this.isFirst&&!J.showLastLabel?U=!1:!ee||D.step||D.rotation||H||0===W||this.handleOverflow(P),z&&ie%z&&(U=!1),U&&j(P.y)?(P.opacity=W,q[this.isNewLabel?"attr":"animate"](P).show(!0),this.isNewLabel=!1):(q.hide(),this.isNewLabel=!0))},B.prototype.replaceMovedLabel=function(){var P=this.label,H=this.axis,W=H.reversed;P&&!this.isNew&&(P.animate({x:H.horiz?W?H.left:H.width+H.left:P.xy.x,y:W=H.horiz?P.xy.y:W?H.width+H.top:H.top,opacity:0},void 0,P.destroy),delete this.label),H.isDirty=!0,this.label=this.movedLabel,delete this.movedLabel},B}()}),Ge(u,"Core/Axis/Axis.js",[u["Core/Animation/AnimationUtilities.js"],u["Core/Axis/AxisDefaults.js"],u["Core/Color/Color.js"],u["Core/DefaultOptions.js"],u["Core/Foundation.js"],u["Core/Globals.js"],u["Core/Axis/Tick.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce,Se,be,ce,ne){var K=re.animObject,Y=Ce.defaultOptions,j=Se.registerEventOptions,N=be.deg2rad,R=ne.arrayMax,I=ne.arrayMin,B=ne.clamp,P=ne.correctFloat,H=ne.defined,W=ne.destroyObjectProperties,ie=ne.erase,te=ne.error,ee=ne.extend,J=ne.fireEvent,q=ne.isArray,D=ne.isNumber,z=ne.isString,A=ne.merge,U=ne.normalizeTickInterval,T=ne.objectEach,S=ne.pick,O=ne.relativeLength,M=ne.removeEvent,Z=ne.splat,ae=ne.syncTimeout,ue=function(ge,V){return U(V,void 0,void 0,S(ge.options.allowDecimals,.5>V||void 0!==ge.tickAmount),!!ge.tickAmount)};return function(){function ge(V,$){this.zoomEnabled=this.width=this.visible=this.userOptions=this.translationSlope=this.transB=this.transA=this.top=this.ticks=this.tickRotCorr=this.tickPositions=this.tickmarkOffset=this.tickInterval=this.tickAmount=this.side=this.series=this.right=this.positiveValuesOnly=this.pos=this.pointRangePadding=this.pointRange=this.plotLinesAndBandsGroups=this.plotLinesAndBands=this.paddedTicks=this.overlap=this.options=this.offset=this.names=this.minPixelPadding=this.minorTicks=this.minorTickInterval=this.min=this.maxLabelLength=this.max=this.len=this.left=this.labelFormatter=this.labelEdge=this.isLinked=this.height=this.hasVisibleSeries=this.hasNames=this.eventOptions=this.coll=this.closestPointRange=this.chart=this.bottom=this.alternateBands=void 0,this.init(V,$)}return ge.prototype.init=function(V,$){var de=$.isX;this.chart=V,this.horiz=V.inverted&&!this.isZAxis?!de:de,this.isXAxis=de,this.coll=this.coll||(de?"xAxis":"yAxis"),J(this,"init",{userOptions:$}),this.opposite=S($.opposite,this.opposite),this.side=S($.side,this.side,this.horiz?this.opposite?0:2:this.opposite?1:3),this.setOptions($);var Me=this.options,Ie=Me.labels,De=Me.type;this.userOptions=$,this.minPixelPadding=0,this.reversed=S(Me.reversed,this.reversed),this.visible=Me.visible,this.zoomEnabled=Me.zoomEnabled,this.hasNames="category"===De||!0===Me.categories,this.categories=Me.categories||(this.hasNames?[]:void 0),this.names||(this.names=[],this.names.keys={}),this.plotLinesAndBandsGroups={},this.positiveValuesOnly=!!this.logarithmic,this.isLinked=H(Me.linkedTo),this.ticks={},this.labelEdge=[],this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len=0,this.minRange=this.userMinRange=Me.minRange||Me.maxZoom,this.range=Me.range,this.offset=Me.offset||0,this.min=this.max=null,$=S(Me.crosshair,Z(V.options.tooltip.crosshairs)[de?0:1]),this.crosshair=!0===$?{}:$,-1===V.axes.indexOf(this)&&(de?V.axes.splice(V.xAxis.length,0,this):V.axes.push(this),V[this.coll].push(this)),this.series=this.series||[],V.inverted&&!this.isZAxis&&de&&typeof this.reversed>"u"&&(this.reversed=!0),this.labelRotation=D(Ie.rotation)?Ie.rotation:void 0,j(this,Me),J(this,"afterInit")},ge.prototype.setOptions=function(V){this.options=A(me.defaultXAxisOptions,"yAxis"===this.coll&&me.defaultYAxisOptions,[me.defaultTopAxisOptions,me.defaultRightAxisOptions,me.defaultBottomAxisOptions,me.defaultLeftAxisOptions][this.side],A(Y[this.coll],V)),J(this,"afterSetOptions",{userOptions:V})},ge.prototype.defaultLabelFormatter=function(V){var $=this.axis;V=this.chart.numberFormatter;var de=D(this.value)?this.value:NaN,Me=$.chart.time,Ie=this.dateTimeLabelFormat,De=Y.lang,oe=De.numericSymbols;De=De.numericSymbolMagnitude||1e3;var ve=$.logarithmic?Math.abs(de):$.tickInterval,xe=oe&&oe.length;if($.categories)var Re="".concat(this.value);else if(Ie)Re=Me.dateFormat(Ie,de);else if(xe&&1e3<=ve)for(;xe--&&typeof Re>"u";)ve>=($=Math.pow(De,xe+1))&&10*de%$==0&&null!==oe[xe]&&0!==de&&(Re=V(de/$,-1)+oe[xe]);return typeof Re>"u"&&(Re=1e4<=Math.abs(de)?V(de,-1):V(de,-1,void 0,"")),Re},ge.prototype.getSeriesExtremes=function(){var de,V=this,$=V.chart;J(this,"getSeriesExtremes",null,function(){V.hasVisibleSeries=!1,V.dataMin=V.dataMax=V.threshold=null,V.softThreshold=!V.isXAxis,V.stacking&&V.stacking.buildStacks(),V.series.forEach(function(Me){if(Me.visible||!$.options.chart.ignoreHiddenSeries){var Ie=Me.options,De=Ie.threshold;if(V.hasVisibleSeries=!0,V.positiveValuesOnly&&0>=De&&(De=null),V.isXAxis){if((Ie=Me.xData).length){Ie=V.logarithmic?Ie.filter(V.validatePositiveValue):Ie;var oe=(de=Me.getXExtremes(Ie)).min,ve=de.max;D(oe)||oe instanceof Date||(Ie=Ie.filter(D),oe=(de=Me.getXExtremes(Ie)).min,ve=de.max),Ie.length&&(V.dataMin=Math.min(S(V.dataMin,oe),oe),V.dataMax=Math.max(S(V.dataMax,ve),ve))}}else Me=Me.applyExtremes(),D(Me.dataMin)&&(oe=Me.dataMin,V.dataMin=Math.min(S(V.dataMin,oe),oe)),D(Me.dataMax)&&(ve=Me.dataMax,V.dataMax=Math.max(S(V.dataMax,ve),ve)),H(De)&&(V.threshold=De),(!Ie.softThreshold||V.positiveValuesOnly)&&(V.softThreshold=!1)}})}),J(this,"afterGetSeriesExtremes")},ge.prototype.translate=function(V,$,de,Me,Ie,De){var oe=this.linkedParent||this,ve=Me&&oe.old?oe.old.min:oe.min;if(!D(ve))return NaN;var xe=oe.minPixelPadding;Ie=(oe.isOrdinal||oe.brokenAxis&&oe.brokenAxis.hasBreaks||oe.logarithmic&&Ie)&&oe.lin2val;var Re=1,we=0;return(Me=Me&&oe.old?oe.old.transA:oe.transA)||(Me=oe.transA),de&&(Re*=-1,we=oe.len),oe.reversed&&(we-=(Re*=-1)*(oe.sector||oe.len)),$?(De=(V*Re+we-xe)/Me+ve,Ie&&(De=oe.lin2val(De))):(Ie&&(V=oe.val2lin(V)),V=Re*(V-ve)*Me,De=(oe.isRadial?V:P(V))+we+Re*xe+(D(De)?Me*De:0)),De},ge.prototype.toPixels=function(V,$){return this.translate(V,!1,!this.horiz,void 0,!0)+($?0:this.pos)},ge.prototype.toValue=function(V,$){return this.translate(V-($?0:this.pos),!0,!this.horiz,void 0,!0)},ge.prototype.getPlotLinePath=function(V){function $(lt,Pe,je){return("pass"!==Ze&&lt<Pe||lt>je)&&(Ze?lt=B(lt,Pe,je):bt=!0),lt}var at,wt,Tt,Ut,bt,de=this,Me=de.chart,Ie=de.left,De=de.top,oe=V.old,ve=V.value,xe=V.lineWidth,Re=oe&&Me.oldChartHeight||Me.chartHeight,we=oe&&Me.oldChartWidth||Me.chartWidth,Le=de.transB,Ne=V.translatedValue,Ze=V.force;return J(this,"getPlotLinePath",V={value:ve,lineWidth:xe,old:oe,force:Ze,acrossPanes:V.acrossPanes,translatedValue:Ne},function(lt){Ne=S(Ne,de.translate(ve,void 0,void 0,oe)),Ne=B(Ne,-1e5,1e5),at=Tt=Math.round(Ne+Le),wt=Ut=Math.round(Re-Ne-Le),D(Ne)?de.horiz?(wt=De,Ut=Re-de.bottom,at=Tt=$(at,Ie,Ie+de.width)):(at=Ie,Tt=we-de.right,wt=Ut=$(wt,De,De+de.height)):(bt=!0,Ze=!1),lt.path=bt&&!Ze?null:Me.renderer.crispLine([["M",at,wt],["L",Tt,Ut]],xe||1)}),V.path},ge.prototype.getLinearTickPositions=function(V,$,de){var Me=P(Math.floor($/V)*V);de=P(Math.ceil(de/V)*V);var De,Ie=[];if(P(Me+V)===Me&&(De=20),this.single)return[$];for($=Me;$<=de&&(Ie.push($),($=P($+V,De))!==oe);)var oe=$;return Ie},ge.prototype.getMinorTickInterval=function(){var V=this.options;return!0===V.minorTicks?S(V.minorTickInterval,"auto"):!1===V.minorTicks?null:V.minorTickInterval},ge.prototype.getMinorTickPositions=function(){var V=this.options,$=this.tickPositions,de=this.minorTickInterval,Me=this.pointRangePadding||0,Ie=this.min-Me,De=(Me=this.max+Me)-Ie,oe=[];if(De&&De/de<this.len/3){var ve=this.logarithmic;if(ve)this.paddedTicks.forEach(function(xe,Re,we){Re&&oe.push.apply(oe,ve.getLogTickPositions(de,we[Re-1],we[Re],!0))});else if(this.dateTime&&"auto"===this.getMinorTickInterval())oe=oe.concat(this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(de),Ie,Me,V.startOfWeek));else for(V=Ie+($[0]-Ie)%de;V<=Me&&V!==oe[0];V+=de)oe.push(V)}return 0!==oe.length&&this.trimTicks(oe),oe},ge.prototype.adjustForMinRange=function(){var De,oe,ve,xe,V=this.options,$=this.logarithmic,de=this.min,Me=this.max,Ie=0;if(this.isXAxis&&typeof this.minRange>"u"&&!$&&(H(V.min)||H(V.max)||H(V.floor)||H(V.ceiling)?this.minRange=null:(this.series.forEach(function(Ne){if(ve=Ne.xData,xe=Ne.xIncrement?1:ve.length-1,1<ve.length)for(De=xe;0<De;De--)oe=ve[De]-ve[De-1],(!Ie||oe<Ie)&&(Ie=oe)}),this.minRange=Math.min(5*Ie,this.dataMax-this.dataMin))),Me-de<this.minRange){var Re=this.dataMax-this.dataMin>=this.minRange,we=this.minRange,Le=(we-Me+de)/2;Le=[de-Le,S(V.min,de-Le)],Re&&(Le[2]=this.logarithmic?this.logarithmic.log2lin(this.dataMin):this.dataMin),Me=[(de=R(Le))+we,S(V.max,de+we)],Re&&(Me[2]=$?$.log2lin(this.dataMax):this.dataMax),(Me=I(Me))-de<we&&(Le[0]=Me-we,Le[1]=S(V.min,Me-we),de=R(Le))}this.min=de,this.max=Me},ge.prototype.getClosest=function(){var V;return this.categories?V=1:this.series.forEach(function($){var de=$.closestPointRange,Me=$.visible||!$.chart.options.chart.ignoreHiddenSeries;!$.noSharedTooltip&&H(de)&&Me&&(V=H(V)?Math.min(V,de):de)}),V},ge.prototype.nameToX=function(V){var $=q(this.options.categories),de=$?this.categories:this.names,Me=V.options.x;if(V.series.requireSorting=!1,H(Me)||(Me=this.options.uniqueNames&&de?$?de.indexOf(V.name):S(de.keys[V.name],-1):V.series.autoIncrement()),-1===Me){if(!$&&de)var Ie=de.length}else Ie=Me;return typeof Ie<"u"?(this.names[Ie]=V.name,this.names.keys[V.name]=Ie):V.x&&(Ie=V.x),Ie},ge.prototype.updateNames=function(){var V=this,$=this.names;0<$.length&&(Object.keys($.keys).forEach(function(de){delete $.keys[de]}),$.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach(function(de){de.xIncrement=null,(!de.points||de.isDirtyData)&&(V.max=Math.max(V.max,de.xData.length-1),de.processData(),de.generatePoints()),de.data.forEach(function(Me,Ie){if(Me&&Me.options&&typeof Me.name<"u"){var De=V.nameToX(Me);typeof De<"u"&&De!==Me.x&&(Me.x=De,de.xData[Ie]=De)}})}))},ge.prototype.setAxisTranslation=function(){var xe,V=this,$=V.max-V.min,de=V.linkedParent,Me=!!V.categories,Ie=V.isXAxis,De=V.axisPointRange||0,oe=0,ve=0;if(Ie||Me||De){var Re=V.getClosest();de?(oe=de.minPointOffset,ve=de.pointRangePadding):V.series.forEach(function(we){var Le=Me?1:Ie?S(we.options.pointRange,Re,0):V.axisPointRange||0,Ne=we.options.pointPlacement;De=Math.max(De,Le),(!V.single||Me)&&(we=we.is("xrange")?!Ie:Ie,oe=Math.max(oe,we&&z(Ne)?0:Le/2),ve=Math.max(ve,we&&"on"===Ne?0:Le))}),V.minPointOffset=oe*=de=V.ordinal&&V.ordinal.slope&&Re?V.ordinal.slope/Re:1,V.pointRangePadding=ve*=de,V.pointRange=Math.min(De,V.single&&Me?1:$),Ie&&(V.closestPointRange=Re)}V.translationSlope=V.transA=xe=V.staticScale||V.len/($+ve||1),V.transB=V.horiz?V.left:V.bottom,V.minPixelPadding=xe*oe,J(this,"afterSetAxisTranslation")},ge.prototype.minFromRange=function(){return this.max-this.range},ge.prototype.setTickInterval=function(V){var $=this.chart,de=this.logarithmic,Me=this.options,Ie=this.isXAxis,De=this.isLinked,oe=Me.tickPixelInterval,ve=this.categories,xe=this.softThreshold,Re=Me.maxPadding,we=Me.minPadding,Le=D(Me.tickInterval)&&0<=Me.tickInterval?Me.tickInterval:void 0,Ne=D(this.threshold)?this.threshold:null;this.dateTime||ve||De||this.getTickAmount();var Ze=S(this.userMin,Me.min),at=S(this.userMax,Me.max);if(De){this.linkedParent=$[this.coll][Me.linkedTo];var wt=this.linkedParent.getExtremes();this.min=S(wt.min,wt.dataMin),this.max=S(wt.max,wt.dataMax),Me.type!==this.linkedParent.options.type&&te(11,1,$)}else{if(xe&&H(Ne))if(this.dataMin>=Ne)wt=Ne,we=0;else if(this.dataMax<=Ne){var Tt=Ne;Re=0}this.min=S(Ze,wt,this.dataMin),this.max=S(at,Tt,this.dataMax)}if(de&&(this.positiveValuesOnly&&!V&&0>=Math.min(this.min,S(this.dataMin,this.min))&&te(10,1,$),this.min=P(de.log2lin(this.min),16),this.max=P(de.log2lin(this.max),16)),this.range&&H(this.max)&&(this.userMin=this.min=Ze=Math.max(this.dataMin,this.minFromRange()),this.userMax=at=this.max,this.range=null),J(this,"foundExtremes"),this.beforePadding&&this.beforePadding(),this.adjustForMinRange(),!(ve||this.axisPointRange||this.stacking&&this.stacking.usePercentage||De)&&H(this.min)&&H(this.max)&&($=this.max-this.min)&&(!H(Ze)&&we&&(this.min-=$*we),!H(at)&&Re&&(this.max+=$*Re)),D(this.userMin)||(D(Me.softMin)&&Me.softMin<this.min&&(this.min=Ze=Me.softMin),D(Me.floor)&&(this.min=Math.max(this.min,Me.floor))),D(this.userMax)||(D(Me.softMax)&&Me.softMax>this.max&&(this.max=at=Me.softMax),D(Me.ceiling)&&(this.max=Math.min(this.max,Me.ceiling))),xe&&H(this.dataMin)&&(Ne=Ne||0,!H(Ze)&&this.min<Ne&&this.dataMin>=Ne?this.min=this.options.minRange?Math.min(Ne,this.max-this.minRange):Ne:!H(at)&&this.max>Ne&&this.dataMax<=Ne&&(this.max=this.options.minRange?Math.max(Ne,this.min+this.minRange):Ne)),D(this.min)&&D(this.max)&&!this.chart.polar&&this.min>this.max&&(H(this.options.min)?this.max=this.min:H(this.options.max)&&(this.min=this.max)),this.tickInterval=this.min===this.max||typeof this.min>"u"||typeof this.max>"u"?1:De&&this.linkedParent&&!Le&&oe===this.linkedParent.options.tickPixelInterval?Le=this.linkedParent.tickInterval:S(Le,this.tickAmount?(this.max-this.min)/Math.max(this.tickAmount-1,1):void 0,ve?1:(this.max-this.min)*oe/Math.max(this.len,oe)),Ie&&!V){var Ut=this.min!==(this.old&&this.old.min)||this.max!==(this.old&&this.old.max);this.series.forEach(function(bt){bt.forceCrop=bt.forceCropping&&bt.forceCropping(),bt.processData(Ut)}),J(this,"postProcessData",{hasExtemesChanged:Ut})}this.setAxisTranslation(),J(this,"initialAxisTranslation"),this.pointRange&&!Le&&(this.tickInterval=Math.max(this.pointRange,this.tickInterval)),V=S(Me.minTickInterval,this.dateTime&&!this.series.some(function(bt){return bt.noSharedTooltip})?this.closestPointRange:0),!Le&&this.tickInterval<V&&(this.tickInterval=V),this.dateTime||this.logarithmic||Le||(this.tickInterval=ue(this,this.tickInterval)),this.tickAmount||(this.tickInterval=this.unsquish()),this.setTickPositions()},ge.prototype.setTickPositions=function(){var V=this.options,$=V.tickPositions,de=this.getMinorTickInterval(),Me=this.hasVerticalPanning(),Ie="colorAxis"===this.coll,De=(Ie||!Me)&&V.startOnTick;if(Me=(Ie||!Me)&&V.endOnTick,Ie=V.tickPositioner,this.tickmarkOffset=this.categories&&"between"===V.tickmarkPlacement&&1===this.tickInterval?.5:0,this.minorTickInterval="auto"===de&&this.tickInterval?this.tickInterval/5:de,this.single=this.min===this.max&&H(this.min)&&!this.tickAmount&&(parseInt(this.min,10)===this.min||!1!==V.allowDecimals),this.tickPositions=de=$&&$.slice(),!de){if(this.ordinal&&this.ordinal.positions||!((this.max-this.min)/this.tickInterval>Math.max(2*this.len,200)))if(this.dateTime)de=this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(this.tickInterval,V.units),this.min,this.max,V.startOfWeek,this.ordinal&&this.ordinal.positions,this.closestPointRange,!0);else if(this.logarithmic)de=this.logarithmic.getLogTickPositions(this.tickInterval,this.min,this.max);else for(var oe=V=this.tickInterval;oe<=2*V&&(de=this.getLinearTickPositions(this.tickInterval,this.min,this.max),this.tickAmount&&de.length>this.tickAmount);)this.tickInterval=ue(this,oe*=1.1);else de=[this.min,this.max],te(19,!1,this.chart);de.length>this.len&&(de=[de[0],de.pop()])[0]===de[1]&&(de.length=1),this.tickPositions=de,Ie&&(Ie=Ie.apply(this,[this.min,this.max]))&&(this.tickPositions=de=Ie)}this.paddedTicks=de.slice(0),this.trimTicks(de,De,Me),this.isLinked||(this.single&&2>de.length&&!this.categories&&!this.series.some(function(ve){return ve.is("heatmap")&&"between"===ve.options.pointPlacement})&&(this.min-=.5,this.max+=.5),$||Ie||this.adjustTickAmount()),J(this,"afterSetTickPositions")},ge.prototype.trimTicks=function(V,$,de){var Me=V[0],Ie=V[V.length-1],De=!this.isOrdinal&&this.minPointOffset||0;if(J(this,"trimTicks"),!this.isLinked){if($&&Me!==-1/0)this.min=Me;else for(;this.min-De>V[0];)V.shift();if(de)this.max=Ie;else for(;this.max+De<V[V.length-1];)V.pop();0===V.length&&H(Me)&&!this.options.tickPositions&&V.push((Ie+Me)/2)}},ge.prototype.alignToOthers=function(){var De,V=this,$=[this],de=V.options,Me="yAxis"===this.coll&&this.chart.options.chart.alignThresholds,Ie=[];if(V.thresholdAlignment=void 0,(!1!==this.chart.options.chart.alignTicks&&de.alignTicks||Me)&&!1!==de.startOnTick&&!1!==de.endOnTick&&!V.logarithmic){var oe=function(Re){var we=Re.options;return[Re.horiz?we.left:we.top,we.width,we.height,we.pane].join()},ve=oe(this);this.chart[this.coll].forEach(function(Re){var we=Re.series;we.length&&we.some(function(Le){return Le.visible})&&Re!==V&&oe(Re)===ve&&(De=!0,$.push(Re))})}if(De&&Me){$.forEach(function(Re){Re=Re.getThresholdAlignment(V),D(Re)&&Ie.push(Re)});var xe=1<Ie.length?Ie.reduce(function(Re,we){return Re+we},0)/Ie.length:void 0;$.forEach(function(Re){Re.thresholdAlignment=xe})}return De},ge.prototype.getThresholdAlignment=function(V){if((!D(this.dataMin)||this!==V&&this.series.some(function($){return $.isDirty||$.isDirtyData}))&&this.getSeriesExtremes(),D(this.threshold))return V=B((this.threshold-(this.dataMin||0))/((this.dataMax||0)-(this.dataMin||0)),0,1),this.options.reversed&&(V=1-V),V},ge.prototype.getTickAmount=function(){var V=this.options,$=V.tickPixelInterval,de=V.tickAmount;!H(V.tickInterval)&&!de&&this.len<$&&!this.isRadial&&!this.logarithmic&&V.startOnTick&&V.endOnTick&&(de=2),!de&&this.alignToOthers()&&(de=Math.ceil(this.len/$)+1),4>de&&(this.finalTickAmt=de,de=5),this.tickAmount=de},ge.prototype.adjustTickAmount=function(){var V=this,$=V.finalTickAmt,de=V.max,Me=V.min,Ie=V.options,De=V.tickPositions,oe=V.tickAmount,ve=V.thresholdAlignment,xe=De&&De.length,Re=S(V.threshold,V.softThreshold?0:null),we=V.tickInterval;if(D(ve)){var Le=.5>ve?Math.ceil(ve*(oe-1)):Math.floor(ve*(oe-1));Ie.reversed&&(Le=oe-1-Le)}if(V.hasData()&&D(Me)&&D(de)){if(ve=function(){V.transA*=(xe-1)/(oe-1),V.min=Ie.startOnTick?De[0]:Math.min(Me,De[0]),V.max=Ie.endOnTick?De[De.length-1]:Math.max(de,De[De.length-1])},D(Le)&&D(V.threshold)){for(;De[Le]!==Re||De.length!==oe||De[0]>Me||De[De.length-1]<de;){for(De.length=0,De.push(V.threshold);De.length<oe;)void 0===De[Le]||De[Le]>V.threshold?De.unshift(P(De[0]-we)):De.push(P(De[De.length-1]+we));if(we>8*V.tickInterval)break;we*=2}ve()}else if(xe<oe){for(;De.length<oe;)De.length%2||Me===Re?De.push(P(De[De.length-1]+we)):De.unshift(P(De[0]-we));ve()}if(H($)){for(we=Re=De.length;we--;)(3===$&&we%2==1||2>=$&&0<we&&we<Re-1)&&De.splice(we,1);V.finalTickAmt=void 0}}},ge.prototype.setScale=function(){var V=!1,$=!1;this.series.forEach(function(Me){V=V||Me.isDirtyData||Me.isDirty,$=$||Me.xAxis&&Me.xAxis.isDirty||!1}),this.setAxisSize();var de=this.len!==(this.old&&this.old.len);de||V||$||this.isLinked||this.forceRedraw||this.userMin!==(this.old&&this.old.userMin)||this.userMax!==(this.old&&this.old.userMax)||this.alignToOthers()?(this.stacking&&this.stacking.resetStacks(),this.forceRedraw=!1,this.getSeriesExtremes(),this.setTickInterval(),this.isDirty||(this.isDirty=de||this.min!==(this.old&&this.old.min)||this.max!==(this.old&&this.old.max))):this.stacking&&this.stacking.cleanStacks(),V&&this.panningState&&(this.panningState.isDirty=!0),J(this,"afterSetScale")},ge.prototype.setExtremes=function(V,$,de,Me,Ie){var De=this,oe=De.chart;de=S(de,!0),De.series.forEach(function(ve){delete ve.kdTree}),Ie=ee(Ie,{min:V,max:$}),J(De,"setExtremes",Ie,function(){De.userMin=V,De.userMax=$,De.eventArgs=Ie,de&&oe.redraw(Me)})},ge.prototype.zoom=function(V,$){var de=this,Me=this.dataMin,Ie=this.dataMax,De=this.options,oe=Math.min(Me,S(De.min,Me)),ve=Math.max(Ie,S(De.max,Ie));return J(this,"zoom",V={newMin:V,newMax:$},function(xe){var Re=xe.newMin,we=xe.newMax;(Re!==de.min||we!==de.max)&&(de.allowZoomOutside||(H(Me)&&(Re<oe&&(Re=oe),Re>ve&&(Re=ve)),H(Ie)&&(we<oe&&(we=oe),we>ve&&(we=ve))),de.displayBtn=typeof Re<"u"||typeof we<"u",de.setExtremes(Re,we,!1,void 0,{trigger:"zoom"})),xe.zoomed=!0}),V.zoomed},ge.prototype.setAxisSize=function(){var V=this.chart,$=this.options,de=$.offsets||[0,0,0,0],Me=this.horiz,Ie=this.width=Math.round(O(S($.width,V.plotWidth-de[3]+de[1]),V.plotWidth)),De=this.height=Math.round(O(S($.height,V.plotHeight-de[0]+de[2]),V.plotHeight)),oe=this.top=Math.round(O(S($.top,V.plotTop+de[0]),V.plotHeight,V.plotTop));$=this.left=Math.round(O(S($.left,V.plotLeft+de[3]),V.plotWidth,V.plotLeft)),this.bottom=V.chartHeight-De-oe,this.right=V.chartWidth-Ie-$,this.len=Math.max(Me?Ie:De,0),this.pos=Me?$:oe},ge.prototype.getExtremes=function(){var V=this.logarithmic;return{min:V?P(V.lin2log(this.min)):this.min,max:V?P(V.lin2log(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},ge.prototype.getThreshold=function(V){var $=this.logarithmic,de=$?$.lin2log(this.min):this.min;return $=$?$.lin2log(this.max):this.max,null===V||V===-1/0?V=de:V===1/0?V=$:de>V?V=de:$<V&&(V=$),this.translate(V,0,1,0,1)},ge.prototype.autoLabelAlign=function(V){var $=(S(V,0)-90*this.side+720)%360;return J(this,"autoLabelAlign",V={align:"center"},function(de){15<$&&165>$?de.align="right":195<$&&345>$&&(de.align="left")}),V.align},ge.prototype.tickSize=function(V){var $=this.options,de=S($["tick"===V?"tickWidth":"minorTickWidth"],"tick"===V&&this.isXAxis&&!this.categories?1:0),Me=$["tick"===V?"tickLength":"minorTickLength"];if(de&&Me){"inside"===$[V+"Position"]&&(Me=-Me);var Ie=[Me,de]}return J(this,"afterTickSize",V={tickSize:Ie}),V.tickSize},ge.prototype.labelMetrics=function(){var V=this.tickPositions&&this.tickPositions[0]||0;return this.chart.renderer.fontMetrics(this.options.labels.style.fontSize,this.ticks[V]&&this.ticks[V].label)},ge.prototype.unsquish=function(){var Re,we,V=this.options.labels,$=this.horiz,de=this.tickInterval,Me=this.len/(((this.categories?1:0)+this.max-this.min)/de),Ie=V.rotation,De=this.labelMetrics(),oe=Math.max(this.max-this.min,0),ve=function(Ze){var at=Ze/(Me||1);return(at=1<at?Math.ceil(at):1)*de>oe&&Ze!==1/0&&Me!==1/0&&oe&&(at=Math.ceil(oe/de)),P(at*de)},xe=de,Le=Number.MAX_VALUE;if($){if(!V.staggerLines&&!V.step)if(D(Ie))var Ne=[Ie];else Me<V.autoRotationLimit&&(Ne=V.autoRotation);Ne&&Ne.forEach(function(Ze){if(Ze===Ie||Ze&&-90<=Ze&&90>=Ze){var at=(we=ve(Math.abs(De.h/Math.sin(N*Ze))))+Math.abs(Ze/360);at<Le&&(Le=at,Re=Ze,xe=we)}})}else V.step||(xe=ve(De.h));return this.autoRotation=Ne,this.labelRotation=S(Re,D(Ie)?Ie:0),xe},ge.prototype.getSlotWidth=function(V){var $=this.chart,de=this.horiz,Me=this.options.labels,Ie=Math.max(this.tickPositions.length-(this.categories?0:1),1),De=$.margin[3];if(V&&D(V.slotWidth))return V.slotWidth;if(de&&2>Me.step)return Me.rotation?0:(this.staggerLines||1)*this.len/Ie;if(!de){if(void 0!==(V=Me.style.width))return parseInt(String(V),10);if(De)return De-$.spacing[3]}return.33*$.chartWidth},ge.prototype.renderUnsquish=function(){var V=this.chart,$=V.renderer,de=this.tickPositions,Me=this.ticks,Ie=this.options.labels,De=Ie.style,oe=this.horiz,ve=this.getSlotWidth(),xe=Math.max(1,Math.round(ve-2*Ie.padding)),Re={},we=this.labelMetrics(),Le=De.textOverflow,Ne=0;if(z(Ie.rotation)||(Re.rotation=Ie.rotation||0),de.forEach(function(Tt){(Tt=Me[Tt]).movedLabel&&Tt.replaceMovedLabel(),Tt&&Tt.label&&Tt.label.textPxLength>Ne&&(Ne=Tt.label.textPxLength)}),this.maxLabelLength=Ne,this.autoRotation)Ne>xe&&Ne>we.h?Re.rotation=this.labelRotation:this.labelRotation=0;else if(ve){var Ze=xe;if(!Le){var at="clip";for(xe=de.length;!oe&&xe--;){var wt=de[xe];(wt=Me[wt].label)&&(wt.styles&&"ellipsis"===wt.styles.textOverflow?wt.css({textOverflow:"clip"}):wt.textPxLength>ve&&wt.css({width:ve+"px"}),wt.getBBox().height>this.len/de.length-(we.h-we.f)&&(wt.specificTextOverflow="ellipsis"))}}}Re.rotation&&(Ze=Ne>.5*V.chartHeight?.33*V.chartHeight:Ne,Le||(at="ellipsis")),(this.labelAlign=Ie.align||this.autoLabelAlign(this.labelRotation))&&(Re.align=this.labelAlign),de.forEach(function(Tt){var Ut=(Tt=Me[Tt])&&Tt.label,bt=De.width,lt={};Ut&&(Ut.attr(Re),Tt.shortenLabel?Tt.shortenLabel():Ze&&!bt&&"nowrap"!==De.whiteSpace&&(Ze<Ut.textPxLength||"SPAN"===Ut.element.tagName)?(lt.width=Ze+"px",Le||(lt.textOverflow=Ut.specificTextOverflow||at),Ut.css(lt)):Ut.styles&&Ut.styles.width&&!lt.width&&!bt&&Ut.css({width:null}),delete Ut.specificTextOverflow,Tt.rotation=Re.rotation)},this),this.tickRotCorr=$.rotCorr(we.b,this.labelRotation||0,0!==this.side)},ge.prototype.hasData=function(){return this.series.some(function(V){return V.hasData()})||this.options.showEmpty&&H(this.min)&&H(this.max)},ge.prototype.addTitle=function(V){var oe,Me=this.opposite,Ie=this.options.title,De=this.chart.styledMode;this.axisTitle||((oe=Ie.textAlign)||(oe=(this.horiz?{low:"left",middle:"center",high:"right"}:{low:Me?"right":"left",middle:"center",high:Me?"left":"right"})[Ie.align]),this.axisTitle=this.chart.renderer.text(Ie.text||"",0,0,Ie.useHTML).attr({zIndex:7,rotation:Ie.rotation,align:oe}).addClass("highcharts-axis-title"),De||this.axisTitle.css(A(Ie.style)),this.axisTitle.add(this.axisGroup),this.axisTitle.isNew=!0),De||Ie.style.width||this.isRadial||this.axisTitle.css({width:this.len+"px"}),this.axisTitle[V?"show":"hide"](V)},ge.prototype.generateTick=function(V){var $=this.ticks;$[V]?$[V].addLabel():$[V]=new ce(this,V)},ge.prototype.getOffset=function(){var V=this,$=this,de=$.chart,Me=$.horiz,Ie=$.options,De=$.side,oe=$.ticks,ve=$.tickPositions,xe=$.coll,Re=$.axisParent,we=de.renderer,Le=de.inverted&&!$.isZAxis?[1,0,3,2][De]:De,Ne=$.hasData(),Ze=Ie.title,at=Ie.labels,wt=de.axisOffset;de=de.clipOffset;var bt,Tt=[-1,1,1,-1][De],Ut=Ie.className,lt=0,Pe=0,je=0;if($.showAxis=bt=Ne||Ie.showEmpty,$.staggerLines=$.horiz&&at.staggerLines||void 0,!$.axisGroup){var it=function(vt,Nt,Kt){return we.g(vt).attr({zIndex:Kt}).addClass("highcharts-".concat(xe.toLowerCase()).concat(Nt," ")+(V.isRadial?"highcharts-radial-axis".concat(Nt," "):"")+(Ut||"")).add(Re)};$.gridGroup=it("grid","-grid",Ie.gridZIndex),$.axisGroup=it("axis","",Ie.zIndex),$.labelGroup=it("axis-labels","-labels",at.zIndex)}if(Ne||$.isLinked?(ve.forEach(function(vt){$.generateTick(vt)}),$.renderUnsquish(),$.reserveSpaceDefault=0===De||2===De||{1:"left",3:"right"}[De]===$.labelAlign,S(at.reserveSpace,"center"===$.labelAlign||null,$.reserveSpaceDefault)&&ve.forEach(function(vt){je=Math.max(oe[vt].getLabelSize(),je)}),$.staggerLines&&(je*=$.staggerLines),$.labelOffset=je*($.opposite?-1:1)):T(oe,function(vt,Nt){vt.destroy(),delete oe[Nt]}),Ze&&Ze.text&&!1!==Ze.enabled&&($.addTitle(bt),bt&&!1!==Ze.reserveSpace)){$.titleOffset=lt=$.axisTitle.getBBox()[Me?"height":"width"];var ct=Ze.offset;Pe=H(ct)?0:S(Ze.margin,Me?5:10)}$.renderLine(),$.offset=Tt*S(Ie.offset,wt[De]?wt[De]+(Ie.margin||0):0),$.tickRotCorr=$.tickRotCorr||{x:0,y:0},Ze=0===De?-$.labelMetrics().h:2===De?$.tickRotCorr.y:0,Ne=Math.abs(je)+Pe,je&&(Ne=Ne-Ze+Tt*(Me?S(at.y,$.tickRotCorr.y+8*Tt):at.x)),$.axisTitleMargin=S(ct,Ne),$.getMaxLabelDimensions&&($.maxLabelDimensions=$.getMaxLabelDimensions(oe,ve)),"colorAxis"!==xe&&(Me=this.tickSize("tick"),wt[De]=Math.max(wt[De],($.axisTitleMargin||0)+lt+Tt*$.offset,Ne,ve&&ve.length&&Me?Me[0]+Tt*$.offset:0),Ie=!$.axisLine||Ie.offset?0:2*Math.floor($.axisLine.strokeWidth()/2),de[Le]=Math.max(de[Le],Ie)),J(this,"afterGetOffset")},ge.prototype.getLinePath=function(V){var $=this.chart,de=this.opposite,Me=this.offset,Ie=this.horiz,De=this.left+(de?this.width:0)+Me;return Me=$.chartHeight-this.bottom-(de?this.height:0)+Me,de&&(V*=-1),$.renderer.crispLine([["M",Ie?this.left:De,Ie?Me:this.top],["L",Ie?$.chartWidth-this.right:De,Ie?Me:$.chartHeight-this.bottom]],V)},ge.prototype.renderLine=function(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))},ge.prototype.getTitlePosition=function(){var V=this.horiz,$=this.left,de=this.top,Me=this.len,Ie=this.options.title,De=V?$:de,oe=this.opposite,ve=this.offset,xe=Ie.x,Re=Ie.y,we=this.axisTitle,Le=this.chart.renderer.fontMetrics(Ie.style.fontSize,we);return we=we?Math.max(we.getBBox(!1,0).height-Le.h-1,0):0,Me={low:De+(V?0:Me),middle:De+Me/2,high:De+(V?Me:0)}[Ie.align],$=(V?de+this.height:$)+(V?1:-1)*(oe?-1:1)*(this.axisTitleMargin||0)+[-we,we,Le.f,-we][this.side],J(this,"afterGetTitlePosition",{titlePosition:V={x:V?Me+xe:$+(oe?this.width:0)+ve+xe,y:V?$+Re-(oe?this.height:0)+ve:Me+Re}}),V},ge.prototype.renderMinorTick=function(V,$){var de=this.minorTicks;de[V]||(de[V]=new ce(this,V,"minor")),$&&de[V].isNew&&de[V].render(null,!0),de[V].render(null,!1,1)},ge.prototype.renderTick=function(V,$,de){var Me=this.ticks;(!this.isLinked||V>=this.min&&V<=this.max||this.grid&&this.grid.isColumn)&&(Me[V]||(Me[V]=new ce(this,V)),de&&Me[V].isNew&&Me[V].render($,!0,-1),Me[V].render($))},ge.prototype.render=function(){var Tt,Ut,V=this,$=V.chart,de=V.logarithmic,Me=V.options,Ie=V.isLinked,De=V.tickPositions,oe=V.axisTitle,ve=V.ticks,xe=V.minorTicks,Re=V.alternateBands,we=Me.stackLabels,Le=Me.alternateGridColor,Ne=V.tickmarkOffset,Ze=V.axisLine,at=V.showAxis,wt=K($.renderer.globalAnimation);if(V.labelEdge.length=0,V.overlap=!1,[ve,xe,Re].forEach(function(lt){T(lt,function(Pe){Pe.isActive=!1})}),V.hasData()||Ie){var bt=V.chart.hasRendered&&V.old&&D(V.old.min);V.minorTickInterval&&!V.categories&&V.getMinorTickPositions().forEach(function(lt){V.renderMinorTick(lt,bt)}),De.length&&(De.forEach(function(lt,Pe){V.renderTick(lt,Pe,bt)}),Ne&&(0===V.min||V.single)&&(ve[-1]||(ve[-1]=new ce(V,-1,null,!0)),ve[-1].render(-1))),Le&&De.forEach(function(lt,Pe){Ut=typeof De[Pe+1]<"u"?De[Pe+1]+Ne:V.max-Ne,Pe%2==0&&lt<V.max&&Ut<=V.max+($.polar?-Ne:Ne)&&(Re[lt]||(Re[lt]=new be.PlotLineOrBand(V)),Tt=lt+Ne,Re[lt].options={from:de?de.lin2log(Tt):Tt,to:de?de.lin2log(Ut):Ut,color:Le,className:"highcharts-alternate-grid"},Re[lt].render(),Re[lt].isActive=!0)}),V._addedPlotLB||(V._addedPlotLB=!0,(Me.plotLines||[]).concat(Me.plotBands||[]).forEach(function(lt){V.addPlotBandOrLine(lt)}))}[ve,xe,Re].forEach(function(lt){var Pe=[],je=wt.duration;T(lt,function(it,ct){it.isActive||(it.render(ct,!1,0),it.isActive=!1,Pe.push(ct))}),ae(function(){for(var it=Pe.length;it--;)lt[Pe[it]]&&!lt[Pe[it]].isActive&&(lt[Pe[it]].destroy(),delete lt[Pe[it]])},lt!==Re&&$.hasRendered&&je?je:0)}),Ze&&(Ze[Ze.isPlaced?"animate":"attr"]({d:this.getLinePath(Ze.strokeWidth())}),Ze.isPlaced=!0,Ze[at?"show":"hide"](at)),oe&&at&&(Me=V.getTitlePosition(),oe[oe.isNew?"attr":"animate"](Me),oe.isNew=!1),we&&we.enabled&&V.stacking&&V.stacking.renderStackTotals(),V.old={len:V.len,max:V.max,min:V.min,transA:V.transA,userMax:V.userMax,userMin:V.userMin},V.isDirty=!1,J(this,"afterRender")},ge.prototype.redraw=function(){this.visible&&(this.render(),this.plotLinesAndBands.forEach(function(V){V.render()})),this.series.forEach(function(V){V.isDirty=!0})},ge.prototype.getKeepProps=function(){return this.keepProps||ge.keepProps},ge.prototype.destroy=function(V){var $=this,de=$.plotLinesAndBands,Me=this.eventOptions;if(J(this,"destroy",{keepEvents:V}),V||M($),[$.ticks,$.minorTicks,$.alternateBands].forEach(function(De){W(De)}),de)for(V=de.length;V--;)de[V].destroy();for(var Ie in"axisLine axisTitle axisGroup gridGroup labelGroup cross scrollbar".split(" ").forEach(function(De){$[De]&&($[De]=$[De].destroy())}),$.plotLinesAndBandsGroups)$.plotLinesAndBandsGroups[Ie]=$.plotLinesAndBandsGroups[Ie].destroy();T($,function(De,oe){-1===$.getKeepProps().indexOf(oe)&&delete $[oe]}),this.eventOptions=Me},ge.prototype.drawCrosshair=function(V,$){var De,de=this.crosshair,Me=S(de&&de.snap,!0),Ie=this.chart,oe=this.cross;if(J(this,"drawCrosshair",{e:V,point:$}),V||(V=this.cross&&this.cross.e),de&&!1!==(H($)||!Me)){if(Me?H($)&&(De=S("colorAxis"!==this.coll?$.crosshairPos:null,this.isXAxis?$.plotX:this.len-$.plotY)):De=V&&(this.horiz?V.chartX-this.pos:this.len-V.chartY+this.pos),H(De)){var ve={value:$&&(this.isXAxis?$.x:S($.stackY,$.y)),translatedValue:De};Ie.polar&&ee(ve,{isCrosshair:!0,chartX:V&&V.chartX,chartY:V&&V.chartY,point:$}),ve=this.getPlotLinePath(ve)||null}if(!H(ve))return void this.hideCrosshair();Me=this.categories&&!this.isRadial,oe||(this.cross=oe=Ie.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(Me?"category ":"thin ")+(de.className||"")).attr({zIndex:S(de.zIndex,2)}).add(),Ie.styledMode||(oe.attr({stroke:de.color||(Me?Te.parse("#ccd6eb").setOpacity(.25).get():"#cccccc"),"stroke-width":S(de.width,1)}).css({"pointer-events":"none"}),de.dashStyle&&oe.attr({dashstyle:de.dashStyle}))),oe.show().attr({d:ve}),Me&&!de.width&&oe.attr({"stroke-width":this.transA}),this.cross.e=V}else this.hideCrosshair();J(this,"afterDrawCrosshair",{e:V,point:$})},ge.prototype.hideCrosshair=function(){this.cross&&this.cross.hide(),J(this,"afterHideCrosshair")},ge.prototype.hasVerticalPanning=function(){var V=this.chart.options.chart.panning;return!!(V&&V.enabled&&/y/.test(V.type))},ge.prototype.validatePositiveValue=function(V){return D(V)&&0<V},ge.prototype.update=function(V,$){var de=this.chart;V=A(this.userOptions,V),this.destroy(!0),this.init(de,V),de.isDirtyBox=!0,S($,!0)&&de.redraw()},ge.prototype.remove=function(V){for(var $=this.chart,de=this.coll,Me=this.series,Ie=Me.length;Ie--;)Me[Ie]&&Me[Ie].remove(!1);ie($.axes,this),ie($[de],this),$[de].forEach(function(De,oe){De.options.index=De.userOptions.index=oe}),this.destroy(),$.isDirtyBox=!0,S(V,!0)&&$.redraw()},ge.prototype.setTitle=function(V,$){this.update({title:V},$)},ge.prototype.setCategories=function(V,$){this.update({categories:V},$)},ge.defaultOptions=me.defaultXAxisOptions,ge.keepProps="extKey hcEvents names series userMax userMin".split(" "),ge}()}),Ge(u,"Core/Axis/DateTimeAxis.js",[u["Core/Utilities.js"]],function(re){var be,me=re.addEvent,Te=re.getMagnitude,Ce=re.normalizeTickInterval,Se=re.timeUnits;return function(ce){function ne(){return this.chart.time.getTimeTicks.apply(this.chart.time,arguments)}function K(N){"datetime"!==N.userOptions.type?this.dateTime=void 0:this.dateTime||(this.dateTime=new j(this))}var Y=[];ce.compose=function(N){return-1===Y.indexOf(N)&&(Y.push(N),N.keepProps.push("dateTime"),N.prototype.getTimeTicks=ne,me(N,"init",K)),N};var j=function(){function N(R){this.axis=R}return N.prototype.normalizeTimeTickInterval=function(R,I){var W,B=I||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],P=Se[(I=B[B.length-1])[0]],H=I[1];for(W=0;W<B.length&&(P=Se[(I=B[W])[0]],H=I[1],!(B[W+1]&&R<=(P*H[H.length-1]+Se[B[W+1][0]])/2));W++);return P===Se.year&&R<5*P&&(H=[1,2,5]),{unitRange:P,count:R=Ce(R/P,H,"year"===I[0]?Math.max(Te(R/P),1):1),unitName:I[0]}},N.prototype.getXDateFormat=function(R,I){var B=this.axis,P=B.chart.time;return B.closestPointRange?P.getDateFormat(B.closestPointRange,R,B.options.startOfWeek,I)||P.resolveDTLFormat(I.year).main:P.resolveDTLFormat(I.day).main},N}();ce.Additions=j}(be||(be={})),be}),Ge(u,"Core/Axis/LogarithmicAxis.js",[u["Core/Utilities.js"]],function(re){var Se,me=re.addEvent,Te=re.normalizeTickInterval,Ce=re.pick;return function(be){function ce(j){var N=this.logarithmic;"logarithmic"!==j.userOptions.type?this.logarithmic=void 0:N||(this.logarithmic=new Y(this))}function ne(){var j=this.logarithmic;j&&(this.lin2val=function(N){return j.lin2log(N)},this.val2lin=function(N){return j.log2lin(N)})}var K=[];be.compose=function(j){return-1===K.indexOf(j)&&(K.push(j),j.keepProps.push("logarithmic"),me(j,"init",ce),me(j,"afterInit",ne)),j};var Y=function(){function j(N){this.axis=N}return j.prototype.getLogTickPositions=function(N,R,I,B){var P=this.axis,H=P.len,W=P.options,ie=[];if(B||(this.minorAutoInterval=void 0),.5<=N)N=Math.round(N),ie=P.getLinearTickPositions(N,R,I);else if(.08<=N){var ee,te=Math.floor(R),J=W=void 0;for(H=.3<N?[1,2,4]:.15<N?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];te<I+1&&!J;te++){var q=H.length;for(ee=0;ee<q&&!J;ee++){var D=this.log2lin(this.lin2log(te)*H[ee]);D>R&&(!B||W<=I)&&typeof W<"u"&&ie.push(W),W>I&&(J=!0),W=D}}}else R=this.lin2log(R),I=this.lin2log(I),N=B?P.getMinorTickInterval():W.tickInterval,N=Ce("auto"===N?null:N,this.minorAutoInterval,W.tickPixelInterval/(B?5:1)*(I-R)/((B?H/P.tickPositions.length:H)||1)),N=Te(N),ie=P.getLinearTickPositions(N,R,I).map(this.log2lin),B||(this.minorAutoInterval=N/5);return B||(P.tickInterval=N),ie},j.prototype.lin2log=function(N){return Math.pow(10,N)},j.prototype.log2lin=function(N){return Math.log(N)/Math.LN10},j}();be.Additions=Y}(Se||(Se={})),Se}),Ge(u,"Core/Axis/PlotLineOrBand/PlotLineOrBandAxis.js",[u["Core/Utilities.js"]],function(re){var Se,me=re.erase,Te=re.extend,Ce=re.isNumber;return function(be){var ne,ce=[];be.compose=function(Y,j){return ne||(ne=Y),-1===ce.indexOf(j)&&(ce.push(j),Te(j.prototype,K.prototype)),j};var K=function(){function Y(){}return Y.prototype.getPlotBandPath=function(j,N,R){void 0===R&&(R=this.options);var I=this.getPlotLinePath({value:N,force:!0,acrossPanes:R.acrossPanes}),B=[],P=this.horiz;if(N=!Ce(this.min)||!Ce(this.max)||j<this.min&&N<this.min||j>this.max&&N>this.max,j=this.getPlotLinePath({value:j,force:!0,acrossPanes:R.acrossPanes}),R=1,j&&I){if(N){var H=j.toString()===I.toString();R=0}for(N=0;N<j.length;N+=2){var W=j[N],ie=j[N+1],te=I[N],ee=I[N+1];"M"!==W[0]&&"L"!==W[0]||"M"!==ie[0]&&"L"!==ie[0]||"M"!==te[0]&&"L"!==te[0]||"M"!==ee[0]&&"L"!==ee[0]||(P&&te[1]===W[1]?(te[1]+=R,ee[1]+=R):P||te[2]!==W[2]||(te[2]+=R,ee[2]+=R),B.push(["M",W[1],W[2]],["L",ie[1],ie[2]],["L",ee[1],ee[2]],["L",te[1],te[2]],["Z"])),B.isFlat=H}}return B},Y.prototype.addPlotBand=function(j){return this.addPlotBandOrLine(j,"plotBands")},Y.prototype.addPlotLine=function(j){return this.addPlotBandOrLine(j,"plotLines")},Y.prototype.addPlotBandOrLine=function(j,N){var R=this,I=this.userOptions,B=new ne(this,j);if(this.visible&&(B=B.render()),B){if(this._addedPlotLB||(this._addedPlotLB=!0,(I.plotLines||[]).concat(I.plotBands||[]).forEach(function(H){R.addPlotBandOrLine(H)})),N){var P=I[N]||[];P.push(j),I[N]=P}this.plotLinesAndBands.push(B)}return B},Y.prototype.removePlotBandOrLine=function(j){var N=this.plotLinesAndBands,R=this.options,I=this.userOptions;if(N){for(var B=N.length;B--;)N[B].id===j&&N[B].destroy();[R.plotLines||[],I.plotLines||[],R.plotBands||[],I.plotBands||[]].forEach(function(P){for(B=P.length;B--;)(P[B]||{}).id===j&&me(P,P[B])})}},Y.prototype.removePlotBand=function(j){this.removePlotBandOrLine(j)},Y.prototype.removePlotLine=function(j){this.removePlotBandOrLine(j)},Y}()}(Se||(Se={})),Se}),Ge(u,"Core/Axis/PlotLineOrBand/PlotLineOrBand.js",[u["Core/Axis/PlotLineOrBand/PlotLineOrBandAxis.js"],u["Core/Utilities.js"]],function(re,me){var Te=me.arrayMax,Ce=me.arrayMin,Se=me.defined,be=me.destroyObjectProperties,ce=me.erase,ne=me.fireEvent,K=me.merge,Y=me.objectEach,j=me.pick;return function(){function N(R,I){this.axis=R,I&&(this.options=I,this.id=I.id)}return N.compose=function(R){return re.compose(N,R)},N.prototype.render=function(){ne(this,"render");var R=this,I=R.axis,B=I.horiz,P=I.logarithmic,H=R.options,W=H.color,ie=j(H.zIndex,0),te=H.events,ee={},J=I.chart.renderer,q=H.label,D=R.label,z=H.to,A=H.from,U=H.value,T=R.svgElem,S=[],O=Se(A)&&Se(z);S=Se(U);var M=!T,Z={class:"highcharts-plot-"+(O?"band ":"line ")+(H.className||"")},ae=O?"bands":"lines";if(P&&(A=P.log2lin(A),z=P.log2lin(z),U=P.log2lin(U)),I.chart.styledMode||(S?(Z.stroke=W||"#999999",Z["stroke-width"]=j(H.width,1),H.dashStyle&&(Z.dashstyle=H.dashStyle)):O&&(Z.fill=W||"#e6ebf5",H.borderWidth&&(Z.stroke=H.borderColor,Z["stroke-width"]=H.borderWidth))),ee.zIndex=ie,(P=I.plotLinesAndBandsGroups[ae+="-"+ie])||(I.plotLinesAndBandsGroups[ae]=P=J.g("plot-"+ae).attr(ee).add()),M&&(R.svgElem=T=J.path().attr(Z).add(P)),S)S=I.getPlotLinePath({value:U,lineWidth:T.strokeWidth(),acrossPanes:H.acrossPanes});else{if(!O)return;S=I.getPlotBandPath(A,z,H)}return!R.eventsAdded&&te&&(Y(te,function(ue,ge){T.on(ge,function(V){te[ge].apply(R,[V])})}),R.eventsAdded=!0),(M||!T.d)&&S&&S.length?T.attr({d:S}):T&&(S?(T.show(),T.animate({d:S})):T.d&&(T.hide(),D&&(R.label=D=D.destroy()))),q&&(Se(q.text)||Se(q.formatter))&&S&&S.length&&0<I.width&&0<I.height&&!S.isFlat?(q=K({align:B&&O&&"center",x:B?!O&&4:10,verticalAlign:!B&&O&&"middle",y:B?O?16:10:O?6:-4,rotation:B&&!O&&90},q),this.renderLabel(q,S,O,ie)):D&&D.hide(),R},N.prototype.renderLabel=function(R,I,B,P){var H=this.axis,W=H.chart.renderer,ie=this.label;ie||(this.label=ie=W.text(this.getLabelText(R),0,0,R.useHTML).attr({align:R.textAlign||R.align,rotation:R.rotation,class:"highcharts-plot-"+(B?"band":"line")+"-label "+(R.className||""),zIndex:P}).add(),H.chart.styledMode||ie.css(K({textOverflow:"ellipsis"},R.style))),P=I.xBounds||[I[0][1],I[1][1],B?I[2][1]:I[0][1]],I=I.yBounds||[I[0][2],I[1][2],B?I[2][2]:I[0][2]],B=Ce(P),W=Ce(I),ie.align(R,!1,{x:B,y:W,width:Te(P)-B,height:Te(I)-W}),ie.alignValue&&"left"!==ie.alignValue||ie.css({width:(90===ie.rotation?H.height-(ie.alignAttr.y-H.top):H.width-(ie.alignAttr.x-H.left))+"px"}),ie.show(!0)},N.prototype.getLabelText=function(R){return Se(R.formatter)?R.formatter.call(this):R.text},N.prototype.destroy=function(){ce(this.axis.plotLinesAndBands,this),delete this.axis,be(this)},N}()}),Ge(u,"Core/Tooltip.js",[u["Core/FormatUtilities.js"],u["Core/Globals.js"],u["Core/Renderer/RendererUtilities.js"],u["Core/Renderer/RendererRegistry.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce,Se){var be=re.format,ce=me.doc,ne=Te.distribute,K=Se.addEvent,Y=Se.clamp,j=Se.css,N=Se.defined,R=Se.discardElement,I=Se.extend,B=Se.fireEvent,P=Se.isArray,H=Se.isNumber,W=Se.isString,ie=Se.merge,te=Se.pick,ee=Se.splat,J=Se.syncTimeout;return function(){function q(D,z){this.allowShared=!0,this.container=void 0,this.crosshairs=[],this.distance=0,this.isHidden=!0,this.isSticky=!1,this.now={},this.options={},this.outside=!1,this.chart=D,this.init(D,z)}return q.prototype.applyFilter=function(){var D=this.chart;D.renderer.definition({tagName:"filter",attributes:{id:"drop-shadow-"+D.index,opacity:.5},children:[{tagName:"feGaussianBlur",attributes:{in:"SourceAlpha",stdDeviation:1}},{tagName:"feOffset",attributes:{dx:1,dy:1}},{tagName:"feComponentTransfer",children:[{tagName:"feFuncA",attributes:{type:"linear",slope:.3}}]},{tagName:"feMerge",children:[{tagName:"feMergeNode"},{tagName:"feMergeNode",attributes:{in:"SourceGraphic"}}]}]})},q.prototype.bodyFormatter=function(D){return D.map(function(z){var A=z.series.tooltipOptions;return(A[(z.point.formatPrefix||"point")+"Formatter"]||z.point.tooltipFormatter).call(z.point,A[(z.point.formatPrefix||"point")+"Format"]||"")})},q.prototype.cleanSplit=function(D){this.chart.series.forEach(function(z){var A=z&&z.tt;A&&(!A.isActive||D?z.tt=A.destroy():A.isActive=!1)})},q.prototype.defaultFormatter=function(D){var z=this.points||ee(this),A=[D.tooltipFooterHeaderFormatter(z[0])];return(A=A.concat(D.bodyFormatter(z))).push(D.tooltipFooterHeaderFormatter(z[0],!0)),A},q.prototype.destroy=function(){this.label&&(this.label=this.label.destroy()),this.split&&this.tt&&(this.cleanSplit(!0),this.tt=this.tt.destroy()),this.renderer&&(this.renderer=this.renderer.destroy(),R(this.container)),Se.clearTimeout(this.hideTimer),Se.clearTimeout(this.tooltipTimeout)},q.prototype.getAnchor=function(D,z){var M,Z,A=this.chart,U=A.pointer,T=A.inverted,S=A.plotTop,O=A.plotLeft,ae=0,ue=0;return D=ee(D),this.followPointer&&z?(typeof z.chartX>"u"&&(z=U.normalize(z)),U=[z.chartX-O,z.chartY-S]):D[0].tooltipPos?U=D[0].tooltipPos:(D.forEach(function(ge){M=ge.series.yAxis,ae+=ge.plotX||0,ue+=ge.plotLow?(ge.plotLow+(ge.plotHigh||0))/2:ge.plotY||0,(Z=ge.series.xAxis)&&M&&(T?(ae+=S+A.plotHeight-Z.len-Z.pos,ue+=O+A.plotWidth-M.len-M.pos):(ae+=Z.pos-O,ue+=M.pos-S))}),ae/=D.length,ue/=D.length,U=[T?A.plotWidth-ue:ae,T?A.plotHeight-ae:ue],this.shared&&1<D.length&&z&&(T?U[0]=z.chartX-O:U[1]=z.chartY-S)),U.map(Math.round)},q.prototype.getLabel=function(){var Z,D=this,z=this.chart.styledMode,A=this.options,U=this.split&&this.allowShared,T="tooltip"+(N(A.className)?" "+A.className:""),S=A.style.pointerEvents||(!this.followPointer&&A.stickOnContact?"auto":"none"),O=function(){D.inContact=!0},M=function(Me){var Ie=D.chart.hoverSeries;D.inContact=D.shouldStickOnContact()&&D.chart.pointer.inClass(Me.relatedTarget,"highcharts-tooltip"),!D.inContact&&Ie&&Ie.onMouseOut&&Ie.onMouseOut()},ae=this.chart.renderer;if(D.label){var ue=!D.label.hasClass("highcharts-label");(U&&!ue||!U&&ue)&&D.destroy()}if(!this.label){if(this.outside){ue=this.chart.options.chart.style;var ge=Ce.getRendererType();this.container=Z=me.doc.createElement("div"),Z.className="highcharts-tooltip-container",j(Z,{position:"absolute",top:"1px",pointerEvents:S,zIndex:Math.max(this.options.style.zIndex||0,(ue&&ue.zIndex||0)+3)}),K(Z,"mouseenter",O),K(Z,"mouseleave",M),me.doc.body.appendChild(Z),this.renderer=ae=new ge(Z,0,0,ue,void 0,void 0,ae.styledMode)}if(U?this.label=ae.g(T):(this.label=ae.label("",0,0,A.shape,void 0,void 0,A.useHTML,void 0,T).attr({padding:A.padding,r:A.borderRadius}),z||this.label.attr({fill:A.backgroundColor,"stroke-width":A.borderWidth}).css(A.style).css({pointerEvents:S}).shadow(A.shadow)),z&&A.shadow&&(this.applyFilter(),this.label.attr({filter:"url(#drop-shadow-"+this.chart.index+")"})),D.outside&&!D.split){var V=this.label,$=V.xSetter,de=V.ySetter;V.xSetter=function(Me){$.call(V,D.distance),Z.style.left=Me+"px"},V.ySetter=function(Me){de.call(V,D.distance),Z.style.top=Me+"px"}}this.label.on("mouseenter",O).on("mouseleave",M).attr({zIndex:8}).add()}return this.label},q.prototype.getPosition=function(D,z,A){var de,U=this.chart,T=this.distance,S={},O=U.inverted&&A.h||0,M=this.outside,Z=M?ce.documentElement.clientWidth-2*T:U.chartWidth,ae=M?Math.max(ce.body.scrollHeight,ce.documentElement.scrollHeight,ce.body.offsetHeight,ce.documentElement.offsetHeight,ce.documentElement.clientHeight):U.chartHeight,ue=U.pointer.getChartPosition(),ge=function(xe){var Re="x"===xe;return[xe,Re?Z:ae,Re?D:z].concat(M?[Re?D*ue.scaleX:z*ue.scaleY,Re?ue.left-T+(A.plotX+U.plotLeft)*ue.scaleX:ue.top-T+(A.plotY+U.plotTop)*ue.scaleY,0,Re?Z:ae]:[Re?D:z,Re?A.plotX+U.plotLeft:A.plotY+U.plotTop,Re?U.plotLeft:U.plotTop,Re?U.plotLeft+U.plotWidth:U.plotTop+U.plotHeight])},V=ge("y"),$=ge("x");ge=!!A.negative,!U.polar&&U.hoverSeries&&U.hoverSeries.yAxis&&U.hoverSeries.yAxis.reversed&&(ge=!ge);var Me=!this.followPointer&&te(A.ttBelow,!U.inverted===ge),Ie=function(xe,Re,we,Le,Ne,Ze,at){var wt=M?"y"===xe?T*ue.scaleY:T*ue.scaleX:T,Tt=(we-Le)/2,Ut=Le<Ne-T,bt=Ne+T+Le<Re,lt=Ne-wt-we+Tt;if(Ne=Ne+wt-Tt,Me&&bt)S[xe]=Ne;else if(!Me&&Ut)S[xe]=lt;else if(Ut)S[xe]=Math.min(at-Le,0>lt-O?lt:lt-O);else{if(!bt)return!1;S[xe]=Math.max(Ze,Ne+O+we>Re?Ne:Ne+O)}},De=function(xe,Re,we,Le,Ne){var Ze;return Ne<T||Ne>Re-T?Ze=!1:S[xe]=Ne<we/2?1:Ne>Re-Le/2?Re-Le-2:Ne-we/2,Ze},oe=function(xe){var Re=V;V=$,$=Re,de=xe},ve=function(){!1!==Ie.apply(0,V)?!1!==De.apply(0,$)||de||(oe(!0),ve()):de?S.x=S.y=0:(oe(!0),ve())};return(U.inverted||1<this.len)&&oe(),ve(),S},q.prototype.hide=function(D){var z=this;Se.clearTimeout(this.hideTimer),D=te(D,this.options.hideDelay),this.isHidden||(this.hideTimer=J(function(){z.getLabel().fadeOut(D&&void 0),z.isHidden=!0},D))},q.prototype.init=function(D,z){this.chart=D,this.options=z,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.split=z.split&&!D.inverted&&!D.polar,this.shared=z.shared||this.split,this.outside=te(z.outside,!(!D.scrollablePixelsX&&!D.scrollablePixelsY))},q.prototype.shouldStickOnContact=function(){return!(this.followPointer||!this.options.stickOnContact)},q.prototype.isStickyOnContact=function(){return!(!this.shouldStickOnContact()||!this.inContact)},q.prototype.move=function(D,z,A,U){var T=this,S=T.now,O=!1!==T.options.animation&&!T.isHidden&&(1<Math.abs(D-S.x)||1<Math.abs(z-S.y)),M=T.followPointer||1<T.len;I(S,{x:O?(2*S.x+D)/3:D,y:O?(S.y+z)/2:z,anchorX:M?void 0:O?(2*S.anchorX+A)/3:A,anchorY:M?void 0:O?(S.anchorY+U)/2:U}),T.getLabel().attr(S),T.drawTracker(),O&&(Se.clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){T&&T.move(D,z,A,U)},32))},q.prototype.refresh=function(D,z){var A=this.chart,U=this.options,T=ee(D),S=T[0],O=[],M=U.formatter||this.defaultFormatter,Z=this.shared,ae=A.styledMode,ue={};if(U.enabled&&S.series){Se.clearTimeout(this.hideTimer),this.allowShared=!(!P(D)&&D.series&&D.series.noSharedTooltip),this.followPointer=!this.split&&S.series.tooltipOptions.followPointer;var ge=(D=this.getAnchor(D,z))[0],V=D[1];if(Z&&this.allowShared?(A.pointer.applyInactiveState(T),T.forEach(function(Me){Me.setState("hover"),O.push(Me.getLabelConfig())}),(ue={x:S.category,y:S.y}).points=O):ue=S.getLabelConfig(),this.len=O.length,M=M.call(ue,this),this.distance=te((Z=S.series).tooltipOptions.distance,16),!1===M)this.hide();else{if(this.split&&this.allowShared)this.renderSplit(M,T);else{var $=ge,de=V;if(z&&A.pointer.isDirectTouch&&($=z.chartX-A.plotLeft,de=z.chartY-A.plotTop),!A.polar&&!1!==Z.options.clip&&!T.some(function(Me){return Me.series.shouldShowTooltip($,de)}))return void this.hide();z=this.getLabel(),U.style.width&&!ae||z.css({width:this.chart.spacingBox.width+"px"}),z.attr({text:M&&M.join?M.join(""):M}),z.removeClass(/highcharts-color-[\d]+/g).addClass("highcharts-color-"+te(S.colorIndex,Z.colorIndex)),ae||z.attr({stroke:U.borderColor||S.color||Z.color||"#666666"}),this.updatePosition({plotX:ge,plotY:V,negative:S.negative,ttBelow:S.ttBelow,h:D[2]||0})}this.isHidden&&this.label&&this.label.attr({opacity:1}).show(),this.isHidden=!1}B(this,"refresh")}},q.prototype.renderSplit=function(D,z){function A(bt,lt,Pe,je,it){return void 0===it&&(it=!0),Pe?(lt=Le?0:wt,bt=Y(bt-je/2,xe.left,xe.right-je-(U.outside?Ne:0))):(lt-=Ze,bt=Y(bt=it?bt-je-De:bt+De,it?bt:xe.left,xe.right)),{x:bt,y:lt}}var U=this,T=U.chart,S=U.chart,O=S.chartWidth,M=S.chartHeight,Z=S.plotHeight,ae=S.plotLeft,ue=S.plotTop,ge=S.pointer,V=S.scrollablePixelsY;V=void 0===V?0:V;var de=S.scrollingContainer,Me=(de=void 0===de?{scrollLeft:0,scrollTop:0}:de).scrollLeft;de=de.scrollTop;var Ie=S.styledMode,De=U.distance,oe=U.options,ve=U.options.positioner,xe=U.outside&&"number"!=typeof S.scrollablePixelsX?ce.documentElement.getBoundingClientRect():{left:Me,right:Me+O,top:de,bottom:de+M},Re=U.getLabel(),we=this.renderer||T.renderer,Le=!(!T.xAxis[0]||!T.xAxis[0].opposite),Ne=(T=ge.getChartPosition()).left;T=T.top;var Ze=ue+de,at=0,wt=Z-V;W(D)&&(D=[!1,D]),D=D.slice(0,z.length+1).reduce(function(bt,lt,Pe){if(!1!==lt&&""!==lt){var je=(Pe=z[Pe-1]||{isHeader:!0,plotX:z[0].plotX,plotY:Z,series:{}}).isHeader,it=je?U:Pe.series;lt=lt.toString();var ct=it.tt,vt=Pe.isHeader,Nt=Pe.series,Kt="highcharts-color-"+te(Pe.colorIndex,Nt.colorIndex,"none");if(ct||(ct={padding:oe.padding,r:oe.borderRadius},Ie||(ct.fill=oe.backgroundColor,ct["stroke-width"]=oe.borderWidth),ct=we.label("",0,0,oe[vt?"headerShape":"shape"],void 0,void 0,oe.useHTML).addClass((vt?"highcharts-tooltip-header ":"")+"highcharts-tooltip-box "+Kt).attr(ct).add(Re)),ct.isActive=!0,ct.attr({text:lt}),Ie||ct.css(oe.style).shadow(oe.shadow).attr({stroke:oe.borderColor||Pe.color||Nt.color||"#333333"}),lt=(vt=(it=it.tt=ct).getBBox()).width+it.strokeWidth(),je&&(wt+=at=vt.height,Le&&(Ze-=at)),Nt=void 0===(Nt=Pe.plotX)?0:Nt,Kt=void 0===(Kt=Pe.plotY)?0:Kt,ct=Pe.series,Pe.isHeader){Nt=ae+Nt;var vi=ue+Z/2}else{var Ki=ct.xAxis,mi=ct.yAxis;Nt=Ki.pos+Y(Nt,-De,Ki.len+De),ct.shouldShowTooltip(0,mi.pos-ue+Kt,{ignoreX:!0})&&(vi=mi.pos+Kt)}Nt=Y(Nt,xe.left-De,xe.right+De),"number"==typeof vi?(vt=vt.height+1,Kt=ve?ve.call(U,lt,vt,Pe):A(Nt,vi,je,lt),bt.push({align:ve?0:void 0,anchorX:Nt,anchorY:vi,boxWidth:lt,point:Pe,rank:te(Kt.rank,je?1:0),size:vt,target:Kt.y,tt:it,x:Kt.x})):it.isActive=!1}return bt},[]),!ve&&D.some(function(bt){var lt=(U.outside?Ne:0)+bt.anchorX;return lt<xe.left&&lt+bt.boxWidth<xe.right||lt<Ne-xe.left+bt.boxWidth&&xe.right-lt>lt})&&(D=D.map(function(bt){var lt=A(bt.anchorX,bt.anchorY,bt.point.isHeader,bt.boxWidth,!1);return I(bt,{target:lt.y,x:lt.x})})),U.cleanSplit(),ne(D,wt);var Tt=Ne,Ut=Ne;D.forEach(function(bt){var lt=bt.x,Pe=bt.boxWidth;(bt=bt.isHeader)||(U.outside&&Ne+lt<Tt&&(Tt=Ne+lt),!bt&&U.outside&&Tt+Pe>Ut&&(Ut=Ne+lt))}),D.forEach(function(bt){var lt=bt.x,Pe=bt.anchorX,je=bt.pos,it=bt.point.isHeader;if(je={visibility:typeof je>"u"?"hidden":"inherit",x:lt,y:je+Ze,anchorX:Pe,anchorY:bt.anchorY},U.outside&&lt<Pe){var ct=Ne-Tt;0<ct&&(it||(je.x=lt+ct,je.anchorX=Pe+ct),it&&(je.x=(Ut-Tt)/2,je.anchorX=Pe+ct))}bt.tt.attr(je)}),D=U.container,V=U.renderer,U.outside&&D&&V&&(S=Re.getBBox(),V.setSize(S.width+S.x,S.height+S.y,!1),D.style.left=Tt+"px",D.style.top=T+"px")},q.prototype.drawTracker=function(){if(this.followPointer||!this.options.stickOnContact)this.tracker&&this.tracker.destroy();else{var D=this.chart,z=this.label,A=this.shared?D.hoverPoints:D.hoverPoint;if(z&&A){var U={x:0,y:0,width:0,height:0};A=this.getAnchor(A);var T=z.getBBox();A[0]+=D.plotLeft-z.translateX,A[1]+=D.plotTop-z.translateY,U.x=Math.min(0,A[0]),U.y=Math.min(0,A[1]),U.width=0>A[0]?Math.max(Math.abs(A[0]),T.width-A[0]):Math.max(Math.abs(A[0]),T.width),U.height=0>A[1]?Math.max(Math.abs(A[1]),T.height-Math.abs(A[1])):Math.max(Math.abs(A[1]),T.height),this.tracker?this.tracker.attr(U):(this.tracker=z.renderer.rect(U).addClass("highcharts-tracker").add(z),D.styledMode||this.tracker.attr({fill:"rgba(0,0,0,0)"}))}}},q.prototype.styledModeFormat=function(D){return D.replace('style="font-size: 10px"','class="highcharts-header"').replace(/style="color:{(point|series)\.color}"/g,'class="highcharts-color-{$1.colorIndex}"')},q.prototype.tooltipFooterHeaderFormatter=function(D,z){var A=D.series,U=A.tooltipOptions,T=A.xAxis,S=T&&T.dateTime,O=U.xDateFormat,M=U[z?"footerFormat":"headerFormat"];return B(this,"headerFormatter",T={isFooter:z,labelConfig:D},function(Z){S&&!O&&H(D.key)&&(O=S.getXDateFormat(D.key,U.dateTimeLabelFormats)),S&&O&&(D.point&&D.point.tooltipDateKeys||["key"]).forEach(function(ae){M=M.replace("{point."+ae+"}","{point."+ae+":"+O+"}")}),A.chart.styledMode&&(M=this.styledModeFormat(M)),Z.text=be(M,{point:D,series:A},this.chart)}),T.text},q.prototype.update=function(D){this.destroy(),ie(!0,this.chart.options.tooltip.userOptions,D),this.init(this.chart,ie(!0,this.options,D))},q.prototype.updatePosition=function(D){var z=this.chart,A=this.options,U=z.pointer,T=this.getLabel();U=U.getChartPosition();var S=(A.positioner||this.getPosition).call(this,T.width,T.height,D),O=D.plotX+z.plotLeft;D=D.plotY+z.plotTop,this.outside&&(this.renderer.setSize(T.width+(A=A.borderWidth+2*this.distance),T.height+A,!1),(1!==U.scaleX||1!==U.scaleY)&&(j(this.container,{transform:"scale(".concat(U.scaleX,", ").concat(U.scaleY,")")}),O*=U.scaleX,D*=U.scaleY),O+=U.left-S.x,D+=U.top-S.y),this.move(Math.round(S.x),Math.round(S.y||0),O,D)},q}()}),Ge(u,"Core/Series/Point.js",[u["Core/Renderer/HTML/AST.js"],u["Core/Animation/AnimationUtilities.js"],u["Core/DefaultOptions.js"],u["Core/FormatUtilities.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce,Se){var be=me.animObject,ce=Te.defaultOptions,ne=Ce.format,K=Se.addEvent,Y=Se.defined,j=Se.erase,N=Se.extend,R=Se.fireEvent,I=Se.getNestedProperty,B=Se.isArray,P=Se.isFunction,H=Se.isNumber,W=Se.isObject,ie=Se.merge,te=Se.objectEach,ee=Se.pick,J=Se.syncTimeout,q=Se.removeEvent,D=Se.uniqueKey;return function(){function z(){this.colorIndex=this.category=void 0,this.formatPrefix="point",this.id=void 0,this.isNull=!1,this.percentage=this.options=this.name=void 0,this.selected=!1,this.total=this.shapeArgs=this.series=void 0,this.visible=!0,this.x=void 0}return z.prototype.animateBeforeDestroy=function(){var A=this,U={x:A.startXPos,opacity:0},T=A.getGraphicalProps();T.singular.forEach(function(S){A[S]=A[S].animate("dataLabel"===S?{x:A[S].startXPos,y:A[S].startYPos,opacity:0}:U)}),T.plural.forEach(function(S){A[S].forEach(function(O){O.element&&O.animate(N({x:A.startXPos},O.startYPos?{x:O.startXPos,y:O.startYPos}:{}))})})},z.prototype.applyOptions=function(A,U){var T=this.series,S=T.options.pointValKey||T.pointValKey;return A=z.prototype.optionsToObject.call(this,A),N(this,A),this.options=this.options?N(this.options,A):A,A.group&&delete this.group,A.dataLabels&&delete this.dataLabels,S&&(this.y=z.prototype.getNestedProperty.call(this,S)),this.formatPrefix=(this.isNull=ee(this.isValid&&!this.isValid(),null===this.x||!H(this.y)))?"null":"point",this.selected&&(this.state="select"),"name"in this&&typeof U>"u"&&T.xAxis&&T.xAxis.hasNames&&(this.x=T.xAxis.nameToX(this)),typeof this.x>"u"&&T?this.x=typeof U>"u"?T.autoIncrement():U:H(A.x)&&T.options.relativeXValue&&(this.x=T.autoIncrement(A.x)),this},z.prototype.destroy=function(){function A(){for(Z in(U.graphic||U.dataLabel||U.dataLabels)&&(q(U),U.destroyElements()),U)U[Z]=null}var U=this,T=U.series,S=T.chart;T=T.options.dataSorting;var Z,O=S.hoverPoints,M=be(U.series.chart.renderer.globalAnimation);U.legendItem&&S.legend.destroyItem(U),O&&(U.setState(),j(O,U),O.length||(S.hoverPoints=null)),U===S.hoverPoint&&U.onMouseOut(),T&&T.enabled?(this.animateBeforeDestroy(),J(A,M.duration)):A(),S.pointCount--},z.prototype.destroyElements=function(A){var U=this;(A=U.getGraphicalProps(A)).singular.forEach(function(T){U[T]=U[T].destroy()}),A.plural.forEach(function(T){U[T].forEach(function(S){S.element&&S.destroy()}),delete U[T]})},z.prototype.firePointEvent=function(A,U,T){var S=this,O=this.series.options;(O.point.events[A]||S.options&&S.options.events&&S.options.events[A])&&S.importEvents(),"click"===A&&O.allowPointSelect&&(T=function(M){S.select&&S.select(null,M.ctrlKey||M.metaKey||M.shiftKey)}),R(S,A,U,T)},z.prototype.getClassName=function(){return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(typeof this.colorIndex<"u"?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+(this.zone&&this.zone.className?" "+this.zone.className.replace("highcharts-negative",""):"")},z.prototype.getGraphicalProps=function(A){var O,U=this,T=[],S={singular:[],plural:[]};for((A=A||{graphic:1,dataLabel:1}).graphic&&T.push("graphic","upperGraphic","shadowGroup"),A.dataLabel&&T.push("dataLabel","dataLabelPath","dataLabelUpper","connector"),O=T.length;O--;){var M=T[O];U[M]&&S.singular.push(M)}return["dataLabel","connector"].forEach(function(Z){var ae=Z+"s";A[Z]&&U[ae]&&S.plural.push(ae)}),S},z.prototype.getLabelConfig=function(){return{x:this.category,y:this.y,color:this.color,colorIndex:this.colorIndex,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},z.prototype.getNestedProperty=function(A){if(A)return 0===A.indexOf("custom.")?I(A,this.options):this[A]},z.prototype.getZone=function(){var A=this.series,U=A.zones;A=A.zoneAxis||"y";var T,S=0;for(T=U[S];this[A]>=T.value;)T=U[++S];return this.nonZonedColor||(this.nonZonedColor=this.color),this.color=T&&T.color&&!this.options.color?T.color:this.nonZonedColor,T},z.prototype.hasNewShapeType=function(){return(this.graphic&&(this.graphic.symbolName||this.graphic.element.nodeName))!==this.shapeType},z.prototype.init=function(A,U,T){return this.series=A,this.applyOptions(U,T),this.id=Y(this.id)?this.id:D(),this.resolveColor(),A.chart.pointCount++,R(this,"afterInit"),this},z.prototype.optionsToObject=function(A){var U=this.series,T=U.options.keys,S=T||U.pointArrayMap||["y"],O=S.length,M={},Z=0,ae=0;if(H(A)||null===A)M[S[0]]=A;else if(B(A))for(!T&&A.length>O&&("string"==(U=typeof A[0])?M.name=A[0]:"number"===U&&(M.x=A[0]),Z++);ae<O;)T&&typeof A[Z]>"u"||(0<S[ae].indexOf(".")?z.prototype.setNestedProperty(M,A[Z],S[ae]):M[S[ae]]=A[Z]),Z++,ae++;else"object"==typeof A&&(M=A,A.dataLabels&&(U._hasPointLabels=!0),A.marker&&(U._hasPointMarkers=!0));return M},z.prototype.resolveColor=function(){var A=this.series,U=A.chart.styledMode,T=A.chart.options.chart.colorCount;if(delete this.nonZonedColor,A.options.colorByPoint){if(!U){var S=(T=A.options.colors||A.chart.options.colors)[A.colorCounter];T=T.length}U=A.colorCounter,A.colorCounter++,A.colorCounter===T&&(A.colorCounter=0)}else U||(S=A.color),U=A.colorIndex;this.colorIndex=ee(this.options.colorIndex,U),this.color=ee(this.options.color,S)},z.prototype.setNestedProperty=function(A,U,T){return T.split(".").reduce(function(S,O,M,Z){return S[O]=Z.length-1===M?U:W(S[O],!0)?S[O]:{},S[O]},A),A},z.prototype.tooltipFormatter=function(A){var U=this.series,T=U.tooltipOptions,S=ee(T.valueDecimals,""),O=T.valuePrefix||"",M=T.valueSuffix||"";return U.chart.styledMode&&(A=U.chart.tooltip.styledModeFormat(A)),(U.pointArrayMap||["y"]).forEach(function(Z){Z="{point."+Z,(O||M)&&(A=A.replace(RegExp(Z+"}","g"),O+Z+"}"+M)),A=A.replace(RegExp(Z+"}","g"),Z+":,."+S+"f}")}),ne(A,{point:this,series:this.series},U.chart)},z.prototype.update=function(A,U,T,S){function O(){M.applyOptions(A);var $=ae&&M.hasDummyGraphic;$=null===M.y?!$:$,ae&&$&&(M.graphic=ae.destroy(),delete M.hasDummyGraphic),W(A,!0)&&(ae&&ae.element&&A&&A.marker&&typeof A.marker.symbol<"u"&&(M.graphic=ae.destroy()),A&&A.dataLabels&&M.dataLabel&&(M.dataLabel=M.dataLabel.destroy()),M.connector&&(M.connector=M.connector.destroy())),Z.updateParallelArrays(M,V=M.index),ge.data[V]=W(ge.data[V],!0)||W(A,!0)?M.options:ee(A,ge.data[V]),Z.isDirty=Z.isDirtyData=!0,!Z.fixedBox&&Z.hasCartesianSeries&&(ue.isDirtyBox=!0),"point"===ge.legendType&&(ue.isDirtyLegend=!0),U&&ue.redraw(T)}var V,M=this,Z=M.series,ae=M.graphic,ue=Z.chart,ge=Z.options;U=ee(U,!0),!1===S?O():M.firePointEvent("update",{options:A},O)},z.prototype.remove=function(A,U){this.series.removePoint(this.series.data.indexOf(this),A,U)},z.prototype.select=function(A,U){var T=this,S=T.series,O=S.chart;this.selectedStaging=A=ee(A,!T.selected),T.firePointEvent(A?"select":"unselect",{accumulate:U},function(){T.selected=T.options.selected=A,S.options.data[S.data.indexOf(T)]=T.options,T.setState(A&&"select"),U||O.getSelectedPoints().forEach(function(M){var Z=M.series;M.selected&&M!==T&&(M.selected=M.options.selected=!1,Z.options.data[Z.data.indexOf(M)]=M.options,M.setState(O.hoverPoints&&Z.options.inactiveOtherPoints?"inactive":""),M.firePointEvent("unselect"))})}),delete this.selectedStaging},z.prototype.onMouseOver=function(A){var U=this.series.chart,T=U.pointer;A=A?T.normalize(A):T.getChartCoordinatesFromPoint(this,U.inverted),T.runPointActions(A,this)},z.prototype.onMouseOut=function(){var A=this.series.chart;this.firePointEvent("mouseOut"),this.series.options.inactiveOtherPoints||(A.hoverPoints||[]).forEach(function(U){U.setState()}),A.hoverPoints=A.hoverPoint=null},z.prototype.importEvents=function(){if(!this.hasImportedEvents){var A=this,U=ie(A.series.options.point,A.options).events;A.events=U,te(U,function(T,S){P(T)&&K(A,S,T)}),this.hasImportedEvents=!0}},z.prototype.setState=function(A,U){var Me,T=this.series,S=this.state,O=T.options.states[A||"normal"]||{},M=ce.plotOptions[T.type].marker&&T.options.marker,ae=M&&M.states&&M.states[A||"normal"]||{},ge=this.marker||{},V=T.chart,$=M&&T.markerAttribs,de=T.halo,Ie=T.stateMarkerGraphic;if(!((A=A||"")===this.state&&!U||this.selected&&"select"!==A||!1===O.enabled||A&&(!1===ae.enabled||M&&!1===M.enabled&&!1===ae.enabled)||A&&ge.states&&ge.states[A]&&!1===ge.states[A].enabled)){if(this.state=A,$&&(Me=T.markerAttribs(this,A)),this.graphic&&!this.hasDummyGraphic){if(S&&this.graphic.removeClass("highcharts-point-"+S),A&&this.graphic.addClass("highcharts-point-"+A),!V.styledMode){var De=T.pointAttribs(this,A),oe=ee(V.options.chart.animation,O.animation);T.options.inactiveOtherPoints&&H(De.opacity)&&((this.dataLabels||[]).forEach(function(ve){ve&&ve.animate({opacity:De.opacity},oe)}),this.connector&&this.connector.animate({opacity:De.opacity},oe)),this.graphic.animate(De,oe)}Me&&this.graphic.animate(Me,ee(V.options.chart.animation,ae.animation,M.animation)),Ie&&Ie.hide()}else A&&ae&&(S=ge.symbol||T.symbol,Ie&&Ie.currentSymbol!==S&&(Ie=Ie.destroy()),Me&&(Ie?Ie[U?"animate":"attr"]({x:Me.x,y:Me.y}):S&&(T.stateMarkerGraphic=Ie=V.renderer.symbol(S,Me.x,Me.y,Me.width,Me.height).add(T.markerGroup),Ie.currentSymbol=S)),!V.styledMode&&Ie&&"inactive"!==this.state&&Ie.attr(T.pointAttribs(this,A))),Ie&&(Ie[A&&this.isInside?"show":"hide"](),Ie.element.point=this,Ie.addClass(this.getClassName(),!0));Me=(Ie=this.graphic||Ie)&&Ie.visibility||"inherit",(O=O.halo)&&O.size&&Ie&&"hidden"!==Me&&!this.isCluster?(de||(T.halo=de=V.renderer.path().add(Ie.parentGroup)),de.show()[U?"animate":"attr"]({d:this.haloPath(O.size)}),de.attr({class:"highcharts-halo highcharts-color-"+ee(this.colorIndex,T.colorIndex)+(this.className?" "+this.className:""),visibility:Me,zIndex:-1}),de.point=this,V.styledMode||de.attr(N({fill:this.color||T.color,"fill-opacity":O.opacity},re.filterUserAttributes(O.attributes||{})))):de&&de.point&&de.point.haloPath&&de.animate({d:de.point.haloPath(0)},null,de.hide),R(this,"afterSetState",{state:A})}},z.prototype.haloPath=function(A){return this.series.chart.renderer.symbols.circle(Math.floor(this.plotX)-A,this.plotY-A,2*A,2*A)},z}()}),Ge(u,"Core/Pointer.js",[u["Core/Color/Color.js"],u["Core/Globals.js"],u["Core/Tooltip.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce){var Se=re.parse,be=me.charts,ce=me.noop,ne=Ce.addEvent,K=Ce.attr,Y=Ce.css,j=Ce.defined,N=Ce.extend,R=Ce.find,I=Ce.fireEvent,B=Ce.isNumber,P=Ce.isObject,H=Ce.objectEach,W=Ce.offset,ie=Ce.pick,te=Ce.splat;return function(){function ee(J,q){this.lastValidTouch={},this.pinchDown=[],this.runChartClick=!1,this.eventsToUnbind=[],this.chart=J,this.hasDragged=!1,this.options=q,this.init(J,q)}return ee.prototype.applyInactiveState=function(J){var D,q=[];(J||[]).forEach(function(z){q.push(D=z.series),D.linkedParent&&q.push(D.linkedParent),D.linkedSeries&&(q=q.concat(D.linkedSeries)),D.navigatorSeries&&q.push(D.navigatorSeries)}),this.chart.series.forEach(function(z){-1===q.indexOf(z)?z.setState("inactive",!0):z.options.inactiveOtherPoints&&z.setAllPointsToState("inactive")})},ee.prototype.destroy=function(){var J=this;this.eventsToUnbind.forEach(function(q){return q()}),this.eventsToUnbind=[],me.chartCount||(ee.unbindDocumentMouseUp&&(ee.unbindDocumentMouseUp=ee.unbindDocumentMouseUp()),ee.unbindDocumentTouchEnd&&(ee.unbindDocumentTouchEnd=ee.unbindDocumentTouchEnd())),clearInterval(J.tooltipTimeout),H(J,function(q,D){J[D]=void 0})},ee.prototype.drag=function(J){var q=this.chart,D=q.options.chart,z=this.zoomHor,A=this.zoomVert,U=q.plotLeft,T=q.plotTop,S=q.plotWidth,O=q.plotHeight,M=this.mouseDownX||0,Z=this.mouseDownY||0,ae=P(D.panning)?D.panning&&D.panning.enabled:D.panning,ue=D.panKey&&J[D.panKey+"Key"],ge=J.chartX,V=J.chartY,$=this.selectionMarker;if((!$||!$.touch)&&(ge<U?ge=U:ge>U+S&&(ge=U+S),V<T?V=T:V>T+O&&(V=T+O),this.hasDragged=Math.sqrt(Math.pow(M-ge,2)+Math.pow(Z-V,2)),10<this.hasDragged)){var de=q.isInsidePlot(M-U,Z-T,{visiblePlotOnly:!0});!q.hasCartesianSeries&&!q.mapView||!this.zoomX&&!this.zoomY||!de||ue||$||(this.selectionMarker=$=q.renderer.rect(U,T,z?1:S,A?1:O,0).attr({class:"highcharts-selection-marker",zIndex:7}).add(),q.styledMode||$.attr({fill:D.selectionMarkerFill||Se("#335cad").setOpacity(.25).get()})),$&&z&&(z=ge-M,$.attr({width:Math.abs(z),x:(0<z?0:z)+M})),$&&A&&(z=V-Z,$.attr({height:Math.abs(z),y:(0<z?0:z)+Z})),de&&!$&&ae&&q.pan(J,D.panning)}},ee.prototype.dragStart=function(J){var q=this.chart;q.mouseIsDown=J.type,q.cancelClick=!1,q.mouseDownX=this.mouseDownX=J.chartX,q.mouseDownY=this.mouseDownY=J.chartY},ee.prototype.drop=function(J){var q=this,D=this.chart,z=this.hasPinched;if(this.selectionMarker){var A=this.selectionMarker,U=A.attr?A.attr("x"):A.x,T=A.attr?A.attr("y"):A.y,S=A.attr?A.attr("width"):A.width,O=A.attr?A.attr("height"):A.height,M={originalEvent:J,xAxis:[],yAxis:[],x:U,y:T,width:S,height:O},Z=!!D.mapView;(this.hasDragged||z)&&(D.axes.forEach(function(ae){if(ae.zoomEnabled&&j(ae.min)&&(z||q[{xAxis:"zoomX",yAxis:"zoomY"}[ae.coll]])&&B(U)&&B(T)){var ue=ae.horiz,ge="touchend"===J.type?ae.minPixelPadding:0,V=ae.toValue((ue?U:T)+ge);ue=ae.toValue((ue?U+S:T+O)-ge),M[ae.coll].push({axis:ae,min:Math.min(V,ue),max:Math.max(V,ue)}),Z=!0}}),Z&&I(D,"selection",M,function(ae){D.zoom(N(ae,z?{animation:!1}:null))})),B(D.index)&&(this.selectionMarker=this.selectionMarker.destroy()),z&&this.scaleGroups()}D&&B(D.index)&&(Y(D.container,{cursor:D._cursor}),D.cancelClick=10<this.hasDragged,D.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])},ee.prototype.findNearestKDPoint=function(J,q,D){var U,z=this.chart,A=z.hoverPoint;return z=z.tooltip,A&&z&&z.isStickyOnContact()?A:(J.forEach(function(T){var S=!(T.noSharedTooltip&&q)&&0>T.options.findNearestPointBy.indexOf("y");if(T=T.searchPoint(D,S),(S=P(T,!0)&&T.series)&&!(S=!P(U,!0))){var O=U.dist-T.dist,M=(T.series.group&&T.series.group.zIndex)-(U.series.group&&U.series.group.zIndex);S=0<(0!=(S=U.distX-T.distX)&&q?S:0!==O?O:0!==M?M:U.series.index>T.series.index?-1:1)}S&&(U=T)}),U)},ee.prototype.getChartCoordinatesFromPoint=function(J,q){var D=J.series,z=D.xAxis;D=D.yAxis;var A=J.shapeArgs;if(z&&D){var U=ie(J.clientX,J.plotX),T=J.plotY||0;return J.isNode&&A&&B(A.x)&&B(A.y)&&(U=A.x,T=A.y),q?{chartX:D.len+D.pos-T,chartY:z.len+z.pos-U}:{chartX:U+z.pos,chartY:T+D.pos}}if(A&&A.x&&A.y)return{chartX:A.x,chartY:A.y}},ee.prototype.getChartPosition=function(){if(this.chartPosition)return this.chartPosition;var J=this.chart.container,q=W(J);this.chartPosition={left:q.left,top:q.top,scaleX:1,scaleY:1};var D=J.offsetWidth;return J=J.offsetHeight,2<D&&2<J&&(this.chartPosition.scaleX=q.width/D,this.chartPosition.scaleY=q.height/J),this.chartPosition},ee.prototype.getCoordinates=function(J){var q={xAxis:[],yAxis:[]};return this.chart.axes.forEach(function(D){q[D.isXAxis?"xAxis":"yAxis"].push({axis:D,value:D.toValue(J[D.horiz?"chartX":"chartY"])})}),q},ee.prototype.getHoverData=function(J,q,D,z,A,U){var T=[];z=!(!z||!J);var S=function(ae){return ae.visible&&!(!A&&ae.directTouch)&&ie(ae.options.enableMouseTracking,!0)},O={chartX:U?U.chartX:void 0,chartY:U?U.chartY:void 0,shared:A};I(this,"beforeGetHoverData",O);var M=q&&!q.stickyTracking?[q]:D.filter(function(ae){return ae.stickyTracking&&(O.filter||S)(ae)}),Z=z||!U?J:this.findNearestKDPoint(M,A,U);return q=Z&&Z.series,Z&&(A&&!q.noSharedTooltip?(M=D.filter(function(ae){return O.filter?O.filter(ae):S(ae)&&!ae.noSharedTooltip})).forEach(function(ae){var ue=R(ae.points,function(ge){return ge.x===Z.x&&!ge.isNull});P(ue)&&(ae.boosted&&ae.boost&&(ue=ae.boost.getPoint(ue)),T.push(ue))}):T.push(Z)),I(this,"afterGetHoverData",O={hoverPoint:Z}),{hoverPoint:O.hoverPoint,hoverSeries:q,hoverPoints:T}},ee.prototype.getPointFromEvent=function(J){J=J.target;for(var q;J&&!q;)q=J.point,J=J.parentNode;return q},ee.prototype.onTrackerMouseOut=function(J){J=J.relatedTarget||J.toElement;var q=this.chart.hoverSeries;this.isDirectTouch=!1,!q||!J||q.stickyTracking||this.inClass(J,"highcharts-tooltip")||this.inClass(J,"highcharts-series-"+q.index)&&this.inClass(J,"highcharts-tracker")||q.onMouseOut()},ee.prototype.inClass=function(J,q){for(var D;J;){if(D=K(J,"class")){if(-1!==D.indexOf(q))return!0;if(-1!==D.indexOf("highcharts-container"))return!1}J=J.parentElement}},ee.prototype.init=function(J,q){this.options=q,this.chart=J,this.runChartClick=!(!q.chart.events||!q.chart.events.click),this.pinchDown=[],this.lastValidTouch={},Te&&(J.tooltip=new Te(J,q.tooltip),this.followTouchMove=ie(q.tooltip.followTouchMove,!0)),this.setDOMEvents()},ee.prototype.normalize=function(J,q){var D=J.touches,z=D?D.length?D.item(0):ie(D.changedTouches,J.changedTouches)[0]:J;return q||(q=this.getChartPosition()),D=z.pageX-q.left,z=z.pageY-q.top,D/=q.scaleX,z/=q.scaleY,N(J,{chartX:Math.round(D),chartY:Math.round(z)})},ee.prototype.onContainerClick=function(J){var q=this.chart,D=q.hoverPoint;J=this.normalize(J);var z=q.plotLeft,A=q.plotTop;q.cancelClick||(D&&this.inClass(J.target,"highcharts-tracker")?(I(D.series,"click",N(J,{point:D})),q.hoverPoint&&D.firePointEvent("click",J)):(N(J,this.getCoordinates(J)),q.isInsidePlot(J.chartX-z,J.chartY-A,{visiblePlotOnly:!0})&&I(q,"click",J)))},ee.prototype.onContainerMouseDown=function(J){var q=1==(1&(J.buttons||J.button));J=this.normalize(J),me.isFirefox&&0!==J.button&&this.onContainerMouseMove(J),(typeof J.button>"u"||q)&&(this.zoomOption(J),q&&J.preventDefault&&J.preventDefault(),this.dragStart(J))},ee.prototype.onContainerMouseLeave=function(J){var q=be[ie(ee.hoverChartIndex,-1)],D=this.chart.tooltip;D&&D.shouldStickOnContact()&&this.inClass(J.relatedTarget,"highcharts-tooltip-container")||(J=this.normalize(J),q&&(J.relatedTarget||J.toElement)&&(q.pointer.reset(),q.pointer.chartPosition=void 0),D&&!D.isHidden&&this.reset())},ee.prototype.onContainerMouseEnter=function(J){delete this.chartPosition},ee.prototype.onContainerMouseMove=function(J){var q=this.chart;J=this.normalize(J),this.setHoverChartIndex(),J.preventDefault||(J.returnValue=!1),("mousedown"===q.mouseIsDown||this.touchSelect(J))&&this.drag(J),q.openMenu||!this.inClass(J.target,"highcharts-tracker")&&!q.isInsidePlot(J.chartX-q.plotLeft,J.chartY-q.plotTop,{visiblePlotOnly:!0})||(this.inClass(J.target,"highcharts-no-tooltip")?this.reset(!1,0):this.runPointActions(J))},ee.prototype.onDocumentTouchEnd=function(J){var q=be[ie(ee.hoverChartIndex,-1)];q&&q.pointer.drop(J)},ee.prototype.onContainerTouchMove=function(J){this.touchSelect(J)?this.onContainerMouseMove(J):this.touch(J)},ee.prototype.onContainerTouchStart=function(J){this.touchSelect(J)?this.onContainerMouseDown(J):(this.zoomOption(J),this.touch(J,!0))},ee.prototype.onDocumentMouseMove=function(J){var q=this.chart,D=this.chartPosition;J=this.normalize(J,D);var z=q.tooltip;!D||z&&z.isStickyOnContact()||q.isInsidePlot(J.chartX-q.plotLeft,J.chartY-q.plotTop,{visiblePlotOnly:!0})||this.inClass(J.target,"highcharts-tracker")||this.reset()},ee.prototype.onDocumentMouseUp=function(J){var q=be[ie(ee.hoverChartIndex,-1)];q&&q.pointer.drop(J)},ee.prototype.pinch=function(J){var q=this,D=q.chart,z=q.pinchDown,A=J.touches||[],U=A.length,T=q.lastValidTouch,S=q.hasZoom,O={},M=1===U&&(q.inClass(J.target,"highcharts-tracker")&&D.runTrackerClick||q.runChartClick),Z={},ae=q.selectionMarker;1<U?q.initiated=!0:1===U&&this.followTouchMove&&(q.initiated=!1),S&&q.initiated&&!M&&!1!==J.cancelable&&J.preventDefault(),[].map.call(A,function(ue){return q.normalize(ue)}),"touchstart"===J.type?([].forEach.call(A,function(ue,ge){z[ge]={chartX:ue.chartX,chartY:ue.chartY}}),T.x=[z[0].chartX,z[1]&&z[1].chartX],T.y=[z[0].chartY,z[1]&&z[1].chartY],D.axes.forEach(function(ue){if(ue.zoomEnabled){var ge=D.bounds[ue.horiz?"h":"v"],V=ue.minPixelPadding,$=ue.toPixels(Math.min(ie(ue.options.min,ue.dataMin),ue.dataMin)),de=ue.toPixels(Math.max(ie(ue.options.max,ue.dataMax),ue.dataMax)),Me=Math.max($,de);ge.min=Math.min(ue.pos,Math.min($,de)-V),ge.max=Math.max(ue.pos+ue.len,Me+V)}}),q.res=!0):q.followTouchMove&&1===U?this.runPointActions(q.normalize(J)):z.length&&(I(D,"touchpan",{originalEvent:J},function(){ae||(q.selectionMarker=ae=N({destroy:ce,touch:!0},D.plotBox)),q.pinchTranslate(z,A,O,ae,Z,T),q.hasPinched=S,q.scaleGroups(O,Z)}),q.res&&(q.res=!1,this.reset(!1,0)))},ee.prototype.pinchTranslate=function(J,q,D,z,A,U){this.zoomHor&&this.pinchTranslateDirection(!0,J,q,D,z,A,U),this.zoomVert&&this.pinchTranslateDirection(!1,J,q,D,z,A,U)},ee.prototype.pinchTranslateDirection=function(J,q,D,z,A,U,T,S){var O=this.chart,M=J?"x":"y",Z=J?"X":"Y",ae="chart"+Z,ue=J?"width":"height",ge=O["plot"+(J?"Left":"Top")],V=O.inverted,$=O.bounds[J?"h":"v"],de=1===q.length,Me=q[0][ae],Ie=!de&&q[1][ae];q=function(){"number"==typeof Re&&20<Math.abs(Me-Ie)&&(ve=S||Math.abs(xe-Re)/Math.abs(Me-Ie)),oe=(ge-xe)/ve+Me,De=O["plot"+(J?"Width":"Height")]/ve};var De,oe,ve=S||1,xe=D[0][ae],Re=!de&&D[1][ae];if(q(),(D=oe)<$.min){D=$.min;var we=!0}else D+De>$.max&&(D=$.max-De,we=!0);we?(xe-=.8*(xe-T[M][0]),"number"==typeof Re&&(Re-=.8*(Re-T[M][1])),q()):T[M]=[xe,Re],V||(U[M]=oe-ge,U[ue]=De),U=V?1/ve:ve,A[ue]=De,A[M]=D,z[V?J?"scaleY":"scaleX":"scale"+Z]=ve,z["translate"+Z]=U*ge+(xe-U*Me)},ee.prototype.reset=function(J,q){var D=this.chart,z=D.hoverSeries,A=D.hoverPoint,U=D.hoverPoints,T=D.tooltip,S=T&&T.shared?U:A;J&&S&&te(S).forEach(function(O){O.series.isCartesian&&typeof O.plotX>"u"&&(J=!1)}),J?T&&S&&te(S).length&&(T.refresh(S),T.shared&&U?U.forEach(function(O){O.setState(O.state,!0),O.series.isCartesian&&(O.series.xAxis.crosshair&&O.series.xAxis.drawCrosshair(null,O),O.series.yAxis.crosshair&&O.series.yAxis.drawCrosshair(null,O))}):A&&(A.setState(A.state,!0),D.axes.forEach(function(O){O.crosshair&&A.series[O.coll]===O&&O.drawCrosshair(null,A)}))):(A&&A.onMouseOut(),U&&U.forEach(function(O){O.setState()}),z&&z.onMouseOut(),T&&T.hide(q),this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove()),D.axes.forEach(function(O){O.hideCrosshair()}),this.hoverX=D.hoverPoints=D.hoverPoint=null)},ee.prototype.runPointActions=function(J,q){var D=this.chart,z=D.tooltip&&D.tooltip.options.enabled?D.tooltip:void 0,A=!!z&&z.shared,U=q||D.hoverPoint,T=U&&U.series||D.hoverSeries;q=this.getHoverData(U,T,D.series,(!J||"touchmove"!==J.type)&&(!!q||T&&T.directTouch&&this.isDirectTouch),A,J),U=q.hoverPoint;var S=q.hoverPoints;q=(T=q.hoverSeries)&&T.tooltipOptions.followPointer&&!T.tooltipOptions.split;var O=A&&T&&!T.noSharedTooltip;if(U&&(U!==D.hoverPoint||z&&z.isHidden)){if((D.hoverPoints||[]).forEach(function(M){-1===S.indexOf(M)&&M.setState()}),D.hoverSeries!==T&&T.onMouseOver(),this.applyInactiveState(S),(S||[]).forEach(function(M){M.setState("hover")}),D.hoverPoint&&D.hoverPoint.firePointEvent("mouseOut"),!U.series)return;D.hoverPoints=S,D.hoverPoint=U,U.firePointEvent("mouseOver",void 0,function(){z&&U&&z.refresh(O?S:U,J)})}else q&&z&&!z.isHidden&&(A=z.getAnchor([{}],J),D.isInsidePlot(A[0],A[1],{visiblePlotOnly:!0})&&z.updatePosition({plotX:A[0],plotY:A[1]}));this.unDocMouseMove||(this.unDocMouseMove=ne(D.container.ownerDocument,"mousemove",function(M){var Z=be[ee.hoverChartIndex];Z&&Z.pointer.onDocumentMouseMove(M)}),this.eventsToUnbind.push(this.unDocMouseMove)),D.axes.forEach(function(M){var ae,Z=ie((M.crosshair||{}).snap,!0);Z&&((ae=D.hoverPoint)&&ae.series[M.coll]===M||(ae=R(S,function(ue){return ue.series&&ue.series[M.coll]===M}))),ae||!Z?M.drawCrosshair(J,ae):M.hideCrosshair()})},ee.prototype.scaleGroups=function(J,q){var D=this.chart;D.series.forEach(function(z){var A=J||z.getPlotBox();z.group&&(z.xAxis&&z.xAxis.zoomEnabled||D.mapView)&&(z.group.attr(A),z.markerGroup&&(z.markerGroup.attr(A),z.markerGroup.clip(q?D.clipRect:null)),z.dataLabelsGroup&&z.dataLabelsGroup.attr(A))}),D.clipRect.attr(q||D.clipBox)},ee.prototype.setDOMEvents=function(){var J=this,q=this.chart.container,D=q.ownerDocument;q.onmousedown=this.onContainerMouseDown.bind(this),q.onmousemove=this.onContainerMouseMove.bind(this),q.onclick=this.onContainerClick.bind(this),this.eventsToUnbind.push(ne(q,"mouseenter",this.onContainerMouseEnter.bind(this))),this.eventsToUnbind.push(ne(q,"mouseleave",this.onContainerMouseLeave.bind(this))),ee.unbindDocumentMouseUp||(ee.unbindDocumentMouseUp=ne(D,"mouseup",this.onDocumentMouseUp.bind(this)));for(var z=this.chart.renderTo.parentElement;z&&"BODY"!==z.tagName;)this.eventsToUnbind.push(ne(z,"scroll",function(){delete J.chartPosition})),z=z.parentElement;me.hasTouch&&(this.eventsToUnbind.push(ne(q,"touchstart",this.onContainerTouchStart.bind(this),{passive:!1})),this.eventsToUnbind.push(ne(q,"touchmove",this.onContainerTouchMove.bind(this),{passive:!1})),ee.unbindDocumentTouchEnd||(ee.unbindDocumentTouchEnd=ne(D,"touchend",this.onDocumentTouchEnd.bind(this),{passive:!1})))},ee.prototype.setHoverChartIndex=function(){var J=this.chart,q=me.charts[ie(ee.hoverChartIndex,-1)];q&&q!==J&&q.pointer.onContainerMouseLeave({relatedTarget:J.container}),q&&q.mouseIsDown||(ee.hoverChartIndex=J.index)},ee.prototype.touch=function(J,q){var D=this.chart;if(this.setHoverChartIndex(),1===J.touches.length)if(J=this.normalize(J),D.isInsidePlot(J.chartX-D.plotLeft,J.chartY-D.plotTop,{visiblePlotOnly:!0})&&!D.openMenu){if(q&&this.runPointActions(J),"touchmove"===J.type)var A=!!(q=this.pinchDown)[0]&&4<=Math.sqrt(Math.pow(q[0].chartX-J.chartX,2)+Math.pow(q[0].chartY-J.chartY,2));ie(A,!0)&&this.pinch(J)}else q&&this.reset();else 2===J.touches.length&&this.pinch(J)},ee.prototype.touchSelect=function(J){return!(!this.chart.options.chart.zooming.singleTouch||!J.touches||1!==J.touches.length)},ee.prototype.zoomOption=function(J){var q=this.chart,D=q.options.chart;q=q.inverted;var z=D.zooming.type||"";/touch/.test(J.type)&&(z=ie(D.zooming.pinchType,z)),this.zoomX=J=/x/.test(z),this.zoomY=D=/y/.test(z),this.zoomHor=J&&!q||D&&q,this.zoomVert=D&&!q||J&&q,this.hasZoom=J||D},ee}()}),Ge(u,"Core/MSPointer.js",[u["Core/Globals.js"],u["Core/Pointer.js"],u["Core/Utilities.js"]],function(re,me,Te){function Ce(){var H=[];return H.item=function(W){return this[W]},R(B,function(W){H.push({pageX:W.pageX,pageY:W.pageY,target:W.target})}),H}function Se(H,W,ie,te){var ee=ce[me.hoverChartIndex||NaN];"touch"!==H.pointerType&&H.pointerType!==H.MSPOINTER_TYPE_TOUCH||!ee||(ee=ee.pointer,te(H),ee[W]({type:ie,target:H.currentTarget,preventDefault:K,touches:Ce()}))}var H,be=this&&this.__extends||(H=function(W,ie){return(H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(te,ee){te.__proto__=ee}||function(te,ee){for(var J in ee)ee.hasOwnProperty(J)&&(te[J]=ee[J])})(W,ie)},function(W,ie){function te(){this.constructor=W}H(W,ie),W.prototype=null===ie?Object.create(ie):(te.prototype=ie.prototype,new te)}),ce=re.charts,ne=re.doc,K=re.noop,Y=re.win,j=Te.addEvent,N=Te.css,R=Te.objectEach,I=Te.removeEvent,B={},P=!!Y.PointerEvent;return function(H){function W(){return null!==H&&H.apply(this,arguments)||this}return be(W,H),W.isRequired=function(){return!(re.hasTouch||!Y.PointerEvent&&!Y.MSPointerEvent)},W.prototype.batchMSEvents=function(ie){ie(this.chart.container,P?"pointerdown":"MSPointerDown",this.onContainerPointerDown),ie(this.chart.container,P?"pointermove":"MSPointerMove",this.onContainerPointerMove),ie(ne,P?"pointerup":"MSPointerUp",this.onDocumentPointerUp)},W.prototype.destroy=function(){this.batchMSEvents(I),H.prototype.destroy.call(this)},W.prototype.init=function(ie,te){H.prototype.init.call(this,ie,te),this.hasZoom&&N(ie.container,{"-ms-touch-action":"none","touch-action":"none"})},W.prototype.onContainerPointerDown=function(ie){Se(ie,"onContainerTouchStart","touchstart",function(te){B[te.pointerId]={pageX:te.pageX,pageY:te.pageY,target:te.currentTarget}})},W.prototype.onContainerPointerMove=function(ie){Se(ie,"onContainerTouchMove","touchmove",function(te){B[te.pointerId]={pageX:te.pageX,pageY:te.pageY},B[te.pointerId].target||(B[te.pointerId].target=te.currentTarget)})},W.prototype.onDocumentPointerUp=function(ie){Se(ie,"onDocumentTouchEnd","touchend",function(te){delete B[te.pointerId]})},W.prototype.setDOMEvents=function(){H.prototype.setDOMEvents.call(this),(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(j)},W}(me)}),Ge(u,"Core/Legend/Legend.js",[u["Core/Animation/AnimationUtilities.js"],u["Core/FormatUtilities.js"],u["Core/Globals.js"],u["Core/Series/Point.js"],u["Core/Renderer/RendererUtilities.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce,Se,be){var ce=re.animObject,ne=re.setAnimation,K=me.format;re=Te.isFirefox;var Y=Te.marginNames;Te=Te.win;var j=Se.distribute,N=be.addEvent,R=be.createElement,I=be.css,B=be.defined,P=be.discardElement,H=be.find,W=be.fireEvent,ie=be.isNumber,te=be.merge,ee=be.pick,J=be.relativeLength,q=be.stableSort,D=be.syncTimeout;return Se=be.wrap,be=function(){function z(A,U){this.allItems=[],this.contentGroup=this.box=void 0,this.display=!1,this.group=void 0,this.offsetWidth=this.maxLegendWidth=this.maxItemWidth=this.legendWidth=this.legendHeight=this.lastLineHeight=this.lastItemY=this.itemY=this.itemX=this.itemMarginTop=this.itemMarginBottom=this.itemHeight=this.initialItemY=0,this.options=void 0,this.padding=0,this.pages=[],this.proximate=!1,this.scrollGroup=void 0,this.widthOption=this.totalItemWidth=this.titleHeight=this.symbolWidth=this.symbolHeight=0,this.chart=A,this.init(A,U)}return z.prototype.init=function(A,U){this.chart=A,this.setOptions(U),U.enabled&&(this.render(),N(this.chart,"endResize",function(){this.legend.positionCheckboxes()}),this.proximate?this.unchartrender=N(this.chart,"render",function(){this.legend.proximatePositions(),this.legend.positionItems()}):this.unchartrender&&this.unchartrender())},z.prototype.setOptions=function(A){var U=ee(A.padding,8);this.options=A,this.chart.styledMode||(this.itemStyle=A.itemStyle,this.itemHiddenStyle=te(this.itemStyle,A.itemHiddenStyle)),this.itemMarginTop=A.itemMarginTop||0,this.itemMarginBottom=A.itemMarginBottom||0,this.padding=U,this.initialItemY=U-5,this.symbolWidth=ee(A.symbolWidth,16),this.pages=[],this.proximate="proximate"===A.layout&&!this.chart.inverted,this.baseline=void 0},z.prototype.update=function(A,U){var T=this.chart;this.setOptions(te(!0,this.options,A)),this.destroy(),T.isDirtyLegend=T.isDirtyBox=!0,ee(U,!0)&&T.redraw(),W(this,"afterUpdate")},z.prototype.colorizeItem=function(A,U){if(A.legendGroup[U?"removeClass":"addClass"]("highcharts-legend-item-hidden"),!this.chart.styledMode){var T=this.options,S=A.legendItem,O=A.legendLine,M=A.legendSymbol,Z=this.itemHiddenStyle.color;T=U?T.itemStyle.color:Z;var ae=U&&A.color||Z,ue=A.options&&A.options.marker,ge={fill:ae};S&&S.css({fill:T,color:T}),O&&O.attr({stroke:ae}),M&&(ue&&M.isMarker&&(ge=A.pointAttribs(),U||(ge.stroke=ge.fill=Z)),M.attr(ge))}W(this,"afterColorizeItem",{item:A,visible:U})},z.prototype.positionItems=function(){this.allItems.forEach(this.positionItem,this),this.chart.isResizing||this.positionCheckboxes()},z.prototype.positionItem=function(A){var U=this,T=this.options,S=T.symbolPadding,O=!T.rtl,M=A._legendItemPos;T=M[0],M=M[1];var Z=A.checkbox,ae=A.legendGroup;ae&&ae.element&&(S={translateX:O?T:this.legendWidth-T-2*S-4,translateY:M},O=function(){W(U,"afterPositionItem",{item:A})},B(ae.translateY)?ae.animate(S,void 0,O):(ae.attr(S),O())),Z&&(Z.x=T,Z.y=M)},z.prototype.destroyItem=function(A){var U=A.checkbox;["legendItem","legendLine","legendSymbol","legendGroup"].forEach(function(T){A[T]&&(A[T]=A[T].destroy())}),U&&P(A.checkbox)},z.prototype.destroy=function(){function A(U){this[U]&&(this[U]=this[U].destroy())}this.getAllItems().forEach(function(U){["legendItem","legendGroup"].forEach(A,U)}),"clipRect up down pager nav box title group".split(" ").forEach(A,this),this.display=null},z.prototype.positionCheckboxes=function(){var A=this.group&&this.group.alignAttr,U=this.clipHeight||this.legendHeight,T=this.titleHeight;if(A){var S=A.translateY;this.allItems.forEach(function(O){var M=O.checkbox;if(M){var Z=S+T+M.y+(this.scrollOffset||0)+3;I(M,{left:A.translateX+O.checkboxOffset+M.x-20+"px",top:Z+"px",display:this.proximate||Z>S-6&&Z<S+U-6?"":"none"})}},this)}},z.prototype.renderTitle=function(){var A=this.options,U=this.padding,T=A.title,S=0;T.text&&(this.title||(this.title=this.chart.renderer.label(T.text,U-3,U-4,void 0,void 0,void 0,A.useHTML,void 0,"legend-title").attr({zIndex:1}),this.chart.styledMode||this.title.css(T.style),this.title.add(this.group)),T.width||this.title.css({width:this.maxLegendWidth+"px"}),S=(A=this.title.getBBox()).height,this.offsetWidth=A.width,this.contentGroup.attr({translateY:S})),this.titleHeight=S},z.prototype.setText=function(A){var U=this.options;A.legendItem.attr({text:U.labelFormat?K(U.labelFormat,A,this.chart):U.labelFormatter.call(A)})},z.prototype.renderItem=function(A){var U=this.chart,T=U.renderer,S=this.options,O=this.symbolWidth,M=S.symbolPadding||0,Z=this.itemStyle,ae=this.itemHiddenStyle,ue="horizontal"===S.layout?ee(S.itemDistance,20):0,ge=!S.rtl,V=!A.series,$=!V&&A.series.drawLegendSymbol?A.series:A,de=$.options,Me=this.createCheckboxForItem&&de&&de.showCheckbox,Ie=S.useHTML,De=A.options.className,oe=A.legendItem;de=O+M+ue+(Me?20:0),oe||(A.legendGroup=T.g("legend-item").addClass("highcharts-"+$.type+"-series highcharts-color-"+A.colorIndex+(De?" "+De:"")+(V?" highcharts-series-"+A.index:"")).attr({zIndex:1}).add(this.scrollGroup),A.legendItem=oe=T.text("",ge?O+M:-M,this.baseline||0,Ie),U.styledMode||oe.css(te(A.visible?Z:ae)),oe.attr({align:ge?"left":"right",zIndex:2}).add(A.legendGroup),this.baseline||(this.fontMetrics=T.fontMetrics(U.styledMode?12:Z.fontSize,oe),this.baseline=this.fontMetrics.f+3+this.itemMarginTop,oe.attr("y",this.baseline),this.symbolHeight=S.symbolHeight||this.fontMetrics.f,S.squareSymbol&&(this.symbolWidth=ee(S.symbolWidth,Math.max(this.symbolHeight,16)),de=this.symbolWidth+M+ue+(Me?20:0),ge&&oe.attr("x",this.symbolWidth+M))),$.drawLegendSymbol(this,A),this.setItemEvents&&this.setItemEvents(A,oe,Ie)),Me&&!A.checkbox&&this.createCheckboxForItem&&this.createCheckboxForItem(A),this.colorizeItem(A,A.visible),!U.styledMode&&Z.width||oe.css({width:(S.itemWidth||this.widthOption||U.spacingBox.width)-de+"px"}),this.setText(A),U=oe.getBBox(),T=this.fontMetrics&&this.fontMetrics.h||0,A.itemWidth=A.checkboxOffset=S.itemWidth||A.legendItemWidth||U.width+de,this.maxItemWidth=Math.max(this.maxItemWidth,A.itemWidth),this.totalItemWidth+=A.itemWidth,this.itemHeight=A.itemHeight=Math.round(A.legendItemHeight||(U.height>1.5*T?U.height:T))},z.prototype.layoutItem=function(A){var U=this.options,T=this.padding,S="horizontal"===U.layout,O=A.itemHeight,M=this.itemMarginBottom,Z=this.itemMarginTop,ae=S?ee(U.itemDistance,20):0,ue=this.maxLegendWidth;U=U.alignColumns&&this.totalItemWidth>ue?this.maxItemWidth:A.itemWidth,S&&this.itemX-T+U>ue&&(this.itemX=T,this.lastLineHeight&&(this.itemY+=Z+this.lastLineHeight+M),this.lastLineHeight=0),this.lastItemY=Z+this.itemY+M,this.lastLineHeight=Math.max(O,this.lastLineHeight),A._legendItemPos=[this.itemX,this.itemY],S?this.itemX+=U:(this.itemY+=Z+O+M,this.lastLineHeight=O),this.offsetWidth=this.widthOption||Math.max((S?this.itemX-T-(A.checkbox?0:ae):U)+T,this.offsetWidth)},z.prototype.getAllItems=function(){var A=[];return this.chart.series.forEach(function(U){var T=U&&U.options;U&&ee(T.showInLegend,!B(T.linkedTo)&&void 0,!0)&&(A=A.concat(U.legendItems||("point"===T.legendType?U.data:U)))}),W(this,"afterGetAllItems",{allItems:A}),A},z.prototype.getAlignment=function(){var A=this.options;return this.proximate?A.align.charAt(0)+"tv":A.floating?"":A.align.charAt(0)+A.verticalAlign.charAt(0)+A.layout.charAt(0)},z.prototype.adjustMargins=function(A,U){var T=this.chart,S=this.options,O=this.getAlignment();O&&[/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/].forEach(function(M,Z){M.test(O)&&!B(A[Z])&&(T[Y[Z]]=Math.max(T[Y[Z]],T.legend[(Z+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][Z]*S[Z%2?"x":"y"]+ee(S.margin,12)+U[Z]+(T.titleOffset[Z]||0)))})},z.prototype.proximatePositions=function(){var A=this.chart,U=[],T="left"===this.options.align;this.allItems.forEach(function(S){var O,M=T;if(S.yAxis){S.xAxis.options.reversed&&(M=!M),S.points&&(O=H(M?S.points:S.points.slice(0).reverse(),function(ae){return ie(ae.plotY)})),M=this.itemMarginTop+S.legendItem.getBBox().height+this.itemMarginBottom;var Z=S.yAxis.top-A.plotTop;S.visible?(O=O?O.plotY:S.yAxis.height,O+=Z-.3*M):O=Z+S.yAxis.height,U.push({target:O,size:M,item:S})}},this),j(U,A.plotHeight).forEach(function(S){S.item._legendItemPos&&S.pos&&(S.item._legendItemPos[1]=A.plotTop-A.spacing[0]+S.pos)})},z.prototype.render=function(){var A=this.chart,U=A.renderer,T=this.options,S=this.padding,O=this.getAllItems(),M=this.group,Z=this.box;this.itemX=S,this.itemY=this.initialItemY,this.lastItemY=this.offsetWidth=0,this.widthOption=J(T.width,A.spacingBox.width-S);var ae=A.spacingBox.width-2*S-T.x;-1<["rm","lm"].indexOf(this.getAlignment().substring(0,2))&&(ae/=2),this.maxLegendWidth=this.widthOption||ae,M||(this.group=M=U.g("legend").addClass(T.className||"").attr({zIndex:7}).add(),this.contentGroup=U.g().attr({zIndex:1}).add(M),this.scrollGroup=U.g().add(this.contentGroup)),this.renderTitle(),q(O,function(ge,V){return(ge.options&&ge.options.legendIndex||0)-(V.options&&V.options.legendIndex||0)}),T.reversed&&O.reverse(),this.allItems=O,this.display=ae=!!O.length,this.itemHeight=this.totalItemWidth=this.maxItemWidth=this.lastLineHeight=0,O.forEach(this.renderItem,this),O.forEach(this.layoutItem,this),O=(this.widthOption||this.offsetWidth)+S;var ue=this.lastItemY+this.lastLineHeight+this.titleHeight;ue=this.handleOverflow(ue),ue+=S,Z||(this.box=Z=U.rect().addClass("highcharts-legend-box").attr({r:T.borderRadius}).add(M)),A.styledMode||Z.attr({stroke:T.borderColor,"stroke-width":T.borderWidth||0,fill:T.backgroundColor||"none"}).shadow(T.shadow),0<O&&0<ue&&Z[Z.placed?"animate":"attr"](Z.crisp.call({},{x:0,y:0,width:O,height:ue},Z.strokeWidth())),M[ae?"show":"hide"](),A.styledMode&&"none"===M.getStyle("display")&&(O=ue=0),this.legendWidth=O,this.legendHeight=ue,ae&&this.align(),this.proximate||this.positionItems(),W(this,"afterRender")},z.prototype.align=function(A){void 0===A&&(A=this.chart.spacingBox);var U=this.chart,T=this.options,S=A.y;/(lth|ct|rth)/.test(this.getAlignment())&&0<U.titleOffset[0]?S+=U.titleOffset[0]:/(lbh|cb|rbh)/.test(this.getAlignment())&&0<U.titleOffset[2]&&(S-=U.titleOffset[2]),S!==A.y&&(A=te(A,{y:S})),U.hasRendered||(this.group.placed=!1),this.group.align(te(T,{width:this.legendWidth,height:this.legendHeight,verticalAlign:this.proximate?"top":T.verticalAlign}),!0,A)},z.prototype.handleOverflow=function(A){var oe,ve,U=this,T=this.chart,S=T.renderer,O=this.options,M=O.y,Z="top"===O.verticalAlign,ae=this.padding,ue=O.maxHeight,ge=O.navigation,V=ee(ge.animation,!0),$=ge.arrowSize||12,de=this.pages,Me=this.allItems,Ie=function(we){"number"==typeof we?Re.attr({height:we}):Re&&(U.clipRect=Re.destroy(),U.contentGroup.clip()),U.contentGroup.div&&(U.contentGroup.div.style.clip=we?"rect("+ae+"px,9999px,"+(ae+we)+"px,0)":"auto")},De=function(we){return U[we]=S.circle(0,0,1.3*$).translate($/2,$/2).add(xe),T.styledMode||U[we].attr("fill","rgba(0,0,0,0.0001)"),U[we]};M=T.spacingBox.height+(Z?-M:M)-ae;var xe=this.nav,Re=this.clipRect;return"horizontal"!==O.layout||"middle"===O.verticalAlign||O.floating||(M/=2),ue&&(M=Math.min(M,ue)),de.length=0,A&&0<M&&A>M&&!1!==ge.enabled?(this.clipHeight=oe=Math.max(M-20-this.titleHeight-ae,0),this.currentPage=ee(this.currentPage,1),this.fullHeight=A,Me.forEach(function(we,Le){var Ne=we._legendItemPos[1],Ze=Math.round(we.legendItem.getBBox().height),at=de.length;(!at||Ne-de[at-1]>oe&&(ve||Ne)!==de[at-1])&&(de.push(ve||Ne),at++),we.pageIx=at-1,ve&&(Me[Le-1].pageIx=at-1),Le===Me.length-1&&Ne+Ze-de[at-1]>oe&&Ze<=oe&&(de.push(Ne),we.pageIx=at),Ne!==ve&&(ve=Ne)}),Re||(Re=U.clipRect=S.clipRect(0,ae,9999,0),U.contentGroup.clip(Re)),Ie(oe),xe||(this.nav=xe=S.g().attr({zIndex:1}).add(this.group),this.up=S.symbol("triangle",0,0,$,$).add(xe),De("upTracker").on("click",function(){U.scroll(-1,V)}),this.pager=S.text("",15,10).addClass("highcharts-legend-navigation"),!T.styledMode&&ge.style&&this.pager.css(ge.style),this.pager.add(xe),this.down=S.symbol("triangle-down",0,0,$,$).add(xe),De("downTracker").on("click",function(){U.scroll(1,V)})),U.scroll(0),A=M):xe&&(Ie(),this.nav=xe.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),A},z.prototype.scroll=function(A,U){var T=this,S=this.chart,O=this.pages,M=O.length,Z=this.clipHeight,ae=this.options.navigation,ue=this.pager,ge=this.padding,V=this.currentPage+A;V>M&&(V=M),0<V&&(typeof U<"u"&&ne(U,S),this.nav.attr({translateX:ge,translateY:Z+this.padding+7+this.titleHeight,visibility:"inherit"}),[this.up,this.upTracker].forEach(function($){$.attr({class:1===V?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})}),ue.attr({text:V+"/"+M}),[this.down,this.downTracker].forEach(function($){$.attr({x:18+this.pager.getBBox().width,class:V===M?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})},this),S.styledMode||(this.up.attr({fill:1===V?ae.inactiveColor:ae.activeColor}),this.upTracker.css({cursor:1===V?"default":"pointer"}),this.down.attr({fill:V===M?ae.inactiveColor:ae.activeColor}),this.downTracker.css({cursor:V===M?"default":"pointer"})),this.scrollOffset=-O[V-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=V,this.positionCheckboxes(),A=ce(ee(U,S.renderer.globalAnimation,!0)),D(function(){W(T,"afterScroll",{currentPage:V})},A.duration))},z.prototype.setItemEvents=function(A,U,T){var S=this,O=S.chart.renderer.boxWrapper,M=A instanceof Ce,Z="highcharts-legend-"+(M?"point":"series")+"-active",ae=S.chart.styledMode,ue=function(ge){S.allItems.forEach(function(V){A!==V&&[V].concat(V.linkedSeries||[]).forEach(function($){$.setState(ge,!M)})})};(T?[U,A.legendSymbol]:[A.legendGroup]).forEach(function(ge){ge&&ge.on("mouseover",function(){A.visible&&ue("inactive"),A.setState("hover"),A.visible&&O.addClass(Z),ae||U.css(S.options.itemHoverStyle)}).on("mouseout",function(){S.chart.styledMode||U.css(te(A.visible?S.itemStyle:S.itemHiddenStyle)),ue(""),O.removeClass(Z),A.setState()}).on("click",function(V){var $=function(){A.setVisible&&A.setVisible(),ue(A.visible?"inactive":"")};O.removeClass(Z),V={browserEvent:V},A.firePointEvent?A.firePointEvent("legendItemClick",V,$):W(A,"legendItemClick",V,$)})})},z.prototype.createCheckboxForItem=function(A){A.checkbox=R("input",{type:"checkbox",className:"highcharts-legend-checkbox",checked:A.selected,defaultChecked:A.selected},this.options.itemCheckboxStyle,this.chart.container),N(A.checkbox,"click",function(U){W(A.series||A,"checkboxClick",{checked:U.target.checked,item:A},function(){A.select()})})},z}(),(/Trident\/7\.0/.test(Te.navigator&&Te.navigator.userAgent)||re)&&Se(be.prototype,"positionItem",function(z,A){var U=this,T=function(){A._legendItemPos&&z.call(U,A)};T(),U.bubbleLegend||setTimeout(T)}),be}),Ge(u,"Core/Series/SeriesRegistry.js",[u["Core/Globals.js"],u["Core/DefaultOptions.js"],u["Core/Series/Point.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce){var ne,Se=me.defaultOptions,be=Ce.extendClass,ce=Ce.merge;return function(K){function Y(j,N){var R=Se.plotOptions||{},I=N.defaultOptions,B=N.prototype;B.type=j,B.pointClass||(B.pointClass=Te),I&&(R[j]=I),K.seriesTypes[j]=N}K.seriesTypes=re.seriesTypes,K.registerSeriesType=Y,K.seriesType=function(j,N,R,I,B){var P=Se.plotOptions||{};return P[j]=ce(P[N=N||""],R),Y(j,be(K.seriesTypes[N]||function(){},I)),K.seriesTypes[j].prototype.type=j,B&&(K.seriesTypes[j].prototype.pointClass=be(Te,B)),K.seriesTypes[j]}}(ne||(ne={})),ne}),Ge(u,"Core/Chart/Chart.js",[u["Core/Animation/AnimationUtilities.js"],u["Core/Axis/Axis.js"],u["Core/FormatUtilities.js"],u["Core/Foundation.js"],u["Core/Globals.js"],u["Core/Legend/Legend.js"],u["Core/MSPointer.js"],u["Core/DefaultOptions.js"],u["Core/Pointer.js"],u["Core/Renderer/RendererRegistry.js"],u["Core/Series/SeriesRegistry.js"],u["Core/Renderer/SVG/SVGRenderer.js"],u["Core/Time.js"],u["Core/Utilities.js"],u["Core/Renderer/HTML/AST.js"]],function(re,me,Te,Ce,Se,be,ce,ne,K,Y,j,N,R,I,B){var P=re.animate,H=re.animObject,W=re.setAnimation,ie=Te.numberFormat,te=Ce.registerEventOptions,ee=Se.charts,J=Se.doc,q=Se.marginNames,D=Se.svg,z=Se.win,A=ne.defaultOptions,U=ne.defaultTime,T=j.seriesTypes,S=I.addEvent,O=I.attr,M=I.cleanRecursively,Z=I.createElement,ae=I.css,ue=I.defined,ge=I.discardElement,V=I.erase,$=I.error,de=I.extend,Me=I.find,Ie=I.fireEvent,De=I.getStyle,oe=I.isArray,ve=I.isNumber,xe=I.isObject,Re=I.isString,we=I.merge,Le=I.objectEach,Ne=I.pick,Ze=I.pInt,at=I.relativeLength,wt=I.removeEvent,Tt=I.splat,Ut=I.syncTimeout,bt=I.uniqueKey;return re=function(){function lt(Pe,je,it){this.series=this.renderTo=this.renderer=this.pointer=this.pointCount=this.plotWidth=this.plotTop=this.plotLeft=this.plotHeight=this.plotBox=this.options=this.numberFormatter=this.margin=this.legend=this.labelCollectors=this.isResizing=this.index=this.eventOptions=this.container=this.colorCounter=this.clipBox=this.chartWidth=this.chartHeight=this.bounds=this.axisOffset=this.axes=void 0,this.sharedClips={},this.yAxis=this.xAxis=this.userOptions=this.titleOffset=this.time=this.symbolCounter=this.spacingBox=this.spacing=void 0,this.getArgs(Pe,je,it)}return lt.chart=function(Pe,je,it){return new lt(Pe,je,it)},lt.prototype.getArgs=function(Pe,je,it){Re(Pe)||Pe.nodeName?(this.renderTo=Pe,this.init(je,it)):this.init(Pe,je)},lt.prototype.init=function(Pe,je){var it=Pe.plotOptions||{};Ie(this,"init",{args:arguments},function(){var ct=we(A,Pe),vt=ct.chart;Le(ct.plotOptions,function(Kt,vi){xe(Kt)&&(Kt.tooltip=it[vi]&&we(it[vi].tooltip)||void 0)}),ct.tooltip.userOptions=Pe.chart&&Pe.chart.forExport&&Pe.tooltip.userOptions||Pe.tooltip,this.userOptions=Pe,this.margin=[],this.spacing=[],this.bounds={h:{},v:{}},this.labelCollectors=[],this.callback=je,this.isResizing=0;var Nt=vt.zooming=vt.zooming||{};Pe.chart&&!Pe.chart.zooming&&(Nt.resetButton=vt.resetZoomButton),Nt.key=Ne(Nt.key,vt.zoomKey),Nt.pinchType=Ne(Nt.pinchType,vt.pinchType),Nt.singleTouch=Ne(Nt.singleTouch,vt.zoomBySingleTouch),Nt.type=Ne(Nt.type,vt.zoomType),this.options=ct,this.axes=[],this.series=[],this.time=Pe.time&&Object.keys(Pe.time).length?new R(Pe.time):Se.time,this.numberFormatter=vt.numberFormatter||ie,this.styledMode=vt.styledMode,this.hasCartesianSeries=vt.showAxes,this.index=ee.length,ee.push(this),Se.chartCount++,te(this,vt),this.xAxis=[],this.yAxis=[],this.pointCount=this.colorCounter=this.symbolCounter=0,Ie(this,"afterInit"),this.firstRender()})},lt.prototype.initSeries=function(Pe){var je=this.options.chart,it=T[je=Pe.type||je.type||je.defaultSeriesType];return it||$(17,!0,this,{missingModuleFor:je}),"function"==typeof(je=new it).init&&je.init(this,Pe),je},lt.prototype.setSeriesData=function(){this.getSeriesOrderByLinks().forEach(function(Pe){Pe.points||Pe.data||!Pe.enabledDataSorting||Pe.setData(Pe.options.data,!1)})},lt.prototype.getSeriesOrderByLinks=function(){return this.series.concat().sort(function(Pe,je){return Pe.linkedSeries.length||je.linkedSeries.length?je.linkedSeries.length-Pe.linkedSeries.length:0})},lt.prototype.orderSeries=function(Pe){var je=this.series;Pe=Pe||0;for(var it=je.length;Pe<it;++Pe)je[Pe]&&(je[Pe].index=Pe,je[Pe].name=je[Pe].getName())},lt.prototype.isInsidePlot=function(Pe,je,it){void 0===it&&(it={});var ct=this.inverted,vt=this.plotBox,Nt=this.plotLeft,Kt=this.plotTop,vi=this.scrollablePlotBox,Ki=0,mi=0;it.visiblePlotOnly&&this.scrollingContainer&&(Ki=(mi=this.scrollingContainer).scrollLeft,mi=mi.scrollTop);var Ii=it.series;if(vt=it.visiblePlotOnly&&vi||vt,Pe={x:vi=it.inverted?je:Pe,y:je=it.inverted?Pe:je,isInsidePlot:!0},!it.ignoreX){var xn=Ii&&(ct?Ii.yAxis:Ii.xAxis)||{pos:Nt,len:1/0};(vi=it.paneCoordinates?xn.pos+vi:Nt+vi)>=Math.max(Ki+Nt,xn.pos)&&vi<=Math.min(Ki+Nt+vt.width,xn.pos+xn.len)||(Pe.isInsidePlot=!1)}return!it.ignoreY&&Pe.isInsidePlot&&(ct=Ii&&(ct?Ii.xAxis:Ii.yAxis)||{pos:Kt,len:1/0},(it=it.paneCoordinates?ct.pos+je:Kt+je)>=Math.max(mi+Kt,ct.pos)&&it<=Math.min(mi+Kt+vt.height,ct.pos+ct.len)||(Pe.isInsidePlot=!1)),Ie(this,"afterIsInsidePlot",Pe),Pe.isInsidePlot},lt.prototype.redraw=function(Pe){Ie(this,"beforeRedraw");var je=this.hasCartesianSeries?this.axes:this.colorAxis||[],it=this.series,ct=this.pointer,vt=this.legend,Nt=this.userOptions.legend,Kt=this.renderer,vi=Kt.isHidden(),Ki=[],mi=this.isDirtyBox,Ii=this.isDirtyLegend;for(this.setResponsive&&this.setResponsive(!1),W(!!this.hasRendered&&Pe,this),vi&&this.temporaryDisplay(),this.layOutTitles(),Pe=it.length;Pe--;){var xn=it[Pe];if(xn.options.stacking||xn.options.centerInCategory){var Qi=!0;if(xn.isDirty){var bn=!0;break}}}if(bn)for(Pe=it.length;Pe--;)(xn=it[Pe]).options.stacking&&(xn.isDirty=!0);it.forEach(function(Ri){Ri.isDirty&&("point"===Ri.options.legendType?("function"==typeof Ri.updateTotals&&Ri.updateTotals(),Ii=!0):Nt&&(Nt.labelFormatter||Nt.labelFormat)&&(Ii=!0)),Ri.isDirtyData&&Ie(Ri,"updatedData")}),Ii&&vt&&vt.options.enabled&&(vt.render(),this.isDirtyLegend=!1),Qi&&this.getStacks(),je.forEach(function(Ri){Ri.updateNames(),Ri.setScale()}),this.getMargins(),je.forEach(function(Ri){Ri.isDirty&&(mi=!0)}),je.forEach(function(Ri){var _r=Ri.min+","+Ri.max;Ri.extKey!==_r&&(Ri.extKey=_r,Ki.push(function(){Ie(Ri,"afterSetExtremes",de(Ri.eventArgs,Ri.getExtremes())),delete Ri.eventArgs})),(mi||Qi)&&Ri.redraw()}),mi&&this.drawChartBox(),Ie(this,"predraw"),it.forEach(function(Ri){(mi||Ri.isDirty)&&Ri.visible&&Ri.redraw(),Ri.isDirtyData=!1}),ct&&ct.reset(!0),Kt.draw(),Ie(this,"redraw"),Ie(this,"render"),vi&&this.temporaryDisplay(!0),Ki.forEach(function(Ri){Ri.call()})},lt.prototype.get=function(Pe){function je(Nt){return Nt.id===Pe||Nt.options&&Nt.options.id===Pe}for(var it=this.series,ct=Me(this.axes,je)||Me(this.series,je),vt=0;!ct&&vt<it.length;vt++)ct=Me(it[vt].points||[],je);return ct},lt.prototype.getAxes=function(){var Pe=this,je=this.options,it=je.xAxis=Tt(je.xAxis||{});je=je.yAxis=Tt(je.yAxis||{}),Ie(this,"getAxes"),it.forEach(function(ct,vt){ct.index=vt,ct.isX=!0}),je.forEach(function(ct,vt){ct.index=vt}),it.concat(je).forEach(function(ct){new me(Pe,ct)}),Ie(this,"afterGetAxes")},lt.prototype.getSelectedPoints=function(){return this.series.reduce(function(Pe,je){return je.getPointsCollection().forEach(function(it){Ne(it.selectedStaging,it.selected)&&Pe.push(it)}),Pe},[])},lt.prototype.getSelectedSeries=function(){return this.series.filter(function(Pe){return Pe.selected})},lt.prototype.setTitle=function(Pe,je,it){this.applyDescription("title",Pe),this.applyDescription("subtitle",je),this.applyDescription("caption",void 0),this.layOutTitles(it)},lt.prototype.applyDescription=function(Pe,je){var it=this,ct="title"===Pe?{color:"#333333",fontSize:this.options.isStock?"16px":"18px"}:{color:"#666666"};ct=this.options[Pe]=we(!this.styledMode&&{style:ct},this.options[Pe],je);var vt=this[Pe];vt&&je&&(this[Pe]=vt=vt.destroy()),ct&&!vt&&((vt=this.renderer.text(ct.text,0,0,ct.useHTML).attr({align:ct.align,class:"highcharts-"+Pe,zIndex:ct.zIndex||4}).add()).update=function(Nt){it[{title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"}[Pe]](Nt)},this.styledMode||vt.css(ct.style),this[Pe]=vt)},lt.prototype.layOutTitles=function(Pe){var je=[0,0,0],it=this.renderer,ct=this.spacingBox;["title","subtitle","caption"].forEach(function(Nt){var mi,Kt=this[Nt],vi=this.options[Nt],Ki=vi.verticalAlign||"top";if(Nt="title"===Nt?"top"===Ki?-3:0:"top"===Ki?je[0]+2:0,Kt){this.styledMode||(mi=vi.style&&vi.style.fontSize),mi=it.fontMetrics(mi,Kt).b,Kt.css({width:(vi.width||ct.width+(vi.widthAdjust||0))+"px"});var Ii=Math.round(Kt.getBBox(vi.useHTML).height);Kt.align(de({y:"bottom"===Ki?mi:Nt+mi,height:Ii},vi),!1,"spacingBox"),vi.floating||("top"===Ki?je[0]=Math.ceil(je[0]+Ii):"bottom"===Ki&&(je[2]=Math.ceil(je[2]+Ii)))}},this),je[0]&&"top"===(this.options.title.verticalAlign||"top")&&(je[0]+=this.options.title.margin),je[2]&&"bottom"===this.options.caption.verticalAlign&&(je[2]+=this.options.caption.margin);var vt=!this.titleOffset||this.titleOffset.join(",")!==je.join(",");this.titleOffset=je,Ie(this,"afterLayOutTitles"),!this.isDirtyBox&&vt&&(this.isDirtyBox=this.isDirtyLegend=vt,this.hasRendered&&Ne(Pe,!0)&&this.isDirtyBox&&this.redraw())},lt.prototype.getChartSize=function(){var Pe=this.options.chart,je=Pe.width;Pe=Pe.height;var it=this.renderTo;ue(je)||(this.containerWidth=De(it,"width")),ue(Pe)||(this.containerHeight=De(it,"height")),this.chartWidth=Math.max(0,je||this.containerWidth||600),this.chartHeight=Math.max(0,at(Pe,this.chartWidth)||(1<this.containerHeight?this.containerHeight:400))},lt.prototype.temporaryDisplay=function(Pe){var je=this.renderTo;if(Pe)for(;je&&je.style;)je.hcOrigStyle&&(ae(je,je.hcOrigStyle),delete je.hcOrigStyle),je.hcOrigDetached&&(J.body.removeChild(je),je.hcOrigDetached=!1),je=je.parentNode;else for(;je&&je.style&&(J.body.contains(je)||je.parentNode||(je.hcOrigDetached=!0,J.body.appendChild(je)),("none"===De(je,"display",!1)||je.hcOricDetached)&&(je.hcOrigStyle={display:je.style.display,height:je.style.height,overflow:je.style.overflow},Pe={display:"block",overflow:"hidden"},je!==this.renderTo&&(Pe.height=0),ae(je,Pe),je.offsetWidth||je.style.setProperty("display","block","important")),(je=je.parentNode)!==J.body););},lt.prototype.setClassName=function(Pe){this.container.className="highcharts-container "+(Pe||"")},lt.prototype.getContainer=function(){var ct,Pe=this.options,je=Pe.chart,it=bt(),vt=this.renderTo;vt||(this.renderTo=vt=je.renderTo),Re(vt)&&(this.renderTo=vt=J.getElementById(vt)),vt||$(13,!0,this);var Nt=Ze(O(vt,"data-highcharts-chart"));ve(Nt)&&ee[Nt]&&ee[Nt].hasRendered&&ee[Nt].destroy(),O(vt,"data-highcharts-chart",this.index),vt.innerHTML=B.emptyHTML,je.skipClone||vt.offsetWidth||this.temporaryDisplay(),this.getChartSize(),Nt=this.chartWidth;var Kt=this.chartHeight;if(ae(vt,{overflow:"hidden"}),this.styledMode||(ct=de({position:"relative",overflow:"hidden",width:Nt+"px",height:Kt+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)",userSelect:"none","touch-action":"manipulation",outline:"none"},je.style||{})),this.container=it=Z("div",{id:it},ct,vt),this._cursor=it.style.cursor,this.renderer=new(je.renderer||!D?Y.getRendererType(je.renderer):N)(it,Nt,Kt,void 0,je.forExport,Pe.exporting&&Pe.exporting.allowHTML,this.styledMode),W(void 0,this),this.setClassName(je.className),this.styledMode)for(var vi in Pe.defs)this.renderer.definition(Pe.defs[vi]);else this.renderer.setStyle(je.style);this.renderer.chartIndex=this.index,Ie(this,"afterGetContainer")},lt.prototype.getMargins=function(Pe){var je=this.spacing,it=this.margin,ct=this.titleOffset;this.resetMargins(),ct[0]&&!ue(it[0])&&(this.plotTop=Math.max(this.plotTop,ct[0]+je[0])),ct[2]&&!ue(it[2])&&(this.marginBottom=Math.max(this.marginBottom,ct[2]+je[2])),this.legend&&this.legend.display&&this.legend.adjustMargins(it,je),Ie(this,"getMargins"),Pe||this.getAxisMargins()},lt.prototype.getAxisMargins=function(){var Pe=this,je=Pe.axisOffset=[0,0,0,0],it=Pe.colorAxis,ct=Pe.margin,vt=function(Nt){Nt.forEach(function(Kt){Kt.visible&&Kt.getOffset()})};Pe.hasCartesianSeries?vt(Pe.axes):it&&it.length&&vt(it),q.forEach(function(Nt,Kt){ue(ct[Kt])||(Pe[Nt]+=je[Kt])}),Pe.setChartSize()},lt.prototype.reflow=function(Pe){var je=this,it=je.options.chart,ct=je.renderTo,vt=ue(it.width)&&ue(it.height),Nt=it.width||De(ct,"width");it=it.height||De(ct,"height"),ct=Pe?Pe.target:z,delete je.pointer.chartPosition,!vt&&!je.isPrinting&&Nt&&it&&(ct===z||ct===J)&&((Nt!==je.containerWidth||it!==je.containerHeight)&&(I.clearTimeout(je.reflowTimeout),je.reflowTimeout=Ut(function(){je.container&&je.setSize(void 0,void 0,!1)},Pe?100:0)),je.containerWidth=Nt,je.containerHeight=it)},lt.prototype.setReflow=function(Pe){var je=this;!1===Pe||this.unbindReflow?!1===Pe&&this.unbindReflow&&(this.unbindReflow=this.unbindReflow()):(this.unbindReflow=S(z,"resize",function(it){je.options&&je.reflow(it)}),S(this,"destroy",this.unbindReflow))},lt.prototype.setSize=function(Pe,je,it){var ct=this,vt=ct.renderer;ct.isResizing+=1,W(it,ct),it=vt.globalAnimation,ct.oldChartHeight=ct.chartHeight,ct.oldChartWidth=ct.chartWidth,typeof Pe<"u"&&(ct.options.chart.width=Pe),typeof je<"u"&&(ct.options.chart.height=je),ct.getChartSize(),ct.styledMode||(it?P:ae)(ct.container,{width:ct.chartWidth+"px",height:ct.chartHeight+"px"},it),ct.setChartSize(!0),vt.setSize(ct.chartWidth,ct.chartHeight,it),ct.axes.forEach(function(Nt){Nt.isDirty=!0,Nt.setScale()}),ct.isDirtyLegend=!0,ct.isDirtyBox=!0,ct.layOutTitles(),ct.getMargins(),ct.redraw(it),ct.oldChartHeight=null,Ie(ct,"resize"),Ut(function(){ct&&Ie(ct,"endResize",null,function(){--ct.isResizing})},H(it).duration)},lt.prototype.setChartSize=function(Pe){var Ki,mi,Ii,xn,je=this.inverted,it=this.renderer,ct=this.chartWidth,vt=this.chartHeight,Nt=this.options.chart,Kt=this.spacing,vi=this.clipOffset;this.plotLeft=Ki=Math.round(this.plotLeft),this.plotTop=mi=Math.round(this.plotTop),this.plotWidth=Ii=Math.max(0,Math.round(ct-Ki-this.marginRight)),this.plotHeight=xn=Math.max(0,Math.round(vt-mi-this.marginBottom)),this.plotSizeX=je?xn:Ii,this.plotSizeY=je?Ii:xn,this.plotBorderWidth=Nt.plotBorderWidth||0,this.spacingBox=it.spacingBox={x:Kt[3],y:Kt[0],width:ct-Kt[3]-Kt[1],height:vt-Kt[0]-Kt[2]},this.plotBox=it.plotBox={x:Ki,y:mi,width:Ii,height:xn},je=2*Math.floor(this.plotBorderWidth/2),ct=Math.ceil(Math.max(je,vi[3])/2),vt=Math.ceil(Math.max(je,vi[0])/2),this.clipBox={x:ct,y:vt,width:Math.floor(this.plotSizeX-Math.max(je,vi[1])/2-ct),height:Math.max(0,Math.floor(this.plotSizeY-Math.max(je,vi[2])/2-vt))},Pe||(this.axes.forEach(function(Qi){Qi.setAxisSize(),Qi.setAxisTranslation()}),it.alignElements()),Ie(this,"afterSetChartSize",{skipAxes:Pe})},lt.prototype.resetMargins=function(){Ie(this,"resetMargins");var Pe=this,je=Pe.options.chart;["margin","spacing"].forEach(function(it){var ct=je[it],vt=xe(ct)?ct:[ct,ct,ct,ct];["Top","Right","Bottom","Left"].forEach(function(Nt,Kt){Pe[it][Kt]=Ne(je[it+Nt],vt[Kt])})}),q.forEach(function(it,ct){Pe[it]=Ne(Pe.margin[ct],Pe.spacing[ct])}),Pe.axisOffset=[0,0,0,0],Pe.clipOffset=[0,0,0,0]},lt.prototype.drawChartBox=function(){var yr,Pe=this.options.chart,je=this.renderer,it=this.chartWidth,ct=this.chartHeight,vt=this.styledMode,Nt=this.plotBGImage,Kt=Pe.backgroundColor,vi=Pe.plotBackgroundColor,Ki=Pe.plotBackgroundImage,mi=this.plotLeft,Ii=this.plotTop,xn=this.plotWidth,Qi=this.plotHeight,bn=this.plotBox,Ri=this.clipRect,_r=this.clipBox,Er=this.chartBackground,or=this.plotBackground,go=this.plotBorder,kr="animate";if(Er||(this.chartBackground=Er=je.rect().addClass("highcharts-background").add(),kr="attr"),vt)var Fr=yr=Er.strokeWidth();else yr=(Fr=Pe.borderWidth||0)+(Pe.shadow?8:0),Kt={fill:Kt||"none"},(Fr||Er["stroke-width"])&&(Kt.stroke=Pe.borderColor,Kt["stroke-width"]=Fr),Er.attr(Kt).shadow(Pe.shadow);Er[kr]({x:yr/2,y:yr/2,width:it-yr-Fr%2,height:ct-yr-Fr%2,r:Pe.borderRadius}),kr="animate",or||(kr="attr",this.plotBackground=or=je.rect().addClass("highcharts-plot-background").add()),or[kr](bn),vt||(or.attr({fill:vi||"none"}).shadow(Pe.plotShadow),Ki&&(Nt?(Ki!==Nt.attr("href")&&Nt.attr("href",Ki),Nt.animate(bn)):this.plotBGImage=je.image(Ki,mi,Ii,xn,Qi).add())),Ri?Ri.animate({width:_r.width,height:_r.height}):this.clipRect=je.clipRect(_r),kr="animate",go||(kr="attr",this.plotBorder=go=je.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),vt||go.attr({stroke:Pe.plotBorderColor,"stroke-width":Pe.plotBorderWidth||0,fill:"none"}),go[kr](go.crisp({x:mi,y:Ii,width:xn,height:Qi},-go.strokeWidth())),this.isDirtyBox=!1,Ie(this,"afterDrawChartBox")},lt.prototype.propFromSeries=function(){var ct,vt,Nt,Pe=this,je=Pe.options.chart,it=Pe.options.series;["inverted","angular","polar"].forEach(function(Kt){for(vt=T[je.type||je.defaultSeriesType],Nt=je[Kt]||vt&&vt.prototype[Kt],ct=it&&it.length;!Nt&&ct--;)(vt=T[it[ct].type])&&vt.prototype[Kt]&&(Nt=!0);Pe[Kt]=Nt})},lt.prototype.linkSeries=function(){var Pe=this,je=Pe.series;je.forEach(function(it){it.linkedSeries.length=0}),je.forEach(function(it){var ct=it.options.linkedTo;Re(ct)&&(ct=":previous"===ct?Pe.series[it.index-1]:Pe.get(ct))&&ct.linkedParent!==it&&(ct.linkedSeries.push(it),it.linkedParent=ct,ct.enabledDataSorting&&it.setDataSortingOptions(),it.visible=Ne(it.options.visible,ct.options.visible,it.visible))}),Ie(this,"afterLinkSeries")},lt.prototype.renderSeries=function(){this.series.forEach(function(Pe){Pe.translate(),Pe.render()})},lt.prototype.renderLabels=function(){var Pe=this,je=Pe.options.labels;je.items&&je.items.forEach(function(it){var ct=de(je.style,it.style),vt=Ze(ct.left)+Pe.plotLeft,Nt=Ze(ct.top)+Pe.plotTop+12;delete ct.left,delete ct.top,Pe.renderer.text(it.html,vt,Nt).attr({zIndex:2}).css(ct).add()})},lt.prototype.render=function(){var Pe=this.axes,je=this.colorAxis,it=this.renderer,ct=this.options,vt=function(mi){mi.forEach(function(Ii){Ii.visible&&Ii.render()})},Nt=0;this.setTitle(),this.legend=new be(this,ct.legend),this.getStacks&&this.getStacks(),this.getMargins(!0),this.setChartSize(),ct=this.plotWidth,Pe.some(function(mi){if(mi.horiz&&mi.visible&&mi.options.labels.enabled&&mi.series.length)return Nt=21,!0});var Kt=this.plotHeight=Math.max(this.plotHeight-Nt,0);Pe.forEach(function(mi){mi.setScale()}),this.getAxisMargins();var vi=1.1<ct/this.plotWidth,Ki=1.05<Kt/this.plotHeight;(vi||Ki)&&(Pe.forEach(function(mi){(mi.horiz&&vi||!mi.horiz&&Ki)&&mi.setTickInterval(!0)}),this.getMargins()),this.drawChartBox(),this.hasCartesianSeries?vt(Pe):je&&je.length&&vt(je),this.seriesGroup||(this.seriesGroup=it.g("series-group").attr({zIndex:3}).add()),this.renderSeries(),this.renderLabels(),this.addCredits(),this.setResponsive&&this.setResponsive(),this.hasRendered=!0},lt.prototype.addCredits=function(Pe){var je=this,it=we(!0,this.options.credits,Pe);it.enabled&&!this.credits&&(this.credits=this.renderer.text(it.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){it.href&&(z.location.href=it.href)}).attr({align:it.position.align,zIndex:8}),je.styledMode||this.credits.css(it.style),this.credits.add().align(it.position),this.credits.update=function(ct){je.credits=je.credits.destroy(),je.addCredits(ct)})},lt.prototype.destroy=function(){var Nt,Pe=this,je=Pe.axes,it=Pe.series,ct=Pe.container,vt=ct&&ct.parentNode;for(Ie(Pe,"destroy"),Pe.renderer.forExport?V(ee,Pe):ee[Pe.index]=void 0,Se.chartCount--,Pe.renderTo.removeAttribute("data-highcharts-chart"),wt(Pe),Nt=je.length;Nt--;)je[Nt]=je[Nt].destroy();for(this.scroller&&this.scroller.destroy&&this.scroller.destroy(),Nt=it.length;Nt--;)it[Nt]=it[Nt].destroy();"title subtitle chartBackground plotBackground plotBGImage plotBorder seriesGroup clipRect credits pointer rangeSelector legend resetZoomButton tooltip renderer".split(" ").forEach(function(Kt){var vi=Pe[Kt];vi&&vi.destroy&&(Pe[Kt]=vi.destroy())}),ct&&(ct.innerHTML=B.emptyHTML,wt(ct),vt&&ge(ct)),Le(Pe,function(Kt,vi){delete Pe[vi]})},lt.prototype.firstRender=function(){var Pe=this,je=Pe.options;(!Pe.isReadyToRender||Pe.isReadyToRender())&&(Pe.getContainer(),Pe.resetMargins(),Pe.setChartSize(),Pe.propFromSeries(),Pe.getAxes(),(oe(je.series)?je.series:[]).forEach(function(it){Pe.initSeries(it)}),Pe.linkSeries(),Pe.setSeriesData(),Ie(Pe,"beforeRender"),K&&(Pe.pointer=ce.isRequired()?new ce(Pe,je):new K(Pe,je)),Pe.render(),Pe.pointer.getChartPosition(),!Pe.renderer.imgCount&&!Pe.hasLoaded&&Pe.onload(),Pe.temporaryDisplay(!0))},lt.prototype.onload=function(){this.callbacks.concat([this.callback]).forEach(function(Pe){Pe&&typeof this.index<"u"&&Pe.apply(this,[this])},this),Ie(this,"load"),Ie(this,"render"),ue(this.index)&&this.setReflow(this.options.chart.reflow),this.warnIfA11yModuleNotLoaded(),this.hasLoaded=!0},lt.prototype.warnIfA11yModuleNotLoaded=function(){var Pe=this.options,je=this.title;Pe&&!this.accessibility&&(this.renderer.boxWrapper.attr({role:"img","aria-label":je&&je.element.textContent||""}),Pe.accessibility&&!1===Pe.accessibility.enabled||$('Highcharts warning: Consider including the "accessibility.js" module to make your chart more usable for people with disabilities. Set the "accessibility.enabled" option to false to remove this warning. See https://www.highcharts.com/docs/accessibility/accessibility-module.',!1,this))},lt.prototype.addSeries=function(Pe,je,it){var vt,ct=this;return Pe&&(je=Ne(je,!0),Ie(ct,"addSeries",{options:Pe},function(){vt=ct.initSeries(Pe),ct.isDirtyLegend=!0,ct.linkSeries(),vt.enabledDataSorting&&vt.setData(Pe.data,!1),Ie(ct,"afterAddSeries",{series:vt}),je&&ct.redraw(it)})),vt},lt.prototype.addAxis=function(Pe,je,it,ct){return this.createAxis(je?"xAxis":"yAxis",{axis:Pe,redraw:it,animation:ct})},lt.prototype.addColorAxis=function(Pe,je,it){return this.createAxis("colorAxis",{axis:Pe,redraw:je,animation:it})},lt.prototype.createAxis=function(Pe,je){return Pe=new me(this,we(je.axis,{index:this[Pe].length,isX:"xAxis"===Pe})),Ne(je.redraw,!0)&&this.redraw(je.animation),Pe},lt.prototype.showLoading=function(Pe){var je=this,it=je.options,ct=it.loading,vt=function(){Nt&&ae(Nt,{left:je.plotLeft+"px",top:je.plotTop+"px",width:je.plotWidth+"px",height:je.plotHeight+"px"})},Nt=je.loadingDiv,Kt=je.loadingSpan;Nt||(je.loadingDiv=Nt=Z("div",{className:"highcharts-loading highcharts-loading-hidden"},null,je.container)),Kt||(je.loadingSpan=Kt=Z("span",{className:"highcharts-loading-inner"},null,Nt),S(je,"redraw",vt)),Nt.className="highcharts-loading",B.setElementHTML(Kt,Ne(Pe,it.lang.loading,"")),je.styledMode||(ae(Nt,de(ct.style,{zIndex:10})),ae(Kt,ct.labelStyle),je.loadingShown||(ae(Nt,{opacity:0,display:""}),P(Nt,{opacity:ct.style.opacity||.5},{duration:ct.showDuration||0}))),je.loadingShown=!0,vt()},lt.prototype.hideLoading=function(){var Pe=this.options,je=this.loadingDiv;je&&(je.className="highcharts-loading highcharts-loading-hidden",this.styledMode||P(je,{opacity:0},{duration:Pe.loading.hideDuration||100,complete:function(){ae(je,{display:"none"})}})),this.loadingShown=!1},lt.prototype.update=function(Pe,je,it,ct){var Ki,mi,vt=this,Nt={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"},Kt=Pe.isResponsiveOptions,vi=[];Ie(vt,"update",{options:Pe}),Kt||vt.setResponsive(!1,!0),Pe=M(Pe,vt.options),vt.userOptions=we(vt.userOptions,Pe);var Ii=Pe.chart;if(Ii){if(we(!0,vt.options.chart,Ii),"className"in Ii&&vt.setClassName(Ii.className),"reflow"in Ii&&vt.setReflow(Ii.reflow),"inverted"in Ii||"polar"in Ii||"type"in Ii){vt.propFromSeries();var xn=!0}"alignTicks"in Ii&&(xn=!0),"events"in Ii&&te(this,Ii),Le(Ii,function(Qi,bn){-1!==vt.propsRequireUpdateSeries.indexOf("chart."+bn)&&(Ki=!0),-1!==vt.propsRequireDirtyBox.indexOf(bn)&&(vt.isDirtyBox=!0),-1!==vt.propsRequireReflow.indexOf(bn)&&(Kt?vt.isDirtyBox=!0:mi=!0)}),!vt.styledMode&&Ii.style&&vt.renderer.setStyle(vt.options.chart.style||{})}!vt.styledMode&&Pe.colors&&(this.options.colors=Pe.colors),Pe.time&&(this.time===U&&(this.time=new R(Pe.time)),we(!0,vt.options.time,Pe.time)),Le(Pe,function(Qi,bn){vt[bn]&&"function"==typeof vt[bn].update?vt[bn].update(Qi,!1):"function"==typeof vt[Nt[bn]]?vt[Nt[bn]](Qi):"colors"!==bn&&-1===vt.collectionsWithUpdate.indexOf(bn)&&we(!0,vt.options[bn],Pe[bn]),"chart"!==bn&&-1!==vt.propsRequireUpdateSeries.indexOf(bn)&&(Ki=!0)}),this.collectionsWithUpdate.forEach(function(Qi){if(Pe[Qi]){var bn=[];vt[Qi].forEach(function(Ri,_r){Ri.options.isInternal||bn.push(Ne(Ri.options.index,_r))}),Tt(Pe[Qi]).forEach(function(Ri,_r){var or,Er=ue(Ri.id);Er&&(or=vt.get(Ri.id)),!or&&vt[Qi]&&(or=vt[Qi][bn?bn[_r]:_r])&&Er&&ue(or.options.id)&&(or=void 0),or&&or.coll===Qi&&(or.update(Ri,!1),it&&(or.touched=!0)),!or&&it&&vt.collectionsWithInit[Qi]&&(vt.collectionsWithInit[Qi][0].apply(vt,[Ri].concat(vt.collectionsWithInit[Qi][1]||[]).concat([!1])).touched=!0)}),it&&vt[Qi].forEach(function(Ri){Ri.touched||Ri.options.isInternal?delete Ri.touched:vi.push(Ri)})}}),vi.forEach(function(Qi){Qi.chart&&Qi.remove&&Qi.remove(!1)}),xn&&vt.axes.forEach(function(Qi){Qi.update({},!1)}),Ki&&vt.getSeriesOrderByLinks().forEach(function(Qi){Qi.chart&&Qi.update({},!1)},this),xn=Ii&&Ii.width,Ii=Ii&&(Re(Ii.height)?at(Ii.height,xn||vt.chartWidth):Ii.height),mi||ve(xn)&&xn!==vt.chartWidth||ve(Ii)&&Ii!==vt.chartHeight?vt.setSize(xn,Ii,ct):Ne(je,!0)&&vt.redraw(ct),Ie(vt,"afterUpdate",{options:Pe,redraw:je,animation:ct})},lt.prototype.setSubtitle=function(Pe,je){this.applyDescription("subtitle",Pe),this.layOutTitles(je)},lt.prototype.setCaption=function(Pe,je){this.applyDescription("caption",Pe),this.layOutTitles(je)},lt.prototype.showResetZoom=function(){function Pe(){je.zoomOut()}var je=this,it=A.lang,ct=je.options.chart.zooming.resetButton,vt=ct.theme,Nt="chart"===ct.relativeTo||"spacingBox"===ct.relativeTo?null:"scrollablePlotBox";Ie(this,"beforeShowResetZoom",null,function(){je.resetZoomButton=je.renderer.button(it.resetZoom,null,null,Pe,vt).attr({align:ct.position.align,title:it.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(ct.position,!1,Nt)}),Ie(this,"afterShowResetZoom")},lt.prototype.zoomOut=function(){Ie(this,"selection",{resetSelection:!0},this.zoom)},lt.prototype.zoom=function(Pe){var Nt,je=this,it=je.pointer,ct=je.inverted?it.mouseDownX:it.mouseDownY,vt=!1;!Pe||Pe.resetSelection?(je.axes.forEach(function(vi){Nt=vi.zoom()}),it.initiated=!1):Pe.xAxis.concat(Pe.yAxis).forEach(function(vi){var Ki=vi.axis,mi=je.inverted?Ki.left:Ki.top,xn=Ki.isXAxis,Qi=!1;(!xn&&ct>=mi&&ct<=(je.inverted?mi+Ki.width:mi+Ki.height)||xn||!ue(ct))&&(Qi=!0),it[xn?"zoomX":"zoomY"]&&Qi&&(Nt=Ki.zoom(vi.min,vi.max),Ki.displayBtn&&(vt=!0))});var Kt=je.resetZoomButton;vt&&!Kt?je.showResetZoom():!vt&&xe(Kt)&&(je.resetZoomButton=Kt.destroy()),Nt&&je.redraw(Ne(je.options.chart.animation,Pe&&Pe.animation,100>je.pointCount))},lt.prototype.pan=function(Pe,je){var it=this,ct=it.hoverPoints;je="object"==typeof je?je:{enabled:je,type:"x"};var vt=it.options.chart;vt&&vt.panning&&(vt.panning=je);var Kt,Nt=je.type;Ie(this,"pan",{originalEvent:Pe},function(){ct&&ct.forEach(function(mi){mi.setState()});var vi=it.xAxis;"xy"===Nt?vi=vi.concat(it.yAxis):"y"===Nt&&(vi=it.yAxis);var Ki={};vi.forEach(function(mi){if(mi.options.panningEnabled&&!mi.options.isInternal){var Ii=mi.horiz,xn=Pe[Ii?"chartX":"chartY"],Qi=it[Ii=Ii?"mouseDownX":"mouseDownY"],bn=mi.minPointOffset||0,Ri=mi.reversed&&!it.inverted||!mi.reversed&&it.inverted?-1:1,_r=mi.getExtremes(),Er=mi.toValue(Qi-xn,!0)+bn*Ri,or=mi.toValue(Qi+mi.len-xn,!0)-(bn*Ri||mi.isXAxis&&mi.pointRangePadding||0),go=or<Er;Ri=mi.hasVerticalPanning(),Qi=go?or:Er,Er=go?Er:or;var yr=mi.panningState;!Ri||mi.isXAxis||yr&&!yr.isDirty||mi.series.forEach(function(kr){var Fr=kr.getProcessedData(!0);Fr=kr.getExtremes(Fr.yData,!0),yr||(yr={startMin:Number.MAX_VALUE,startMax:-Number.MAX_VALUE}),ve(Fr.dataMin)&&ve(Fr.dataMax)&&(yr.startMin=Math.min(Ne(kr.options.threshold,1/0),Fr.dataMin,yr.startMin),yr.startMax=Math.max(Ne(kr.options.threshold,-1/0),Fr.dataMax,yr.startMax))}),Ri=Math.min(Ne(yr&&yr.startMin,_r.dataMin),bn?_r.min:mi.toValue(mi.toPixels(_r.min)-mi.minPixelPadding)),or=Math.max(Ne(yr&&yr.startMax,_r.dataMax),bn?_r.max:mi.toValue(mi.toPixels(_r.max)+mi.minPixelPadding)),mi.panningState=yr,mi.isOrdinal||(0<(bn=Ri-Qi)&&(Er+=bn,Qi=Ri),0<(bn=Er-or)&&(Er=or,Qi-=bn),mi.series.length&&Qi!==_r.min&&Er!==_r.max&&Qi>=Ri&&Er<=or&&(mi.setExtremes(Qi,Er,!1,!1,{trigger:"pan"}),!it.resetZoomButton&&Qi!==Ri&&Er!==or&&Nt.match("y")&&(it.showResetZoom(),mi.displayBtn=!1),Kt=!0),Ki[Ii]=xn)}}),Le(Ki,function(mi,Ii){it[Ii]=mi}),Kt&&it.redraw(!1),ae(it.container,{cursor:"move"})})},lt}(),de(re.prototype,{callbacks:[],collectionsWithInit:{xAxis:[re.prototype.addAxis,[!0]],yAxis:[re.prototype.addAxis,[!1]],series:[re.prototype.addSeries]},collectionsWithUpdate:["xAxis","yAxis","series"],propsRequireDirtyBox:"backgroundColor borderColor borderWidth borderRadius plotBackgroundColor plotBackgroundImage plotBorderColor plotBorderWidth plotShadow shadow".split(" "),propsRequireReflow:"margin marginTop marginRight marginBottom marginLeft spacing spacingTop spacingRight spacingBottom spacingLeft".split(" "),propsRequireUpdateSeries:"chart.inverted chart.polar chart.ignoreHiddenSeries chart.type colors plotOptions time tooltip".split(" ")}),re}),Ge(u,"Core/Legend/LegendSymbol.js",[u["Core/Utilities.js"]],function(re){var Ce,Se,me=re.merge,Te=re.pick;return(Se=Ce||(Ce={})).drawLineMarker=function(be){var ce=this.options,ne=be.symbolWidth,K=be.symbolHeight,Y=K/2,j=this.chart.renderer,N=this.legendGroup;be=be.baseline-Math.round(.3*be.fontMetrics.b);var R={},I=ce.marker;this.chart.styledMode||(R={"stroke-width":ce.lineWidth||0},ce.dashStyle&&(R.dashstyle=ce.dashStyle)),this.legendLine=j.path([["M",0,be],["L",ne,be]]).addClass("highcharts-graph").attr(R).add(N),I&&!1!==I.enabled&&ne&&(ce=Math.min(Te(I.radius,Y),Y),0===this.symbol.indexOf("url")&&(I=me(I,{width:K,height:K}),ce=0),this.legendSymbol=ne=j.symbol(this.symbol,ne/2-ce,be-ce,2*ce,2*ce,I).addClass("highcharts-point").add(N),ne.isMarker=!0)},Se.drawRectangle=function(be,ce){var ne=be.symbolHeight,K=be.options.squareSymbol;ce.legendSymbol=this.chart.renderer.rect(K?(be.symbolWidth-ne)/2:0,be.baseline-ne+1,K?ne:be.symbolWidth,ne,Te(be.options.symbolRadius,ne/2)).addClass("highcharts-point").attr({zIndex:3}).add(ce.legendGroup)},Ce}),Ge(u,"Core/Series/SeriesDefaults.js",[],function(){return{lineWidth:2,allowPointSelect:!1,crisp:!0,showCheckbox:!1,animation:{duration:1e3},events:{},marker:{enabledThreshold:2,lineColor:"#ffffff",lineWidth:0,radius:4,states:{normal:{animation:!0},hover:{animation:{duration:50},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{animation:{},align:"center",defer:!0,formatter:function(){return"number"!=typeof this.y?"":(0,this.series.chart.numberFormatter)(this.y,-1)},padding:5,style:{fontSize:"11px",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0},cropThreshold:300,opacity:1,pointRange:0,softThreshold:!0,states:{normal:{animation:!0},hover:{animation:{duration:50},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{animation:{duration:0}},inactive:{animation:{duration:50},opacity:.2}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"}}),Ge(u,"Core/Series/Series.js",[u["Core/Animation/AnimationUtilities.js"],u["Core/DefaultOptions.js"],u["Core/Foundation.js"],u["Core/Globals.js"],u["Core/Legend/LegendSymbol.js"],u["Core/Series/Point.js"],u["Core/Series/SeriesDefaults.js"],u["Core/Series/SeriesRegistry.js"],u["Core/Renderer/SVG/SVGElement.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce,Se,be,ce,ne,K,Y){var j=re.animObject,N=re.setAnimation,R=me.defaultOptions,I=Te.registerEventOptions,B=Ce.hasTouch,P=Ce.svg,H=Ce.win,W=ne.seriesTypes,ie=Y.addEvent,te=Y.arrayMax,ee=Y.arrayMin,J=Y.clamp,q=Y.cleanRecursively,D=Y.correctFloat,z=Y.defined,A=Y.erase,U=Y.error,T=Y.extend,S=Y.find,O=Y.fireEvent,M=Y.getNestedProperty,Z=Y.isArray,ae=Y.isNumber,ue=Y.isString,ge=Y.merge,V=Y.objectEach,$=Y.pick,de=Y.removeEvent,Me=Y.splat,Ie=Y.syncTimeout;return re=function(){function De(){this.zones=this.yAxis=this.xAxis=this.userOptions=this.tooltipOptions=this.processedYData=this.processedXData=this.points=this.options=this.linkedSeries=this.index=this.eventsToUnbind=this.eventOptions=this.data=this.chart=this._i=void 0}return De.prototype.init=function(oe,ve){O(this,"init",{options:ve});var xe=this,Re=oe.series;this.eventsToUnbind=[],xe.chart=oe,xe.options=xe.setOptions(ve),ve=xe.options,xe.linkedSeries=[],xe.bindAxes(),T(xe,{name:ve.name,state:"",visible:!1!==ve.visible,selected:!0===ve.selected}),I(this,ve);var Le,we=ve.events;(we&&we.click||ve.point&&ve.point.events&&ve.point.events.click||ve.allowPointSelect)&&(oe.runTrackerClick=!0),xe.getColor(),xe.getSymbol(),xe.parallelArrays.forEach(function(Ne){xe[Ne+"Data"]||(xe[Ne+"Data"]=[])}),xe.isCartesian&&(oe.hasCartesianSeries=!0),Re.length&&(Le=Re[Re.length-1]),xe._i=$(Le&&Le._i,-1)+1,xe.opacity=xe.options.opacity,oe.orderSeries(this.insert(Re)),ve.dataSorting&&ve.dataSorting.enabled?xe.setDataSortingOptions():xe.points||xe.data||xe.setData(ve.data,!1),O(this,"afterInit")},De.prototype.is=function(oe){return W[oe]&&this instanceof W[oe]},De.prototype.insert=function(oe){var xe,ve=this.options.index;if(ae(ve)){for(xe=oe.length;xe--;)if(ve>=$(oe[xe].options.index,oe[xe]._i)){oe.splice(xe+1,0,this);break}-1===xe&&oe.unshift(this),xe+=1}else oe.push(this);return $(xe,oe.length-1)},De.prototype.bindAxes=function(){var Re,oe=this,ve=oe.options,xe=oe.chart;O(this,"bindAxes",null,function(){(oe.axisTypes||[]).forEach(function(we){var Le=0;xe[we].forEach(function(Ne){Re=Ne.options,(ve[we]===Le&&!Re.isInternal||typeof ve[we]<"u"&&ve[we]===Re.id||typeof ve[we]>"u"&&0===Re.index)&&(oe.insert(Ne.series),oe[we]=Ne,Ne.isDirty=!0),Re.isInternal||Le++}),oe[we]||oe.optionalAxis===we||U(18,!0,xe)})}),O(this,"afterBindAxes")},De.prototype.updateParallelArrays=function(oe,ve){var xe=oe.series,Re=arguments,we=ae(ve)?function(Le){var Ne="y"===Le&&xe.toYData?xe.toYData(oe):oe[Le];xe[Le+"Data"][ve]=Ne}:function(Le){Array.prototype[ve].apply(xe[Le+"Data"],Array.prototype.slice.call(Re,2))};xe.parallelArrays.forEach(we)},De.prototype.hasData=function(){return this.visible&&typeof this.dataMax<"u"&&typeof this.dataMin<"u"||this.visible&&this.yData&&0<this.yData.length},De.prototype.autoIncrement=function(oe){var Ne,ve=this.options,xe=ve.pointIntervalUnit,Re=ve.relativeXValue,we=this.chart.time,Le=this.xIncrement;return Le=$(Le,ve.pointStart,0),this.pointInterval=Ne=$(this.pointInterval,ve.pointInterval,1),Re&&ae(oe)&&(Ne*=oe),xe&&(ve=new we.Date(Le),"day"===xe?we.set("Date",ve,we.get("Date",ve)+Ne):"month"===xe?we.set("Month",ve,we.get("Month",ve)+Ne):"year"===xe&&we.set("FullYear",ve,we.get("FullYear",ve)+Ne),Ne=ve.getTime()-Le),Re&&ae(oe)?Le+Ne:(this.xIncrement=Le+Ne,Le)},De.prototype.setDataSortingOptions=function(){var oe=this.options;T(this,{requireSorting:!1,sorted:!1,enabledDataSorting:!0,allowDG:!1}),z(oe.pointRange)||(oe.pointRange=1)},De.prototype.setOptions=function(oe){var ve=this.chart,xe=ve.options,Re=xe.plotOptions,we=ve.userOptions||{};oe=ge(oe),ve=ve.styledMode;var Le={plotOptions:Re,userOptions:oe};O(this,"setOptions",Le);var Ne=Le.plotOptions[this.type],Ze=we.plotOptions||{};return this.userOptions=Le.userOptions,we=ge(Ne,Re.series,we.plotOptions&&we.plotOptions[this.type],oe),this.tooltipOptions=ge(R.tooltip,R.plotOptions.series&&R.plotOptions.series.tooltip,R.plotOptions[this.type].tooltip,xe.tooltip.userOptions,Re.series&&Re.series.tooltip,Re[this.type].tooltip,oe.tooltip),this.stickyTracking=$(oe.stickyTracking,Ze[this.type]&&Ze[this.type].stickyTracking,Ze.series&&Ze.series.stickyTracking,!(!this.tooltipOptions.shared||this.noSharedTooltip)||we.stickyTracking),null===Ne.marker&&delete we.marker,this.zoneAxis=we.zoneAxis,Re=this.zones=(we.zones||[]).slice(),!we.negativeColor&&!we.negativeFillColor||we.zones||(xe={value:we[this.zoneAxis+"Threshold"]||we.threshold||0,className:"highcharts-negative"},ve||(xe.color=we.negativeColor,xe.fillColor=we.negativeFillColor),Re.push(xe)),Re.length&&z(Re[Re.length-1].value)&&Re.push(ve?{}:{color:this.color,fillColor:this.fillColor}),O(this,"afterSetOptions",{options:we}),we},De.prototype.getName=function(){return $(this.options.name,"Series "+(this.index+1))},De.prototype.getCyclic=function(oe,ve,xe){var Re=this.chart,we=this.userOptions,Le=oe+"Index",Ne=oe+"Counter",Ze=xe?xe.length:$(Re.options.chart[oe+"Count"],Re[oe+"Count"]);if(!ve){var at=$(we[Le],we["_"+Le]);z(at)||(Re.series.length||(Re[Ne]=0),we["_"+Le]=at=Re[Ne]%Ze,Re[Ne]+=1),xe&&(ve=xe[at])}typeof at<"u"&&(this[Le]=at),this[oe]=ve},De.prototype.getColor=function(){this.chart.styledMode?this.getCyclic("color"):this.options.colorByPoint?this.color="#cccccc":this.getCyclic("color",this.options.color||R.plotOptions[this.type].color,this.chart.options.colors)},De.prototype.getPointsCollection=function(){return(this.hasGroupedData?this.points:this.data)||[]},De.prototype.getSymbol=function(){this.getCyclic("symbol",this.options.marker.symbol,this.chart.options.symbols)},De.prototype.findPointIndex=function(oe,ve){var Ne,Ze,xe=oe.id,Re=oe.x,we=this.points,Le=this.options.dataSorting;if(xe)(Le=this.chart.get(xe))instanceof be&&(Ne=Le);else if((this.linkedParent||this.enabledDataSorting||this.options.relativeXValue)&&(Ne=function(wt){return!wt.touched&&wt.index===oe.index},Le&&Le.matchByName?Ne=function(wt){return!wt.touched&&wt.name===oe.name}:this.options.relativeXValue&&(Ne=function(wt){return!wt.touched&&wt.options.x===oe.x}),!(Ne=S(we,Ne))))return;if(Ne){var at=Ne&&Ne.index;typeof at<"u"&&(Ze=!0)}return typeof at>"u"&&ae(Re)&&(at=this.xData.indexOf(Re,ve)),-1!==at&&typeof at<"u"&&this.cropped&&(at=at>=this.cropStart?at-this.cropStart:at),!Ze&&ae(at)&&we[at]&&we[at].touched&&(at=void 0),at},De.prototype.updateData=function(oe,ve){var at,wt,Tt,xe=this.options,Re=xe.dataSorting,we=this.points,Le=[],Ne=this.requireSorting,Ze=oe.length===we.length,Ut=!0;if(this.xIncrement=null,oe.forEach(function(bt,lt){var Pe=z(bt)&&this.pointClass.prototype.optionsToObject.call({series:this},bt)||{};Pe.id||ae(Pe.x)?(-1===(Pe=this.findPointIndex(Pe,Tt))||typeof Pe>"u"?Le.push(bt):we[Pe]&&bt!==xe.data[Pe]?(we[Pe].update(bt,!1,null,!1),we[Pe].touched=!0,Ne&&(Tt=Pe+1)):we[Pe]&&(we[Pe].touched=!0),(!Ze||lt!==Pe||Re&&Re.enabled||this.hasDerivedData)&&(at=!0)):Le.push(bt)},this),at)for(oe=we.length;oe--;)(wt=we[oe])&&!wt.touched&&wt.remove&&wt.remove(!1,ve);else!Ze||Re&&Re.enabled?Ut=!1:(oe.forEach(function(bt,lt){bt!==we[lt].y&&we[lt].update&&we[lt].update(bt,!1,null,!1)}),Le.length=0);return we.forEach(function(bt){bt&&(bt.touched=!1)}),!!Ut&&(Le.forEach(function(bt){this.addPoint(bt,!1,null,null,!1)},this),null===this.xIncrement&&this.xData&&this.xData.length&&(this.xIncrement=te(this.xData),this.autoIncrement()),!0)},De.prototype.setData=function(oe,ve,xe,Re){void 0===ve&&(ve=!0);var we=this,Le=we.points,Ne=Le&&Le.length||0,Ze=we.options,at=we.chart,wt=Ze.dataSorting,Tt=we.xAxis,Ut=Ze.turboThreshold,bt=this.xData,lt=this.yData,Pe=we.pointArrayMap;Pe=Pe&&Pe.length;var it,je=Ze.keys,ct=0,vt=1,Nt=null;if(!at.options.chart.allowMutatingData){Ze.data&&delete we.options.data,we.userOptions.data&&delete we.userOptions.data;var Kt=ge(!0,oe)}if(Kt=(oe=Kt||oe||[]).length,wt&&wt.enabled&&(oe=this.sortData(oe)),at.options.chart.allowMutatingData&&!1!==Re&&Kt&&Ne&&!we.cropped&&!we.hasGroupedData&&we.visible&&!we.boosted&&(it=this.updateData(oe,xe)),!it){if(we.xIncrement=null,we.colorCounter=0,this.parallelArrays.forEach(function(vi){we[vi+"Data"].length=0}),Ut&&Kt>Ut)if(Nt=we.getFirstValidPoint(oe),ae(Nt))for(xe=0;xe<Kt;xe++)bt[xe]=this.autoIncrement(),lt[xe]=oe[xe];else if(Z(Nt))if(Pe)if(Nt.length===Pe)for(xe=0;xe<Kt;xe++)bt[xe]=this.autoIncrement(),lt[xe]=oe[xe];else for(xe=0;xe<Kt;xe++)bt[xe]=(Re=oe[xe])[0],lt[xe]=Re.slice(1,Pe+1);else if(je&&(ct=0<=(ct=je.indexOf("x"))?ct:0,vt=0<=(vt=je.indexOf("y"))?vt:1),1===Nt.length&&(vt=0),ct===vt)for(xe=0;xe<Kt;xe++)bt[xe]=this.autoIncrement(),lt[xe]=oe[xe][vt];else for(xe=0;xe<Kt;xe++)bt[xe]=(Re=oe[xe])[ct],lt[xe]=Re[vt];else U(12,!1,at);else for(xe=0;xe<Kt;xe++)typeof oe[xe]<"u"&&(we.pointClass.prototype.applyOptions.apply(Re={series:we},[oe[xe]]),we.updateParallelArrays(Re,xe));for(lt&&ue(lt[0])&&U(14,!0,at),we.data=[],we.options.data=we.userOptions.data=oe,xe=Ne;xe--;)Le[xe]&&Le[xe].destroy&&Le[xe].destroy();Tt&&(Tt.minRange=Tt.userMinRange),we.isDirty=at.isDirtyBox=!0,we.isDirtyData=!!Le,xe=!1}"point"===Ze.legendType&&(this.processData(),this.generatePoints()),ve&&at.redraw(xe)},De.prototype.sortData=function(oe){var ve=this,xe=ve.options.dataSorting.sortKey||"y",Re=function(we,Le){return z(Le)&&we.pointClass.prototype.optionsToObject.call({series:we},Le)||{}};return oe.forEach(function(we,Le){oe[Le]=Re(ve,we),oe[Le].index=Le},this),oe.concat().sort(function(we,Le){return we=M(xe,we),(Le=M(xe,Le))<we?-1:Le>we?1:0}).forEach(function(we,Le){we.x=Le},this),ve.linkedSeries&&ve.linkedSeries.forEach(function(we){var Le=we.options,Ne=Le.data;Le.dataSorting&&Le.dataSorting.enabled||!Ne||(Ne.forEach(function(Ze,at){Ne[at]=Re(we,Ze),oe[at]&&(Ne[at].x=oe[at].x,Ne[at].index=at)}),we.setData(Ne,!1))}),oe},De.prototype.getProcessedData=function(oe){var ve=this.xAxis,xe=this.options,Re=xe.cropThreshold,we=oe||this.getExtremesFromAll||xe.getExtremesFromAll,Le=this.isCartesian;oe=ve&&ve.val2lin,xe=!(!ve||!ve.logarithmic);var Ne=0,Ze=this.xData,at=this.yData,wt=this.requireSorting,Tt=!1,Ut=Ze.length;if(ve){var bt=(Tt=ve.getExtremes()).min,lt=Tt.max;Tt=!(!ve.categories||ve.names.length)}if(Le&&this.sorted&&!we&&(!Re||Ut>Re||this.forceCrop))if(Ze[Ut-1]<bt||Ze[0]>lt)Ze=[],at=[];else if(this.yData&&(Ze[0]<bt||Ze[Ut-1]>lt)){var Pe=this.cropData(this.xData,this.yData,bt,lt);Ze=Pe.xData,at=Pe.yData,Ne=Pe.start,Pe=!0}for(Re=Ze.length||1;--Re;)if(0<(ve=xe?oe(Ze[Re])-oe(Ze[Re-1]):Ze[Re]-Ze[Re-1])&&(typeof je>"u"||ve<je))var je=ve;else 0>ve&&wt&&!Tt&&(U(15,!1,this.chart),wt=!1);return{xData:Ze,yData:at,cropped:Pe,cropStart:Ne,closestPointRange:je}},De.prototype.processData=function(oe){if(this.isCartesian&&!this.isDirty&&!this.xAxis.isDirty&&!this.yAxis.isDirty&&!oe)return!1;oe=this.getProcessedData(),this.cropped=oe.cropped,this.cropStart=oe.cropStart,this.processedXData=oe.xData,this.processedYData=oe.yData,this.closestPointRange=this.basePointRange=oe.closestPointRange,O(this,"afterProcessData")},De.prototype.cropData=function(oe,ve,xe,Re,we){var Ne,Le=oe.length,Ze=0,at=Le;for(we=$(we,this.cropShoulder),Ne=0;Ne<Le;Ne++)if(oe[Ne]>=xe){Ze=Math.max(0,Ne-we);break}for(xe=Ne;xe<Le;xe++)if(oe[xe]>Re){at=xe+we;break}return{xData:oe.slice(Ze,at),yData:ve.slice(Ze,at),start:Ze,end:at}},De.prototype.generatePoints=function(){var oe=this.options,ve=this.processedData||oe.data,xe=this.processedXData,Re=this.processedYData,we=this.pointClass,Le=xe.length,Ne=this.cropStart||0,Ze=this.hasGroupedData,at=oe.keys,wt=[];oe=oe.dataGrouping&&oe.dataGrouping.groupAll?Ne:0;var Tt,Ut,bt=this.data;if(!bt&&!Ze){var lt=[];lt.length=ve.length,bt=this.data=lt}for(at&&Ze&&(this.options.keys=!1),Ut=0;Ut<Le;Ut++){if(lt=Ne+Ut,Ze){var Pe=(new we).init(this,[xe[Ut]].concat(Me(Re[Ut])));Pe.dataGroup=this.groupMap[oe+Ut],Pe.dataGroup.options&&(Pe.options=Pe.dataGroup.options,T(Pe,Pe.dataGroup.options),delete Pe.dataLabels)}else(Pe=bt[lt])||typeof ve[lt]>"u"||(bt[lt]=Pe=(new we).init(this,ve[lt],xe[Ut]));Pe&&(Pe.index=Ze?oe+Ut:lt,wt[Ut]=Pe)}if(this.options.keys=at,bt&&(Le!==(Tt=bt.length)||Ze))for(Ut=0;Ut<Tt;Ut++)Ut!==Ne||Ze||(Ut+=Le),bt[Ut]&&(bt[Ut].destroyElements(),bt[Ut].plotX=void 0);this.data=bt,this.points=wt,O(this,"afterGeneratePoints")},De.prototype.getXExtremes=function(oe){return{min:ee(oe),max:te(oe)}},De.prototype.getExtremes=function(oe,ve){var xe=this.xAxis,Re=this.yAxis,we=this.processedXData||this.xData,Le=[],Ne=this.requireSorting?this.cropShoulder:0;Re=!!Re&&Re.positiveValuesOnly;var Ze,at=0,wt=0,Tt=0,Ut=(oe=oe||this.stackedYData||this.processedYData||[]).length;if(xe){var bt=xe.getExtremes();at=bt.min,wt=bt.max}for(Ze=0;Ze<Ut;Ze++){var lt=we[Ze],Pe=(ae(bt=oe[Ze])||Z(bt))&&(bt.length||0<bt||!Re);if(lt=ve||this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||!xe||(we[Ze+Ne]||lt)>=at&&(we[Ze-Ne]||lt)<=wt,Pe&&lt)if(Pe=bt.length)for(;Pe--;)ae(bt[Pe])&&(Le[Tt++]=bt[Pe]);else Le[Tt++]=bt}return oe={activeYData:Le,dataMin:ee(Le),dataMax:te(Le)},O(this,"afterGetExtremes",{dataExtremes:oe}),oe},De.prototype.applyExtremes=function(){var oe=this.getExtremes();return this.dataMin=oe.dataMin,this.dataMax=oe.dataMax,oe},De.prototype.getFirstValidPoint=function(oe){for(var ve=oe.length,xe=0,Re=null;null===Re&&xe<ve;)Re=oe[xe],xe++;return Re},De.prototype.translate=function(){this.processedXData||this.processData(),this.generatePoints();var lt,Pe,oe=this.options,ve=oe.stacking,xe=this.xAxis,Re=xe.categories,we=this.enabledDataSorting,Le=this.yAxis,Ne=this.points,Ze=Ne.length,at=this.pointPlacementToXValue(),wt=!!at,Tt=oe.threshold,Ut=oe.startFromThreshold?Tt:0,bt=this.zoneAxis||"y",je=Number.MAX_VALUE;for(lt=0;lt<Ze;lt++){var it=Ne[lt],ct=it.x,vt=void 0,Nt=void 0,Kt=it.y,vi=it.low,Ki=ve&&Le.stacking&&Le.stacking.stacks[(this.negStacks&&Kt<(Ut?0:Tt)?"-":"")+this.stackKey];if((Le.positiveValuesOnly&&!Le.validatePositiveValue(Kt)||xe.positiveValuesOnly&&!xe.validatePositiveValue(ct))&&(it.isNull=!0),it.plotX=Pe=D(J(xe.translate(ct,0,0,0,1,at,"flags"===this.type),-1e5,1e5)),ve&&this.visible&&Ki&&Ki[ct]){var mi=this.getStackIndicator(mi,ct,this.index);it.isNull||(Nt=(vt=Ki[ct]).points[mi.key])}if(Z(Nt)&&(Kt=Nt[1],(vi=Nt[0])===Ut&&mi.key===Ki[ct].base&&(vi=$(ae(Tt)&&Tt,Le.min)),Le.positiveValuesOnly&&0>=vi&&(vi=null),it.total=it.stackTotal=vt.total,it.percentage=vt.total&&it.y/vt.total*100,it.stackY=Kt,this.irregularWidths||vt.setOffset(this.pointXOffset||0,this.barW||0)),it.yBottom=z(vi)?J(Le.translate(vi,0,1,0,1),-1e5,1e5):null,this.dataModify&&(Kt=this.dataModify.modifyValue(Kt,lt)),it.plotY=void 0,ae(Kt)&&typeof(vt=Le.translate(Kt,!1,!0,!1,!0))<"u"&&(it.plotY=J(vt,-1e5,1e5)),it.isInside=this.isPointInside(it),it.clientX=wt?D(xe.translate(ct,0,0,0,1,at)):Pe,it.negative=it[bt]<(oe[bt+"Threshold"]||Tt||0),it.category=$(Re&&Re[it.x],it.x),!it.isNull&&!1!==it.visible){typeof Ii<"u"&&(je=Math.min(je,Math.abs(Pe-Ii)));var Ii=Pe}it.zone=this.zones.length?it.getZone():void 0,!it.graphic&&this.group&&we&&(it.isNew=!0)}this.closestPointRangePx=je,O(this,"afterTranslate")},De.prototype.getValidPoints=function(oe,ve,xe){var Re=this.chart;return(oe||this.points||[]).filter(function(we){return!(ve&&!Re.isInsidePlot(we.plotX,we.plotY,{inverted:Re.inverted}))&&!1!==we.visible&&(xe||!we.isNull)})},De.prototype.getClipBox=function(){var oe=this.chart,ve=this.xAxis,xe=this.yAxis,Re=ge(oe.clipBox);return ve&&ve.len!==oe.plotSizeX&&(Re.width=ve.len),xe&&xe.len!==oe.plotSizeY&&(Re.height=xe.len),Re},De.prototype.getSharedClipKey=function(){return this.sharedClipKey=(this.options.xAxis||0)+","+(this.options.yAxis||0)},De.prototype.setClip=function(){var oe=this.chart,ve=this.group,xe=this.markerGroup,Re=oe.sharedClips;oe=oe.renderer;var we=this.getClipBox(),Le=this.getSharedClipKey(),Ne=Re[Le];Ne?Ne.animate(we):Re[Le]=Ne=oe.clipRect(we),ve&&ve.clip(!1===this.options.clip?void 0:Ne),xe&&xe.clip()},De.prototype.animate=function(oe){var ve=this.chart,xe=this.group,Re=this.markerGroup,we=ve.inverted,Le=j(this.options.animation),Ne=[this.getSharedClipKey(),Le.duration,Le.easing,Le.defer].join(),Ze=ve.sharedClips[Ne],at=ve.sharedClips[Ne+"m"];if(oe&&xe)Le=this.getClipBox(),Ze?Ze.attr("height",Le.height):(Le.width=0,we&&(Le.x=ve.plotHeight),Ze=ve.renderer.clipRect(Le),ve.sharedClips[Ne]=Ze,at=ve.renderer.clipRect({x:we?(ve.plotSizeX||0)+99:-99,y:we?-ve.plotLeft:-ve.plotTop,width:99,height:we?ve.chartWidth:ve.chartHeight}),ve.sharedClips[Ne+"m"]=at),xe.clip(Ze),Re&&Re.clip(at);else if(Ze&&!Ze.hasClass("highcharts-animating")){ve=this.getClipBox();var wt=Le.step;Re&&Re.element.childNodes.length&&(Le.step=function(Tt,Ut){wt&&wt.apply(Ut,arguments),at&&at.element&&at.attr(Ut.prop,"width"===Ut.prop?Tt+99:Tt)}),Ze.addClass("highcharts-animating").animate(ve,Le)}},De.prototype.afterAnimate=function(){var oe=this;this.setClip(),V(this.chart.sharedClips,function(ve,xe,Re){ve&&!oe.chart.container.querySelector('[clip-path="url(#'.concat(ve.id,')"]'))&&(ve.destroy(),delete Re[xe])}),this.finishedAnimating=!0,O(this,"afterAnimate")},De.prototype.drawPoints=function(){var Ne,Ze,oe=this.points,ve=this.chart,xe=this.options.marker,Re=this[this.specialGroup]||this.markerGroup,we=this.xAxis,Le=$(xe.enabled,!(we&&!we.isRadial)||null,this.closestPointRangePx>=xe.enabledThreshold*xe.radius);if(!1!==xe.enabled||this._hasPointMarkers)for(Ne=0;Ne<oe.length;Ne++){var at=oe[Ne],wt=(Ze=at.graphic)?"animate":"attr",Tt=at.marker||{},Ut=!!at.marker;if((Le&&typeof Tt.enabled>"u"||Tt.enabled)&&!at.isNull&&!1!==at.visible){var bt=$(Tt.symbol,this.symbol,"rect"),lt=this.markerAttribs(at,at.selected&&"select");this.enabledDataSorting&&(at.startXPos=we.reversed?-(lt.width||0):we.width);var Pe=!1!==at.isInside;Ze?Ze[Pe?"show":"hide"](Pe).animate(lt):Pe&&(0<(lt.width||0)||at.hasImage)&&(at.graphic=Ze=ve.renderer.symbol(bt,lt.x,lt.y,lt.width,lt.height,Ut?Tt:xe).add(Re),this.enabledDataSorting&&ve.hasRendered&&(Ze.attr({x:at.startXPos}),wt="animate")),Ze&&"animate"===wt&&Ze[Pe?"show":"hide"](Pe).animate(lt),Ze&&!ve.styledMode&&Ze[wt](this.pointAttribs(at,at.selected&&"select")),Ze&&Ze.addClass(at.getClassName(),!0)}else Ze&&(at.graphic=Ze.destroy())}},De.prototype.markerAttribs=function(oe,ve){var xe=this.options,Re=xe.marker,we=oe.marker||{},Le=we.symbol||Re.symbol,Ne=$(we.radius,Re&&Re.radius);return ve&&(Re=Re.states[ve],Ne=$((ve=we.states&&we.states[ve])&&ve.radius,Re&&Re.radius,Ne&&Ne+(Re&&Re.radiusPlus||0))),oe.hasImage=Le&&0===Le.indexOf("url"),oe.hasImage&&(Ne=0),oe=ae(Ne)?{x:xe.crisp?Math.floor(oe.plotX-Ne):oe.plotX-Ne,y:oe.plotY-Ne}:{},Ne&&(oe.width=oe.height=2*Ne),oe},De.prototype.pointAttribs=function(oe,ve){var xe=this.options.marker,Re=oe&&oe.options,we=Re&&Re.marker||{},Le=Re&&Re.color,Ne=oe&&oe.color,Ze=oe&&oe.zone&&oe.zone.color,at=this.color;return oe=$(we.lineWidth,xe.lineWidth),Re=1,at=Le||Ze||Ne||at,Le=we.fillColor||xe.fillColor||at,Ne=we.lineColor||xe.lineColor||at,xe=xe.states[ve=ve||"normal"]||{},oe=$((ve=we.states&&we.states[ve]||{}).lineWidth,xe.lineWidth,oe+$(ve.lineWidthPlus,xe.lineWidthPlus,0)),{stroke:Ne=ve.lineColor||xe.lineColor||Ne,"stroke-width":oe,fill:Le=ve.fillColor||xe.fillColor||Le,opacity:Re=$(ve.opacity,xe.opacity,Re)}},De.prototype.destroy=function(oe){var Ne,Ze,at,ve=this,xe=ve.chart,Re=/AppleWebKit\/533/.test(H.navigator.userAgent),we=ve.data||[];for(O(ve,"destroy",{keepEventsForUpdate:oe}),this.removeEvents(oe),(ve.axisTypes||[]).forEach(function(wt){(at=ve[wt])&&at.series&&(A(at.series,ve),at.isDirty=at.forceRedraw=!0)}),ve.legendItem&&ve.chart.legend.destroyItem(ve),Ne=we.length;Ne--;)(Ze=we[Ne])&&Ze.destroy&&Ze.destroy();ve.clips&&ve.clips.forEach(function(wt){return wt.destroy()}),Y.clearTimeout(ve.animationTimeout),V(ve,function(wt,Tt){wt instanceof K&&!wt.survive&&wt[Re&&"group"===Tt?"hide":"destroy"]()}),xe.hoverSeries===ve&&(xe.hoverSeries=void 0),A(xe.series,ve),xe.orderSeries(),V(ve,function(wt,Tt){oe&&"hcEvents"===Tt||delete ve[Tt]})},De.prototype.applyZones=function(){var Tt,Ut,bt,lt,Pe,je,it,ct,oe=this,ve=this.chart,xe=ve.renderer,Re=this.zones,we=this.clips||[],Le=this.graph,Ne=this.area,Ze=Math.max(ve.plotWidth,ve.plotHeight),at=this[(this.zoneAxis||"y")+"Axis"],wt=ve.inverted,vt=!1;if(Re.length&&(Le||Ne)&&at&&typeof at.min<"u"){var Nt=at.reversed,Kt=at.horiz;Le&&!this.showLine&&Le.hide(),Ne&&Ne.hide();var vi=at.getExtremes();Re.forEach(function(Ki,mi){Tt=Nt?Kt?ve.plotWidth:0:Kt?0:at.toPixels(vi.min)||0,Tt=J($(Ut,Tt),0,Ze),Ut=J(Math.round(at.toPixels($(Ki.value,vi.max),!0)||0),0,Ze),vt&&(Tt=Ut=at.toPixels(vi.max)),lt=Math.abs(Tt-Ut),Pe=Math.min(Tt,Ut),je=Math.max(Tt,Ut),at.isXAxis?(bt={x:wt?je:Pe,y:0,width:lt,height:Ze},Kt||(bt.x=ve.plotHeight-bt.x)):(bt={x:0,y:wt?je:Pe,width:Ze,height:lt},Kt&&(bt.y=ve.plotWidth-bt.y)),wt&&xe.isVML&&(bt=at.isXAxis?{x:0,y:Nt?Pe:je,height:bt.width,width:ve.chartWidth}:{x:bt.y-ve.plotLeft-ve.spacingBox.x,y:0,width:bt.height,height:ve.chartHeight}),we[mi]?we[mi].animate(bt):we[mi]=xe.clipRect(bt),it=oe["zone-area-"+mi],ct=oe["zone-graph-"+mi],Le&&ct&&ct.clip(we[mi]),Ne&&it&&it.clip(we[mi]),vt=Ki.value>vi.max,oe.resetZones&&0===Ut&&(Ut=void 0)}),this.clips=we}else oe.visible&&(Le&&Le.show(),Ne&&Ne.show())},De.prototype.invertGroups=function(oe){function ve(){["group","markerGroup"].forEach(function(we){xe[we]&&(Re.renderer.isVML&&xe[we].attr({width:xe.yAxis.len,height:xe.xAxis.len}),xe[we].width=xe.yAxis.len,xe[we].height=xe.xAxis.len,xe[we].invert(!xe.isRadialSeries&&oe))})}var xe=this,Re=xe.chart;xe.xAxis&&(xe.eventsToUnbind.push(ie(Re,"resize",ve)),ve(),xe.invertGroups=ve)},De.prototype.plotGroup=function(oe,ve,xe,Re,we){var Le=this[oe],Ne=!Le;return xe={visibility:xe,zIndex:Re||.1},typeof this.opacity>"u"||this.chart.styledMode||"inactive"===this.state||(xe.opacity=this.opacity),Ne&&(this[oe]=Le=this.chart.renderer.g().add(we)),Le.addClass("highcharts-"+ve+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(z(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(Le.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),Le.attr(xe)[Ne?"attr":"animate"](this.getPlotBox()),Le},De.prototype.getPlotBox=function(){var oe=this.chart,ve=this.xAxis,xe=this.yAxis;return oe.inverted&&(ve=xe,xe=this.xAxis),{translateX:ve?ve.left:oe.plotLeft,translateY:xe?xe.top:oe.plotTop,scaleX:1,scaleY:1}},De.prototype.removeEvents=function(oe){oe||de(this),this.eventsToUnbind.length&&(this.eventsToUnbind.forEach(function(ve){ve()}),this.eventsToUnbind.length=0)},De.prototype.render=function(){var oe=this,ve=oe.chart,xe=oe.options,Re=j(xe.animation),we=oe.visible?"inherit":"hidden",Le=xe.zIndex,Ne=oe.hasRendered,Ze=ve.seriesGroup,at=ve.inverted;ve=!oe.finishedAnimating&&ve.renderer.isSVG?Re.duration:0,O(this,"render");var wt=oe.plotGroup("group","series",we,Le,Ze);oe.markerGroup=oe.plotGroup("markerGroup","markers",we,Le,Ze),!1!==xe.clip&&oe.setClip(),oe.animate&&ve&&oe.animate(!0),wt.inverted=!!$(oe.invertible,oe.isCartesian)&&at,oe.drawGraph&&(oe.drawGraph(),oe.applyZones()),oe.visible&&oe.drawPoints(),oe.drawDataLabels&&oe.drawDataLabels(),oe.redrawPoints&&oe.redrawPoints(),oe.drawTracker&&!1!==oe.options.enableMouseTracking&&oe.drawTracker(),oe.invertGroups(at),oe.animate&&ve&&oe.animate(),Ne||(ve&&Re.defer&&(ve+=Re.defer),oe.animationTimeout=Ie(function(){oe.afterAnimate()},ve||0)),oe.isDirty=!1,oe.hasRendered=!0,O(oe,"afterRender")},De.prototype.redraw=function(){var oe=this.chart,ve=this.isDirty||this.isDirtyData,xe=this.group,Re=this.xAxis,we=this.yAxis;xe&&(oe.inverted&&xe.attr({width:oe.plotWidth,height:oe.plotHeight}),xe.animate({translateX:$(Re&&Re.left,oe.plotLeft),translateY:$(we&&we.top,oe.plotTop)})),this.translate(),this.render(),ve&&delete this.kdTree},De.prototype.searchPoint=function(oe,ve){var xe=this.xAxis,Re=this.yAxis,we=this.chart.inverted;return this.searchKDTree({clientX:we?xe.len-oe.chartY+xe.pos:oe.chartX-xe.pos,plotY:we?Re.len-oe.chartX+Re.pos:oe.chartY-Re.pos},ve,oe)},De.prototype.buildKDTree=function(oe){function ve(we,Le,Ne){var Ze=we&&we.length;if(Ze){var at=xe.kdAxisArray[Le%Ne];return we.sort(function(wt,Tt){return wt[at]-Tt[at]}),{point:we[Ze=Math.floor(Ze/2)],left:ve(we.slice(0,Ze),Le+1,Ne),right:ve(we.slice(Ze+1),Le+1,Ne)}}}this.buildingKdTree=!0;var xe=this,Re=-1<xe.options.findNearestPointBy.indexOf("y")?2:1;delete xe.kdTree,Ie(function(){xe.kdTree=ve(xe.getValidPoints(null,!xe.directTouch),Re,Re),xe.buildingKdTree=!1},xe.options.kdNow||oe&&"touchstart"===oe.type?0:1)},De.prototype.searchKDTree=function(oe,ve,xe){var we=this,Le=this.kdAxisArray[0],Ne=this.kdAxisArray[1],Ze=ve?"distX":"dist";if(ve=-1<we.options.findNearestPointBy.indexOf("y")?2:1,this.kdTree||this.buildingKdTree||this.buildKDTree(xe),this.kdTree)return function Re(at,wt,Tt,Ut){var bt=wt.point,lt=we.kdAxisArray[Tt%Ut],Pe=bt,je=z(at[Le])&&z(bt[Le])?Math.pow(at[Le]-bt[Le],2):null,it=z(at[Ne])&&z(bt[Ne])?Math.pow(at[Ne]-bt[Ne],2):null;return bt.dist=z(it=(je||0)+(it||0))?Math.sqrt(it):Number.MAX_VALUE,bt.distX=z(je)?Math.sqrt(je):Number.MAX_VALUE,je=0>(lt=at[lt]-bt[lt])?"right":"left",wt[it=0>lt?"left":"right"]&&(Pe=(it=Re(at,wt[it],Tt+1,Ut))[Ze]<Pe[Ze]?it:bt),wt[je]&&Math.sqrt(lt*lt)<Pe[Ze]&&(Pe=(at=Re(at,wt[je],Tt+1,Ut))[Ze]<Pe[Ze]?at:Pe),Pe}(oe,this.kdTree,ve,ve)},De.prototype.pointPlacementToXValue=function(){var oe=this.options,ve=oe.pointRange,xe=this.xAxis;return"between"===(oe=oe.pointPlacement)&&(oe=xe.reversed?-.5:.5),ae(oe)?oe*(ve||xe.pointRange):0},De.prototype.isPointInside=function(oe){var ve=this.chart,xe=this.xAxis,Re=this.yAxis;return typeof oe.plotY<"u"&&typeof oe.plotX<"u"&&0<=oe.plotY&&oe.plotY<=(Re?Re.len:ve.plotHeight)&&0<=oe.plotX&&oe.plotX<=(xe?xe.len:ve.plotWidth)},De.prototype.drawTracker=function(){var oe=this,ve=oe.options,xe=ve.trackByArea,Re=[].concat(xe?oe.areaPath:oe.graphPath),we=oe.chart,Le=we.pointer,Ne=we.renderer,Ze=we.options.tooltip.snap,at=oe.tracker,wt=function(Ut){we.hoverSeries!==oe&&oe.onMouseOver()},Tt="rgba(192,192,192,"+(P?1e-4:.002)+")";at?at.attr({d:Re}):oe.graph&&(oe.tracker=Ne.path(Re).attr({visibility:oe.visible?"inherit":"hidden",zIndex:2}).addClass(xe?"highcharts-tracker-area":"highcharts-tracker-line").add(oe.group),we.styledMode||oe.tracker.attr({"stroke-linecap":"round","stroke-linejoin":"round",stroke:Tt,fill:xe?Tt:"none","stroke-width":oe.graph.strokeWidth()+(xe?0:2*Ze)}),[oe.tracker,oe.markerGroup,oe.dataLabelsGroup].forEach(function(Ut){Ut&&(Ut.addClass("highcharts-tracker").on("mouseover",wt).on("mouseout",function(bt){Le.onTrackerMouseOut(bt)}),ve.cursor&&!we.styledMode&&Ut.css({cursor:ve.cursor}),B)&&Ut.on("touchstart",wt)})),O(this,"afterDrawTracker")},De.prototype.addPoint=function(oe,ve,xe,Re,we){var Le=this.options,Ne=this.data,Ze=this.chart,at=this.xAxis;at=at&&at.hasNames&&at.names;var Ut,wt=Le.data,Tt=this.xData;ve=$(ve,!0);var bt={series:this};this.pointClass.prototype.applyOptions.apply(bt,[oe]);var lt=bt.x,Pe=Tt.length;if(this.requireSorting&&lt<Tt[Pe-1])for(Ut=!0;Pe&&Tt[Pe-1]>lt;)Pe--;this.updateParallelArrays(bt,"splice",Pe,0,0),this.updateParallelArrays(bt,Pe),at&&bt.name&&(at[lt]=bt.name),wt.splice(Pe,0,oe),(Ut||this.processedData)&&(this.data.splice(Pe,0,null),this.processData()),"point"===Le.legendType&&this.generatePoints(),xe&&(Ne[0]&&Ne[0].remove?Ne[0].remove(!1):(Ne.shift(),this.updateParallelArrays(bt,"shift"),wt.shift())),!1!==we&&O(this,"addPoint",{point:bt}),this.isDirtyData=this.isDirty=!0,ve&&Ze.redraw(Re)},De.prototype.removePoint=function(oe,ve,xe){var Re=this,we=Re.data,Le=we[oe],Ne=Re.points,Ze=Re.chart,at=function(){Ne&&Ne.length===we.length&&Ne.splice(oe,1),we.splice(oe,1),Re.options.data.splice(oe,1),Re.updateParallelArrays(Le||{series:Re},"splice",oe,1),Le&&Le.destroy(),Re.isDirty=!0,Re.isDirtyData=!0,ve&&Ze.redraw()};N(xe,Ze),ve=$(ve,!0),Le?Le.firePointEvent("remove",null,at):at()},De.prototype.remove=function(oe,ve,xe,Re){function we(){Le.destroy(Re),Ne.isDirtyLegend=Ne.isDirtyBox=!0,Ne.linkSeries(),$(oe,!0)&&Ne.redraw(ve)}var Le=this,Ne=Le.chart;!1!==xe?O(Le,"remove",null,we):we()},De.prototype.update=function(oe,ve){oe=q(oe,this.userOptions),O(this,"update",{options:oe});var Tt,xe=this,Re=xe.chart,we=xe.userOptions,Le=xe.initialType||xe.type,Ne=Re.options.plotOptions,Ze=W[Le].prototype,at=xe.finishedAnimating&&{animation:!1},wt={},Ut=["eventOptions","navigatorSeries","baseSeries"],bt=oe.type||we.type||Re.options.chart.type,lt=!(this.hasDerivedData||bt&&bt!==this.type||typeof oe.pointStart<"u"||typeof oe.pointInterval<"u"||typeof oe.relativeXValue<"u"||oe.joinBy||oe.mapData||xe.hasOptionChanged("dataGrouping")||xe.hasOptionChanged("pointStart")||xe.hasOptionChanged("pointInterval")||xe.hasOptionChanged("pointIntervalUnit")||xe.hasOptionChanged("keys"));if(bt=bt||Le,lt&&(Ut.push("data","isDirtyData","points","processedData","processedXData","processedYData","xIncrement","cropped","_hasPointMarkers","_hasPointLabels","clips","nodes","layout","level","mapMap","mapData","minY","maxY","minX","maxX"),!1!==oe.visible&&Ut.push("area","graph"),xe.parallelArrays.forEach(function(je){Ut.push(je+"Data")}),oe.data&&(oe.dataSorting&&T(xe.options.dataSorting,oe.dataSorting),this.setData(oe.data,!1))),oe=ge(we,at,{index:typeof we.index>"u"?xe.index:we.index,pointStart:$(Ne&&Ne.series&&Ne.series.pointStart,we.pointStart,xe.xData[0])},!lt&&{data:xe.options.data},oe),lt&&oe.data&&(oe.data=xe.options.data),(Ut=["group","markerGroup","dataLabelsGroup","transformGroup"].concat(Ut)).forEach(function(je){Ut[je]=xe[je],delete xe[je]}),Ne=!1,W[bt]){if(Ne=bt!==xe.type,xe.remove(!1,!1,!1,!0),Ne)if(Object.setPrototypeOf)Object.setPrototypeOf(xe,W[bt].prototype);else{for(Tt in at=Object.hasOwnProperty.call(xe,"hcEvents")&&xe.hcEvents,Ze)xe[Tt]=void 0;T(xe,W[bt].prototype),at?xe.hcEvents=at:delete xe.hcEvents}}else U(17,!0,Re,{missingModuleFor:bt});if(Ut.forEach(function(je){xe[je]=Ut[je]}),xe.init(Re,oe),lt&&this.points){var Pe=xe.options;!1===Pe.visible?(wt.graphic=1,wt.dataLabel=1):xe._hasPointLabels||(Ze=Pe.dataLabels,!(oe=Pe.marker)||!1!==oe.enabled&&(we.marker&&we.marker.symbol)===oe.symbol||(wt.graphic=1),Ze&&!1===Ze.enabled&&(wt.dataLabel=1)),this.points.forEach(function(je){je&&je.series&&(je.resolveColor(),Object.keys(wt).length&&je.destroyElements(wt),!1===Pe.showInLegend&&je.legendItem&&Re.legend.destroyItem(je))},this)}xe.initialType=Le,Re.linkSeries(),Ne&&xe.linkedSeries.length&&(xe.isDirtyData=!0),O(this,"afterUpdate"),$(ve,!0)&&Re.redraw(!!lt&&void 0)},De.prototype.setName=function(oe){this.name=this.options.name=this.userOptions.name=oe,this.chart.isDirtyLegend=!0},De.prototype.hasOptionChanged=function(oe){var ve=this.options[oe],xe=this.chart.options.plotOptions,Re=this.userOptions[oe];return Re?ve!==Re:ve!==$(xe&&xe[this.type]&&xe[this.type][oe],xe&&xe.series&&xe.series[oe],ve)},De.prototype.onMouseOver=function(){var oe=this.chart,ve=oe.hoverSeries;oe.pointer.setHoverChartIndex(),ve&&ve!==this&&ve.onMouseOut(),this.options.events.mouseOver&&O(this,"mouseOver"),this.setState("hover"),oe.hoverSeries=this},De.prototype.onMouseOut=function(){var oe=this.options,ve=this.chart,xe=ve.tooltip,Re=ve.hoverPoint;ve.hoverSeries=null,Re&&Re.onMouseOut(),this&&oe.events.mouseOut&&O(this,"mouseOut"),!xe||this.stickyTracking||xe.shared&&!this.noSharedTooltip||xe.hide(),ve.series.forEach(function(we){we.setState("",!0)})},De.prototype.setState=function(oe,ve){var xe=this,Re=xe.options,we=xe.graph,Le=Re.inactiveOtherPoints,Ne=Re.states,Ze=$(Ne[oe||"normal"]&&Ne[oe||"normal"].animation,xe.chart.options.chart.animation),at=Re.lineWidth,wt=0,Tt=Re.opacity;if(xe.state!==(oe=oe||"")&&([xe.group,xe.markerGroup,xe.dataLabelsGroup].forEach(function(Ut){Ut&&(xe.state&&Ut.removeClass("highcharts-series-"+xe.state),oe&&Ut.addClass("highcharts-series-"+oe))}),xe.state=oe,!xe.chart.styledMode)){if(Ne[oe]&&!1===Ne[oe].enabled)return;if(oe&&(at=Ne[oe].lineWidth||at+(Ne[oe].lineWidthPlus||0),Tt=$(Ne[oe].opacity,Tt)),we&&!we.dashstyle)for(we.animate(Re={"stroke-width":at},Ze);xe["zone-graph-"+wt];)xe["zone-graph-"+wt].animate(Re,Ze),wt+=1;Le||[xe.group,xe.markerGroup,xe.dataLabelsGroup,xe.labelBySeries].forEach(function(Ut){Ut&&Ut.animate({opacity:Tt},Ze)})}ve&&Le&&xe.points&&xe.setAllPointsToState(oe||void 0)},De.prototype.setAllPointsToState=function(oe){this.points.forEach(function(ve){ve.setState&&ve.setState(oe)})},De.prototype.setVisible=function(oe,ve){var xe=this,Re=xe.chart,we=xe.legendItem,Le=Re.options.chart.ignoreHiddenSeries,Ze=(xe.visible=oe=xe.options.visible=xe.userOptions.visible=typeof oe>"u"?!xe.visible:oe)?"show":"hide";["group","dataLabelsGroup","markerGroup","tracker","tt"].forEach(function(at){xe[at]&&xe[at][Ze]()}),(Re.hoverSeries===xe||(Re.hoverPoint&&Re.hoverPoint.series)===xe)&&xe.onMouseOut(),we&&Re.legend.colorizeItem(xe,oe),xe.isDirty=!0,xe.options.stacking&&Re.series.forEach(function(at){at.options.stacking&&at.visible&&(at.isDirty=!0)}),xe.linkedSeries.forEach(function(at){at.setVisible(oe,!1)}),Le&&(Re.isDirtyBox=!0),O(xe,Ze),!1!==ve&&Re.redraw()},De.prototype.show=function(){this.setVisible(!0)},De.prototype.hide=function(){this.setVisible(!1)},De.prototype.select=function(oe){this.selected=oe=this.options.selected=typeof oe>"u"?!this.selected:oe,this.checkbox&&(this.checkbox.checked=oe),O(this,oe?"select":"unselect")},De.prototype.shouldShowTooltip=function(oe,ve,xe){return void 0===xe&&(xe={}),xe.series=this,xe.visiblePlotOnly=!0,this.chart.isInsidePlot(oe,ve,xe)},De.defaultOptions=ce,De.types=ne.seriesTypes,De.registerType=ne.registerSeriesType,De}(),T(re.prototype,{axisTypes:["xAxis","yAxis"],coll:"series",colorCounter:0,cropShoulder:1,directTouch:!1,drawLegendSymbol:Se.drawLineMarker,isCartesian:!0,kdAxisArray:["clientX","plotY"],parallelArrays:["x","y"],pointClass:be,requireSorting:!0,sorted:!0}),ne.series=re,re}),Ge(u,"Extensions/ScrollablePlotArea.js",[u["Core/Animation/AnimationUtilities.js"],u["Core/Axis/Axis.js"],u["Core/Chart/Chart.js"],u["Core/Series/Series.js"],u["Core/Renderer/RendererRegistry.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce,Se,be){var ce=re.stop,ne=be.addEvent,K=be.createElement,Y=be.defined,j=be.merge,N=be.pick;ne(Te,"afterSetChartSize",function(R){var I=this.options.chart.scrollablePlotArea,B=I&&I.minWidth;if(I=I&&I.minHeight,!this.renderer.forExport){if(B){if(this.scrollablePixelsX=B=Math.max(0,B-this.chartWidth)){this.scrollablePlotBox=this.renderer.scrollablePlotBox=j(this.plotBox),this.plotBox.width=this.plotWidth+=B,this.inverted?this.clipBox.height+=B:this.clipBox.width+=B;var P={1:{name:"right",value:B}}}}else I&&(this.scrollablePixelsY=B=Math.max(0,I-this.chartHeight),Y(B)&&(this.scrollablePlotBox=this.renderer.scrollablePlotBox=j(this.plotBox),this.plotBox.height=this.plotHeight+=B,this.inverted?this.clipBox.width+=B:this.clipBox.height+=B,P={2:{name:"bottom",value:B}}));P&&!R.skipAxes&&this.axes.forEach(function(H){P[H.side]?H.getPlotLinePath=function(){var W=P[H.side].name,ie=this[W];this[W]=ie-P[H.side].value;var te=me.prototype.getPlotLinePath.apply(this,arguments);return this[W]=ie,te}:(H.setAxisSize(),H.setAxisTranslation())})}}),ne(Te,"render",function(){this.scrollablePixelsX||this.scrollablePixelsY?(this.setUpScrolling&&this.setUpScrolling(),this.applyFixed()):this.fixedDiv&&this.applyFixed()}),Te.prototype.setUpScrolling=function(){var R=this,I={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};this.scrollablePixelsX&&(I.overflowX="auto"),this.scrollablePixelsY&&(I.overflowY="auto"),this.scrollingParent=K("div",{className:"highcharts-scrolling-parent"},{position:"relative"},this.renderTo),this.scrollingContainer=K("div",{className:"highcharts-scrolling"},I,this.scrollingParent),ne(this.scrollingContainer,"scroll",function(){R.pointer&&delete R.pointer.chartPosition}),this.innerContainer=K("div",{className:"highcharts-inner-container"},null,this.scrollingContainer),this.innerContainer.appendChild(this.container),this.setUpScrolling=null},Te.prototype.moveFixedElements=function(){var P,R=this.container,I=this.fixedRenderer,B=".highcharts-contextbutton .highcharts-credits .highcharts-legend .highcharts-legend-checkbox .highcharts-navigator-series .highcharts-navigator-xaxis .highcharts-navigator-yaxis .highcharts-navigator .highcharts-reset-zoom .highcharts-drillup-button .highcharts-scrollbar .highcharts-subtitle .highcharts-title".split(" ");this.scrollablePixelsX&&!this.inverted?P=".highcharts-yaxis":this.scrollablePixelsX&&this.inverted||this.scrollablePixelsY&&!this.inverted?P=".highcharts-xaxis":this.scrollablePixelsY&&this.inverted&&(P=".highcharts-yaxis"),P&&B.push(P+":not(.highcharts-radial-axis)",P+"-labels:not(.highcharts-radial-axis-labels)"),B.forEach(function(H){[].forEach.call(R.querySelectorAll(H),function(W){(W.namespaceURI===I.SVG_NS?I.box:I.box.parentNode).appendChild(W),W.style.pointerEvents="auto"})})},Te.prototype.applyFixed=function(){var R=!this.fixedDiv,I=this.options.chart,B=I.scrollablePlotArea,P=Se.getRendererType();R?(this.fixedDiv=K("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:(I.style&&I.style.zIndex||0)+2,top:0},null,!0),this.scrollingContainer&&this.scrollingContainer.parentNode.insertBefore(this.fixedDiv,this.scrollingContainer),this.renderTo.style.overflow="visible",this.fixedRenderer=I=new P(this.fixedDiv,this.chartWidth,this.chartHeight,this.options.chart.style),this.scrollableMask=I.path().attr({fill:this.options.chart.backgroundColor||"#fff","fill-opacity":N(B.opacity,.85),zIndex:-1}).addClass("highcharts-scrollable-mask").add(),ne(this,"afterShowResetZoom",this.moveFixedElements),ne(this,"afterApplyDrilldown",this.moveFixedElements),ne(this,"afterLayOutTitles",this.moveFixedElements)):this.fixedRenderer.setSize(this.chartWidth,this.chartHeight),(this.scrollableDirty||R)&&(this.scrollableDirty=!1,this.moveFixedElements()),I=this.chartWidth+(this.scrollablePixelsX||0),P=this.chartHeight+(this.scrollablePixelsY||0),ce(this.container),this.container.style.width=I+"px",this.container.style.height=P+"px",this.renderer.boxWrapper.attr({width:I,height:P,viewBox:[0,0,I,P].join(" ")}),this.chartBackground.attr({width:I,height:P}),this.scrollingContainer.style.height=this.chartHeight+"px",R&&(B.scrollPositionX&&(this.scrollingContainer.scrollLeft=this.scrollablePixelsX*B.scrollPositionX),B.scrollPositionY&&(this.scrollingContainer.scrollTop=this.scrollablePixelsY*B.scrollPositionY)),R=this.plotTop-(P=this.axisOffset)[0]-1,B=this.plotLeft-P[3]-1,I=this.plotTop+this.plotHeight+P[2]+1,P=this.plotLeft+this.plotWidth+P[1]+1;var H=this.plotLeft+this.plotWidth-(this.scrollablePixelsX||0),W=this.plotTop+this.plotHeight-(this.scrollablePixelsY||0);R=this.scrollablePixelsX?[["M",0,R],["L",this.plotLeft-1,R],["L",this.plotLeft-1,I],["L",0,I],["Z"],["M",H,R],["L",this.chartWidth,R],["L",this.chartWidth,I],["L",H,I],["Z"]]:this.scrollablePixelsY?[["M",B,0],["L",B,this.plotTop-1],["L",P,this.plotTop-1],["L",P,0],["Z"],["M",B,W],["L",B,this.chartHeight],["L",P,this.chartHeight],["L",P,W],["Z"]]:[["M",0,0]],"adjustHeight"!==this.redrawTrigger&&this.scrollableMask.attr({d:R})},ne(me,"afterInit",function(){this.chart.scrollableDirty=!0}),ne(Ce,"show",function(){this.chart.scrollableDirty=!0})}),Ge(u,"Core/Axis/Stacking/StackItem.js",[u["Core/FormatUtilities.js"],u["Core/Series/SeriesRegistry.js"],u["Core/Utilities.js"]],function(re,me,Te){var Ce=re.format,Se=me.series,be=Te.defined,ce=Te.destroyObjectProperties,ne=Te.isNumber,K=Te.pick;return function(){function Y(j,N,R,I,B){var P=j.chart.inverted;this.axis=j,this.isNegative=R,this.options=N=N||{},this.x=I,this.cumulative=this.total=null,this.points={},this.hasValidPoints=!1,this.stack=B,this.rightCliff=this.leftCliff=0,this.alignOptions={align:N.align||(P?R?"left":"right":"center"),verticalAlign:N.verticalAlign||(P?"middle":R?"bottom":"top"),y:N.y,x:N.x},this.textAlign=N.textAlign||(P?R?"right":"left":"center")}return Y.prototype.destroy=function(){ce(this,this.axis)},Y.prototype.render=function(j){var N=this.axis.chart,R=this.options,I=R.format;I=I?Ce(I,this,N):R.formatter.call(this),this.label?this.label.attr({text:I,visibility:"hidden"}):(this.label=N.renderer.label(I,null,null,R.shape,null,null,R.useHTML,!1,"stack-labels"),I={r:R.borderRadius||0,text:I,rotation:R.rotation,padding:K(R.padding,5),visibility:"hidden"},N.styledMode||(I.fill=R.backgroundColor,I.stroke=R.borderColor,I["stroke-width"]=R.borderWidth,this.label.css(R.style)),this.label.attr(I),this.label.added||this.label.add(j)),this.label.labelrank=N.plotSizeY},Y.prototype.setOffset=function(j,N,R,I,B){var P=this.axis,H=P.chart;I=P.translate(P.stacking.usePercentage?100:I||this.total,0,0,0,1),R=P.translate(R||0),j=K(B,H.xAxis[0].translate(this.x))+j,P=be(I)&&this.getStackBox(H,this,j,I,N,Math.abs(I-R),P),R=this.isNegative;var W=this.textAlign;(N=this.label)&&P&&(j=N.getBBox(),B=N.padding,I="justify"===K(this.options.overflow,"justify"),W="left"===W?H.inverted?-B:B:"right"===W?j.width:H.inverted&&"center"===W?j.width/2:H.inverted?R?j.width+B:-B:j.width/2,R=H.inverted?j.height/2:R?-B:j.height,this.alignOptions.x=K(this.options.x,0),this.alignOptions.y=K(this.options.y,0),P.x-=W,P.y-=R,N.align(this.alignOptions,null,P),H.isInsidePlot(N.alignAttr.x+W-this.alignOptions.x,N.alignAttr.y+R-this.alignOptions.y)?N.show():(N.hide(),I=!1),I&&Se.prototype.justifyDataLabel.call(this.axis,N,this.alignOptions,N.alignAttr,j,P),N.attr({x:N.alignAttr.x,y:N.alignAttr.y}),K(!I&&this.options.crop,!0)&&((H=ne(N.x)&&ne(N.y)&&H.isInsidePlot(N.x-B+N.width,N.y)&&H.isInsidePlot(N.x+B,N.y))||N.hide()))},Y.prototype.getStackBox=function(j,N,R,I,B,P,H){var W=N.axis.reversed,ie=j.inverted,te=H.height+H.pos-(ie?j.plotLeft:j.plotTop);return N=N.isNegative&&!W||!N.isNegative&&W,{x:ie?N?I-H.right:I-P+H.pos-j.plotLeft:R+j.xAxis[0].transB-j.plotLeft,y:ie?H.height-R-B:N?te-I-P:te-I,width:ie?P:B,height:ie?B:P}},Y}()}),Ge(u,"Core/Axis/Stacking/StackingAxis.js",[u["Core/Animation/AnimationUtilities.js"],u["Core/Axis/Axis.js"],u["Core/Series/SeriesRegistry.js"],u["Core/Axis/Stacking/StackItem.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce,Se){function be(){var U=this,T=U.inverted;U.yAxis.forEach(function(S){S.stacking&&S.stacking.stacks&&S.hasVisibleSeries&&(S.stacking.oldStacks=S.stacking.stacks)}),U.series.forEach(function(S){var O=S.xAxis&&S.xAxis.options||{};!S.options.stacking||!0!==S.visible&&!1!==U.options.chart.ignoreHiddenSeries||(S.stackKey=[S.type,D(S.options.stack,""),T?O.top:O.left,T?O.height:O.width].join())})}function ce(){var U=this.stacking;if(U){var T=U.stacks;q(T,function(S,O){ie(S),T[O]=null}),U&&U.stackTotalGroup&&U.stackTotalGroup.destroy()}}function ne(){this.stacking||(this.stacking=new z(this))}function K(U,T,S,O){return!W(U)||U.x!==T||O&&U.stackKey!==O?U={x:T,index:0,key:O,stackKey:O}:U.index++,U.key=[S,T,U.index].join(),U}function Y(){var Z,U=this,T=U.stackKey,S=U.yAxis.stacking.stacks,O=U.processedXData,M=U[U.options.stacking+"Stacker"];M&&[T,"-"+T].forEach(function(ae){for(var ge,V,ue=O.length;ue--;)Z=U.getStackIndicator(Z,ge=O[ue],U.index,ae),(V=(ge=S[ae]&&S[ae][ge])&&ge.points[Z.key])&&M.call(U,V,ge,ue)})}function j(U,T,S){U[0]=H(U[0]*(T=T.total?100/T.total:0)),U[1]=H(U[1]*T),this.stackedYData[S]=U[1]}function N(){var U=this.yAxis.stacking;this.options.centerInCategory&&(this.is("column")||this.is("columnrange"))&&!this.options.stacking&&1<this.chart.series.length?B.setStackedPoints.call(this,"group"):U&&q(U.stacks,function(T,S){"group"===S.slice(-5)&&(q(T,function(O){return O.destroy()}),delete U.stacks[S])})}function R(U){var T=U||this.options.stacking;if(T&&(!0===this.visible||!1===this.chart.options.chart.ignoreHiddenSeries)){var S=this.processedXData,O=this.processedYData,M=[],Z=O.length,ae=this.options,ue=ae.threshold,ge=D(ae.startFromThreshold&&ue,0);ae=ae.stack;var De,oe,V="-"+(U=U?""+this.type+",".concat(T):this.stackKey),$=this.negStacks,de=this.yAxis,Me=de.stacking.stacks,Ie=de.stacking.oldStacks;for(de.stacking.stacksTouched+=1,oe=0;oe<Z;oe++){var ve=S[oe],xe=O[oe],Re=this.getStackIndicator(Re,ve,this.index),we=Re.key,Le=(De=$&&xe<(ge?0:ue))?V:U;Me[Le]||(Me[Le]={}),Me[Le][ve]||(Ie[Le]&&Ie[Le][ve]?(Me[Le][ve]=Ie[Le][ve],Me[Le][ve].total=null):Me[Le][ve]=new Ce(de,de.options.stackLabels,!!De,ve,ae)),Le=Me[Le][ve],null!==xe?(Le.points[we]=Le.points[this.index]=[D(Le.cumulative,ge)],W(Le.cumulative)||(Le.base=we),Le.touched=de.stacking.stacksTouched,0<Re.index&&!1===this.singleStacks&&(Le.points[we][0]=Le.points[this.index+","+ve+",0"][0])):Le.points[we]=Le.points[this.index]=null,"percent"===T?(De=De?U:V,Le.total=$&&Me[De]&&Me[De][ve]?(De=Me[De][ve]).total=Math.max(De.total,Le.total)+Math.abs(xe)||0:H(Le.total+(Math.abs(xe)||0))):"group"===T?(ee(xe)&&(xe=xe[0]),null!==xe&&(Le.total=(Le.total||0)+1)):Le.total=H(Le.total+(xe||0)),Le.cumulative="group"===T?(Le.total||1)-1:D(Le.cumulative,ge)+(xe||0),null!==xe&&(Le.points[we].push(Le.cumulative),M[oe]=Le.cumulative,Le.hasValidPoints=!0)}"percent"===T&&(de.stacking.usePercentage=!0),"group"!==T&&(this.stackedYData=M),de.stacking.oldStacks={}}}var A,U,T,I=re.getDeferredAnimation,B=Te.series.prototype,P=Se.addEvent,H=Se.correctFloat,W=Se.defined,ie=Se.destroyObjectProperties,te=Se.fireEvent,ee=Se.isArray,J=Se.isNumber,q=Se.objectEach,D=Se.pick,z=function(){function U(T){this.oldStacks={},this.stacks={},this.stacksTouched=0,this.axis=T}return U.prototype.buildStacks=function(){var Z,T=this.axis,S=T.series,O=T.options.reversedStacks,M=S.length;if(!T.isXAxis){for(this.usePercentage=!1,Z=M;Z--;){var ae=S[O?Z:M-Z-1];ae.setStackedPoints(),ae.setGroupedPoints()}for(Z=0;Z<M;Z++)S[Z].modifyStacks();te(T,"afterBuildStacks")}},U.prototype.cleanStacks=function(){if(!this.axis.isXAxis){if(this.oldStacks)var T=this.stacks=this.oldStacks;q(T,function(S){q(S,function(O){O.cumulative=O.total})})}},U.prototype.resetStacks=function(){var T=this;T.axis.isXAxis||q(T.stacks,function(O){q(O,function(M,Z){J(M.touched)&&M.touched<T.stacksTouched?(M.destroy(),delete O[Z]):(M.total=null,M.cumulative=null)})})},U.prototype.renderStackTotals=function(){var T=this.axis,S=T.chart,O=S.renderer,M=this.stacks;T=I(S,T.options.stackLabels&&T.options.stackLabels.animation||!1);var Z=this.stackTotalGroup=this.stackTotalGroup||O.g("stack-labels").attr({zIndex:6,opacity:0}).add();Z.translate(S.plotLeft,S.plotTop),q(M,function(ae){q(ae,function(ue){ue.render(Z)})}),Z.animate({opacity:1},T)},U}();return U=A||(A={}),T=[],U.compose=function(S,O,M){-1===T.indexOf(S)&&(T.push(S),P(S,"init",ne),P(S,"destroy",ce)),-1===T.indexOf(O)&&(T.push(O),O.prototype.getStacks=be),-1===T.indexOf(M)&&(T.push(M),(S=M.prototype).getStackIndicator=K,S.modifyStacks=Y,S.percentStacker=j,S.setGroupedPoints=N,S.setStackedPoints=R)},A}),Ge(u,"Series/Line/LineSeries.js",[u["Core/Series/Series.js"],u["Core/Series/SeriesRegistry.js"],u["Core/Utilities.js"]],function(re,me,Te){var ce,Ce=this&&this.__extends||(ce=function(ne,K){return(ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Y,j){Y.__proto__=j}||function(Y,j){for(var N in j)j.hasOwnProperty(N)&&(Y[N]=j[N])})(ne,K)},function(ne,K){function Y(){this.constructor=ne}ce(ne,K),ne.prototype=null===K?Object.create(K):(Y.prototype=K.prototype,new Y)}),Se=Te.defined,be=Te.merge;return Te=function(ce){function ne(){var K=null!==ce&&ce.apply(this,arguments)||this;return K.data=void 0,K.options=void 0,K.points=void 0,K}return Ce(ne,ce),ne.prototype.drawGraph=function(){var K=this,Y=this.options,j=(this.gappedPath||this.getGraphPath).call(this),N=this.chart.styledMode,R=[["graph","highcharts-graph"]];N||R[0].push(Y.lineColor||this.color||"#cccccc",Y.dashStyle),(R=K.getZonesGraphs(R)).forEach(function(I,B){var P=I[0],H=K[P],W=H?"animate":"attr";H?(H.endX=K.preventGraphAnimation?null:j.xMap,H.animate({d:j})):j.length&&(K[P]=H=K.chart.renderer.path(j).addClass(I[1]).attr({zIndex:1}).add(K.group)),H&&!N&&(P={stroke:I[2],"stroke-width":Y.lineWidth,fill:K.fillGraph&&K.color||"none"},I[3]?P.dashstyle=I[3]:"square"!==Y.linecap&&(P["stroke-linecap"]=P["stroke-linejoin"]="round"),H[W](P).shadow(2>B&&Y.shadow)),H&&(H.startX=j.xMap,H.isArea=j.isArea)})},ne.prototype.getGraphPath=function(K,Y,j){var P,N=this,R=N.options,I=[],B=[],H=R.step,W=(K=K||N.points).reversed;return W&&K.reverse(),(H={right:1,center:2}[H]||H&&3)&&W&&(H=4-H),(K=this.getValidPoints(K,!1,!(R.connectNulls&&!Y&&!j))).forEach(function(ie,te){var ee=ie.plotX,J=ie.plotY,q=K[te-1];(ie.leftCliff||q&&q.rightCliff)&&!j&&(P=!0),ie.isNull&&!Se(Y)&&0<te?P=!R.connectNulls:ie.isNull&&!Y?P=!0:(0===te||P?te=[["M",ie.plotX,ie.plotY]]:N.getPointSpline?te=[N.getPointSpline(K,ie,te)]:H?(te=1===H?[["L",q.plotX,J]]:2===H?[["L",(q.plotX+ee)/2,q.plotY],["L",(q.plotX+ee)/2,J]]:[["L",ee,q.plotY]]).push(["L",ee,J]):te=[["L",ee,J]],B.push(ie.x),H&&(B.push(ie.x),2===H&&B.push(ie.x)),I.push.apply(I,te),P=!1)}),I.xMap=B,N.graphPath=I},ne.prototype.getZonesGraphs=function(K){return this.zones.forEach(function(Y,j){j=["zone-graph-"+j,"highcharts-graph highcharts-zone-graph-"+j+" "+(Y.className||"")],this.chart.styledMode||j.push(Y.color||this.color,Y.dashStyle||this.options.dashStyle),K.push(j)},this),K},ne.defaultOptions=be(re.defaultOptions,{}),ne}(re),me.registerSeriesType("line",Te),Te}),Ge(u,"Series/Area/AreaSeries.js",[u["Core/Color/Color.js"],u["Core/Legend/LegendSymbol.js"],u["Core/Series/SeriesRegistry.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce){var j,Se=this&&this.__extends||(j=function(N,R){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,B){I.__proto__=B}||function(I,B){for(var P in B)B.hasOwnProperty(P)&&(I[P]=B[P])})(N,R)},function(N,R){function I(){this.constructor=N}j(N,R),N.prototype=null===R?Object.create(R):(I.prototype=R.prototype,new I)}),be=re.parse,ce=Te.seriesTypes.line;re=Ce.extend;var ne=Ce.merge,K=Ce.objectEach,Y=Ce.pick;return Ce=function(j){function N(){var R=null!==j&&j.apply(this,arguments)||this;return R.data=void 0,R.options=void 0,R.points=void 0,R}return Se(N,j),N.prototype.drawGraph=function(){this.areaPath=[],j.prototype.drawGraph.apply(this);var R=this,I=this.areaPath,B=this.options,P=[["area","highcharts-area",this.color,B.fillColor]];this.zones.forEach(function(H,W){P.push(["zone-area-"+W,"highcharts-area highcharts-zone-area-"+W+" "+H.className,H.color||R.color,H.fillColor||B.fillColor])}),P.forEach(function(H){var W=H[0],ie={},te=R[W],ee=te?"animate":"attr";te?(te.endX=R.preventGraphAnimation?null:I.xMap,te.animate({d:I})):(ie.zIndex=0,(te=R[W]=R.chart.renderer.path(I).addClass(H[1]).add(R.group)).isArea=!0),R.chart.styledMode||(ie.fill=Y(H[3],be(H[2]).setOpacity(Y(B.fillOpacity,.75)).get())),te[ee](ie),te.startX=I.xMap,te.shiftUnit=B.step?2:1})},N.prototype.getGraphPath=function(R){var I=ce.prototype.getGraphPath,B=this.options,P=B.stacking,H=this.yAxis,W=[],ie=[],te=this.index,ee=H.stacking.stacks[this.stackKey],J=B.threshold,q=Math.round(H.getThreshold(B.threshold));B=Y(B.connectNulls,"percent"===P);var D=function(O,M,Z){var ae=R[O];O=P&&ee[ae.x].points[te];var ue=ae[Z+"Null"]||0;if(Z=ae[Z+"Cliff"]||0,ae=!0,Z||ue){var ge=(ue?O[0]:O[1])+Z,V=O[0]+Z;ae=!!ue}else!P&&R[M]&&R[M].isNull&&(ge=V=J);typeof ge<"u"&&(ie.push({plotX:T,plotY:null===ge?q:H.getThreshold(ge),isNull:ae,isCliff:!0}),W.push({plotX:T,plotY:null===V?q:H.getThreshold(V),doCurve:!1}))};R=R||this.points,P&&(R=this.getStackPoints(R));for(var z=0,A=R.length;z<A;++z){P||(R[z].leftCliff=R[z].rightCliff=R[z].leftNull=R[z].rightNull=void 0);var U=R[z].isNull,T=Y(R[z].rectPlotX,R[z].plotX),S=P?Y(R[z].yBottom,q):q;(!U||B)&&(B||D(z,z-1,"left"),U&&!P&&B||(ie.push(R[z]),W.push({x:z,plotX:T,plotY:S})),B||D(z,z+1,"right"))}return D=I.call(this,ie,!0,!0),W.reversed=!0,(S=(U=I.call(this,W,!0,!0))[0])&&"M"===S[0]&&(U[0]=["L",S[1],S[2]]),(U=D.concat(U)).length&&U.push(["Z"]),I=I.call(this,ie,!1,B),U.xMap=D.xMap,this.areaPath=U,I},N.prototype.getStackPoints=function(R){var I=this,B=[],P=[],H=this.xAxis,W=this.yAxis,ie=W.stacking.stacks[this.stackKey],te={},ee=W.series,J=ee.length,q=W.options.reversedStacks?1:-1,D=ee.indexOf(I);if(R=R||this.points,this.options.stacking){for(var z=0;z<R.length;z++)R[z].leftNull=R[z].rightNull=void 0,te[R[z].x]=R[z];K(ie,function(U,T){null!==U.total&&P.push(T)}),P.sort(function(U,T){return U-T});var A=ee.map(function(U){return U.visible});P.forEach(function(U,T){var O,M,S=0;if(te[U]&&!te[U].isNull)B.push(te[U]),[-1,1].forEach(function(ae){var ue=1===ae?"rightNull":"leftNull",ge=ie[P[T+ae]],V=0;if(ge)for(var $=D;0<=$&&$<J;){var de=ee[$].index;(O=ge.points[de])||(de===I.index?te[U][ue]=!0:A[$]&&(M=ie[U].points[de])&&(V-=M[1]-M[0])),$+=q}te[U][1===ae?"rightCliff":"leftCliff"]=V});else{for(var Z=D;0<=Z&&Z<J;){if(O=ie[U].points[ee[Z].index]){S=O[1];break}Z+=q}S=Y(S,0),S=W.translate(S,0,1,0,1),B.push({isNull:!0,plotX:H.translate(U,0,0,0,1),x:U,plotY:S,yBottom:S})}})}return B},N.defaultOptions=ne(ce.defaultOptions,{threshold:0}),N}(ce),re(Ce.prototype,{singleStacks:!1,drawLegendSymbol:me.drawRectangle}),Te.registerSeriesType("area",Ce),Ce}),Ge(u,"Series/Spline/SplineSeries.js",[u["Core/Series/SeriesRegistry.js"],u["Core/Utilities.js"]],function(re,me){var ce,Te=this&&this.__extends||(ce=function(ne,K){return(ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Y,j){Y.__proto__=j}||function(Y,j){for(var N in j)j.hasOwnProperty(N)&&(Y[N]=j[N])})(ne,K)},function(ne,K){function Y(){this.constructor=ne}ce(ne,K),ne.prototype=null===K?Object.create(K):(Y.prototype=K.prototype,new Y)}),Ce=re.seriesTypes.line,Se=me.merge,be=me.pick;return me=function(ce){function ne(){var K=null!==ce&&ce.apply(this,arguments)||this;return K.data=void 0,K.options=void 0,K.points=void 0,K}return Te(ne,ce),ne.prototype.getPointSpline=function(K,Y,j){var N=Y.plotX||0,R=Y.plotY||0,I=K[j-1];if(j=K[j+1],I&&!I.isNull&&!1!==I.doCurve&&!Y.isCliff&&j&&!j.isNull&&!1!==j.doCurve&&!Y.isCliff){var B=j.plotX||0,P=0,H=(1.5*N+(I.plotX||0))/2.5,W=(1.5*R+(K=I.plotY||0))/2.5,ie=(1.5*R+(j=j.plotY||0))/2.5;(B=(1.5*N+B)/2.5)!==H&&(P=(ie-W)*(B-N)/(B-H)+R-ie),ie+=P,(W+=P)>K&&W>R?ie=2*R-(W=Math.max(K,R)):W<K&&W<R&&(ie=2*R-(W=Math.min(K,R))),ie>j&&ie>R?W=2*R-(ie=Math.max(j,R)):ie<j&&ie<R&&(W=2*R-(ie=Math.min(j,R))),Y.rightContX=B,Y.rightContY=ie}return Y=["C",be(I.rightContX,I.plotX,0),be(I.rightContY,I.plotY,0),be(H,N,0),be(W,R,0),N,R],I.rightContX=I.rightContY=void 0,Y},ne.defaultOptions=Se(Ce.defaultOptions),ne}(Ce),re.registerSeriesType("spline",me),me}),Ge(u,"Series/AreaSpline/AreaSplineSeries.js",[u["Series/Spline/SplineSeries.js"],u["Core/Legend/LegendSymbol.js"],u["Core/Series/SeriesRegistry.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce){var Y,Se=this&&this.__extends||(Y=function(j,N){return(Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,I){R.__proto__=I}||function(R,I){for(var B in I)I.hasOwnProperty(B)&&(R[B]=I[B])})(j,N)},function(j,N){function R(){this.constructor=j}Y(j,N),j.prototype=null===N?Object.create(N):(R.prototype=N.prototype,new R)}),be=Te.seriesTypes,ce=be.area;be=be.area.prototype;var ne=Ce.extend,K=Ce.merge;return Ce=function(Y){function j(){var N=null!==Y&&Y.apply(this,arguments)||this;return N.data=void 0,N.points=void 0,N.options=void 0,N}return Se(j,Y),j.defaultOptions=K(re.defaultOptions,ce.defaultOptions),j}(re),ne(Ce.prototype,{getGraphPath:be.getGraphPath,getStackPoints:be.getStackPoints,drawGraph:be.drawGraph,drawLegendSymbol:me.drawRectangle}),Te.registerSeriesType("areaspline",Ce),Ce}),Ge(u,"Series/Column/ColumnSeries.js",[u["Core/Animation/AnimationUtilities.js"],u["Core/Color/Color.js"],u["Core/Globals.js"],u["Core/Legend/LegendSymbol.js"],u["Core/Series/Series.js"],u["Core/Series/SeriesRegistry.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce,Se,be,ce){var J,ne=this&&this.__extends||(J=function(q,D){return(J=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(z,A){z.__proto__=A}||function(z,A){for(var U in A)A.hasOwnProperty(U)&&(z[U]=A[U])})(q,D)},function(q,D){function z(){this.constructor=q}J(q,D),q.prototype=null===D?Object.create(D):(z.prototype=D.prototype,new z)}),K=re.animObject,Y=me.parse,j=Te.hasTouch;re=Te.noop;var N=ce.clamp,R=ce.css,I=ce.defined,B=ce.extend,P=ce.fireEvent,H=ce.isArray,W=ce.isNumber,ie=ce.merge,te=ce.pick,ee=ce.objectEach;return ce=function(J){function q(){var D=null!==J&&J.apply(this,arguments)||this;return D.borderWidth=void 0,D.data=void 0,D.group=void 0,D.options=void 0,D.points=void 0,D}return ne(q,J),q.prototype.animate=function(D){var z=this,A=this.yAxis,U=z.options,T=this.chart.inverted,S={},O=T?"translateX":"translateY";if(D)S.scaleY=.001,D=N(A.toPixels(U.threshold),A.pos,A.pos+A.len),T?S.translateX=D-A.len:S.translateY=D,z.clipBox&&z.setClip(),z.group.attr(S);else{var M=Number(z.group.attr(O));z.group.animate({scaleY:1},B(K(z.options.animation),{step:function(Z,ae){z.group&&(S[O]=M+ae.pos*(A.pos-M),z.group.attr(S))}}))}},q.prototype.init=function(D,z){J.prototype.init.apply(this,arguments);var A=this;(D=A.chart).hasRendered&&D.series.forEach(function(U){U.type===A.type&&(U.isDirty=!0)})},q.prototype.getColumnMetrics=function(){var D=this,z=D.options,A=D.xAxis,U=D.yAxis,T=A.options.reversedStacks;T=A.reversed&&!T||!A.reversed&&T;var O,S={},M=0;!1===z.grouping?M=1:D.chart.series.forEach(function(ge){var V=ge.yAxis,$=ge.options;if(ge.type===D.type&&(ge.visible||!D.chart.options.chart.ignoreHiddenSeries)&&U.len===V.len&&U.pos===V.pos){if($.stacking&&"group"!==$.stacking){typeof S[O=ge.stackKey]>"u"&&(S[O]=M++);var de=S[O]}else!1!==$.grouping&&(de=M++);ge.columnIndex=de}});var Z=Math.min(Math.abs(A.transA)*(A.ordinal&&A.ordinal.slope||z.pointRange||A.closestPointRange||A.tickInterval||1),A.len),ae=Z*z.groupPadding,ue=(Z-2*ae)/(M||1);return z=Math.min(z.maxPointWidth||A.len,te(z.pointWidth,ue*(1-2*z.pointPadding))),D.columnMetrics={width:z,offset:(ue-z)/2+(ae+((D.columnIndex||0)+(T?1:0))*ue-Z/2)*(T?-1:1),paddedWidth:ue,columnCount:M},D.columnMetrics},q.prototype.crispCol=function(D,z,A,U){var T=this.chart,S=this.borderWidth,O=-(S%2?.5:0);return S=S%2?.5:1,T.inverted&&T.renderer.isVML&&(S+=1),this.options.crisp&&(A=Math.round(D+A)+O,A-=D=Math.round(D)+O),U=Math.round(z+U)+S,O=.5>=Math.abs(z)&&.5<U,U-=z=Math.round(z)+S,O&&U&&(--z,U+=1),{x:D,y:z,width:A,height:U}},q.prototype.adjustForMissingColumns=function(D,z,A,U){var T=this,S=this.options.stacking;if(!A.isNull&&1<U.columnCount){var O=this.yAxis.options.reversedStacks,M=0,Z=O?0:-U.columnCount;ee(this.yAxis.stacking&&this.yAxis.stacking.stacks,function(ae){if("number"==typeof A.x&&(ae=ae[A.x.toString()])){var ue=ae.points[T.index],ge=ae.total;S?(ue&&(M=Z),ae.hasValidPoints&&(O?Z++:Z--)):H(ue)&&(M=ue[1],Z=ge||0)}}),D=(A.plotX||0)+((Z-1)*U.paddedWidth+z)/2-z-M*U.paddedWidth}return D},q.prototype.translate=function(){var D=this,z=D.chart,A=D.options,U=D.dense=2>D.closestPointRange*D.xAxis.transA;U=D.borderWidth=te(A.borderWidth,U?0:1);var T=D.xAxis,S=D.yAxis,O=A.threshold,M=D.translatedThreshold=S.getThreshold(O),Z=te(A.minPointLength,5),ae=D.getColumnMetrics(),ue=ae.width,ge=D.pointXOffset=ae.offset,V=D.dataMin,$=D.dataMax,de=D.barW=Math.max(ue,1+2*U);z.inverted&&(M-=.5),A.pointPadding&&(de=Math.ceil(de)),Se.prototype.translate.apply(D),D.points.forEach(function(Me){var Ie=te(Me.yBottom,M),De=999+Math.abs(Ie),oe=Me.plotX||0;De=N(Me.plotY,-De,S.len+De);var ve=Math.min(De,Ie),xe=Math.max(De,Ie)-ve,Re=ue,we=oe+ge,Le=de;Z&&Math.abs(xe)<Z&&(xe=Z,oe=!S.reversed&&!Me.negative||S.reversed&&Me.negative,W(O)&&W($)&&Me.y===O&&$<=O&&(S.min||0)<O&&(V!==$||(S.max||0)<=O)&&(oe=!oe),ve=Math.abs(ve-M)>Z?Ie-Z:M-(oe?Z:0)),I(Me.options.pointWidth)&&(Re=Le=Math.ceil(Me.options.pointWidth),we-=Math.round((Re-ue)/2)),A.centerInCategory&&(we=D.adjustForMissingColumns(we,Re,Me,ae)),Me.barX=we,Me.pointWidth=Re,Me.tooltipPos=z.inverted?[N(S.len+S.pos-z.plotLeft-De,S.pos-z.plotLeft,S.len+S.pos-z.plotLeft),T.len+T.pos-z.plotTop-we-Le/2,xe]:[T.left-z.plotLeft+we+Le/2,N(De+S.pos-z.plotTop,S.pos-z.plotTop,S.len+S.pos-z.plotTop),xe],Me.shapeType=D.pointClass.prototype.shapeType||"rect",Me.shapeArgs=D.crispCol.apply(D,Me.isNull?[we,M,Le,0]:[we,ve,Le,xe])})},q.prototype.drawGraph=function(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")},q.prototype.pointAttribs=function(D,z){var A=this.options,U=this.pointAttrToOptions||{},T=U.stroke||"borderColor",S=U["stroke-width"]||"borderWidth",O=D&&D.color||this.color,M=D&&D[T]||A[T]||O;U=D&&D.options.dashStyle||A.dashStyle;var Z=D&&D[S]||A[S]||this[S]||0,ae=te(D&&D.opacity,A.opacity,1);if(D&&this.zones.length){var ue=D.getZone();O=D.options.color||ue&&(ue.color||D.nonZonedColor)||this.color,ue&&(M=ue.borderColor||M,U=ue.dashStyle||U,Z=ue.borderWidth||Z)}return z&&D&&(z=(D=ie(A.states[z],D.options.states&&D.options.states[z]||{})).brightness,O=D.color||typeof z<"u"&&Y(O).brighten(D.brightness).get()||O,M=D[T]||M,Z=D[S]||Z,U=D.dashStyle||U,ae=te(D.opacity,ae)),T={fill:O,stroke:M,"stroke-width":Z,opacity:ae},U&&(T.dashstyle=U),T},q.prototype.drawPoints=function(){var S,D=this,z=this.chart,A=D.options,U=z.renderer,T=A.animationLimit||250;D.points.forEach(function(O){var M=O.graphic,Z=!!M,ae=M&&z.pointCount<T?"animate":"attr";W(O.plotY)&&null!==O.y?(S=O.shapeArgs,M&&O.hasNewShapeType()&&(M=M.destroy()),D.enabledDataSorting&&(O.startXPos=D.xAxis.reversed?-(S&&S.width||0):D.xAxis.width),M||(O.graphic=M=U[O.shapeType](S).add(O.group||D.group))&&D.enabledDataSorting&&z.hasRendered&&z.pointCount<T&&(M.attr({x:O.startXPos}),Z=!0,ae="animate"),M&&Z&&M[ae](ie(S)),A.borderRadius&&M[ae]({r:A.borderRadius}),z.styledMode||M[ae](D.pointAttribs(O,O.selected&&"select")).shadow(!1!==O.allowShadow&&A.shadow,null,A.stacking&&!A.borderRadius),M&&(M.addClass(O.getClassName(),!0),M.attr({visibility:O.visible?"inherit":"hidden"}))):M&&(O.graphic=M.destroy())})},q.prototype.drawTracker=function(){var T,D=this,z=D.chart,A=z.pointer,U=function(S){var O=A.getPointFromEvent(S);typeof O<"u"&&(A.isDirectTouch=!0,O.onMouseOver(S))};D.points.forEach(function(S){T=H(S.dataLabels)?S.dataLabels:S.dataLabel?[S.dataLabel]:[],S.graphic&&(S.graphic.element.point=S),T.forEach(function(O){O.div?O.div.point=S:O.element.point=S})}),D._hasTracking||(D.trackerGroups.forEach(function(S){D[S]&&(D[S].addClass("highcharts-tracker").on("mouseover",U).on("mouseout",function(O){A.onTrackerMouseOut(O)}),j&&D[S].on("touchstart",U),!z.styledMode&&D.options.cursor&&D[S].css(R).css({cursor:D.options.cursor}))}),D._hasTracking=!0),P(this,"afterDrawTracker")},q.prototype.remove=function(){var D=this,z=D.chart;z.hasRendered&&z.series.forEach(function(A){A.type===D.type&&(A.isDirty=!0)}),Se.prototype.remove.apply(D,arguments)},q.defaultOptions=ie(Se.defaultOptions,{borderRadius:0,centerInCategory:!1,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:void 0,verticalAlign:void 0,y:void 0},startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"}),q}(Se),B(ce.prototype,{cropShoulder:0,directTouch:!0,drawLegendSymbol:Ce.drawRectangle,getSymbol:re,negStacks:!0,trackerGroups:["group","dataLabelsGroup"]}),be.registerSeriesType("column",ce),ce}),Ge(u,"Core/Series/DataLabel.js",[u["Core/Animation/AnimationUtilities.js"],u["Core/FormatUtilities.js"],u["Core/Utilities.js"]],function(re,me,Te){var B,Ce=re.getDeferredAnimation,Se=me.format,be=Te.defined,ce=Te.extend,ne=Te.fireEvent,K=Te.isArray,Y=Te.isString,j=Te.merge,N=Te.objectEach,R=Te.pick,I=Te.splat;return function(P){function H(D,z,A,U,T){var S=this,O=this.chart,M=this.isCartesian&&O.inverted,Z=this.enabledDataSorting,ae=R(D.dlBox&&D.dlBox.centerX,D.plotX),ue=D.plotY,ge=A.rotation,V=A.align,$=be(ae)&&be(ue)&&O.isInsidePlot(ae,Math.round(ue),{inverted:M,paneCoordinates:!0,series:S}),de=function(ve){Z&&S.xAxis&&!Me&&S.setDataLabelStartPos(D,z,T,$,ve)},Me="justify"===R(A.overflow,Z?"none":"justify"),Ie=this.visible&&!1!==D.visible&&(D.series.forceDL||Z&&!Me||$||R(A.inside,!!this.options.stacking)&&U&&O.isInsidePlot(ae,M?U.x+1:U.y+U.height-1,{inverted:M,paneCoordinates:!0,series:S}));if(Ie&&be(ae)&&be(ue)){ge&&z.attr({align:V}),V=z.getBBox(!0);var De=[0,0],oe=O.renderer.fontMetrics(O.styledMode?void 0:A.style.fontSize,z).b;U=ce({x:M?this.yAxis.len-ue:ae,y:Math.round(M?this.xAxis.len-ae:ue),width:0,height:0},U),ce(A,{width:V.width,height:V.height}),ge?(Me=!1,De=O.renderer.rotCorr(oe,ge),ae={x:U.x+(A.x||0)+U.width/2+De.x,y:U.y+(A.y||0)+{top:0,middle:.5,bottom:1}[A.verticalAlign]*U.height},De=[V.x-Number(z.attr("x")),V.y-Number(z.attr("y"))],de(ae),z[T?"attr":"animate"](ae)):(de(U),z.align(A,void 0,U),ae=z.alignAttr),Me&&0<=U.height?this.justifyDataLabel(z,A,ae,V,U,T):R(A.crop,!0)&&(U=ae.x,de=ae.y,Ie=O.isInsidePlot(U+=De[0],de+=De[1],{paneCoordinates:!0,series:S})&&O.isInsidePlot(U+V.width,de+V.height,{paneCoordinates:!0,series:S})),A.shape&&!ge&&z[T?"attr":"animate"]({anchorX:M?O.plotWidth-D.plotY:D.plotX,anchorY:M?O.plotHeight-D.plotX:D.plotY})}T&&Z&&(z.placed=!1),Ie||Z&&!Me?z.show():(z.hide(),z.placed=!1)}function ie(){var D=this,z=D.chart,A=D.options,U=D.points,T=D.hasRendered||0,S=z.renderer,O=z.options.chart,M=O.backgroundColor,Z=S.getContrast(Y(O=O.plotBackgroundColor)&&O||Y(M)&&M||"#000000"),ae=A.dataLabels;if(M=ae.animation,M=ae.defer?Ce(z,M,D):{defer:0,duration:0},ae=ee(ee(z.options.plotOptions&&z.options.plotOptions.series&&z.options.plotOptions.series.dataLabels,z.options.plotOptions&&z.options.plotOptions[D.type]&&z.options.plotOptions[D.type].dataLabels),ae),ne(this,"drawDataLabels"),K(ae)||ae.enabled||D._hasPointLabels){var ge=D.plotGroup("dataLabelsGroup","data-labels",T?"inherit":"hidden",ae.zIndex||6);ge.attr({opacity:+T}),!T&&(T=D.dataLabelsGroup)&&(D.visible&&ge.show(),T[A.animation?"animate":"attr"]({opacity:1},M)),U.forEach(function(V){I(ee(ae,V.dlOptions||V.options&&V.options.dataLabels)).forEach(function($,de){var Me=$.enabled&&(!V.isNull||V.dataLabelOnNull)&&function W(D,z){var A=z.filter;return!A||(z=A.operator,D=D[A.property],A=A.value,">"===z&&D>A||"<"===z&&D<A||">="===z&&D>=A||"<="===z&&D<=A||"=="===z&&D==A||"==="===z&&D===A)}(V,$),Ie=V.connectors?V.connectors[de]:V.connector,De=V.dataLabels?V.dataLabels[de]:V.dataLabel,oe=!De,ve=R($.distance,V.labelDistance);if(Me){var xe=V.getLabelConfig(),Re=R($[V.formatPrefix+"Format"],$.format);xe=be(Re)?Se(Re,xe,z):($[V.formatPrefix+"Formatter"]||$.formatter).call(xe,$),Re=$.style;var we=$.rotation;z.styledMode||(Re.color=R($.color,Re.color,D.color,"#000000"),"contrast"===Re.color?(V.contrastColor=S.getContrast(V.color||D.color),Re.color=!be(ve)&&$.inside||0>ve||A.stacking?V.contrastColor:Z):delete V.contrastColor,A.cursor&&(Re.cursor=A.cursor));var Le={r:$.borderRadius||0,rotation:we,padding:$.padding,zIndex:1};z.styledMode||(Le.fill=$.backgroundColor,Le.stroke=$.borderColor,Le["stroke-width"]=$.borderWidth),N(Le,function(Ne,Ze){typeof Ne>"u"&&delete Le[Ze]})}!De||Me&&be(xe)&&!!De.div==!!$.useHTML&&(De.rotation&&$.rotation||De.rotation===$.rotation)||(oe=!0,V.dataLabel=De=V.dataLabel&&V.dataLabel.destroy(),V.dataLabels&&(1===V.dataLabels.length?delete V.dataLabels:delete V.dataLabels[de]),de||delete V.dataLabel,Ie&&(V.connector=V.connector.destroy(),V.connectors&&(1===V.connectors.length?delete V.connectors:delete V.connectors[de]))),Me&&be(xe)?(De?Le.text=xe:(V.dataLabels=V.dataLabels||[],De=V.dataLabels[de]=we?S.text(xe,0,0,$.useHTML).addClass("highcharts-data-label"):S.label(xe,0,0,$.shape,null,null,$.useHTML,null,"data-label"),de||(V.dataLabel=De),De.addClass(" highcharts-data-label-color-"+V.colorIndex+" "+($.className||"")+($.useHTML?" highcharts-tracker":""))),De.options=$,De.attr(Le),z.styledMode||De.css(Re).shadow($.shadow),$.textPath&&!$.useHTML&&(De.setTextPath(V.getDataLabelPath&&V.getDataLabelPath(De)||V.graphic,$.textPath),V.dataLabelPath&&!$.textPath.enabled&&(V.dataLabelPath=V.dataLabelPath.destroy())),De.added||De.add(ge),D.alignDataLabel(V,De,$,null,oe)):De&&De.hide()})})}ne(this,"afterDrawDataLabels")}function te(D,z,A,U,T,S){var O=this.chart,M=z.align,Z=z.verticalAlign,ae=D.box?0:D.padding||0,ue=z.x;ue=void 0===ue?0:ue;var ge=z.y;ge=void 0===ge?0:ge;var V=(A.x||0)+ae;if(0>V){"right"===M&&0<=ue?(z.align="left",z.inside=!0):ue-=V;var $=!0}return(V=(A.x||0)+U.width-ae)>O.plotWidth&&("left"===M&&0>=ue?(z.align="right",z.inside=!0):ue+=O.plotWidth-V,$=!0),0>(V=A.y+ae)&&("bottom"===Z&&0<=ge?(z.verticalAlign="top",z.inside=!0):ge-=V,$=!0),(V=(A.y||0)+U.height-ae)>O.plotHeight&&("top"===Z&&0>=ge?(z.verticalAlign="bottom",z.inside=!0):ge+=O.plotHeight-V,$=!0),$&&(z.x=ue,z.y=ge,D.placed=!S,D.align(z,void 0,T)),$}function ee(D,z){var U,A=[];if(K(D)&&!K(z))A=D.map(function(T){return j(T,z)});else if(K(z)&&!K(D))A=z.map(function(T){return j(D,T)});else if(K(D)||K(z))for(U=Math.max(D.length,z.length);U--;)A[U]=j(D[U],z[U]);else A=j(D,z);return A}function J(D,z,A,U,T){var S=this.chart,O=S.inverted,M=this.xAxis,Z=M.reversed,ae=O?z.height/2:z.width/2;D=(D=D.pointWidth)?D/2:0,z.startXPos=O?T.x:Z?-ae-D:M.width-ae+D,z.startYPos=O?Z?this.yAxis.height-ae+D:-ae-D:T.y,U?"hidden"===z.visibility&&(z.show(),z.attr({opacity:0}).animate({opacity:1})):z.attr({opacity:1}).animate({opacity:0},void 0,z.hide),S.hasRendered&&(A&&z.attr({x:z.startXPos,y:z.startYPos}),z.placed=!0)}var q=[];P.compose=function(D){if(-1===q.indexOf(D)){var z=D.prototype;q.push(D),z.alignDataLabel=H,z.drawDataLabels=ie,z.justifyDataLabel=te,z.setDataLabelStartPos=J}}}(B||(B={})),B}),Ge(u,"Series/Column/ColumnDataLabel.js",[u["Core/Series/DataLabel.js"],u["Core/Series/SeriesRegistry.js"],u["Core/Utilities.js"]],function(re,me,Te){var ce,Ce=me.series,Se=Te.merge,be=Te.pick;return function(ne){function K(j,N,R,I,B){var P=this.chart.inverted,H=j.series,W=(H.xAxis?H.xAxis.len:this.chart.plotSizeX)||0,ie=j.dlBox||j.shapeArgs,te=be(j.below,j.plotY>be(this.translatedThreshold,H=(H.yAxis?H.yAxis.len:this.chart.plotSizeY)||0)),ee=be(R.inside,!!this.options.stacking);ie&&(0>(I=Se(ie)).y&&(I.height+=I.y,I.y=0),0<(ie=I.y+I.height-H)&&ie<I.height&&(I.height-=ie),P&&(I={x:H-I.y-I.height,y:W-I.x-I.width,width:I.height,height:I.width}),ee||(P?(I.x+=te?0:I.width,I.width=0):(I.y+=te?I.height:0,I.height=0))),R.align=be(R.align,!P||ee?"center":te?"right":"left"),R.verticalAlign=be(R.verticalAlign,P||ee?"middle":te?"top":"bottom"),Ce.prototype.alignDataLabel.call(this,j,N,R,I,B),R.inside&&j.contrastColor&&N.css({color:j.contrastColor})}var Y=[];ne.compose=function(j){re.compose(Ce),-1===Y.indexOf(j)&&(Y.push(j),j.prototype.alignDataLabel=K)}}(ce||(ce={})),ce}),Ge(u,"Series/Bar/BarSeries.js",[u["Series/Column/ColumnSeries.js"],u["Core/Series/SeriesRegistry.js"],u["Core/Utilities.js"]],function(re,me,Te){var ce,Ce=this&&this.__extends||(ce=function(ne,K){return(ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Y,j){Y.__proto__=j}||function(Y,j){for(var N in j)j.hasOwnProperty(N)&&(Y[N]=j[N])})(ne,K)},function(ne,K){function Y(){this.constructor=ne}ce(ne,K),ne.prototype=null===K?Object.create(K):(Y.prototype=K.prototype,new Y)}),Se=Te.extend,be=Te.merge;return Te=function(ce){function ne(){var K=null!==ce&&ce.apply(this,arguments)||this;return K.data=void 0,K.options=void 0,K.points=void 0,K}return Ce(ne,ce),ne.defaultOptions=be(re.defaultOptions,{}),ne}(re),Se(Te.prototype,{inverted:!0}),me.registerSeriesType("bar",Te),Te}),Ge(u,"Series/Scatter/ScatterSeries.js",[u["Core/Series/SeriesRegistry.js"],u["Core/Utilities.js"]],function(re,me){var K,Te=this&&this.__extends||(K=function(Y,j){return(K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,R){N.__proto__=R}||function(N,R){for(var I in R)R.hasOwnProperty(I)&&(N[I]=R[I])})(Y,j)},function(Y,j){function N(){this.constructor=Y}K(Y,j),Y.prototype=null===j?Object.create(j):(N.prototype=j.prototype,new N)}),Ce=re.seriesTypes,Se=Ce.column,be=Ce.line;Ce=me.addEvent;var ce=me.extend,ne=me.merge;return me=function(K){function Y(){var j=null!==K&&K.apply(this,arguments)||this;return j.data=void 0,j.options=void 0,j.points=void 0,j}return Te(Y,K),Y.prototype.applyJitter=function(){var j=this,N=this.options.jitter,R=this.points.length;N&&this.points.forEach(function(I,B){["x","y"].forEach(function(P,H){var W="plot"+P.toUpperCase();if(N[P]&&!I.isNull){var ie=j[P+"Axis"],te=N[P]*ie.transA;if(ie&&!ie.isLog){var ee=Math.max(0,I[W]-te);ie=Math.min(ie.len,I[W]+te),H=1e4*Math.sin(B+H*R),I[W]=ee+(ie-ee)*(H-Math.floor(H)),"x"===P&&(I.clientX=I.plotX)}}})})},Y.prototype.drawGraph=function(){this.options.lineWidth?K.prototype.drawGraph.call(this):this.graph&&(this.graph=this.graph.destroy())},Y.defaultOptions=ne(be.defaultOptions,{lineWidth:0,findNearestPointBy:"xy",jitter:{x:0,y:0},marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">\u25cf</span> <span style="font-size: 10px"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}}),Y}(be),ce(me.prototype,{drawTracker:Se.prototype.drawTracker,sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1}),Ce(me,"afterTranslate",function(){this.applyJitter()}),re.registerSeriesType("scatter",me),me}),Ge(u,"Series/CenteredUtilities.js",[u["Core/Globals.js"],u["Core/Series/Series.js"],u["Core/Utilities.js"]],function(re,me,Te){var K,Y,Ce=re.deg2rad,Se=Te.fireEvent,be=Te.isNumber,ce=Te.pick,ne=Te.relativeLength;return(Y=K||(K={})).getCenter=function(){var j=this.options,N=this.chart,R=2*(j.slicedOffset||0),I=N.plotWidth-2*R,B=N.plotHeight-2*R,P=j.center,H=Math.min(I,B),W=j.thickness,ie=j.size,te=j.innerSize||0;for("string"==typeof ie&&(ie=parseFloat(ie)),"string"==typeof te&&(te=parseFloat(te)),j=[ce(P[0],"50%"),ce(P[1],"50%"),ce(ie&&0>ie?void 0:j.size,"100%"),ce(te&&0>te?void 0:j.innerSize||0,"0%")],!N.angular||this instanceof me||(j[3]=0),P=0;4>P;++P)ie=j[P],N=2>P||2===P&&/%$/.test(ie),j[P]=ne(ie,[I,B,H,j[2]][P])+(N?R:0);return j[3]>j[2]&&(j[3]=j[2]),be(W)&&2*W<j[2]&&0<W&&(j[3]=j[2]-2*W),Se(this,"afterGetCenter",{positions:j}),j},Y.getStartAndEndRadians=function(j,N){return j=be(j)?j:0,N=be(N)&&N>j&&360>N-j?N:j+360,{start:Ce*(j+-90),end:Ce*(N+-90)}},K}),Ge(u,"Series/Pie/PiePoint.js",[u["Core/Animation/AnimationUtilities.js"],u["Core/Series/Point.js"],u["Core/Utilities.js"]],function(re,me,Te){var j,Ce=this&&this.__extends||(j=function(N,R){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,B){I.__proto__=B}||function(I,B){for(var P in B)B.hasOwnProperty(P)&&(I[P]=B[P])})(N,R)},function(N,R){function I(){this.constructor=N}j(N,R),N.prototype=null===R?Object.create(R):(I.prototype=R.prototype,new I)}),Se=re.setAnimation,be=Te.addEvent,ce=Te.defined;re=Te.extend;var ne=Te.isNumber,K=Te.pick,Y=Te.relativeLength;return me=function(j){function N(){var R=null!==j&&j.apply(this,arguments)||this;return R.labelDistance=void 0,R.options=void 0,R.series=void 0,R}return Ce(N,j),N.prototype.getConnectorPath=function(){var R=this.labelPosition,I=this.series.options.dataLabels,B=this.connectorShapes,P=I.connectorShape;return B[P]&&(P=B[P]),P.call(this,{x:R.final.x,y:R.final.y,alignment:R.alignment},R.connectorPosition,I)},N.prototype.getTranslate=function(){return this.sliced?this.slicedTranslation:{translateX:0,translateY:0}},N.prototype.haloPath=function(R){var I=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(I.x,I.y,I.r+R,I.r+R,{innerR:I.r-1,start:I.start,end:I.end})},N.prototype.init=function(){var R=this;j.prototype.init.apply(this,arguments),this.name=K(this.name,"Slice");var I=function(B){R.slice("select"===B.type)};return be(this,"select",I),be(this,"unselect",I),this},N.prototype.isValid=function(){return ne(this.y)&&0<=this.y},N.prototype.setVisible=function(R,I){var B=this,P=this.series,H=P.chart,W=P.options.ignoreHiddenPoint;I=K(I,W),R!==this.visible&&(this.visible=this.options.visible=R=typeof R>"u"?!this.visible:R,P.options.data[P.data.indexOf(this)]=this.options,["graphic","dataLabel","connector","shadowGroup"].forEach(function(ie){B[ie]&&B[ie][R?"show":"hide"](R)}),this.legendItem&&H.legend.colorizeItem(this,R),R||"hover"!==this.state||this.setState(""),W&&(P.isDirty=!0),I&&H.redraw())},N.prototype.slice=function(R,I,B){var P=this.series;Se(B,P.chart),K(I,!0),this.sliced=this.options.sliced=ce(R)?R:!this.sliced,P.options.data[P.data.indexOf(this)]=this.options,this.graphic&&this.graphic.animate(this.getTranslate()),this.shadowGroup&&this.shadowGroup.animate(this.getTranslate())},N}(me),re(me.prototype,{connectorShapes:{fixedOffset:function(j,N,R){var I=N.breakAt;return N=N.touchingSliceAt,[["M",j.x,j.y],R.softConnector?["C",j.x+("left"===j.alignment?-5:5),j.y,2*I.x-N.x,2*I.y-N.y,I.x,I.y]:["L",I.x,I.y],["L",N.x,N.y]]},straight:function(j,N){return[["M",j.x,j.y],["L",(N=N.touchingSliceAt).x,N.y]]},crookedLine:function(j,N,R){N=N.touchingSliceAt;var I=this.series,B=I.center[0],P=I.chart.plotWidth,H=I.chart.plotLeft;I=j.alignment;var W=this.shapeArgs.r;return R=Y(R.crookDistance,1),R=["L",P="left"===I?B+W+(P+H-B-W)*(1-R):H+(B-W)*R,j.y],B=!0,("left"===I?P>j.x||P<N.x:P<j.x||P>N.x)&&(B=!1),j=[["M",j.x,j.y]],B&&j.push(R),j.push(["L",N.x,N.y]),j}}}),me}),Ge(u,"Series/Pie/PieSeries.js",[u["Series/CenteredUtilities.js"],u["Series/Column/ColumnSeries.js"],u["Core/Globals.js"],u["Core/Legend/LegendSymbol.js"],u["Series/Pie/PiePoint.js"],u["Core/Series/Series.js"],u["Core/Series/SeriesRegistry.js"],u["Core/Renderer/SVG/Symbols.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce,Se,be,ce,ne,K){var W,Y=this&&this.__extends||(W=function(ie,te){return(W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ee,J){ee.__proto__=J}||function(ee,J){for(var q in J)J.hasOwnProperty(q)&&(ee[q]=J[q])})(ie,te)},function(ie,te){function ee(){this.constructor=ie}W(ie,te),ie.prototype=null===te?Object.create(te):(ee.prototype=te.prototype,new ee)}),j=re.getStartAndEndRadians;Te=Te.noop;var N=K.clamp,R=K.extend,I=K.fireEvent,B=K.merge,P=K.pick,H=K.relativeLength;return K=function(W){function ie(){var te=null!==W&&W.apply(this,arguments)||this;return te.center=void 0,te.data=void 0,te.maxLabelDistance=void 0,te.options=void 0,te.points=void 0,te}return Y(ie,W),ie.prototype.animate=function(te){var ee=this,q=ee.startAngleRad;te||ee.points.forEach(function(D){var z=D.graphic,A=D.shapeArgs;z&&A&&(z.attr({r:P(D.startR,ee.center&&ee.center[3]/2),start:q,end:q}),z.animate({r:A.r,start:A.start,end:A.end},ee.options.animation))})},ie.prototype.drawEmpty=function(){var te=this.startAngleRad,ee=this.endAngleRad,J=this.options;if(0===this.total&&this.center){var q=this.center[0],D=this.center[1];this.graph||(this.graph=this.chart.renderer.arc(q,D,this.center[1]/2,0,te,ee).addClass("highcharts-empty-series").add(this.group)),this.graph.attr({d:ne.arc(q,D,this.center[2]/2,0,{start:te,end:ee,innerR:this.center[3]/2})}),this.chart.styledMode||this.graph.attr({"stroke-width":J.borderWidth,fill:J.fillColor||"none",stroke:J.color||"#cccccc"})}else this.graph&&(this.graph=this.graph.destroy())},ie.prototype.drawPoints=function(){var te=this.chart.renderer;this.points.forEach(function(ee){ee.graphic&&ee.hasNewShapeType()&&(ee.graphic=ee.graphic.destroy()),ee.graphic||(ee.graphic=te[ee.shapeType](ee.shapeArgs).add(ee.series.group),ee.delayedRendering=!0)})},ie.prototype.generatePoints=function(){W.prototype.generatePoints.call(this),this.updateTotals()},ie.prototype.getX=function(te,ee,J){var q=this.center,D=this.radii?this.radii[J.index]||0:q[2]/2;return te=Math.asin(N((te-q[1])/(D+J.labelDistance),-1,1)),q[0]+(ee?-1:1)*Math.cos(te)*(D+J.labelDistance)+(0<J.labelDistance?(ee?-1:1)*this.options.dataLabels.padding:0)},ie.prototype.hasData=function(){return!!this.processedXData.length},ie.prototype.redrawPoints=function(){var D,z,A,U,te=this,ee=te.chart,J=ee.renderer,q=te.options.shadow;this.drawEmpty(),!q||te.shadowGroup||ee.styledMode||(te.shadowGroup=J.g("shadow").attr({zIndex:-1}).add(te.group)),te.points.forEach(function(T){var S={};if(z=T.graphic,!T.isNull&&z){var O=void 0;U=T.shapeArgs,D=T.getTranslate(),ee.styledMode||(O=T.shadowGroup,q&&!O&&(O=T.shadowGroup=J.g("shadow").add(te.shadowGroup)),O&&O.attr(D),A=te.pointAttribs(T,T.selected&&"select")),T.delayedRendering?(z.setRadialReference(te.center).attr(U).attr(D),ee.styledMode||z.attr(A).attr({"stroke-linejoin":"round"}).shadow(q,O),T.delayedRendering=!1):(z.setRadialReference(te.center),ee.styledMode||B(!0,S,A),B(!0,S,U,D),z.animate(S)),z.attr({visibility:T.visible?"inherit":"hidden"}),z.addClass(T.getClassName(),!0)}else z&&(T.graphic=z.destroy())})},ie.prototype.sortByAngle=function(te,ee){te.sort(function(J,q){return typeof J.angle<"u"&&(q.angle-J.angle)*ee})},ie.prototype.translate=function(te){I(this,"translate"),this.generatePoints();var ee=this.options,J=ee.slicedOffset,q=J+(ee.borderWidth||0),D=j(ee.startAngle,ee.endAngle),z=this.startAngleRad=D.start;D=(this.endAngleRad=D.end)-z;var A=this.points,U=ee.dataLabels.distance;ee=ee.ignoreHiddenPoint;var S,T=A.length,O=0;for(te||(this.center=te=this.getCenter()),S=0;S<T;S++){var M=A[S],Z=z+O*D;!M.isValid()||ee&&!M.visible||(O+=M.percentage/100);var ae=z+O*D,ue={x:te[0],y:te[1],r:te[2]/2,innerR:te[3]/2,start:Math.round(1e3*Z)/1e3,end:Math.round(1e3*ae)/1e3};M.shapeType="arc",M.shapeArgs=ue,M.labelDistance=P(M.options.dataLabels&&M.options.dataLabels.distance,U),M.labelDistance=H(M.labelDistance,ue.r),this.maxLabelDistance=Math.max(this.maxLabelDistance||0,M.labelDistance),(ae=(ae+Z)/2)>1.5*Math.PI?ae-=2*Math.PI:ae<-Math.PI/2&&(ae+=2*Math.PI),M.slicedTranslation={translateX:Math.round(Math.cos(ae)*J),translateY:Math.round(Math.sin(ae)*J)},ue=Math.cos(ae)*te[2]/2;var ge=Math.sin(ae)*te[2]/2;M.tooltipPos=[te[0]+.7*ue,te[1]+.7*ge],M.half=ae<-Math.PI/2||ae>Math.PI/2?1:0,M.angle=ae,Z=Math.min(q,M.labelDistance/5),M.labelPosition={natural:{x:te[0]+ue+Math.cos(ae)*M.labelDistance,y:te[1]+ge+Math.sin(ae)*M.labelDistance},final:{},alignment:0>M.labelDistance?"center":M.half?"right":"left",connectorPosition:{breakAt:{x:te[0]+ue+Math.cos(ae)*Z,y:te[1]+ge+Math.sin(ae)*Z},touchingSliceAt:{x:te[0]+ue,y:te[1]+ge}}}}I(this,"afterTranslate")},ie.prototype.updateTotals=function(){var q,te=this.points,ee=te.length,J=this.options.ignoreHiddenPoint,D=0;for(q=0;q<ee;q++){var z=te[q];!z.isValid()||J&&!z.visible||(D+=z.y)}for(this.total=D,q=0;q<ee;q++)(z=te[q]).percentage=0<D&&(z.visible||!J)?z.y/D*100:0,z.total=D},ie.defaultOptions=B(be.defaultOptions,{center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{allowOverlap:!0,connectorPadding:5,connectorShape:"fixedOffset",crookDistance:"70%",distance:30,enabled:!0,formatter:function(){return this.point.isNull?void 0:this.point.name},softConnector:!0,x:0},fillColor:void 0,ignoreHiddenPoint:!0,inactiveOtherPoints:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,lineWidth:void 0,states:{hover:{brightness:.1}}}),ie}(be),R(K.prototype,{axisTypes:[],directTouch:!0,drawGraph:void 0,drawLegendSymbol:Ce.drawRectangle,drawTracker:me.prototype.drawTracker,getCenter:re.getCenter,getSymbol:Te,isCartesian:!1,noSharedTooltip:!0,pointAttribs:me.prototype.pointAttribs,pointClass:Se,requireSorting:!1,searchPoint:Te,trackerGroups:["group","dataLabelsGroup"]}),ce.registerSeriesType("pie",K),K}),Ge(u,"Series/Pie/PieDataLabel.js",[u["Core/Series/DataLabel.js"],u["Core/Globals.js"],u["Core/Renderer/RendererUtilities.js"],u["Core/Series/SeriesRegistry.js"],u["Core/Utilities.js"]],function(re,me,Te,Ce,Se){var B,be=me.noop,ce=Te.distribute,ne=Ce.series,K=Se.arrayMax,Y=Se.clamp,j=Se.defined,N=Se.merge,R=Se.pick,I=Se.relativeLength;return function(P){function H(){var $,de,Me,Ie,De,oe,ve,xe,Re,we,Le,Ne,J=this,q=J.data,D=J.chart,z=J.options.dataLabels||{},A=z.connectorPadding,U=D.plotWidth,T=D.plotHeight,S=D.plotLeft,O=Math.round(D.chartWidth/3),M=J.center,Z=M[2]/2,ae=M[1],ue=[[],[]],ge=[0,0,0,0],V=J.dataLabelPositioners;J.visible&&(z.enabled||J._hasPointLabels)&&(q.forEach(function(Ze){Ze.dataLabel&&Ze.visible&&Ze.dataLabel.shortened&&(Ze.dataLabel.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),Ze.dataLabel.shortened=!1)}),ne.prototype.drawDataLabels.apply(J),q.forEach(function(Ze){Ze.dataLabel&&(Ze.visible?(ue[Ze.half].push(Ze),Ze.dataLabel._pos=null,!j(z.style.width)&&!j(Ze.options.dataLabels&&Ze.options.dataLabels.style&&Ze.options.dataLabels.style.width)&&Ze.dataLabel.getBBox().width>O&&(Ze.dataLabel.css({width:Math.round(.7*O)+"px"}),Ze.dataLabel.shortened=!0)):(Ze.dataLabel=Ze.dataLabel.destroy(),Ze.dataLabels&&1===Ze.dataLabels.length&&delete Ze.dataLabels))}),ue.forEach(function(Ze,at){var Ut,wt=Ze.length,Tt=[];if(wt){if(J.sortByAngle(Ze,at-.5),0<J.maxLabelDistance){var bt=Math.max(0,ae-Z-J.maxLabelDistance),lt=Math.min(ae+Z+J.maxLabelDistance,D.plotHeight);Ze.forEach(function(Pe){0<Pe.labelDistance&&Pe.dataLabel&&(Pe.top=Math.max(0,ae-Z-Pe.labelDistance),Pe.bottom=Math.min(ae+Z+Pe.labelDistance,D.plotHeight),Ut=Pe.dataLabel.getBBox().height||21,Pe.distributeBox={target:Pe.labelPosition.natural.y-Pe.top+Ut/2,size:Ut,rank:Pe.y},Tt.push(Pe.distributeBox))}),ce(Tt,bt=lt+Ut-bt,bt/5)}for(Le=0;Le<wt;Le++){if(Ie=($=Ze[Le]).dataLabel,we=!1===$.visible?"hidden":"inherit",Re=bt=(oe=$.labelPosition).natural.y,Tt&&j($.distributeBox)&&(typeof $.distributeBox.pos>"u"?we="hidden":(ve=$.distributeBox.size,Re=V.radialDistributionY($))),delete $.positionIndex,z.justify)xe=V.justify($,Z,M);else switch(z.alignTo){case"connectors":xe=V.alignToConnectors(Ze,at,U,S);break;case"plotEdges":xe=V.alignToPlotEdges(Ie,at,U,S);break;default:xe=V.radialDistributionX(J,$,Re,bt)}Ie._attr={visibility:we,align:oe.alignment},Ie._pos={x:xe+R((Ne=$.options.dataLabels||{}).x,z.x)+({left:A,right:-A}[oe.alignment]||0),y:Re+R(Ne.y,z.y)-10},oe.final.x=xe,oe.final.y=Re,R(z.crop,!0)&&(De=Ie.getBBox().width,bt=null,xe-De<A&&1===at?(bt=Math.round(De-xe+A),ge[3]=Math.max(bt,ge[3])):xe+De>U-A&&0===at&&(bt=Math.round(xe+De-U+A),ge[1]=Math.max(bt,ge[1])),0>Re-ve/2?ge[0]=Math.max(Math.round(ve/2-Re),ge[0]):Re+ve/2>T&&(ge[2]=Math.max(Math.round(Re+ve/2-T),ge[2])),Ie.sideOverflow=bt)}}}),0===K(ge)||this.verifyDataLabelOverflow(ge))&&(this.placeDataLabels(),this.points.forEach(function(Ze){var at;Ne=N(z,Ze.options.dataLabels),(de=R(Ne.connectorWidth,1))&&(Me=Ze.connector,(Ie=Ze.dataLabel)&&Ie._pos&&Ze.visible&&0<Ze.labelDistance?(we=Ie._attr.visibility,(at=!Me)&&(Ze.connector=Me=D.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+Ze.colorIndex+(Ze.className?" "+Ze.className:"")).add(J.dataLabelsGroup),D.styledMode||Me.attr({"stroke-width":de,stroke:Ne.connectorColor||Ze.color||"#666666"})),Me[at?"attr":"animate"]({d:Ze.getConnectorPath()}),Me.attr("visibility",we)):Me&&(Ze.connector=Me.destroy()))}))}function W(){this.points.forEach(function(J){var D,q=J.dataLabel;q&&J.visible&&((D=q._pos)?(q.sideOverflow&&(q._attr.width=Math.max(q.getBBox().width-q.sideOverflow,0),q.css({width:q._attr.width+"px",textOverflow:(this.options.dataLabels.style||{}).textOverflow||"ellipsis"}),q.shortened=!0),q.attr(q._attr),q[q.moved?"animate":"attr"](D),q.moved=!0):q&&q.attr({y:-9999})),delete J.distributeBox},this)}function ie(J){var q=this.center,D=this.options,z=D.center,A=D.minSize||80,U=null!==D.size;if(!U){if(null!==z[0])var T=Math.max(q[2]-Math.max(J[1],J[3]),A);else T=Math.max(q[2]-J[1]-J[3],A),q[0]+=(J[3]-J[1])/2;null!==z[1]?T=Y(T,A,q[2]-Math.max(J[0],J[2])):(T=Y(T,A,q[2]-J[0]-J[2]),q[1]+=(J[0]-J[2])/2),T<q[2]?(q[2]=T,q[3]=Math.min(D.thickness?Math.max(0,T-2*D.thickness):Math.max(0,I(D.innerSize||0,T)),T),this.translate(q),this.drawDataLabels&&this.drawDataLabels()):U=!0}return U}var te=[],ee={radialDistributionY:function(J){return J.top+J.distributeBox.pos},radialDistributionX:function(J,q,D,z){return J.getX(D<q.top+2||D>q.bottom-2?z:D,q.half,q)},justify:function(J,q,D){return D[0]+(J.half?-1:1)*(q+J.labelDistance)},alignToPlotEdges:function(J,q,D,z){return J=J.getBBox().width,q?J+z:D-J-z},alignToConnectors:function(J,q,D,z){var U,A=0;return J.forEach(function(T){(U=T.dataLabel.getBBox().width)>A&&(A=U)}),q?A+z:D-A-z}};P.compose=function(J){re.compose(ne),-1===te.indexOf(J)&&(te.push(J),(J=J.prototype).dataLabelPositioners=ee,J.alignDataLabel=be,J.drawDataLabels=H,J.placeDataLabels=W,J.verifyDataLabelOverflow=ie)}}(B||(B={})),B}),Ge(u,"Extensions/OverlappingDataLabels.js",[u["Core/Chart/Chart.js"],u["Core/Utilities.js"]],function(re,me){function Te(Y,j){var N=!1;if(Y){var R=Y.newOpacity;Y.oldOpacity!==R&&(Y.alignAttr&&Y.placed?(Y[R?"removeClass":"addClass"]("highcharts-data-label-hidden"),N=!0,Y.alignAttr.opacity=R,Y[Y.isOld?"animate":"attr"](Y.alignAttr,null,function(){j.styledMode||Y.css({pointerEvents:R?"auto":"none"})}),Se(j,"afterHideOverlappingLabel")):Y.attr({opacity:R})),Y.isOld=!0}return N}var Se=me.fireEvent,be=me.isArray,ce=me.isNumber,ne=me.objectEach,K=me.pick;(0,me.addEvent)(re,"render",function(){var Y=this,j=[];(this.labelCollectors||[]).forEach(function(N){j=j.concat(N())}),(this.yAxis||[]).forEach(function(N){N.stacking&&N.options.stackLabels&&!N.options.stackLabels.allowOverlap&&ne(N.stacking.stacks,function(R){ne(R,function(I){I.label&&j.push(I.label)})})}),(this.series||[]).forEach(function(N){var R=N.options.dataLabels;N.visible&&(!1!==R.enabled||N._hasPointLabels)&&((R=function(I){return I.forEach(function(B){B.visible&&(be(B.dataLabels)?B.dataLabels:B.dataLabel?[B.dataLabel]:[]).forEach(function(P){var H=P.options;P.labelrank=K(H.labelrank,B.labelrank,B.shapeArgs&&B.shapeArgs.height),H.allowOverlap?(P.oldOpacity=P.opacity,P.newOpacity=1,Te(P,Y)):j.push(P)})})})(N.nodes||[]),R(N.points))}),this.hideOverlappingLabels(j)}),re.prototype.hideOverlappingLabels=function(Y){var I,B,P,j=this,N=Y.length,R=j.renderer,H=!1,W=function(ee){var J,z,q=ee.box?0:ee.padding||0,D=J=0;if(ee&&(!ee.alignAttr||ee.placed)){var A=ee.alignAttr||{x:ee.attr("x"),y:ee.attr("y")},U=ee.parentGroup;return ee.width||(J=ee.getBBox(),ee.width=J.width,ee.height=J.height,J=R.fontMetrics(null,ee.element).h),(z={left:"0",center:"0.5",right:"1"}[ee.alignValue])?D=+z*(ee.width-2*q):ce(ee.x)&&Math.round(ee.x)!==ee.translateX&&(D=ee.x-ee.translateX),{x:A.x+(U.translateX||0)+q-(D||0),y:A.y+(U.translateY||0)+q-J,width:ee.width-2*q,height:ee.height-2*q}}};for(B=0;B<N;B++)(I=Y[B])&&(I.oldOpacity=I.opacity,I.newOpacity=1,I.absoluteBox=W(I));for(Y.sort(function(ee,J){return(J.labelrank||0)-(ee.labelrank||0)}),B=0;B<N;B++){var ie=(W=Y[B])&&W.absoluteBox;for(I=B+1;I<N;++I){var te=(P=Y[I])&&P.absoluteBox;!ie||!te||W===P||0===W.newOpacity||0===P.newOpacity||"hidden"===W.visibility||"hidden"===P.visibility||te.x>=ie.x+ie.width||te.x+te.width<=ie.x||te.y>=ie.y+ie.height||te.y+te.height<=ie.y||((W.labelrank<P.labelrank?W:P).newOpacity=0)}}Y.forEach(function(ee){Te(ee,j)&&(H=!0)}),H&&Se(j,"afterHideAllOverlappingLabels")}}),Ge(u,"Core/Responsive.js",[u["Core/Utilities.js"]],function(re){var j,me=re.extend,Te=re.find,Ce=re.isArray,Se=re.isObject,be=re.merge,ce=re.objectEach,ne=re.pick,K=re.splat,Y=re.uniqueKey;return function(N){var R=[];N.compose=function(B){return-1===R.indexOf(B)&&(R.push(B),me(B.prototype,I.prototype)),B};var I=function(){function B(){}return B.prototype.currentOptions=function(P){var W=this,ie={};return function H(te,ee,J,q){var D;ce(te,function(z,A){if(!q&&-1<W.collectionsWithUpdate.indexOf(A)&&ee[A])for(z=K(z),J[A]=[],D=0;D<Math.max(z.length,ee[A].length);D++)ee[A][D]&&(void 0===z[D]?J[A][D]=ee[A][D]:(J[A][D]={},H(z[D],ee[A][D],J[A][D],q+1)));else Se(z)?(J[A]=Ce(z)?[]:{},H(z,ee[A]||{},J[A],q+1)):J[A]=typeof ee[A]>"u"?null:ee[A]})}(P,this.options,ie,0),ie},B.prototype.matchResponsiveRule=function(P,H){var W=P.condition;(W.callback||function(){return this.chartWidth<=ne(W.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=ne(W.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=ne(W.minWidth,0)&&this.chartHeight>=ne(W.minHeight,0)}).call(this)&&H.push(P._id)},B.prototype.setResponsive=function(P,H){var W=this,ie=this.options.responsive,te=this.currentResponsive,ee=[];!H&&ie&&ie.rules&&ie.rules.forEach(function(J){typeof J._id>"u"&&(J._id=Y()),W.matchResponsiveRule(J,ee)},this),(H=be.apply(void 0,ee.map(function(J){return Te((ie||{}).rules||[],function(q){return q._id===J})}).map(function(J){return J&&J.chartOptions}))).isResponsiveOptions=!0,(ee=ee.toString()||void 0)!==(te&&te.ruleIds)&&(te&&this.update(te.undoOptions,P,!0),ee?((te=this.currentOptions(H)).isResponsiveOptions=!0,this.currentResponsive={ruleIds:ee,mergedOptions:H,undoOptions:te},this.update(H,P,!0)):this.currentResponsive=void 0)},B}()}(j||(j={})),j}),Ge(u,"masters/highcharts.src.js",[u["Core/Globals.js"],u["Core/Utilities.js"],u["Core/DefaultOptions.js"],u["Core/Animation/Fx.js"],u["Core/Animation/AnimationUtilities.js"],u["Core/Renderer/HTML/AST.js"],u["Core/FormatUtilities.js"],u["Core/Renderer/RendererUtilities.js"],u["Core/Renderer/SVG/SVGElement.js"],u["Core/Renderer/SVG/SVGRenderer.js"],u["Core/Renderer/HTML/HTMLElement.js"],u["Core/Renderer/HTML/HTMLRenderer.js"],u["Core/Axis/Axis.js"],u["Core/Axis/DateTimeAxis.js"],u["Core/Axis/LogarithmicAxis.js"],u["Core/Axis/PlotLineOrBand/PlotLineOrBand.js"],u["Core/Axis/Tick.js"],u["Core/Tooltip.js"],u["Core/Series/Point.js"],u["Core/Pointer.js"],u["Core/MSPointer.js"],u["Core/Legend/Legend.js"],u["Core/Chart/Chart.js"],u["Core/Axis/Stacking/StackingAxis.js"],u["Core/Axis/Stacking/StackItem.js"],u["Core/Series/Series.js"],u["Core/Series/SeriesRegistry.js"],u["Series/Column/ColumnSeries.js"],u["Series/Column/ColumnDataLabel.js"],u["Series/Pie/PieSeries.js"],u["Series/Pie/PieDataLabel.js"],u["Core/Series/DataLabel.js"],u["Core/Responsive.js"],u["Core/Color/Color.js"],u["Core/Time.js"]],function(re,me,Te,Ce,Se,be,ce,ne,K,Y,j,N,R,I,B,P,H,W,ie,te,ee,J,q,D,z,A,U,T,S,O,M,Z,ae,ue,ge){return re.animate=Se.animate,re.animObject=Se.animObject,re.getDeferredAnimation=Se.getDeferredAnimation,re.setAnimation=Se.setAnimation,re.stop=Se.stop,re.timers=Ce.timers,re.AST=be,re.Axis=R,re.Chart=q,re.chart=q.chart,re.Fx=Ce,re.Legend=J,re.PlotLineOrBand=P,re.Point=ie,re.Pointer=ee.isRequired()?ee:te,re.Series=A,re.StackItem=z,re.SVGElement=K,re.SVGRenderer=Y,re.Tick=H,re.Time=ge,re.Tooltip=W,re.Color=ue,re.color=ue.parse,N.compose(Y),j.compose(K),re.defaultOptions=Te.defaultOptions,re.getOptions=Te.getOptions,re.time=Te.defaultTime,re.setOptions=Te.setOptions,re.dateFormat=ce.dateFormat,re.format=ce.format,re.numberFormat=ce.numberFormat,re.addEvent=me.addEvent,re.arrayMax=me.arrayMax,re.arrayMin=me.arrayMin,re.attr=me.attr,re.clearTimeout=me.clearTimeout,re.correctFloat=me.correctFloat,re.createElement=me.createElement,re.css=me.css,re.defined=me.defined,re.destroyObjectProperties=me.destroyObjectProperties,re.discardElement=me.discardElement,re.distribute=ne.distribute,re.erase=me.erase,re.error=me.error,re.extend=me.extend,re.extendClass=me.extendClass,re.find=me.find,re.fireEvent=me.fireEvent,re.getMagnitude=me.getMagnitude,re.getStyle=me.getStyle,re.inArray=me.inArray,re.isArray=me.isArray,re.isClass=me.isClass,re.isDOMElement=me.isDOMElement,re.isFunction=me.isFunction,re.isNumber=me.isNumber,re.isObject=me.isObject,re.isString=me.isString,re.keys=me.keys,re.merge=me.merge,re.normalizeTickInterval=me.normalizeTickInterval,re.objectEach=me.objectEach,re.offset=me.offset,re.pad=me.pad,re.pick=me.pick,re.pInt=me.pInt,re.relativeLength=me.relativeLength,re.removeEvent=me.removeEvent,re.seriesType=U.seriesType,re.splat=me.splat,re.stableSort=me.stableSort,re.syncTimeout=me.syncTimeout,re.timeUnits=me.timeUnits,re.uniqueKey=me.uniqueKey,re.useSerialIds=me.useSerialIds,re.wrap=me.wrap,S.compose(T),Z.compose(A),I.compose(R),B.compose(R),M.compose(O),P.compose(R),ae.compose(q),D.compose(R,q,A),re}),u["masters/highcharts.src.js"]._modules=u,u["masters/highcharts.src.js"]},_s.exports?(Ge.default=Ge,_s.exports=lo.document?Ge(lo):Ge):void 0!==(Mn=function(){return Ge(lo)}.call(la,Is,la,_s))&&(_s.exports=Mn)},761:(_s,la,Is)=>{var Mn,lo,Ge;Ge=function(Ge){function u(re,me,Te,Ce){re.hasOwnProperty(me)||(re[me]=Ce.apply(null,Te),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:me,module:re[me]}})))}u(Ge=Ge?Ge._modules:{},"Extensions/Annotations/AnnotationChart.js",[Ge["Core/Utilities.js"]],function(re){function me(P,H){return P=this.initAnnotation(P),this.options.annotations.push(P.options),N(H,!0)&&(P.redraw(),P.graphic.attr({opacity:1})),P}function Te(){var P=this;P.plotBoxClip=this.renderer.clipRect(this.plotBox),P.controlPointsGroup=P.renderer.g("control-points").attr({zIndex:99}).clip(P.plotBoxClip).add(),P.options.annotations.forEach(function(H,W){if(!P.annotations.some(function(te){return te.options===H})){var ie=P.initAnnotation(H);P.options.annotations[W]=ie.options}}),P.drawAnnotations(),ne(P,"redraw",P.drawAnnotations),ne(P,"destroy",function(){P.plotBoxClip.destroy(),P.controlPointsGroup.destroy()}),ne(P,"exportData",function(H){var W=(this.options.exporting&&this.options.exporting.csv||{}).columnHeaderFormatter,ie=!H.dataRows[1].xValues,te=P.options.lang&&P.options.lang.exportData&&P.options.lang.exportData.annotationHeader,ee=function(S){if(W){var O=W(S);if(!1!==O)return O}return O=te+" "+S,ie?{columnTitle:O,topLevelColumnTitle:O}:O},J=H.dataRows[0].length,q=P.options.exporting&&P.options.exporting.csv&&P.options.exporting.csv.annotations&&P.options.exporting.csv.annotations.itemDelimiter,D=P.options.exporting&&P.options.exporting.csv&&P.options.exporting.csv.annotations&&P.options.exporting.csv.annotations.join;P.annotations.forEach(function(S){S.options.labelOptions&&S.options.labelOptions.includeInDataExport&&S.labels.forEach(function(O){if(O.options.text){var M=O.options.text;O.points.forEach(function(Z){var ae=Z.x,ue=Z.series.xAxis?Z.series.xAxis.options.index:-1,ge=!1;if(-1===ue){Z=H.dataRows[0].length;for(var V=Array(Z),$=0;$<Z;++$)V[$]="";V.push(M),V.xValues=[],V.xValues[ue]=ae,H.dataRows.push(V),ge=!0}if(ge||H.dataRows.forEach(function(de){!ge&&de.xValues&&void 0!==ue&&ae===de.xValues[ue]&&(D&&de.length>J?de[de.length-1]+=q+M:de.push(M),ge=!0)}),!ge){for(Z=H.dataRows[0].length,V=Array(Z),$=0;$<Z;++$)V[$]="";V[0]=ae,V.push(M),V.xValues=[],void 0!==ue&&(V.xValues[ue]=ae),H.dataRows.push(V)}})}})});var z=0;H.dataRows.forEach(function(S){z=Math.max(z,S.length)});for(var A=z-H.dataRows[0].length,U=0;U<A;U++){var T=ee(U+1);ie?(H.dataRows[0].push(T.topLevelColumnTitle),H.dataRows[1].push(T.columnTitle)):H.dataRows[0].push(T)}})}function Ce(){this.plotBoxClip.attr(this.plotBox),this.annotations.forEach(function(P){P.redraw(),P.graphic.animate({opacity:1},P.animationConfig)})}function Se(P){var H=this.annotations,W="annotations"===P.coll?P:Y(H,function(ie){return ie.options.id===P});W&&(j(W,"remove"),K(this.options.annotations,W.options),K(H,W),W.destroy())}function be(){this.annotations=[],this.options.annotations||(this.options.annotations=[])}function ce(P){this.chart.hasDraggedAnnotation||P.apply(this,Array.prototype.slice.call(arguments,1))}var B,ne=re.addEvent,K=re.erase,Y=re.find,j=re.fireEvent,N=re.pick,R=re.wrap,I=[];return(B||(B={})).compose=function(H,W,ie){-1===I.indexOf(W)&&(I.push(W),ne(W,"afterInit",be),(W=W.prototype).addAnnotation=me,W.callbacks.push(Te),W.collectionsWithInit.annotations=[me],W.collectionsWithUpdate.push("annotations"),W.drawAnnotations=Ce,W.removeAnnotation=Se,W.initAnnotation=function(te){return te=new(H.types[te.type]||H)(this,te),this.annotations.push(te),te}),-1===I.indexOf(ie)&&(I.push(ie),R(ie.prototype,"onContainerMouseDown",ce))},B}),u(Ge,"Extensions/Annotations/AnnotationDefaults.js",[Ge["Core/Utilities.js"]],function(re){var me=re.defined;return{visible:!0,animation:{},crop:!0,draggable:"xy",labelOptions:{align:"center",allowOverlap:!1,backgroundColor:"rgba(0, 0, 0, 0.75)",borderColor:"#000000",borderRadius:3,borderWidth:1,className:"highcharts-no-tooltip",crop:!1,formatter:function(){return me(this.y)?""+this.y:"Annotation label"},includeInDataExport:!0,overflow:"justify",padding:5,shadow:!1,shape:"callout",style:{fontSize:"11px",fontWeight:"normal",color:"contrast"},useHTML:!1,verticalAlign:"bottom",x:0,y:-16},shapeOptions:{stroke:"rgba(0, 0, 0, 0.75)",strokeWidth:1,fill:"rgba(0, 0, 0, 0.75)",r:0,snap:2},controlPointOptions:{symbol:"circle",width:10,height:10,style:{cursor:"pointer",fill:"#ffffff",stroke:"#000000","stroke-width":2},visible:!1,events:{}},events:{},zIndex:6}}),u(Ge,"Extensions/Annotations/EventEmitter.js",[Ge["Core/Globals.js"],Ge["Core/Utilities.js"]],function(re,me){var Te=re.doc,Ce=re.isTouchDevice,Se=me.addEvent,be=me.fireEvent,ce=me.objectEach,ne=me.pick,K=me.removeEvent;return function(){function Y(){}return Y.prototype.addEvents=function(){var j=this,N=function(I){Se(I,Ce?"touchstart":"mousedown",function(B){j.onMouseDown(B)},{passive:!1})};if(N(this.graphic.element),(j.labels||[]).forEach(function(I){I.options.useHTML&&I.graphic.text&&N(I.graphic.text.element)}),ce(j.options.events,function(I,B){var P=function(H){"click"===B&&j.cancelClick||I.call(j,j.chart.pointer.normalize(H),j.target)};-1===(j.nonDOMEvents||[]).indexOf(B)?j.graphic.on(B,P):Se(j,B,P,{passive:!1})}),j.options.draggable&&(Se(j,"drag",j.onDrag),!j.graphic.renderer.styledMode)){var R={cursor:{x:"ew-resize",y:"ns-resize",xy:"move"}[j.options.draggable]};j.graphic.css(R),(j.labels||[]).forEach(function(I){I.options.useHTML&&I.graphic.text&&I.graphic.text.css(R)})}j.isUpdating||be(j,"add")},Y.prototype.destroy=function(){this.removeDocEvents(),K(this),this.hcEvents=null},Y.prototype.mouseMoveToRadians=function(j,N,R){var I=j.prevChartY-R,B=j.prevChartX-N;return R=j.chartY-R,j=j.chartX-N,this.chart.inverted&&(N=B,B=I,I=N,N=j,j=R,R=N),Math.atan2(R,j)-Math.atan2(I,B)},Y.prototype.mouseMoveToScale=function(j,N,R){return N=(j.chartX-N||1)/(j.prevChartX-N||1),j=(j.chartY-R||1)/(j.prevChartY-R||1),this.chart.inverted&&(R=j,j=N,N=R),{x:N,y:j}},Y.prototype.mouseMoveToTranslation=function(j){var N=j.chartX-j.prevChartX;if(j=j.chartY-j.prevChartY,this.chart.inverted){var R=j;j=N,N=R}return{x:N,y:j}},Y.prototype.onDrag=function(j){if(this.chart.isInsidePlot(j.chartX-this.chart.plotLeft,j.chartY-this.chart.plotTop,{visiblePlotOnly:!0})){var N=this.mouseMoveToTranslation(j);"x"===this.options.draggable&&(N.y=0),"y"===this.options.draggable&&(N.x=0),this.points.length?this.translate(N.x,N.y):(this.shapes.forEach(function(R){return R.translate(N.x,N.y)}),this.labels.forEach(function(R){return R.translate(N.x,N.y)})),this.redraw(!1)}},Y.prototype.onMouseDown=function(j){if(j.preventDefault&&j.preventDefault(),2!==j.button){var N=this,R=N.chart.pointer,I=(j=R.normalize(j)).chartX,B=j.chartY;N.cancelClick=!1,N.chart.hasDraggedAnnotation=!0,N.removeDrag=Se(Te,Ce?"touchmove":"mousemove",function(P){N.hasDragged=!0,(P=R.normalize(P)).prevChartX=I,P.prevChartY=B,be(N,"drag",P),I=P.chartX,B=P.chartY},Ce?{passive:!1}:void 0),N.removeMouseUp=Se(Te,Ce?"touchend":"mouseup",function(P){var H=ne(N.target&&N.target.annotation,N.target);H&&(H.cancelClick=N.hasDragged),N.cancelClick=N.hasDragged,N.hasDragged=!1,N.chart.hasDraggedAnnotation=!1,be(ne(H,N),"afterUpdate"),N.onMouseUp(P)},Ce?{passive:!1}:void 0)}},Y.prototype.onMouseUp=function(j){var N=this.chart,R=N.options.annotations;N=N.annotations.indexOf(j=this.target||this),this.removeDocEvents(),R[N]=j.options},Y.prototype.removeDocEvents=function(){this.removeDrag&&(this.removeDrag=this.removeDrag()),this.removeMouseUp&&(this.removeMouseUp=this.removeMouseUp())},Y}()}),u(Ge,"Extensions/Annotations/ControlPoint.js",[Ge["Extensions/Annotations/EventEmitter.js"],Ge["Core/Utilities.js"]],function(re,me){var be,Te=this&&this.__extends||(be=function(ce,ne){return(be=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(K,Y){K.__proto__=Y}||function(K,Y){for(var j in Y)Y.hasOwnProperty(j)&&(K[j]=Y[j])})(ce,ne)},function(ce,ne){function K(){this.constructor=ce}be(ce,ne),ce.prototype=null===ne?Object.create(ne):(K.prototype=ne.prototype,new K)}),Ce=me.merge,Se=me.pick;return re=function(be){function ce(ne,K,Y,j){var N=be.call(this)||this;return N.graphic=void 0,N.nonDOMEvents=["drag"],N.chart=ne,N.target=K,N.options=Y,N.index=Se(Y.index,j),N}return Te(ce,be),ce.prototype.destroy=function(){be.prototype.destroy.call(this),this.graphic&&(this.graphic=this.graphic.destroy()),this.options=this.target=this.chart=null},ce.prototype.redraw=function(ne){this.graphic[ne?"animate":"attr"](this.options.positioner.call(this,this.target))},ce.prototype.render=function(){var ne=this.chart,K=this.options;this.graphic=ne.renderer.symbol(K.symbol,0,0,K.width,K.height).add(ne.controlPointsGroup).css(K.style),this.setVisibility(K.visible),this.addEvents()},ce.prototype.setVisibility=function(ne){this.graphic[ne?"show":"hide"](),this.options.visible=ne},ce.prototype.update=function(ne){var K=this.chart,Y=this.target,j=this.index;ne=Ce(!0,this.options,ne),this.destroy(),this.constructor(K,Y,ne,j),this.render(K.controlPointsGroup),this.redraw()},ce}(re),re}),u(Ge,"Extensions/Annotations/MockPoint.js",[Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"]],function(re,me){var Te=re.series.prototype,Ce=me.defined,Se=me.fireEvent;return function(){function be(ce,ne,K){this.plotY=this.plotX=void 0,this.mock=!0,this.series={visible:!0,chart:ce,getPlotBox:Te.getPlotBox},this.target=ne||null,this.options=K,this.applyOptions(this.getOptions())}return be.fromPoint=function(ce){return new be(ce.series.chart,null,{x:ce.x,y:ce.y,xAxis:ce.series.xAxis,yAxis:ce.series.yAxis})},be.pointToPixels=function(ce,ne){var K=ce.series,Y=K.chart,j=ce.plotX||0,N=ce.plotY||0;return Y.inverted&&(ce.mock?(j=ce.plotY,N=ce.plotX):(j=Y.plotWidth-(ce.plotY||0),N=Y.plotHeight-(ce.plotX||0))),K&&!ne&&(j+=(ce=K.getPlotBox()).translateX,N+=ce.translateY),{x:j,y:N}},be.pointToOptions=function(ce){return{x:ce.x,y:ce.y,xAxis:ce.series.xAxis,yAxis:ce.series.yAxis}},be.prototype.applyOptions=function(ce){this.command=ce.command,this.setAxis(ce,"x"),this.setAxis(ce,"y"),this.refresh()},be.prototype.getLabelConfig=function(){return{x:this.x,y:this.y,point:this}},be.prototype.getOptions=function(){return this.hasDynamicOptions()?this.options(this.target):this.options},be.prototype.hasDynamicOptions=function(){return"function"==typeof this.options},be.prototype.isInsidePlot=function(){var ce=this.plotX,ne=this.plotY,K=this.series.xAxis,Y=this.series.yAxis,j={x:ce,y:ne,isInsidePlot:!0};return K&&(j.isInsidePlot=Ce(ce)&&0<=ce&&ce<=K.len),Y&&(j.isInsidePlot=j.isInsidePlot&&Ce(ne)&&0<=ne&&ne<=Y.len),Se(this.series.chart,"afterIsInsidePlot",j),j.isInsidePlot},be.prototype.refresh=function(){var ce=this.series,ne=ce.xAxis;ce=ce.yAxis;var K=this.getOptions();ne?(this.x=K.x,this.plotX=ne.toPixels(K.x,!0)):(this.x=void 0,this.plotX=K.x),ce?(this.y=K.y,this.plotY=ce.toPixels(K.y,!0)):(this.y=null,this.plotY=K.y),this.isInside=this.isInsidePlot()},be.prototype.refreshOptions=function(){var ce=this.series,ne=ce.xAxis;ce=ce.yAxis,this.x=this.options.x=ne?this.options.x=ne.toValue(this.plotX,!0):this.plotX,this.y=this.options.y=ce?ce.toValue(this.plotY,!0):this.plotY},be.prototype.rotate=function(ce,ne,K){if(!this.hasDynamicOptions()){var Y=Math.cos(K);K=Math.sin(K);var j=this.plotX-ce,N=this.plotY-ne;this.plotX=j*Y-N*K+ce,this.plotY=j*K+N*Y+ne,this.refreshOptions()}},be.prototype.scale=function(ce,ne,K,Y){if(!this.hasDynamicOptions()){var j=this.plotY*Y;this.plotX=(1-K)*ce+this.plotX*K,this.plotY=(1-Y)*ne+j,this.refreshOptions()}},be.prototype.setAxis=function(ce,ne){var K=this.series.chart;this.series[ne+="Axis"]="object"==typeof(ce=ce[ne])?ce:Ce(ce)?K[ne][ce]||K.get(ce):null},be.prototype.toAnchor=function(){var ce=[this.plotX,this.plotY,0,0];return this.series.chart.inverted&&(ce[0]=this.plotY,ce[1]=this.plotX),ce},be.prototype.translate=function(ce,ne,K,Y){this.hasDynamicOptions()||(this.plotX+=K,this.plotY+=Y,this.refreshOptions())},be}()}),u(Ge,"Extensions/Annotations/Controllables/Controllable.js",[Ge["Extensions/Annotations/ControlPoint.js"],Ge["Extensions/Annotations/MockPoint.js"],Ge["Core/Tooltip.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce){var Se=Ce.isObject,be=Ce.isString,ce=Ce.merge,ne=Ce.splat;return Ce=function(){function K(Y,j,N,R){this.graphic=void 0,this.annotation=Y,this.chart=Y.chart,this.collection="label"===R?"labels":"shapes",this.options=j,this.points=[],this.controlPoints=[],this.index=N,this.itemType=R,this.init(Y,j,N)}return K.prototype.addControlPoints=function(){var Y=this,j=this.controlPoints,N=this.options.controlPoints||[];N.forEach(function(R,I){(R=ce(Y.options.controlPointOptions,R)).index||(R.index=I),N[I]=R,j.push(new re(Y.chart,Y,R))})},K.prototype.anchor=function(Y){var j=Y.series.getPlotBox(),N=Y.series.chart,R=Y.mock?Y.toAnchor():Te.prototype.getAnchor.call({chart:Y.series.chart},Y);return{relativePosition:R={x:R[0]+(this.options.x||0),y:R[1]+(this.options.y||0),height:R[2]||0,width:R[3]||0},absolutePosition:ce(R,{x:R.x+(Y.mock?j.translateX:N.plotLeft),y:R.y+(Y.mock?j.translateY:N.plotTop)})}},K.prototype.attr=function(){for(var Y=0;Y<arguments.length;Y++);this.graphic.attr.apply(this.graphic,arguments)},K.prototype.attrsFromOptions=function(Y){var I,j=this.constructor.attrsMap,N={},R=this.chart.styledMode;for(I in Y){var B=j[I];typeof j[I]>"u"||R&&-1!==["fill","stroke","stroke-width"].indexOf(B)||(N[B]=Y[I])}return N},K.prototype.destroy=function(){this.graphic&&(this.graphic=this.graphic.destroy()),this.tracker&&(this.tracker=this.tracker.destroy()),this.controlPoints.forEach(function(Y){return Y.destroy()}),this.options=this.controlPoints=this.points=this.chart=null,this.annotation&&(this.annotation=null)},K.prototype.getPointsOptions=function(){var Y=this.options;return Y.points||Y.point&&ne(Y.point)},K.prototype.init=function(Y,j,N){this.annotation=Y,this.chart=Y.chart,this.options=j,this.points=[],this.controlPoints=[],this.index=N,this.linkPoints(),this.addControlPoints()},K.prototype.linkPoints=function(){var R,Y=this.getPointsOptions(),j=this.points,N=Y&&Y.length||0;for(R=0;R<N;R++){var I=this.point(Y[R],j[R]);if(!I)return void(j.length=0);I.mock&&I.refresh(),j[R]=I}return j},K.prototype.point=function(Y,j){return Y&&Y.series?Y:(j&&null!==j.series||(Se(Y)?j=new me(this.chart,this,Y):be(Y)?j=this.chart.get(Y)||null:"function"==typeof Y&&(j=(j=Y.call(j,this)).series?j:new me(this.chart,this,Y))),j)},K.prototype.render=function(Y){this.controlPoints.forEach(function(j){return j.render()})},K.prototype.redraw=function(Y){this.controlPoints.forEach(function(j){return j.redraw(Y)})},K.prototype.rotate=function(Y,j,N){this.transform("rotate",Y,j,N)},K.prototype.scale=function(Y,j,N,R){this.transform("scale",Y,j,N,R)},K.prototype.setControlPointsVisibility=function(Y){this.controlPoints.forEach(function(j){j.setVisibility(Y)})},K.prototype.shouldBeDrawn=function(){return!!this.points.length},K.prototype.transform=function(Y,j,N,R,I){var B=this;if(this.chart.inverted){var P=j;j=N,N=P}this.points.forEach(function(H,W){return B.transformPoint(Y,j,N,R,I,W)},this)},K.prototype.transformPoint=function(Y,j,N,R,I,B){var P=this.points[B];P.mock||(P=this.points[B]=me.fromPoint(P)),P[Y](j,N,R,I)},K.prototype.translate=function(Y,j){this.transform("translate",null,null,Y,j)},K.prototype.translatePoint=function(Y,j,N){this.transformPoint("translate",null,null,Y,j,N)},K.prototype.translateShape=function(Y,j,N){var R=this.annotation.chart,I=this.annotation.userOptions,B=R.annotations.indexOf(this.annotation);R=R.options.annotations[B],this.translatePoint(Y,j,0),N&&this.translatePoint(Y,j,1),R[this.collection][this.index].point=this.options.point,I[this.collection][this.index].point=this.options.point},K.prototype.update=function(Y){var j=this.annotation;Y=ce(!0,this.options,Y);var N=this.graphic.parentGroup;this.destroy(),this.constructor(j,Y,this.index,this.itemType),this.render(N),this.redraw()},K}(),Ce}),u(Ge,"Extensions/Annotations/Controllables/ControllableDefaults.js",[],function(){return{defaultMarkers:{arrow:{tagName:"marker",attributes:{id:"arrow",refY:5,refX:9,markerWidth:10,markerHeight:10},children:[{tagName:"path",attributes:{d:"M 0 0 L 10 5 L 0 10 Z","stroke-width":0}}]},"reverse-arrow":{tagName:"marker",attributes:{id:"reverse-arrow",refY:5,refX:1,markerWidth:10,markerHeight:10},children:[{tagName:"path",attributes:{d:"M 0 5 L 10 0 L 10 10 Z","stroke-width":0}}]}}}}),u(Ge,"Extensions/Annotations/Controllables/ControllablePath.js",[Ge["Extensions/Annotations/Controllables/Controllable.js"],Ge["Extensions/Annotations/Controllables/ControllableDefaults.js"],Ge["Core/Globals.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce){function Se(ie){return function(te){this.attr(ie,"url(#"+te+")")}}function be(){this.options.defs=R(K,this.options.defs||{})}function ce(ie,te){var ee={attributes:{id:ie}},J={stroke:te.color||"none",fill:te.color||"rgba(0, 0, 0, 0.75)"};return ee.children=te.children&&te.children.map(function(q){return R(J,q)}),te=R(!0,{attributes:{markerWidth:20,markerHeight:20,refX:0,refY:0,orient:"auto"}},te,ee),(te=this.definition(te)).id=ie,te}var ie,ne=this&&this.__extends||(ie=function(te,ee){return(ie=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(J,q){J.__proto__=q}||function(J,q){for(var D in q)q.hasOwnProperty(D)&&(J[D]=q[D])})(te,ee)},function(te,ee){function J(){this.constructor=te}ie(te,ee),te.prototype=null===ee?Object.create(ee):(J.prototype=ee.prototype,new J)}),K=me.defaultMarkers,Y=Ce.addEvent,j=Ce.defined,N=Ce.extend,R=Ce.merge,I=Ce.uniqueKey,B=[],P=Se("marker-end"),H=Se("marker-start"),W="rgba(192,192,192,"+(Te.svg?1e-4:.002)+")";return function(ie){function te(ee,J,q){return(ee=ie.call(this,ee,J,q,"shape")||this).type="path",ee}return ne(te,ie),te.compose=function(ee,J){-1===B.indexOf(ee)&&(B.push(ee),Y(ee,"afterGetContainer",be)),-1===B.indexOf(J)&&(B.push(J),J.prototype.addMarker=ce)},te.prototype.toD=function(){var ee=this.options.d;if(ee)return"function"==typeof ee?ee.call(this):ee;var J=(ee=this.points).length,q=[],D=J,z=ee[0],A=D&&this.anchor(z).absolutePosition,U=0;if(A)for(q.push(["M",A.x,A.y]);++U<J&&D;)D=(z=ee[U]).command||"L",A=this.anchor(z).absolutePosition,"M"===D||"L"===D?q.push([D,A.x,A.y]):"Z"===D&&q.push([D]),D=z.series.visible;return D&&this.graphic?this.chart.renderer.crispLine(q,this.graphic.strokeWidth()):null},te.prototype.shouldBeDrawn=function(){return ie.prototype.shouldBeDrawn.call(this)||!!this.options.d},te.prototype.render=function(ee){var J=this.options,q=this.attrsFromOptions(J);this.graphic=this.annotation.chart.renderer.path([["M",0,0]]).attr(q).add(ee),J.className&&this.graphic.addClass(J.className),this.tracker=this.annotation.chart.renderer.path([["M",0,0]]).addClass("highcharts-tracker-line").attr({zIndex:2}).add(ee),this.annotation.chart.styledMode||this.tracker.attr({"stroke-linejoin":"round",stroke:W,fill:W,"stroke-width":this.graphic.strokeWidth()+2*J.snap}),ie.prototype.render.call(this),N(this.graphic,{markerStartSetter:H,markerEndSetter:P}),this.setMarkers(this)},te.prototype.redraw=function(ee){if(this.graphic){var J=this.toD(),q=ee?"animate":"attr";J?(this.graphic[q]({d:J}),this.tracker[q]({d:J})):(this.graphic.attr({d:"M 0 -9000000000"}),this.tracker.attr({d:"M 0 -9000000000"})),this.graphic.placed=this.tracker.placed=!!J}ie.prototype.redraw.call(this,ee)},te.prototype.setMarkers=function(ee){var J=ee.options,q=ee.chart,D=q.options.defs,z=J.fill,A=j(z)&&"none"!==z?z:J.stroke;["markerStart","markerEnd"].forEach(function(U){var S,T=J[U];if(T){for(S in D){var O=D[S];if((T===(O.attributes&&O.attributes.id)||T===O.id)&&"marker"===O.tagName){var M=O;break}}M&&(T=ee[U]=q.renderer.addMarker((J.id||I())+"-"+T,R(M,{color:A})),ee.attr(U,T.getAttribute("id")))}})},te.attrsMap={dashStyle:"dashstyle",strokeWidth:"stroke-width",stroke:"stroke",fill:"fill",zIndex:"zIndex"},te}(re)}),u(Ge,"Extensions/Annotations/Controllables/ControllableRect.js",[Ge["Extensions/Annotations/Controllables/Controllable.js"],Ge["Extensions/Annotations/Controllables/ControllablePath.js"],Ge["Core/Utilities.js"]],function(re,me,Te){var be,Ce=this&&this.__extends||(be=function(ce,ne){return(be=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(K,Y){K.__proto__=Y}||function(K,Y){for(var j in Y)Y.hasOwnProperty(j)&&(K[j]=Y[j])})(ce,ne)},function(ce,ne){function K(){this.constructor=ce}be(ce,ne),ce.prototype=null===ne?Object.create(ne):(K.prototype=ne.prototype,new K)}),Se=Te.merge;return function(be){function ce(ne,K,Y){return(ne=be.call(this,ne,K,Y,"shape")||this).type="rect",ne.translate=be.prototype.translateShape,ne}return Ce(ce,be),ce.prototype.render=function(ne){var K=this.attrsFromOptions(this.options);this.graphic=this.annotation.chart.renderer.rect(0,-9e9,0,0).attr(K).add(ne),be.prototype.render.call(this)},ce.prototype.redraw=function(ne){if(this.graphic){var K=this.anchor(this.points[0]).absolutePosition;K?this.graphic[ne?"animate":"attr"]({x:K.x,y:K.y,width:this.options.width,height:this.options.height}):this.attr({x:0,y:-9e9}),this.graphic.placed=!!K}be.prototype.redraw.call(this,ne)},ce.attrsMap=Se(me.attrsMap,{width:"width",height:"height"}),ce}(re)}),u(Ge,"Extensions/Annotations/Controllables/ControllableCircle.js",[Ge["Extensions/Annotations/Controllables/Controllable.js"],Ge["Extensions/Annotations/Controllables/ControllablePath.js"],Ge["Core/Utilities.js"]],function(re,me,Te){var be,Ce=this&&this.__extends||(be=function(ce,ne){return(be=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(K,Y){K.__proto__=Y}||function(K,Y){for(var j in Y)Y.hasOwnProperty(j)&&(K[j]=Y[j])})(ce,ne)},function(ce,ne){function K(){this.constructor=ce}be(ce,ne),ce.prototype=null===ne?Object.create(ne):(K.prototype=ne.prototype,new K)}),Se=Te.merge;return function(be){function ce(ne,K,Y){return(ne=be.call(this,ne,K,Y,"shape")||this).type="circle",ne.translate=be.prototype.translateShape,ne}return Ce(ce,be),ce.prototype.redraw=function(ne){if(this.graphic){var K=this.anchor(this.points[0]).absolutePosition;K?this.graphic[ne?"animate":"attr"]({x:K.x,y:K.y,r:this.options.r}):this.graphic.attr({x:0,y:-9e9}),this.graphic.placed=!!K}be.prototype.redraw.call(this,ne)},ce.prototype.render=function(ne){var K=this.attrsFromOptions(this.options);this.graphic=this.annotation.chart.renderer.circle(0,-9e9,0).attr(K).add(ne),be.prototype.render.call(this)},ce.prototype.setRadius=function(ne){this.options.r=ne},ce.attrsMap=Se(me.attrsMap,{r:"r"}),ce}(re)}),u(Ge,"Extensions/Annotations/Controllables/ControllableEllipse.js",[Ge["Extensions/Annotations/Controllables/Controllable.js"],Ge["Extensions/Annotations/Controllables/ControllablePath.js"],Ge["Core/Utilities.js"]],function(re,me,Te){var ce,Ce=this&&this.__extends||(ce=function(ne,K){return(ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Y,j){Y.__proto__=j}||function(Y,j){for(var N in j)j.hasOwnProperty(N)&&(Y[N]=j[N])})(ne,K)},function(ne,K){function Y(){this.constructor=ne}ce(ne,K),ne.prototype=null===K?Object.create(K):(Y.prototype=K.prototype,new Y)}),Se=Te.merge,be=Te.defined;return function(ce){function ne(K,Y,j){return(K=ce.call(this,K,Y,j,"shape")||this).type="ellipse",K}return Ce(ne,ce),ne.prototype.init=function(K,Y,j){be(Y.yAxis)&&Y.points.forEach(function(N){N.yAxis=Y.yAxis}),be(Y.xAxis)&&Y.points.forEach(function(N){N.xAxis=Y.xAxis}),ce.prototype.init.call(this,K,Y,j)},ne.prototype.render=function(K){this.graphic=this.annotation.chart.renderer.createElement("ellipse").attr(this.attrsFromOptions(this.options)).add(K),ce.prototype.render.call(this)},ne.prototype.translate=function(K,Y){ce.prototype.translateShape.call(this,K,Y,!0)},ne.prototype.getDistanceFromLine=function(K,Y,j,N){return Math.abs((Y.y-K.y)*j-(Y.x-K.x)*N+Y.x*K.y-Y.y*K.x)/Math.sqrt((Y.y-K.y)*(Y.y-K.y)+(Y.x-K.x)*(Y.x-K.x))},ne.prototype.getAttrs=function(K,Y){var j=K.x,N=K.y,R=Y.x,I=Y.y;Y=(j+R)/2,K=(N+I)/2;var B=Math.sqrt((j-R)*(j-R)/4+(N-I)*(N-I)/4);return N=180*Math.atan((I-N)/(R-j))/Math.PI,Y<j&&(N+=180),{cx:Y,cy:K,rx:B,ry:j=this.getRY(),angle:N}},ne.prototype.getRY=function(){var K=this.getYAxis();return be(K)?Math.abs(K.toPixels(this.options.ry)-K.toPixels(0)):this.options.ry},ne.prototype.getYAxis=function(){return this.chart.yAxis[this.options.yAxis]},ne.prototype.getAbsolutePosition=function(K){return this.anchor(K).absolutePosition},ne.prototype.redraw=function(K){if(this.graphic){var Y=this.getAbsolutePosition(this.points[0]),j=this.getAbsolutePosition(this.points[1]);j=this.getAttrs(Y,j),Y?this.graphic[K?"animate":"attr"]({cx:j.cx,cy:j.cy,rx:j.rx,ry:j.ry,rotation:j.angle,rotationOriginX:j.cx,rotationOriginY:j.cy}):this.graphic.attr({x:0,y:-9e9}),this.graphic.placed=!!Y}ce.prototype.redraw.call(this,K)},ne.prototype.setYRadius=function(K){var Y=this.annotation.userOptions.shapes;this.options.ry=K,Y&&Y[0]&&(Y[0].ry=K,Y[0].ry=K)},ne.attrsMap=Se(me.attrsMap,{ry:"ry"}),ne}(re)}),u(Ge,"Extensions/Annotations/Controllables/ControllableLabel.js",[Ge["Extensions/Annotations/Controllables/Controllable.js"],Ge["Core/FormatUtilities.js"],Ge["Extensions/Annotations/MockPoint.js"],Ge["Core/Tooltip.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce,Se){function be(R,I,B,P,H){var W=H&&H.anchorX;H=H&&H.anchorY;var ie=B/2;if(Y(W)&&Y(H)){var te=[["M",W,H]],ee=I-H;0>ee&&(ee=-P-ee),ee<B&&(ie=W<R+B/2?ee:B-ee),H>I+P?te.push(["L",R+ie,I+P]):H<I?te.push(["L",R+ie,I]):W<R?te.push(["L",R,I+P/2]):W>R+B&&te.push(["L",R+B,I+P/2])}return te||[]}var R,ce=this&&this.__extends||(R=function(I,B){return(R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,H){P.__proto__=H}||function(P,H){for(var W in H)H.hasOwnProperty(W)&&(P[W]=H[W])})(I,B)},function(I,B){function P(){this.constructor=I}R(I,B),I.prototype=null===B?Object.create(B):(P.prototype=B.prototype,new P)}),ne=me.format,K=Se.extend,Y=Se.isNumber,j=Se.pick,N=[];return function(R){function I(B,P,H){return R.call(this,B,P,H,"label")||this}return ce(I,R),I.alignedPosition=function(B,P){var ee,J,H=B.align,W=B.verticalAlign,ie=(P.x||0)+(B.x||0),te=(P.y||0)+(B.y||0);return"right"===H?ee=1:"center"===H&&(ee=2),ee&&(ie+=(P.width-(B.width||0))/ee),"bottom"===W?J=1:"middle"===W&&(J=2),J&&(te+=(P.height-(B.height||0))/J),{x:Math.round(ie),y:Math.round(te)}},I.compose=function(B){-1===N.indexOf(B)&&(N.push(B),B.prototype.symbols.connector=be)},I.justifiedOptions=function(B,P,H,W){var ie=H.align,te=H.verticalAlign,ee=P.box?0:P.padding||0,J=P.getBBox();P={align:ie,verticalAlign:te,x:H.x,y:H.y,width:P.width,height:P.height},H=(W.x||0)-B.plotLeft,W=(W.y||0)-B.plotTop;var q=H+ee;return 0>q&&("right"===ie?P.align="left":P.x=(P.x||0)-q),(q=H+J.width-ee)>B.plotWidth&&("left"===ie?P.align="right":P.x=(P.x||0)+B.plotWidth-q),0>(q=W+ee)&&("bottom"===te?P.verticalAlign="top":P.y=(P.y||0)-q),(q=W+J.height-ee)>B.plotHeight&&("top"===te?P.verticalAlign="bottom":P.y=(P.y||0)+B.plotHeight-q),P},I.prototype.translatePoint=function(B,P){R.prototype.translatePoint.call(this,B,P,0)},I.prototype.translate=function(B,P){var H=this.annotation.chart,W=this.annotation.userOptions,ie=H.annotations.indexOf(this.annotation);ie=H.options.annotations[ie],H.inverted&&(H=B,B=P,P=H),this.options.x+=B,this.options.y+=P,ie[this.collection][this.index].x=this.options.x,ie[this.collection][this.index].y=this.options.y,W[this.collection][this.index].x=this.options.x,W[this.collection][this.index].y=this.options.y},I.prototype.render=function(B){var P=this.options,H=this.attrsFromOptions(P),W=P.style;this.graphic=this.annotation.chart.renderer.label("",0,-9999,P.shape,null,null,P.useHTML,null,"annotation-label").attr(H).add(B),this.annotation.chart.styledMode||("contrast"===W.color&&(W.color=this.annotation.chart.renderer.getContrast(-1<I.shapesWithoutBackground.indexOf(P.shape)?"#FFFFFF":P.backgroundColor)),this.graphic.css(P.style).shadow(P.shadow)),P.className&&this.graphic.addClass(P.className),this.graphic.labelrank=P.labelrank,R.prototype.render.call(this)},I.prototype.redraw=function(B){var P=this.options,H=this.text||P.format||P.text,W=this.graphic,ie=this.points[0];W?(W.attr({text:H?ne(String(H),ie.getLabelConfig(),this.annotation.chart):P.formatter.call(ie,this)}),P=this.anchor(ie),(H=this.position(P))?(W.alignAttr=H,H.anchorX=P.absolutePosition.x,H.anchorY=P.absolutePosition.y,W[B?"animate":"attr"](H)):W.attr({x:0,y:-9999}),W.placed=!!H,R.prototype.redraw.call(this,B)):this.redraw(B)},I.prototype.anchor=function(B){var P=R.prototype.anchor.apply(this,arguments),H=this.options.x||0,W=this.options.y||0;return P.absolutePosition.x-=H,P.absolutePosition.y-=W,P.relativePosition.x-=H,P.relativePosition.y-=W,P},I.prototype.position=function(B){var P=this.graphic,H=this.annotation.chart,W=this.points[0],ie=this.options,te=B.absolutePosition,ee=B.relativePosition,J=W.series.visible&&Te.prototype.isInsidePlot.call(W);if(P&&J){var q=P.width;B=void 0===q?0:q;var D=void 0===(q=P.height)?0:q;ie.distance?q=Ce.prototype.getPosition.call({chart:H,distance:j(ie.distance,16)},B,D,{plotX:ee.x,plotY:ee.y,negative:W.negative,ttBelow:W.ttBelow,h:ee.height||ee.width}):ie.positioner?q=ie.positioner.call(this):(W={x:te.x,y:te.y,width:0,height:0},q=I.alignedPosition(K(ie,{width:B,height:D}),W),"justify"===this.options.overflow&&(q=I.alignedPosition(I.justifiedOptions(H,P,ie,q),W))),ie.crop&&(J=H.isInsidePlot(P=q.x-H.plotLeft,ie=q.y-H.plotTop)&&H.isInsidePlot(P+B,ie+D))}return J?q:null},I.attrsMap={backgroundColor:"fill",borderColor:"stroke",borderWidth:"stroke-width",zIndex:"zIndex",borderRadius:"r",padding:"padding"},I.shapesWithoutBackground=["connector"],I}(re)}),u(Ge,"Extensions/Annotations/Controllables/ControllableImage.js",[Ge["Extensions/Annotations/Controllables/Controllable.js"],Ge["Extensions/Annotations/Controllables/ControllableLabel.js"]],function(re,me){var Ce,Te=this&&this.__extends||(Ce=function(Se,be){return(Ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ce,ne){ce.__proto__=ne}||function(ce,ne){for(var K in ne)ne.hasOwnProperty(K)&&(ce[K]=ne[K])})(Se,be)},function(Se,be){function ce(){this.constructor=Se}Ce(Se,be),Se.prototype=null===be?Object.create(be):(ce.prototype=be.prototype,new ce)});return function(Ce){function Se(be,ce,ne){return(be=Ce.call(this,be,ce,ne,"shape")||this).type="image",be.translate=Ce.prototype.translateShape,be}return Te(Se,Ce),Se.prototype.render=function(be){var ce=this.attrsFromOptions(this.options),ne=this.options;this.graphic=this.annotation.chart.renderer.image(ne.src,0,-9e9,ne.width,ne.height).attr(ce).add(be),this.graphic.width=ne.width,this.graphic.height=ne.height,Ce.prototype.render.call(this)},Se.prototype.redraw=function(be){if(this.graphic){var ce=this.anchor(this.points[0]);(ce=me.prototype.position.call(this,ce))?this.graphic[be?"animate":"attr"]({x:ce.x,y:ce.y}):this.graphic.attr({x:0,y:-9e9}),this.graphic.placed=!!ce}Ce.prototype.redraw.call(this,be)},Se.attrsMap={width:"width",height:"height",zIndex:"zIndex"},Se}(re)}),u(Ge,"Core/Chart/ChartNavigationComposition.js",[],function(){var re;return function(me){me.compose=function(Ce){return Ce.navigation||(Ce.navigation=new Te(Ce)),Ce};var Te=function(){function Ce(Se){this.updates=[],this.chart=Se}return Ce.prototype.addUpdate=function(Se){this.chart.navigation.updates.push(Se)},Ce.prototype.update=function(Se,be){var ce=this;this.updates.forEach(function(ne){ne.call(ce.chart,Se,be)})},Ce}();me.Additions=Te}(re||(re={})),re}),u(Ge,"Extensions/Annotations/NavigationBindingsUtilities.js",[Ge["Core/Utilities.js"]],function(re){var me=re.defined,Te=re.isNumber,Ce=re.pick,Se={backgroundColor:"string",borderColor:"string",borderRadius:"string",color:"string",fill:"string",fontSize:"string",labels:"string",name:"string",stroke:"string",title:"string"};return{annotationsFieldsTypes:Se,getAssignedAxis:function(be){return be.filter(function(ce){var ne=ce.axis.getExtremes(),K=ne.min;ne=ne.max;var Y=Ce(ce.axis.minPointOffset,0);return Te(K)&&Te(ne)&&ce.value>=K-Y&&ce.value<=ne+Y&&!ce.axis.options.isInternal})[0]},getFieldType:function(be,ce){return ce=typeof ce,me(be=Se[be])&&(ce=be),{string:"text",number:"number",boolean:"checkbox"}[ce]}}}),u(Ge,"Extensions/Annotations/NavigationBindingsDefaults.js",[Ge["Extensions/Annotations/NavigationBindingsUtilities.js"],Ge["Core/Utilities.js"]],function(re,me){var Te=re.getAssignedAxis,Ce=me.isNumber,Se=me.merge;return{lang:{navigation:{popup:{simpleShapes:"Simple shapes",lines:"Lines",circle:"Circle",ellipse:"Ellipse",rectangle:"Rectangle",label:"Label",shapeOptions:"Shape options",typeOptions:"Details",fill:"Fill",format:"Text",strokeWidth:"Line width",stroke:"Line color",title:"Title",name:"Name",labelOptions:"Label options",labels:"Labels",backgroundColor:"Background color",backgroundColors:"Background colors",borderColor:"Border color",borderRadius:"Border radius",borderWidth:"Border width",style:"Style",padding:"Padding",fontSize:"Font size",color:"Color",height:"Height",shapes:"Shape options"}}},navigation:{bindingsClassName:"highcharts-bindings-container",bindings:{circleAnnotation:{className:"highcharts-circle-annotation",start:function(be){var ce=this.chart.pointer.getCoordinates(be);be=Te(ce.xAxis),ce=Te(ce.yAxis);var ne=this.chart.options.navigation;if(be&&ce)return this.chart.addAnnotation(Se({langKey:"circle",type:"basicAnnotation",shapes:[{type:"circle",point:{x:be.value,y:ce.value,xAxis:be.axis.options.index,yAxis:ce.axis.options.index},r:5}]},ne.annotationsOptions,ne.bindings.circleAnnotation.annotationsOptions))},steps:[function(be,ce){var ne=ce.options.shapes;if(Ce((ne=ne&&ne[0]&&ne[0].point||{}).xAxis)&&Ce(ne.yAxis)){var K=this.chart.inverted,Y=this.chart.xAxis[ne.xAxis].toPixels(ne.x);ne=this.chart.yAxis[ne.yAxis].toPixels(ne.y),K=Math.max(Math.sqrt(Math.pow(K?ne-be.chartX:Y-be.chartX,2)+Math.pow(K?Y-be.chartY:ne-be.chartY,2)),5)}ce.update({shapes:[{r:K}]})}]},ellipseAnnotation:{className:"highcharts-ellipse-annotation",start:function(be){var ce=this.chart.pointer.getCoordinates(be);be=Te(ce.xAxis),ce=Te(ce.yAxis);var ne=this.chart.options.navigation;if(be&&ce)return this.chart.addAnnotation(Se({langKey:"ellipse",type:"basicAnnotation",shapes:[{type:"ellipse",xAxis:be.axis.options.index,yAxis:ce.axis.options.index,points:[{x:be.value,y:ce.value},{x:be.value,y:ce.value}],ry:1}]},ne.annotationsOptions,ne.bindings.ellipseAnnotation.annotationOptions))},steps:[function(be,ce){var ne=(ce=ce.shapes[0]).getAbsolutePosition(ce.points[1]);ce.translatePoint(be.chartX-ne.x,be.chartY-ne.y,1),ce.redraw(!1)},function(be,ce){var ne=(ce=ce.shapes[0]).getAbsolutePosition(ce.points[0]),K=ce.getAbsolutePosition(ce.points[1]);be=ce.getDistanceFromLine(ne,K,be.chartX,be.chartY),ne=ce.getYAxis(),be=Math.abs(ne.toValue(0)-ne.toValue(be)),ce.setYRadius(be),ce.redraw(!1)}]},rectangleAnnotation:{className:"highcharts-rectangle-annotation",start:function(be){be=this.chart.pointer.getCoordinates(be);var ce=Te(be.xAxis),ne=Te(be.yAxis);if(ce&&ne){be=ce.value;var K=ne.value,Y=this.chart.options.navigation;return this.chart.addAnnotation(Se({langKey:"rectangle",type:"basicAnnotation",shapes:[{type:"path",points:[{xAxis:ce=ce.axis.options.index,yAxis:ne=ne.axis.options.index,x:be,y:K},{xAxis:ce,yAxis:ne,x:be,y:K},{xAxis:ce,yAxis:ne,x:be,y:K},{xAxis:ce,yAxis:ne,x:be,y:K},{command:"Z"}]}]},Y.annotationsOptions,Y.bindings.rectangleAnnotation.annotationsOptions))}},steps:[function(be,ce){var ne=ce.options.shapes;ne=ne&&ne[0]&&ne[0].points||[];var K=this.chart.pointer.getCoordinates(be);be=Te(K.xAxis),K=Te(K.yAxis),be&&K&&(K=K.value,ne[1].x=be=be.value,ne[2].x=be,ne[2].y=K,ne[3].y=K,ce.update({shapes:[{points:ne}]}))}]},labelAnnotation:{className:"highcharts-label-annotation",start:function(be){var ce=this.chart.pointer.getCoordinates(be);be=Te(ce.xAxis),ce=Te(ce.yAxis);var ne=this.chart.options.navigation;if(be&&ce)return this.chart.addAnnotation(Se({langKey:"label",type:"basicAnnotation",labelOptions:{format:"{y:.2f}"},labels:[{point:{xAxis:be.axis.options.index,yAxis:ce.axis.options.index,x:be.value,y:ce.value},overflow:"none",crop:!0}]},ne.annotationsOptions,ne.bindings.labelAnnotation.annotationsOptions))}}},events:{},annotationsOptions:{animation:{defer:0}}}}}),u(Ge,"Extensions/Annotations/NavigationBindings.js",[Ge["Core/Chart/ChartNavigationComposition.js"],Ge["Core/DefaultOptions.js"],Ge["Core/FormatUtilities.js"],Ge["Core/Globals.js"],Ge["Extensions/Annotations/NavigationBindingsDefaults.js"],Ge["Extensions/Annotations/NavigationBindingsUtilities.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce,Se,be,ce){function K(){this.chart.navigationBindings&&this.chart.navigationBindings.deselectAnnotation()}function Y(){this.navigationBindings&&this.navigationBindings.destroy()}function j(){var ae=this.options;ae&&ae.navigation&&ae.navigation.bindings&&(this.navigationBindings=new Z(this,ae.navigation),this.navigationBindings.initEvents(),this.navigationBindings.initUpdate())}function N(){var ae=this.navigationBindings;if(this&&ae){var ue=!1;if(this.series.forEach(function(V){!V.options.isInternal&&V.visible&&(ue=!0)}),this.navigationBindings&&this.navigationBindings.container&&this.navigationBindings.container[0]){var ge=this.navigationBindings.container[0];S(ae.boundClassNames,function(V,$){if($=ge.querySelectorAll("."+$))for(var de=0;de<$.length;de++){var Me=$[de],Ie=Me.className;"normal"===V.noDataState||ue?-1!==Ie.indexOf("highcharts-disabled-btn")&&Me.classList.remove("highcharts-disabled-btn"):-1===Ie.indexOf("highcharts-disabled-btn")&&(Me.className+=" highcharts-disabled-btn")}})}}}function R(){this.deselectAnnotation()}function I(){this.selectedButtonElement=null}function B(ae){var ue=ae.prototype.defaultOptions.events&&ae.prototype.defaultOptions.events.click;T(!0,ae.prototype.defaultOptions.events,{click:function(ge){var V=this,$=V.chart.navigationBindings,de=$.activeAnnotation;ue&&ue.call(V,ge),de!==V?($.deselectAnnotation(),$.activeAnnotation=V,V.setControlPointsVisibility(!0),q($,"showPopup",{annotation:V,formType:"annotation-toolbar",options:$.annotationToFields(V),onSubmit:function(Me){if("remove"===Me.actionType)$.activeAnnotation=!1,$.chart.removeAnnotation(V);else{var Ie={};$.fieldsToOptions(Me.fields,Ie),$.deselectAnnotation(),Me=Ie.typeOptions,"measure"===V.options.type&&(Me.crosshairY.enabled=0!==Me.crosshairY.strokeWidth,Me.crosshairX.enabled=0!==Me.crosshairX.strokeWidth),V.update(Ie)}}})):q($,"closePopup"),ge.activeAnnotation=!0}})}var P=me.setOptions,H=Te.format,W=Ce.doc,ie=Ce.win,te=be.getFieldType,ee=ce.addEvent,J=ce.attr,q=ce.fireEvent,D=ce.isArray,z=ce.isFunction,A=ce.isNumber,U=ce.isObject,T=ce.merge,S=ce.objectEach,O=ce.pick,M=[],Z=function(){function ae(ue,ge){this.selectedButton=this.boundClassNames=void 0,this.chart=ue,this.options=ge,this.eventsToUnbind=[],this.container=this.chart.container.querySelectorAll("."+this.options.bindingsClassName),this.container.length||(this.container=W.querySelectorAll("."+this.options.bindingsClassName))}return ae.compose=function(ue,ge){-1===M.indexOf(ue)&&(M.push(ue),ee(ue,"remove",K),B(ue),S(ue.types,function(V){B(V)})),-1===M.indexOf(ge)&&(M.push(ge),ee(ge,"destroy",Y),ee(ge,"load",j),ee(ge,"render",N)),-1===M.indexOf(ae)&&(M.push(ae),ee(ae,"closePopup",R),ee(ae,"deselectButton",I)),-1===M.indexOf(P)&&(M.push(P),P(Se))},ae.prototype.initEvents=function(){var ue=this,ge=ue.chart,V=ue.container,$=ue.options;ue.boundClassNames={},S($.bindings||{},function(de){ue.boundClassNames[de.className]=de}),[].forEach.call(V,function(de){ue.eventsToUnbind.push(ee(de,"click",function(Me){var Ie=ue.getButtonEvents(de,Me);Ie&&-1===Ie.button.className.indexOf("highcharts-disabled-btn")&&ue.bindingsButtonClick(Ie.button,Ie.events,Me)}))}),S($.events||{},function(de,Me){z(de)&&ue.eventsToUnbind.push(ee(ue,Me,de,{passive:!1}))}),ue.eventsToUnbind.push(ee(ge.container,"click",function(de){!ge.cancelClick&&ge.isInsidePlot(de.chartX-ge.plotLeft,de.chartY-ge.plotTop,{visiblePlotOnly:!0})&&ue.bindingsChartClick(this,de)})),ue.eventsToUnbind.push(ee(ge.container,Ce.isTouchDevice?"touchmove":"mousemove",function(de){ue.bindingsContainerMouseMove(this,de)},Ce.isTouchDevice?{passive:!1}:void 0))},ae.prototype.initUpdate=function(){var ue=this;re.compose(this.chart).navigation.addUpdate(function(ge){ue.update(ge)})},ae.prototype.bindingsButtonClick=function(ue,ge,V){var $=this.chart,de=$.renderer.boxWrapper,Me=!0;this.selectedButtonElement&&(this.selectedButtonElement.classList===ue.classList&&(Me=!1),q(this,"deselectButton",{button:this.selectedButtonElement}),this.nextEvent&&(this.currentUserDetails&&"annotations"===this.currentUserDetails.coll&&$.removeAnnotation(this.currentUserDetails),this.mouseMoveEvent=this.nextEvent=!1)),Me?(this.selectedButton=ge,this.selectedButtonElement=ue,q(this,"selectButton",{button:ue}),ge.init&&ge.init.call(this,ue,V),(ge.start||ge.steps)&&$.renderer.boxWrapper.addClass("highcharts-draw-mode")):($.stockTools&&$.stockTools.toggleButtonActiveClass(ue),de.removeClass("highcharts-draw-mode"),this.mouseMoveEvent=this.nextEvent=!1,this.selectedButton=null)},ae.prototype.bindingsChartClick=function(ue,ge){var V=this.activeAnnotation,$=this.selectedButton;ue=(ue=this.chart).renderer.boxWrapper,V&&(V.cancelClick||ge.activeAnnotation||!ge.target.parentNode||function ne(ae,ue){var ge=ie.Element.prototype,V=ge.matches||ge.msMatchesSelector||ge.webkitMatchesSelector,$=null;if(ge.closest)$=ge.closest.call(ae,ue);else do{if(V.call(ae,ue))return ae;ae=ae.parentElement||ae.parentNode}while(null!==ae&&1===ae.nodeType);return $}(ge.target,".highcharts-popup")?V.cancelClick&&setTimeout(function(){V.cancelClick=!1},0):q(this,"closePopup")),$&&$.start&&(this.nextEvent?(this.nextEvent(ge,this.currentUserDetails),this.steps&&(this.stepIndex++,$.steps[this.stepIndex]?this.mouseMoveEvent=this.nextEvent=$.steps[this.stepIndex]:(q(this,"deselectButton",{button:this.selectedButtonElement}),ue.removeClass("highcharts-draw-mode"),$.end&&$.end.call(this,ge,this.currentUserDetails),this.mouseMoveEvent=this.nextEvent=!1,this.selectedButton=null))):(this.currentUserDetails=$.start.call(this,ge))&&$.steps?(this.stepIndex=0,this.steps=!0,this.mouseMoveEvent=this.nextEvent=$.steps[this.stepIndex]):(q(this,"deselectButton",{button:this.selectedButtonElement}),ue.removeClass("highcharts-draw-mode"),this.steps=!1,this.selectedButton=null,$.end&&$.end.call(this,ge,this.currentUserDetails)))},ae.prototype.bindingsContainerMouseMove=function(ue,ge){this.mouseMoveEvent&&this.mouseMoveEvent(ge,this.currentUserDetails)},ae.prototype.fieldsToOptions=function(ue,ge){return S(ue,function(V,$){var de=parseFloat(V),Me=$.split("."),Ie=Me.length-1;if(!A(de)||V.match(/px/g)||$.match(/format/g)||(V=de),"undefined"!==V){var De=ge;Me.forEach(function(oe,ve){var xe=O(Me[ve+1],"");Ie===ve?De[oe]=V:(De[oe]||(De[oe]=xe.match(/\d/g)?[]:{}),De=De[oe])})}}),ge},ae.prototype.deselectAnnotation=function(){this.activeAnnotation&&(this.activeAnnotation.setControlPointsVisibility(!1),this.activeAnnotation=!1)},ae.prototype.annotationToFields=function(ue){function ge(oe,ve,xe,Re,we){if(xe&&oe&&-1===Ie.indexOf(ve)&&(0<=(xe.indexOf&&xe.indexOf(ve))||xe[ve]||!0===xe))if(D(oe))Re[ve]=[],oe.forEach(function(Ne,Ze){U(Ne)?(Re[ve][Ze]={},S(Ne,function(at,wt){ge(at,wt,de[ve],Re[ve][Ze],ve)})):ge(Ne,0,de[ve],Re[ve],ve)});else if(U(oe)){var Le={};D(Re)?(Re.push(Le),Le[ve]={},Le=Le[ve]):Re[ve]=Le,S(oe,function(Ne,Ze){ge(Ne,Ze,0===ve?xe:de[ve],Le,ve)})}else"format"===ve?Re[ve]=[H(oe,ue.labels[0].points[0]).toString(),"text"]:D(Re)?Re.push([oe,te(we,oe)]):Re[ve]=[oe,te(ve,oe)]}var V=ue.options,$=ae.annotationsEditable,de=$.nestedOptions,Me=O(V.type,V.shapes&&V.shapes[0]&&V.shapes[0].type,V.labels&&V.labels[0]&&V.labels[0].type,"label"),Ie=ae.annotationsNonEditable[V.langKey]||[],De={langKey:V.langKey,type:Me};return S(V,function(oe,ve){"typeOptions"===ve?(De[ve]={},S(V[ve],function(xe,Re){ge(xe,Re,de,De[ve],Re)})):ge(oe,ve,$[Me],De,ve)}),De},ae.prototype.getClickedClassNames=function(ue,ge){var $,V=ge.target;for(ge=[];V&&(($=J(V,"class"))&&(ge=ge.concat($.split(" ").map(function(de){return[de,V]}))),(V=V.parentNode)!==ue););return ge},ae.prototype.getButtonEvents=function(ue,ge){var $,V=this;return this.getClickedClassNames(ue,ge).forEach(function(de){V.boundClassNames[de[0]]&&!$&&($={events:V.boundClassNames[de[0]],button:de[1]})}),$},ae.prototype.update=function(ue){this.options=T(!0,this.options,ue),this.removeEvents(),this.initEvents()},ae.prototype.removeEvents=function(){this.eventsToUnbind.forEach(function(ue){return ue()})},ae.prototype.destroy=function(){this.removeEvents()},ae.annotationsEditable={nestedOptions:{labelOptions:["style","format","backgroundColor"],labels:["style"],label:["style"],style:["fontSize","color"],background:["fill","strokeWidth","stroke"],innerBackground:["fill","strokeWidth","stroke"],outerBackground:["fill","strokeWidth","stroke"],shapeOptions:["fill","strokeWidth","stroke"],shapes:["fill","strokeWidth","stroke"],line:["strokeWidth","stroke"],backgroundColors:[!0],connector:["fill","strokeWidth","stroke"],crosshairX:["strokeWidth","stroke"],crosshairY:["strokeWidth","stroke"]},circle:["shapes"],ellipse:["shapes"],verticalLine:[],label:["labelOptions"],measure:["background","crosshairY","crosshairX"],fibonacci:[],tunnel:["background","line","height"],pitchfork:["innerBackground","outerBackground"],rect:["shapes"],crookedLine:[],basicAnnotation:["shapes","labelOptions"]},ae.annotationsNonEditable={rectangle:["crosshairX","crosshairY","labelOptions"],ellipse:["labelOptions"],circle:["labelOptions"]},ae}();return Z}),u(Ge,"Extensions/Annotations/Popup/PopupAnnotations.js",[Ge["Core/Globals.js"],Ge["Core/Utilities.js"]],function(re,me){function Te(N,R,I,B,P,H){var W=this;if(R){var ee,J,ie=this.addInput,te=this.lang;K(B,function(q,D){ee=""!==I?I+"."+D:D,ne(q)&&(!ce(q)||ce(q)&&ne(q[0])?((J=te[D]||D).match(/\d/g)||P.push([!0,J,N]),Te.call(W,N,R,ee,q,P,!1)):P.push([W,ee,"annotation",N,q]))}),H&&(j(P,function(q){return q[1].match(/format/g)?-1:1}),Se&&P.reverse(),P.forEach(function(q){!0===q[0]?be("span",{className:"highcharts-annotation-title"},void 0,q[2]).appendChild(Ce.createTextNode(q[1])):(q[4]={value:q[4][0],type:q[4][1]},ie.apply(q[0],q.splice(1)))}))}}var Ce=re.doc,Se=re.isFirefox,be=me.createElement,ce=me.isArray,ne=me.isObject,K=me.objectEach,Y=me.pick,j=me.stableSort;return{addForm:function(N,R,I,B){if(N){var P=this.container,H=this.lang,W=be("h2",{className:"highcharts-popup-main-title"},void 0,P);W.appendChild(Ce.createTextNode(H[R.langKey]||R.langKey||"")),W=be("div",{className:"highcharts-popup-lhs-col highcharts-popup-lhs-full"},void 0,P);var ie=be("div",{className:"highcharts-popup-bottom-row"},void 0,P);Te.call(this,W,N,"",R,[],!0),this.addButton(ie,B?H.addButton||"add":H.saveButton||"save",B?"add":"save",P,I)}},addToolbar:function(N,R,I){var B=this,P=this.lang,H=this.container,W=this.showForm;-1===H.className.indexOf("highcharts-annotation-toolbar")&&(H.className+=" highcharts-annotation-toolbar"),N&&(H.style.top=N.plotTop+10+"px"),be("span",void 0,void 0,H).appendChild(Ce.createTextNode(Y(P[R.langKey]||R.langKey,R.shapes&&R.shapes[0].type,"")));var ie=this.addButton(H,P.removeButton||"remove","remove",H,I);ie.className+=" highcharts-annotation-remove-button",ie.style["background-image"]="url("+this.iconsURL+"destroy.svg)",(ie=this.addButton(H,P.editButton||"edit","edit",H,function(){W.call(B,"annotation-edit",N,R,I)})).className+=" highcharts-annotation-edit-button",ie.style["background-image"]="url("+this.iconsURL+"edit.svg)"}}}),u(Ge,"Extensions/Annotations/Popup/PopupIndicators.js",[Ge["Core/Renderer/HTML/AST.js"],Ge["Core/Globals.js"],Ge["Extensions/Annotations/NavigationBindingsUtilities.js"],Ge["Core/Series/SeriesRegistry.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce,Se){function be(U){var T=ie("div",{className:"highcharts-popup-lhs-col"},void 0,U);return U=ie("div",{className:"highcharts-popup-rhs-col"},void 0,U),ie("div",{className:"highcharts-popup-rhs-col-wrapper"},void 0,U),{lhsCol:T,rhsCol:U}}function ce(U,T,S,O){var M=this,Z=M.lang,ae=T.querySelectorAll(".highcharts-popup-lhs-col")[0];T=T.querySelectorAll(".highcharts-popup-rhs-col")[0];var ue="edit"===S;if(S=ue?U.series:U.options.plotOptions||{},U||!S){var ge,V=[];ue||ee(S)?ee(S)&&(V=R.call(this,S)):V=N.call(this,S,O),D(V,function(Me,Ie){return(Me=Me.indicatorFullName.toLowerCase())<(Ie=Ie.indicatorFullName.toLowerCase())?-1:Me>Ie?1:0}),ae.children[1]&&ae.children[1].remove();var $=ie("ul",{className:"highcharts-indicator-list"},void 0,ae),de=T.querySelectorAll(".highcharts-popup-rhs-col-wrapper")[0];V.forEach(function(Me){var Ie=Me.indicatorFullName,De=Me.indicatorType,oe=Me.series;(ge=ie("li",{className:"highcharts-indicator-list"},void 0,$)).appendChild(P.createTextNode(Ie)),["click","touchstart"].forEach(function(ve){W(ge,ve,function(){var xe=de.parentNode.children[1],Re=oe.params||oe.options.params;de.innerHTML=re.emptyHTML,ie("h3",{className:"highcharts-indicator-title"},void 0,de).appendChild(P.createTextNode(I(oe,De).indicatorFullName)),ie("input",{type:"hidden",name:"highcharts-type-"+De,value:De},void 0,de),B.call(M,De,"series",U,de,oe,oe.linkedParent&&oe.linkedParent.options.id),Re.volumeSeriesID&&B.call(M,De,"volume",U,de,oe,oe.linkedParent&&Re.volumeSeriesID),ne.call(M,U,"params",Re,De,de),xe&&(xe.style.display="block"),ue&&oe.options&&ie("input",{type:"hidden",name:"highcharts-id-"+De,value:oe.options.id},void 0,de).setAttribute("highcharts-data-series-id",oe.options.id)})})}),0<$.childNodes.length?$.childNodes[0].click():ue||(re.setElementHTML(de.parentNode.children[0],Z.noFilterMatch||""),de.parentNode.children[1].style.display="none")}}function ne(U,T,S,O,M){var Z=this;if(U){var ae=this.addInput;q(S,function(ue,ge){var V=T+"."+ge;te(ue)&&V&&(J(ue)&&(ae.call(Z,V,O,M,{}),ne.call(Z,U,V,ue,O,M)),V in z?(V=Y.call(Z,O,V,M),j.call(Z,U,T,V,O,ge,ue)):"params.volumeSeriesID"===V||ee(ue)||ae.call(Z,V,O,M,{value:ue,type:"number"}))})}}function K(U,T){var S=this,O=T.querySelectorAll(".highcharts-popup-lhs-col")[0];T=this.lang.clearFilter,O=ie("div",{className:"highcharts-input-wrapper"},void 0,O);var M=this.addInput("searchIndicators","input",O,{value:"",type:"text",htmlFor:"search-indicators",labelClassName:"highcharts-input-search-indicators-label"}),Z=ie("a",{textContent:T},void 0,O);M.classList.add("highcharts-input-search-indicators"),Z.classList.add("clear-filter-button"),W(M,"input",function(ae){ce.call(S,U,S.container,"add",this.value),Z.style.display=this.value.length?"inline-block":"none"}),["click","touchstart"].forEach(function(ae){W(Z,ae,function(){M.value="",ce.call(S,U,S.container,"add",""),Z.style.display="none"})})}function Y(U,T,S){var O=T.split(".");O=O[O.length-1];var M=this.lang;return ie("label",{htmlFor:U="highcharts-"+T+"-type-"+U},null,S).appendChild(P.createTextNode(M[O]||T)),(S=ie("select",{name:U,className:"highcharts-popup-field",id:"highcharts-select-"+T},null,S)).setAttribute("id","highcharts-select-"+T),S}function j(U,T,S,O,M,Z,ae){"series"===T||"volume"===T?U.series.forEach(function(ue){var ge=ue.options,V=ge.name||ge.params?ue.name:ge.id||"";"highcharts-navigator-series"!==ge.id&&ge.id!==(ae&&ae.options&&ae.options.id)&&(te(Z)||"volume"!==T||"column"!==ue.type||(Z=ge.id),ie("option",{value:ge.id},void 0,S).appendChild(P.createTextNode(V)))}):O&&M&&A[M+"-"+O].forEach(function(ue){ie("option",{value:ue},void 0,S).appendChild(P.createTextNode(ue))}),te(Z)&&(S.value=Z)}function N(U,T){var S=this.chart&&this.chart.options.lang,O=S&&S.navigation&&S.navigation.popup&&S.navigation.popup.indicatorAliases,M=[];return q(U,function(ae,ue){var ge=ae&&ae.options;if(ae.params||ge&&ge.params)if(ue=(ge=I(ae,ue)).indicatorFullName,ge=ge.indicatorType,T){var V=T.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");V=new RegExp(V,"i");var $=O&&O[ge]&&O[ge].join(" ")||"";(ue.match(V)||$.match(V))&&M.push({indicatorFullName:ue,indicatorType:ge,series:ae})}else M.push({indicatorFullName:ue,indicatorType:ge,series:ae})}),M}function R(U){var T=[];return U.forEach(function(S){S.is("sma")&&T.push({indicatorFullName:S.name,indicatorType:S.type,series:S})}),T}function I(U,T){var S=U.options,O=H[T]&&H[T].prototype.nameBase||T.toUpperCase();return S&&S.type&&(T=U.options.type,O=U.name),{indicatorFullName:O,indicatorType:T}}function B(U,T,S,O,M,Z){S&&(U=Y.call(this,U,T,O),j.call(this,S,T,U,void 0,void 0,void 0,M),te(Z)&&(U.value=Z))}var z,U,P=me.doc,H=Ce.seriesTypes,W=Se.addEvent,ie=Se.createElement,te=Se.defined,ee=Se.isArray,J=Se.isObject,q=Se.objectEach,D=Se.stableSort;(U=z||(z={}))[U["params.algorithm"]=0]="params.algorithm",U[U["params.average"]=1]="params.average";var A={"algorithm-pivotpoints":["standard","fibonacci","camarilla"],"average-disparityindex":["sma","ema","dema","tema","wma"]};return{addForm:function(U,T,S){if(T=this.lang,U){this.tabs.init.call(this,U);var O=this.container.querySelectorAll(".highcharts-tab-item-content");be(O[0]),K.call(this,U,O[0]),ce.call(this,U,O[0],"add");var M=O[0].querySelectorAll(".highcharts-popup-rhs-col")[0];this.addButton(M,T.addButton||"add","add",M,S),be(O[1]),ce.call(this,U,O[1],"edit"),M=O[1].querySelectorAll(".highcharts-popup-rhs-col")[0],this.addButton(M,T.saveButton||"save","edit",M,S),this.addButton(M,T.removeButton||"remove","remove",M,S)}},getAmount:function(){var U=0;return this.series.forEach(function(T){(T.params||T.options.params)&&U++}),U}}}),u(Ge,"Extensions/Annotations/Popup/PopupTabs.js",[Ge["Core/Globals.js"],Ge["Core/Utilities.js"]],function(re,me){function Te(){return K("div",{className:"highcharts-tab-item-content highcharts-no-mousewheel"},void 0,this.container)}function Ce(Y,j){var R=this.lang,I="highcharts-tab-item";return 0===j&&(I+=" highcharts-tab-disabled"),(j=K("span",{className:I},void 0,this.container)).appendChild(ce.createTextNode(R[Y+"Button"]||Y)),j.setAttribute("highcharts-data-tab-type",Y),j}function Se(Y,j){var N=this.container.querySelectorAll(".highcharts-tab-item-content");Y.className+=" highcharts-tab-item-active",N[j].className+=" highcharts-tab-item-show"}function be(Y){var j=this;this.container.querySelectorAll(".highcharts-tab-item").forEach(function(N,R){0===Y&&"edit"===N.getAttribute("highcharts-data-tab-type")||["click","touchstart"].forEach(function(I){ne(N,I,function(){var B=j.container,P=B.querySelectorAll(".highcharts-tab-item");B=B.querySelectorAll(".highcharts-tab-item-content");for(var H=0;H<P.length;H++)P[H].classList.remove("highcharts-tab-item-active"),B[H].classList.remove("highcharts-tab-item-show");Se.call(j,this,R)})})})}var ce=re.doc,ne=me.addEvent,K=me.createElement;return{init:function(Y){if(Y){Y=this.indicators.getAmount.call(Y);var j=Ce.call(this,"add");Ce.call(this,"edit",Y),Te.call(this),Te.call(this),be.call(this,Y),Se.call(this,j,0)}}}}),u(Ge,"Extensions/Annotations/Popup/Popup.js",[Ge["Core/Renderer/HTML/AST.js"],Ge["Core/Globals.js"],Ge["Core/DefaultOptions.js"],Ge["Extensions/Annotations/Popup/PopupAnnotations.js"],Ge["Extensions/Annotations/Popup/PopupIndicators.js"],Ge["Extensions/Annotations/Popup/PopupTabs.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce,Se,be,ce){var K=me.doc,Y=Te.getOptions,j=ce.addEvent,N=ce.createElement,R=ce.fireEvent,I=ce.pick;return(Te=ce.extend)((ce=function(){function B(P,H,W){this.chart=W,this.iconsURL=H,this.lang=Y().lang.navigation.popup,this.container=N("div",{className:"highcharts-popup highcharts-no-tooltip"},void 0,P),j(this.container,"mousedown",function(){var ie=W&&W.navigationBindings&&W.navigationBindings.activeAnnotation;if(ie){ie.cancelClick=!0;var te=j(me.doc,"click",function(){setTimeout(function(){ie.cancelClick=!1},0),te()})}}),this.addCloseBtn()}return B.prototype.init=function(P,H,W){B.call(this,P,H,W)},B.prototype.addCloseBtn=function(){var P=this,H=this.iconsURL,W=N("div",{className:"highcharts-popup-close"},void 0,this.container);W.style["background-image"]="url("+(H.match(/png|svg|jpeg|jpg|gif/gi)?H:H+"close.svg")+")",["click","touchstart"].forEach(function(ie){j(W,ie,function(){P.chart?R(P.chart.navigationBindings,"closePopup"):P.closePopup()})})},B.prototype.addInput=function(P,H,W,ie){var te=P.split("."),ee=this.lang;return(H="highcharts-"+H+"-"+I(ie.htmlFor,te=te[te.length-1])).match(/\d/g)||N("label",{htmlFor:H,className:ie.labelClassName},void 0,W).appendChild(K.createTextNode(ee[te]||te)),(W=N("input",{name:H,value:ie.value,type:ie.type,className:"highcharts-popup-field"},void 0,W)).setAttribute("highcharts-data-name",P),W},B.prototype.addButton=function(P,H,W,ie,te){var ee=this,J=N("button",void 0,void 0,P);return J.appendChild(K.createTextNode(H)),te&&["click","touchstart"].forEach(function(q){j(J,q,function(){return ee.closePopup(),te(function ne(B,P){var H=Array.prototype.slice.call(B.querySelectorAll("input")),W=Array.prototype.slice.call(B.querySelectorAll("select")),ie=B.querySelectorAll("#highcharts-select-series > option:checked")[0];B=B.querySelectorAll("#highcharts-select-volume > option:checked")[0];var te={actionType:P,linkedTo:ie&&ie.getAttribute("value")||"",fields:{}};return H.forEach(function(ee){var J=ee.getAttribute("highcharts-data-name");ee.getAttribute("highcharts-data-series-id")?te.seriesId=ee.value:J?te.fields[J]=ee.value:te.type=ee.value}),W.forEach(function(ee){var J=ee.id;"highcharts-select-series"!==J&&"highcharts-select-volume"!==J&&(J=J.split("highcharts-select-")[1],te.fields[J]=ee.value)}),B&&(te.fields["params.volumeSeriesID"]=B.getAttribute("value")||""),te}(ie,W))})}),J},B.prototype.showPopup=function(){var P=this.container,H=P.querySelectorAll(".highcharts-popup-close")[0];this.formType=void 0,P.innerHTML=re.emptyHTML,0<=P.className.indexOf("highcharts-annotation-toolbar")&&(P.classList.remove("highcharts-annotation-toolbar"),P.removeAttribute("style")),P.appendChild(H),P.style.display="block",P.style.height=""},B.prototype.closePopup=function(){this.container.style.display="none"},B.prototype.showForm=function(P,H,W,ie){H&&(this.showPopup(),"indicators"===P&&this.indicators.addForm.call(this,H,W,ie),"annotation-toolbar"===P&&this.annotations.addToolbar.call(this,H,W,ie),"annotation-edit"===P&&this.annotations.addForm.call(this,H,W,ie),"flag"===P&&this.annotations.addForm.call(this,H,W,ie,!0),this.formType=P,this.container.style.height=this.container.offsetHeight+"px")},B}()).prototype,{annotations:Ce,indicators:Se,tabs:be}),ce}),u(Ge,"Extensions/Annotations/Popup/PopupComposition.js",[Ge["Extensions/Annotations/Popup/Popup.js"],Ge["Core/Utilities.js"]],function(re,me){function Te(){this.popup&&this.popup.closePopup()}function Ce(K){this.popup||(this.popup=new re(this.chart.container,this.chart.options.navigation.iconsURL||this.chart.options.stockTools&&this.chart.options.stockTools.gui.iconsURL||"https://code.highcharts.com/10.2.1/gfx/stock-icons/",this.chart)),this.popup.showForm(K.formType,this.chart,K.options,K.onSubmit)}function Se(K,Y){this.inClass(Y.target,"highcharts-popup")||K.apply(this,Array.prototype.slice.call(arguments,1))}var be=me.addEvent,ce=me.wrap,ne=[];return{compose:function(K,Y){-1===ne.indexOf(K)&&(ne.push(K),be(K,"closePopup",Te),be(K,"showPopup",Ce)),-1===ne.indexOf(Y)&&(ne.push(Y),ce(Y.prototype,"onContainerMouseDown",Se))}}}),u(Ge,"Extensions/Annotations/Annotation.js",[Ge["Core/Animation/AnimationUtilities.js"],Ge["Extensions/Annotations/AnnotationChart.js"],Ge["Extensions/Annotations/AnnotationDefaults.js"],Ge["Extensions/Annotations/Controllables/Controllable.js"],Ge["Extensions/Annotations/Controllables/ControllableRect.js"],Ge["Extensions/Annotations/Controllables/ControllableCircle.js"],Ge["Extensions/Annotations/Controllables/ControllableEllipse.js"],Ge["Extensions/Annotations/Controllables/ControllablePath.js"],Ge["Extensions/Annotations/Controllables/ControllableImage.js"],Ge["Extensions/Annotations/Controllables/ControllableLabel.js"],Ge["Extensions/Annotations/ControlPoint.js"],Ge["Extensions/Annotations/EventEmitter.js"],Ge["Extensions/Annotations/MockPoint.js"],Ge["Extensions/Annotations/NavigationBindings.js"],Ge["Extensions/Annotations/Popup/PopupComposition.js"],Ge["Core/Utilities.js"]],function(re,me,Te,Ce,Se,be,ce,ne,K,Y,j,N,R,I,B,P){function W(T,S){var O={};return["labels","shapes"].forEach(function(M){var Z=T[M];Z&&(O[M]=S[M]?U(S[M]).map(function(ae,ue){return z(Z[ue],ae)}):T[M])}),O}var T,ie=this&&this.__extends||(T=function(S,O){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,Z){M.__proto__=Z}||function(M,Z){for(var ae in Z)Z.hasOwnProperty(ae)&&(M[ae]=Z[ae])})(S,O)},function(S,O){function M(){this.constructor=S}T(S,O),S.prototype=null===O?Object.create(O):(M.prototype=O.prototype,new M)}),te=re.getDeferredAnimation,ee=Ce.prototype,J=P.destroyObjectProperties,q=P.erase,D=P.fireEvent,z=P.merge,A=P.pick,U=P.splat;return re=function(T){function S(O,M){var Z=T.call(this)||this;return Z.annotation=void 0,Z.coll="annotations",Z.collection=void 0,Z.animationConfig=void 0,Z.graphic=void 0,Z.group=void 0,Z.labelCollector=void 0,Z.labelsGroup=void 0,Z.shapesGroup=void 0,Z.chart=O,Z.points=[],Z.controlPoints=[],Z.coll="annotations",Z.labels=[],Z.shapes=[],Z.options=z(Z.defaultOptions,M),Z.userOptions=M,M=W(Z.options,M),Z.options.labels=M.labels,Z.options.shapes=M.shapes,Z.init(O,Z.options),Z}return ie(S,T),S.compose=function(O,M,Z){me.compose(S,O,M),Y.compose(Z),ne.compose(O,Z),I.compose(S,O),B.compose(I,M)},S.prototype.addClipPaths=function(){this.setClipAxes(),this.clipXAxis&&this.clipYAxis&&this.options.crop&&(this.clipRect=this.chart.renderer.clipRect(this.getClipBox()))},S.prototype.addLabels=function(){var O=this,M=this.options.labels||[];M.forEach(function(Z,ae){Z=O.initLabel(Z,ae),z(!0,M[ae],Z.options)})},S.prototype.addShapes=function(){var O=this,M=this.options.shapes||[];M.forEach(function(Z,ae){Z=O.initShape(Z,ae),z(!0,M[ae],Z.options)})},S.prototype.destroy=function(){var O=this.chart,M=function(Z){Z.destroy()};this.labels.forEach(M),this.shapes.forEach(M),this.clipYAxis=this.clipXAxis=null,q(O.labelCollectors,this.labelCollector),T.prototype.destroy.call(this),ee.destroy.call(this),J(this,O)},S.prototype.destroyItem=function(O){q(this[O.itemType+"s"],O),O.destroy()},S.prototype.getClipBox=function(){if(this.clipXAxis&&this.clipYAxis)return{x:this.clipXAxis.left,y:this.clipYAxis.top,width:this.clipXAxis.width,height:this.clipYAxis.height}},S.prototype.init=function(O,M,Z){O=this.chart,M=this.options.animation,this.linkPoints(),this.addControlPoints(),this.addShapes(),this.addLabels(),this.setLabelCollector(),this.animationConfig=te(O,M)},S.prototype.initLabel=function(O,M){return O=z(this.options.labelOptions,{controlPointOptions:this.options.controlPointOptions},O),(M=new Y(this,O,M)).itemType="label",this.labels.push(M),M},S.prototype.initShape=function(O,M){return O=z(this.options.shapeOptions,{controlPointOptions:this.options.controlPointOptions},O),(M=new S.shapesMap[O.type](this,O,M)).itemType="shape",this.shapes.push(M),M},S.prototype.redraw=function(O){this.linkPoints(),this.graphic||this.render(),this.clipRect&&this.clipRect.animate(this.getClipBox()),this.redrawItems(this.shapes,O),this.redrawItems(this.labels,O),ee.redraw.call(this,O)},S.prototype.redrawItem=function(O,M){O.linkPoints(),O.shouldBeDrawn()?(O.graphic||this.renderItem(O),O.redraw(A(M,!0)&&O.graphic.placed),O.points.length&&function H(T){var S=T.graphic;T=T.points.some(function(O){return!1!==O.series.visible&&!1!==O.visible}),S&&(T?"hidden"===S.visibility&&S.show():S.hide())}(O)):this.destroyItem(O)},S.prototype.redrawItems=function(O,M){for(var Z=O.length;Z--;)this.redrawItem(O[Z],M)},S.prototype.remove=function(){return this.chart.removeAnnotation(this)},S.prototype.render=function(){var O=this.chart.renderer;this.graphic=O.g("annotation").attr({opacity:0,zIndex:this.options.zIndex,visibility:this.options.visible?"inherit":"hidden"}).add(),this.shapesGroup=O.g("annotation-shapes").add(this.graphic),this.options.crop&&this.shapesGroup.clip(this.chart.plotBoxClip),this.labelsGroup=O.g("annotation-labels").attr({translateX:0,translateY:0}).add(this.graphic),this.addClipPaths(),this.clipRect&&this.graphic.clip(this.clipRect),this.renderItems(this.shapes),this.renderItems(this.labels),this.addEvents(),ee.render.call(this)},S.prototype.renderItem=function(O){O.render("label"===O.itemType?this.labelsGroup:this.shapesGroup)},S.prototype.renderItems=function(O){for(var M=O.length;M--;)this.renderItem(O[M])},S.prototype.setClipAxes=function(){var O=this.chart.xAxis,M=this.chart.yAxis,Z=(this.options.labels||[]).concat(this.options.shapes||[]).reduce(function(ae,ue){return[O[(ue=ue&&(ue.point||ue.points&&ue.points[0]))&&ue.xAxis]||ae[0],M[ue&&ue.yAxis]||ae[1]]},[]);this.clipXAxis=Z[0],this.clipYAxis=Z[1]},S.prototype.setControlPointsVisibility=function(O){var M=function(Z){Z.setControlPointsVisibility(O)};ee.setControlPointsVisibility.call(this,O),this.shapes.forEach(M),this.labels.forEach(M)},S.prototype.setLabelCollector=function(){var O=this;O.labelCollector=function(){return O.labels.reduce(function(M,Z){return Z.options.allowOverlap||M.push(Z.graphic),M},[])},O.chart.labelCollectors.push(O.labelCollector)},S.prototype.setOptions=function(O){this.options=z(this.defaultOptions,O)},S.prototype.setVisibility=function(O){var M=this.options,Z=this.chart.navigationBindings;O=A(O,!M.visible),this.graphic.attr("visibility",O?"inherit":"hidden"),O||(this.setControlPointsVisibility(!1),Z.activeAnnotation===this&&Z.popup&&"annotation-toolbar"===Z.popup.formType&&D(Z,"closePopup")),M.visible=O},S.prototype.update=function(O,M){var Z=this.chart,ae=W(this.userOptions,O),ue=Z.annotations.indexOf(this);(O=z(!0,this.userOptions,O)).labels=ae.labels,O.shapes=ae.shapes,this.destroy(),this.constructor(Z,O),Z.options.annotations[ue]=O,this.isUpdating=!0,A(M,!0)&&Z.redraw(),D(this,"afterUpdate"),this.isUpdating=!1},S.ControlPoint=j,S.MockPoint=R,S.shapesMap={rect:Se,circle:be,ellipse:ce,path:ne,image:K},S.types={},S}(N),z(!0,re.prototype,Ce.prototype,z(re.prototype,{nonDOMEvents:["add","afterUpdate","drag","remove"],defaultOptions:Te})),re}),u(Ge,"masters/modules/annotations.src.js",[Ge["Core/Globals.js"],Ge["Extensions/Annotations/Annotation.js"]],function(re,me){re.Annotation=me,me.compose(re.Chart,re.Pointer,re.SVGRenderer)})},_s.exports?(Ge.default=Ge,_s.exports=Ge):(Mn=[Is(470)],void 0!==(lo=function(u){return Ge(u),Ge.Highcharts=u,Ge}.apply(la,Mn))&&(_s.exports=lo))},898:function(_s){_s.exports=function(){"use strict";var la,Is,Mn;function lo(u,re){if(la)if(Is){var me="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+la+")(sharedChunk); ("+Is+")(sharedChunk); self.onerror = null;",Te={};la(Te),Mn=re(Te),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(Mn.workerUrl=window.URL.createObjectURL(new Blob([me],{type:"text/javascript"})))}else Is=re;else la=re}return lo(0,function(u){var re=typeof self<"u"?self:{},me="2.12.0";let Te;const Ce={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Te){const s=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Te=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):s}catch{Te=s}}return Te},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Se={supported:!1,testSupport:function(s){!ne&&ce&&(K?Y(s):be=s)}};let be,ce,ne=!1,K=!1;function Y(s){const r=s.createTexture();s.bindTexture(s.TEXTURE_2D,r);try{if(s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,ce),s.isContextLost())return;Se.supported=!0}catch{}s.deleteTexture(r),ne=!0}re.document&&(ce=re.document.createElement("img"),ce.onload=function(){be&&Y(be),be=null,K=!0},ce.onerror=function(){ne=!0,be=null},ce.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const j="01";var N=R;function R(s,r,a,h){this.cx=3*s,this.bx=3*(a-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(h-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=r,this.p2x=a,this.p2y=h}R.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,r){if(void 0===r&&(r=1e-6),s<0)return 0;if(s>1)return 1;for(var a=s,h=0;h<8;h++){var p=this.sampleCurveX(a)-s;if(Math.abs(p)<r)return a;var g=this.sampleCurveDerivativeX(a);if(Math.abs(g)<1e-6)break;a-=p/g}var v=0,b=1;for(a=s,h=0;h<20&&(p=this.sampleCurveX(a),!(Math.abs(p-s)<r));h++)s>p?v=a:b=a,a=.5*(b-v)+v;return a},solve:function(s,r){return this.sampleCurveY(this.solveCurveX(s,r))}};var I=B;function B(s,r){this.x=s,this.y=r}B.prototype={clone:function(){return new B(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,r){return this.clone()._rotateAround(s,r)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var r=s.x-this.x,a=s.y-this.y;return r*r+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,r){return Math.atan2(this.x*r-this.y*s,this.x*s+this.y*r)},_matMult:function(s){var r=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=r,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var r=Math.cos(s),a=Math.sin(s),h=a*this.x+r*this.y;return this.x=r*this.x-a*this.y,this.y=h,this},_rotateAround:function(s,r){var a=Math.cos(s),h=Math.sin(s),p=r.y+h*(this.x-r.x)+a*(this.y-r.y);return this.x=r.x+a*(this.x-r.x)-h*(this.y-r.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},B.convert=function(s){return s instanceof B?s:Array.isArray(s)?new B(s[0],s[1]):s};const P=Math.PI/180,H=180/Math.PI;function W(s){return s*P}function ie(s){return s*H}const te=[[0,0],[1,0],[1,1],[0,1]];function ee(s){if(s<=0)return 0;if(s>=1)return 1;const r=s*s,a=r*s;return 4*(s<.5?a:3*(s-r)+a-.75)}function J(s,r,a,h){const p=new N(s,r,a,h);return function(g){return p.solve(g)}}const q=J(.25,.1,.25,1);function D(s,r,a){return Math.min(a,Math.max(r,s))}function z(s,r,a){return(a=D((a-s)/(r-s),0,1))*a*(3-2*a)}function A(s,r,a){const h=a-r,p=((s-r)%h+h)%h+r;return p===r?a:p}function U(s,r,a){if(!s.length)return a(null,[]);let h=s.length;const p=new Array(s.length);let g=null;s.forEach((v,b)=>{r(v,(E,k)=>{E&&(g=E),p[b]=k,0==--h&&a(g,p)})})}function T(s){const r=[];for(const a in s)r.push(s[a]);return r}function S(s,...r){for(const a of r)for(const h in a)s[h]=a[h];return s}let O=1;function M(){return O++}function Z(){return function s(r){return r?(r^Math.random()*(16>>r/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,s)}()}function ae(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function ue(s){return!!s&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s)}function ge(s,r){s.forEach(a=>{r[a]&&(r[a]=r[a].bind(r))})}function V(s,r){return-1!==s.indexOf(r,s.length-r.length)}function $(s,r,a){const h={};for(const p in s)h[p]=r.call(a||this,s[p],p,s);return h}function de(s,r,a){const h={};for(const p in s)r.call(a||this,s[p],p,s)&&(h[p]=s[p]);return h}function Me(s){return Array.isArray(s)?s.map(Me):"object"==typeof s&&s?$(s,Me):s}const Ie={};function De(s){Ie[s]||(typeof console<"u"&&console.warn(s),Ie[s]=!0)}function oe(s,r,a){return(a.y-s.y)*(r.x-s.x)>(r.y-s.y)*(a.x-s.x)}function ve(s){let r=0;for(let a,h,p=0,g=s.length,v=g-1;p<g;v=p++)a=s[p],h=s[v],r+=(h.x-a.x)*(a.y+h.y);return r}function xe(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Re(s){const r={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,h,p,g)=>{const v=p||g;return r[h]=!v||v.toLowerCase(),""}),r["max-age"]){const a=parseInt(r["max-age"],10);isNaN(a)?delete r["max-age"]:r["max-age"]=a}return r}let we=null;function Le(s){if(null==we){const r=s.navigator?s.navigator.userAgent:null;we=!!s.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return we}function Ne(s){try{const r=re[s];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ze(s,r){return[s[4*r],s[4*r+1],s[4*r+2],s[4*r+3]]}const at="mapbox-tiles";let wt,Tt,Ut=500,bt=50;function lt(){try{return re.caches}catch{}}function Pe(){lt()&&!wt&&(wt=re.caches.open(at))}function je(s){const r=s.indexOf("?");if(r<0)return s;const h=function(p){const g=p.indexOf("?");return g>0?p.slice(g+1).split("&"):[]}(s).filter(p=>{const g=p.split("=");return"language"===g[0]||"worldview"===g[0]});return h.length?`${s.slice(0,r)}?${h.join("&")}`:s.slice(0,r)}let it=1/0;const ct={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(ct);class vt extends Error{constructor(r,a,h){401===a&&_r(h)&&(r+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(r),this.status=a,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Nt=xe()?()=>self.worker&&self.worker.referrer:()=>("blob:"===re.location.protocol?re.parent:re).location.href,Kt=function(s,r){if(!(/^file:/.test(a=s.url)||/^file:/.test(Nt())&&!/^\w+:/.test(a))){if(re.fetch&&re.Request&&re.AbortController&&re.Request.prototype.hasOwnProperty("signal"))return function(h,p){const g=new re.AbortController,v=new re.Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:Nt(),signal:g.signal});let b=!1,E=!1;const k=(X=v.url).indexOf("sku=")>0&&_r(X);var X;"json"===h.type&&v.headers.set("Accept","application/json");const se=(_e,Ee,Oe)=>{if(E)return;if(_e&&"SecurityError"!==_e.message&&De(_e),Ee&&Oe)return he(Ee);const Ve=Date.now();re.fetch(v).then(tt=>{if(tt.ok){const ht=k?tt.clone():null;return he(tt,ht,Ve)}return p(new vt(tt.statusText,tt.status,h.url))}).catch(tt=>{20!==tt.code&&p(new Error(tt.message))})},he=(_e,Ee,Oe)=>{("arrayBuffer"===h.type?_e.arrayBuffer():"json"===h.type?_e.json():_e.text()).then(Ve=>{E||(Ee&&Oe&&function(tt,ht,et){if(Pe(),!wt)return;const st={status:ht.status,statusText:ht.statusText,headers:new re.Headers};ht.headers.forEach((Ot,It)=>st.headers.set(It,Ot));const dt=Re(ht.headers.get("Cache-Control")||"");if(dt["no-store"])return;dt["max-age"]&&st.headers.set("Expires",new Date(et+1e3*dt["max-age"]).toUTCString());const ut=st.headers.get("Expires");ut&&(new Date(ut).getTime()-et<42e4||function(Ot,It){if(void 0===Tt)try{new Response(new ReadableStream),Tt=!0}catch{Tt=!1}Tt?It(Ot.body):Ot.blob().then(It)}(ht,Ot=>{const It=new re.Response(Ot,st);Pe(),wt&&wt.then(Wt=>Wt.put(je(tt.url),It)).catch(Wt=>De(Wt.message))}))}(v,Ee,Oe),b=!0,p(null,Ve,_e.headers.get("Cache-Control"),_e.headers.get("Expires")))}).catch(Ve=>{E||p(new Error(Ve.message))})};return k?function(_e,Ee){if(Pe(),!wt)return Ee(null);const Oe=je(_e.url);wt.then(Ve=>{Ve.match(Oe).then(tt=>{const ht=function(et){if(!et)return!1;const st=new Date(et.headers.get("Expires")||0),dt=Re(et.headers.get("Cache-Control")||"");return st>Date.now()&&!dt["no-cache"]}(tt);Ve.delete(Oe),ht&&Ve.put(Oe,tt.clone()),Ee(null,tt,ht)}).catch(Ee)}).catch(Ee)}(v,se):se(null,null),{cancel:()=>{E=!0,b||g.abort()}}}(s,r);if(xe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,r,void 0,!0)}var a;return function(h,p){const g=new re.XMLHttpRequest;g.open(h.method||"GET",h.url,!0),"arrayBuffer"===h.type&&(g.responseType="arraybuffer");for(const v in h.headers)g.setRequestHeader(v,h.headers[v]);return"json"===h.type&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials="include"===h.credentials,g.onerror=()=>{p(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||0===g.status)&&null!==g.response){let v=g.response;if("json"===h.type)try{v=JSON.parse(g.response)}catch(b){return p(b)}p(null,v,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else p(new vt(g.statusText,g.status,h.url))},g.send(h.body),{cancel:()=>g.abort()}}(s,r)},vi=function(s,r){return Kt(S(s,{type:"arrayBuffer"}),r)};function Ki(s){const r=re.document.createElement("a");return r.href=s,r.protocol===re.document.location.protocol&&r.host===re.document.location.host}const mi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ii,xn;Ii=[],xn=0;const Qi=function(s,r){if(Se.supported&&(s.headers||(s.headers={}),s.headers.accept="image/webp,*/*"),xn>=Ce.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:s,callback:r,cancelled:!1,cancel(){this.cancelled=!0}};return Ii.push(g),g}xn++;let a=!1;const h=()=>{if(!a)for(a=!0,xn--;Ii.length&&xn<Ce.MAX_PARALLEL_IMAGE_REQUESTS;){const g=Ii.shift(),{requestParameters:v,callback:b,cancelled:E}=g;E||(g.cancel=Qi(v,b).cancel)}},p=vi(s,(g,v,b,E)=>{h(),g?r(g):v&&(re.createImageBitmap?function(k,X){const se=new re.Blob([new Uint8Array(k)],{type:"image/png"});re.createImageBitmap(se).then(he=>{X(null,he)}).catch(he=>{X(new Error(`Could not load image because of ${he.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(k,X)=>r(k,X,b,E)):function(k,X){const se=new re.Image,he=re.URL;se.onload=()=>{X(null,se),he.revokeObjectURL(se.src),se.onload=null,re.requestAnimationFrame(()=>{se.src=mi})},se.onerror=()=>X(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const _e=new re.Blob([new Uint8Array(k)],{type:"image/png"});se.src=k.byteLength?he.createObjectURL(_e):mi}(v,(k,X)=>r(k,X,b,E)))});return{cancel:()=>{p.cancel(),h()}}},bn="NO_ACCESS_TOKEN";function Ri(s){return 0===s.indexOf("mapbox:")}function _r(s){return Ce.API_URL_REGEX.test(s)}function Er(s){return Ce.API_CDN_URL_REGEX.test(s)}function or(s){return Ce.API_STYLE_REGEX.test(s)&&!go(s)}function go(s){return Ce.API_SPRITE_REGEX.test(s)}const yr=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function kr(s){const r=s.match(yr);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function Fr(s){const r=s.params.length?`?${s.params.join("&")}`:"";return`${s.protocol}://${s.authority}${s.path}${r}`}function _o(s){if(!s)return null;const r=s.split(".");if(!r||3!==r.length)return null;try{return JSON.parse(decodeURIComponent(re.atob(r[1]).split("").map(a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Qe{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const a=_o(Ce.ACCESS_TOKEN);let h="";return h=a&&a.u?re.btoa(encodeURIComponent(a.u).replace(/%([0-9A-F]{2})/g,(p,g)=>String.fromCharCode(Number("0x"+g)))):Ce.ACCESS_TOKEN||"",r?`mapbox.eventData.${r}:${h}`:`mapbox.eventData:${h}`}fetchEventData(){const r=Ne("localStorage"),a=this.getStorageKey(),h=this.getStorageKey("uuid");if(r)try{const p=re.localStorage.getItem(a);p&&(this.eventData=JSON.parse(p));const g=re.localStorage.getItem(h);g&&(this.anonId=g)}catch{De("Unable to read from LocalStorage")}}saveEventData(){const r=Ne("localStorage"),a=this.getStorageKey(),h=this.getStorageKey("uuid");if(r)try{re.localStorage.setItem(h,this.anonId),Object.keys(this.eventData).length>=1&&re.localStorage.setItem(a,JSON.stringify(this.eventData))}catch{De("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,a,h,p){if(!Ce.EVENTS_URL)return;const g=kr(Ce.EVENTS_URL);g.params.push(`access_token=${p||Ce.ACCESS_TOKEN||""}`);const v={event:this.type,created:new Date(r).toISOString()},b=a?S(v,a):v,E={url:Fr(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([b])};var X;this.pendingRequest=(X=k=>{this.pendingRequest=null,h(k),this.saveEventData(),this.processRequests(p)},Kt(S(E,{method:"POST"}),X))}queueRequest(r,a){this.queue.push(r),this.processRequests(a)}}const Ae=new class extends Qe{constructor(s){super("appUserTurnstile"),this._customAccessToken=s}postTurnstileEvent(s,r){Ce.EVENTS_URL&&Ce.ACCESS_TOKEN&&Array.isArray(s)&&s.some(a=>Ri(a)||_r(a))&&this.queueRequest(Date.now(),r)}processRequests(s){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=_o(Ce.ACCESS_TOKEN),a=r?r.u:Ce.ACCESS_TOKEN;let h=a!==this.eventData.tokenU;ue(this.anonId)||(this.anonId=Z(),h=!0);const p=this.queue.shift();if(this.eventData.lastSuccess){const g=new Date(this.eventData.lastSuccess),v=new Date(p),b=(p-this.eventData.lastSuccess)/864e5;h=h||b>=1||b<-1||g.getDate()!==v.getDate()}else h=!0;h?this.postEvent(p,{sdkIdentifier:"mapbox-gl-js",sdkVersion:me,skuId:j,"enabled.telemetry":!1,userId:this.anonId},g=>{g||(this.eventData.lastSuccess=p,this.eventData.tokenU=a)},s):this.processRequests()}},Fe=Ae.postTurnstileEvent.bind(Ae),Ke=new class extends Qe{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(s,r,a,h){this.skuToken=r,this.errorCb=h,Ce.EVENTS_URL&&(a||Ce.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},a):this.errorCb(new Error(bn)))}processRequests(s){if(this.pendingRequest||0===this.queue.length)return;const{id:r,timestamp:a}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),ue(this.anonId)||(this.anonId=Z()),this.postEvent(a,{sdkIdentifier:"mapbox-gl-js",sdkVersion:me,skuId:j,skuToken:this.skuToken,userId:this.anonId},h=>{h?this.errorCb(h):r&&(this.success[r]=!0)},s))}},nt=Ke.postMapLoadEvent.bind(Ke),gt=new class extends Qe{constructor(){super("gljs.performance")}postPerformanceEvent(s,r){Ce.EVENTS_URL&&(s||Ce.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},s)}processRequests(s){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:r,performanceData:a}=this.queue.shift(),h=function(p){const g=re.performance.getEntriesByType("resource"),v=re.performance.getEntriesByType("mark"),b=function(he){const _e={};if(he)for(const Ee in he)if("other"!==Ee)for(const Oe of he[Ee]){const Ve=`${Ee}ResolveRangeMin`,tt=`${Ee}ResolveRangeMax`,ht=`${Ee}RequestCount`,et=`${Ee}RequestCachedCount`;_e[Ve]=Math.min(_e[Ve]||1/0,Oe.startTime),_e[tt]=Math.max(_e[tt]||-1/0,Oe.responseEnd);const st=dt=>{void 0===_e[dt]&&(_e[dt]=0),++_e[dt]};void 0!==Oe.transferSize&&0===Oe.transferSize&&st(et),st(ht)}return _e}(function(he,_e){const Ee={};if(he)for(const Oe of he){const Ve=_e(Oe);void 0===Ee[Ve]&&(Ee[Ve]=[]),Ee[Ve].push(Oe)}return Ee}(g,ni)),E=re.devicePixelRatio,k=re.navigator.connection||re.navigator.mozConnection||re.navigator.webkitConnection,X={counters:[],metadata:[],attributes:[]},se=(he,_e,Ee)=>{null!=Ee&&he.push({name:_e,value:Ee.toString()})};for(const he in b)se(X.counters,he,b[he]);if(p.interactionRange[0]!==1/0&&p.interactionRange[1]!==-1/0&&(se(X.counters,"interactionRangeMin",p.interactionRange[0]),se(X.counters,"interactionRangeMax",p.interactionRange[1])),v)for(const he of Object.keys(Yt)){const _e=Yt[he],Ee=v.find(Oe=>Oe.name===_e);Ee&&se(X.counters,_e,Ee.startTime)}return se(X.counters,"visibilityHidden",p.visibilityHidden),se(X.attributes,"style",function(he){if(he)for(const _e of he){const Ee=_e.name.split("?")[0];if(or(Ee)){const Oe=Ee.split("/").slice(-2);if(2===Oe.length)return`mapbox://styles/${Oe[0]}/${Oe[1]}`}}}(g)),se(X.attributes,"terrainEnabled",p.terrainEnabled?"true":"false"),se(X.attributes,"fogEnabled",p.fogEnabled?"true":"false"),se(X.attributes,"projection",p.projection),se(X.attributes,"zoom",p.zoom),se(X.metadata,"devicePixelRatio",E),se(X.metadata,"connectionEffectiveType",k?k.effectiveType:void 0),se(X.metadata,"navigatorUserAgent",re.navigator.userAgent),se(X.metadata,"screenWidth",re.screen.width),se(X.metadata,"screenHeight",re.screen.height),se(X.metadata,"windowWidth",re.innerWidth),se(X.metadata,"windowHeight",re.innerHeight),se(X.metadata,"mapWidth",p.width/E),se(X.metadata,"mapHeight",p.height/E),se(X.metadata,"webglRenderer",p.renderer),se(X.metadata,"webglVendor",p.vendor),se(X.metadata,"sdkVersion",me),se(X.metadata,"sdkIdentifier","mapbox-gl-js"),X}(a);for(const p of h.metadata);for(const p of h.counters);for(const p of h.attributes);this.postEvent(r,h,()=>{},s)}},Dt=gt.postPerformanceEvent.bind(gt),Et=new class extends Qe{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(s,r,a,h){if(!Ce.API_URL||!Ce.SESSION_PATH)return;const p=kr(Ce.API_URL+Ce.SESSION_PATH);p.params.push(`sku=${r||""}`),p.params.push(`access_token=${h||Ce.ACCESS_TOKEN||""}`);const g={url:Fr(p),headers:{"Content-Type":"text/plain"}};var b;this.pendingRequest=(b=v=>{this.pendingRequest=null,a(v),this.saveEventData(),this.processRequests(h)},Kt(S(g,{method:"GET"}),b))}getSessionAPI(s,r,a,h){this.skuToken=r,this.errorCb=h,Ce.SESSION_PATH&&Ce.API_URL&&(a||Ce.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},a):this.errorCb(new Error(bn)))}processRequests(s){if(this.pendingRequest||0===this.queue.length)return;const{id:r,timestamp:a}=this.queue.shift();r&&this.success[r]||this.getSession(a,this.skuToken,h=>{h?this.errorCb(h):r&&(this.success[r]=!0)},s)}},_t=Et.getSessionAPI.bind(Et),Mt=new Set,Yt={create:"create",load:"load",fullLoad:"fullLoad"},gi={mark(s){re.performance.mark(s)},measure(s,r,a){re.performance.measure(s,r,a)}};function ni(s){const r=s.name.split("?")[0];return Er(r)&&r.includes("mapbox-gl.js")?"javascript":Er(r)&&r.includes("mapbox-gl.css")?"css":Ce.API_FONTS_REGEX.test(r)?"fontRange":go(r)?"sprite":or(r)?"style":Ce.API_TILEJSON_REGEX.test(r)?"tilejson":"other"}const Hi=re.performance;function zi(s){const r=s?s.url.toString():void 0;return Hi.getEntriesByName(r)}let Pi,Yi,dn,Xn;const Li={now:()=>void 0!==dn?dn:re.performance.now(),setNow(s){dn=s},restoreNow(){dn=void 0},frame(s){const r=re.requestAnimationFrame(s);return{cancel:()=>re.cancelAnimationFrame(r)}},getImageData(s,r=0){const{width:a,height:h}=s;Xn||(Xn=re.document.createElement("canvas"));const p=Xn.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(a>Xn.width||h>Xn.height)&&(Xn.width=a,Xn.height=h),p.clearRect(-r,-r,a+2*r,h+2*r),p.drawImage(s,0,0,a,h),p.getImageData(-r,-r,a+2*r,h+2*r)},resolveURL:s=>(Pi||(Pi=re.document.createElement("a")),Pi.href=s,Pi.href),get devicePixelRatio(){return re.devicePixelRatio},get prefersReducedMotion(){return!!re.matchMedia&&(null==Yi&&(Yi=re.matchMedia("(prefers-reduced-motion: reduce)")),Yi.matches)}};function sr(s,r,a){a[s]&&-1!==a[s].indexOf(r)||(a[s]=a[s]||[],a[s].push(r))}function vr(s,r,a){if(a&&a[s]){const h=a[s].indexOf(r);-1!==h&&a[s].splice(h,1)}}class Pa{constructor(r,a={}){S(this,a),this.type=r}}class bl extends Pa{constructor(r,a={}){super("error",S({error:r},a))}}class Ws{on(r,a){return this._listeners=this._listeners||{},sr(r,a,this._listeners),this}off(r,a){return vr(r,a,this._listeners),vr(r,a,this._oneTimeListeners),this}once(r,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},sr(r,a,this._oneTimeListeners),this):new Promise(h=>this.once(r,h))}fire(r,a){"string"==typeof r&&(r=new Pa(r,a||{}));const h=r.type;if(this.listens(h)){r.target=this;const p=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const b of p)b.call(this,r);const g=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const b of g)vr(h,b,this._oneTimeListeners),b.call(this,r);const v=this._eventedParent;v&&(S(r,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),v.fire(r))}else r instanceof bl&&console.error(r.error);return this}listens(r){return!!(this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r))}setEventedParent(r,a){return this._eventedParent=r,this._eventedParentData=a,this}}var $t=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ya(s,...r){for(const a of r)for(const h in a)s[h]=a[h];return s}function io(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function xr(s){if(Array.isArray(s))return s.map(xr);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const r={};for(const a in s)r[a]=xr(s[a]);return r}return io(s)}class ys extends Error{constructor(r,a){super(a),this.message=a,this.key=r}}var vs=ys;class Nc{constructor(r,a=[]){this.parent=r,this.bindings={};for(const[h,p]of a)this.bindings[h]=p}concat(r){return new Nc(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}var br=Nc;const Mo={kind:"null"},ri={kind:"number"},Sn={kind:"string"},Tn={kind:"boolean"},On={kind:"color"},tn={kind:"object"},pn={kind:"value"},vu={kind:"collator"},ti={kind:"formatted"},ca={kind:"resolvedImage"};function Gi(s,r){return{kind:"array",itemType:s,N:r}}function Ji(s){if("array"===s.kind){const r=Ji(s.itemType);return"number"==typeof s.N?`array<${r}, ${s.N}>`:"value"===s.itemType.kind?"array":`array<${r}>`}return s.kind}const Oa=[Mo,ri,Sn,Tn,On,ti,tn,Gi(pn),ca];function xu(s,r){if("error"===r.kind)return null;if("array"===s.kind){if("array"===r.kind&&(0===r.N&&"value"===r.itemType.kind||!xu(s.itemType,r.itemType))&&("number"!=typeof s.N||s.N===r.N))return null}else{if(s.kind===r.kind)return null;if("value"===s.kind)for(const a of Oa)if(!xu(a,r))return null}return`Expected ${Ji(s)} but found ${Ji(r)} instead.`}function Eh(s,r){return r.some(a=>a.kind===s.kind)}function wl(s,r){return r.some(a=>"null"===a?null===s:"array"===a?Array.isArray(s):"object"===a?s&&!Array.isArray(s)&&"object"==typeof s:a===typeof s)}var So,wf={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Cl(s){return(s=Math.round(s))<0?0:s>255?255:s}function bu(s){return Cl("%"===s[s.length-1]?parseFloat(s)/100*255:parseInt(s))}function Xs(s){return(r="%"===s[s.length-1]?parseFloat(s)/100:parseFloat(s))<0?0:r>1?1:r;var r}function Cf(s,r,a){return a<0?a+=1:a>1&&(a-=1),6*a<1?s+(r-s)*a*6:2*a<1?r:3*a<2?s+(r-s)*(2/3-a)*6:s}try{So={}.parseCSSColor=function(s){var r,a=s.replace(/ /g,"").toLowerCase();if(a in wf)return wf[a].slice();if("#"===a[0])return 4===a.length?(r=parseInt(a.substr(1),16))>=0&&r<=4095?[(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,1]:null:7===a.length&&(r=parseInt(a.substr(1),16))>=0&&r<=16777215?[(16711680&r)>>16,(65280&r)>>8,255&r,1]:null;var h=a.indexOf("("),p=a.indexOf(")");if(-1!==h&&p+1===a.length){var g=a.substr(0,h),v=a.substr(h+1,p-(h+1)).split(","),b=1;switch(g){case"rgba":if(4!==v.length)return null;b=Xs(v.pop());case"rgb":return 3!==v.length?null:[bu(v[0]),bu(v[1]),bu(v[2]),b];case"hsla":if(4!==v.length)return null;b=Xs(v.pop());case"hsl":if(3!==v.length)return null;var E=(parseFloat(v[0])%360+360)%360/360,k=Xs(v[1]),X=Xs(v[2]),se=X<=.5?X*(k+1):X+k-X*k,he=2*X-se;return[Cl(255*Cf(he,se,E+1/3)),Cl(255*Cf(he,se,E)),Cl(255*Cf(he,se,E-1/3)),b];default:return null}}return null}}catch{}class Ps{constructor(r,a,h,p=1){this.r=r,this.g=a,this.b=h,this.a=p}static parse(r){if(!r)return;if(r instanceof Ps)return r;if("string"!=typeof r)return;const a=So(r);return a?new Ps(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toString(){const[r,a,h,p]=this.toArray();return`rgba(${Math.round(r)},${Math.round(a)},${Math.round(h)},${p})`}toArray(){const{r,g:a,b:h,a:p}=this;return 0===p?[0,0,0,0]:[255*r/p,255*a/p,255*h/p,p]}toArray01(){const{r,g:a,b:h,a:p}=this;return 0===p?[0,0,0,0]:[r/p,a/p,h/p,p]}toArray01PremultipliedAlpha(){const{r,g:a,b:h,a:p}=this;return[r,a,h,p]}}Ps.black=new Ps(0,0,0,1),Ps.white=new Ps(1,1,1,1),Ps.transparent=new Ps(0,0,0,0),Ps.red=new Ps(1,0,0,1),Ps.blue=new Ps(0,0,1,1);var Ur=Ps;class wu{constructor(r,a,h){this.sensitivity=r?a?"variant":"case":a?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,a){return this.collator.compare(r,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class $d{constructor(r,a,h,p,g){this.text=r.normalize?r.normalize():r,this.image=a,this.scale=h,this.fontStack=p,this.textColor=g}}class Vo{constructor(r){this.sections=r}static fromString(r){return new Vo([new $d(r,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(r=>0!==r.text.length||r.image&&0!==r.image.name.length)}static factory(r){return r instanceof Vo?r:Vo.fromString(r)}toString(){return 0===this.sections.length?"":this.sections.map(r=>r.text).join("")}serialize(){const r=["format"];for(const a of this.sections){if(a.image){r.push(["image",a.image.name]);continue}r.push(a.text);const h={};a.fontStack&&(h["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(h["font-scale"]=a.scale),a.textColor&&(h["text-color"]=["rgba"].concat(a.textColor.toArray())),r.push(h)}return r}}class qs{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new qs({name:r,available:!1}):null}serialize(){return["image",this.name]}}function Ag(s,r,a,h){return"number"==typeof s&&s>=0&&s<=255&&"number"==typeof r&&r>=0&&r<=255&&"number"==typeof a&&a>=0&&a<=255?void 0===h||"number"==typeof h&&h>=0&&h<=1?null:`Invalid rgba value [${[s,r,a,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof h?[s,r,a,h]:[s,r,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function jo(s){if(null===s||"string"==typeof s||"boolean"==typeof s||"number"==typeof s||s instanceof Ur||s instanceof wu||s instanceof Vo||s instanceof qs)return!0;if(Array.isArray(s)){for(const r of s)if(!jo(r))return!1;return!0}if("object"==typeof s){for(const r in s)if(!jo(s[r]))return!1;return!0}return!1}function an(s){if(null===s)return Mo;if("string"==typeof s)return Sn;if("boolean"==typeof s)return Tn;if("number"==typeof s)return ri;if(s instanceof Ur)return On;if(s instanceof wu)return vu;if(s instanceof Vo)return ti;if(s instanceof qs)return ca;if(Array.isArray(s)){const r=s.length;let a;for(const h of s){const p=an(h);if(a){if(a===p)continue;a=pn;break}a=p}return Gi(a||pn,r)}return tn}function Cu(s){const r=typeof s;return null===s?"":"string"===r||"number"===r||"boolean"===r?String(s):s instanceof Ur||s instanceof Vo||s instanceof qs?s.toString():JSON.stringify(s)}class Ef{constructor(r,a){this.type=r,this.value=a}static parse(r,a){if(2!==r.length)return a.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!jo(r[1]))return a.error("invalid value");const h=r[1];let p=an(h);const g=a.expectedType;return"array"!==p.kind||0!==p.N||!g||"array"!==g.kind||"number"==typeof g.N&&0!==g.N||(p=g),new Ef(p,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Ur?["rgba"].concat(this.value.toArray()):this.value instanceof Vo?this.value.serialize():this.value}}var Eu=Ef,hi=class{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}};const Mh={string:Sn,number:ri,boolean:Tn,object:tn};class fn{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");let h,p=1;const g=r[0];if("array"===g){let b,E;if(r.length>2){const k=r[1];if("string"!=typeof k||!(k in Mh)||"object"===k)return a.error('The item type argument of "array" must be one of string, number, boolean',1);b=Mh[k],p++}else b=pn;if(r.length>3){if(null!==r[2]&&("number"!=typeof r[2]||r[2]<0||r[2]!==Math.floor(r[2])))return a.error('The length argument to "array" must be a positive integer literal',2);E=r[2],p++}h=Gi(b,E)}else h=Mh[g];const v=[];for(;p<r.length;p++){const b=a.parse(r[p],p,pn);if(!b)return null;v.push(b)}return new fn(h,v)}evaluate(r){for(let a=0;a<this.args.length;a++){const h=this.args[a].evaluate(r);if(!xu(this.type,an(h)))return h;if(a===this.args.length-1)throw new hi(`Expected value to be of type ${Ji(this.type)}, but found ${Ji(an(h))} instead.`)}return null}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=this.type,a=[r.kind];if("array"===r.kind){const h=r.itemType;if("string"===h.kind||"number"===h.kind||"boolean"===h.kind){a.push(h.kind);const p=r.N;("number"==typeof p||this.args.length>1)&&a.push(p)}}return a.concat(this.args.map(h=>h.serialize()))}}var Ys=fn;class Sh{constructor(r){this.type=ti,this.sections=r}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");const h=r[1];if(!Array.isArray(h)&&"object"==typeof h)return a.error("First argument must be an image or text section.");const p=[];let g=!1;for(let v=1;v<=r.length-1;++v){const b=r[v];if(g&&"object"==typeof b&&!Array.isArray(b)){g=!1;let E=null;if(b["font-scale"]&&(E=a.parse(b["font-scale"],1,ri),!E))return null;let k=null;if(b["text-font"]&&(k=a.parse(b["text-font"],1,Gi(Sn)),!k))return null;let X=null;if(b["text-color"]&&(X=a.parse(b["text-color"],1,On),!X))return null;const se=p[p.length-1];se.scale=E,se.font=k,se.textColor=X}else{const E=a.parse(r[v],1,pn);if(!E)return null;const k=E.type.kind;if("string"!==k&&"value"!==k&&"null"!==k&&"resolvedImage"!==k)return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,p.push({content:E,scale:null,font:null,textColor:null})}}return new Sh(p)}evaluate(r){return new Vo(this.sections.map(a=>{const h=a.content.evaluate(r);return an(h)===ca?new $d("",h,null,null,null):new $d(Cu(h),null,a.scale?a.scale.evaluate(r):null,a.font?a.font.evaluate(r).join(","):null,a.textColor?a.textColor.evaluate(r):null)}))}eachChild(r){for(const a of this.sections)r(a.content),a.scale&&r(a.scale),a.font&&r(a.font),a.textColor&&r(a.textColor)}outputDefined(){return!1}serialize(){const r=["format"];for(const a of this.sections){r.push(a.content.serialize());const h={};a.scale&&(h["font-scale"]=a.scale.serialize()),a.font&&(h["text-font"]=a.font.serialize()),a.textColor&&(h["text-color"]=a.textColor.serialize()),r.push(h)}return r}}class Th{constructor(r){this.type=ca,this.input=r}static parse(r,a){if(2!==r.length)return a.error("Expected two arguments.");const h=a.parse(r[1],1,Sn);return h?new Th(h):a.error("No image name provided.")}evaluate(r){const a=this.input.evaluate(r),h=qs.fromString(a);return h&&r.availableImages&&(h.available=r.availableImages.indexOf(a)>-1),h}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const kg={"to-boolean":Tn,"to-color":On,"to-number":ri,"to-string":Sn};class Wd{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");const h=r[0];if(("to-boolean"===h||"to-string"===h)&&2!==r.length)return a.error("Expected one argument.");const p=kg[h],g=[];for(let v=1;v<r.length;v++){const b=a.parse(r[v],v,pn);if(!b)return null;g.push(b)}return new Wd(p,g)}evaluate(r){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(r));if("color"===this.type.kind){let a,h;for(const p of this.args){if(a=p.evaluate(r),h=null,a instanceof Ur)return a;if("string"==typeof a){const g=r.parseColor(a);if(g)return g}else if(Array.isArray(a)&&(h=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:Ag(a[0],a[1],a[2],a[3]),!h))return new Ur(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new hi(h||`Could not parse color from value '${"string"==typeof a?a:String(JSON.stringify(a))}'`)}if("number"===this.type.kind){let a=null;for(const h of this.args){if(a=h.evaluate(r),null===a)return 0;const p=Number(a);if(!isNaN(p))return p}throw new hi(`Could not convert ${JSON.stringify(a)} to number.`)}return"formatted"===this.type.kind?Vo.fromString(Cu(this.args[0].evaluate(r))):"resolvedImage"===this.type.kind?qs.fromString(Cu(this.args[0].evaluate(r))):Cu(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Sh([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Th(this.args[0]).serialize();const r=[`to-${this.type.kind}`];return this.eachChild(a=>{r.push(a.serialize())}),r}}var El=Wd;const ic=["Unknown","Point","LineString","Polygon"];var Mu=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?ic[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const s=this.featureDistanceData.center,r=this.featureDistanceData.scale,{x:a,y:h}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(a*r-s[0])+this.featureDistanceData.bearing[1]*(h*r-s[1])}return 0}parseColor(s){let r=this._parseColorCache[s];return r||(r=this._parseColorCache[s]=Ur.parse(s)),r}};class nc{constructor(r,a,h,p){this.name=r,this.type=a,this._evaluate=h,this.args=p}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(r=>r.serialize()))}static parse(r,a){const h=r[0],p=nc.definitions[h];if(!p)return a.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(p)?p[0]:p.type,v=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,b=v.filter(([k])=>!Array.isArray(k)||k.length===r.length-1);let E=null;for(const[k,X]of b){E=new Sl(a.registry,a.path,null,a.scope);const se=[];let he=!1;for(let _e=1;_e<r.length;_e++){const Ee=r[_e],Oe=Array.isArray(k)?k[_e-1]:k.type,Ve=E.parse(Ee,1+se.length,Oe);if(!Ve){he=!0;break}se.push(Ve)}if(!he)if(Array.isArray(k)&&k.length!==se.length)E.error(`Expected ${k.length} arguments, but found ${se.length} instead.`);else{for(let _e=0;_e<se.length;_e++){const Ee=Array.isArray(k)?k[_e]:k.type,Oe=se[_e];E.concat(_e+1).checkSubtype(Ee,Oe.type)}if(0===E.errors.length)return new nc(h,g,X,se)}}if(1===b.length)a.errors.push(...E.errors);else{const k=(b.length?b:v).map(([se])=>{return he=se,Array.isArray(he)?`(${he.map(Ji).join(", ")})`:`(${Ji(he.type)}...)`;var he}).join(" | "),X=[];for(let se=1;se<r.length;se++){const he=a.parse(r[se],1+X.length);if(!he)return null;X.push(Ji(he.type))}a.error(`Expected arguments of type ${k}, but found (${X.join(", ")}) instead.`)}return null}static register(r,a){nc.definitions=a;for(const h in a)r[h]=nc}}var Ml=nc;class nn{constructor(r,a,h){this.type=vu,this.locale=h,this.caseSensitive=r,this.diacriticSensitive=a}static parse(r,a){if(2!==r.length)return a.error("Expected one argument.");const h=r[1];if("object"!=typeof h||Array.isArray(h))return a.error("Collator options argument must be an object.");const p=a.parse(void 0!==h["case-sensitive"]&&h["case-sensitive"],1,Tn);if(!p)return null;const g=a.parse(void 0!==h["diacritic-sensitive"]&&h["diacritic-sensitive"],1,Tn);if(!g)return null;let v=null;return h.locale&&(v=a.parse(h.locale,1,Sn),!v)?null:new nn(p,g,v)}evaluate(r){return new wu(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}serialize(){const r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]}}const co=8192;function Su(s,r){s[0]=Math.min(s[0],r[0]),s[1]=Math.min(s[1],r[1]),s[2]=Math.max(s[2],r[0]),s[3]=Math.max(s[3],r[1])}function Uo(s,r){return!(s[0]<=r[0]||s[2]>=r[2]||s[1]<=r[1]||s[3]>=r[3])}function Xd(s,r){const a=(180+s[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,p=Math.pow(2,r.z);return[Math.round(a*p*co),Math.round(h*p*co)]}function Ig(s,r,a){const h=s[0]-r[0],p=s[1]-r[1],g=s[0]-a[0],v=s[1]-a[1];return h*v-g*p==0&&h*g<=0&&p*v<=0}function ha(s,r){let a=!1;for(let v=0,b=r.length;v<b;v++){const E=r[v];for(let k=0,X=E.length;k<X-1;k++){if(Ig(s,E[k],E[k+1]))return!1;(p=E[k])[1]>(h=s)[1]!=(g=E[k+1])[1]>h[1]&&h[0]<(g[0]-p[0])*(h[1]-p[1])/(g[1]-p[1])+p[0]&&(a=!a)}}var h,p,g;return a}function Zs(s,r){for(let a=0;a<r.length;a++)if(ha(s,r[a]))return!0;return!1}function qd(s,r,a,h){const p=h[0]-a[0],g=h[1]-a[1],v=(s[0]-a[0])*g-p*(s[1]-a[1]),b=(r[0]-a[0])*g-p*(r[1]-a[1]);return v>0&&b<0||v<0&&b>0}function Tu(s,r,a){for(const k of a)for(let X=0;X<k.length-1;++X)if((b=[(v=k[X+1])[0]-(g=k[X])[0],v[1]-g[1]])[0]*(E=[(p=r)[0]-(h=s)[0],p[1]-h[1]])[1]-b[1]*E[0]!=0&&qd(h,p,g,v)&&qd(g,v,h,p))return!0;var h,p,g,v,b,E;return!1}function Os(s,r){for(let a=0;a<s.length;++a)if(!ha(s[a],r))return!1;for(let a=0;a<s.length-1;++a)if(Tu(s[a],s[a+1],r))return!1;return!0}function wr(s,r){for(let a=0;a<r.length;a++)if(Os(s,r[a]))return!0;return!1}function Du(s,r,a){const h=[];for(let p=0;p<s.length;p++){const g=[];for(let v=0;v<s[p].length;v++){const b=Xd(s[p][v],a);Su(r,b),g.push(b)}h.push(g)}return h}function Mf(s,r,a){const h=[];for(let p=0;p<s.length;p++){const g=Du(s[p],r,a);h.push(g)}return h}function Ks(s,r,a,h){if(s[0]<a[0]||s[0]>a[2]){const p=.5*h;let g=s[0]-a[0]>p?-h:a[0]-s[0]>p?h:0;0===g&&(g=s[0]-a[2]>p?-h:a[2]-s[0]>p?h:0),s[0]+=g}Su(r,s)}function Vi(s,r,a,h){const p=Math.pow(2,h.z)*co,g=[h.x*co,h.y*co],v=[];if(!s)return v;for(const b of s)for(const E of b){const k=[E.x+g[0],E.y+g[1]];Ks(k,r,a,p),v.push(k)}return v}function Dh(s,r,a,h){const p=Math.pow(2,h.z)*co,g=[h.x*co,h.y*co],v=[];if(!s)return v;for(const E of s){const k=[];for(const X of E){const se=[X.x+g[0],X.y+g[1]];Su(r,se),k.push(se)}v.push(k)}if(r[2]-r[0]<=p/2){(b=r)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const E of v)for(const k of E)Ks(k,r,a,p)}var b;return v}class rc{constructor(r,a){this.type=Tn,this.geojson=r,this.geometries=a}static parse(r,a){if(2!==r.length)return a.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(jo(r[1])){const h=r[1];if("FeatureCollection"===h.type)for(let p=0;p<h.features.length;++p){const g=h.features[p].geometry.type;if("Polygon"===g||"MultiPolygon"===g)return new rc(h,h.features[p].geometry)}else if("Feature"===h.type){const p=h.geometry.type;if("Polygon"===p||"MultiPolygon"===p)return new rc(h,h.geometry)}else if("Polygon"===h.type||"MultiPolygon"===h.type)return new rc(h,h)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(null!=r.geometry()&&null!=r.canonicalID()){if("Point"===r.geometryType())return function(a,h){const p=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(!v)return!1;if("Polygon"===h.type){const b=Du(h.coordinates,g,v),E=Vi(a.geometry(),p,g,v);if(!Uo(p,g))return!1;for(const k of E)if(!ha(k,b))return!1}if("MultiPolygon"===h.type){const b=Mf(h.coordinates,g,v),E=Vi(a.geometry(),p,g,v);if(!Uo(p,g))return!1;for(const k of E)if(!Zs(k,b))return!1}return!0}(r,this.geometries);if("LineString"===r.geometryType())return function(a,h){const p=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(!v)return!1;if("Polygon"===h.type){const b=Du(h.coordinates,g,v),E=Dh(a.geometry(),p,g,v);if(!Uo(p,g))return!1;for(const k of E)if(!Os(k,b))return!1}if("MultiPolygon"===h.type){const b=Mf(h.coordinates,g,v),E=Dh(a.geometry(),p,g,v);if(!Uo(p,g))return!1;for(const k of E)if(!wr(k,b))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Ah=rc;function oc(s){if(s instanceof Ml&&("get"===s.name&&1===s.args.length||"feature-state"===s.name||"has"===s.name&&1===s.args.length||"properties"===s.name||"geometry-type"===s.name||"id"===s.name||/^filter-/.test(s.name))||s instanceof Ah)return!1;let r=!0;return s.eachChild(a=>{r&&!oc(a)&&(r=!1)}),r}function Qs(s){if(s instanceof Ml&&"feature-state"===s.name)return!1;let r=!0;return s.eachChild(a=>{r&&!Qs(a)&&(r=!1)}),r}function Za(s,r){if(s instanceof Ml&&r.indexOf(s.name)>=0)return!1;let a=!0;return s.eachChild(h=>{a&&!Za(h,r)&&(a=!1)}),a}class Au{constructor(r,a){this.type=a.type,this.name=r,this.boundExpression=a}static parse(r,a){if(2!==r.length||"string"!=typeof r[1])return a.error("'var' expression requires exactly one string literal argument.");const h=r[1];return a.scope.has(h)?new Au(h,a.scope.get(h)):a.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Cr=Au;class ku{constructor(r,a=[],h,p=new br,g=[]){this.registry=r,this.path=a,this.key=a.map(v=>`[${v}]`).join(""),this.scope=p,this.errors=g,this.expectedType=h}parse(r,a,h,p,g={}){return a?this.concat(a,h,p)._parse(r,g):this._parse(r,g)}_parse(r,a){function h(p,g,v){return"assert"===v?new Ys(g,[p]):"coerce"===v?new El(g,[p]):p}if(null!==r&&"string"!=typeof r&&"boolean"!=typeof r&&"number"!=typeof r||(r=["literal",r]),Array.isArray(r)){if(0===r.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=r[0];if("string"!=typeof p)return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[p];if(g){let v=g.parse(r,this);if(!v)return null;if(this.expectedType){const b=this.expectedType,E=v.type;if("string"!==b.kind&&"number"!==b.kind&&"boolean"!==b.kind&&"object"!==b.kind&&"array"!==b.kind||"value"!==E.kind)if("color"!==b.kind&&"formatted"!==b.kind&&"resolvedImage"!==b.kind||"value"!==E.kind&&"string"!==E.kind){if(this.checkSubtype(b,E))return null}else v=h(v,b,a.typeAnnotation||"coerce");else v=h(v,b,a.typeAnnotation||"assert")}if(!(v instanceof Eu)&&"resolvedImage"!==v.type.kind&&sc(v)){const b=new Mu;try{v=new Eu(v.type,v.evaluate(b))}catch(E){return this.error(E.message),null}}return v}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===r?"'undefined' value invalid. Use null instead.":"object"==typeof r?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,a,h){const p="number"==typeof r?this.path.concat(r):this.path,g=h?this.scope.concat(h):this.scope;return new ku(this.registry,p,a||null,g,this.errors)}error(r,...a){const h=`${this.key}${a.map(p=>`[${p}]`).join("")}`;this.errors.push(new vs(h,r))}checkSubtype(r,a){const h=xu(r,a);return h&&this.error(h),h}}var Sl=ku;function sc(s){if(s instanceof Cr)return sc(s.boundExpression);if(s instanceof Ml&&"error"===s.name||s instanceof nn||s instanceof Ah)return!1;const r=s instanceof El||s instanceof Ys;let a=!0;return s.eachChild(h=>{a=r?a&&sc(h):a&&h instanceof Eu}),!!a&&oc(s)&&Za(s,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function mn(s,r){const a=s.length-1;let h,p,g=0,v=a,b=0;for(;g<=v;)if(b=Math.floor((g+v)/2),h=s[b],p=s[b+1],h<=r){if(b===a||r<p)return b;g=b+1}else{if(!(h>r))throw new hi("Input is not a number.");v=b-1}return 0}class kh{constructor(r,a,h){this.type=r,this.input=a,this.labels=[],this.outputs=[];for(const[p,g]of h)this.labels.push(p),this.outputs.push(g)}static parse(r,a){if(r.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");const h=a.parse(r[1],1,ri);if(!h)return null;const p=[];let g=null;a.expectedType&&"value"!==a.expectedType.kind&&(g=a.expectedType);for(let v=1;v<r.length;v+=2){const b=1===v?-1/0:r[v],E=r[v+1],k=v,X=v+1;if("number"!=typeof b)return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(p.length&&p[p.length-1][0]>=b)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const se=a.parse(E,X,g);if(!se)return null;g=g||se.type,p.push([b,se])}return new kh(g,h,p)}evaluate(r){const a=this.labels,h=this.outputs;if(1===a.length)return h[0].evaluate(r);const p=this.input.evaluate(r);if(p<=a[0])return h[0].evaluate(r);const g=a.length;return p>=a[g-1]?h[g-1].evaluate(r):h[mn(a,p)].evaluate(r)}eachChild(r){r(this.input);for(const a of this.outputs)r(a)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){const r=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&r.push(this.labels[a]),r.push(this.outputs[a].serialize());return r}}var Ih=kh;function ci(s,r,a){return s*(1-a)+r*a}var To=Object.freeze({__proto__:null,number:ci,color:function(s,r,a){return new Ur(ci(s.r,r.r,a),ci(s.g,r.g,a),ci(s.b,r.b,a),ci(s.a,r.a,a))},array:function(s,r,a){return s.map((h,p)=>ci(h,r[p],a))}});const Do=4/29,Ka=6/29,xs=3*Ka*Ka,Rs=Math.PI/180,Ai=180/Math.PI;function gn(s){return s>.008856451679035631?Math.pow(s,1/3):s/xs+Do}function Mr(s){return s>Ka?s*s*s:xs*(s-Do)}function ns(s){return 255*(s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055)}function Qa(s){return(s/=255)<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function ho(s){const r=Qa(s.r),a=Qa(s.g),h=Qa(s.b),p=gn((.4124564*r+.3575761*a+.1804375*h)/.95047),g=gn((.2126729*r+.7151522*a+.072175*h)/1);return{l:116*g-16,a:500*(p-g),b:200*(g-gn((.0193339*r+.119192*a+.9503041*h)/1.08883)),alpha:s.a}}function Tl(s){let r=(s.l+16)/116,a=isNaN(s.a)?r:r+s.a/500,h=isNaN(s.b)?r:r-s.b/200;return r=1*Mr(r),a=.95047*Mr(a),h=1.08883*Mr(h),new Ur(ns(3.2404542*a-1.5371385*r-.4985314*h),ns(-.969266*a+1.8760108*r+.041556*h),ns(.0556434*a-.2040259*r+1.0572252*h),s.alpha)}function qr(s,r,a){const h=r-s;return s+a*(h>180||h<-180?h-360*Math.round(h/360):h)}const Ja={forward:ho,reverse:Tl,interpolate:function(s,r,a){return{l:ci(s.l,r.l,a),a:ci(s.a,r.a,a),b:ci(s.b,r.b,a),alpha:ci(s.alpha,r.alpha,a)}}},ua={forward:function(s){const{l:r,a,b:h}=ho(s),p=Math.atan2(h,a)*Ai;return{h:p<0?p+360:p,c:Math.sqrt(a*a+h*h),l:r,alpha:s.a}},reverse:function(s){const r=s.h*Rs,a=s.c;return Tl({l:s.l,a:Math.cos(r)*a,b:Math.sin(r)*a,alpha:s.alpha})},interpolate:function(s,r,a){return{h:qr(s.h,r.h,a),c:ci(s.c,r.c,a),l:ci(s.l,r.l,a),alpha:ci(s.alpha,r.alpha,a)}}};var An=Object.freeze({__proto__:null,lab:Ja,hcl:ua});class ac{constructor(r,a,h,p,g){this.type=r,this.operator=a,this.interpolation=h,this.input=p,this.labels=[],this.outputs=[];for(const[v,b]of g)this.labels.push(v),this.outputs.push(b)}static interpolationFactor(r,a,h,p){let g=0;if("exponential"===r.name)g=Dl(a,r.base,h,p);else if("linear"===r.name)g=Dl(a,1,h,p);else if("cubic-bezier"===r.name){const v=r.controlPoints;g=new N(v[0],v[1],v[2],v[3]).solve(Dl(a,1,h,p))}return g}static parse(r,a){let[h,p,g,...v]=r;if(!Array.isArray(p)||0===p.length)return a.error("Expected an interpolation type expression.",1);if("linear"===p[0])p={name:"linear"};else if("exponential"===p[0]){const k=p[1];if("number"!=typeof k)return a.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:k}}else{if("cubic-bezier"!==p[0])return a.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const k=p.slice(1);if(4!==k.length||k.some(X=>"number"!=typeof X||X<0||X>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:k}}}if(r.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(g=a.parse(g,2,ri),!g)return null;const b=[];let E=null;"interpolate-hcl"===h||"interpolate-lab"===h?E=On:a.expectedType&&"value"!==a.expectedType.kind&&(E=a.expectedType);for(let k=0;k<v.length;k+=2){const X=v[k],se=v[k+1],he=k+3,_e=k+4;if("number"!=typeof X)return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',he);if(b.length&&b[b.length-1][0]>=X)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',he);const Ee=a.parse(se,_e,E);if(!Ee)return null;E=E||Ee.type,b.push([X,Ee])}return"number"===E.kind||"color"===E.kind||"array"===E.kind&&"number"===E.itemType.kind&&"number"==typeof E.N?new ac(E,h,p,g,b):a.error(`Type ${Ji(E)} is not interpolatable.`)}evaluate(r){const a=this.labels,h=this.outputs;if(1===a.length)return h[0].evaluate(r);const p=this.input.evaluate(r);if(p<=a[0])return h[0].evaluate(r);const g=a.length;if(p>=a[g-1])return h[g-1].evaluate(r);const v=mn(a,p),b=ac.interpolationFactor(this.interpolation,p,a[v],a[v+1]),E=h[v].evaluate(r),k=h[v+1].evaluate(r);return"interpolate"===this.operator?To[this.type.kind.toLowerCase()](E,k,b):"interpolate-hcl"===this.operator?ua.reverse(ua.interpolate(ua.forward(E),ua.forward(k),b)):Ja.reverse(Ja.interpolate(Ja.forward(E),Ja.forward(k),b))}eachChild(r){r(this.input);for(const a of this.outputs)r(a)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){let r;r="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const a=[this.operator,r,this.input.serialize()];for(let h=0;h<this.labels.length;h++)a.push(this.labels[h],this.outputs[h].serialize());return a}}function Dl(s,r,a,h){const p=h-a,g=s-a;return 0===p?0:1===r?g/p:(Math.pow(r,g)-1)/(Math.pow(r,p)-1)}var Js=ac;class Ra{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expectected at least one argument.");let h=null;const p=a.expectedType;p&&"value"!==p.kind&&(h=p);const g=[];for(const b of r.slice(1)){const E=a.parse(b,1+g.length,h,void 0,{typeAnnotation:"omit"});if(!E)return null;h=h||E.type,g.push(E)}const v=p&&g.some(b=>xu(p,b.type));return new Ra(v?pn:h,g)}evaluate(r){let a,h=null,p=0;for(const g of this.args){if(p++,h=g.evaluate(r),h&&h instanceof qs&&!h.available&&(a||(a=h),h=null,p===this.args.length))return a;if(null!==h)break}return h}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=["coalesce"];return this.eachChild(a=>{r.push(a.serialize())}),r}}var yo=Ra;class Al{constructor(r,a){this.type=a.type,this.bindings=[].concat(r),this.result=a}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const a of this.bindings)r(a[1]);r(this.result)}static parse(r,a){if(r.length<4)return a.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const h=[];for(let g=1;g<r.length-1;g+=2){const v=r[g];if("string"!=typeof v)return a.error(`Expected string, but found ${typeof v} instead.`,g);if(/[^a-zA-Z0-9_]/.test(v))return a.error("Variable names must contain only alphanumeric characters or '_'.",g);const b=a.parse(r[g+1],g+1);if(!b)return null;h.push([v,b])}const p=a.parse(r[r.length-1],r.length-1,a.expectedType,h);return p?new Al(h,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const r=["let"];for(const[a,h]of this.bindings)r.push(a,h.serialize());return r.push(this.result.serialize()),r}}var lc=Al;class Ls{constructor(r,a,h){this.type=r,this.index=a,this.input=h}static parse(r,a){if(3!==r.length)return a.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const h=a.parse(r[1],1,ri),p=a.parse(r[2],2,Gi(a.expectedType||pn));return h&&p?new Ls(p.type.itemType,h,p):null}evaluate(r){const a=this.index.evaluate(r),h=this.input.evaluate(r);if(a<0)throw new hi(`Array index out of bounds: ${a} < 0.`);if(a>=h.length)throw new hi(`Array index out of bounds: ${a} > ${h.length-1}.`);if(a!==Math.floor(a))throw new hi(`Array index must be an integer, but found ${a} instead.`);return h[a]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var cc=Ls;class Ph{constructor(r,a){this.type=Tn,this.needle=r,this.haystack=a}static parse(r,a){if(3!==r.length)return a.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const h=a.parse(r[1],1,pn),p=a.parse(r[2],2,pn);return h&&p?Eh(h.type,[Tn,Sn,ri,Mo,pn])?new Ph(h,p):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ji(h.type)} instead`):null}evaluate(r){const a=this.needle.evaluate(r),h=this.haystack.evaluate(r);if(null==h)return!1;if(!wl(a,["boolean","string","number","null"]))throw new hi(`Expected first argument to be of type boolean, string, number or null, but found ${Ji(an(a))} instead.`);if(!wl(h,["string","array"]))throw new hi(`Expected second argument to be of type array or string, but found ${Ji(an(h))} instead.`);return h.indexOf(a)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Sr=Ph;class Iu{constructor(r,a,h){this.type=ri,this.needle=r,this.haystack=a,this.fromIndex=h}static parse(r,a){if(r.length<=2||r.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const h=a.parse(r[1],1,pn),p=a.parse(r[2],2,pn);if(!h||!p)return null;if(!Eh(h.type,[Tn,Sn,ri,Mo,pn]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ji(h.type)} instead`);if(4===r.length){const g=a.parse(r[3],3,ri);return g?new Iu(h,p,g):null}return new Iu(h,p)}evaluate(r){const a=this.needle.evaluate(r),h=this.haystack.evaluate(r);if(!wl(a,["boolean","string","number","null"]))throw new hi(`Expected first argument to be of type boolean, string, number or null, but found ${Ji(an(a))} instead.`);if(!wl(h,["string","array"]))throw new hi(`Expected second argument to be of type array or string, but found ${Ji(an(h))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(r);return h.indexOf(a,p)}return h.indexOf(a)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Pg=Iu;class Bc{constructor(r,a,h,p,g,v){this.inputType=r,this.type=a,this.input=h,this.cases=p,this.outputs=g,this.otherwise=v}static parse(r,a){if(r.length<5)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return a.error("Expected an even number of arguments.");let h,p;a.expectedType&&"value"!==a.expectedType.kind&&(p=a.expectedType);const g={},v=[];for(let k=2;k<r.length-1;k+=2){let X=r[k];const se=r[k+1];Array.isArray(X)||(X=[X]);const he=a.concat(k);if(0===X.length)return he.error("Expected at least one branch label.");for(const Ee of X){if("number"!=typeof Ee&&"string"!=typeof Ee)return he.error("Branch labels must be numbers or strings.");if("number"==typeof Ee&&Math.abs(Ee)>Number.MAX_SAFE_INTEGER)return he.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof Ee&&Math.floor(Ee)!==Ee)return he.error("Numeric branch labels must be integer values.");if(h){if(he.checkSubtype(h,an(Ee)))return null}else h=an(Ee);if(void 0!==g[String(Ee)])return he.error("Branch labels must be unique.");g[String(Ee)]=v.length}const _e=a.parse(se,k,p);if(!_e)return null;p=p||_e.type,v.push(_e)}const b=a.parse(r[1],1,pn);if(!b)return null;const E=a.parse(r[r.length-1],r.length-1,p);return E?"value"!==b.type.kind&&a.concat(1).checkSubtype(h,b.type)?null:new Bc(h,p,b,g,v,E):null}evaluate(r){const a=this.input.evaluate(r);return(an(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),h=[],p={};for(const v of a){const b=p[this.cases[v]];void 0===b?(p[this.cases[v]]=h.length,h.push([this.cases[v],[v]])):h[b][1].push(v)}const g=v=>"number"===this.inputType.kind?Number(v):v;for(const[v,b]of h)r.push(1===b.length?g(b[0]):b.map(g)),r.push(this.outputs[v].serialize());return r.push(this.otherwise.serialize()),r}}var Yd=Bc;class La{constructor(r,a,h){this.type=r,this.branches=a,this.otherwise=h}static parse(r,a){if(r.length<4)return a.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return a.error("Expected an odd number of arguments.");let h;a.expectedType&&"value"!==a.expectedType.kind&&(h=a.expectedType);const p=[];for(let v=1;v<r.length-1;v+=2){const b=a.parse(r[v],v,Tn);if(!b)return null;const E=a.parse(r[v+1],v+1,h);if(!E)return null;p.push([b,E]),h=h||E.type}const g=a.parse(r[r.length-1],r.length-1,h);return g?new La(h,p,g):null}evaluate(r){for(const[a,h]of this.branches)if(a.evaluate(r))return h.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[a,h]of this.branches)r(a),r(h);r(this.otherwise)}outputDefined(){return this.branches.every(([r,a])=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["case"];return this.eachChild(a=>{r.push(a.serialize())}),r}}var Oh=La;class da{constructor(r,a,h,p){this.type=r,this.input=a,this.beginIndex=h,this.endIndex=p}static parse(r,a){if(r.length<=2||r.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const h=a.parse(r[1],1,pn),p=a.parse(r[2],2,ri);if(!h||!p)return null;if(!Eh(h.type,[Gi(pn),Sn,pn]))return a.error(`Expected first argument to be of type array or string, but found ${Ji(h.type)} instead`);if(4===r.length){const g=a.parse(r[3],3,ri);return g?new da(h.type,h,p,g):null}return new da(h.type,h,p)}evaluate(r){const a=this.input.evaluate(r),h=this.beginIndex.evaluate(r);if(!wl(a,["string","array"]))throw new hi(`Expected first argument to be of type array or string, but found ${Ji(an(a))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(r);return a.slice(h,p)}return a.slice(h)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Go=da;function Sf(s,r){return"=="===s||"!="===s?"boolean"===r.kind||"string"===r.kind||"number"===r.kind||"null"===r.kind||"value"===r.kind:"string"===r.kind||"number"===r.kind||"value"===r.kind}function rs(s,r,a,h){return 0===h.compare(r,a)}function Ao(s,r,a){const h="=="!==s&&"!="!==s;return class ZO{constructor(g,v,b){this.type=Tn,this.lhs=g,this.rhs=v,this.collator=b,this.hasUntypedArgument="value"===g.type.kind||"value"===v.type.kind}static parse(g,v){if(3!==g.length&&4!==g.length)return v.error("Expected two or three arguments.");const b=g[0];let E=v.parse(g[1],1,pn);if(!E)return null;if(!Sf(b,E.type))return v.concat(1).error(`"${b}" comparisons are not supported for type '${Ji(E.type)}'.`);let k=v.parse(g[2],2,pn);if(!k)return null;if(!Sf(b,k.type))return v.concat(2).error(`"${b}" comparisons are not supported for type '${Ji(k.type)}'.`);if(E.type.kind!==k.type.kind&&"value"!==E.type.kind&&"value"!==k.type.kind)return v.error(`Cannot compare types '${Ji(E.type)}' and '${Ji(k.type)}'.`);h&&("value"===E.type.kind&&"value"!==k.type.kind?E=new Ys(k.type,[E]):"value"!==E.type.kind&&"value"===k.type.kind&&(k=new Ys(E.type,[k])));let X=null;if(4===g.length){if("string"!==E.type.kind&&"string"!==k.type.kind&&"value"!==E.type.kind&&"value"!==k.type.kind)return v.error("Cannot use collator to compare non-string types.");if(X=v.parse(g[3],3,vu),!X)return null}return new ZO(E,k,X)}evaluate(g){const v=this.lhs.evaluate(g),b=this.rhs.evaluate(g);if(h&&this.hasUntypedArgument){const E=an(v),k=an(b);if(E.kind!==k.kind||"string"!==E.kind&&"number"!==E.kind)throw new hi(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${E.kind}, ${k.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const E=an(v),k=an(b);if("string"!==E.kind||"string"!==k.kind)return r(g,v,b)}return this.collator?a(g,v,b,this.collator.evaluate(g)):r(g,v,b)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}serialize(){const g=[s];return this.eachChild(v=>{g.push(v.serialize())}),g}}}const Pu=Ao("==",function(s,r,a){return r===a},rs),Rh=Ao("!=",function(s,r,a){return r!==a},function(s,r,a,h){return!rs(0,r,a,h)}),zc=Ao("<",function(s,r,a){return r<a},function(s,r,a,h){return h.compare(r,a)<0}),pa=Ao(">",function(s,r,a){return r>a},function(s,r,a,h){return h.compare(r,a)>0}),Og=Ao("<=",function(s,r,a){return r<=a},function(s,r,a,h){return h.compare(r,a)<=0}),bv=Ao(">=",function(s,r,a){return r>=a},function(s,r,a,h){return h.compare(r,a)>=0});class Zd{constructor(r,a,h,p,g,v){this.type=Sn,this.number=r,this.locale=a,this.currency=h,this.unit=p,this.minFractionDigits=g,this.maxFractionDigits=v}static parse(r,a){if(3!==r.length)return a.error("Expected two arguments.");const h=a.parse(r[1],1,ri);if(!h)return null;const p=r[2];if("object"!=typeof p||Array.isArray(p))return a.error("NumberFormat options argument must be an object.");let g=null;if(p.locale&&(g=a.parse(p.locale,1,Sn),!g))return null;let v=null;if(p.currency&&(v=a.parse(p.currency,1,Sn),!v))return null;let b=null;if(p.unit&&(b=a.parse(p.unit,1,Sn),!b))return null;let E=null;if(p["min-fraction-digits"]&&(E=a.parse(p["min-fraction-digits"],1,ri),!E))return null;let k=null;return p["max-fraction-digits"]&&(k=a.parse(p["max-fraction-digits"],1,ri),!k)?null:new Zd(h,g,v,b,E,k)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(r):void 0,unit:this.unit?this.unit.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.unit&&r(this.unit),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.unit&&(r.unit=this.unit.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]}}class Kd{constructor(r){this.type=ri,this.input=r}static parse(r,a){if(2!==r.length)return a.error(`Expected 1 argument, but found ${r.length-1} instead.`);const h=a.parse(r[1],1);return h?"array"!==h.type.kind&&"string"!==h.type.kind&&"value"!==h.type.kind?a.error(`Expected argument of type string or array, but found ${Ji(h.type)} instead.`):new Kd(h):null}evaluate(r){const a=this.input.evaluate(r);if("string"==typeof a||Array.isArray(a))return a.length;throw new hi(`Expected value to be of type string or array, but found ${Ji(an(a))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){const r=["length"];return this.eachChild(a=>{r.push(a.serialize())}),r}}const Rg={"==":Pu,"!=":Rh,">":pa,"<":zc,">=":bv,"<=":Og,array:Ys,at:cc,boolean:Ys,case:Oh,coalesce:yo,collator:nn,format:Sh,image:Th,in:Sr,"index-of":Pg,interpolate:Js,"interpolate-hcl":Js,"interpolate-lab":Js,length:Kd,let:lc,literal:Eu,match:Yd,number:Ys,"number-format":Zd,object:Ys,slice:Go,step:Ih,string:Ys,"to-boolean":El,"to-color":El,"to-number":El,"to-string":El,var:Cr,within:Ah};function Lg(s,[r,a,h,p]){r=r.evaluate(s),a=a.evaluate(s),h=h.evaluate(s);const g=p?p.evaluate(s):1,v=Ag(r,a,h,g);if(v)throw new hi(v);return new Ur(r/255*g,a/255*g,h/255*g,g)}function Tf(s,r){return s in r}function Qd(s,r){const a=r[s];return void 0===a?null:a}function el(s){return{type:s}}Ml.register(Rg,{error:[{kind:"error"},[Sn],(s,[r])=>{throw new hi(r.evaluate(s))}],typeof:[Sn,[pn],(s,[r])=>Ji(an(r.evaluate(s)))],"to-rgba":[Gi(ri,4),[On],(s,[r])=>r.evaluate(s).toArray()],rgb:[On,[ri,ri,ri],Lg],rgba:[On,[ri,ri,ri,ri],Lg],has:{type:Tn,overloads:[[[Sn],(s,[r])=>Tf(r.evaluate(s),s.properties())],[[Sn,tn],(s,[r,a])=>Tf(r.evaluate(s),a.evaluate(s))]]},get:{type:pn,overloads:[[[Sn],(s,[r])=>Qd(r.evaluate(s),s.properties())],[[Sn,tn],(s,[r,a])=>Qd(r.evaluate(s),a.evaluate(s))]]},"feature-state":[pn,[Sn],(s,[r])=>Qd(r.evaluate(s),s.featureState||{})],properties:[tn,[],s=>s.properties()],"geometry-type":[Sn,[],s=>s.geometryType()],id:[pn,[],s=>s.id()],zoom:[ri,[],s=>s.globals.zoom],pitch:[ri,[],s=>s.globals.pitch||0],"distance-from-center":[ri,[],s=>s.distanceFromCenter()],"heatmap-density":[ri,[],s=>s.globals.heatmapDensity||0],"line-progress":[ri,[],s=>s.globals.lineProgress||0],"sky-radial-progress":[ri,[],s=>s.globals.skyRadialProgress||0],accumulated:[pn,[],s=>void 0===s.globals.accumulated?null:s.globals.accumulated],"+":[ri,el(ri),(s,r)=>{let a=0;for(const h of r)a+=h.evaluate(s);return a}],"*":[ri,el(ri),(s,r)=>{let a=1;for(const h of r)a*=h.evaluate(s);return a}],"-":{type:ri,overloads:[[[ri,ri],(s,[r,a])=>r.evaluate(s)-a.evaluate(s)],[[ri],(s,[r])=>-r.evaluate(s)]]},"/":[ri,[ri,ri],(s,[r,a])=>r.evaluate(s)/a.evaluate(s)],"%":[ri,[ri,ri],(s,[r,a])=>r.evaluate(s)%a.evaluate(s)],ln2:[ri,[],()=>Math.LN2],pi:[ri,[],()=>Math.PI],e:[ri,[],()=>Math.E],"^":[ri,[ri,ri],(s,[r,a])=>Math.pow(r.evaluate(s),a.evaluate(s))],sqrt:[ri,[ri],(s,[r])=>Math.sqrt(r.evaluate(s))],log10:[ri,[ri],(s,[r])=>Math.log(r.evaluate(s))/Math.LN10],ln:[ri,[ri],(s,[r])=>Math.log(r.evaluate(s))],log2:[ri,[ri],(s,[r])=>Math.log(r.evaluate(s))/Math.LN2],sin:[ri,[ri],(s,[r])=>Math.sin(r.evaluate(s))],cos:[ri,[ri],(s,[r])=>Math.cos(r.evaluate(s))],tan:[ri,[ri],(s,[r])=>Math.tan(r.evaluate(s))],asin:[ri,[ri],(s,[r])=>Math.asin(r.evaluate(s))],acos:[ri,[ri],(s,[r])=>Math.acos(r.evaluate(s))],atan:[ri,[ri],(s,[r])=>Math.atan(r.evaluate(s))],min:[ri,el(ri),(s,r)=>Math.min(...r.map(a=>a.evaluate(s)))],max:[ri,el(ri),(s,r)=>Math.max(...r.map(a=>a.evaluate(s)))],abs:[ri,[ri],(s,[r])=>Math.abs(r.evaluate(s))],round:[ri,[ri],(s,[r])=>{const a=r.evaluate(s);return a<0?-Math.round(-a):Math.round(a)}],floor:[ri,[ri],(s,[r])=>Math.floor(r.evaluate(s))],ceil:[ri,[ri],(s,[r])=>Math.ceil(r.evaluate(s))],"filter-==":[Tn,[Sn,pn],(s,[r,a])=>s.properties()[r.value]===a.value],"filter-id-==":[Tn,[pn],(s,[r])=>s.id()===r.value],"filter-type-==":[Tn,[Sn],(s,[r])=>s.geometryType()===r.value],"filter-<":[Tn,[Sn,pn],(s,[r,a])=>{const h=s.properties()[r.value],p=a.value;return typeof h==typeof p&&h<p}],"filter-id-<":[Tn,[pn],(s,[r])=>{const a=s.id(),h=r.value;return typeof a==typeof h&&a<h}],"filter->":[Tn,[Sn,pn],(s,[r,a])=>{const h=s.properties()[r.value],p=a.value;return typeof h==typeof p&&h>p}],"filter-id->":[Tn,[pn],(s,[r])=>{const a=s.id(),h=r.value;return typeof a==typeof h&&a>h}],"filter-<=":[Tn,[Sn,pn],(s,[r,a])=>{const h=s.properties()[r.value],p=a.value;return typeof h==typeof p&&h<=p}],"filter-id-<=":[Tn,[pn],(s,[r])=>{const a=s.id(),h=r.value;return typeof a==typeof h&&a<=h}],"filter->=":[Tn,[Sn,pn],(s,[r,a])=>{const h=s.properties()[r.value],p=a.value;return typeof h==typeof p&&h>=p}],"filter-id->=":[Tn,[pn],(s,[r])=>{const a=s.id(),h=r.value;return typeof a==typeof h&&a>=h}],"filter-has":[Tn,[pn],(s,[r])=>r.value in s.properties()],"filter-has-id":[Tn,[],s=>null!==s.id()&&void 0!==s.id()],"filter-type-in":[Tn,[Gi(Sn)],(s,[r])=>r.value.indexOf(s.geometryType())>=0],"filter-id-in":[Tn,[Gi(pn)],(s,[r])=>r.value.indexOf(s.id())>=0],"filter-in-small":[Tn,[Sn,Gi(pn)],(s,[r,a])=>a.value.indexOf(s.properties()[r.value])>=0],"filter-in-large":[Tn,[Sn,Gi(pn)],(s,[r,a])=>function(h,p,g,v){for(;g<=v;){const b=g+v>>1;if(p[b]===h)return!0;p[b]>h?v=b-1:g=b+1}return!1}(s.properties()[r.value],a.value,0,a.value.length-1)],all:{type:Tn,overloads:[[[Tn,Tn],(s,[r,a])=>r.evaluate(s)&&a.evaluate(s)],[el(Tn),(s,r)=>{for(const a of r)if(!a.evaluate(s))return!1;return!0}]]},any:{type:Tn,overloads:[[[Tn,Tn],(s,[r,a])=>r.evaluate(s)||a.evaluate(s)],[el(Tn),(s,r)=>{for(const a of r)if(a.evaluate(s))return!0;return!1}]]},"!":[Tn,[Tn],(s,[r])=>!r.evaluate(s)],"is-supported-script":[Tn,[Sn],(s,[r])=>{const a=s.globals&&s.globals.isSupportedScript;return!a||a(r.evaluate(s))}],upcase:[Sn,[Sn],(s,[r])=>r.evaluate(s).toUpperCase()],downcase:[Sn,[Sn],(s,[r])=>r.evaluate(s).toLowerCase()],concat:[Sn,el(pn),(s,r)=>r.map(a=>Cu(a.evaluate(s))).join("")],"resolved-locale":[Sn,[vu],(s,[r])=>r.evaluate(s).resolvedLocale()]});var Ou=Rg;function Fg(s){return{result:"success",value:s}}function ea(s){return{result:"error",value:s}}function Vc(s){return"data-driven"===s["property-type"]}function jc(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function Df(s){return!!s.expression&&s.expression.interpolated}function Yn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":null===s?"null":typeof s}function Ru(s){return"object"==typeof s&&null!==s&&!Array.isArray(s)}function wv(s){return s}function Lh(s,r){const a="color"===r.type,h=s.stops&&"object"==typeof s.stops[0][0],p=h||!(h||void 0!==s.property),g=s.type||(Df(r)?"exponential":"interval");if(a&&((s=Ya({},s)).stops&&(s.stops=s.stops.map(k=>[k[0],Ur.parse(k[1])])),s.default=Ur.parse(s.default?s.default:r.default)),s.colorSpace&&"rgb"!==s.colorSpace&&!An[s.colorSpace])throw new Error(`Unknown color space: ${s.colorSpace}`);let v,b,E;if("exponential"===g)v=kf;else if("interval"===g)v=Ng;else if("categorical"===g){v=Af,b=Object.create(null);for(const k of s.stops)b[k[0]]=k[1];E=typeof s.stops[0][0]}else{if("identity"!==g)throw new Error(`Unknown function type "${g}"`);v=tl}if(h){const k={},X=[];for(let _e=0;_e<s.stops.length;_e++){const Ee=s.stops[_e],Oe=Ee[0].zoom;void 0===k[Oe]&&(k[Oe]={zoom:Oe,type:s.type,property:s.property,default:s.default,stops:[]},X.push(Oe)),k[Oe].stops.push([Ee[0].value,Ee[1]])}const se=[];for(const _e of X)se.push([k[_e].zoom,Lh(k[_e],r)]);const he={name:"linear"};return{kind:"composite",interpolationType:he,interpolationFactor:Js.interpolationFactor.bind(void 0,he),zoomStops:se.map(_e=>_e[0]),evaluate:({zoom:_e},Ee)=>kf({stops:se,base:s.base},r,_e).evaluate(_e,Ee)}}if(p){const k="exponential"===g?{name:"exponential",base:void 0!==s.base?s.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:Js.interpolationFactor.bind(void 0,k),zoomStops:s.stops.map(X=>X[0]),evaluate:({zoom:X})=>v(s,r,X,b,E)}}return{kind:"source",evaluate(k,X){const se=X&&X.properties?X.properties[s.property]:void 0;return void 0===se?kl(s.default,r.default):v(s,r,se,b,E)}}}function kl(s,r,a){return void 0!==s?s:void 0!==r?r:void 0!==a?a:void 0}function Af(s,r,a,h,p){return kl(typeof a===p?h[a]:void 0,s.default,r.default)}function Ng(s,r,a){if("number"!==Yn(a))return kl(s.default,r.default);const h=s.stops.length;if(1===h||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[h-1][0])return s.stops[h-1][1];const p=mn(s.stops.map(g=>g[0]),a);return s.stops[p][1]}function kf(s,r,a){const h=void 0!==s.base?s.base:1;if("number"!==Yn(a))return kl(s.default,r.default);const p=s.stops.length;if(1===p||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[p-1][0])return s.stops[p-1][1];const g=mn(s.stops.map(X=>X[0]),a),v=function(X,se,he,_e){const Ee=_e-he,Oe=X-he;return 0===Ee?0:1===se?Oe/Ee:(Math.pow(se,Oe)-1)/(Math.pow(se,Ee)-1)}(a,h,s.stops[g][0],s.stops[g+1][0]),b=s.stops[g][1],E=s.stops[g+1][1];let k=To[r.type]||wv;if(s.colorSpace&&"rgb"!==s.colorSpace){const X=An[s.colorSpace];k=(se,he)=>X.reverse(X.interpolate(X.forward(se),X.forward(he),v))}return"function"==typeof b.evaluate?{evaluate(...X){const se=b.evaluate.apply(void 0,X),he=E.evaluate.apply(void 0,X);if(void 0!==se&&void 0!==he)return k(se,he,v)}}:k(b,E,v)}function tl(s,r,a){return"color"===r.type?a=Ur.parse(a):"formatted"===r.type?a=Vo.fromString(a.toString()):"resolvedImage"===r.type?a=qs.fromString(a.toString()):Yn(a)===r.type||"enum"===r.type&&r.values[a]||(a=void 0),kl(a,s.default,r.default)}class Lu{constructor(r,a){var h;this.expression=r,this._warningHistory={},this._evaluator=new Mu,this._defaultValue=a?"color"===(h=a).type&&(Ru(h.default)||Array.isArray(h.default))?new Ur(0,0,0,0):"color"===h.type?Ur.parse(h.default)||null:void 0===h.default?null:h.default:null,this._enumValues=a&&"enum"===a.type?a.values:null}evaluateWithoutErrorHandling(r,a,h,p,g,v,b,E){return this._evaluator.globals=r,this._evaluator.feature=a,this._evaluator.featureState=h,this._evaluator.canonical=p||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(r,a,h,p,g,v,b,E){this._evaluator.globals=r,this._evaluator.feature=a||null,this._evaluator.featureState=h||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=E||null;try{const k=this.expression.evaluate(this._evaluator);if(null==k||"number"==typeof k&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new hi(`Expected value to be one of ${Object.keys(this._enumValues).map(X=>JSON.stringify(X)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}}}function no(s){return Array.isArray(s)&&s.length>0&&"string"==typeof s[0]&&s[0]in Ou}function il(s,r){const a=new Sl(Ou,[],r?function(p){const g={color:On,string:Sn,number:ri,enum:Sn,boolean:Tn,formatted:ti,resolvedImage:ca};return"array"===p.type?Gi(g[p.value]||pn,p.length):g[p.type]}(r):void 0),h=a.parse(s,void 0,void 0,void 0,r&&"string"===r.type?{typeAnnotation:"coerce"}:void 0);return h?Fg(new Lu(h,r)):ea(a.errors)}class Il{constructor(r,a){this.kind=r,this._styleExpression=a,this.isStateDependent="constant"!==r&&!Qs(a.expression)}evaluateWithoutErrorHandling(r,a,h,p,g,v){return this._styleExpression.evaluateWithoutErrorHandling(r,a,h,p,g,v)}evaluate(r,a,h,p,g,v){return this._styleExpression.evaluate(r,a,h,p,g,v)}}class Fu{constructor(r,a,h,p){this.kind=r,this.zoomStops=h,this._styleExpression=a,this.isStateDependent="camera"!==r&&!Qs(a.expression),this.interpolationType=p}evaluateWithoutErrorHandling(r,a,h,p,g,v){return this._styleExpression.evaluateWithoutErrorHandling(r,a,h,p,g,v)}evaluate(r,a,h,p,g,v){return this._styleExpression.evaluate(r,a,h,p,g,v)}interpolationFactor(r,a,h){return this.interpolationType?Js.interpolationFactor(this.interpolationType,r,a,h):0}}function Nu(s,r){if("error"===(s=il(s,r)).result)return s;const a=s.value.expression,h=oc(a);if(!h&&!Vc(r))return ea([new vs("","data expressions not supported")]);const p=Za(a,["zoom","pitch","distance-from-center"]);if(!p&&!jc(r))return ea([new vs("","zoom expressions not supported")]);const g=Fh(a);return g||p?g instanceof vs?ea([g]):g instanceof Js&&!Df(r)?ea([new vs("",'"interpolate" expressions cannot be used with this property')]):Fg(g?new Fu(h?"camera":"composite",s.value,g.labels,g instanceof Js?g.interpolation:void 0):new Il(h?"constant":"source",s.value)):ea([new vs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class hc{constructor(r,a){this._parameters=r,this._specification=a,Ya(this,Lh(this._parameters,this._specification))}static deserialize(r){return new hc(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function Fh(s){let r=null;if(s instanceof lc)r=Fh(s.result);else if(s instanceof yo){for(const a of s.args)if(r=Fh(a),r)break}else(s instanceof Ih||s instanceof Js)&&s.input instanceof Ml&&"zoom"===s.input.name&&(r=s);return r instanceof vs||s.eachChild(a=>{const h=Fh(a);h instanceof vs?r=h:!r&&h?r=new vs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&h&&r!==h&&(r=new vs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}class wi{constructor(r,a,h,p){this.message=(r?`${r}: `:"")+h,p&&(this.identifier=p),null!=a&&a.__line__&&(this.line=a.__line__)}}function ta(s){const r=s.key,a=s.value,h=s.valueSpec||{},p=s.objectElementValidators||{},g=s.style,v=s.styleSpec;let b=[];const E=Yn(a);if("object"!==E)return[new wi(r,a,`object expected, ${E} found`)];for(const k in a){const X=k.split(".")[0],se=h[X]||h["*"];let he;p[X]?he=p[X]:h[X]?he=lr:p["*"]?he=p["*"]:h["*"]&&(he=lr),he?b=b.concat(he({key:(r&&`${r}.`)+k,value:a[k],valueSpec:se,style:g,styleSpec:v,object:a,objectKey:k},a)):b.push(new wi(r,a[k],`unknown property "${k}"`))}for(const k in h)p[k]||h[k].required&&void 0===h[k].default&&void 0===a[k]&&b.push(new wi(r,a,`missing required property "${k}"`));return b}function $o(s){const r=s.value,a=s.valueSpec,h=s.style,p=s.styleSpec,g=s.key,v=s.arrayElementValidator||lr;if("array"!==Yn(r))return[new wi(g,r,`array expected, ${Yn(r)} found`)];if(a.length&&r.length!==a.length)return[new wi(g,r,`array length ${a.length} expected, length ${r.length} found`)];if(a["min-length"]&&r.length<a["min-length"])return[new wi(g,r,`array length at least ${a["min-length"]} expected, length ${r.length} found`)];let b={type:a.value,values:a.values,minimum:a.minimum,maximum:a.maximum,function:void 0};p.$version<7&&(b.function=a.function),"object"===Yn(a.value)&&(b=a.value);let E=[];for(let k=0;k<r.length;k++)E=E.concat(v({array:r,arrayIndex:k,value:r[k],valueSpec:b,style:h,styleSpec:p,key:`${g}[${k}]`}));return E}function Bu(s){const r=s.key,a=s.value,h=s.valueSpec;let p=Yn(a);if("number"===p&&a!=a&&(p="NaN"),"number"!==p)return[new wi(r,a,`number expected, ${p} found`)];if("minimum"in h){let g=h.minimum;if("array"===Yn(h.minimum)&&(g=h.minimum[s.arrayIndex]),a<g)return[new wi(r,a,`${a} is less than the minimum value ${g}`)]}if("maximum"in h){let g=h.maximum;if("array"===Yn(h.maximum)&&(g=h.maximum[s.arrayIndex]),a>g)return[new wi(r,a,`${a} is greater than the maximum value ${g}`)]}return[]}function If(s){const r=s.valueSpec,a=io(s.value.type);let h,p,g,v={};const b="categorical"!==a&&void 0===s.value.property,E=!b,k="array"===Yn(s.value.stops)&&"array"===Yn(s.value.stops[0])&&"object"===Yn(s.value.stops[0][0]),X=ta({key:s.key,value:s.value,valueSpec:s.styleSpec.function,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(_e){if("identity"===a)return[new wi(_e.key,_e.value,'identity function may not have a "stops" property')];let Ee=[];const Oe=_e.value;return Ee=Ee.concat($o({key:_e.key,value:Oe,valueSpec:_e.valueSpec,style:_e.style,styleSpec:_e.styleSpec,arrayElementValidator:se})),"array"===Yn(Oe)&&0===Oe.length&&Ee.push(new wi(_e.key,Oe,"array must have at least one stop")),Ee},default:function(_e){return lr({key:_e.key,value:_e.value,valueSpec:r,style:_e.style,styleSpec:_e.styleSpec})}}});return"identity"===a&&b&&X.push(new wi(s.key,s.value,'missing required property "property"')),"identity"===a||s.value.stops||X.push(new wi(s.key,s.value,'missing required property "stops"')),"exponential"===a&&s.valueSpec.expression&&!Df(s.valueSpec)&&X.push(new wi(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(E&&!Vc(s.valueSpec)?X.push(new wi(s.key,s.value,"property functions not supported")):b&&!jc(s.valueSpec)&&X.push(new wi(s.key,s.value,"zoom functions not supported"))),"categorical"!==a&&!k||void 0!==s.value.property||X.push(new wi(s.key,s.value,'"property" property is required')),X;function se(_e){let Ee=[];const Oe=_e.value,Ve=_e.key;if("array"!==Yn(Oe))return[new wi(Ve,Oe,`array expected, ${Yn(Oe)} found`)];if(2!==Oe.length)return[new wi(Ve,Oe,`array length 2 expected, length ${Oe.length} found`)];if(k){if("object"!==Yn(Oe[0]))return[new wi(Ve,Oe,`object expected, ${Yn(Oe[0])} found`)];if(void 0===Oe[0].zoom)return[new wi(Ve,Oe,"object stop key must have zoom")];if(void 0===Oe[0].value)return[new wi(Ve,Oe,"object stop key must have value")];const tt=io(Oe[0].zoom);if("number"!=typeof tt)return[new wi(Ve,Oe[0].zoom,"stop zoom values must be numbers")];if(g&&g>tt)return[new wi(Ve,Oe[0].zoom,"stop zoom values must appear in ascending order")];tt!==g&&(g=tt,p=void 0,v={}),Ee=Ee.concat(ta({key:`${Ve}[0]`,value:Oe[0],valueSpec:{zoom:{}},style:_e.style,styleSpec:_e.styleSpec,objectElementValidators:{zoom:Bu,value:he}}))}else Ee=Ee.concat(he({key:`${Ve}[0]`,value:Oe[0],valueSpec:{},style:_e.style,styleSpec:_e.styleSpec},Oe));return no(xr(Oe[1]))?Ee.concat([new wi(`${Ve}[1]`,Oe[1],"expressions are not allowed in function stops.")]):Ee.concat(lr({key:`${Ve}[1]`,value:Oe[1],valueSpec:r,style:_e.style,styleSpec:_e.styleSpec}))}function he(_e,Ee){const Oe=Yn(_e.value),Ve=io(_e.value),tt=null!==_e.value?_e.value:Ee;if(h){if(Oe!==h)return[new wi(_e.key,tt,`${Oe} stop domain type must match previous stop domain type ${h}`)]}else h=Oe;if("number"!==Oe&&"string"!==Oe&&"boolean"!==Oe&&"number"!=typeof Ve&&"string"!=typeof Ve&&"boolean"!=typeof Ve)return[new wi(_e.key,tt,"stop domain value must be a number, string, or boolean")];if("number"!==Oe&&"categorical"!==a){let ht=`number expected, ${Oe} found`;return Vc(r)&&void 0===a&&(ht+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new wi(_e.key,tt,ht)]}return"categorical"!==a||"number"!==Oe||"number"==typeof Ve&&isFinite(Ve)&&Math.floor(Ve)===Ve?"categorical"!==a&&"number"===Oe&&"number"==typeof Ve&&"number"==typeof p&&void 0!==p&&Ve<p?[new wi(_e.key,tt,"stop domain values must appear in ascending order")]:(p=Ve,"categorical"===a&&Ve in v?[new wi(_e.key,tt,"stop domain values must be unique")]:(v[Ve]=!0,[])):[new wi(_e.key,tt,`integer expected, found ${String(Ve)}`)]}}function Pl(s){const r=("property"===s.expressionContext?Nu:il)(xr(s.value),s.valueSpec);if("error"===r.result)return r.value.map(h=>new wi(`${s.key}${h.key}`,s.value,h.message));const a=r.value.expression||r.value._styleExpression.expression;if("property"===s.expressionContext&&"text-font"===s.propertyKey&&!a.outputDefined())return[new wi(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===s.expressionContext&&"layout"===s.propertyType&&!Qs(a))return[new wi(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===s.expressionContext)return Pf(a,s);if(s.expressionContext&&0===s.expressionContext.indexOf("cluster")){if(!Za(a,["zoom","feature-state"]))return[new wi(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===s.expressionContext&&!oc(a))return[new wi(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Pf(s,r){const a=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const p of r.valueSpec.expression.parameters)a.delete(p);if(0===a.size)return[];const h=[];return s instanceof Ml&&a.has(s.name)?[new wi(r.key,r.value,`["${s.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(s.eachChild(p=>{h.push(...Pf(p,r))}),h)}function Jd(s){const r=s.key,a=s.value,h=s.valueSpec,p=[];return Array.isArray(h.values)?-1===h.values.indexOf(io(a))&&p.push(new wi(r,a,`expected one of [${h.values.join(", ")}], ${JSON.stringify(a)} found`)):-1===Object.keys(h.values).indexOf(io(a))&&p.push(new wi(r,a,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(a)} found`)),p}function Or(s){if(!0===s||!1===s)return!0;if(!Array.isArray(s)||0===s.length)return!1;switch(s[0]){case"has":return s.length>=2&&"$id"!==s[1]&&"$type"!==s[1];case"in":return s.length>=3&&("string"!=typeof s[1]||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==s.length||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const r of s.slice(1))if(!Or(r)&&"boolean"!=typeof r)return!1;return!0;default:return!0}}function uc(s,r="fill"){if(null==s)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Or(s)||(s=vo(s));const a=s;let h=!0;try{h=function(k){if(!ko(k))return k;let X=xr(k);return Ol(X),X=Fs(X),X}(a)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(a,null,2)}\n        `)}const p=$t[`filter_${r}`],g=il(h,p);let v=null;if("error"===g.result)throw new Error(g.value.map(k=>`${k.key}: ${k.message}`).join(", "));v=(k,X,se)=>g.value.evaluate(k,X,{},se);let b=null,E=null;if(h!==a){const k=il(a,p);if("error"===k.result)throw new Error(k.value.map(X=>`${X.key}: ${X.message}`).join(", "));b=(X,se,he,_e,Ee)=>k.value.evaluate(X,se,{},he,void 0,void 0,_e,Ee),E=!oc(k.value.expression)}return{filter:v,dynamicFilter:b||void 0,needGeometry:dc(h),needFeature:!!E}}function Fs(s){if(!Array.isArray(s))return s;const r=function(a){if(Bg.has(a[0]))for(let h=1;h<a.length;h++)if(ko(a[h]))return!0;return a}(s);return!0===r?r:r.map(a=>Fs(a))}function Ol(s){let r=!1;const a=[];if("case"===s[0]){for(let h=1;h<s.length-1;h+=2)r=r||ko(s[h]),a.push(s[h+1]);a.push(s[s.length-1])}else if("match"===s[0]){r=r||ko(s[1]);for(let h=2;h<s.length-1;h+=2)a.push(s[h+1]);a.push(s[s.length-1])}else if("step"===s[0]){r=r||ko(s[1]);for(let h=1;h<s.length-1;h+=2)a.push(s[h+1])}r&&(s.length=0,s.push("any",...a));for(let h=1;h<s.length;h++)Ol(s[h])}function ko(s){if(!Array.isArray(s))return!1;if("pitch"===(r=s[0])||"distance-from-center"===r)return!0;var r;for(let a=1;a<s.length;a++)if(ko(s[a]))return!0;return!1}const Bg=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function ep(s,r){return s<r?-1:s>r?1:0}function dc(s){if(!Array.isArray(s))return!1;if("within"===s[0])return!0;for(let r=1;r<s.length;r++)if(dc(s[r]))return!0;return!1}function vo(s){if(!s)return!0;const r=s[0];return s.length<=1?"any"!==r:"=="===r?zu(s[1],s[2],"=="):"!="===r?fa(zu(s[1],s[2],"==")):"<"===r||">"===r||"<="===r||">="===r?zu(s[1],s[2],r):"any"===r?(a=s.slice(1),["any"].concat(a.map(vo))):"all"===r?["all"].concat(s.slice(1).map(vo)):"none"===r?["all"].concat(s.slice(1).map(vo).map(fa)):"in"===r?pc(s[1],s.slice(2)):"!in"===r?fa(pc(s[1],s.slice(2))):"has"===r?Of(s[1]):"!has"===r?fa(Of(s[1])):"within"!==r||s;var a}function zu(s,r,a){switch(s){case"$type":return[`filter-type-${a}`,r];case"$id":return[`filter-id-${a}`,r];default:return[`filter-${a}`,s,r]}}function pc(s,r){if(0===r.length)return!1;switch(s){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(a=>typeof a!=typeof r[0])?["filter-in-large",s,["literal",r.sort(ep)]]:["filter-in-small",s,["literal",r]]}}function Of(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function fa(s){return["!",s]}function Uc(s){return Or(xr(s.value))?Pl(Ya({},s,{expressionContext:"filter",valueSpec:s.styleSpec[`filter_${s.layerType||"fill"}`]})):Vu(s)}function Vu(s){const r=s.value,a=s.key;if("array"!==Yn(r))return[new wi(a,r,`array expected, ${Yn(r)} found`)];const h=s.styleSpec;let p,g=[];if(r.length<1)return[new wi(a,r,"filter array must have at least 1 element")];switch(g=g.concat(Jd({key:`${a}[0]`,value:r[0],valueSpec:h.filter_operator,style:s.style,styleSpec:s.styleSpec})),io(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&"$type"===io(r[1])&&g.push(new wi(a,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":3!==r.length&&g.push(new wi(a,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(p=Yn(r[1]),"string"!==p&&g.push(new wi(`${a}[1]`,r[1],`string expected, ${p} found`)));for(let v=2;v<r.length;v++)p=Yn(r[v]),"$type"===io(r[1])?g=g.concat(Jd({key:`${a}[${v}]`,value:r[v],valueSpec:h.geometry_type,style:s.style,styleSpec:s.styleSpec})):"string"!==p&&"number"!==p&&"boolean"!==p&&g.push(new wi(`${a}[${v}]`,r[v],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let v=1;v<r.length;v++)g=g.concat(Vu({key:`${a}[${v}]`,value:r[v],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":p=Yn(r[1]),2!==r.length?g.push(new wi(a,r,`filter array for "${r[0]}" operator must have 2 elements`)):"string"!==p&&g.push(new wi(`${a}[1]`,r[1],`string expected, ${p} found`));break;case"within":p=Yn(r[1]),2!==r.length?g.push(new wi(a,r,`filter array for "${r[0]}" operator must have 2 elements`)):"object"!==p&&g.push(new wi(`${a}[1]`,r[1],`object expected, ${p} found`))}return g}function hn(s,r){const a=s.key,h=s.style,p=s.styleSpec,g=s.value,v=s.objectKey,b=p[`${r}_${s.layerType}`];if(!b)return[];const E=v.match(/^(.*)-transition$/);if("paint"===r&&E&&b[E[1]]&&b[E[1]].transition)return lr({key:a,value:g,valueSpec:p.transition,style:h,styleSpec:p});const k=s.valueSpec||b[v];if(!k)return[new wi(a,g,`unknown property "${v}"`)];let X;if("string"===Yn(g)&&Vc(k)&&!k.tokens&&(X=/^{([^}]+)}$/.exec(g)))return[new wi(a,g,`"${v}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(X[1])} }\`.`)];const se=[];return"symbol"===s.layerType&&("text-field"===v&&h&&!h.glyphs&&se.push(new wi(a,g,'use of "text-field" requires a style "glyphs" property')),"text-font"===v&&Ru(xr(g))&&"identity"===io(g.type)&&se.push(new wi(a,g,'"text-font" does not support identity functions'))),se.concat(lr({key:s.key,value:g,valueSpec:k,style:h,styleSpec:p,expressionContext:"property",propertyType:r,propertyKey:v}))}function ju(s){return hn(s,"paint")}function zg(s){return hn(s,"layout")}function Uu(s){let r=[];const a=s.value,h=s.key,p=s.style,g=s.styleSpec;a.type||a.ref||r.push(new wi(h,a,'either "type" or "ref" is required'));let v=io(a.type);const b=io(a.ref);if(a.id){const E=io(a.id);for(let k=0;k<s.arrayIndex;k++){const X=p.layers[k];io(X.id)===E&&r.push(new wi(h,a.id,`duplicate layer id "${a.id}", previously used at line ${X.id.__line__}`))}}if("ref"in a){let E;["type","source","source-layer","filter","layout"].forEach(k=>{k in a&&r.push(new wi(h,a[k],`"${k}" is prohibited for ref layers`))}),p.layers.forEach(k=>{io(k.id)===b&&(E=k)}),E?E.ref?r.push(new wi(h,a.ref,"ref cannot reference another ref layer")):v=io(E.type):"string"==typeof b&&r.push(new wi(h,a.ref,`ref layer "${b}" not found`))}else if("background"!==v&&"sky"!==v)if(a.source){const E=p.sources&&p.sources[a.source],k=E&&io(E.type);E?"vector"===k&&"raster"===v?r.push(new wi(h,a.source,`layer "${a.id}" requires a raster source`)):"raster"===k&&"raster"!==v?r.push(new wi(h,a.source,`layer "${a.id}" requires a vector source`)):"vector"!==k||a["source-layer"]?"raster-dem"===k&&"hillshade"!==v?r.push(new wi(h,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==v||!a.paint||!a.paint["line-gradient"]&&!a.paint["line-trim-offset"]||"geojson"===k&&E.lineMetrics||r.push(new wi(h,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new wi(h,a,`layer "${a.id}" must specify a "source-layer"`)):r.push(new wi(h,a.source,`source "${a.source}" not found`))}else r.push(new wi(h,a,'missing required property "source"'));return r=r.concat(ta({key:h,value:a,valueSpec:g.layer,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{"*":()=>[],type:()=>lr({key:`${h}.type`,value:a.type,valueSpec:g.layer.type,style:s.style,styleSpec:s.styleSpec,object:a,objectKey:"type"}),filter:E=>Uc(Ya({layerType:v},E)),layout:E=>ta({layer:a,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":k=>zg(Ya({layerType:v},k))}}),paint:E=>ta({layer:a,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":k=>ju(Ya({layerType:v},k))}})}})),r}function nl(s){const r=s.value,a=s.key,h=Yn(r);return"string"!==h?[new wi(a,r,`string expected, ${h} found`)]:[]}const tp={promoteId:function({key:s,value:r}){if("string"===Yn(r))return nl({key:s,value:r});{const a=[];for(const h in r)a.push(...nl({key:`${s}.${h}`,value:r[h]}));return a}}};function ip(s){const r=s.value,a=s.key,h=s.styleSpec,p=s.style;if(!r.type)return[new wi(a,r,'"type" is required')];const g=io(r.type);let v;switch(g){case"vector":case"raster":case"raster-dem":return v=ta({key:a,value:r,valueSpec:h[`source_${g.replace("-","_")}`],style:s.style,styleSpec:h,objectElementValidators:tp}),v;case"geojson":if(v=ta({key:a,value:r,valueSpec:h.source_geojson,style:p,styleSpec:h,objectElementValidators:tp}),r.cluster)for(const b in r.clusterProperties){const[E,k]=r.clusterProperties[b],X="string"==typeof E?[E,["accumulated"],["get",b]]:E;v.push(...Pl({key:`${a}.${b}.map`,value:k,expressionContext:"cluster-map"})),v.push(...Pl({key:`${a}.${b}.reduce`,value:X,expressionContext:"cluster-reduce"}))}return v;case"video":return ta({key:a,value:r,valueSpec:h.source_video,style:p,styleSpec:h});case"image":return ta({key:a,value:r,valueSpec:h.source_image,style:p,styleSpec:h});case"canvas":return[new wi(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Jd({key:`${a}.type`,value:r.type,valueSpec:{values:Rf(h)},style:p,styleSpec:h})}}function Rf(s){return s.source.reduce((r,a)=>{const h=s[a];return"enum"===h.type.type&&(r=r.concat(Object.keys(h.type.values))),r},[])}function Lf(s){const r=s.value,a=s.styleSpec,h=a.light,p=s.style;let g=[];const v=Yn(r);if(void 0===r)return g;if("object"!==v)return g=g.concat([new wi("light",r,`object expected, ${v} found`)]),g;for(const b in r){const E=b.match(/^(.*)-transition$/);g=g.concat(E&&h[E[1]]&&h[E[1]].transition?lr({key:b,value:r[b],valueSpec:a.transition,style:p,styleSpec:a}):h[b]?lr({key:b,value:r[b],valueSpec:h[b],style:p,styleSpec:a}):[new wi(b,r[b],`unknown property "${b}"`)])}return g}function ai(s){const r=s.value,a=s.key,h=s.style,p=s.styleSpec,g=p.terrain;let v=[];const b=Yn(r);if(void 0===r)return v;if("object"!==b)return v=v.concat([new wi("terrain",r,`object expected, ${b} found`)]),v;for(const E in r){const k=E.match(/^(.*)-transition$/);v=v.concat(k&&g[k[1]]&&g[k[1]].transition?lr({key:E,value:r[E],valueSpec:p.transition,style:h,styleSpec:p}):g[E]?lr({key:E,value:r[E],valueSpec:g[E],style:h,styleSpec:p}):[new wi(E,r[E],`unknown property "${E}"`)])}if(r.source){const E=h.sources&&h.sources[r.source],k=E&&io(E.type);E?"raster-dem"!==k&&v.push(new wi(a,r.source,`terrain cannot be used with a source of type ${String(k)}, it only be used with a "raster-dem" source type`)):v.push(new wi(a,r.source,`source "${r.source}" not found`))}else v.push(new wi(a,r,'terrain is missing required property "source"'));return v}function Vn(s){const r=s.value,a=s.style,h=s.styleSpec,p=h.fog;let g=[];const v=Yn(r);if(void 0===r)return g;if("object"!==v)return g=g.concat([new wi("fog",r,`object expected, ${v} found`)]),g;for(const b in r){const E=b.match(/^(.*)-transition$/);g=g.concat(E&&p[E[1]]&&p[E[1]].transition?lr({key:b,value:r[b],valueSpec:h.transition,style:a,styleSpec:h}):p[b]?lr({key:b,value:r[b],valueSpec:p[b],style:a,styleSpec:h}):[new wi(b,r[b],`unknown property "${b}"`)])}return g}const Io={"*":()=>[],array:$o,boolean:function(s){const r=s.value,a=s.key,h=Yn(r);return"boolean"!==h?[new wi(a,r,`boolean expected, ${h} found`)]:[]},number:Bu,color:function(s){const r=s.key,a=s.value,h=Yn(a);return"string"!==h?[new wi(r,a,`color expected, ${h} found`)]:null===So(a)?[new wi(r,a,`color expected, "${a}" found`)]:[]},enum:Jd,filter:Uc,function:If,layer:Uu,object:ta,source:ip,light:Lf,terrain:ai,fog:Vn,string:nl,formatted:function(s){return 0===nl(s).length?[]:Pl(s)},resolvedImage:function(s){return 0===nl(s).length?[]:Pl(s)},projection:function(s){const r=s.value,a=s.styleSpec,h=a.projection,p=s.style;let g=[];const v=Yn(r);if("object"===v)for(const b in r)g=g.concat(lr({key:b,value:r[b],valueSpec:h[b],style:p,styleSpec:a}));else"string"!==v&&(g=g.concat([new wi("projection",r,`object or string expected, ${v} found`)]));return g}};function lr(s){const r=s.value,a=s.valueSpec,h=s.styleSpec;return a.expression&&Ru(io(r))?If(s):a.expression&&no(xr(r))?Pl(s):a.type&&Io[a.type]?Io[a.type](s):ta(Ya({},s,{valueSpec:a.type?h[a.type]:a}))}function uo(s){const r=s.value,a=s.key,h=nl(s);return h.length||(-1===r.indexOf("{fontstack}")&&h.push(new wi(a,r,'"glyphs" url must include a "{fontstack}" token')),-1===r.indexOf("{range}")&&h.push(new wi(a,r,'"glyphs" url must include a "{range}" token'))),h}function Hu(s,r=$t){return ma(lr({key:"",value:s,valueSpec:r.$root,styleSpec:r,style:s,objectElementValidators:{glyphs:uo,"*":()=>[]}}))}const Nh=s=>ma(ju(s)),Fa=s=>ma(zg(s));function ma(s){return s.slice().sort((r,a)=>r.line&&a.line?r.line-a.line:0)}function Gu(s,r){let a=!1;if(r&&r.length)for(const h of r)s.fire(new bl(new Error(h.message))),a=!0;return a}var Bh=Na;function Na(s,r,a){var h=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var p=new Int32Array(this.arrayBuffer);s=p[0],this.d=(r=p[1])+2*(a=p[2]);for(var g=0;g<this.d*this.d;g++){var v=p[3+g],b=p[3+g+1];h.push(v===b?null:p.subarray(v,b))}var E=p[3+h.length+1];this.keys=p.subarray(p[3+h.length],E),this.bboxes=p.subarray(E),this.insert=this._insertReadonly}else{this.d=r+2*a;for(var k=0;k<this.d*this.d;k++)h.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=s,this.padding=a,this.scale=r/s,this.uid=0;var X=a/r*s;this.min=-X,this.max=s+X}Na.prototype.insert=function(s,r,a,h,p){this._forEachCell(r,a,h,p,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(r),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(p)},Na.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Na.prototype._insertCell=function(s,r,a,h,p,g){this.cells[p].push(g)},Na.prototype.query=function(s,r,a,h,p){var g=this.min,v=this.max;if(s<=g&&r<=g&&v<=a&&v<=h&&!p)return Array.prototype.slice.call(this.keys);var b=[];return this._forEachCell(s,r,a,h,this._queryCell,b,{},p),b},Na.prototype._queryCell=function(s,r,a,h,p,g,v,b){var E=this.cells[p];if(null!==E)for(var k=this.keys,X=this.bboxes,se=0;se<E.length;se++){var he=E[se];if(void 0===v[he]){var _e=4*he;(b?b(X[_e+0],X[_e+1],X[_e+2],X[_e+3]):s<=X[_e+2]&&r<=X[_e+3]&&a>=X[_e+0]&&h>=X[_e+1])?(v[he]=!0,g.push(k[he])):v[he]=!1}}},Na.prototype._forEachCell=function(s,r,a,h,p,g,v,b){for(var E=this._convertToCellCoord(s),k=this._convertToCellCoord(r),X=this._convertToCellCoord(a),se=this._convertToCellCoord(h),he=E;he<=X;he++)for(var _e=k;_e<=se;_e++){var Ee=this.d*_e+he;if((!b||b(this._convertFromCellCoord(he),this._convertFromCellCoord(_e),this._convertFromCellCoord(he+1),this._convertFromCellCoord(_e+1)))&&p.call(this,s,r,a,h,Ee,g,v,b))return}},Na.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},Na.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},Na.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,r=3+this.cells.length+1+1,a=0,h=0;h<this.cells.length;h++)a+=this.cells[h].length;var p=new Int32Array(r+a+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var g=r,v=0;v<s.length;v++){var b=s[v];p[3+v]=g,p.set(b,g),g+=b.length}return p[3+s.length]=g,p.set(this.keys,g),p[3+s.length+1]=g+=this.keys.length,p.set(this.bboxes,g),g+=this.bboxes.length,p.buffer};const np={};function Ei(s,r,a={}){Object.defineProperty(s,"_classRegistryKey",{value:r,writeable:!1}),np[r]={klass:s,omit:a.omit||[]}}Ei(Object,"Object"),Bh.serialize=function(s,r){const a=s.toArrayBuffer();return r&&r.push(a),{buffer:a}},Bh.deserialize=function(s){return new Bh(s.buffer)},Object.defineProperty(Bh,"name",{value:"Grid"}),Ei(Bh,"Grid"),Ei(Ur,"Color"),Ei(Error,"Error"),Ei(vt,"AJAXError"),Ei(qs,"ResolvedImage"),Ei(hc,"StylePropertyFunction"),Ei(Lu,"StyleExpression",{omit:["_evaluator"]}),Ei(Fu,"ZoomDependentExpression"),Ei(Il,"ZoomConstantExpression"),Ei(Ml,"CompoundExpression",{omit:["_evaluate"]});for(const s in Ou)np[Ou[s]._classRegistryKey]||Ei(Ou[s],`Expression${s}`);function Wo(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&"ArrayBuffer"===s.constructor.name)}function Ba(s){return re.ImageBitmap&&s instanceof re.ImageBitmap}function rl(s,r){if(null==s||"boolean"==typeof s||"number"==typeof s||"string"==typeof s||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp)return s;if(Wo(s)||Ba(s))return r&&r.push(s),s;if(ArrayBuffer.isView(s)){const a=s;return r&&r.push(a.buffer),a}if(s instanceof re.ImageData)return r&&r.push(s.data.buffer),s;if(Array.isArray(s)){const a=[];for(const h of s)a.push(rl(h,r));return a}if("object"==typeof s){const a=s.constructor,h=a._classRegistryKey;if(!h)throw new Error(`can't serialize object of unregistered class ${h}`);const p=a.serialize?a.serialize(s,r):{};if(!a.serialize){for(const g in s)s.hasOwnProperty(g)&&(np[h].omit.indexOf(g)>=0||(p[g]=rl(s[g],r)));s instanceof Error&&(p.message=s.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==h&&(p.$name=h),p}throw new Error("can't serialize object of type "+typeof s)}function za(s){if(null==s||"boolean"==typeof s||"number"==typeof s||"string"==typeof s||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||Wo(s)||Ba(s)||ArrayBuffer.isView(s)||s instanceof re.ImageData)return s;if(Array.isArray(s))return s.map(za);if("object"==typeof s){const r=s.$name||"Object",{klass:a}=np[r];if(!a)throw new Error(`can't deserialize unregistered class ${r}`);if(a.deserialize)return a.deserialize(s);const h=Object.create(a.prototype);for(const p of Object.keys(s))"$name"!==p&&(h[p]=za(s[p]));return h}throw new Error("can't deserialize object of type "+typeof s)}const ga=s=>s>=1536&&s<=1791,Ff=s=>s>=1872&&s<=1919,$u=s=>s>=2208&&s<=2303,rp=s=>s>=11904&&s<=12031,op=s=>s>=12032&&s<=12255,zh=s=>s>=12272&&s<=12287,Rl=s=>s>=12288&&s<=12351,Hc=s=>s>=12352&&s<=12447,Gc=s=>s>=12448&&s<=12543,Nf=s=>s>=12544&&s<=12591,Wu=s=>s>=12704&&s<=12735,Xu=s=>s>=12736&&s<=12783,sp=s=>s>=12784&&s<=12799,ap=s=>s>=12800&&s<=13055,lp=s=>s>=13056&&s<=13311,cp=s=>s>=13312&&s<=19903,Vh=s=>s>=19968&&s<=40959,Bf=s=>s>=40960&&s<=42127,zf=s=>s>=42128&&s<=42191,Po=s=>s>=44032&&s<=55215,ia=s=>s>=63744&&s<=64255,m=s=>s>=64336&&s<=65023,l=s=>s>=65040&&s<=65055,d=s=>s>=65072&&s<=65103,_=s=>s>=65104&&s<=65135,x=s=>s>=65136&&s<=65279,C=s=>s>=65280&&s<=65519;function F(s){for(const r of s)if(fe(r.charCodeAt(0)))return!0;return!1}function G(s){for(const r of s)if(!Q(r.charCodeAt(0)))return!1;return!0}function Q(s){return!(ga(s)||Ff(s)||$u(s)||m(s)||x(s))}function fe(s){return!(746!==s&&747!==s&&(s<4352||!(Wu(s)||Nf(s)||d(s)&&!(s>=65097&&s<=65103)||ia(s)||lp(s)||rp(s)||Xu(s)||!(!Rl(s)||s>=12296&&s<=12305||s>=12308&&s<=12319||12336===s)||cp(s)||Vh(s)||ap(s)||(r=s,r>=12592&&r<=12687)||(r=>r>=43360&&r<=43391)(s)||(r=>r>=55216&&r<=55295)(s)||(r=>r>=4352&&r<=4607)(s)||Po(s)||Hc(s)||zh(s)||(r=>r>=12688&&r<=12703)(s)||op(s)||sp(s)||Gc(s)&&12540!==s||!(!C(s)||65288===s||65289===s||65293===s||s>=65306&&s<=65310||65339===s||65341===s||65343===s||s>=65371&&s<=65503||65507===s||s>=65512&&s<=65519)||!(!_(s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||(r=>r>=5120&&r<=5759)(s)||(r=>r>=6320&&r<=6399)(s)||l(s)||(r=>r>=19904&&r<=19967)(s)||Bf(s)||zf(s))));var r}function pe(s){return!(fe(s)||(r=s,(a=r)>=128&&a<=255&&(167===r||169===r||174===r||177===r||188===r||189===r||190===r||215===r||247===r)||(a=>a>=8192&&a<=8303)(r)&&(8214===r||8224===r||8225===r||8240===r||8241===r||8251===r||8252===r||8258===r||8263===r||8264===r||8265===r||8273===r)||(a=>a>=8448&&a<=8527)(r)||(a=>a>=8528&&a<=8591)(r)||(a=>a>=8960&&a<=9215)(r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||9003===r||r>=9085&&r<=9114||r>=9150&&r<=9165||9167===r||r>=9169&&r<=9179||r>=9186&&r<=9215)||(a=>a>=9216&&a<=9279)(r)&&9251!==r||(a=>a>=9280&&a<=9311)(r)||(a=>a>=9312&&a<=9471)(r)||(a=>a>=9632&&a<=9727)(r)||(a=>a>=9728&&a<=9983)(r)&&!(r>=9754&&r<=9759)||(a=>a>=11008&&a<=11263)(r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||Rl(r)||Gc(r)||(a=>a>=57344&&a<=63743)(r)||d(r)||_(r)||C(r)||8734===r||8756===r||8757===r||r>=9984&&r<=10087||r>=10102&&r<=10131||65532===r||65533===r));var r,a}function ke(s){return s>=1424&&s<=2303||m(s)||x(s)}function ze(s,r){return!(!r&&ke(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||(a=s,a>=6016&&a<=6143));var a}function We(s){for(const r of s)if(ke(r.charCodeAt(0)))return!0;return!1}const $e="deferred",qe="loading",Ue="loaded";let He=null,Je="unavailable",Ye=null;const rt=function(s){s&&"string"==typeof s&&s.indexOf("NetworkError")>-1&&(Je="error"),He&&He(s)};function mt(){pt.fire(new Pa("pluginStateChange",{pluginStatus:Je,pluginURL:Ye}))}const pt=new Ws,xt=function(){return Je},Rt=function(){if(Je!==$e||!Ye)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Je=qe,mt(),Ye&&vi({url:Ye},s=>{s?rt(s):(Je=Ue,mt())})},kt={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Je===Ue||null!=kt.applyArabicShaping,isLoading:()=>Je===qe,setState(s){Je=s.pluginStatus,Ye=s.pluginURL},isParsed:()=>null!=kt.applyArabicShaping&&null!=kt.processBidirectionalText&&null!=kt.processStyledBidirectionalText,getPluginURL:()=>Ye};class Ct{constructor(r,a){this.zoom=r,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.transition=a.transition,this.pitch=a.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(r){return function(a,h){for(const p of a)if(!ze(p.charCodeAt(0),h))return!1;return!0}(r,kt.isLoaded())}}class si{constructor(r,a){this.property=r,this.value=a,this.expression=function(h,p){if(Ru(h))return new hc(h,p);if(no(h)){const g=Nu(h,p);if("error"===g.result)throw new Error(g.value.map(v=>`${v.key}: ${v.message}`).join(", "));return g.value}{let g=h;return"string"==typeof h&&"color"===p.type&&(g=Ur.parse(h)),{kind:"constant",evaluate:()=>g}}}(void 0===a?r.specification.default:a,r.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(r,a,h){return this.property.possiblyEvaluate(this,r,a,h)}}class At{constructor(r){this.property=r,this.value=new si(r,void 0)}transitioned(r,a){return new Ft(this.property,this.value,a,S({},r.transition,this.transition),r.now)}untransitioned(){return new Ft(this.property,this.value,null,{},0)}}class Ht{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return Me(this._values[r].value.value)}setValue(r,a){this._values.hasOwnProperty(r)||(this._values[r]=new At(this._values[r].property)),this._values[r].value=new si(this._values[r].property,null===a?void 0:Me(a))}getTransition(r){return Me(this._values[r].transition)}setTransition(r,a){this._values.hasOwnProperty(r)||(this._values[r]=new At(this._values[r].property)),this._values[r].transition=Me(a)||void 0}serialize(){const r={};for(const a of Object.keys(this._values)){const h=this.getValue(a);void 0!==h&&(r[a]=h);const p=this.getTransition(a);void 0!==p&&(r[`${a}-transition`]=p)}return r}transitioned(r,a){const h=new ei(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].transitioned(r,a._values[p]);return h}untransitioned(){const r=new ei(this._properties);for(const a of Object.keys(this._values))r._values[a]=this._values[a].untransitioned();return r}}class Ft{constructor(r,a,h,p,g){const v=p.delay||0,b=p.duration||0;g=g||0,this.property=r,this.value=a,this.begin=g+v,this.end=this.begin+b,r.specification.transition&&(p.delay||p.duration)&&(this.prior=h)}possiblyEvaluate(r,a,h){const p=r.now||0,g=this.value.possiblyEvaluate(r,a,h),v=this.prior;if(v){if(p>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(p<this.begin)return v.possiblyEvaluate(r,a,h);{const b=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(r,a,h),g,ee(b))}}return g}}class ei{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,a,h){const p=new li(this._properties);for(const g of Object.keys(this._values))p._values[g]=this._values[g].possiblyEvaluate(r,a,h);return p}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class zt{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}getValue(r){return Me(this._values[r].value)}setValue(r,a){this._values[r]=new si(this._values[r].property,null===a?void 0:Me(a))}serialize(){const r={};for(const a of Object.keys(this._values)){const h=this.getValue(a);void 0!==h&&(r[a]=h)}return r}possiblyEvaluate(r,a,h){const p=new li(this._properties);for(const g of Object.keys(this._values))p._values[g]=this._values[g].possiblyEvaluate(r,a,h);return p}}class Zt{constructor(r,a,h){this.property=r,this.value=a,this.parameters=h}isConstant(){return"constant"===this.value.kind}constantOr(r){return"constant"===this.value.kind?this.value.value:r}evaluate(r,a,h,p){return this.property.evaluate(this.value,this.parameters,r,a,h,p)}}class li{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class St{constructor(r){this.specification=r}possiblyEvaluate(r,a){return r.expression.evaluate(a)}interpolate(r,a,h){const p=To[this.specification.type];return p?p(r,a,h):r}}class Lt{constructor(r,a){this.specification=r,this.overrides=a}possiblyEvaluate(r,a,h,p){return new Zt(this,"constant"===r.expression.kind||"camera"===r.expression.kind?{kind:"constant",value:r.expression.evaluate(a,null,{},h,p)}:r.expression,a)}interpolate(r,a,h){if("constant"!==r.value.kind||"constant"!==a.value.kind)return r;if(void 0===r.value.value||void 0===a.value.value)return new Zt(this,{kind:"constant",value:void 0},r.parameters);const p=To[this.specification.type];return p?new Zt(this,{kind:"constant",value:p(r.value.value,a.value.value,h)},r.parameters):r}evaluate(r,a,h,p,g,v){return"constant"===r.kind?r.value:r.evaluate(a,h,p,g,v)}}class Ti{constructor(r){this.specification=r}possiblyEvaluate(r,a,h,p){return!!r.expression.evaluate(a,null,{},h,p)}interpolate(){return!1}}class ki{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const a=new Ct(0,{});for(const h in r){const p=r[h];p.specification.overridable&&this.overridableProperties.push(h);const g=this.defaultPropertyValues[h]=new si(p,void 0),v=this.defaultTransitionablePropertyValues[h]=new At(p);this.defaultTransitioningPropertyValues[h]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=g.possiblyEvaluate(a)}}}function Di(s,r){return 256*(s=D(Math.floor(s),0,255))+D(Math.floor(r),0,255)}Ei(Lt,"DataDrivenProperty"),Ei(St,"DataConstantProperty"),Ei(Ti,"ColorRampProperty");const Ui={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class cn{constructor(r,a){this._structArray=r,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Fi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,a){return r._trim(),a&&(r.isTransferred=!0,a.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const a=Object.create(this.prototype);return a.arrayBuffer=r.arrayBuffer,a.length=r.length,a.capacity=r.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ci(s,r=1){let a=0,h=0;return{members:s.map(p=>{const g=Ui[p.type].BYTES_PER_ELEMENT,v=a=jn(a,Math.max(r,g)),b=p.components||1;return h=Math.max(h,g),a+=g*b,{name:p.name,type:p.type,components:b,offset:v}}),size:jn(a,Math.max(h,r)),alignment:r}}function jn(s,r){return Math.ceil(s/r)*r}class Un extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a){const h=this.length;return this.resize(h+1),this.emplace(h,r,a)}emplace(r,a,h){const p=2*r;return this.int16[p+0]=a,this.int16[p+1]=h,r}}Un.prototype.bytesPerElement=4,Ei(Un,"StructArrayLayout2i4");class cr extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,a,h)}emplace(r,a,h,p){const g=3*r;return this.int16[g+0]=a,this.int16[g+1]=h,this.int16[g+2]=p,r}}cr.prototype.bytesPerElement=6,Ei(cr,"StructArrayLayout3i6");class tr extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,h,p){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,h,p)}emplace(r,a,h,p,g){const v=4*r;return this.int16[v+0]=a,this.int16[v+1]=h,this.int16[v+2]=p,this.int16[v+3]=g,r}}tr.prototype.bytesPerElement=8,Ei(tr,"StructArrayLayout4i8");class os extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,h,p,g,v,b){const E=this.length;return this.resize(E+1),this.emplace(E,r,a,h,p,g,v,b)}emplace(r,a,h,p,g,v,b,E){const k=6*r,X=12*r,se=3*r;return this.int16[k+0]=a,this.int16[k+1]=h,this.uint8[X+4]=p,this.uint8[X+5]=g,this.uint8[X+6]=v,this.uint8[X+7]=b,this.float32[se+2]=E,r}}os.prototype.bytesPerElement=12,Ei(os,"StructArrayLayout2i4ub1f12");class bs extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,h,p){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,h,p)}emplace(r,a,h,p,g){const v=4*r;return this.float32[v+0]=a,this.float32[v+1]=h,this.float32[v+2]=p,this.float32[v+3]=g,r}}bs.prototype.bytesPerElement=16,Ei(bs,"StructArrayLayout4f16");class ss extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,h,p,g){const v=this.length;return this.resize(v+1),this.emplace(v,r,a,h,p,g)}emplace(r,a,h,p,g,v){const b=6*r,E=3*r;return this.uint16[b+0]=a,this.uint16[b+1]=h,this.uint16[b+2]=p,this.uint16[b+3]=g,this.float32[E+2]=v,r}}ss.prototype.bytesPerElement=12,Ei(ss,"StructArrayLayout4ui1f12");class Ns extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,h,p){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,h,p)}emplace(r,a,h,p,g){const v=4*r;return this.uint16[v+0]=a,this.uint16[v+1]=h,this.uint16[v+2]=p,this.uint16[v+3]=g,r}}Ns.prototype.bytesPerElement=8,Ei(Ns,"StructArrayLayout4ui8");class ir extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,h,p,g,v){const b=this.length;return this.resize(b+1),this.emplace(b,r,a,h,p,g,v)}emplace(r,a,h,p,g,v,b){const E=6*r;return this.int16[E+0]=a,this.int16[E+1]=h,this.int16[E+2]=p,this.int16[E+3]=g,this.int16[E+4]=v,this.int16[E+5]=b,r}}ir.prototype.bytesPerElement=12,Ei(ir,"StructArrayLayout6i12");class fr extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,h,p,g,v,b,E,k,X,se,he){const _e=this.length;return this.resize(_e+1),this.emplace(_e,r,a,h,p,g,v,b,E,k,X,se,he)}emplace(r,a,h,p,g,v,b,E,k,X,se,he,_e){const Ee=12*r;return this.int16[Ee+0]=a,this.int16[Ee+1]=h,this.int16[Ee+2]=p,this.int16[Ee+3]=g,this.uint16[Ee+4]=v,this.uint16[Ee+5]=b,this.uint16[Ee+6]=E,this.uint16[Ee+7]=k,this.int16[Ee+8]=X,this.int16[Ee+9]=se,this.int16[Ee+10]=he,this.int16[Ee+11]=_e,r}}fr.prototype.bytesPerElement=24,Ei(fr,"StructArrayLayout4i4ui4i24");class Ln extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,h,p,g,v){const b=this.length;return this.resize(b+1),this.emplace(b,r,a,h,p,g,v)}emplace(r,a,h,p,g,v,b){const E=10*r,k=5*r;return this.int16[E+0]=a,this.int16[E+1]=h,this.int16[E+2]=p,this.float32[k+2]=g,this.float32[k+3]=v,this.float32[k+4]=b,r}}Ln.prototype.bytesPerElement=20,Ei(Ln,"StructArrayLayout3i3f20");class Nr extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.uint32[1*r+0]=a,r}}Nr.prototype.bytesPerElement=4,Ei(Nr,"StructArrayLayout1ul4");class Yr extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,h,p,g,v,b,E,k,X,se,he,_e){const Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,r,a,h,p,g,v,b,E,k,X,se,he,_e)}emplace(r,a,h,p,g,v,b,E,k,X,se,he,_e,Ee){const Oe=20*r,Ve=10*r;return this.int16[Oe+0]=a,this.int16[Oe+1]=h,this.int16[Oe+2]=p,this.int16[Oe+3]=g,this.int16[Oe+4]=v,this.float32[Ve+3]=b,this.float32[Ve+4]=E,this.float32[Ve+5]=k,this.float32[Ve+6]=X,this.int16[Oe+14]=se,this.uint32[Ve+8]=he,this.uint16[Oe+18]=_e,this.uint16[Oe+19]=Ee,r}}Yr.prototype.bytesPerElement=40,Ei(Yr,"StructArrayLayout5i4f1i1ul2ui40");class mr extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,h,p,g,v,b){const E=this.length;return this.resize(E+1),this.emplace(E,r,a,h,p,g,v,b)}emplace(r,a,h,p,g,v,b,E){const k=8*r;return this.int16[k+0]=a,this.int16[k+1]=h,this.int16[k+2]=p,this.int16[k+4]=g,this.int16[k+5]=v,this.int16[k+6]=b,this.int16[k+7]=E,r}}mr.prototype.bytesPerElement=16,Ei(mr,"StructArrayLayout3i2i2i16");class Hn extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,h,p,g){const v=this.length;return this.resize(v+1),this.emplace(v,r,a,h,p,g)}emplace(r,a,h,p,g,v){const b=4*r,E=8*r;return this.float32[b+0]=a,this.float32[b+1]=h,this.float32[b+2]=p,this.int16[E+6]=g,this.int16[E+7]=v,r}}Hn.prototype.bytesPerElement=16,Ei(Hn,"StructArrayLayout2f1f2i16");class fc extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,h,p){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,h,p)}emplace(r,a,h,p,g){const v=12*r,b=3*r;return this.uint8[v+0]=a,this.uint8[v+1]=h,this.float32[b+1]=p,this.float32[b+2]=g,r}}fc.prototype.bytesPerElement=12,Ei(fc,"StructArrayLayout2ub2f12");class ol extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,a,h)}emplace(r,a,h,p){const g=3*r;return this.float32[g+0]=a,this.float32[g+1]=h,this.float32[g+2]=p,r}}ol.prototype.bytesPerElement=12,Ei(ol,"StructArrayLayout3f12");class Oo extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,a,h)}emplace(r,a,h,p){const g=3*r;return this.uint16[g+0]=a,this.uint16[g+1]=h,this.uint16[g+2]=p,r}}Oo.prototype.bytesPerElement=6,Ei(Oo,"StructArrayLayout3ui6");class po extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,a,h,p,g,v,b,E,k,X,se,he,_e,Ee,Oe,Ve,tt,ht,et,st,dt){const ut=this.length;return this.resize(ut+1),this.emplace(ut,r,a,h,p,g,v,b,E,k,X,se,he,_e,Ee,Oe,Ve,tt,ht,et,st,dt)}emplace(r,a,h,p,g,v,b,E,k,X,se,he,_e,Ee,Oe,Ve,tt,ht,et,st,dt,ut){const Ot=30*r,It=15*r,Wt=60*r;return this.int16[Ot+0]=a,this.int16[Ot+1]=h,this.int16[Ot+2]=p,this.float32[It+2]=g,this.float32[It+3]=v,this.uint16[Ot+8]=b,this.uint16[Ot+9]=E,this.uint32[It+5]=k,this.uint32[It+6]=X,this.uint32[It+7]=se,this.uint16[Ot+16]=he,this.uint16[Ot+17]=_e,this.uint16[Ot+18]=Ee,this.float32[It+10]=Oe,this.float32[It+11]=Ve,this.uint8[Wt+48]=tt,this.uint8[Wt+49]=ht,this.uint8[Wt+50]=et,this.uint32[It+13]=st,this.int16[Ot+28]=dt,this.uint8[Wt+58]=ut,r}}po.prototype.bytesPerElement=60,Ei(po,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class as extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,a,h,p,g,v,b,E,k,X,se,he,_e,Ee,Oe,Ve,tt,ht,et,st,dt,ut,Ot,It,Wt,ii,Bt,Xt,Qt,Jt){const oi=this.length;return this.resize(oi+1),this.emplace(oi,r,a,h,p,g,v,b,E,k,X,se,he,_e,Ee,Oe,Ve,tt,ht,et,st,dt,ut,Ot,It,Wt,ii,Bt,Xt,Qt,Jt)}emplace(r,a,h,p,g,v,b,E,k,X,se,he,_e,Ee,Oe,Ve,tt,ht,et,st,dt,ut,Ot,It,Wt,ii,Bt,Xt,Qt,Jt,oi){const Vt=38*r,di=19*r;return this.int16[Vt+0]=a,this.int16[Vt+1]=h,this.int16[Vt+2]=p,this.float32[di+2]=g,this.float32[di+3]=v,this.int16[Vt+8]=b,this.int16[Vt+9]=E,this.int16[Vt+10]=k,this.int16[Vt+11]=X,this.int16[Vt+12]=se,this.int16[Vt+13]=he,this.uint16[Vt+14]=_e,this.uint16[Vt+15]=Ee,this.uint16[Vt+16]=Oe,this.uint16[Vt+17]=Ve,this.uint16[Vt+18]=tt,this.uint16[Vt+19]=ht,this.uint16[Vt+20]=et,this.uint16[Vt+21]=st,this.uint16[Vt+22]=dt,this.uint16[Vt+23]=ut,this.uint16[Vt+24]=Ot,this.uint16[Vt+25]=It,this.uint16[Vt+26]=Wt,this.uint16[Vt+27]=ii,this.uint16[Vt+28]=Bt,this.uint32[di+15]=Xt,this.float32[di+16]=Qt,this.float32[di+17]=Jt,this.float32[di+18]=oi,r}}as.prototype.bytesPerElement=76,Ei(as,"StructArrayLayout3i2f6i15ui1ul3f76");class ls extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.float32[1*r+0]=a,r}}ls.prototype.bytesPerElement=4,Ei(ls,"StructArrayLayout1f4");class Va extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,h,p,g){const v=this.length;return this.resize(v+1),this.emplace(v,r,a,h,p,g)}emplace(r,a,h,p,g,v){const b=5*r;return this.float32[b+0]=a,this.float32[b+1]=h,this.float32[b+2]=p,this.float32[b+3]=g,this.float32[b+4]=v,r}}Va.prototype.bytesPerElement=20,Ei(Va,"StructArrayLayout5f20");class mc extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,h,p){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,h,p)}emplace(r,a,h,p,g){const v=6*r;return this.uint32[3*r+0]=a,this.uint16[v+2]=h,this.uint16[v+3]=p,this.uint16[v+4]=g,r}}mc.prototype.bytesPerElement=12,Ei(mc,"StructArrayLayout1ul3ui12");class na extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a){const h=this.length;return this.resize(h+1),this.emplace(h,r,a)}emplace(r,a,h){const p=2*r;return this.uint16[p+0]=a,this.uint16[p+1]=h,r}}na.prototype.bytesPerElement=4,Ei(na,"StructArrayLayout2ui4");class Ll extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.uint16[1*r+0]=a,r}}Ll.prototype.bytesPerElement=2,Ei(Ll,"StructArrayLayout1ui2");class Vg extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a){const h=this.length;return this.resize(h+1),this.emplace(h,r,a)}emplace(r,a,h){const p=2*r;return this.float32[p+0]=a,this.float32[p+1]=h,r}}Vg.prototype.bytesPerElement=8,Ei(Vg,"StructArrayLayout2f8");class Cv extends cn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Cv.prototype.size=40;class ui extends Yr{get(r){return new Cv(this,r)}}Ei(ui,"CollisionBoxArray");class cw extends cn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(r){this._structArray.uint8[this._pos1+49]=r}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(r){this._structArray.uint8[this._pos1+50]=r}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(r){this._structArray.uint32[this._pos4+13]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(r){this._structArray.uint8[this._pos1+58]=r}}cw.prototype.size=60;class hw extends po{get(r){return new cw(this,r)}}Ei(hw,"PlacedSymbolArray");class uw extends cn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(r){this._structArray.uint32[this._pos4+15]=r}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}uw.prototype.size=76;class dw extends as{get(r){return new uw(this,r)}}Ei(dw,"SymbolInstanceArray");class pw extends ls{getoffsetX(r){return this.float32[1*r+0]}}Ei(pw,"GlyphOffsetArray");class fw extends Un{getx(r){return this.int16[2*r+0]}gety(r){return this.int16[2*r+1]}}Ei(fw,"SymbolLineVertexArray");class mw extends cn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}mw.prototype.size=12;class qu extends mc{get(r){return new mw(this,r)}}Ei(qu,"FeatureIndexArray");class gw extends na{geta_centroid_pos0(r){return this.uint16[2*r+0]}geta_centroid_pos1(r){return this.uint16[2*r+1]}}Ei(gw,"FillExtrusionCentroidArray");const KM=Ci([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Ro=Ci([{name:"a_dash",components:4,type:"Uint16"}]);var $c={exports:{}},Ev=function(s,r){var a,h,p,g,v,b,E,k;for(h=s.length-(a=3&s.length),p=r,v=3432918353,b=461845907,k=0;k<h;)E=255&s.charCodeAt(k)|(255&s.charCodeAt(++k))<<8|(255&s.charCodeAt(++k))<<16|(255&s.charCodeAt(++k))<<24,++k,p=27492+(65535&(g=5*(65535&(p=(p^=E=(65535&(E=(E=(65535&E)*v+(((E>>>16)*v&65535)<<16)&4294967295)<<15|E>>>17))*b+(((E>>>16)*b&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(E=0,a){case 3:E^=(255&s.charCodeAt(k+2))<<16;case 2:E^=(255&s.charCodeAt(k+1))<<8;case 1:p^=E=(65535&(E=(E=(65535&(E^=255&s.charCodeAt(k)))*v+(((E>>>16)*v&65535)<<16)&4294967295)<<15|E>>>17))*b+(((E>>>16)*b&65535)<<16)&4294967295}return p^=s.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0},_a=function(s,r){for(var a,h=s.length,p=r^h,g=0;h>=4;)a=1540483477*(65535&(a=255&s.charCodeAt(g)|(255&s.charCodeAt(++g))<<8|(255&s.charCodeAt(++g))<<16|(255&s.charCodeAt(++g))<<24))+((1540483477*(a>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),h-=4,++g;switch(h){case 3:p^=(255&s.charCodeAt(g+2))<<16;case 2:p^=(255&s.charCodeAt(g+1))<<8;case 1:p=1540483477*(65535&(p^=255&s.charCodeAt(g)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};$c.exports=Ev,$c.exports.murmur3=Ev,$c.exports.murmur2=_a;class ja{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,a,h,p){this.ids.push(jg(r)),this.positions.push(a,h,p)}getPositions(r){const a=jg(r);let h=0,p=this.ids.length-1;for(;h<p;){const v=h+p>>1;this.ids[v]>=a?p=v:h=v+1}const g=[];for(;this.ids[h]===a;)g.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return g}static serialize(r,a){const h=new Float64Array(r.ids),p=new Uint32Array(r.positions);return Zu(h,p,0,h.length-1),a&&a.push(h.buffer,p.buffer),{ids:h,positions:p}}static deserialize(r){const a=new ja;return a.ids=r.ids,a.positions=r.positions,a.indexed=!0,a}}function jg(s){const r=+s;return!isNaN(r)&&Number.MIN_SAFE_INTEGER<=r&&r<=Number.MAX_SAFE_INTEGER?r:$c.exports(String(s))}function Zu(s,r,a,h){for(;a<h;){const p=s[a+h>>1];let g=a-1,v=h+1;for(;;){do{g++}while(s[g]<p);do{v--}while(s[v]>p);if(g>=v)break;Wc(s,g,v),Wc(r,3*g,3*v),Wc(r,3*g+1,3*v+1),Wc(r,3*g+2,3*v+2)}v-a<h-v?(Zu(s,r,a,v),a=v+1):(Zu(s,r,v+1,h),h=v)}}function Wc(s,r,a){const h=s[r];s[r]=s[a],s[a]=h}Ei(ja,"FeaturePositionMap");class Fl{constructor(r){this.gl=r.gl,this.initialized=!1}fetchUniformLocation(r,a){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(r,a),this.initialized=!0),!!this.location}}class Vf extends Fl{constructor(r){super(r),this.current=0}set(r,a,h){this.fetchUniformLocation(r,a)&&this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class Mv extends Fl{constructor(r){super(r),this.current=[0,0,0,0]}set(r,a,h){this.fetchUniformLocation(r,a)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3])))}}class yw extends Fl{constructor(r){super(r),this.current=Ur.transparent}set(r,a,h){this.fetchUniformLocation(r,a)&&(h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a)))}}const QM=new Float32Array(16),Sv=new Float32Array(9),ya=new Float32Array(4);function hp(s){return[Di(255*s.r,255*s.g),Di(255*s.b,255*s.a)]}class Nl{constructor(r,a,h){this.value=r,this.uniformNames=a.map(p=>`u_${p}`),this.type=h}setUniform(r,a,h,p,g){a.set(r,g,p.constantOr(this.value))}getBinding(r,a){return"color"===this.type?new yw(r):new Vf(r)}}class up{constructor(r,a){this.uniformNames=a.map(h=>`u_${h}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(r){this.pixelRatio=r.pixelRatio||1,this.pattern=r.tl.concat(r.br)}setUniform(r,a,h,p,g){const v="u_pattern"===g||"u_dash"===g?this.pattern:"u_pixel_ratio"===g?this.pixelRatio:null;v&&a.set(r,g,v)}getBinding(r,a){return"u_pattern"===a||"u_dash"===a?new Mv(r):new Vf(r)}}class Bl{constructor(r,a,h,p){this.expression=r,this.type=h,this.maxValue=0,this.paintVertexAttributes=a.map(g=>({name:`a_${g}`,type:"Float32",components:"color"===h?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(r,a,h,p,g,v){const b=this.paintVertexArray.length,E=this.expression.evaluate(new Ct(0),a,{},g,p,v);this.paintVertexArray.resize(r),this._setPaintValue(b,r,E)}updatePaintArray(r,a,h,p,g){const v=this.expression.evaluate({zoom:0},h,p,void 0,g);this._setPaintValue(r,a,v)}_setPaintValue(r,a,h){if("color"===this.type){const p=hp(h);for(let g=r;g<a;g++)this.paintVertexArray.emplace(g,p[0],p[1])}else{for(let p=r;p<a;p++)this.paintVertexArray.emplace(p,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class sl{constructor(r,a,h,p,g,v){this.expression=r,this.uniformNames=a.map(b=>`u_${b}_t`),this.type=h,this.useIntegerZoom=p,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=a.map(b=>({name:`a_${b}`,type:"Float32",components:"color"===h?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(r,a,h,p,g,v){const b=this.expression.evaluate(new Ct(this.zoom),a,{},g,p,v),E=this.expression.evaluate(new Ct(this.zoom+1),a,{},g,p,v),k=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(k,r,b,E)}updatePaintArray(r,a,h,p,g){const v=this.expression.evaluate({zoom:this.zoom},h,p,void 0,g),b=this.expression.evaluate({zoom:this.zoom+1},h,p,void 0,g);this._setPaintValue(r,a,v,b)}_setPaintValue(r,a,h,p){if("color"===this.type){const g=hp(h),v=hp(p);for(let b=r;b<a;b++)this.paintVertexArray.emplace(b,g[0],g[1],v[0],v[1])}else{for(let g=r;g<a;g++)this.paintVertexArray.emplace(g,h,p);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(p))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,a,h,p,g){const v=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,b=D(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);a.set(r,g,b)}getBinding(r,a){return new Vf(r)}}class Xc{constructor(r,a,h,p,g){this.expression=r,this.layerId=g,this.paintVertexAttributes=("array"===h?Ro:KM).members;for(let v=0;v<a.length;++v);this.paintVertexArray=new p}populatePaintArray(r,a,h){const p=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValues(p,r,a.patterns&&a.patterns[this.layerId],h)}updatePaintArray(r,a,h,p,g,v){this._setPaintValues(r,a,h.patterns&&h.patterns[this.layerId],v)}_setPaintValues(r,a,h,p){if(!p||!h)return;const g=p[h];if(!g)return;const{tl:v,br:b,pixelRatio:E}=g;for(let k=r;k<a;k++)this.paintVertexArray.emplace(k,v[0],v[1],b[0],b[1],E)}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class qc{constructor(r,a,h=(()=>!0)){this.binders={},this._buffers=[];const p=[];for(const g in r.paint._values){if(!h(g))continue;const v=r.paint.get(g);if(!(v instanceof Zt&&Vc(v.property.specification)))continue;const b=xw(g,r.type),E=v.value,k=v.property.specification.type,X=v.property.useIntegerZoom,se="line-dasharray"===g||g.endsWith("pattern"),he="line-dasharray"===g&&"constant"!==r.layout.get("line-cap").value.kind;if("constant"!==E.kind||he)if("source"===E.kind||he||se){const _e=bw(g,k,"source");this.binders[g]=se?new Xc(E,b,k,_e,r.id):new Bl(E,b,k,_e),p.push(`/a_${g}`)}else{const _e=bw(g,k,"composite");this.binders[g]=new sl(E,b,k,X,a,_e),p.push(`/z_${g}`)}else this.binders[g]=se?new up(E.value,b):new Nl(E.value,b,k),p.push(`/u_${g}`)}this.cacheKey=p.sort().join("")}getMaxValue(r){const a=this.binders[r];return a instanceof Bl||a instanceof sl?a.maxValue:0}populatePaintArrays(r,a,h,p,g,v){for(const b in this.binders){const E=this.binders[b];(E instanceof Bl||E instanceof sl||E instanceof Xc)&&E.populatePaintArray(r,a,h,p,g,v)}}setConstantPatternPositions(r){for(const a in this.binders){const h=this.binders[a];h instanceof up&&h.setConstantPatternPositions(r)}}updatePaintArrays(r,a,h,p,g,v){let b=!1;for(const E in r){const k=a.getPositions(E);for(const X of k){const se=h.feature(X.index);for(const he in this.binders){const _e=this.binders[he];if((_e instanceof Bl||_e instanceof sl||_e instanceof Xc)&&!0===_e.expression.isStateDependent){const Ee=p.paint.get(he);_e.expression=Ee.value,_e.updatePaintArray(X.start,X.end,se,r[E],g,v),b=!0}}}}return b}defines(){const r=[];for(const a in this.binders){const h=this.binders[a];(h instanceof Nl||h instanceof up)&&r.push(...h.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return r}getBinderAttributes(){const r=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof Bl||h instanceof sl||h instanceof Xc)for(let p=0;p<h.paintVertexAttributes.length;p++)r.push(h.paintVertexAttributes[p].name)}return r}getBinderUniforms(){const r=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof Nl||h instanceof up||h instanceof sl)for(const p of h.uniformNames)r.push(p)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r){const a=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof Nl||p instanceof up||p instanceof sl)for(const g of p.uniformNames)a.push({name:g,property:h,binding:p.getBinding(r,g)})}return a}setUniforms(r,a,h,p,g){for(const{name:v,property:b,binding:E}of h)this.binders[b].setUniform(r,E,g,p.get(b),v)}updatePaintBuffers(){this._buffers=[];for(const r in this.binders){const a=this.binders[r];(a instanceof Bl||a instanceof sl||a instanceof Xc)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(r){for(const a in this.binders){const h=this.binders[a];(h instanceof Bl||h instanceof sl||h instanceof Xc)&&h.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const a=this.binders[r];(a instanceof Bl||a instanceof sl||a instanceof Xc)&&a.destroy()}}}class jh{constructor(r,a,h=(()=>!0)){this.programConfigurations={};for(const p of r)this.programConfigurations[p.id]=new qc(p,a,h);this.needsUpload=!1,this._featureMap=new ja,this._bufferOffset=0}populatePaintArrays(r,a,h,p,g,v,b){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(r,a,p,g,v,b);void 0!==a.id&&this._featureMap.add(a.id,h,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,a,h,p,g){for(const v of h)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(r,this._featureMap,a,v,p,g)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}const vw={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function xw(s,r){return vw[s]||[s.replace(`${r}-`,"").replace(/-/g,"_")]}const Ug={"line-pattern":{source:ss,composite:ss},"fill-pattern":{source:ss,composite:ss},"fill-extrusion-pattern":{source:ss,composite:ss},"line-dasharray":{source:Ns,composite:Ns}},jf={color:{source:Vg,composite:bs},number:{source:ls,composite:Vg}};function bw(s,r,a){const h=Ug[s];return h&&h[a]||jf[r][a]}Ei(Nl,"ConstantBinder"),Ei(up,"PatternConstantBinder"),Ei(Bl,"SourceExpressionBinder"),Ei(Xc,"PatternCompositeBinder"),Ei(sl,"CompositeExpressionBinder"),Ei(qc,"ProgramConfiguration",{omit:["_buffers"]}),Ei(jh,"ProgramConfigurationSet");const Yc="-transition";class va extends Ws{constructor(r,a){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==r.type&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,"background"!==r.type&&"sky"!==r.type&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),a.layout&&(this._unevaluatedLayout=new zt(a.layout)),a.paint)){this._transitionablePaint=new Ht(a.paint);for(const h in r.paint)this.setPaintProperty(h,r.paint[h],{validate:!1});for(const h in r.layout)this.setLayoutProperty(h,r.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new li(a.paint)}}getLayoutProperty(r){return"visibility"===r?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,a,h={}){null!=a&&this._validate(Fa,`layers.${this.id}.layout.${r}`,r,a,h)||("visibility"!==r?this._unevaluatedLayout.setValue(r,a):this.visibility=a)}getPaintProperty(r){return V(r,Yc)?this._transitionablePaint.getTransition(r.slice(0,-Yc.length)):this._transitionablePaint.getValue(r)}setPaintProperty(r,a,h={}){if(null!=a&&this._validate(Nh,`layers.${this.id}.paint.${r}`,r,a,h))return!1;if(V(r,Yc))return this._transitionablePaint.setTransition(r.slice(0,-Yc.length),a||void 0),!1;{const p=this._transitionablePaint._values[r],g=p.value.isDataDriven(),v=p.value;this._transitionablePaint.setValue(r,a),this._handleSpecialPaintPropertyUpdate(r);const b=this._transitionablePaint._values[r].value,E=b.isDataDriven(),k=V(r,"pattern")||"line-dasharray"===r;return E||g||k||this._handleOverridablePaintPropertyUpdate(r,v,b)}}_handleSpecialPaintPropertyUpdate(r){}getProgramIds(){return null}getProgramConfiguration(r){return null}_handleOverridablePaintPropertyUpdate(r,a,h){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||"none"===this.visibility}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,a){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,a)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),de(r,(a,h)=>!(void 0===a||"layout"===h&&!Object.keys(a).length||"paint"===h&&!Object.keys(a).length))}_validate(r,a,h,p,g={}){return(!g||!1!==g.validate)&&Gu(this,r.call(Hu,{key:a,layerType:this.type,objectKey:h,value:p,styleSpec:$t,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const a=this.paint.get(r);if(a instanceof Zt&&Vc(a.property.specification)&&("source"===a.value.kind||"composite"===a.value.kind)&&a.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=uc(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Uf=Ci([{name:"a_pos",components:2,type:"Int16"}],4),ww=Ci([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ro{constructor(r=[]){this.segments=r}prepareSegment(r,a,h,p){let g=this.segments[this.segments.length-1];return r>ro.MAX_VERTEX_ARRAY_LENGTH&&De(`Max vertices per segment is ${ro.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!g||g.vertexLength+r>ro.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==p)&&(g={vertexOffset:a.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},void 0!==p&&(g.sortKey=p),this.segments.push(g)),g}get(){return this.segments}destroy(){for(const r of this.segments)for(const a in r.vaos)r.vaos[a].destroy()}static simpleSegment(r,a,h,p){return new ro([{vertexOffset:r,primitiveOffset:a,vertexLength:h,primitiveLength:p,vaos:{},sortKey:0}])}}ro.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ei(ro,"SegmentVector");var Zi=8192;class gc{constructor(r,a){r&&(a?this.setSouthWest(r).setNorthEast(a):4===r.length?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))}setNorthEast(r){return this._ne=r instanceof Dn?new Dn(r.lng,r.lat):Dn.convert(r),this}setSouthWest(r){return this._sw=r instanceof Dn?new Dn(r.lng,r.lat):Dn.convert(r),this}extend(r){const a=this._sw,h=this._ne;let p,g;if(r instanceof Dn)p=r,g=r;else{if(!(r instanceof gc))return Array.isArray(r)?4===r.length||r.every(Array.isArray)?this.extend(gc.convert(r)):this.extend(Dn.convert(r)):"object"==typeof r&&null!==r&&r.hasOwnProperty("lat")&&r.hasOwnProperty("lon")?this.extend(Dn.convert(r)):this;if(p=r._sw,g=r._ne,!p||!g)return this}return a||h?(a.lng=Math.min(p.lng,a.lng),a.lat=Math.min(p.lat,a.lat),h.lng=Math.max(g.lng,h.lng),h.lat=Math.max(g.lat,h.lat)):(this._sw=new Dn(p.lng,p.lat),this._ne=new Dn(g.lng,g.lat)),this}getCenter(){return new Dn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Dn(this.getWest(),this.getNorth())}getSouthEast(){return new Dn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:a,lat:h}=Dn.convert(r);let p=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&p}static convert(r){return!r||r instanceof gc?r:new gc(r)}}const Zc=6371008.8;class Dn{constructor(r,a){if(isNaN(r)||isNaN(a))throw new Error(`Invalid LngLat object: (${r}, ${a})`);if(this.lng=+r,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Dn(A(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const a=Math.PI/180,h=this.lat*a,p=r.lat*a,g=Math.sin(h)*Math.sin(p)+Math.cos(h)*Math.cos(p)*Math.cos((r.lng-this.lng)*a);return Zc*Math.acos(Math.min(g,1))}toBounds(r=0){const a=360*r/40075017,h=a/Math.cos(Math.PI/180*this.lat);return new gc(new Dn(this.lng-h,this.lat-a),new Dn(this.lng+h,this.lat+a))}static convert(r){if(r instanceof Dn)return r;if(Array.isArray(r)&&(2===r.length||3===r.length))return new Dn(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&"object"==typeof r&&null!==r)return new Dn(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Tv=2*Math.PI*Zc;function Pt(s){return Tv*Math.cos(s*Math.PI/180)}function al(s){return(180+s)/360}function nr(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function ra(s,r){return s/Pt(r)}function cs(s){return 360*s-180}function Xo(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function Dv(s,r){return s*Pt(Xo(r))}const zl=85.051129;function Hf(s){return 1/Math.cos(s*Math.PI/180)}class xa{constructor(r,a,h=0){this.x=+r,this.y=+a,this.z=+h}static fromLngLat(r,a=0){const h=Dn.convert(r);return new xa(al(h.lng),nr(h.lat),ra(a,h.lat))}toLngLat(){return new Dn(cs(this.x),Xo(this.y))}toAltitude(){return Dv(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Tv*Hf(Xo(this.y))}}function Gf(s,r,a,h,p,g,v,b,E){const k=(r+h)/2,X=(a+p)/2,se=new I(k,X);b(se),function(he,_e,Ee,Oe,Ve,tt){const ht=Ee-Ve,et=Oe-tt;return Math.abs((Oe-_e)*ht-(Ee-he)*et)/Math.hypot(ht,et)}(se.x,se.y,g.x,g.y,v.x,v.y)>=E?(Gf(s,r,a,k,X,g,se,b,E),Gf(s,k,X,h,p,se,v,b,E)):s.push(v)}function Uh(s,r,a){let h=s[0],p=h.x,g=h.y;r(h);const v=[h];for(let b=1;b<s.length;b++){const E=s[b],{x:k,y:X}=E;r(E),Gf(v,p,g,k,X,h,E,r,a),p=k,g=X,h=E}return v}function Hg(s,r,a,h){if(h(r,a)){const p=r.add(a)._mult(.5);Hg(s,r,p,h),Hg(s,p,a,h)}else s.push(a)}function Av(s,r){let a=s[0];const h=[a];for(let p=1;p<s.length;p++){const g=s[p];Hg(h,a,g,r),a=g}return h}const Hh=Math.pow(2,14)-1,dp=-Hh-1;function kv(s,r){const a=Math.round(s.x*r),h=Math.round(s.y*r);return s.x=D(a,dp,Hh),s.y=D(h,dp,Hh),(a<s.x||a>s.x+1||h<s.y||h>s.y+1)&&De("Geometry exceeds allowed extent, reduce your vector tile buffer size"),s}function _c(s,r,a){const h=s.loadGeometry(),p=s.extent,g=Zi/p;if(r&&a&&a.projection.isReprojectedInTileSpace){const v=1<<r.z,{scale:b,x:E,y:k,projection:X}=a,se=he=>{const _e=cs((r.x+he.x/p)/v),Ee=Xo((r.y+he.y/p)/v),Oe=X.project(_e,Ee);he.x=(Oe.x*b-E)*p,he.y=(Oe.y*b-k)*p};for(let he=0;he<h.length;he++)if(1!==s.type)h[he]=Uh(h[he],se,1);else{const _e=[];for(const Ee of h[he])Ee.x<0||Ee.x>=p||Ee.y<0||Ee.y>=p||(se(Ee),_e.push(Ee));h[he]=_e}}for(const v of h)for(const b of v)kv(b,g);return h}function Gh(s,r){return{type:s.type,id:s.id,properties:s.properties,geometry:r?_c(s):[]}}function yc(s,r,a,h,p){s.emplaceBack(2*r+(h+1)/2,2*a+(p+1)/2)}function Kc(s,r,a){s.emplaceBack(r.x,r.y,r.z,16384*a[0],16384*a[1],16384*a[2])}class Gg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.hasPattern=!1,this.projection=r.projection,this.layoutVertexArray=new Un,this.indexArray=new Oo,this.segments=new ro,this.programConfigurations=new jh(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(r,a,h,p){const g=this.layers[0],v=[];let b=null;"circle"===g.type&&(b=g.layout.get("circle-sort-key"));for(const{feature:k,id:X,index:se,sourceLayerIndex:he}of r){const _e=this.layers[0]._featureFilter.needGeometry,Ee=Gh(k,_e);if(!this.layers[0]._featureFilter.filter(new Ct(this.zoom),Ee,h))continue;const Oe=b?b.evaluate(Ee,{},h):void 0,Ve={id:X,properties:k.properties,type:k.type,sourceLayerIndex:he,index:se,geometry:_e?Ee.geometry:_c(k,h,p),patterns:{},sortKey:Oe};v.push(Ve)}b&&v.sort((k,X)=>k.sortKey-X.sortKey);let E=null;"globe"===p.projection.name&&(this.globeExtVertexArray=new ir,E=p.projection);for(const k of v){const{geometry:X,index:se,sourceLayerIndex:he}=k,_e=r[se].feature;this.addFeature(k,X,se,a.availableImages,h,E),a.featureIndex.insert(_e,X,se,he,this.index)}}update(r,a,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,h,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Uf.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,ww.members))),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(r,a,h,p,g,v){for(const b of a)for(const E of b){const k=E.x,X=E.y;if(k<0||k>=Zi||X<0||X>=Zi)continue;if(v){const _e=v.projectTilePoint(k,X,g),Ee=v.upVector(g,k,X),Oe=this.globeExtVertexArray;Kc(Oe,_e,Ee),Kc(Oe,_e,Ee),Kc(Oe,_e,Ee),Kc(Oe,_e,Ee)}const se=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),he=se.vertexLength;yc(this.layoutVertexArray,k,X,-1,-1),yc(this.layoutVertexArray,k,X,1,-1),yc(this.layoutVertexArray,k,X,1,1),yc(this.layoutVertexArray,k,X,-1,1),this.indexArray.emplaceBack(he,he+1,he+2),this.indexArray.emplaceBack(he,he+2,he+3),se.vertexLength+=4,se.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,{},p,g)}}function Cw(s,r){for(let a=0;a<s.length;a++)if($h(r,s[a]))return!0;for(let a=0;a<r.length;a++)if($h(s,r[a]))return!0;return!!$g(s,r)}function Iv(s,r,a){return!!$h(s,r)||!!Wg(r,s,a)}function Pv(s,r){if(1===s.length)return Xg(r,s[0]);for(let a=0;a<r.length;a++){const h=r[a];for(let p=0;p<h.length;p++)if($h(s,h[p]))return!0}for(let a=0;a<s.length;a++)if(Xg(r,s[a]))return!0;for(let a=0;a<r.length;a++)if($g(s,r[a]))return!0;return!1}function JM(s,r,a){if(s.length>1){if($g(s,r))return!0;for(let h=0;h<r.length;h++)if(Wg(r[h],s,a))return!0}for(let h=0;h<s.length;h++)if(Wg(s[h],r,a))return!0;return!1}function $g(s,r){if(0===s.length||0===r.length)return!1;for(let a=0;a<s.length-1;a++){const h=s[a],p=s[a+1];for(let g=0;g<r.length-1;g++)if(Ew(h,p,r[g],r[g+1]))return!0}return!1}function Ew(s,r,a,h){return oe(s,a,h)!==oe(r,a,h)&&oe(s,r,a)!==oe(s,r,h)}function Wg(s,r,a){const h=a*a;if(1===r.length)return s.distSqr(r[0])<h;for(let p=1;p<r.length;p++)if(pp(s,r[p-1],r[p])<h)return!0;return!1}function pp(s,r,a){const h=r.distSqr(a);if(0===h)return s.distSqr(r);const p=((s.x-r.x)*(a.x-r.x)+(s.y-r.y)*(a.y-r.y))/h;return s.distSqr(p<0?r:p>1?a:a.sub(r)._mult(p)._add(r))}function Xg(s,r){let a,h,p,g=!1;for(let v=0;v<s.length;v++){a=s[v];for(let b=0,E=a.length-1;b<a.length;E=b++)h=a[b],p=a[E],h.y>r.y!=p.y>r.y&&r.x<(p.x-h.x)*(r.y-h.y)/(p.y-h.y)+h.x&&(g=!g)}return g}function $h(s,r){let a=!1;for(let h=0,p=s.length-1;h<s.length;p=h++){const g=s[h],v=s[p];g.y>r.y!=v.y>r.y&&r.x<(v.x-g.x)*(r.y-g.y)/(v.y-g.y)+g.x&&(a=!a)}return a}function qg(s,r,a,h,p){for(const v of s)if(r<=v.x&&a<=v.y&&h>=v.x&&p>=v.y)return!0;const g=[new I(r,a),new I(r,p),new I(h,p),new I(h,a)];if(s.length>2)for(const v of g)if($h(s,v))return!0;for(let v=0;v<s.length-1;v++)if(eS(s[v],s[v+1],g))return!0;return!1}function eS(s,r,a){const h=a[0],p=a[2];if(s.x<h.x&&r.x<h.x||s.x>p.x&&r.x>p.x||s.y<h.y&&r.y<h.y||s.y>p.y&&r.y>p.y)return!1;const g=oe(s,r,a[0]);return g!==oe(s,r,a[1])||g!==oe(s,r,a[2])||g!==oe(s,r,a[3])}function Wh(s,r,a){const h=r.paint.get(s).value;return"constant"===h.kind?h.value:a.programConfigurations.get(r.id).getMaxValue(s)}function Yg(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function $f(s,r,a,h,p){if(!r[0]&&!r[1])return s;const g=I.convert(r)._mult(p);"viewport"===a&&g._rotate(-h);const v=[];for(let b=0;b<s.length;b++)v.push(s[b].sub(g));return v}function Ov(s,r,a,h){const p=I.convert(s)._mult(h);return"viewport"===r&&p._rotate(-a),p}Ei(Gg,"CircleBucket",{omit:["layers"]});const Rv=new ki({"circle-sort-key":new Lt($t.layout_circle["circle-sort-key"])});var Wf={paint:new ki({"circle-radius":new Lt($t.paint_circle["circle-radius"]),"circle-color":new Lt($t.paint_circle["circle-color"]),"circle-blur":new Lt($t.paint_circle["circle-blur"]),"circle-opacity":new Lt($t.paint_circle["circle-opacity"]),"circle-translate":new St($t.paint_circle["circle-translate"]),"circle-translate-anchor":new St($t.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new St($t.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new St($t.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Lt($t.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Lt($t.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Lt($t.paint_circle["circle-stroke-opacity"])}),layout:Rv},Ku=1e-6,Lo=typeof Float32Array<"u"?Float32Array:Array;function Lv(){var s=new Lo(9);return Lo!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function Fv(s,r,a){var h=r[0],p=r[1],g=r[2],v=r[3],b=r[4],E=r[5],k=r[6],X=r[7],se=r[8],he=a[0],_e=a[1],Ee=a[2],Oe=a[3],Ve=a[4],tt=a[5],ht=a[6],et=a[7],st=a[8];return s[0]=he*h+_e*v+Ee*k,s[1]=he*p+_e*b+Ee*X,s[2]=he*g+_e*E+Ee*se,s[3]=Oe*h+Ve*v+tt*k,s[4]=Oe*p+Ve*b+tt*X,s[5]=Oe*g+Ve*E+tt*se,s[6]=ht*h+et*v+st*k,s[7]=ht*p+et*b+st*X,s[8]=ht*g+et*E+st*se,s}function Vl(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Qu(s,r){var a=r[0],h=r[1],p=r[2],g=r[3],v=r[4],b=r[5],E=r[6],k=r[7],X=r[8],se=r[9],he=r[10],_e=r[11],Ee=r[12],Oe=r[13],Ve=r[14],tt=r[15],ht=a*b-h*v,et=a*E-p*v,st=a*k-g*v,dt=h*E-p*b,ut=h*k-g*b,Ot=p*k-g*E,It=X*Oe-se*Ee,Wt=X*Ve-he*Ee,ii=X*tt-_e*Ee,Bt=se*Ve-he*Oe,Xt=se*tt-_e*Oe,Qt=he*tt-_e*Ve,Jt=ht*Qt-et*Xt+st*Bt+dt*ii-ut*Wt+Ot*It;return Jt?(s[0]=(b*Qt-E*Xt+k*Bt)*(Jt=1/Jt),s[1]=(p*Xt-h*Qt-g*Bt)*Jt,s[2]=(Oe*Ot-Ve*ut+tt*dt)*Jt,s[3]=(he*ut-se*Ot-_e*dt)*Jt,s[4]=(E*ii-v*Qt-k*Wt)*Jt,s[5]=(a*Qt-p*ii+g*Wt)*Jt,s[6]=(Ve*st-Ee*Ot-tt*et)*Jt,s[7]=(X*Ot-he*st+_e*et)*Jt,s[8]=(v*Xt-b*ii+k*It)*Jt,s[9]=(h*ii-a*Xt-g*It)*Jt,s[10]=(Ee*ut-Oe*st+tt*ht)*Jt,s[11]=(se*st-X*ut-_e*ht)*Jt,s[12]=(b*Wt-v*Bt-E*It)*Jt,s[13]=(a*Bt-h*Wt+p*It)*Jt,s[14]=(Oe*et-Ee*dt-Ve*ht)*Jt,s[15]=(X*dt-se*et+he*ht)*Jt,s):null}function vc(s,r,a){var h=r[0],p=r[1],g=r[2],v=r[3],b=r[4],E=r[5],k=r[6],X=r[7],se=r[8],he=r[9],_e=r[10],Ee=r[11],Oe=r[12],Ve=r[13],tt=r[14],ht=r[15],et=a[0],st=a[1],dt=a[2],ut=a[3];return s[0]=et*h+st*b+dt*se+ut*Oe,s[1]=et*p+st*E+dt*he+ut*Ve,s[2]=et*g+st*k+dt*_e+ut*tt,s[3]=et*v+st*X+dt*Ee+ut*ht,s[4]=(et=a[4])*h+(st=a[5])*b+(dt=a[6])*se+(ut=a[7])*Oe,s[5]=et*p+st*E+dt*he+ut*Ve,s[6]=et*g+st*k+dt*_e+ut*tt,s[7]=et*v+st*X+dt*Ee+ut*ht,s[8]=(et=a[8])*h+(st=a[9])*b+(dt=a[10])*se+(ut=a[11])*Oe,s[9]=et*p+st*E+dt*he+ut*Ve,s[10]=et*g+st*k+dt*_e+ut*tt,s[11]=et*v+st*X+dt*Ee+ut*ht,s[12]=(et=a[12])*h+(st=a[13])*b+(dt=a[14])*se+(ut=a[15])*Oe,s[13]=et*p+st*E+dt*he+ut*Ve,s[14]=et*g+st*k+dt*_e+ut*tt,s[15]=et*v+st*X+dt*Ee+ut*ht,s}function Ju(s,r,a){var h,p,g,v,b,E,k,X,se,he,_e,Ee,Oe=a[0],Ve=a[1],tt=a[2];return r===s?(s[12]=r[0]*Oe+r[4]*Ve+r[8]*tt+r[12],s[13]=r[1]*Oe+r[5]*Ve+r[9]*tt+r[13],s[14]=r[2]*Oe+r[6]*Ve+r[10]*tt+r[14],s[15]=r[3]*Oe+r[7]*Ve+r[11]*tt+r[15]):(p=r[1],g=r[2],v=r[3],b=r[4],E=r[5],k=r[6],X=r[7],se=r[8],he=r[9],_e=r[10],Ee=r[11],s[0]=h=r[0],s[1]=p,s[2]=g,s[3]=v,s[4]=b,s[5]=E,s[6]=k,s[7]=X,s[8]=se,s[9]=he,s[10]=_e,s[11]=Ee,s[12]=h*Oe+b*Ve+se*tt+r[12],s[13]=p*Oe+E*Ve+he*tt+r[13],s[14]=g*Oe+k*Ve+_e*tt+r[14],s[15]=v*Oe+X*Ve+Ee*tt+r[15]),s}function Qc(s,r,a){var h=a[0],p=a[1],g=a[2];return s[0]=r[0]*h,s[1]=r[1]*h,s[2]=r[2]*h,s[3]=r[3]*h,s[4]=r[4]*p,s[5]=r[5]*p,s[6]=r[6]*p,s[7]=r[7]*p,s[8]=r[8]*g,s[9]=r[9]*g,s[10]=r[10]*g,s[11]=r[11]*g,s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s}function Xf(s,r,a){var h=Math.sin(a),p=Math.cos(a),g=r[4],v=r[5],b=r[6],E=r[7],k=r[8],X=r[9],se=r[10],he=r[11];return r!==s&&(s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[4]=g*p+k*h,s[5]=v*p+X*h,s[6]=b*p+se*h,s[7]=E*p+he*h,s[8]=k*p-g*h,s[9]=X*p-v*h,s[10]=se*p-b*h,s[11]=he*p-E*h,s}function jl(s,r,a){var h=Math.sin(a),p=Math.cos(a),g=r[0],v=r[1],b=r[2],E=r[3],k=r[8],X=r[9],se=r[10],he=r[11];return r!==s&&(s[4]=r[4],s[5]=r[5],s[6]=r[6],s[7]=r[7],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[0]=g*p-k*h,s[1]=v*p-X*h,s[2]=b*p-se*h,s[3]=E*p-he*h,s[8]=g*h+k*p,s[9]=v*h+X*p,s[10]=b*h+se*p,s[11]=E*h+he*p,s}function Nv(s,r){return s[0]=r[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=r[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=r[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Bv(s,r,a){var h,p,g,v=a[0],b=a[1],E=a[2],k=Math.hypot(v,b,E);return k<Ku?null:(v*=k=1/k,b*=k,E*=k,h=Math.sin(r),p=Math.cos(r),s[0]=v*v*(g=1-p)+p,s[1]=b*v*g+E*h,s[2]=E*v*g-b*h,s[3]=0,s[4]=v*b*g-E*h,s[5]=b*b*g+p,s[6]=E*b*g+v*h,s[7]=0,s[8]=v*E*g+b*h,s[9]=b*E*g-v*h,s[10]=E*E*g+p,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s)}Math.hypot||(Math.hypot=function(){for(var s=0,r=arguments.length;r--;)s+=arguments[r]*arguments[r];return Math.sqrt(s)});var Mw=vc;function Zg(){var s=new Lo(3);return Lo!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function zv(s){var r=new Lo(3);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r}function hs(s){return Math.hypot(s[0],s[1],s[2])}function Bs(s,r,a){var h=new Lo(3);return h[0]=s,h[1]=r,h[2]=a,h}function xc(s,r,a){return s[0]=r[0]+a[0],s[1]=r[1]+a[1],s[2]=r[2]+a[2],s}function Kg(s,r,a){return s[0]=r[0]-a[0],s[1]=r[1]-a[1],s[2]=r[2]-a[2],s}function Vv(s,r,a){return s[0]=r[0]*a[0],s[1]=r[1]*a[1],s[2]=r[2]*a[2],s}function fp(s,r,a){return s[0]=Math.min(r[0],a[0]),s[1]=Math.min(r[1],a[1]),s[2]=Math.min(r[2],a[2]),s}function mp(s,r,a){return s[0]=Math.max(r[0],a[0]),s[1]=Math.max(r[1],a[1]),s[2]=Math.max(r[2],a[2]),s}function ba(s,r,a){return s[0]=r[0]*a,s[1]=r[1]*a,s[2]=r[2]*a,s}function ed(s,r,a,h){return s[0]=r[0]+a[0]*h,s[1]=r[1]+a[1]*h,s[2]=r[2]+a[2]*h,s}function ws(s,r){var a=r[0],h=r[1],p=r[2],g=a*a+h*h+p*p;return g>0&&(g=1/Math.sqrt(g)),s[0]=r[0]*g,s[1]=r[1]*g,s[2]=r[2]*g,s}function Ua(s,r){return s[0]*r[0]+s[1]*r[1]+s[2]*r[2]}function Qg(s,r,a){var h=r[0],p=r[1],g=r[2],v=a[0],b=a[1],E=a[2];return s[0]=p*E-g*b,s[1]=g*v-h*E,s[2]=h*b-p*v,s}function Hr(s,r,a){var h=r[0],p=r[1],g=r[2],v=a[3]*h+a[7]*p+a[11]*g+a[15];return s[0]=(a[0]*h+a[4]*p+a[8]*g+a[12])/(v=v||1),s[1]=(a[1]*h+a[5]*p+a[9]*g+a[13])/v,s[2]=(a[2]*h+a[6]*p+a[10]*g+a[14])/v,s}function td(s,r,a){var h=a[0],p=a[1],g=a[2],v=r[0],b=r[1],E=r[2],k=p*E-g*b,X=g*v-h*E,se=h*b-p*v,he=p*se-g*X,_e=g*k-h*se,Ee=h*X-p*k,Oe=2*a[3];return X*=Oe,se*=Oe,_e*=2,Ee*=2,s[0]=v+(k*=Oe)+(he*=2),s[1]=b+X+_e,s[2]=E+se+Ee,s}var id,xo=Kg,gp=Vv,jv=hs;function Jg(s,r,a){return s[0]=r[0]*a,s[1]=r[1]*a,s[2]=r[2]*a,s[3]=r[3]*a,s}function e_(s,r){var a=r[0],h=r[1],p=r[2],g=r[3],v=a*a+h*h+p*p+g*g;return v>0&&(v=1/Math.sqrt(v)),s[0]=a*v,s[1]=h*v,s[2]=p*v,s[3]=g*v,s}function nd(s,r,a){var h=r[0],p=r[1],g=r[2],v=r[3];return s[0]=a[0]*h+a[4]*p+a[8]*g+a[12]*v,s[1]=a[1]*h+a[5]*p+a[9]*g+a[13]*v,s[2]=a[2]*h+a[6]*p+a[10]*g+a[14]*v,s[3]=a[3]*h+a[7]*p+a[11]*g+a[15]*v,s}function Sw(){var s=new Lo(4);return Lo!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function Tw(s){return s[0]=0,s[1]=0,s[2]=0,s[3]=1,s}function qf(s,r,a){a*=.5;var h=r[0],p=r[1],g=r[2],v=r[3],b=Math.sin(a),E=Math.cos(a);return s[0]=h*E+v*b,s[1]=p*E+g*b,s[2]=g*E-p*b,s[3]=v*E-h*b,s}function Yf(s,r,a){a*=.5;var h=r[0],p=r[1],g=r[2],v=r[3],b=Math.sin(a),E=Math.cos(a);return s[0]=h*E-g*b,s[1]=p*E+v*b,s[2]=g*E+h*b,s[3]=v*E-p*b,s}Zg(),id=new Lo(4),Lo!=Float32Array&&(id[0]=0,id[1]=0,id[2]=0,id[3]=0);var t_=e_;Zg(),Bs(1,0,0),Bs(0,1,0),Sw(),Sw(),Lv();class Uv{constructor(r,a){this.pos=r,this.dir=a}intersectsPlane(r,a,h){const p=Ua(a,this.dir);if(Math.abs(p)<1e-6)return!1;const g=((r[0]-this.pos[0])*a[0]+(r[1]-this.pos[1])*a[1]+(r[2]-this.pos[2])*a[2])/p;return h[0]=this.pos[0]+this.dir[0]*g,h[1]=this.pos[1]+this.dir[1]*g,h[2]=this.pos[2]+this.dir[2]*g,!0}closestPointOnSphere(r,a,h){if(Oe=(_e=this.pos)[0],Ve=_e[1],tt=_e[2],ht=(Ee=r)[0],et=Ee[1],st=Ee[2],Math.abs(Oe-ht)<=Ku*Math.max(1,Math.abs(Oe),Math.abs(ht))&&Math.abs(Ve-et)<=Ku*Math.max(1,Math.abs(Ve),Math.abs(et))&&Math.abs(tt-st)<=Ku*Math.max(1,Math.abs(tt),Math.abs(st))||0===a)return h[0]=h[1]=h[2]=0,!1;var _e,Ee,Oe,Ve,tt,ht,et,st;const[p,g,v]=this.dir,b=this.pos[0]-r[0],E=this.pos[1]-r[1],k=this.pos[2]-r[2],X=p*p+g*g+v*v,se=2*(b*p+E*g+k*v),he=se*se-4*X*(b*b+E*E+k*k-a*a);if(he<0){const _e=Math.max(-se/2,0),Ee=b+p*_e,Oe=E+g*_e,Ve=k+v*_e,tt=Math.hypot(Ee,Oe,Ve);return h[0]=Ee*a/tt,h[1]=Oe*a/tt,h[2]=Ve*a/tt,!1}{const _e=(-se-Math.sqrt(he))/(2*X);if(_e<0){const Ee=Math.hypot(b,E,k);return h[0]=b*a/Ee,h[1]=E*a/Ee,h[2]=k*a/Ee,!1}return h[0]=b+p*_e,h[1]=E+g*_e,h[2]=k+v*_e,!0}}}class Hv{constructor(r,a,h,p,g){this.TL=r,this.TR=a,this.BR=h,this.BL=p,this.horizon=g}static fromInvProjectionMatrix(r,a,h){const p=[-1,1,1],g=[1,1,1],v=[1,-1,1],b=[-1,-1,1],E=Hr(p,p,r),k=Hr(g,g,r),X=Hr(v,v,r),se=Hr(b,b,r);return new Hv(E,k,X,se,a/h)}}class Zf{constructor(r,a){this.points=r,this.planes=a}static fromInvProjectionMatrix(r,a,h,p){const g=Math.pow(2,h),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const k=nd([],E,r),X=1/k[3]/a*g;return(se=k)[0]=(he=k)[0]*(_e=[X,X,p?1/k[3]:X,X])[0],se[1]=he[1]*_e[1],se[2]=he[2]*_e[2],se[3]=he[3]*_e[3],se;var se,he,_e}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const k=ws([],Qg([],xo([],v[E[0]],v[E[1]]),xo([],v[E[2]],v[E[1]]))),X=-Ua(k,v[E[1]]);return k.concat(X)});return new Zf(v,b)}}class Cs{static fromPoints(r){const a=[1/0,1/0,1/0],h=[-1/0,-1/0,-1/0];for(const p of r)fp(a,a,p),mp(h,h,p);return new Cs(a,h)}static applyTransform(r,a){const h=r.getCorners();for(let p=0;p<h.length;++p)Hr(h[p],h[p],a);return Cs.fromPoints(h)}constructor(r,a){this.min=r,this.max=a,this.center=ba([],xc([],this.min,this.max),.5)}quadrant(r){const a=[r%2==0,r<2],h=zv(this.min),p=zv(this.max);for(let g=0;g<a.length;g++)h[g]=a[g]?this.min[g]:this.center[g],p[g]=a[g]?this.center[g]:this.max[g];return p[2]=this.max[2],new Cs(h,p)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}distanceZ(r){return Math.max(Math.min(this.max[2],r[2]),this.min[2])-r[2]}getCorners(){const r=this.min,a=this.max;return[[r[0],r[1],r[2]],[a[0],r[1],r[2]],[a[0],a[1],r[2]],[r[0],a[1],r[2]],[r[0],r[1],a[2]],[a[0],r[1],a[2]],[a[0],a[1],a[2]],[r[0],a[1],a[2]]]}intersects(r){const a=this.getCorners();let h=!0;for(let p=0;p<r.planes.length;p++){const g=r.planes[p];let v=0;for(let b=0;b<a.length;b++)v+=Ua(g,a[b])+g[3]>=0;if(0===v)return 0;v!==a.length&&(h=!1)}if(h)return 2;for(let p=0;p<3;p++){let g=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let b=0;b<r.points.length;b++){const E=r.points[b][p]-this.min[p];g=Math.min(g,E),v=Math.max(v,E)}if(v<0||g>this.max[p]-this.min[p])return 0}return 1}}function Gv(s,r,a,h,p,g,v,b,E){if(g&&s.queryGeometry.isAboveHorizon)return!1;g&&(E*=s.pixelToTileUnitsFactor);const k=s.tileID.canonical,X=a.projection.upVectorScale(k,a.center.lat,a.worldSize).metersToTile;for(const se of r)for(const he of se){const _e=he.add(b),Ee=p&&a.elevation?a.elevation.exaggeration()*p.getElevationAt(_e.x,_e.y,!0):0,Oe=a.projection.projectTilePoint(_e.x,_e.y,k);if(Ee>0){const et=a.projection.upVector(k,_e.x,_e.y);Oe.x+=et[0]*X*Ee,Oe.y+=et[1]*X*Ee,Oe.z+=et[2]*X*Ee}const Ve=g?_e:Dw(Oe.x,Oe.y,Oe.z,h),tt=g?s.tilespaceRays.map(et=>Kf(et,Ee)):s.queryGeometry.screenGeometry,ht=nd([],[Oe.x,Oe.y,Oe.z,1],h);if(!v&&g?E*=ht[3]/a.cameraToCenterDistance:v&&!g&&(E*=a.cameraToCenterDistance/ht[3]),g){const et=Xo((he.y/Zi+k.y)/(1<<k.z));E/=a.projection.pixelsPerMeter(et,1)/ra(1,et)}if(Iv(tt,Ve,E))return!0}return!1}function Dw(s,r,a,h){const p=nd([],[s,r,a,1],h);return new I(p[0]/p[3],p[1]/p[3])}const $v=Bs(0,0,0),Wv=Bs(0,0,1);function Kf(s,r){const a=Zg();return $v[2]=r,s.intersectsPlane($v,Wv,a),new I(a[0],a[1])}class i_ extends Gg{}function Qf(s,{width:r,height:a},h,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==r*a*h)throw new RangeError("mismatched image size")}else p=new Uint8Array(r*a*h);return s.width=r,s.height=a,s.data=p,s}function Xv(s,r,a){const{width:h,height:p}=r;h===s.width&&p===s.height||(hr(s,r,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,h),height:Math.min(s.height,p)},a),s.width=h,s.height=p,s.data=r.data)}function hr(s,r,a,h,p,g){if(0===p.width||0===p.height)return r;if(p.width>s.width||p.height>s.height||a.x>s.width-p.width||a.y>s.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>r.width||p.height>r.height||h.x>r.width-p.width||h.y>r.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const v=s.data,b=r.data;for(let E=0;E<p.height;E++){const k=((a.y+E)*s.width+a.x)*g,X=((h.y+E)*r.width+h.x)*g;for(let se=0;se<p.width*g;se++)b[X+se]=v[k+se]}return r}Ei(i_,"HeatmapBucket",{omit:["layers"]});class bc{constructor(r,a){Qf(this,r,1,a)}resize(r){Xv(this,new bc(r),1)}clone(){return new bc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,a,h,p,g){hr(r,a,h,p,g,1)}}class oa{constructor(r,a){Qf(this,r,4,a)}resize(r){Xv(this,new oa(r),4)}replace(r,a){a?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new oa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,a,h,p,g){hr(r,a,h,p,g,4)}}Ei(bc,"AlphaImage"),Ei(oa,"RGBAImage");var Jf={paint:new ki({"heatmap-radius":new Lt($t.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Lt($t.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new St($t.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ti($t.paint_heatmap["heatmap-color"]),"heatmap-opacity":new St($t.paint_heatmap["heatmap-opacity"])})};function em(s){const r={},a=s.resolution||256,h=s.clips?s.clips.length:1,p=s.image||new oa({width:a,height:h}),g=(v,b,E)=>{r[s.evaluationKey]=E;const k=s.expression.evaluate(r);p.data[v+b+0]=Math.floor(255*k.r/k.a),p.data[v+b+1]=Math.floor(255*k.g/k.a),p.data[v+b+2]=Math.floor(255*k.b/k.a),p.data[v+b+3]=Math.floor(255*k.a)};if(s.clips)for(let v=0,b=0;v<h;++v,b+=4*a)for(let E=0,k=0;E<a;E++,k+=4){const X=E/(a-1),{start:se,end:he}=s.clips[v];g(b,k,se*(1-X)+he*X)}else for(let v=0,b=0;v<a;v++,b+=4)g(0,b,v/(a-1));return p}var Aw={paint:new ki({"hillshade-illumination-direction":new St($t.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new St($t.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new St($t.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new St($t.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new St($t.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new St($t.paint_hillshade["hillshade-accent-color"])})};const kw=Ci([{name:"a_pos",components:2,type:"Int16"}],4),{members:Iw}=kw;var _p={exports:{}};function tm(s,r,a){a=a||2;var h,p,g,v,b,E,k,X=r&&r.length,se=X?r[0]*a:s.length,he=Pw(s,0,se,a,!0),_e=[];if(!he||he.next===he.prev)return _e;if(X&&(he=function(Oe,Ve,tt,ht){var et,st,dt,ut=[];for(et=0,st=Ve.length;et<st;et++)(dt=Pw(Oe,Ve[et]*ht,et<st-1?Ve[et+1]*ht:Oe.length,ht,!1))===dt.next&&(dt.steiner=!0),ut.push(tS(dt));for(ut.sort(Ow),et=0;et<ut.length;et++)tt=Kv(ut[et],tt);return tt}(s,r,he,a)),s.length>80*a){h=g=s[0],p=v=s[1];for(var Ee=a;Ee<se;Ee+=a)(b=s[Ee])<h&&(h=b),(E=s[Ee+1])<p&&(p=E),b>g&&(g=b),E>v&&(v=E);k=0!==(k=Math.max(g-h,v-p))?32767/k:0}return wc(he,_e,a,h,p,k,0),_e}function Pw(s,r,a,h,p){var g,v;if(p===rm(s,r,a,h)>0)for(g=r;g<a;g+=h)v=nm(g,s[g],s[g+1],v);else for(g=a-h;g>=r;g-=h)v=nm(g,s[g],s[g+1],v);return v&&vp(v,v.next)&&(th(v),v=v.next),v}function rd(s,r){if(!s)return s;r||(r=s);var a,h=s;do{if(a=!1,h.steiner||!vp(h,h.next)&&0!==Gr(h.prev,h,h.next))h=h.next;else{if(th(h),(h=r=h.prev)===h.next)break;a=!0}}while(a||h!==r);return r}function wc(s,r,a,h,p,g,v){if(s){!v&&g&&function(X,se,he,_e){var Ee=X;do{0===Ee.z&&(Ee.z=yp(Ee.x,Ee.y,se,he,_e)),Ee.prevZ=Ee.prev,Ee.nextZ=Ee.next,Ee=Ee.next}while(Ee!==X);Ee.prevZ.nextZ=null,Ee.prevZ=null,function(Oe){var Ve,tt,ht,et,st,dt,ut,Ot,It=1;do{for(tt=Oe,Oe=null,st=null,dt=0;tt;){for(dt++,ht=tt,ut=0,Ve=0;Ve<It&&(ut++,ht=ht.nextZ);Ve++);for(Ot=It;ut>0||Ot>0&&ht;)0!==ut&&(0===Ot||!ht||tt.z<=ht.z)?(et=tt,tt=tt.nextZ,ut--):(et=ht,ht=ht.nextZ,Ot--),st?st.nextZ=et:Oe=et,et.prevZ=st,st=et;tt=ht}st.nextZ=null,It*=2}while(dt>1)}(Ee)}(s,h,p,g);for(var b,E,k=s;s.prev!==s.next;)if(b=s.prev,E=s.next,g?qv(s,h,p,g):n_(s))r.push(b.i/a|0),r.push(s.i/a|0),r.push(E.i/a|0),th(s),s=E.next,k=E.next;else if((s=E)===k){v?1===v?wc(s=Yv(rd(s),r,a),r,a,h,p,g,2):2===v&&Zv(s,r,a,h,p,g):wc(rd(s),r,a,h,p,g,1);break}}}function n_(s){var r=s.prev,a=s,h=s.next;if(Gr(r,a,h)>=0)return!1;for(var p=r.x,g=a.x,v=h.x,b=r.y,E=a.y,k=h.y,X=p<g?p<v?p:v:g<v?g:v,se=b<E?b<k?b:k:E<k?E:k,he=p>g?p>v?p:v:g>v?g:v,_e=b>E?b>k?b:k:E>k?E:k,Ee=h.next;Ee!==r;){if(Ee.x>=X&&Ee.x<=he&&Ee.y>=se&&Ee.y<=_e&&od(p,b,g,E,v,k,Ee.x,Ee.y)&&Gr(Ee.prev,Ee,Ee.next)>=0)return!1;Ee=Ee.next}return!0}function qv(s,r,a,h){var p=s.prev,g=s,v=s.next;if(Gr(p,g,v)>=0)return!1;for(var b=p.x,E=g.x,k=v.x,X=p.y,se=g.y,he=v.y,_e=b<E?b<k?b:k:E<k?E:k,Ee=X<se?X<he?X:he:se<he?se:he,Oe=b>E?b>k?b:k:E>k?E:k,Ve=X>se?X>he?X:he:se>he?se:he,tt=yp(_e,Ee,r,a,h),ht=yp(Oe,Ve,r,a,h),et=s.prevZ,st=s.nextZ;et&&et.z>=tt&&st&&st.z<=ht;){if(et.x>=_e&&et.x<=Oe&&et.y>=Ee&&et.y<=Ve&&et!==p&&et!==v&&od(b,X,E,se,k,he,et.x,et.y)&&Gr(et.prev,et,et.next)>=0||(et=et.prevZ,st.x>=_e&&st.x<=Oe&&st.y>=Ee&&st.y<=Ve&&st!==p&&st!==v&&od(b,X,E,se,k,he,st.x,st.y)&&Gr(st.prev,st,st.next)>=0))return!1;st=st.nextZ}for(;et&&et.z>=tt;){if(et.x>=_e&&et.x<=Oe&&et.y>=Ee&&et.y<=Ve&&et!==p&&et!==v&&od(b,X,E,se,k,he,et.x,et.y)&&Gr(et.prev,et,et.next)>=0)return!1;et=et.prevZ}for(;st&&st.z<=ht;){if(st.x>=_e&&st.x<=Oe&&st.y>=Ee&&st.y<=Ve&&st!==p&&st!==v&&od(b,X,E,se,k,he,st.x,st.y)&&Gr(st.prev,st,st.next)>=0)return!1;st=st.nextZ}return!0}function Yv(s,r,a){var h=s;do{var p=h.prev,g=h.next.next;!vp(p,g)&&Jc(p,h,h.next,g)&&eh(p,g)&&eh(g,p)&&(r.push(p.i/a|0),r.push(h.i/a|0),r.push(g.i/a|0),th(h),th(h.next),h=s=g),h=h.next}while(h!==s);return rd(h)}function Zv(s,r,a,h,p,g){var v=s;do{for(var b=v.next.next;b!==v.prev;){if(v.i!==b.i&&r_(v,b)){var E=Jv(v,b);return v=rd(v,v.next),E=rd(E,E.next),wc(v,r,a,h,p,g,0),void wc(E,r,a,h,p,g,0)}b=b.next}v=v.next}while(v!==s)}function Ow(s,r){return s.x-r.x}function Kv(s,r){var a=function(p,g){var v,b=g,E=p.x,k=p.y,X=-1/0;do{if(k<=b.y&&k>=b.next.y&&b.next.y!==b.y){var se=b.x+(k-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(se<=E&&se>X&&(X=se,v=b.x<b.next.x?b:b.next,se===E))return v}b=b.next}while(b!==g);if(!v)return null;var he,_e=v,Ee=v.x,Oe=v.y,Ve=1/0;b=v;do{E>=b.x&&b.x>=Ee&&E!==b.x&&od(k<Oe?E:X,k,Ee,Oe,k<Oe?X:E,k,b.x,b.y)&&(he=Math.abs(k-b.y)/(E-b.x),eh(b,p)&&(he<Ve||he===Ve&&(b.x>v.x||b.x===v.x&&Qv(v,b)))&&(v=b,Ve=he)),b=b.next}while(b!==_e);return v}(s,r);if(!a)return r;var h=Jv(a,s);return rd(h,h.next),rd(a,a.next)}function Qv(s,r){return Gr(s.prev,s,r.prev)<0&&Gr(r.next,s,s.next)<0}function yp(s,r,a,h,p){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-a)*p|0)|s<<8))|s<<4))|s<<2))|s<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-h)*p|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function tS(s){var r=s,a=s;do{(r.x<a.x||r.x===a.x&&r.y<a.y)&&(a=r),r=r.next}while(r!==s);return a}function od(s,r,a,h,p,g,v,b){return(p-v)*(r-b)>=(s-v)*(g-b)&&(s-v)*(h-b)>=(a-v)*(r-b)&&(a-v)*(g-b)>=(p-v)*(h-b)}function r_(s,r){return s.next.i!==r.i&&s.prev.i!==r.i&&!function(a,h){var p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==h.i&&p.next.i!==h.i&&Jc(p,p.next,a,h))return!0;p=p.next}while(p!==a);return!1}(s,r)&&(eh(s,r)&&eh(r,s)&&function(a,h){var p=a,g=!1,v=(a.x+h.x)/2,b=(a.y+h.y)/2;do{p.y>b!=p.next.y>b&&p.next.y!==p.y&&v<(p.next.x-p.x)*(b-p.y)/(p.next.y-p.y)+p.x&&(g=!g),p=p.next}while(p!==a);return g}(s,r)&&(Gr(s.prev,s,r.prev)||Gr(s,r.prev,r))||vp(s,r)&&Gr(s.prev,s,s.next)>0&&Gr(r.prev,r,r.next)>0)}function Gr(s,r,a){return(r.y-s.y)*(a.x-r.x)-(r.x-s.x)*(a.y-r.y)}function vp(s,r){return s.x===r.x&&s.y===r.y}function Jc(s,r,a,h){var p=sd(Gr(s,r,a)),g=sd(Gr(s,r,h)),v=sd(Gr(a,h,s)),b=sd(Gr(a,h,r));return p!==g&&v!==b||!(0!==p||!im(s,a,r))||!(0!==g||!im(s,h,r))||!(0!==v||!im(a,s,h))||!(0!==b||!im(a,r,h))}function im(s,r,a){return r.x<=Math.max(s.x,a.x)&&r.x>=Math.min(s.x,a.x)&&r.y<=Math.max(s.y,a.y)&&r.y>=Math.min(s.y,a.y)}function sd(s){return s>0?1:s<0?-1:0}function eh(s,r){return Gr(s.prev,s,s.next)<0?Gr(s,r,s.next)>=0&&Gr(s,s.prev,r)>=0:Gr(s,r,s.prev)<0||Gr(s,s.next,r)<0}function Jv(s,r){var a=new Ul(s.i,s.x,s.y),h=new Ul(r.i,r.x,r.y),p=s.next,g=r.prev;return s.next=r,r.prev=s,a.next=p,p.prev=a,h.next=a,a.prev=h,g.next=h,h.prev=g,h}function nm(s,r,a,h){var p=new Ul(s,r,a);return h?(p.next=h.next,p.prev=h,h.next.prev=p,h.next=p):(p.prev=p,p.next=p),p}function th(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Ul(s,r,a){this.i=s,this.x=r,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function rm(s,r,a,h){for(var p=0,g=r,v=a-h;g<a;g+=h)p+=(s[v]-s[g])*(s[g+1]+s[v+1]),v=g;return p}function o_(s,r,a,h,p){e0(s,r,a||0,h||s.length-1,p||t0)}function e0(s,r,a,h,p){for(;h>a;){if(h-a>600){var g=h-a+1,v=r-a+1,b=Math.log(g),E=.5*Math.exp(2*b/3),k=.5*Math.sqrt(b*E*(g-E)/g)*(v-g/2<0?-1:1);e0(s,r,Math.max(a,Math.floor(r-v*E/g+k)),Math.min(h,Math.floor(r+(g-v)*E/g+k)),p)}var X=s[r],se=a,he=h;for(xp(s,a,r),p(s[h],X)>0&&xp(s,a,h);se<he;){for(xp(s,se,he),se++,he--;p(s[se],X)<0;)se++;for(;p(s[he],X)>0;)he--}0===p(s[a],X)?xp(s,a,he):xp(s,++he,h),he<=r&&(a=he+1),r<=he&&(h=he-1)}}function xp(s,r,a){var h=s[r];s[r]=s[a],s[a]=h}function t0(s,r){return s<r?-1:s>r?1:0}function ih(s,r){const a=s.length;if(a<=1)return[s];const h=[];let p,g;for(let v=0;v<a;v++){const b=ve(s[v]);0!==b&&(s[v].area=Math.abs(b),void 0===g&&(g=b<0),g===b<0?(p&&h.push(p),p=[s[v]]):p.push(s[v]))}if(p&&h.push(p),r>1)for(let v=0;v<h.length;v++)h[v].length<=r||(o_(h[v],r,1,h[v].length-1,Rw),h[v]=h[v].slice(0,r));return h}function Rw(s,r){return r.area-s.area}function s_(s,r,a){const h=a.patternDependencies;let p=!1;for(const g of r){const v=g.paint.get(`${s}-pattern`);v.isConstant()||(p=!0);const b=v.constantOr(null);b&&(p=!0,h[b]=!0)}return p}function a_(s,r,a,h,p){const g=p.patternDependencies;for(const v of r){const b=v.paint.get(`${s}-pattern`).value;if("constant"!==b.kind){let E=b.evaluate({zoom:h},a,{},p.availableImages);E=E&&E.name?E.name:E,g[E]=!0,a.patterns[v.id]=E}}return a}_p.exports=tm,_p.exports.default=tm,tm.deviation=function(s,r,a,h){var p=r&&r.length,g=Math.abs(rm(s,0,p?r[0]*a:s.length,a));if(p)for(var v=0,b=r.length;v<b;v++)g-=Math.abs(rm(s,r[v]*a,v<b-1?r[v+1]*a:s.length,a));var E=0;for(v=0;v<h.length;v+=3){var k=h[v]*a,X=h[v+1]*a,se=h[v+2]*a;E+=Math.abs((s[k]-s[se])*(s[X+1]-s[k+1])-(s[k]-s[X])*(s[se+1]-s[k+1]))}return 0===g&&0===E?0:Math.abs((E-g)/g)},tm.flatten=function(s){for(var r=s[0][0].length,a={vertices:[],holes:[],dimensions:r},h=0,p=0;p<s.length;p++){for(var g=0;g<s[p].length;g++)for(var v=0;v<r;v++)a.vertices.push(s[p][g][v]);p>0&&a.holes.push(h+=s[p-1].length)}return a};class om{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Un,this.indexArray=new Oo,this.indexArray2=new na,this.programConfigurations=new jh(r.layers,r.zoom),this.segments=new ro,this.segments2=new ro,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.projection=r.projection}populate(r,a,h,p){this.hasPattern=s_("fill",this.layers,a);const g=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:b,id:E,index:k,sourceLayerIndex:X}of r){const se=this.layers[0]._featureFilter.needGeometry,he=Gh(b,se);if(!this.layers[0]._featureFilter.filter(new Ct(this.zoom),he,h))continue;const _e=g?g.evaluate(he,{},h,a.availableImages):void 0,Ee={id:E,properties:b.properties,type:b.type,sourceLayerIndex:X,index:k,geometry:se?he.geometry:_c(b,h,p),patterns:{},sortKey:_e};v.push(Ee)}g&&v.sort((b,E)=>b.sortKey-E.sortKey);for(const b of v){const{geometry:E,index:k,sourceLayerIndex:X}=b;if(this.hasPattern){const se=a_("fill",this.layers,b,this.zoom,a);this.patternFeatures.push(se)}else this.addFeature(b,E,k,h,{},a.availableImages);a.featureIndex.insert(r[k].feature,E,k,X,this.index)}}update(r,a,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,h,p)}addFeatures(r,a,h,p,g){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,a,h,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Iw),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,a,h,p,g,v=[]){for(const b of ih(a,500)){let E=0;for(const Ee of b)E+=Ee.length;const k=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),X=k.vertexLength,se=[],he=[];for(const Ee of b){if(0===Ee.length)continue;Ee!==b[0]&&he.push(se.length/2);const Oe=this.segments2.prepareSegment(Ee.length,this.layoutVertexArray,this.indexArray2),Ve=Oe.vertexLength;this.layoutVertexArray.emplaceBack(Ee[0].x,Ee[0].y),this.indexArray2.emplaceBack(Ve+Ee.length-1,Ve),se.push(Ee[0].x),se.push(Ee[0].y);for(let tt=1;tt<Ee.length;tt++)this.layoutVertexArray.emplaceBack(Ee[tt].x,Ee[tt].y),this.indexArray2.emplaceBack(Ve+tt-1,Ve+tt),se.push(Ee[tt].x),se.push(Ee[tt].y);Oe.vertexLength+=Ee.length,Oe.primitiveLength+=Ee.length}const _e=_p.exports(se,he);for(let Ee=0;Ee<_e.length;Ee+=3)this.indexArray.emplaceBack(X+_e[Ee],X+_e[Ee+1],X+_e[Ee+2]);k.vertexLength+=E,k.primitiveLength+=_e.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,g,v,p)}}Ei(om,"FillBucket",{omit:["layers","patternFeatures"]});const l_=new ki({"fill-sort-key":new Lt($t.layout_fill["fill-sort-key"])});var Lw={paint:new ki({"fill-antialias":new St($t.paint_fill["fill-antialias"]),"fill-opacity":new Lt($t.paint_fill["fill-opacity"]),"fill-color":new Lt($t.paint_fill["fill-color"]),"fill-outline-color":new Lt($t.paint_fill["fill-outline-color"]),"fill-translate":new St($t.paint_fill["fill-translate"]),"fill-translate-anchor":new St($t.paint_fill["fill-translate-anchor"]),"fill-pattern":new Lt($t.paint_fill["fill-pattern"])}),layout:l_};const n0=Ci([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Fw=Ci([{name:"a_centroid_pos",components:2,type:"Uint16"}]),r0=Ci([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:iS}=n0;var sm={},Xh=I,o0=ll;function ll(s,r,a,h,p){this.properties={},this.extent=a,this.type=0,this._pbf=s,this._geometry=-1,this._keys=h,this._values=p,s.readFields(Zn,this,r)}function Zn(s,r,a){1==s?r.id=a.readVarint():2==s?function(h,p){for(var g=h.readVarint()+h.pos;h.pos<g;){var v=p._keys[h.readVarint()],b=p._values[h.readVarint()];p.properties[v]=b}}(a,r):3==s?r.type=a.readVarint():4==s&&(r._geometry=a.pos)}function Nw(s){for(var r,a,h=0,p=0,g=s.length,v=g-1;p<g;v=p++)h+=((a=s[v]).x-(r=s[p]).x)*(r.y+a.y);return h}ll.types=["Unknown","Point","LineString","Polygon"],ll.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var r,a=s.readVarint()+s.pos,h=1,p=0,g=0,v=0,b=[];s.pos<a;){if(p<=0){var E=s.readVarint();h=7&E,p=E>>3}if(p--,1===h||2===h)g+=s.readSVarint(),v+=s.readSVarint(),1===h&&(r&&b.push(r),r=[]),r.push(new Xh(g,v));else{if(7!==h)throw new Error("unknown command "+h);r&&r.push(r[0].clone())}}return r&&b.push(r),b},ll.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var r=s.readVarint()+s.pos,a=1,h=0,p=0,g=0,v=1/0,b=-1/0,E=1/0,k=-1/0;s.pos<r;){if(h<=0){var X=s.readVarint();a=7&X,h=X>>3}if(h--,1===a||2===a)(p+=s.readSVarint())<v&&(v=p),p>b&&(b=p),(g+=s.readSVarint())<E&&(E=g),g>k&&(k=g);else if(7!==a)throw new Error("unknown command "+a)}return[v,E,b,k]},ll.prototype.toGeoJSON=function(s,r,a){var h,p,g=this.extent*Math.pow(2,a),v=this.extent*s,b=this.extent*r,E=this.loadGeometry(),k=ll.types[this.type];function X(_e){for(var Ee=0;Ee<_e.length;Ee++){var Oe=_e[Ee];_e[Ee]=[360*(Oe.x+v)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(Oe.y+b)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var se=[];for(h=0;h<E.length;h++)se[h]=E[h][0];X(E=se);break;case 2:for(h=0;h<E.length;h++)X(E[h]);break;case 3:for(E=function(_e){var Ee=_e.length;if(Ee<=1)return[_e];for(var Oe,Ve,tt=[],ht=0;ht<Ee;ht++){var et=Nw(_e[ht]);0!==et&&(void 0===Ve&&(Ve=et<0),Ve===et<0?(Oe&&tt.push(Oe),Oe=[_e[ht]]):Oe.push(_e[ht]))}return Oe&&tt.push(Oe),tt}(E),h=0;h<E.length;h++)for(p=0;p<E[h].length;p++)X(E[h][p])}1===E.length?E=E[0]:k="Multi"+k;var he={type:"Feature",geometry:{type:k,coordinates:E},properties:this.properties};return"id"in this&&(he.id=this.id),he};var nS=o0,ad=Hl;function Hl(s,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(Bw,this,r),this.length=this._features.length}function Bw(s,r,a){15===s?r.version=a.readVarint():1===s?r.name=a.readString():5===s?r.extent=a.readVarint():2===s?r._features.push(a.pos):3===s?r._keys.push(a.readString()):4===s&&r._values.push(function(h){for(var p=null,g=h.readVarint()+h.pos;h.pos<g;){var v=h.readVarint()>>3;p=1===v?h.readString():2===v?h.readFloat():3===v?h.readDouble():4===v?h.readVarint64():5===v?h.readVarint():6===v?h.readSVarint():7===v?h.readBoolean():null}return p}(a))}Hl.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var r=this._pbf.readVarint()+this._pbf.pos;return new nS(this._pbf,r,this.extent,this._keys,this._values)};var zw=ad;function qh(s,r,a){if(3===s){var h=new zw(a,a.readVarint()+a.pos);h.length&&(r[h.name]=h)}}var c_=sm.VectorTile=function(s,r){this.layers=s.readFields(qh,{},r)},ld=sm.VectorTileFeature=o0;function am(s,r,a,h){const p=[],g=0===h?(v,b,E,k,X,se)=>{v.push(new I(se,E+(se-b)/(k-b)*(X-E)))}:(v,b,E,k,X,se)=>{v.push(new I(b+(se-E)/(X-E)*(k-b),se))};for(const v of s){const b=[];for(const E of v){if(E.length<=2)continue;const k=[];for(let he=0;he<E.length-1;he++){const _e=E[he].x,Ee=E[he].y,Oe=E[he+1].x,Ve=E[he+1].y,tt=0===h?_e:Ee,ht=0===h?Oe:Ve;tt<r?ht>r&&g(k,_e,Ee,Oe,Ve,r):tt>a?ht<a&&g(k,_e,Ee,Oe,Ve,a):k.push(E[he]),ht<r&&tt>=r&&g(k,_e,Ee,Oe,Ve,r),ht>a&&tt<=a&&g(k,_e,Ee,Oe,Ve,a)}let X=E[E.length-1];const se=0===h?X.x:X.y;se>=r&&se<=a&&k.push(X),k.length&&(X=k[k.length-1],k[0].x===X.x&&k[0].y===X.y||k.push(k[0]),b.push(k))}b.length&&p.push(b)}return p}sm.VectorTileLayer=ad;const Vw=ld.types,h_=Math.pow(2,13);function lm(s,r,a,h,p,g,v,b){s.emplaceBack((r<<1)+v,(a<<1)+g,(Math.floor(h*h_)<<1)+p,Math.round(b))}function cm(s,r,a){s.emplaceBack(r.x,r.y,r.z,16384*a[0],16384*a[1],16384*a[2])}class hm{constructor(){this.acc=new I(0,0),this.polyCount=[]}startRing(r){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new I(r.x,r.y),this.max=new I(r.x,r.y))}append(r,a){this.currentPolyCount.edges++,this.acc._add(r);const h=this.min,p=this.max;r.x<h.x?h.x=r.x:r.x>p.x&&(p.x=r.x),r.y<h.y?h.y=r.y:r.y>p.y&&(p.y=r.y),((0===r.x||r.x===Zi)&&r.x===a.x)!=((0===r.y||r.y===Zi)&&r.y===a.y)&&this.processBorderOverlap(r,a),a.x<0!=r.x<0&&this.addBorderIntersection(0,ci(a.y,r.y,(0-a.x)/(r.x-a.x))),a.x>Zi!=r.x>Zi&&this.addBorderIntersection(1,ci(a.y,r.y,(Zi-a.x)/(r.x-a.x))),a.y<0!=r.y<0&&this.addBorderIntersection(2,ci(a.x,r.x,(0-a.y)/(r.y-a.y))),a.y>Zi!=r.y>Zi&&this.addBorderIntersection(3,ci(a.x,r.x,(Zi-a.y)/(r.y-a.y)))}addBorderIntersection(r,a){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[r];a<h[0]&&(h[0]=a),a>h[1]&&(h[1]=a)}processBorderOverlap(r,a){if(r.x===a.x){if(r.y===a.y)return;const h=0===r.x?0:1;this.addBorderIntersection(h,a.y),this.addBorderIntersection(h,r.y)}else{const h=0===r.y?2:3;this.addBorderIntersection(h,a.x),this.addBorderIntersection(h,r.x)}}centroid(){const r=this.polyCount.reduce((a,h)=>a+h.edges,0);return 0!==r?this.acc.div(r)._round():new I(0,0)}span(){return new I(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((r,a)=>r+ +(a[0]!==Number.MAX_VALUE),0)}}class um{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=r.projection,this.layoutVertexArray=new tr,this.centroidVertexArray=new gw,this.indexArray=new Oo,this.programConfigurations=new jh(r.layers,r.zoom),this.segments=new ro,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.enableTerrain=r.enableTerrain}populate(r,a,h,p){this.features=[],this.hasPattern=s_("fill-extrusion",this.layers,a),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(g){const v=Math.exp(Math.PI*(1-g.y/(1<<g.z)*2));return 80150034*v/(v*v+1)/Zi/(1<<g.z)}(h),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:g,id:v,index:b,sourceLayerIndex:E}of r){const k=this.layers[0]._featureFilter.needGeometry,X=Gh(g,k);if(!this.layers[0]._featureFilter.filter(new Ct(this.zoom),X,h))continue;const se={id:v,sourceLayerIndex:E,index:b,geometry:k?X.geometry:_c(g,h,p),properties:g.properties,type:g.type,patterns:{}},he=this.layoutVertexArray.length;this.hasPattern?this.features.push(a_("fill-extrusion",this.layers,se,this.zoom,a)):this.addFeature(se,se.geometry,b,h,{},a.availableImages,p),a.featureIndex.insert(g,se.geometry,b,E,this.index,he)}this.sortBorders()}addFeatures(r,a,h,p,g){for(const v of this.features){const{geometry:b}=v;this.addFeature(v,b,v.index,a,h,p,g)}this.sortBorders()}update(r,a,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,h,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,iS),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=r.createVertexBuffer(this.layoutVertexExtArray,r0.members,!0))),this.programConfigurations.upload(r),this.uploaded=!0}uploadCentroid(r){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,Fw.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,a,h,p,g,v,b){const E=[new I(0,0),new I(Zi,Zi)],k=b.projection,X="globe"===k.name,se=this.enableTerrain&&!X?new hm:null,he="Polygon"===Vw[r.type];X&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new ir);const _e=ih(a,500);for(let tt=_e.length-1;tt>=0;tt--){const ht=_e[tt];(0===ht.length||(Ee=ht[0]).every(et=>et.x<=0)||Ee.every(et=>et.x>=Zi)||Ee.every(et=>et.y<=0)||Ee.every(et=>et.y>=Zi))&&_e.splice(tt,1)}var Ee;let Oe;if(X)Oe=d_(_e,E,p);else{Oe=[];for(const tt of _e)Oe.push({polygon:tt,bounds:E})}const Ve=he?this.edgeRadius:0;for(const{polygon:tt,bounds:ht}of Oe){let et=0,st=0;for(const ut of tt)he&&!ut[0].equals(ut[ut.length-1])&&ut.push(ut[0]),st+=he?ut.length-1:ut.length;const dt=this.segments.prepareSegment((he?5:4)*st,this.layoutVertexArray,this.indexArray);if(he){const ut=[],Ot=[];et=dt.vertexLength;for(const Wt of tt){let ii,Bt;Wt.length&&Wt!==tt[0]&&Ot.push(ut.length/2),ii=Wt[1].sub(Wt[0])._perp()._unit();for(let Xt=1;Xt<Wt.length;Xt++){const Qt=Wt[Xt],Jt=Wt[Xt===Wt.length-1?1:Xt+1];let{x:oi,y:Vt}=Qt;if(Ve){Bt=Jt.sub(Qt)._perp()._unit();const di=ii.add(Bt)._unit(),ji=Ve*Math.min(4,1/(ii.x*di.x+ii.y*di.y));oi+=ji*di.x,Vt+=ji*di.y,ii=Bt}lm(this.layoutVertexArray,oi,Vt,0,0,1,1,0),dt.vertexLength++,ut.push(Qt.x,Qt.y),X&&cm(this.layoutVertexExtArray,k.projectTilePoint(oi,Vt,p),k.upVector(p,oi,Vt))}}const It=_p.exports(ut,Ot);for(let Wt=0;Wt<It.length;Wt+=3)this.indexArray.emplaceBack(et+It[Wt],et+It[Wt+2],et+It[Wt+1]),dt.primitiveLength++}for(const ut of tt){se&&ut.length&&se.startRing(ut[0]);let Ot,It,Wt,ii=ut.length>4&&s0(ut[ut.length-2],ut[0],ut[1]),Bt=Ve?rS(ut[ut.length-2],ut[0],ut[1],Ve):0;It=ut[1].sub(ut[0])._perp()._unit();let Xt=!0;for(let Qt=1,Jt=0;Qt<ut.length;Qt++){let oi=ut[Qt-1],Vt=ut[Qt];const di=ut[Qt===ut.length-1?1:Qt+1];if(se&&he&&se.currentPolyCount.top++,Hw(Vt,oi,ht)){Ve&&(It=di.sub(Vt)._perp()._unit(),Xt=!Xt);continue}se&&se.append(Vt,oi);const ji=Vt.sub(oi)._perp(),bi=ji.x/(Math.abs(ji.x)+Math.abs(ji.y)),Si=ji.y>0?1:0,yi=oi.dist(Vt);if(Jt+yi>32768&&(Jt=0),Ve){Wt=di.sub(Vt)._perp()._unit();let wn=Uw(oi,Vt,di,jw(It,Wt),Ve);isNaN(wn)&&(wn=0);const Wi=Vt.sub(oi)._unit();oi=oi.add(Wi.mult(Bt))._round(),Vt=Vt.add(Wi.mult(-wn))._round(),Bt=wn,It=Wt}const qi=dt.vertexLength,kn=ut.length>4&&s0(oi,Vt,di);let _n=u_(Jt,ii,Xt);if(lm(this.layoutVertexArray,oi.x,oi.y,bi,Si,0,0,_n),lm(this.layoutVertexArray,oi.x,oi.y,bi,Si,0,1,_n),Jt+=yi,_n=u_(Jt,kn,!Xt),ii=kn,lm(this.layoutVertexArray,Vt.x,Vt.y,bi,Si,0,0,_n),lm(this.layoutVertexArray,Vt.x,Vt.y,bi,Si,0,1,_n),dt.vertexLength+=4,this.indexArray.emplaceBack(qi+0,qi+1,qi+2),this.indexArray.emplaceBack(qi+1,qi+3,qi+2),dt.primitiveLength+=2,Ve){const wn=et+(1===Qt?ut.length-2:Qt-2),Wi=1===Qt?et:wn+1;if(this.indexArray.emplaceBack(qi+1,wn,qi+3),this.indexArray.emplaceBack(wn,Wi,qi+3),dt.primitiveLength+=2,void 0===Ot&&(Ot=qi),!Hw(di,ut[Qt],ht)){const Kn=Qt===ut.length-1?Ot:dt.vertexLength;this.indexArray.emplaceBack(qi+2,qi+3,Kn),this.indexArray.emplaceBack(qi+3,Kn+1,Kn),this.indexArray.emplaceBack(qi+3,Wi,Kn+1),dt.primitiveLength+=3}Xt=!Xt}if(X){const wn=this.layoutVertexExtArray,Wi=k.projectTilePoint(oi.x,oi.y,p),Kn=k.projectTilePoint(Vt.x,Vt.y,p),rn=k.upVector(p,oi.x,oi.y),Cn=k.upVector(p,Vt.x,Vt.y);cm(wn,Wi,rn),cm(wn,Wi,rn),cm(wn,Kn,Cn),cm(wn,Kn,Cn)}}he&&(et+=ut.length-1)}}if(se&&se.polyCount.length>0){if(se.borders){se.vertexArrayOffset=this.centroidVertexArray.length;const tt=se.borders,ht=this.featuresOnBorder.push(se)-1;for(let et=0;et<4;et++)tt[et][0]!==Number.MAX_VALUE&&this.borders[et].push(ht)}this.encodeCentroid(se.borders?void 0:se.centroid(),se)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,g,v,p)}sortBorders(){for(let r=0;r<4;r++)this.borders[r].sort((a,h)=>this.featuresOnBorder[a].borders[r][0]-this.featuresOnBorder[h].borders[r][0])}encodeCentroid(r,a,h=!0){let p,g;if(r)if(0!==r.y){const b=a.span()._mult(this.tileToMeter);p=(Math.max(r.x,1)<<3)+Math.min(7,Math.round(b.x/10)),g=(Math.max(r.y,1)<<3)+Math.min(7,Math.round(b.y/10))}else p=Math.ceil(7*(r.x+450)),g=0;else p=0,g=+h;let v=h?this.centroidVertexArray.length:a.vertexArrayOffset;for(const b of a.polyCount){h&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*b.edges+b.top);for(let E=0;E<b.top;E++)this.centroidVertexArray.emplace(v++,p,g);for(let E=0;E<2*b.edges;E++)this.centroidVertexArray.emplace(v++,0,g),this.centroidVertexArray.emplace(v++,p,g)}}}function jw(s,r){const a=s.add(r)._unit();return s.x*a.x+s.y*a.y}function rS(s,r,a,h){const p=r.sub(s)._perp()._unit(),g=a.sub(r)._perp()._unit();return Uw(s,r,a,jw(p,g),h)}function Uw(s,r,a,h,p){const g=Math.sqrt(1-h*h);return Math.min(s.dist(r)/3,r.dist(a)/3,p*g/h)}function Hw(s,r,a){return s.x<a[0].x&&r.x<a[0].x||s.x>a[1].x&&r.x>a[1].x||s.y<a[0].y&&r.y<a[0].y||s.y>a[1].y&&r.y>a[1].y}function s0(s,r,a){if(s.x<0||s.x>=Zi||r.x<0||r.x>=Zi||a.x<0||a.x>=Zi)return!1;const h=a.sub(r),p=h.perp(),g=s.sub(r);return(h.x*g.x+h.y*g.y)/Math.sqrt((h.x*h.x+h.y*h.y)*(g.x*g.x+g.y*g.y))>-.866&&p.x*g.x+p.y*g.y<0}function u_(s,r,a){const h=r?2|s:-3&s;return a?1|h:-2&h}function dm(){const s=Math.PI/32,r=Math.tan(s),a=Zc;return a*Math.sqrt(1+2*r*r)-a}function d_(s,r,a){const h=1<<a.z,p=cs(a.x/h),g=cs((a.x+1)/h),v=Xo(a.y/h),b=Xo((a.y+1)/h);return function(E,k,X,se,he=0,_e){const Ee=[];if(!E.length||!X||!se)return Ee;const Oe=(ut,Ot)=>{for(const It of ut)Ee.push({polygon:It,bounds:Ot})},Ve=Math.ceil(Math.log2(X)),tt=Math.ceil(Math.log2(se)),ht=Ve-tt,et=[];for(let ut=0;ut<Math.abs(ht);ut++)et.push(ht>0?0:1);for(let ut=0;ut<Math.min(Ve,tt);ut++)et.push(0),et.push(1);let st=E;if(st=am(st,k[0].y-he,k[1].y+he,1),st=am(st,k[0].x-he,k[1].x+he,0),!st.length)return Ee;const dt=[];for(et.length?dt.push({polygons:st,bounds:k,depth:0}):Oe(st,k);dt.length;){const ut=dt.pop(),Ot=ut.depth,It=et[Ot],Wt=ut.bounds[0],ii=ut.bounds[1],Bt=0===It?Wt.x:Wt.y,Xt=0===It?ii.x:ii.y,Qt=_e?_e(It,Bt,Xt):.5*(Bt+Xt),Jt=am(ut.polygons,Bt-he,Qt+he,It),oi=am(ut.polygons,Qt-he,Xt+he,It);if(Jt.length){const Vt=[Wt,new I(0===It?Qt:ii.x,1===It?Qt:ii.y)];et.length>Ot+1?dt.push({polygons:Jt,bounds:Vt,depth:Ot+1}):Oe(Jt,Vt)}if(oi.length){const Vt=[new I(0===It?Qt:Wt.x,1===It?Qt:Wt.y),ii];et.length>Ot+1?dt.push({polygons:oi,bounds:Vt,depth:Ot+1}):Oe(oi,Vt)}}return Ee}(s,r,Math.ceil((g-p)/11.25),Math.ceil((v-b)/11.25),1,(E,k,X)=>{if(0===E)return.5*(k+X);{const se=Xo((a.y+k/Zi)/h);return(nr(.5*(Xo((a.y+X/Zi)/h)+se))*h-a.y)*Zi}})}Ei(um,"FillExtrusionBucket",{omit:["layers","features"]}),Ei(hm,"PartMetadata");const a0=new ki({"fill-extrusion-edge-radius":new St($t["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var l0={paint:new ki({"fill-extrusion-opacity":new St($t["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Lt($t["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new St($t["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new St($t["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Lt($t["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Lt($t["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Lt($t["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new St($t["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new St($t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new St($t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:a0};function pm(s,r,a){var h=2*Math.PI*6378137/256/Math.pow(2,a);return[s*h-2*Math.PI*6378137/2,r*h-2*Math.PI*6378137/2]}class fm{constructor(r,a,h){this.z=r,this.x=a,this.y=h,this.key=bp(0,r,r,a,h)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,a){const h=(v=this.y,b=this.z,E=pm(256*(g=this.x),256*(v=Math.pow(2,b)-v-1),b),k=pm(256*(g+1),256*(v+1),b),E[0]+","+E[1]+","+k[0]+","+k[1]),p=function(g,v,b){let E,k="";for(let X=g;X>0;X--)E=1<<X-1,k+=(v&E?1:0)+(b&E?2:0);return k}(this.z,this.x,this.y);var g,v,b,E,k;return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===a?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",h)}toString(){return`${this.z}/${this.x}/${this.y}`}}class mm{constructor(r,a){this.wrap=r,this.canonical=a,this.key=bp(r,a.z,a.z,a.x,a.y)}}class $r{constructor(r,a,h,p,g){this.overscaledZ=r,this.wrap=a,this.canonical=new fm(h,+p,+g),this.key=0===a&&r===h?this.canonical.key:bp(a,r,h,p,g)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){const a=this.canonical.z-r;return r>this.canonical.z?new $r(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new $r(r,this.wrap,r,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(r,a=!0){if(this.overscaledZ===r&&a)return this.key;if(r>this.canonical.z)return bp(this.wrap*+a,r,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-r;return bp(this.wrap*+a,r,r,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(r){if(r.wrap!==this.wrap)return!1;const a=this.canonical.z-r.canonical.z;return 0===r.overscaledZ||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>a&&r.canonical.y===this.canonical.y>>a}children(r){if(this.overscaledZ>=r)return[new $r(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,h=2*this.canonical.x,p=2*this.canonical.y;return[new $r(a,this.wrap,a,h,p),new $r(a,this.wrap,a,h+1,p),new $r(a,this.wrap,a,h,p+1),new $r(a,this.wrap,a,h+1,p+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new $r(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new $r(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new mm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function bp(s,r,a,h,p){const g=1<<Math.min(a,22);let v=g*(p%g)+h%g;return s&&a<22&&(v+=g*g*((s<0?-2*s-1:2*s)%(1<<2*(22-a)))),16*(32*v+a)+(r-a)}Ei(fm,"CanonicalTileID"),Ei($r,"OverscaledTileID",{omit:["projMatrix"]});class cd extends I{constructor(r,a,h){super(r,a),this.z=h}}function wp(s,r){return s.x*r.x+s.y*r.y}function p_(s,r){if(1===s.length){let a=0;const h=r[a++];let p;for(;!p||h.equals(p);)if(p=r[a++],!p)return 1/0;for(;a<r.length;a++){const g=r[a],v=s[0],b=p.sub(h),E=g.sub(h),k=v.sub(h),X=wp(b,b),se=wp(b,E),he=wp(E,E),_e=wp(k,b),Ee=wp(k,E),Oe=X*he-se*se,Ve=(he*_e-se*Ee)/Oe,tt=(X*Ee-se*_e)/Oe,ht=h.z*(1-Ve-tt)+p.z*Ve+g.z*tt;if(isFinite(ht))return ht}return 1/0}{let a=1/0;for(const h of r)a=Math.min(a,h.z);return a}}function c0(s,r,a,h,p,g,v,b){const E=v*p.getElevationAt(s,r,!0,!0),k=0!==g[0],X=k?0===g[1]?v*(g[0]/7-450):v*function(se,he,_e){const Ee=Math.floor(he[0]/8),Oe=Math.floor(he[1]/8),Ve=10*(he[0]-8*Ee),tt=10*(he[1]-8*Oe),ht=se.getElevationAt(Ee,Oe,!0,!0),et=se.getMeterToDEM(_e),st=Math.floor(.5*(Ve*et-1)),dt=Math.floor(.5*(tt*et-1)),ut=se.tileCoordToPixel(Ee,Oe),Ot=2*st+1,It=2*dt+1,Wt=(ji=Ot,bi=It,[(oi=se).getElevationAtPixel(Vt=ut.x-st,di=ut.y-dt,!0),oi.getElevationAtPixel(Vt+bi,di,!0),oi.getElevationAtPixel(Vt,di+bi,!0),oi.getElevationAtPixel(Vt+ji,di+bi,!0)]),ii=Math.abs(Wt[0]-Wt[1]),Bt=Math.abs(Wt[2]-Wt[3]),Xt=Math.abs(Wt[0]-Wt[2])+Math.abs(Wt[1]-Wt[3]),Qt=Math.min(.25,.5*et*(ii+Bt)/Ot),Jt=Math.min(.25,.5*et*Xt/It);var oi,Vt,di,ji,bi;return ht+Math.max(Qt*Ve,Jt*tt)}(p,g,b):E;return{base:E+(0===a)?-1:a,top:k?Math.max(X+h,E+a+2):E+h}}const Gw=Ci([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:$w}=Gw,Ww=Ci([{name:"a_packed",components:4,type:"Float32"}]),{members:f_}=Ww,Xw=ld.types,qw=Math.cos(Math.PI/180*37.5);class gm{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.projection=r.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new os,this.layoutVertexArray2=new bs,this.indexArray=new Oo,this.programConfigurations=new jh(r.layers,r.zoom),this.segments=new ro,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(r,a,h,p){this.hasPattern=s_("line",this.layers,a);const g=this.layers[0].layout.get("line-sort-key"),v=[];for(const{feature:X,id:se,index:he,sourceLayerIndex:_e}of r){const Ee=this.layers[0]._featureFilter.needGeometry,Oe=Gh(X,Ee);if(!this.layers[0]._featureFilter.filter(new Ct(this.zoom),Oe,h))continue;const Ve=g?g.evaluate(Oe,{},h):void 0,tt={id:se,properties:X.properties,type:X.type,sourceLayerIndex:_e,index:he,geometry:Ee?Oe.geometry:_c(X,h,p),patterns:{},sortKey:Ve};v.push(tt)}g&&v.sort((X,se)=>X.sortKey-se.sortKey);const{lineAtlas:b,featureIndex:E}=a,k=this.addConstantDashes(b);for(const X of v){const{geometry:se,index:he,sourceLayerIndex:_e}=X;if(k&&this.addFeatureDashes(X,b),this.hasPattern){const Ee=a_("line",this.layers,X,this.zoom,a);this.patternFeatures.push(Ee)}else this.addFeature(X,se,he,h,b.positions,a.availableImages);E.insert(r[he].feature,se,he,_e,this.index)}}addConstantDashes(r){let a=!1;for(const h of this.layers){const p=h.paint.get("line-dasharray").value,g=h.layout.get("line-cap").value;if("constant"!==p.kind||"constant"!==g.kind)a=!0;else{const v=g.value,b=p.value;if(!b)continue;r.addDash(b,v)}}return a}addFeatureDashes(r,a){const h=this.zoom;for(const p of this.layers){const g=p.paint.get("line-dasharray").value,v=p.layout.get("line-cap").value;if("constant"===g.kind&&"constant"===v.kind)continue;let b,E;if("constant"===g.kind){if(b=g.value,!b)continue}else b=g.evaluate({zoom:h},r);E="constant"===v.kind?v.value:v.evaluate({zoom:h},r),a.addDash(b,E),r.patterns[p.id]=a.getKey(b,E)}}update(r,a,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,h,p)}addFeatures(r,a,h,p,g){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,a,h,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,f_)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,$w),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&r.properties.hasOwnProperty("mapbox_clip_start")&&r.properties.hasOwnProperty("mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,a,h,p,g,v){const b=this.layers[0].layout,E=b.get("line-join").evaluate(r,{}),k=b.get("line-cap").evaluate(r,{}),X=b.get("line-miter-limit"),se=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const he of a)this.addLine(he,r,E,k,X,se);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,g,v,p)}addLine(r,a,h,p,g,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let tt=0;tt<r.length-1;tt++)this.totalDistance+=r[tt].dist(r[tt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b="Polygon"===Xw[a.type];let E=r.length;for(;E>=2&&r[E-1].equals(r[E-2]);)E--;let k=0;for(;k<E-1&&r[k].equals(r[k+1]);)k++;if(E<(b?3:2))return;"bevel"===h&&(g=1.05);const X=this.overscaling<=16?122880/(512*this.overscaling):0,se=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let he,_e,Ee,Oe,Ve;this.e1=this.e2=-1,b&&(he=r[E-2],Ve=r[k].sub(he)._unit()._perp());for(let tt=k;tt<E;tt++){if(Ee=tt===E-1?b?r[k+1]:void 0:r[tt+1],Ee&&r[tt].equals(Ee))continue;Ve&&(Oe=Ve),he&&(_e=he),he=r[tt],Ve=Ee?Ee.sub(he)._unit()._perp():Oe,Oe=Oe||Ve;let ht=Oe.add(Ve);0===ht.x&&0===ht.y||ht._unit();const et=Oe.x*Ve.x+Oe.y*Ve.y,st=ht.x*Ve.x+ht.y*Ve.y,dt=0!==st?1/st:1/0,ut=2*Math.sqrt(2-2*st),Ot=st<qw&&_e&&Ee,It=Oe.x*Ve.y-Oe.y*Ve.x>0;if(Ot&&tt>k){const Bt=he.dist(_e);if(Bt>2*X){const Xt=he.sub(he.sub(_e)._mult(X/Bt)._round());this.updateDistance(_e,Xt),this.addCurrentVertex(Xt,Oe,0,0,se),_e=Xt}}const Wt=_e&&Ee;let ii=Wt?h:b?"butt":p;if(Wt&&"round"===ii&&(dt<v?ii="miter":dt<=2&&(ii="fakeround")),"miter"===ii&&dt>g&&(ii="bevel"),"bevel"===ii&&(dt>2&&(ii="flipbevel"),dt<g&&(ii="miter")),_e&&this.updateDistance(_e,he),"miter"===ii)ht._mult(dt),this.addCurrentVertex(he,ht,0,0,se);else if("flipbevel"===ii){if(dt>100)ht=Ve.mult(-1);else{const Bt=dt*Oe.add(Ve).mag()/Oe.sub(Ve).mag();ht._perp()._mult(Bt*(It?-1:1))}this.addCurrentVertex(he,ht,0,0,se),this.addCurrentVertex(he,ht.mult(-1),0,0,se)}else if("bevel"===ii||"fakeround"===ii){const Bt=-Math.sqrt(dt*dt-1),Xt=It?Bt:0,Qt=It?0:Bt;if(_e&&this.addCurrentVertex(he,Oe,Xt,Qt,se),"fakeround"===ii){const Jt=Math.round(180*ut/Math.PI/20);for(let oi=1;oi<Jt;oi++){let Vt=oi/Jt;if(.5!==Vt){const ji=Vt-.5;Vt+=Vt*ji*(Vt-1)*((1.0904+et*(et*(3.55645-1.43519*et)-3.2452))*ji*ji+(.848013+et*(.215638*et-1.06021)))}const di=Ve.sub(Oe)._mult(Vt)._add(Oe)._unit()._mult(It?-1:1);this.addHalfVertex(he,di.x,di.y,!1,It,0,se)}}Ee&&this.addCurrentVertex(he,Ve,-Xt,-Qt,se)}else if("butt"===ii)this.addCurrentVertex(he,ht,0,0,se);else if("square"===ii){const Bt=_e?1:-1;_e||this.addCurrentVertex(he,ht,Bt,Bt,se),this.addCurrentVertex(he,ht,0,0,se),_e&&this.addCurrentVertex(he,ht,Bt,Bt,se)}else"round"===ii&&(_e&&(this.addCurrentVertex(he,Oe,0,0,se),this.addCurrentVertex(he,Oe,1,1,se,!0)),Ee&&(this.addCurrentVertex(he,Ve,-1,-1,se,!0),this.addCurrentVertex(he,Ve,0,0,se)));if(Ot&&tt<E-1){const Bt=he.dist(Ee);if(Bt>2*X){const Xt=he.add(Ee.sub(he)._mult(X/Bt)._round());this.updateDistance(he,Xt),this.addCurrentVertex(Xt,Ve,0,0,se),he=Xt}}}}addCurrentVertex(r,a,h,p,g,v=!1){const b=a.y*p-a.x,E=-a.y-a.x*p;this.addHalfVertex(r,a.x+a.y*h,a.y-a.x*h,v,!1,h,g),this.addHalfVertex(r,b,E,v,!0,-p,g)}addHalfVertex({x:r,y:a},h,p,g,v,b,E){this.layoutVertexArray.emplaceBack((r<<1)+(g?1:0),(a<<1)+(v?1:0),Math.round(63*h)+128,Math.round(63*p)+128,1+(0===b?0:b<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const k=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),E.primitiveLength++),v?this.e2=k:this.e1=k}updateScaledDistance(){if(this.lineClips){const r=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=r*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(r,a){this.distance+=r.dist(a),this.updateScaledDistance()}}Ei(gm,"LineBucket",{omit:["layers","patternFeatures"]});const h0=new ki({"line-cap":new Lt($t.layout_line["line-cap"]),"line-join":new Lt($t.layout_line["line-join"]),"line-miter-limit":new St($t.layout_line["line-miter-limit"]),"line-round-limit":new St($t.layout_line["line-round-limit"]),"line-sort-key":new Lt($t.layout_line["line-sort-key"])});var u0={paint:new ki({"line-opacity":new Lt($t.paint_line["line-opacity"]),"line-color":new Lt($t.paint_line["line-color"]),"line-translate":new St($t.paint_line["line-translate"]),"line-translate-anchor":new St($t.paint_line["line-translate-anchor"]),"line-width":new Lt($t.paint_line["line-width"]),"line-gap-width":new Lt($t.paint_line["line-gap-width"]),"line-offset":new Lt($t.paint_line["line-offset"]),"line-blur":new Lt($t.paint_line["line-blur"]),"line-dasharray":new Lt($t.paint_line["line-dasharray"]),"line-pattern":new Lt($t.paint_line["line-pattern"]),"line-gradient":new Ti($t.paint_line["line-gradient"]),"line-trim-offset":new St($t.paint_line["line-trim-offset"])}),layout:h0};const d0=new class extends Lt{possiblyEvaluate(s,r){return r=new Ct(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,transition:r.transition}),super.possiblyEvaluate(s,r)}evaluate(s,r,a,h){return r=S({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(s,r,a,h)}}(u0.paint.properties["line-width"].specification);function Es(s,r){return r>0?r+2*s:s}d0.useIntegerZoom=!0;const m_=Ci([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),p0=Ci([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),g_=Ci([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ci([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Ms=Ci([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Cp=Ci([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ci([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const _m=Ci([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Yw=Ci([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ci([{name:"triangle",components:3,type:"Uint16"}]),Ci([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ci([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ci([{type:"Float32",name:"offsetX"}]),Ci([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);const cl=128;function __(s,r){const{expression:a}=r;if("constant"===a.kind)return{kind:"constant",layoutSize:a.evaluate(new Ct(s+1))};if("source"===a.kind)return{kind:"source"};{const{zoomStops:h,interpolationType:p}=a;let g=0;for(;g<h.length&&h[g]<=s;)g++;g=Math.max(0,g-1);let v=g;for(;v<h.length&&h[v]<s+1;)v++;v=Math.min(h.length-1,v);const b=h[g],E=h[v];return"composite"===a.kind?{kind:"composite",minZoom:b,maxZoom:E,interpolationType:p}:{kind:"camera",minZoom:b,maxZoom:E,minSize:a.evaluate(new Ct(b)),maxSize:a.evaluate(new Ct(E)),interpolationType:p}}}function Ep(s,{uSize:r,uSizeT:a},{lowerSize:h,upperSize:p}){return"source"===s.kind?h/cl:"composite"===s.kind?ci(h/cl,p/cl,a):r}function hd(s,r){let a=0,h=0;if("constant"===s.kind)h=s.layoutSize;else if("source"!==s.kind){const{interpolationType:p,minZoom:g,maxZoom:v}=s,b=p?D(Js.interpolationFactor(p,r,g,v),0,1):0;"camera"===s.kind?h=ci(s.minSize,s.maxSize,b):a=b}return{uSizeT:a,uSize:h}}var f0=Object.freeze({__proto__:null,getSizeData:__,evaluateSizeForFeature:Ep,evaluateSizeForZoom:hd,SIZE_PACK_FACTOR:cl});function Zw(s,r,a){return s.sections.forEach(h=>{h.text=function(p,g,v){const b=g.layout.get("text-transform").evaluate(v,{});return"uppercase"===b?p=p.toLocaleUpperCase():"lowercase"===b&&(p=p.toLocaleLowerCase()),kt.applyArabicShaping&&(p=kt.applyArabicShaping(p)),p}(h.text,r,a)}),s}const Mp={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function Kw(s){return"\ufe36"===s||"\ufe48"===s||"\ufe38"===s||"\ufe44"===s||"\ufe42"===s||"\ufe3e"===s||"\ufe3c"===s||"\ufe3a"===s||"\ufe18"===s||"\ufe40"===s||"\ufe10"===s||"\ufe13"===s||"\ufe14"===s||"\uff40"===s||"\uffe3"===s||"\ufe11"===s||"\ufe12"===s}function Qw(s){return"\ufe35"===s||"\ufe47"===s||"\ufe37"===s||"\ufe43"===s||"\ufe41"===s||"\ufe3d"===s||"\ufe3b"===s||"\ufe39"===s||"\ufe17"===s||"\ufe3f"===s}var Sp=gr,Yh=function(s,r,a,h,p){var g,v,b=8*p-h-1,E=(1<<b)-1,k=E>>1,X=-7,se=a?p-1:0,he=a?-1:1,_e=s[r+se];for(se+=he,g=_e&(1<<-X)-1,_e>>=-X,X+=b;X>0;g=256*g+s[r+se],se+=he,X-=8);for(v=g&(1<<-X)-1,g>>=-X,X+=h;X>0;v=256*v+s[r+se],se+=he,X-=8);if(0===g)g=1-k;else{if(g===E)return v?NaN:1/0*(_e?-1:1);v+=Math.pow(2,h),g-=k}return(_e?-1:1)*v*Math.pow(2,g-h)},Gl=function(s,r,a,h,p,g){var v,b,E,k=8*g-p-1,X=(1<<k)-1,se=X>>1,he=23===p?Math.pow(2,-24)-Math.pow(2,-77):0,_e=h?0:g-1,Ee=h?1:-1,Oe=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(b=isNaN(r)?1:0,v=X):(v=Math.floor(Math.log(r)/Math.LN2),r*(E=Math.pow(2,-v))<1&&(v--,E*=2),(r+=v+se>=1?he/E:he*Math.pow(2,1-se))*E>=2&&(v++,E/=2),v+se>=X?(b=0,v=X):v+se>=1?(b=(r*E-1)*Math.pow(2,p),v+=se):(b=r*Math.pow(2,se-1)*Math.pow(2,p),v=0));p>=8;s[a+_e]=255&b,_e+=Ee,b/=256,p-=8);for(v=v<<p|b,k+=p;k>0;s[a+_e]=255&v,_e+=Ee,v/=256,k-=8);s[a+_e-Ee]|=128*Oe};function gr(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}gr.Varint=0,gr.Fixed64=1,gr.Bytes=2,gr.Fixed32=5;var y_=4294967296,Jw=1/y_,e1=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function $l(s){return s.type===gr.Bytes?s.readVarint()+s.pos:s.pos+1}function zs(s,r,a){var h=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));a.realloc(h);for(var p=a.pos-1;p>=s;p--)a.buf[p+h]=a.buf[p]}function v_(s,r){for(var a=0;a<s.length;a++)r.writeVarint(s[a])}function x_(s,r){for(var a=0;a<s.length;a++)r.writeSVarint(s[a])}function t1(s,r){for(var a=0;a<s.length;a++)r.writeFloat(s[a])}function m0(s,r){for(var a=0;a<s.length;a++)r.writeDouble(s[a])}function n1(s,r){for(var a=0;a<s.length;a++)r.writeBoolean(s[a])}function Dp(s,r){for(var a=0;a<s.length;a++)r.writeFixed32(s[a])}function r1(s,r){for(var a=0;a<s.length;a++)r.writeSFixed32(s[a])}function o1(s,r){for(var a=0;a<s.length;a++)r.writeFixed64(s[a])}function b_(s,r){for(var a=0;a<s.length;a++)r.writeSFixed64(s[a])}function ud(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+16777216*s[r+3]}function Zh(s,r,a){s[a]=r,s[a+1]=r>>>8,s[a+2]=r>>>16,s[a+3]=r>>>24}function s1(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+(s[r+3]<<24)}function dd(s,r,a){r.glyphs=[],1===s&&a.readMessage(w_,r)}function w_(s,r,a){if(3===s){const{id:h,bitmap:p,width:g,height:v,left:b,top:E,advance:k}=a.readMessage(g0,{});r.glyphs.push({id:h,bitmap:new bc({width:g+6,height:v+6},p),metrics:{width:g,height:v,left:b,top:E,advance:k}})}else 4===s?r.ascender=a.readSVarint():5===s&&(r.descender=a.readSVarint())}function g0(s,r,a){1===s?r.id=a.readVarint():2===s?r.bitmap=a.readBytes():3===s?r.width=a.readVarint():4===s?r.height=a.readVarint():5===s?r.left=a.readSVarint():6===s?r.top=a.readSVarint():7===s&&(r.advance=a.readVarint())}function C_(s){let r=0,a=0;for(const v of s)r+=v.w*v.h,a=Math.max(a,v.w);s.sort((v,b)=>b.h-v.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),a),h:1/0}];let p=0,g=0;for(const v of s)for(let b=h.length-1;b>=0;b--){const E=h[b];if(!(v.w>E.w||v.h>E.h)){if(v.x=E.x,v.y=E.y,g=Math.max(g,v.y+v.h),p=Math.max(p,v.x+v.w),v.w===E.w&&v.h===E.h){const k=h.pop();b<h.length&&(h[b]=k)}else v.h===E.h?(E.x+=v.w,E.w-=v.w):v.w===E.w?(E.y+=v.h,E.h-=v.h):(h.push({x:E.x+v.w,y:E.y,w:E.w-v.w,h:v.h}),E.y+=v.h,E.h-=v.h);break}}return{w:p,h:g,fill:r/(p*g)||0}}gr.prototype={destroy:function(){this.buf=null},readFields:function(s,r,a){for(a=a||this.length;this.pos<a;){var h=this.readVarint(),p=h>>3,g=this.pos;this.type=7&h,s(p,r,this),this.pos===g&&this.skip(h)}return r},readMessage:function(s,r){return this.readFields(s,r,this.readVarint()+this.pos)},readFixed32:function(){var s=ud(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=s1(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=ud(this.buf,this.pos)+ud(this.buf,this.pos+4)*y_;return this.pos+=8,s},readSFixed64:function(){var s=ud(this.buf,this.pos)+s1(this.buf,this.pos+4)*y_;return this.pos+=8,s},readFloat:function(){var s=Yh(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=Yh(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var r,a,h=this.buf;return r=127&(a=h[this.pos++]),a<128?r:(r|=(127&(a=h[this.pos++]))<<7,a<128?r:(r|=(127&(a=h[this.pos++]))<<14,a<128?r:(r|=(127&(a=h[this.pos++]))<<21,a<128?r:function(p,g,v){var b,E,k=v.buf;if(b=(112&(E=k[v.pos++]))>>4,E<128||(b|=(127&(E=k[v.pos++]))<<3,E<128)||(b|=(127&(E=k[v.pos++]))<<10,E<128)||(b|=(127&(E=k[v.pos++]))<<17,E<128)||(b|=(127&(E=k[v.pos++]))<<24,E<128)||(b|=(1&(E=k[v.pos++]))<<31,E<128))return function Tp(s,r,a){return a?4294967296*r+(s>>>0):4294967296*(r>>>0)+(s>>>0)}(p,b,g);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(a=h[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var s=this.readVarint()+this.pos,r=this.pos;return this.pos=s,s-r>=12&&e1?e1.decode(this.buf.subarray(r,s)):function(a,h,p){for(var g="",v=h;v<p;){var b,E,k,X=a[v],se=null,he=X>239?4:X>223?3:X>191?2:1;if(v+he>p)break;1===he?X<128&&(se=X):2===he?128==(192&(b=a[v+1]))&&(se=(31&X)<<6|63&b)<=127&&(se=null):3===he?(E=a[v+2],128==(192&(b=a[v+1]))&&128==(192&E)&&((se=(15&X)<<12|(63&b)<<6|63&E)<=2047||se>=55296&&se<=57343)&&(se=null)):4===he&&(E=a[v+2],k=a[v+3],128==(192&(b=a[v+1]))&&128==(192&E)&&128==(192&k)&&((se=(15&X)<<18|(63&b)<<12|(63&E)<<6|63&k)<=65535||se>=1114112)&&(se=null)),null===se?(se=65533,he=1):se>65535&&(se-=65536,g+=String.fromCharCode(se>>>10&1023|55296),se=56320|1023&se),g+=String.fromCharCode(se),v+=he}return g}(this.buf,r,s)},readBytes:function(){var s=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,s);return this.pos=s,r},readPackedVarint:function(s,r){if(this.type!==gr.Bytes)return s.push(this.readVarint(r));var a=$l(this);for(s=s||[];this.pos<a;)s.push(this.readVarint(r));return s},readPackedSVarint:function(s){if(this.type!==gr.Bytes)return s.push(this.readSVarint());var r=$l(this);for(s=s||[];this.pos<r;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==gr.Bytes)return s.push(this.readBoolean());var r=$l(this);for(s=s||[];this.pos<r;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==gr.Bytes)return s.push(this.readFloat());var r=$l(this);for(s=s||[];this.pos<r;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==gr.Bytes)return s.push(this.readDouble());var r=$l(this);for(s=s||[];this.pos<r;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==gr.Bytes)return s.push(this.readFixed32());var r=$l(this);for(s=s||[];this.pos<r;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==gr.Bytes)return s.push(this.readSFixed32());var r=$l(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==gr.Bytes)return s.push(this.readFixed64());var r=$l(this);for(s=s||[];this.pos<r;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==gr.Bytes)return s.push(this.readSFixed64());var r=$l(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed64());return s},skip:function(s){var r=7&s;if(r===gr.Varint)for(;this.buf[this.pos++]>127;);else if(r===gr.Bytes)this.pos=this.readVarint()+this.pos;else if(r===gr.Fixed32)this.pos+=4;else{if(r!==gr.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(s,r){this.writeVarint(s<<3|r)},realloc:function(s){for(var r=this.length||16;r<this.pos+s;)r*=2;if(r!==this.length){var a=new Uint8Array(r);a.set(this.buf),this.buf=a,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),Zh(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),Zh(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),Zh(this.buf,-1&s,this.pos),Zh(this.buf,Math.floor(s*Jw),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),Zh(this.buf,-1&s,this.pos),Zh(this.buf,Math.floor(s*Jw),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(r,a){var h,p,g,b;if(r>=0?(h=r%4294967296|0,p=r/4294967296|0):(p=~(-r/4294967296),4294967295^(h=~(-r%4294967296))?h=h+1|0:(h=0,p=p+1|0)),r>=0x10000000000000000||r<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),g=h,(b=a).buf[b.pos++]=127&g|128,g>>>=7,b.buf[b.pos++]=127&g|128,g>>>=7,b.buf[b.pos++]=127&g|128,g>>>=7,b.buf[b.pos++]=127&g|128,b.buf[b.pos]=127&(g>>>=7),function(g,v){var b=(7&g)<<4;v.buf[v.pos++]|=b|((g>>>=3)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g)))))}(p,a)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(Boolean(s))},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var r=this.pos;this.pos=function(h,p,g){for(var v,b,E=0;E<p.length;E++){if((v=p.charCodeAt(E))>55295&&v<57344){if(!b){v>56319||E+1===p.length?(h[g++]=239,h[g++]=191,h[g++]=189):b=v;continue}if(v<56320){h[g++]=239,h[g++]=191,h[g++]=189,b=v;continue}v=b-55296<<10|v-56320|65536,b=null}else b&&(h[g++]=239,h[g++]=191,h[g++]=189,b=null);v<128?h[g++]=v:(v<2048?h[g++]=v>>6|192:(v<65536?h[g++]=v>>12|224:(h[g++]=v>>18|240,h[g++]=v>>12&63|128),h[g++]=v>>6&63|128),h[g++]=63&v|128)}return g}(this.buf,s,this.pos);var a=this.pos-r;a>=128&&zs(r,a,this),this.pos=r-1,this.writeVarint(a),this.pos+=a},writeFloat:function(s){this.realloc(4),Gl(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),Gl(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var r=s.length;this.writeVarint(r),this.realloc(r);for(var a=0;a<r;a++)this.buf[this.pos++]=s[a]},writeRawMessage:function(s,r){this.pos++;var a=this.pos;s(r,this);var h=this.pos-a;h>=128&&zs(a,h,this),this.pos=a-1,this.writeVarint(h),this.pos+=h},writeMessage:function(s,r,a){this.writeTag(s,gr.Bytes),this.writeRawMessage(r,a)},writePackedVarint:function(s,r){r.length&&this.writeMessage(s,v_,r)},writePackedSVarint:function(s,r){r.length&&this.writeMessage(s,x_,r)},writePackedBoolean:function(s,r){r.length&&this.writeMessage(s,n1,r)},writePackedFloat:function(s,r){r.length&&this.writeMessage(s,t1,r)},writePackedDouble:function(s,r){r.length&&this.writeMessage(s,m0,r)},writePackedFixed32:function(s,r){r.length&&this.writeMessage(s,Dp,r)},writePackedSFixed32:function(s,r){r.length&&this.writeMessage(s,r1,r)},writePackedFixed64:function(s,r){r.length&&this.writeMessage(s,o1,r)},writePackedSFixed64:function(s,r){r.length&&this.writeMessage(s,b_,r)},writeBytesField:function(s,r){this.writeTag(s,gr.Bytes),this.writeBytes(r)},writeFixed32Field:function(s,r){this.writeTag(s,gr.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(s,r){this.writeTag(s,gr.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(s,r){this.writeTag(s,gr.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(s,r){this.writeTag(s,gr.Fixed64),this.writeSFixed64(r)},writeVarintField:function(s,r){this.writeTag(s,gr.Varint),this.writeVarint(r)},writeSVarintField:function(s,r){this.writeTag(s,gr.Varint),this.writeSVarint(r)},writeStringField:function(s,r){this.writeTag(s,gr.Bytes),this.writeString(r)},writeFloatField:function(s,r){this.writeTag(s,gr.Fixed32),this.writeFloat(r)},writeDoubleField:function(s,r){this.writeTag(s,gr.Fixed64),this.writeDouble(r)},writeBooleanField:function(s,r){this.writeVarintField(s,Boolean(r))}};class Ap{constructor(r,{pixelRatio:a,version:h,stretchX:p,stretchY:g,content:v}){this.paddedRect=r,this.pixelRatio=a,this.stretchX=p,this.stretchY=g,this.content=v,this.version=h}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class _0{constructor(r,a){const h={},p={};this.haveRenderCallbacks=[];const g=[];this.addImages(r,h,g),this.addImages(a,p,g);const{w:v,h:b}=C_(g),E=new oa({width:v||1,height:b||1});for(const k in r){const X=r[k],se=h[k].paddedRect;oa.copy(X.data,E,{x:0,y:0},{x:se.x+1,y:se.y+1},X.data)}for(const k in a){const X=a[k],se=p[k].paddedRect,he=se.x+1,_e=se.y+1,Ee=X.data.width,Oe=X.data.height;oa.copy(X.data,E,{x:0,y:0},{x:he,y:_e},X.data),oa.copy(X.data,E,{x:0,y:Oe-1},{x:he,y:_e-1},{width:Ee,height:1}),oa.copy(X.data,E,{x:0,y:0},{x:he,y:_e+Oe},{width:Ee,height:1}),oa.copy(X.data,E,{x:Ee-1,y:0},{x:he-1,y:_e},{width:1,height:Oe}),oa.copy(X.data,E,{x:0,y:0},{x:he+Ee,y:_e},{width:1,height:Oe})}this.image=E,this.iconPositions=h,this.patternPositions=p}addImages(r,a,h){for(const p in r){const g=r[p],v={x:0,y:0,w:g.data.width+2,h:g.data.height+2};h.push(v),a[p]=new Ap(v,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(r,a){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(h=>r.hasImage(h)),r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in r.updatedImages)this.patchUpdatedImage(this.iconPositions[h],r.getImage(h),a),this.patchUpdatedImage(this.patternPositions[h],r.getImage(h),a)}patchUpdatedImage(r,a,h){if(!r||!a||r.version===a.version)return;r.version=a.version;const[p,g]=r.tl;h.update(a.data,void 0,{x:p,y:g})}}Ei(Ap,"ImagePosition"),Ei(_0,"ImageAtlas");const wa={horizontal:1,vertical:2,horizontalOnly:3};class kp{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,a){const h=new kp;return h.scale=r||1,h.fontStack=a,h}static forImage(r){const a=new kp;return a.imageName=r,a}}class pd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,a){const h=new pd;for(let p=0;p<r.sections.length;p++){const g=r.sections[p];g.image?h.addImageSection(g):h.addTextSection(g,a)}return h}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSections(){return this.sections}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(r){this.text=function(a,h){let p="";for(let g=0;g<a.length;g++){const v=a.charCodeAt(g+1)||null,b=a.charCodeAt(g-1)||null;p+=!h&&(v&&pe(v)&&!Mp[a[g+1]]||b&&pe(b)&&!Mp[a[g-1]])||!Mp[a[g]]?a[g]:Mp[a[g]]}return p}(this.text,r)}trim(){let r=0;for(let h=0;h<this.text.length&&ym[this.text.charCodeAt(h)];h++)r++;let a=this.text.length;for(let h=this.text.length-1;h>=0&&h>=r&&ym[this.text.charCodeAt(h)];h--)a--;this.text=this.text.substring(r,a),this.sectionIndex=this.sectionIndex.slice(r,a)}substring(r,a){const h=new pd;return h.text=this.text.substring(r,a),h.sectionIndex=this.sectionIndex.slice(r,a),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,a)=>Math.max(r,this.sections[a].scale),0)}addTextSection(r,a){this.text+=r.text,this.sections.push(kp.forText(r.scale,r.fontStack||a));const h=this.sections.length-1;for(let p=0;p<r.text.length;++p)this.sectionIndex.push(h)}addImageSection(r){const a=r.image?r.image.name:"";if(0===a.length)return void De("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(kp.forImage(a)),this.sectionIndex.push(this.sections.length-1)):De("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function E_(s,r,a,h,p,g,v,b,E,k,X,se,he,_e,Ee){const Oe=pd.fromFeature(s,p);se===wa.vertical&&Oe.verticalizePunctuation(he);let Ve=[];const tt=function(ut,Ot,It,Wt,ii,Bt){if(!ut)return[];const Xt=[],Qt=function(di,ji,bi,Si,yi,qi){let kn=0;for(let _n=0;_n<di.length();_n++){const wn=di.getSection(_n);kn+=vm(di.getCharCode(_n),wn,Si,yi,ji,qi)}return kn/Math.max(1,Math.ceil(kn/bi))}(ut,Ot,It,Wt,ii,Bt),Jt=ut.text.indexOf("\u200b")>=0;let oi=0;for(let di=0;di<ut.length();di++){const ji=ut.getSection(di),bi=ut.getCharCode(di);if(ym[bi]||(oi+=vm(bi,ji,Wt,ii,Ot,Bt)),di<ut.length()-1){const Si=!((Vt=bi)<11904||!(Wu(Vt)||Nf(Vt)||d(Vt)||ia(Vt)||lp(Vt)||rp(Vt)||Xu(Vt)||Rl(Vt)||cp(Vt)||Vh(Vt)||ap(Vt)||C(Vt)||Hc(Vt)||zh(Vt)||op(Vt)||sp(Vt)||Gc(Vt)||l(Vt)||zf(Vt)||Bf(Vt)));(y0[bi]||Si||ji.imageName)&&Xt.push(v0(di+1,oi,Qt,Xt,S_(bi,ut.getCharCode(di+1),Si&&Jt),!1))}}var Vt;return x0(v0(ut.length(),oi,Qt,Xt,0,!0))}(Oe,k,g,r,h,_e),{processBidirectionalText:ht,processStyledBidirectionalText:et}=kt;if(ht&&1===Oe.sections.length){const ut=ht(Oe.toString(),tt);for(const Ot of ut){const It=new pd;It.text=Ot,It.sections=Oe.sections;for(let Wt=0;Wt<Ot.length;Wt++)It.sectionIndex.push(0);Ve.push(It)}}else if(et){const ut=et(Oe.text,Oe.sectionIndex,tt);for(const Ot of ut){const It=new pd;It.text=Ot[0],It.sectionIndex=Ot[1],It.sections=Oe.sections,Ve.push(It)}}else Ve=function(ut,Ot){const It=[],Wt=ut.text;let ii=0;for(const Bt of Ot)It.push(ut.substring(ii,Bt)),ii=Bt;return ii<Wt.length&&It.push(ut.substring(ii,Wt.length)),It}(Oe,tt);const st=[],dt={positionedLines:st,text:Oe.toString(),top:X[1],bottom:X[1],left:X[0],right:X[0],writingMode:se,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ut,Ot,It,Wt,ii,Bt,Xt,Qt,Jt,oi,Vt,di){let ji=0,bi=0,Si=0;const yi="right"===Qt?1:"left"===Qt?0:.5;let qi=!1;for(const rn of ii){const Cn=rn.getSections();for(const Qn of Cn){if(Qn.imageName)continue;const Bn=Ot[Qn.fontStack];if(Bn&&(qi=void 0!==Bn.ascender&&void 0!==Bn.descender,!qi))break}if(!qi)break}let kn=0;for(const rn of ii){rn.trim();const Cn=rn.getMaxScale(),Qn=24*(Cn-1),Bn={positionedGlyphs:[],lineOffset:0};ut.positionedLines[kn]=Bn;const rr=Bn.positionedGlyphs;let ur=0;if(!rn.length()){bi+=Bt,++kn;continue}let dr=0,Br=0;for(let Jn=0;Jn<rn.length();Jn++){const oo=rn.getSection(Jn),Zr=rn.getSectionIndex(Jn),In=rn.getCharCode(Jn);let Rr=oo.scale,bo=null,pr=null,Kr=null,us=24,Fo=0;const No=!(Jt===wa.horizontal||!Vt&&!fe(In)||Vt&&(ym[In]||(_n=In,ga(_n)||Ff(_n)||$u(_n)||m(_n)||x(_n))));if(oo.imageName){const Ts=Wt[oo.imageName];if(!Ts)continue;Kr=oo.imageName,ut.iconsInText=ut.iconsInText||!0,pr=Ts.paddedRect;const wo=Ts.displaySize;Rr=24*Rr/di,bo={width:wo[0],height:wo[1],left:1,top:-3,advance:No?wo[1]:wo[0],localGlyph:!1},Fo=qi?-bo.height*Rr:24*Cn-17-wo[1]*Rr,us=bo.advance;const en=(No?wo[0]:wo[1])*Rr-24*Cn;en>0&&en>ur&&(ur=en)}else{const Ts=It[oo.fontStack];if(!Ts)continue;Ts[In]&&(pr=Ts[In]);const wo=Ot[oo.fontStack];if(!wo)continue;const en=wo.glyphs[In];if(!en)continue;if(bo=en.metrics,us=8203!==In?24:0,qi){const Md=void 0!==wo.ascender?Math.abs(wo.ascender):0,su=void 0!==wo.descender?Math.abs(wo.descender):0,Yp=(Md+su)*Rr;dr<Yp&&(dr=Yp,Br=(Md-su)/2*Rr),Fo=-Md*Rr}else Fo=24*(Cn-Rr)-17}No?(ut.verticalizable=!0,rr.push({glyph:In,imageName:Kr,x:ji,y:bi+Fo,vertical:No,scale:Rr,localGlyph:bo.localGlyph,fontStack:oo.fontStack,sectionIndex:Zr,metrics:bo,rect:pr}),ji+=us*Rr+oi):(rr.push({glyph:In,imageName:Kr,x:ji,y:bi+Fo,vertical:No,scale:Rr,localGlyph:bo.localGlyph,fontStack:oo.fontStack,sectionIndex:Zr,metrics:bo,rect:pr}),ji+=bo.advance*Rr+oi)}0!==rr.length&&(Si=Math.max(ji-oi,Si),qi?T_(rr,yi,ur,Br,Bt*Cn/2):T_(rr,yi,ur,0,Bt/2)),ji=0;const fo=Bt*Cn+ur;Bn.lineOffset=Math.max(ur,Qn),bi+=fo,++kn}var _n;const wn=bi,{horizontalAlign:Wi,verticalAlign:Kn}=xm(Xt);(function(rn,Cn,Qn,Bn,rr,ur){const dr=(Cn-Qn)*rr,Br=-ur*Bn;for(const fo of rn)for(const Jn of fo.positionedGlyphs)Jn.x+=dr,Jn.y+=Br})(ut.positionedLines,yi,Wi,Kn,Si,wn),ut.top+=-Kn*wn,ut.bottom=ut.top+wn,ut.left+=-Wi*Si,ut.right=ut.left+Si,ut.hasBaseline=qi}(dt,r,a,h,Ve,v,b,E,se,k,he,Ee),!function(ut){for(const Ot of ut)if(0!==Ot.positionedGlyphs.length)return!1;return!0}(st)&&dt}const ym={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},y0={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function vm(s,r,a,h,p,g){if(r.imageName){const v=h[r.imageName];return v?v.displaySize[0]*r.scale*24/g+p:0}{const v=a[r.fontStack],b=v&&v.glyphs[s];return b?b.metrics.advance*r.scale+p:0}}function M_(s,r,a,h){const p=Math.pow(s-r,2);return h?s<r?p/2:2*p:p+Math.abs(a)*a}function S_(s,r,a){let h=0;return 10===s&&(h-=1e4),a&&(h+=150),40!==s&&65288!==s||(h+=50),41!==r&&65289!==r||(h+=50),h}function v0(s,r,a,h,p,g){let v=null,b=M_(r,a,p,g);for(const E of h){const k=M_(r-E.x,a,p,g)+E.badness;k<=b&&(v=E,b=k)}return{index:s,x:r,priorBreak:v,badness:b}}function x0(s){return s?x0(s.priorBreak).concat(s.index):[]}function xm(s){let r=.5,a=.5;switch(s){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:r,verticalAlign:a}}function T_(s,r,a,h,p){if(!(r||a||h||p))return;const g=s.length-1,v=s[g],b=(v.x+v.metrics.advance*v.scale)*r;for(let E=0;E<=g;E++)s[E].x-=b,s[E].y+=a+h+p}function Kh(s,r,a){const{horizontalAlign:h,verticalAlign:p}=xm(a),g=r[0]-s.displaySize[0]*h,v=r[1]-s.displaySize[1]*p;return{image:s,top:v,bottom:v+s.displaySize[1],left:g,right:g+s.displaySize[0]}}function D_(s,r,a,h,p,g){const v=s.image;let b;if(v.content){const Ve=v.content,tt=v.pixelRatio||1;b=[Ve[0]/tt,Ve[1]/tt,v.displaySize[0]-Ve[2]/tt,v.displaySize[1]-Ve[3]/tt]}const E=r.left*g,k=r.right*g;let X,se,he,_e;"width"===a||"both"===a?(_e=p[0]+E-h[3],se=p[0]+k+h[1]):(_e=p[0]+(E+k-v.displaySize[0])/2,se=_e+v.displaySize[0]);const Ee=r.top*g,Oe=r.bottom*g;return"height"===a||"both"===a?(X=p[1]+Ee-h[0],he=p[1]+Oe+h[2]):(X=p[1]+(Ee+Oe-v.displaySize[1])/2,he=X+v.displaySize[1]),{image:v,top:X,right:se,bottom:he,left:_e,collisionPadding:b}}class Wl extends I{constructor(r,a,h,p,g){super(r,a),this.angle=p,this.z=h,void 0!==g&&(this.segment=g)}clone(){return new Wl(this.x,this.y,this.z,this.angle,this.segment)}}function b0(s,r,a,h,p){if(void 0===r.segment)return!0;let g=r,v=r.segment+1,b=0;for(;b>-a/2;){if(v--,v<0)return!1;b-=s[v].dist(g),g=s[v]}b+=s[v].dist(s[v+1]),v++;const E=[];let k=0;for(;b<a/2;){const X=s[v],se=s[v+1];if(!se)return!1;let he=s[v-1].angleTo(X)-X.angleTo(se);for(he=Math.abs((he+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:b,angleDelta:he}),k+=he;b-E[0].distance>h;)k-=E.shift().angleDelta;if(k>p)return!1;v++,b+=X.dist(se)}return!0}function a1(s){let r=0;for(let a=0;a<s.length-1;a++)r+=s[a].dist(s[a+1]);return r}function Ip(s,r,a){return s?.6*r*a:0}function w0(s,r){return Math.max(s?s.right-s.left:0,r?r.right-r.left:0)}function C0(s,r,a,h,p,g){const v=Ip(a,p,g),b=w0(a,h)*g;let E=0;const k=a1(s)/2;for(let X=0;X<s.length-1;X++){const se=s[X],he=s[X+1],_e=se.dist(he);if(E+_e>k){const Ee=(k-E)/_e,Oe=ci(se.x,he.x,Ee),Ve=ci(se.y,he.y,Ee),tt=new Wl(Oe,Ve,0,he.angleTo(se),X);return!v||b0(s,tt,b,v,r)?tt:void 0}E+=_e}}function E0(s,r,a,h,p,g,v,b,E){const k=Ip(h,g,v),X=w0(h,p),se=X*v,he=0===s[0].x||s[0].x===E||0===s[0].y||s[0].y===E;return r-se<r/4&&(r=se+r/4),A_(s,he?r/2*b%r:(X/2+2*g)*v*b%r,r,k,a,se,he,!1,E)}function A_(s,r,a,h,p,g,v,b,E){const k=g/2,X=a1(s);let se=0,he=r-a,_e=[];for(let Ee=0;Ee<s.length-1;Ee++){const Oe=s[Ee],Ve=s[Ee+1],tt=Oe.dist(Ve),ht=Ve.angleTo(Oe);for(;he+a<se+tt;){he+=a;const et=(he-se)/tt,st=ci(Oe.x,Ve.x,et),dt=ci(Oe.y,Ve.y,et);if(st>=0&&st<E&&dt>=0&&dt<E&&he-k>=0&&he+k<=X){const ut=new Wl(st,dt,0,ht,Ee);ut._round(),h&&!b0(s,ut,g,h,p)||_e.push(ut)}}se+=tt}return b||_e.length||v||(_e=A_(s,se/2,a,h,p,g,v,!0,E)),_e}function bm(s,r,a,h,p){const g=[];for(let v=0;v<s.length;v++){const b=s[v];let E;for(let k=0;k<b.length-1;k++){let X=b[k],se=b[k+1];X.x<r&&se.x<r||(X.x<r?X=new I(r,X.y+(r-X.x)/(se.x-X.x)*(se.y-X.y))._round():se.x<r&&(se=new I(r,X.y+(r-X.x)/(se.x-X.x)*(se.y-X.y))._round()),X.y<a&&se.y<a||(X.y<a?X=new I(X.x+(a-X.y)/(se.y-X.y)*(se.x-X.x),a)._round():se.y<a&&(se=new I(X.x+(a-X.y)/(se.y-X.y)*(se.x-X.x),a)._round()),X.x>=h&&se.x>=h||(X.x>=h?X=new I(h,X.y+(h-X.x)/(se.x-X.x)*(se.y-X.y))._round():se.x>=h&&(se=new I(h,X.y+(h-X.x)/(se.x-X.x)*(se.y-X.y))._round()),X.y>=p&&se.y>=p||(X.y>=p?X=new I(X.x+(p-X.y)/(se.y-X.y)*(se.x-X.x),p)._round():se.y>=p&&(se=new I(X.x+(p-X.y)/(se.y-X.y)*(se.x-X.x),p)._round()),E&&X.equals(E[E.length-1])||(E=[X],g.push(E)),E.push(se)))))}}return g}Ei(Wl,"Anchor");const fd=1e20;function Pp(s,r,a,h,p,g,v,b,E){for(let k=r;k<r+h;k++)Op(s,a*g+k,g,p,v,b,E);for(let k=a;k<a+p;k++)Op(s,k*g+r,1,h,v,b,E)}function Op(s,r,a,h,p,g,v){g[0]=0,v[0]=-fd,v[1]=fd,p[0]=s[r];for(let b=1,E=0,k=0;b<h;b++){p[b]=s[r+b*a];const X=b*b;do{const se=g[E];k=(p[b]-p[se]+X-se*se)/(b-se)/2}while(k<=v[E]&&--E>-1);E++,g[E]=b,v[E]=k,v[E+1]=fd}for(let b=0,E=0;b<h;b++){for(;v[E+1]<b;)E++;const k=g[E],X=b-k;s[r+b*a]=p[k]+X*X}}const wm={none:0,ideographs:1,all:2};class nh{constructor(r,a,h){this.requestManager=r,this.localGlyphMode=a,this.localFontFamily=h,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(r){this.url=r}getGlyphs(r,a){const h=[];for(const p in r)for(const g of r[p])h.push({stack:p,id:g});U(h,({stack:p,id:g},v)=>{let b=this.entries[p];b||(b=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=b.glyphs[g];if(void 0!==E)return void v(null,{stack:p,id:g,glyph:E});if(E=this._tinySDF(b,p,g),E)return b.glyphs[g]=E,void v(null,{stack:p,id:g,glyph:E});const k=Math.floor(g/256);if(256*k>65535)return void v(new Error("glyphs > 65535 not supported"));if(b.ranges[k])return void v(null,{stack:p,id:g,glyph:E});let X=b.requests[k];X||(X=b.requests[k]=[],nh.loadGlyphRange(p,k,this.url,this.requestManager,(se,he)=>{if(he){b.ascender=he.ascender,b.descender=he.descender;for(const _e in he.glyphs)this._doesCharSupportLocalGlyph(+_e)||(b.glyphs[+_e]=he.glyphs[+_e]);b.ranges[k]=!0}for(const _e of X)_e(se,he);delete b.requests[k]})),X.push((se,he)=>{se?v(se):he&&v(null,{stack:p,id:g,glyph:he.glyphs[g]||null})})},(p,g)=>{if(p)a(p);else if(g){const v={};for(const{stack:b,id:E,glyph:k}of g)void 0===v[b]&&(v[b]={}),void 0===v[b].glyphs&&(v[b].glyphs={}),v[b].glyphs[E]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics},v[b].ascender=this.entries[b].ascender,v[b].descender=this.entries[b].descender;a(null,v)}})}_doesCharSupportLocalGlyph(r){return this.localGlyphMode!==wm.none&&(this.localGlyphMode===wm.all?!!this.localFontFamily:!!this.localFontFamily&&(Vh(r)||Po(r)||Hc(r)||Gc(r)||Rl(r)))}_tinySDF(r,a,h){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(h))return;let g=r.tinySDF;if(!g){let Oe="400";/bold/i.test(a)?Oe="900":/medium/i.test(a)?Oe="500":/light/i.test(a)&&(Oe="200"),g=r.tinySDF=new nh.TinySDF({fontFamily:p,fontWeight:Oe,fontSize:48,buffer:6,radius:16}),g.fontWeight=Oe}if(this.localGlyphs[g.fontWeight][h])return this.localGlyphs[g.fontWeight][h];const v=String.fromCharCode(h),{data:b,width:E,height:k,glyphWidth:X,glyphHeight:se,glyphLeft:he,glyphTop:_e,glyphAdvance:Ee}=g.draw(v);return this.localGlyphs[g.fontWeight][h]={id:h,bitmap:new bc({width:E,height:k},b),metrics:{width:X/2,height:se/2,left:he/2,top:_e/2-27,advance:Ee/2,localGlyph:!0}}}}function k_(s,r,a,h){const p=[],g=s.image,v=g.pixelRatio,b=g.paddedRect.w-2,E=g.paddedRect.h-2,k=s.right-s.left,X=s.bottom-s.top,se=g.stretchX||[[0,b]],he=g.stretchY||[[0,E]],_e=(Bt,Xt)=>Bt+Xt[1]-Xt[0],Ee=se.reduce(_e,0),Oe=he.reduce(_e,0),Ve=b-Ee,tt=E-Oe;let ht=0,et=Ee,st=0,dt=Oe,ut=0,Ot=Ve,It=0,Wt=tt;if(g.content&&h){const Bt=g.content;ht=md(se,0,Bt[0]),st=md(he,0,Bt[1]),et=md(se,Bt[0],Bt[2]),dt=md(he,Bt[1],Bt[3]),ut=Bt[0]-ht,It=Bt[1]-st,Ot=Bt[2]-Bt[0]-et,Wt=Bt[3]-Bt[1]-dt}const ii=(Bt,Xt,Qt,Jt)=>{const oi=Cm(Bt.stretch-ht,et,k,s.left),Vt=Rp(Bt.fixed-ut,Ot,Bt.stretch,Ee),di=Cm(Xt.stretch-st,dt,X,s.top),ji=Rp(Xt.fixed-It,Wt,Xt.stretch,Oe),bi=Cm(Qt.stretch-ht,et,k,s.left),Si=Rp(Qt.fixed-ut,Ot,Qt.stretch,Ee),yi=Cm(Jt.stretch-st,dt,X,s.top),qi=Rp(Jt.fixed-It,Wt,Jt.stretch,Oe),kn=new I(oi,di),_n=new I(bi,di),wn=new I(bi,yi),Wi=new I(oi,yi),Kn=new I(Vt/v,ji/v),rn=new I(Si/v,qi/v),Cn=r*Math.PI/180;if(Cn){const rr=Math.sin(Cn),ur=Math.cos(Cn),dr=[ur,-rr,rr,ur];kn._matMult(dr),_n._matMult(dr),Wi._matMult(dr),wn._matMult(dr)}const Qn=Bt.stretch+Bt.fixed,Bn=Xt.stretch+Xt.fixed;return{tl:kn,tr:_n,bl:Wi,br:wn,tex:{x:g.paddedRect.x+1+Qn,y:g.paddedRect.y+1+Bn,w:Qt.stretch+Qt.fixed-Qn,h:Jt.stretch+Jt.fixed-Bn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Kn,pixelOffsetBR:rn,minFontScaleX:Ot/v/k,minFontScaleY:Wt/v/X,isSDF:a}};if(h&&(g.stretchX||g.stretchY)){const Bt=gd(se,Ve,Ee),Xt=gd(he,tt,Oe);for(let Qt=0;Qt<Bt.length-1;Qt++){const Jt=Bt[Qt],oi=Bt[Qt+1];for(let Vt=0;Vt<Xt.length-1;Vt++)p.push(ii(Jt,Xt[Vt],oi,Xt[Vt+1]))}}else p.push(ii({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:E+1}));return p}function md(s,r,a){let h=0;for(const p of s)h+=Math.max(r,Math.min(a,p[1]))-Math.max(r,Math.min(a,p[0]));return h}function gd(s,r,a){const h=[{fixed:-1,stretch:0}];for(const[p,g]of s){const v=h[h.length-1];h.push({fixed:p-v.stretch,stretch:v.stretch}),h.push({fixed:p-v.stretch,stretch:v.stretch+(g-p)})}return h.push({fixed:r+1,stretch:a}),h}function Cm(s,r,a,h){return s/r*a+h}function Rp(s,r,a,h){return s-r*a/h}function l1(s,r,a,h){const p=r+s.positionedLines[h].lineOffset;return 0===h?a+p/2:a+(p+(r+s.positionedLines[h-1].lineOffset))/2}nh.loadGlyphRange=function(s,r,a,h,p){const g=256*r,v=g+255,b=h.transformRequest(h.normalizeGlyphsURL(a).replace("{fontstack}",s).replace("{range}",`${g}-${v}`),ct.Glyphs);vi(b,(E,k)=>{if(E)p(E);else if(k){const X={},se=new Sp(k).readFields(dd,{});for(const he of se.glyphs)X[he.id]=he;p(null,{glyphs:X,ascender:se.ascender,descender:se.descender})}})},nh.TinySDF=class{constructor({fontSize:s=24,buffer:r=3,radius:a=8,cutoff:h=.25,fontFamily:p="sans-serif",fontWeight:g="normal",fontStyle:v="normal"}={}){this.buffer=r,this.cutoff=h,this.radius=a;const b=this.size=s+4*r,E=this._createCanvas(b),k=this.ctx=E.getContext("2d",{willReadFrequently:!0});k.font=`${v} ${g} ${s}px ${p}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(s){const r=document.createElement("canvas");return r.width=r.height=s,r}draw(s){const{width:r,actualBoundingBoxAscent:a,actualBoundingBoxDescent:h,actualBoundingBoxLeft:p,actualBoundingBoxRight:g}=this.ctx.measureText(s),v=Math.ceil(a),b=Math.min(this.size-this.buffer,Math.ceil(g-p)),E=Math.min(this.size-this.buffer,v+Math.ceil(h)),k=b+2*this.buffer,X=E+2*this.buffer,se=Math.max(k*X,0),he=new Uint8ClampedArray(se),_e={data:he,width:k,height:X,glyphWidth:b,glyphHeight:E,glyphTop:v,glyphLeft:0,glyphAdvance:r};if(0===b||0===E)return _e;const{ctx:Ee,buffer:Oe,gridInner:Ve,gridOuter:tt}=this;Ee.clearRect(Oe,Oe,b,E),Ee.fillText(s,Oe,Oe+v);const ht=Ee.getImageData(Oe,Oe,b,E);tt.fill(fd,0,se),Ve.fill(0,0,se);for(let et=0;et<E;et++)for(let st=0;st<b;st++){const dt=ht.data[4*(et*b+st)+3]/255;if(0===dt)continue;const ut=(et+Oe)*k+st+Oe;if(1===dt)tt[ut]=0,Ve[ut]=fd;else{const Ot=.5-dt;tt[ut]=Ot>0?Ot*Ot:0,Ve[ut]=Ot<0?Ot*Ot:0}}Pp(tt,0,0,k,X,k,this.f,this.v,this.z),Pp(Ve,Oe,Oe,b,E,k,this.f,this.v,this.z);for(let et=0;et<se;et++){const st=Math.sqrt(tt[et])-Math.sqrt(Ve[et]);he[et]=Math.round(255-255*(st/this.radius+this.cutoff))}return _e}};class c1{constructor(r=[],a=M0){if(this.data=r,this.length=this.data.length,this.compare=a,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(r){this.data.push(r),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const r=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:a,compare:h}=this,p=a[r];for(;r>0;){const g=r-1>>1,v=a[g];if(h(p,v)>=0)break;a[r]=v,r=g}a[r]=p}_down(r){const{data:a,compare:h}=this,p=this.length>>1,g=a[r];for(;r<p;){let v=1+(r<<1),b=a[v];const E=v+1;if(E<this.length&&h(a[E],b)<0&&(v=E,b=a[E]),h(b,g)>=0)break;a[r]=b,r=v}a[r]=g}}function M0(s,r){return s<r?-1:s>r?1:0}function I_(s,r=1,a=!1){let h=1/0,p=1/0,g=-1/0,v=-1/0;const b=s[0];for(let _e=0;_e<b.length;_e++){const Ee=b[_e];(!_e||Ee.x<h)&&(h=Ee.x),(!_e||Ee.y<p)&&(p=Ee.y),(!_e||Ee.x>g)&&(g=Ee.x),(!_e||Ee.y>v)&&(v=Ee.y)}const E=Math.min(g-h,v-p);let k=E/2;const X=new c1([],S0);if(0===E)return new I(h,p);for(let _e=h;_e<g;_e+=E)for(let Ee=p;Ee<v;Ee+=E)X.push(new Lp(_e+k,Ee+k,k,s));let se=function(_e){let Ee=0,Oe=0,Ve=0;const tt=_e[0];for(let ht=0,et=tt.length,st=et-1;ht<et;st=ht++){const dt=tt[ht],ut=tt[st],Ot=dt.x*ut.y-ut.x*dt.y;Oe+=(dt.x+ut.x)*Ot,Ve+=(dt.y+ut.y)*Ot,Ee+=3*Ot}return new Lp(Oe/Ee,Ve/Ee,0,_e)}(s),he=X.length;for(;X.length;){const _e=X.pop();(_e.d>se.d||!se.d)&&(se=_e,a&&console.log("found best %d after %d probes",Math.round(1e4*_e.d)/1e4,he)),_e.max-se.d<=r||(k=_e.h/2,X.push(new Lp(_e.p.x-k,_e.p.y-k,k,s)),X.push(new Lp(_e.p.x+k,_e.p.y-k,k,s)),X.push(new Lp(_e.p.x-k,_e.p.y+k,k,s)),X.push(new Lp(_e.p.x+k,_e.p.y+k,k,s)),he+=4)}return a&&(console.log(`num probes: ${he}`),console.log(`best distance: ${se.d}`)),se.p}function S0(s,r){return r.max-s.max}function Lp(s,r,a,h){this.p=new I(s,r),this.h=a,this.d=function(p,g){let v=!1,b=1/0;for(let E=0;E<g.length;E++){const k=g[E];for(let X=0,se=k.length,he=se-1;X<se;he=X++){const _e=k[X],Ee=k[he];_e.y>p.y!=Ee.y>p.y&&p.x<(Ee.x-_e.x)*(p.y-_e.y)/(Ee.y-_e.y)+_e.x&&(v=!v),b=Math.min(b,pp(p,_e,Ee))}}return(v?1:-1)*Math.sqrt(b)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}const Em=Number.POSITIVE_INFINITY,h1=Math.sqrt(2);function P_(s,[r,a]){let h=0,p=0;if(a===Em){r<0&&(r=0);const g=r/h1;switch(s){case"top-right":case"top-left":p=g-7;break;case"bottom-right":case"bottom-left":p=7-g;break;case"bottom":p=7-r;break;case"top":p=r-7}switch(s){case"top-right":case"bottom-right":h=-g;break;case"top-left":case"bottom-left":h=g;break;case"left":h=r;break;case"right":h=-r}}else{switch(r=Math.abs(r),a=Math.abs(a),s){case"top-right":case"top-left":case"top":p=a-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-a}switch(s){case"top-right":case"bottom-right":case"right":h=-r;break;case"top-left":case"bottom-left":case"left":h=r}}return[h,p]}function u1(s,r,a,h,p,g,v,b,E,k){s.createArrays(),s.tilePixelRatio=Zi/(512*s.overscaling),s.compareText={},s.iconsNeedLinear=!1;const X=s.layers[0].layout,se=s.layers[0]._unevaluatedLayout._values,he={};if("composite"===s.textSizeData.kind){const{minZoom:Oe,maxZoom:Ve}=s.textSizeData;he.compositeTextSizes=[se["text-size"].possiblyEvaluate(new Ct(Oe),b),se["text-size"].possiblyEvaluate(new Ct(Ve),b)]}if("composite"===s.iconSizeData.kind){const{minZoom:Oe,maxZoom:Ve}=s.iconSizeData;he.compositeIconSizes=[se["icon-size"].possiblyEvaluate(new Ct(Oe),b),se["icon-size"].possiblyEvaluate(new Ct(Ve),b)]}he.layoutTextSize=se["text-size"].possiblyEvaluate(new Ct(E+1),b),he.layoutIconSize=se["icon-size"].possiblyEvaluate(new Ct(E+1),b),he.textMaxSize=se["text-size"].possiblyEvaluate(new Ct(18),b);const _e="map"===X.get("text-rotation-alignment")&&"point"!==X.get("symbol-placement"),Ee=X.get("text-size");for(const Oe of s.features){const Ve=X.get("text-font").evaluate(Oe,{},b).join(","),tt=Ee.evaluate(Oe,{},b),ht=he.layoutTextSize.evaluate(Oe,{},b),et=(he.layoutIconSize.evaluate(Oe,{},b),{horizontal:{},vertical:void 0}),st=Oe.text;let dt,ut=[0,0];if(st){const Wt=st.toString(),ii=24*X.get("text-letter-spacing").evaluate(Oe,{},b),Bt=24*X.get("text-line-height").evaluate(Oe,{},b),Xt=G(Wt)?ii:0,Qt=X.get("text-anchor").evaluate(Oe,{},b),Jt=X.get("text-variable-anchor");if(!Jt){const bi=X.get("text-radial-offset").evaluate(Oe,{},b);ut=bi?P_(Qt,[24*bi,Em]):X.get("text-offset").evaluate(Oe,{},b).map(Si=>24*Si)}let oi=_e?"center":X.get("text-justify").evaluate(Oe,{},b);const Vt="point"===X.get("symbol-placement"),di=Vt?24*X.get("text-max-width").evaluate(Oe,{},b):1/0,ji=bi=>{s.allowVerticalPlacement&&F(Wt)&&(et.vertical=E_(st,r,a,p,Ve,di,Bt,Qt,bi,Xt,ut,wa.vertical,!0,ht,tt))};if(!_e&&Jt){const bi="auto"===oi?Jt.map(yi=>O_(yi)):[oi];let Si=!1;for(let yi=0;yi<bi.length;yi++){const qi=bi[yi];if(!et.horizontal[qi])if(Si)et.horizontal[qi]=et.horizontal[0];else{const kn=E_(st,r,a,p,Ve,di,Bt,"center",qi,Xt,ut,wa.horizontal,!1,ht,tt);kn&&(et.horizontal[qi]=kn,Si=1===kn.positionedLines.length)}}ji("left")}else{if("auto"===oi&&(oi=O_(Qt)),Vt||X.get("text-writing-mode").indexOf("horizontal")>=0||!F(Wt)){const bi=E_(st,r,a,p,Ve,di,Bt,Qt,oi,Xt,ut,wa.horizontal,!1,ht,tt);bi&&(et.horizontal[oi]=bi)}ji(Vt?"left":oi)}}let Ot=!1;if(Oe.icon&&Oe.icon.name){const Wt=h[Oe.icon.name];Wt&&(dt=Kh(p[Oe.icon.name],X.get("icon-offset").evaluate(Oe,{},b),X.get("icon-anchor").evaluate(Oe,{},b)),Ot=Wt.sdf,void 0===s.sdfIcons?s.sdfIcons=Wt.sdf:s.sdfIcons!==Wt.sdf&&De("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Wt.pixelRatio!==s.pixelRatio||0!==X.get("icon-rotate").constantOr(1))&&(s.iconsNeedLinear=!0))}const It=T0(et.horizontal)||et.vertical;s.iconsInText||(s.iconsInText=!!It&&It.iconsInText),(It||dt)&&hl(s,Oe,et,dt,h,he,ht,0,ut,Ot,v,b,k)}g&&s.generateCollisionDebugBuffers(E,s.collisionBoxArray)}function O_(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function hl(s,r,a,h,p,g,v,b,E,k,X,se,he){let _e=g.textMaxSize.evaluate(r,{},se);void 0===_e&&(_e=v);const Ee=s.layers[0].layout,Oe=Ee.get("icon-offset").evaluate(r,{},se),Ve=T0(a.horizontal)||a.vertical,tt="globe"===he.name,ht=v/24,et=s.tilePixelRatio*_e/24,st=(Xt=s.overscaling,s.zoom>18&&Xt>2&&(Xt>>=1),Math.max(Zi/(512*Xt),1)*Ee.get("symbol-spacing")),dt=Ee.get("text-padding")*s.tilePixelRatio,ut=Ee.get("icon-padding")*s.tilePixelRatio,Ot=W(Ee.get("text-max-angle")),It="map"===Ee.get("text-rotation-alignment")&&"point"!==Ee.get("symbol-placement"),Wt="map"===Ee.get("icon-rotation-alignment")&&"point"!==Ee.get("symbol-placement"),ii=Ee.get("symbol-placement"),Bt=st/2;var Xt;const Qt=Ee.get("icon-text-fit");let Jt;h&&"none"!==Qt&&(s.allowVerticalPlacement&&a.vertical&&(Jt=D_(h,a.vertical,Qt,Ee.get("icon-text-fit-padding"),Oe,ht)),Ve&&(h=D_(h,Ve,Qt,Ee.get("icon-text-fit-padding"),Oe,ht)));const oi=(Vt,di,ji)=>{if(di.x<0||di.x>=Zi||di.y<0||di.y>=Zi)return;let bi=null;if(tt){const{x:Si,y:yi,z:qi}=he.projectTilePoint(di.x,di.y,ji);bi={anchor:new Wl(Si,yi,qi,0,void 0),up:he.upVector(ji,di.x,di.y)}}!function(Si,yi,qi,kn,_n,wn,Wi,Kn,rn,Cn,Qn,Bn,rr,ur,dr,Br,fo,Jn,oo,Zr,In,Rr,bo,pr,Kr){const us=Si.addToLineVertexArray(yi,kn);let Fo,No,Ts,wo,en,Md,su,Yp=0,$0=0,W0=0,X0=0,ry=-1,oy=-1;const Ea={};let hh=$c.exports("");const Sd=qi?qi.anchor:yi;let au=0,sy=0;if(void 0===rn._unevaluatedLayout.getValue("text-radial-offset")?[au,sy]=rn.layout.get("text-offset").evaluate(In,{},Kr).map(Qr=>24*Qr):(au=24*rn.layout.get("text-radial-offset").evaluate(In,{},Kr),sy=Em),Si.allowVerticalPlacement&&_n.vertical){const Qr=_n.vertical;if(dr)Md=L_(Qr),Kn&&(su=L_(Kn));else{const Yo=rn.layout.get("text-rotate").evaluate(In,{},Kr)+90;Ts=Mm(Cn,Sd,yi,Qn,Bn,rr,Qr,ur,Yo,Br),Kn&&(wo=Mm(Cn,Sd,yi,Qn,Bn,rr,Kn,Jn,Yo))}}if(wn){const Qr=rn.layout.get("icon-rotate").evaluate(In,{},Kr),Yo="none"!==rn.layout.get("icon-text-fit"),Co=k_(wn,Qr,bo,Yo),Sc=Kn?k_(Kn,Qr,bo,Yo):void 0;No=Mm(Cn,Sd,yi,Qn,Bn,rr,wn,Jn,Qr),Yp=4*Co.length;const Kp=Si.iconSizeData;let Zo=null;"source"===Kp.kind?(Zo=[cl*rn.layout.get("icon-size").evaluate(In,{},Kr)],Zo[0]>rh&&De(`${Si.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===Kp.kind&&(Zo=[cl*Rr.compositeIconSizes[0].evaluate(In,{},Kr),cl*Rr.compositeIconSizes[1].evaluate(In,{},Kr)],(Zo[0]>rh||Zo[1]>rh)&&De(`${Si.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Si.addSymbols(Si.icon,Co,Zo,Zr,oo,In,!1,qi,yi,us.lineStartIndex,us.lineLength,-1,pr,Kr),ry=Si.icon.placedSymbolArray.length-1,Sc&&($0=4*Sc.length,Si.addSymbols(Si.icon,Sc,Zo,Zr,oo,In,wa.vertical,qi,yi,us.lineStartIndex,us.lineLength,-1,pr,Kr),oy=Si.icon.placedSymbolArray.length-1)}for(const Qr in _n.horizontal){const Yo=_n.horizontal[Qr];Fo||(hh=$c.exports(Yo.text),dr?en=L_(Yo):Fo=Mm(Cn,Sd,yi,Qn,Bn,rr,Yo,ur,rn.layout.get("text-rotate").evaluate(In,{},Kr),Br));const Co=1===Yo.positionedLines.length;if(W0+=R_(Si,qi,yi,Yo,Wi,rn,dr,In,Br,us,_n.vertical?wa.horizontal:wa.horizontalOnly,Co?Object.keys(_n.horizontal):[Qr],Ea,ry,Rr,pr,Kr),Co)break}_n.vertical&&(X0+=R_(Si,qi,yi,_n.vertical,Wi,rn,dr,In,Br,us,wa.vertical,["vertical"],Ea,oy,Rr,pr,Kr));let uh=-1;const Zp=(Qr,Yo)=>Qr?Math.max(Qr,Yo):Yo;uh=Zp(en,uh),uh=Zp(Md,uh),uh=Zp(su,uh);const D1=uh>-1?1:0;Si.glyphOffsetArray.length>=dl.MAX_GLYPHS&&De("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==In.sortKey&&Si.addToSortKeyRanges(Si.symbolInstances.length,In.sortKey),Si.symbolInstances.emplaceBack(Sd.x,Sd.y,Sd.z,yi.x,yi.y,Ea.right>=0?Ea.right:-1,Ea.center>=0?Ea.center:-1,Ea.left>=0?Ea.left:-1,Ea.vertical>=0?Ea.vertical:-1,ry,oy,hh,void 0!==Fo?Fo:Si.collisionBoxArray.length,void 0!==Fo?Fo+1:Si.collisionBoxArray.length,void 0!==Ts?Ts:Si.collisionBoxArray.length,void 0!==Ts?Ts+1:Si.collisionBoxArray.length,void 0!==No?No:Si.collisionBoxArray.length,void 0!==No?No+1:Si.collisionBoxArray.length,wo||Si.collisionBoxArray.length,wo?wo+1:Si.collisionBoxArray.length,Qn,W0,X0,Yp,$0,D1,0,au,sy,uh)}(s,di,bi,Vt,a,h,p,Jt,s.layers[0],s.collisionBoxArray,r.index,r.sourceLayerIndex,s.index,dt,It,E,0,ut,Wt,Oe,r,g,k,X,se)};if("line"===ii)for(const Vt of bm(r.geometry,0,0,Zi,Zi)){const di=E0(Vt,st,Ot,a.vertical||Ve,h,24,et,s.overscaling,Zi);for(const ji of di){const bi=Ve;bi&&d1(s,bi.text,Bt,ji)||oi(Vt,ji,se)}}else if("line-center"===ii){for(const Vt of r.geometry)if(Vt.length>1){const di=C0(Vt,Ot,a.vertical||Ve,h,24,et);di&&oi(Vt,di,se)}}else if("Polygon"===r.type)for(const Vt of ih(r.geometry,0)){const di=I_(Vt,16);oi(Vt[0],new Wl(di.x,di.y,0,0,void 0),se)}else if("LineString"===r.type)for(const Vt of r.geometry)oi(Vt,new Wl(Vt[0].x,Vt[0].y,0,0,void 0),se);else if("Point"===r.type)for(const Vt of r.geometry)for(const di of Vt)oi([di],new Wl(di.x,di.y,0,0,void 0),se)}const rh=32640;function R_(s,r,a,h,p,g,v,b,E,k,X,se,he,_e,Ee,Oe,Ve){const tt=function(st,dt,ut,Ot,It,Wt,ii,Bt){const Xt=[];if(0===dt.positionedLines.length)return Xt;const Qt=Ot.layout.get("text-rotate").evaluate(Wt,{})*Math.PI/180,Jt=function(bi){const Si=bi[0],yi=bi[1],qi=Si*yi;return qi>0?[Si,-yi]:qi<0?[-Si,yi]:0===Si?[yi,Si]:[yi,-Si]}(ut);let oi=Math.abs(dt.top-dt.bottom);for(const bi of dt.positionedLines)oi-=bi.lineOffset;const Vt=dt.positionedLines.length,di=oi/Vt;let ji=dt.top-ut[1];for(let bi=0;bi<Vt;++bi){const Si=dt.positionedLines[bi];ji=l1(dt,di,ji,bi);for(const yi of Si.positionedGlyphs){if(!yi.rect)continue;const qi=yi.rect||{};let kn=4,_n=!0,wn=1,Wi=0;if(yi.imageName){const pr=ii[yi.imageName];if(!pr)continue;if(pr.sdf){De("SDF images are not supported in formatted text and will be ignored.");continue}_n=!1,wn=pr.pixelRatio,kn=1/wn}const Kn=(It||Bt)&&yi.vertical,rn=yi.metrics.advance*yi.scale/2,Cn=yi.metrics,Qn=yi.rect;if(null===Qn)continue;Bt&&dt.verticalizable&&(Wi=yi.imageName?rn-yi.metrics.width*yi.scale/2:0);const Bn=It?[yi.x+rn,yi.y]:[0,0];let rr=[0,0],ur=[0,0],dr=!1;It||(Kn?(ur=[yi.x+rn+Jt[0],yi.y+Jt[1]-Wi],dr=!0):rr=[yi.x+rn+ut[0],yi.y+ut[1]-Wi]);const Br=Qn.w*yi.scale/(wn*(yi.localGlyph?2:1)),fo=Qn.h*yi.scale/(wn*(yi.localGlyph?2:1));let Jn,oo,Zr,In;if(Kn){const pr=yi.y-ji,Kr=new I(-rn,rn-pr),us=-Math.PI/2,Fo=new I(...ur);Jn=new I(-rn+rr[0],rr[1]),Jn._rotateAround(us,Kr)._add(Fo),Jn.x+=-pr+rn,Jn.y-=(Cn.left-kn)*yi.scale;const No=yi.imageName?Cn.advance*yi.scale:24*yi.scale,Ts=String.fromCharCode(yi.glyph);Kw(Ts)?Jn.x+=(1-kn)*yi.scale:Qw(Ts)?Jn.x+=No-Cn.height*yi.scale+(-kn-1)*yi.scale:Jn.x+=yi.imageName||Cn.width+2*kn===Qn.w&&Cn.height+2*kn===Qn.h?(No-fo)/2:(No-(Cn.height+2*kn)*yi.scale)/2,oo=new I(Jn.x,Jn.y-Br),Zr=new I(Jn.x+fo,Jn.y),In=new I(Jn.x+fo,Jn.y-Br)}else{const pr=(Cn.left-kn)*yi.scale-rn+rr[0],Kr=(-Cn.top-kn)*yi.scale+rr[1],us=pr+Br,Fo=Kr+fo;Jn=new I(pr,Kr),oo=new I(us,Kr),Zr=new I(pr,Fo),In=new I(us,Fo)}if(Qt){let pr;pr=It?new I(0,0):dr?new I(Jt[0],Jt[1]):new I(ut[0],ut[1]),Jn._rotateAround(Qt,pr),oo._rotateAround(Qt,pr),Zr._rotateAround(Qt,pr),In._rotateAround(Qt,pr)}const Rr=new I(0,0),bo=new I(0,0);Xt.push({tl:Jn,tr:oo,bl:Zr,br:In,tex:qi,writingMode:dt.writingMode,glyphOffset:Bn,sectionIndex:yi.sectionIndex,isSDF:_n,pixelOffsetTL:Rr,pixelOffsetBR:bo,minFontScaleX:0,minFontScaleY:0})}}return Xt}(0,h,E,g,v,b,p,s.allowVerticalPlacement),ht=s.textSizeData;let et=null;"source"===ht.kind?(et=[cl*g.layout.get("text-size").evaluate(b,{},Ve)],et[0]>rh&&De(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===ht.kind&&(et=[cl*Ee.compositeTextSizes[0].evaluate(b,{},Ve),cl*Ee.compositeTextSizes[1].evaluate(b,{},Ve)],(et[0]>rh||et[1]>rh)&&De(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),s.addSymbols(s.text,tt,et,E,v,b,X,r,a,k.lineStartIndex,k.lineLength,_e,Oe,Ve);for(const st of se)he[st]=s.text.placedSymbolArray.length-1;return 4*tt.length}function T0(s){for(const r in s)return s[r];return null}function Mm(s,r,a,h,p,g,v,b,E,k){let X=v.top,se=v.bottom,he=v.left,_e=v.right;const Ee=v.collisionPadding;if(Ee&&(he-=Ee[0],X-=Ee[1],_e+=Ee[2],se+=Ee[3]),E){const Oe=new I(he,X),Ve=new I(_e,X),tt=new I(he,se),ht=new I(_e,se),et=W(E);let st=new I(0,0);k&&(st=new I(k[0],k[1])),Oe._rotateAround(et,st),Ve._rotateAround(et,st),tt._rotateAround(et,st),ht._rotateAround(et,st),he=Math.min(Oe.x,Ve.x,tt.x,ht.x),_e=Math.max(Oe.x,Ve.x,tt.x,ht.x),X=Math.min(Oe.y,Ve.y,tt.y,ht.y),se=Math.max(Oe.y,Ve.y,tt.y,ht.y)}return s.emplaceBack(r.x,r.y,r.z,a.x,a.y,he,X,_e,se,b,h,p,g),s.length-1}function L_(s){s.collisionPadding&&(s.top-=s.collisionPadding[1],s.bottom+=s.collisionPadding[3]);const r=s.bottom-s.top;return r>0?Math.max(10,r):null}function d1(s,r,a,h){const p=s.compareText;if(r in p){const g=p[r];for(let v=g.length-1;v>=0;v--)if(h.dist(g[v])<a)return!0}else p[r]=[];return p[r].push(h),!1}const D0=Ci([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:A0}=D0,k0=Ci([{name:"a_pos_3",components:3,type:"Int16"}]);var Fp=Ci([{name:"a_pos",type:"Int16",components:2}]);const sn=Zi/Math.PI/2,Ni=2*ra(1,0)*sn*Math.PI,Jh=[64,32,16],Ha=-sn,Ga=sn,I0=[new Cs([Ha,Ha,Ha],[Ga,Ga,Ga]),new Cs([Ha,Ha,Ha],[0,0,Ga]),new Cs([0,Ha,Ha],[Ga,0,Ga]),new Cs([Ha,0,Ha],[0,Ga,Ga]),new Cs([0,0,Ha],[Ga,Ga,Ga])];function P0(s,r,a,h=!0){const p=ba([],s._camera.position,s.worldSize),g=[r,a,1,1];nd(g,g,s.pixelMatrixInverse),Jg(g,g,1/g[3]);const v=ws([],xo([],g,p)),b=s.globeMatrix,E=[b[12],b[13],b[14]],k=xo([],E,p),X=hs(k),se=ws([],k),he=s.worldSize/(2*Math.PI),_e=Ua(se,v),Ee=Math.asin(he/X);if(Ee<Math.acos(_e)){if(!h)return null;const ii=[],Bt=[];ba(ii,v,X/_e),ws(Bt,xo(Bt,ii,k)),ws(v,xc(v,k,ba(v,Bt,Math.tan(Ee)*X)))}const Oe=[];new Uv(p,v).closestPointOnSphere(E,he,Oe);const Ve=ws([],Ze(b,0)),tt=ws([],Ze(b,1)),ht=ws([],Ze(b,2)),et=Ua(Ve,Oe),st=Ua(tt,Oe),dt=Ua(ht,Oe),ut=ie(Math.asin(-st/he));let Ot=ie(Math.atan2(et,dt));Ot=s.center.lng+function(ii,Bt){const Xt=(Bt-ii+180)%360-180;return Xt<-180?Xt+360:Xt}(s.center.lng,Ot);const It=al(Ot),Wt=D(nr(ut),0,1);return new xa(It,Wt)}class O0{constructor(r,a,h){this.a=xo([],r,h),this.b=xo([],a,h),this.center=h;const p=ws([],this.a),g=ws([],this.b);this.angle=Math.acos(Ua(p,g))}}function F_(s,r){if(0===s.angle)return null;let a;return a=0===s.a[r]?1/s.angle*.5*Math.PI:1/s.angle*Math.atan(s.b[r]/s.a[r]/Math.sin(s.angle)-1/Math.tan(s.angle)),a<0||a>1?null:function(h,p,g,v){const b=Math.sin(g);return h*(Math.sin((1-v)*g)/b)+p*(Math.sin(v*g)/b)}(s.a[r],s.b[r],s.angle,D(a,0,1))+s.center[r]}function Xl(s){if(s.z<=1)return I0[s.z+2*s.y+s.x];const r=Np(Sm(s));return Cs.fromPoints(r)}function _d(s,r,a){return ba(s,s,1-a),ed(s,s,r,a)}function N_(s,r){const a=yd(r.zoom);if(0===a)return Xl(s);const h=Sm(s),p=Np(h),g=al(h.getWest())*r.worldSize,v=al(h.getEast())*r.worldSize,b=nr(h.getNorth())*r.worldSize,E=nr(h.getSouth())*r.worldSize,k=[g,b,0],X=[v,b,0],se=[g,E,0],he=[v,E,0],_e=Qu([],r.globeMatrix);return Hr(k,k,_e),Hr(X,X,_e),Hr(se,se,_e),Hr(he,he,_e),p[0]=_d(p[0],se,a),p[1]=_d(p[1],he,a),p[2]=_d(p[2],X,a),p[3]=_d(p[3],k,a),Cs.fromPoints(p)}function B_(s,r,a){for(const h of s)Hr(h,h,r),ba(h,h,a)}function Sm({x:s,y:r,z:a}){const h=1/(1<<a),p=new Dn(cs(s*h),Xo((r+1)*h)),g=new Dn(cs((s+1)*h),Xo(r*h));return new gc(p,g)}function Np(s){const r=W(s.getNorth()),a=W(s.getSouth()),h=Math.cos(r),p=Math.cos(a),g=Math.sin(r),v=Math.sin(a),b=s.getWest(),E=s.getEast();return[oh(p,v,b),oh(p,v,E),oh(h,g,E),oh(h,g,b)]}function oh(s,r,a,h=sn){return a=W(a),[s*Math.sin(a)*h,-r*h,s*Math.cos(a)*h]}function Bp(s,r,a){return oh(Math.cos(W(s)),Math.sin(W(s)),r,a)}function Tm(s,r,a,h){const p=1<<a.z,g=(s/Zi+a.x)/p;return Bp(Xo((r/Zi+a.y)/p),cs(g),h)}function z_({min:s,max:r}){return 16383/Math.max(r[0]-s[0],r[1]-s[1],r[2]-s[2])}const p1=new Float64Array(16);function zp(s){const r=z_(s),a=Nv(p1,[r,r,r]);return Ju(a,a,((h=[])[0]=-(p=s.min)[0],h[1]=-p[1],h[2]=-p[2],h));var h,p}function Dm(s){const r=(h=s.min,(a=p1)[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=h[0],a[13]=h[1],a[14]=h[2],a[15]=1,a);var a,h;const p=1/z_(s);return Qc(r,r,[p,p,p])}function f1(s,r,a,h,p){const g=function(E){const k=Zi/(2*Math.PI);return E/(2*Math.PI)/k}(a),v=[s,r,-a/(2*Math.PI)],b=Vl(new Float64Array(16));return Ju(b,b,v),Qc(b,b,[g,g,g]),Xf(b,b,W(-p)),jl(b,b,W(-h)),b}function yd(s){return z(5,6,s)}function eu(s,r){const a=Bp(r.lat,r.lng);return v=(p=Kg([],function(Ee){const Oe=Bp(Ee._center.lat,Ee._center.lng);let Ve=Qg([],Bs(0,1,0),Oe);const tt=Bv([],-Ee.angle,Oe);Ve=Hr(Ve,Ve,tt),Bv(tt,-Ee._pitch,Ve);const ht=ws([],Oe);return ba(ht,ht,Ee.cameraToCenterDistance/Ee.pixelsPerMeter*Ni),Hr(ht,ht,tt),xc([],Oe,ht)}(s),a))[0],b=p[1],E=p[2],k=(g=a)[0],X=g[1],se=g[2],_e=(he=Math.sqrt(v*v+b*b+E*E)*Math.sqrt(k*k+X*X+se*se))&&Ua(p,g)/he,Math.acos(Math.min(Math.max(_e,-1),1));var p,g,v,b,E,k,X,se,he,_e}function V_(s,r){return eu(s,r)>Math.PI/2*1.01}const j_=W(85),Am=Math.cos(j_),m1=Math.sin(j_);function U_(s,r){const a=s.fovAboveCenter,h=s.elevation?s.elevation.getMinElevationBelowMSL()*r:0,p=(s._camera.position[2]*s.worldSize-h)/Math.cos(s._pitch),g=Math.sin(a)*p/Math.sin(Math.max(Math.PI/2-s._pitch-a,.01)),v=Math.sin(s._pitch)*g+p;return Math.min(1.01*v,p*(1/s._horizonShift))}function tu(s,r){if(!r.isReprojectedInTileSpace)return{scale:1<<s.z,x:s.x,y:s.y,x2:s.x+1,y2:s.y+1,projection:r};const a=Math.pow(2,-s.z),h=s.x*a,p=(s.x+1)*a,g=s.y*a,v=(s.y+1)*a,b=cs(h),E=cs(p),k=Xo(g),X=Xo(v),se=r.project(b,k),he=r.project(E,k),_e=r.project(E,X),Ee=r.project(b,X);let Oe=Math.min(se.x,he.x,_e.x,Ee.x),Ve=Math.min(se.y,he.y,_e.y,Ee.y),tt=Math.max(se.x,he.x,_e.x,Ee.x),ht=Math.max(se.y,he.y,_e.y,Ee.y);const et=a/16;function st(ut,Ot,It,Wt,ii,Bt){const Xt=(It+ii)/2,Qt=(Wt+Bt)/2,Jt=r.project(cs(Xt),Xo(Qt)),oi=Math.max(0,Oe-Jt.x,Ve-Jt.y,Jt.x-tt,Jt.y-ht);Oe=Math.min(Oe,Jt.x),tt=Math.max(tt,Jt.x),Ve=Math.min(Ve,Jt.y),ht=Math.max(ht,Jt.y),oi>et&&(st(ut,Jt,It,Wt,Xt,Qt),st(Jt,Ot,Xt,Qt,ii,Bt))}st(se,he,h,g,p,g),st(he,_e,p,g,p,v),st(_e,Ee,p,v,h,v),st(Ee,se,h,v,h,g),Oe-=et,Ve-=et,tt+=et,ht+=et;const dt=1/Math.max(tt-Oe,ht-Ve);return{scale:dt,x:Oe*dt,y:Ve*dt,x2:tt*dt,y2:ht*dt,projection:r}}const g1=Vl(new Float32Array(16));class sh{constructor(r){this.spec=r,this.name=r.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(r,a){return{x:0,y:0,z:0}}unproject(r,a){return new Dn(0,0)}projectTilePoint(r,a,h){return{x:r,y:a,z:0}}locationPoint(r,a,h=!0){return r._coordinatePoint(r.locationCoordinate(a),h)}pixelsPerMeter(r,a){return ra(1,r)*a}pixelSpaceConversion(r,a,h){return 1}farthestPixelDistance(r){return U_(r,r.pixelsPerMeter)}pointCoordinate(r,a,h,p){const g=r.horizonLineFromTop(!1),v=new I(a,Math.max(g,h));return r.rayIntersectionCoordinate(r.pointRayIntersection(v,p))}pointCoordinate3D(r,a,h){const p=new I(a,h);if(r.elevation)return r.elevation.pointCoordinate(p);{const g=this.pointCoordinate(r,p.x,p.y,0);return[g.x,g.y,g.z]}}isPointAboveHorizon(r,a){if(r.elevation)return!this.pointCoordinate3D(r,a.x,a.y);const h=r.horizonLineFromTop();return a.y<h}createInversionMatrix(r,a){return g1}createTileMatrix(r,a,h){let p,g,v;const b=h.canonical,E=Vl(new Float64Array(16));if(this.isReprojectedInTileSpace){const k=tu(b,this);p=1,g=k.x+h.wrap*k.scale,v=k.y,Qc(E,E,[p/k.scale,p/k.scale,r.pixelsPerMeter/a])}else p=a/r.zoomScale(b.z),g=(b.x+Math.pow(2,b.z)*h.wrap)*p,v=b.y*p;return Ju(E,E,[g,v,0]),Qc(E,E,[p/Zi,p/Zi,1]),E}upVector(r,a,h){return[0,0,1]}upVectorScale(r,a,h){return{metersToTile:1}}}class _1 extends sh{constructor(r){super(r),this.range=[4,7],this.center=r.center||[-96,37.5];const[a,h]=this.parallels=r.parallels||[29.5,45.5],p=Math.sin(W(a));this.n=(p+Math.sin(W(h)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(r,a){const{n:h,c:p,r0:g}=this,v=W(r-this.center[0]),b=W(a),E=Math.sqrt(p-2*h*Math.sin(b))/h;return{x:E*Math.sin(v*h),y:E*Math.cos(v*h)-g,z:0}}unproject(r,a){const{n:h,c:p,r0:g}=this,v=g+a;let b=Math.atan2(r,Math.abs(v))*Math.sign(v);v*h<0&&(b-=Math.PI*Math.sign(r)*Math.sign(v));const E=W(this.center[0])*h;b=A(b,-Math.PI-E,Math.PI-E);const k=D(ie(b/h)+this.center[0],-180,180),X=Math.asin(D((p-(r*r+v*v)*h*h)/(2*h),-1,1)),se=D(ie(X),-85.051129,zl);return new Dn(k,se)}}const Vp=1.340264,vd=-.081106,jp=893e-6,xd=.003796,Up=Math.sqrt(3)/2;class H_ extends sh{project(r,a){a=a/180*Math.PI,r=r/180*Math.PI;const h=Math.asin(Up*Math.sin(a)),p=h*h,g=p*p*p;return{x:.5*(r*Math.cos(h)/(Up*(Vp+3*vd*p+g*(7*jp+9*xd*p)))/Math.PI+.5),y:1-.5*(h*(Vp+vd*p+g*(jp+xd*p))/Math.PI+1),z:0}}unproject(r,a){r=(2*r-.5)*Math.PI;let h=a=(2*(1-a)-1)*Math.PI,p=h*h,g=p*p*p;for(let X,se,he,_e=0;_e<12&&(se=h*(Vp+vd*p+g*(jp+xd*p))-a,he=Vp+3*vd*p+g*(7*jp+9*xd*p),X=se/he,h=D(h-X,-Math.PI/3,Math.PI/3),p=h*h,g=p*p*p,!(Math.abs(X)<1e-12));++_e);const v=Up*r*(Vp+3*vd*p+g*(7*jp+9*xd*p))/Math.cos(h),b=Math.asin(Math.sin(h)/Up),E=D(180*v/Math.PI,-180,180),k=D(180*b/Math.PI,-85.051129,zl);return new Dn(E,k)}}class oS extends sh{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0}project(r,a){return{x:.5+r/360,y:.5-a/360,z:0}}unproject(r,a){const h=360*(r-.5),p=D(360*(.5-a),-85.051129,zl);return new Dn(h,p)}}const ah=Math.PI/2;function km(s){return Math.tan((ah+s)/2)}class sS extends sh{constructor(r){super(r),this.center=r.center||[0,30];const[a,h]=this.parallels=r.parallels||[30,30];let p=W(a),g=W(h);this.southernCenter=p+g<0,this.southernCenter&&(p=-p,g=-g);const v=Math.cos(p),b=km(p);this.n=p===g?Math.sin(p):Math.log(v/Math.cos(g))/Math.log(km(g)/b),this.f=v*Math.pow(km(p),this.n)/this.n}project(r,a){a=W(a),this.southernCenter&&(a=-a),r=W(r-this.center[0]);const h=1e-6,{n:p,f:g}=this;g>0?a<-ah+h&&(a=-ah+h):a>ah-h&&(a=ah-h);const v=g/Math.pow(km(a),p);let b=v*Math.sin(p*r),E=g-v*Math.cos(p*r);return b=.5*(b/Math.PI+.5),E=.5*(E/Math.PI+.5),{x:b,y:this.southernCenter?E:1-E,z:0}}unproject(r,a){r=(2*r-.5)*Math.PI,this.southernCenter&&(a=1-a),a=(2*(1-a)-.5)*Math.PI;const{n:h,f:p}=this,g=p-a,v=Math.sign(g),b=Math.sign(h)*Math.sqrt(r*r+g*g);let E=Math.atan2(r,Math.abs(g))*v;g*h<0&&(E-=Math.PI*Math.sign(r)*v);const k=D(ie(E/h)+this.center[0],-180,180),X=D(ie(2*Math.atan(Math.pow(p/b,1/h))-ah),-85.051129,zl);return new Dn(k,this.southernCenter?-X:X)}}class ft extends sh{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(r,a){return{x:al(r),y:nr(a),z:0}}unproject(r,a){const h=cs(r),p=Xo(a);return new Dn(h,p)}}const iu=W(zl);class R0 extends sh{project(r,a){const h=(a=W(a))*a,p=h*h;return{x:.5*((r=W(r))*(.8707-.131979*h+p*(p*(.003971*h-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(a*(1.007226+h*(.015085+p*(.028874*h-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(r,a){r=(2*r-.5)*Math.PI;let h=a=(2*(1-a)-1)*Math.PI,p=25,g=0,v=h*h;do{v=h*h;const k=v*v;g=(h*(1.007226+v*(.015085+k*(.028874*v-.044475-.005916*k)))-a)/(1.007226+v*(.045255+k*(.259866*v-.311325-.005916*11*k))),h=D(h-g,-iu,iu)}while(Math.abs(g)>1e-6&&--p>0);v=h*h;const b=D(ie(r/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),E=ie(h);return new Dn(b,E)}}const Hp=W(zl);class ul extends sh{project(r,a){a=W(a),r=W(r);const h=Math.cos(a),p=2/Math.PI,g=Math.acos(h*Math.cos(r/2)),v=Math.sin(g)/g,b=.5*(r*p+2*h*Math.sin(r/2)/v)||0,E=.5*(a+Math.sin(a)/v)||0;return{x:.5*(b/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(r,a){let h=r=(2*r-.5)*Math.PI,p=a=(2*(1-a)-1)*Math.PI,g=25;const v=1e-6;let b=0,E=0;do{const k=Math.cos(p),X=Math.sin(p),se=2*X*k,he=X*X,_e=k*k,Ee=Math.cos(h/2),Oe=Math.sin(h/2),Ve=2*Ee*Oe,tt=Oe*Oe,ht=1-_e*Ee*Ee,et=ht?1/ht:0,st=ht?Math.acos(k*Ee)*Math.sqrt(1/ht):0,dt=.5*(2*st*k*Oe+2*h/Math.PI)-r,ut=.5*(st*X+p)-a,Ot=.5*et*(_e*tt+st*k*Ee*he)+1/Math.PI,It=et*(Ve*se/4-st*X*Oe),Wt=.125*et*(se*Oe-st*X*_e*Ve),ii=.5*et*(he*Ee+st*tt*k)+.5,Bt=It*Wt-ii*Ot;b=(ut*It-dt*ii)/Bt,E=(dt*Wt-ut*Ot)/Bt,h=D(h-b,-Math.PI,Math.PI),p=D(p-E,-Hp,Hp)}while((Math.abs(b)>v||Math.abs(E)>v)&&--g>0);return new Dn(ie(h),ie(p))}}class G_ extends sh{constructor(r){super(r),this.center=r.center||[0,0],this.parallels=r.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(W(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(r,a){const{scale:h,cosPhi:p}=this;return{x:W(r)*p*h+.5,y:-Math.sin(W(a))/p*h+.5,z:0}}unproject(r,a){const{scale:h,cosPhi:p}=this,g=-(a-.5)/h,v=D(ie((r-.5)/h)/p,-180,180),b=Math.asin(D(g*p,-1,1)),E=D(ie(b),-85.051129,zl);return new Dn(v,E)}}class y1 extends ft{constructor(r){super(r),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(r,a,h){const p=Tm(r,a,h);return Hr(p,p,zp(Xl(h))),{x:p[0],y:p[1],z:p[2]}}locationPoint(r,a){const h=Bp(a.lat,a.lng),p=ws([],h),g=r.elevation?r.elevation.getAtPointOrZero(r.locationCoordinate(a),r._centerAltitude):r._centerAltitude;ed(h,h,p,ra(1,0)*Zi*g);const v=Vl(new Float64Array(16));return vc(v,r.pixelMatrix,r.globeMatrix),Hr(h,h,v),new I(h[0],h[1])}pixelsPerMeter(r,a){return ra(1,0)*a}pixelSpaceConversion(r,a,h){const p=ra(1,r)*a,g=ci(ra(1,45)*a,p,h);return this.pixelsPerMeter(r,a)/g}createTileMatrix(r,a,h){const p=Dm(Xl(h.canonical));return vc(new Float64Array(16),r.globeMatrix,p)}createInversionMatrix(r,a){const{center:h}=r,p=zp(Xl(a));return jl(p,p,W(h.lng)),Xf(p,p,W(h.lat)),Qc(p,p,[r._pixelsPerMercatorPixel,r._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(r,a,h,p){return P0(r,a,h,!0)||new xa(0,0)}pointCoordinate3D(r,a,h){const p=this.pointCoordinate(r,a,h,0);return[p.x,p.y,p.z]}isPointAboveHorizon(r,a){return!P0(r,a.x,a.y,!1)}farthestPixelDistance(r){const a=function(p,g){const v=p.cameraToCenterDistance,b=p._centerAltitude*g,E=p._camera,k=p._camera.forward(),X=xc([],ba([],k,-v),[0,0,b]),se=p.worldSize/(2*Math.PI),he=[0,0,-se],_e=p.width/p.height,Ee=Math.tan(p.fovAboveCenter),Oe=ba([],E.up(),Ee),Ve=ba([],E.right(),Ee*_e),tt=ws([],xc([],xc([],k,Oe),Ve)),ht=[];let et;if(new Uv(X,tt).closestPointOnSphere(he,se,ht)){const st=xc([],ht,he),dt=xo([],st,X);et=Math.cos(p.fovAboveCenter)*hs(dt)}else{const st=xo([],X,he),dt=xo([],he,X);ws(dt,dt);const ut=hs(st)-se;et=Math.sqrt(ut*(ut+2*se));const Ot=Math.acos(et/(se+ut))-Math.acos(Ua(k,dt));et*=Math.cos(Ot)}return 1.01*et}(r,this.pixelsPerMeter(r.center.lat,r.worldSize)),h=yd(r.zoom);if(h>0){const p=U_(r,ra(1,r.center.lat)*r.worldSize),g=r.worldSize/(2*Math.PI),v=Math.max(r.width,r.height)/r.worldSize*Math.PI;return ci(a,p+g*(1-Math.cos(v)),Math.pow(h,10))}return a}upVector(r,a,h){return Tm(a,h,r,1)}upVectorScale(r){return{metersToTile:Ni*z_(Xl(r))}}}function Im(s){const r=s.parallels,a=!!r&&Math.abs(r[0]+r[1])<.01;switch(s.name){case"mercator":return new ft(s);case"equirectangular":return new oS(s);case"naturalEarth":return new R0(s);case"equalEarth":return new H_(s);case"winkelTripel":return new ul(s);case"albers":return a?new G_(s):new _1(s);case"lambertConformalConic":return a?new G_(s):new sS(s);case"globe":return new y1(s)}throw new Error(`Invalid projection name: ${s.name}`)}const Cc=ld.types,$_=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Gp(s,r,a,h,p,g,v,b,E,k,X,se,he){const _e=b?Math.min(rh,Math.round(b[0])):0,Ee=b?Math.min(rh,Math.round(b[1])):0;s.emplaceBack(r,a,Math.round(32*h),Math.round(32*p),g,v,(_e<<1)+(E?1:0),Ee,16*k,16*X,256*se,256*he)}function bd(s,r,a,h,p,g,v){s.emplaceBack(r,a,h,p,g,v)}function W_(s,r,a,h,p){s.emplaceBack(r,a,h,p),s.emplaceBack(r,a,h,p),s.emplaceBack(r,a,h,p),s.emplaceBack(r,a,h,p)}function L0(s){for(const r of s.sections)if(We(r.text))return!0;return!1}class F0{constructor(r){this.layoutVertexArray=new fr,this.indexArray=new Oo,this.programConfigurations=r,this.segments=new ro,this.dynamicLayoutVertexArray=new bs,this.opacityVertexArray=new Nr,this.placedSymbolArray=new hw,this.globeExtVertexArray=new Ln}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(r,a,h,p){this.isEmpty()||(h&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,m_.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,g_.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,$_,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,p0.members,!0)),this.opacityVertexBuffer.itemSize=1),(h||p)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Ei(F0,"SymbolBuffers");class wd{constructor(r,a,h){this.layoutVertexArray=new r,this.layoutAttributes=a,this.indexArray=new h,this.segments=new ro,this.collisionVertexArray=new fc,this.collisionVertexArrayExt=new ol}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,Ms.members,!0),this.collisionVertexBufferExt=r.createVertexBuffer(this.collisionVertexArrayExt,Cp.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Ei(wd,"CollisionBuffers");class dl{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(v=>v.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Vl([]),this.placementViewportMatrix=Vl([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=__(this.zoom,a["text-size"]),this.iconSizeData=__(this.zoom,a["icon-size"]);const h=this.layers[0].layout,p=h.get("symbol-sort-key"),g=h.get("symbol-z-order");this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==g&&void 0!==p.constantOr(1),this.sortFeaturesByY=("viewport-y"===g||"auto"===g&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map(v=>wa[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=r.sourceID,this.projection=r.projection}createArrays(){this.text=new F0(new jh(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new F0(new jh(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new pw,this.lineVertexArray=new fw,this.symbolInstances=new dw}calculateGlyphDependencies(r,a,h,p,g){for(let v=0;v<r.length;v++)if(a[r.charCodeAt(v)]=!0,p&&g){const b=Mp[r.charAt(v)];b&&(a[b.charCodeAt(0)]=!0)}}populate(r,a,h,p){const g=this.layers[0],v=g.layout,b="globe"===this.projection.name,E=v.get("text-font"),k=v.get("text-field"),X=v.get("icon-image"),se=("constant"!==k.value.kind||k.value.value instanceof Vo&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&("constant"!==E.value.kind||E.value.value.length>0),he="constant"!==X.value.kind||!!X.value.value||Object.keys(X.parameters).length>0,_e=v.get("symbol-sort-key");if(this.features=[],!se&&!he)return;const Ee=a.iconDependencies,Oe=a.glyphDependencies,Ve=a.availableImages,tt=new Ct(this.zoom);for(const{feature:ht,id:et,index:st,sourceLayerIndex:dt}of r){const ut=g._featureFilter.needGeometry,Ot=Gh(ht,ut);if(!g._featureFilter.filter(tt,Ot,h))continue;if(ut||(Ot.geometry=_c(ht,h,p)),b&&1!==ht.type&&h.z<=5){const Bt=Ot.geometry,Xt=.98078528056,Qt=(Jt,oi)=>Ua(Tm(Jt.x,Jt.y,h,1),Tm(oi.x,oi.y,h,1))<Xt;for(let Jt=0;Jt<Bt.length;Jt++)Bt[Jt]=Av(Bt[Jt],Qt)}let It,Wt;if(se){const Bt=g.getValueAndResolveTokens("text-field",Ot,h,Ve),Xt=Vo.factory(Bt);L0(Xt)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===xt()||this.hasRTLText&&kt.isParsed())&&(It=Zw(Xt,g,Ot))}if(he){const Bt=g.getValueAndResolveTokens("icon-image",Ot,h,Ve);Wt=Bt instanceof qs?Bt:qs.fromString(Bt)}if(!It&&!Wt)continue;const ii=this.sortFeaturesByKey?_e.evaluate(Ot,{},h):void 0;if(this.features.push({id:et,text:It,icon:Wt,index:st,sourceLayerIndex:dt,geometry:Ot.geometry,properties:ht.properties,type:Cc[ht.type],sortKey:ii}),Wt&&(Ee[Wt.name]=!0),It){const Bt=E.evaluate(Ot,{},h).join(","),Xt="map"===v.get("text-rotation-alignment")&&"point"!==v.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(wa.vertical)>=0;for(const Qt of It.sections)if(Qt.image)Ee[Qt.image.name]=!0;else{const Jt=F(It.toString()),oi=Qt.fontStack||Bt,Vt=Oe[oi]=Oe[oi]||{};this.calculateGlyphDependencies(Qt.text,Vt,Xt,this.allowVerticalPlacement,Jt)}}}"line"===v.get("symbol-placement")&&(this.features=function(ht){const et={},st={},dt=[];let ut=0;function Ot(Bt){dt.push(ht[Bt]),ut++}function It(Bt,Xt,Qt){const Jt=st[Bt];return delete st[Bt],st[Xt]=Jt,dt[Jt].geometry[0].pop(),dt[Jt].geometry[0]=dt[Jt].geometry[0].concat(Qt[0]),Jt}function Wt(Bt,Xt,Qt){const Jt=et[Xt];return delete et[Xt],et[Bt]=Jt,dt[Jt].geometry[0].shift(),dt[Jt].geometry[0]=Qt[0].concat(dt[Jt].geometry[0]),Jt}function ii(Bt,Xt,Qt){const Jt=Qt?Xt[0][Xt[0].length-1]:Xt[0][0];return`${Bt}:${Jt.x}:${Jt.y}`}for(let Bt=0;Bt<ht.length;Bt++){const Xt=ht[Bt],Qt=Xt.geometry,Jt=Xt.text?Xt.text.toString():null;if(!Jt){Ot(Bt);continue}const oi=ii(Jt,Qt),Vt=ii(Jt,Qt,!0);if(oi in st&&Vt in et&&st[oi]!==et[Vt]){const di=Wt(oi,Vt,Qt),ji=It(oi,Vt,dt[di].geometry);delete et[oi],delete st[Vt],st[ii(Jt,dt[ji].geometry,!0)]=ji,dt[di].geometry=null}else oi in st?It(oi,Vt,Qt):Vt in et?Wt(oi,Vt,Qt):(Ot(Bt),et[oi]=ut-1,st[Vt]=ut-1)}return dt.filter(Bt=>Bt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ht,et)=>ht.sortKey-et.sortKey)}update(r,a,h,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,a,this.layers,h,p),this.icon.programConfigurations.updatePaintArrays(r,a,this.layers,h,p))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Im(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,a){const h=this.lineVertexArray.length;if(void 0!==r.segment)for(const{x:p,y:g}of a)this.lineVertexArray.emplaceBack(p,g);return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(r,a,h,p,g,v,b,E,k,X,se,he,_e,Ee){const Oe=r.indexArray,Ve=r.layoutVertexArray,tt=r.globeExtVertexArray,ht=r.segments.prepareSegment(4*a.length,Ve,Oe,this.canOverlap?v.sortKey:void 0),et=this.glyphOffsetArray.length,st=ht.vertexLength,dt=this.allowVerticalPlacement&&b===wa.vertical?Math.PI/2:0,ut=v.text&&v.text.sections;for(let It=0;It<a.length;It++){const{tl:Wt,tr:ii,bl:Bt,br:Xt,tex:Qt,pixelOffsetTL:Jt,pixelOffsetBR:oi,minFontScaleX:Vt,minFontScaleY:di,glyphOffset:ji,isSDF:bi,sectionIndex:Si}=a[It],yi=ht.vertexLength,qi=ji[1];if(Gp(Ve,k.x,k.y,Wt.x,qi+Wt.y,Qt.x,Qt.y,h,bi,Jt.x,Jt.y,Vt,di),Gp(Ve,k.x,k.y,ii.x,qi+ii.y,Qt.x+Qt.w,Qt.y,h,bi,oi.x,Jt.y,Vt,di),Gp(Ve,k.x,k.y,Bt.x,qi+Bt.y,Qt.x,Qt.y+Qt.h,h,bi,Jt.x,oi.y,Vt,di),Gp(Ve,k.x,k.y,Xt.x,qi+Xt.y,Qt.x+Qt.w,Qt.y+Qt.h,h,bi,oi.x,oi.y,Vt,di),E){const{x:kn,y:_n,z:wn}=E.anchor,[Wi,Kn,rn]=E.up;bd(tt,kn,_n,wn,Wi,Kn,rn),bd(tt,kn,_n,wn,Wi,Kn,rn),bd(tt,kn,_n,wn,Wi,Kn,rn),bd(tt,kn,_n,wn,Wi,Kn,rn),W_(r.dynamicLayoutVertexArray,kn,_n,wn,dt)}else W_(r.dynamicLayoutVertexArray,k.x,k.y,k.z,dt);Oe.emplaceBack(yi,yi+1,yi+2),Oe.emplaceBack(yi+1,yi+2,yi+3),ht.vertexLength+=4,ht.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ji[0]),It!==a.length-1&&Si===a[It+1].sectionIndex||r.programConfigurations.populatePaintArrays(Ve.length,v,v.index,{},_e,Ee,ut&&ut[Si])}const Ot=E?E.anchor:k;r.placedSymbolArray.emplaceBack(Ot.x,Ot.y,Ot.z,k.x,k.y,et,this.glyphOffsetArray.length-et,st,X,se,k.segment,h?h[0]:0,h?h[1]:0,p[0],p[1],b,0,!1,0,he,0)}_commitLayoutVertex(r,a,h,p,g,v,b){r.emplaceBack(a,h,p,g,v,Math.round(b.x),Math.round(b.y))}_addCollisionDebugVertices(r,a,h,p,g,v,b){const E=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),k=E.vertexLength,X=b.tileAnchorX,se=b.tileAnchorY;for(let _e=0;_e<4;_e++)h.collisionVertexArray.emplaceBack(0,0,0,0);h.collisionVertexArrayExt.emplaceBack(a,-r.padding,-r.padding),h.collisionVertexArrayExt.emplaceBack(a,r.padding,-r.padding),h.collisionVertexArrayExt.emplaceBack(a,r.padding,r.padding),h.collisionVertexArrayExt.emplaceBack(a,-r.padding,r.padding),this._commitLayoutVertex(h.layoutVertexArray,p,g,v,X,se,new I(r.x1,r.y1)),this._commitLayoutVertex(h.layoutVertexArray,p,g,v,X,se,new I(r.x2,r.y1)),this._commitLayoutVertex(h.layoutVertexArray,p,g,v,X,se,new I(r.x2,r.y2)),this._commitLayoutVertex(h.layoutVertexArray,p,g,v,X,se,new I(r.x1,r.y2)),E.vertexLength+=4;const he=h.indexArray;he.emplaceBack(k,k+1),he.emplaceBack(k+1,k+2),he.emplaceBack(k+2,k+3),he.emplaceBack(k+3,k),E.primitiveLength+=4}_addTextDebugCollisionBoxes(r,a,h,p,g,v){for(let b=p;b<g;b++){const E=h.get(b),k=this.getSymbolInstanceTextSize(r,v,a,b);this._addCollisionDebugVertices(E,k,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(r,a,h,p,g,v){for(let b=p;b<g;b++){const E=h.get(b),k=this.getSymbolInstanceIconSize(r,a,v.placedIconSymbolIndex);this._addCollisionDebugVertices(E,k,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,v)}}generateCollisionDebugBuffers(r,a){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new wd(mr,_m.members,na),this.iconCollisionBox=new wd(mr,_m.members,na);const h=hd(this.iconSizeData,r),p=hd(this.textSizeData,r);for(let g=0;g<this.symbolInstances.length;g++){const v=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(p,r,a,v.textBoxStartIndex,v.textBoxEndIndex,v),this._addTextDebugCollisionBoxes(p,r,a,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._addIconDebugCollisionBoxes(h,r,a,v.iconBoxStartIndex,v.iconBoxEndIndex,v),this._addIconDebugCollisionBoxes(h,r,a,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v)}}getSymbolInstanceTextSize(r,a,h,p){const g=this.text.placedSymbolArray.get(a.rightJustifiedTextSymbolIndex>=0?a.rightJustifiedTextSymbolIndex:a.centerJustifiedTextSymbolIndex>=0?a.centerJustifiedTextSymbolIndex:a.leftJustifiedTextSymbolIndex>=0?a.leftJustifiedTextSymbolIndex:a.verticalPlacedTextSymbolIndex>=0?a.verticalPlacedTextSymbolIndex:p),v=Ep(this.textSizeData,r,g)/24;return this.tilePixelRatio*v}getSymbolInstanceIconSize(r,a,h){const p=this.icon.placedSymbolArray.get(h),g=Ep(this.iconSizeData,r,p);return this.tilePixelRatio*g}_commitDebugCollisionVertexUpdate(r,a,h){r.emplaceBack(a,-h,-h),r.emplaceBack(a,h,-h),r.emplaceBack(a,h,h),r.emplaceBack(a,-h,h)}_updateTextDebugCollisionBoxes(r,a,h,p,g,v){for(let b=p;b<g;b++){const E=h.get(b),k=this.getSymbolInstanceTextSize(r,v,a,b);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,E.padding)}}_updateIconDebugCollisionBoxes(r,a,h,p,g,v){for(let b=p;b<g;b++){const E=h.get(b),k=this.getSymbolInstanceIconSize(r,a,v);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,E.padding)}}updateCollisionDebugBuffers(r,a){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const h=hd(this.iconSizeData,r),p=hd(this.textSizeData,r);for(let g=0;g<this.symbolInstances.length;g++){const v=this.symbolInstances.get(g);this._updateTextDebugCollisionBoxes(p,r,a,v.textBoxStartIndex,v.textBoxEndIndex,v),this._updateTextDebugCollisionBoxes(p,r,a,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._updateIconDebugCollisionBoxes(h,r,a,v.iconBoxStartIndex,v.iconBoxEndIndex,v.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(h,r,a,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(r,a,h,p,g,v,b,E,k){const X={};if(a<h){const{x1:se,y1:he,x2:_e,y2:Ee,padding:Oe,projectedAnchorX:Ve,projectedAnchorY:tt,projectedAnchorZ:ht,tileAnchorX:et,tileAnchorY:st,featureIndex:dt}=r.get(a);X.textBox={x1:se,y1:he,x2:_e,y2:Ee,padding:Oe,projectedAnchorX:Ve,projectedAnchorY:tt,projectedAnchorZ:ht,tileAnchorX:et,tileAnchorY:st},X.textFeatureIndex=dt}if(p<g){const{x1:se,y1:he,x2:_e,y2:Ee,padding:Oe,projectedAnchorX:Ve,projectedAnchorY:tt,projectedAnchorZ:ht,tileAnchorX:et,tileAnchorY:st,featureIndex:dt}=r.get(p);X.verticalTextBox={x1:se,y1:he,x2:_e,y2:Ee,padding:Oe,projectedAnchorX:Ve,projectedAnchorY:tt,projectedAnchorZ:ht,tileAnchorX:et,tileAnchorY:st},X.verticalTextFeatureIndex=dt}if(v<b){const{x1:se,y1:he,x2:_e,y2:Ee,padding:Oe,projectedAnchorX:Ve,projectedAnchorY:tt,projectedAnchorZ:ht,tileAnchorX:et,tileAnchorY:st,featureIndex:dt}=r.get(v);X.iconBox={x1:se,y1:he,x2:_e,y2:Ee,padding:Oe,projectedAnchorX:Ve,projectedAnchorY:tt,projectedAnchorZ:ht,tileAnchorX:et,tileAnchorY:st},X.iconFeatureIndex=dt}if(E<k){const{x1:se,y1:he,x2:_e,y2:Ee,padding:Oe,projectedAnchorX:Ve,projectedAnchorY:tt,projectedAnchorZ:ht,tileAnchorX:et,tileAnchorY:st,featureIndex:dt}=r.get(E);X.verticalIconBox={x1:se,y1:he,x2:_e,y2:Ee,padding:Oe,projectedAnchorX:Ve,projectedAnchorY:tt,projectedAnchorZ:ht,tileAnchorX:et,tileAnchorY:st},X.verticalIconFeatureIndex=dt}return X}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const h=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,a){const h=r.placedSymbolArray.get(a),p=h.vertexStartIndex+4*h.numGlyphs;for(let g=h.vertexStartIndex;g<p;g+=4)r.indexArray.emplaceBack(g,g+1,g+2),r.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const a=Math.sin(r),h=Math.cos(r),p=[],g=[],v=[];for(let b=0;b<this.symbolInstances.length;++b){v.push(b);const E=this.symbolInstances.get(b);p.push(0|Math.round(a*E.tileAnchorX+h*E.tileAnchorY)),g.push(E.featureIndex)}return v.sort((b,E)=>p[b]-p[E]||g[E]-g[b]),v}addToSortKeyRanges(r,a){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===a?h.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const h=this.symbolInstances.get(a);this.featureSortOrder.push(h.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:g,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:b,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:k}=h;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),g>=0&&g!==p&&this.addIndicesForPlacedSymbol(this.text,g),v>=0&&v!==g&&v!==p&&this.addIndicesForPlacedSymbol(this.text,v),b>=0&&this.addIndicesForPlacedSymbol(this.text,b),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ei(dl,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),dl.MAX_GLYPHS=65535,dl.addDynamicAttributes=W_;const X_=new ki({"symbol-placement":new St($t.layout_symbol["symbol-placement"]),"symbol-spacing":new St($t.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new St($t.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Lt($t.layout_symbol["symbol-sort-key"]),"symbol-z-order":new St($t.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new St($t.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new St($t.layout_symbol["icon-ignore-placement"]),"icon-optional":new St($t.layout_symbol["icon-optional"]),"icon-rotation-alignment":new St($t.layout_symbol["icon-rotation-alignment"]),"icon-size":new Lt($t.layout_symbol["icon-size"]),"icon-text-fit":new St($t.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new St($t.layout_symbol["icon-text-fit-padding"]),"icon-image":new Lt($t.layout_symbol["icon-image"]),"icon-rotate":new Lt($t.layout_symbol["icon-rotate"]),"icon-padding":new St($t.layout_symbol["icon-padding"]),"icon-keep-upright":new St($t.layout_symbol["icon-keep-upright"]),"icon-offset":new Lt($t.layout_symbol["icon-offset"]),"icon-anchor":new Lt($t.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new St($t.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new St($t.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new St($t.layout_symbol["text-rotation-alignment"]),"text-field":new Lt($t.layout_symbol["text-field"]),"text-font":new Lt($t.layout_symbol["text-font"]),"text-size":new Lt($t.layout_symbol["text-size"]),"text-max-width":new Lt($t.layout_symbol["text-max-width"]),"text-line-height":new Lt($t.layout_symbol["text-line-height"]),"text-letter-spacing":new Lt($t.layout_symbol["text-letter-spacing"]),"text-justify":new Lt($t.layout_symbol["text-justify"]),"text-radial-offset":new Lt($t.layout_symbol["text-radial-offset"]),"text-variable-anchor":new St($t.layout_symbol["text-variable-anchor"]),"text-anchor":new Lt($t.layout_symbol["text-anchor"]),"text-max-angle":new St($t.layout_symbol["text-max-angle"]),"text-writing-mode":new St($t.layout_symbol["text-writing-mode"]),"text-rotate":new Lt($t.layout_symbol["text-rotate"]),"text-padding":new St($t.layout_symbol["text-padding"]),"text-keep-upright":new St($t.layout_symbol["text-keep-upright"]),"text-transform":new Lt($t.layout_symbol["text-transform"]),"text-offset":new Lt($t.layout_symbol["text-offset"]),"text-allow-overlap":new St($t.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new St($t.layout_symbol["text-ignore-placement"]),"text-optional":new St($t.layout_symbol["text-optional"])});var $p={paint:new ki({"icon-opacity":new Lt($t.paint_symbol["icon-opacity"]),"icon-color":new Lt($t.paint_symbol["icon-color"]),"icon-halo-color":new Lt($t.paint_symbol["icon-halo-color"]),"icon-halo-width":new Lt($t.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Lt($t.paint_symbol["icon-halo-blur"]),"icon-translate":new St($t.paint_symbol["icon-translate"]),"icon-translate-anchor":new St($t.paint_symbol["icon-translate-anchor"]),"text-opacity":new Lt($t.paint_symbol["text-opacity"]),"text-color":new Lt($t.paint_symbol["text-color"],{runtimeType:On,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new Lt($t.paint_symbol["text-halo-color"]),"text-halo-width":new Lt($t.paint_symbol["text-halo-width"]),"text-halo-blur":new Lt($t.paint_symbol["text-halo-blur"]),"text-translate":new St($t.paint_symbol["text-translate"]),"text-translate-anchor":new St($t.paint_symbol["text-translate-anchor"])}),layout:X_};class Pm{constructor(r){this.type=r.property.overrides?r.property.overrides.runtimeType:Mo,this.defaultValue=r}evaluate(r){if(r.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(r.formattedSection))return a.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ei(Pm,"FormatSectionOverride",{omit:["defaultValue"]});class q_ extends va{constructor(r){super(r,$p)}recalculate(r,a){super.recalculate(r,a),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const p=[];for(const g of h)p.indexOf(g)<0&&p.push(g);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(r,a,h,p){const g=this.layout.get(r).evaluate(a,{},h,p),v=this._unevaluatedLayout._values[r];return v.isDataDriven()||no(v.value)||!g?g:(b=a.properties,g.replace(/{([^{}]+)}/g,(k,X)=>X in b?String(b[X]):""));var b}createBucket(r){return new dl(r)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const r of $p.paint.overridableProperties){if(!q_.hasPaintOverride(this.layout,r))continue;const a=this.paint.get(r),h=new Pm(a),p=new Lu(h,a.property.specification);let g=null;g="constant"===a.value.kind||"source"===a.value.kind?new Il("source",p):new Fu("composite",p,a.value.zoomStops,a.value._interpolationType),this.paint._values[r]=new Zt(a.property,g,a.parameters)}}_handleOverridablePaintPropertyUpdate(r,a,h){return!(!this.layout||a.isDataDriven()||h.isDataDriven())&&q_.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,a){const h=r.get("text-field"),p=$p.paint.properties[a];let g=!1;const v=b=>{for(const E of b)if(p.overrides&&p.overrides.hasOverride(E))return void(g=!0)};if("constant"===h.value.kind&&h.value.value instanceof Vo)v(h.value.value.sections);else if("source"===h.value.kind){const b=k=>{g||(k instanceof Eu&&an(k.value)===ti?v(k.value.sections):k instanceof Sh?v(k.sections):k.eachChild(b))},E=h.value;E._styleExpression&&b(E._styleExpression.expression)}return g}getProgramConfiguration(r){return new qc(this,r)}}var v1={paint:new ki({"background-color":new St($t.paint_background["background-color"]),"background-pattern":new St($t.paint_background["background-pattern"]),"background-opacity":new St($t.paint_background["background-opacity"])})},x1={paint:new ki({"raster-opacity":new St($t.paint_raster["raster-opacity"]),"raster-hue-rotate":new St($t.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new St($t.paint_raster["raster-brightness-min"]),"raster-brightness-max":new St($t.paint_raster["raster-brightness-max"]),"raster-saturation":new St($t.paint_raster["raster-saturation"]),"raster-contrast":new St($t.paint_raster["raster-contrast"]),"raster-resampling":new St($t.paint_raster["raster-resampling"]),"raster-fade-duration":new St($t.paint_raster["raster-fade-duration"])})};class b1 extends va{constructor(r){super(r,{}),this.implementation=r}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)}onRemove(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)}}var w1={paint:new ki({"sky-type":new St($t.paint_sky["sky-type"]),"sky-atmosphere-sun":new St($t.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new St($t.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new St($t.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new St($t.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ti($t.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new St($t.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new St($t.paint_sky["sky-atmosphere-color"]),"sky-opacity":new St($t.paint_sky["sky-opacity"])})};function Om(s,r,a){const h=[0,0,1],p=Tw([]);return Yf(p,p,a?-W(s)+Math.PI:W(s)),qf(p,p,-W(r)),td(h,h,p),ws(h,h)}const aS={circle:class extends va{constructor(s){super(s,Wf)}createBucket(s){return new Gg(s)}queryRadius(s){const r=s;return Wh("circle-radius",this,r)+Wh("circle-stroke-width",this,r)+Yg(this.paint.get("circle-translate"))}queryIntersectsFeature(s,r,a,h,p,g,v,b){const E=Ov(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,s.pixelToTileUnitsFactor),k=this.paint.get("circle-radius").evaluate(r,a)+this.paint.get("circle-stroke-width").evaluate(r,a);return Gv(s,h,g,v,b,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),E,k)}getProgramIds(){return["circle"]}getProgramConfiguration(s){return new qc(this,s)}},heatmap:class extends va{createBucket(s){return new i_(s)}constructor(s){super(s,Jf),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){"heatmap-color"===s&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=em({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(s){return Wh("heatmap-radius",this,s)}queryIntersectsFeature(s,r,a,h,p,g,v,b){const E=this.paint.get("heatmap-radius").evaluate(r,a);return Gv(s,h,g,v,b,!0,!0,new I(0,0),E)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(s){return new qc(this,s)}},hillshade:class extends va{constructor(s){super(s,Aw)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends va{constructor(s){super(s,Lw)}getProgramIds(){const s=this.paint.get("fill-pattern"),r=s&&s.constantOr(1),a=[r?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&a.push(r&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),a}getProgramConfiguration(s){return new qc(this,s)}recalculate(s,r){super.recalculate(s,r);const a=this.paint._values["fill-outline-color"];"constant"===a.value.kind&&void 0===a.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new om(s)}queryRadius(){return Yg(this.paint.get("fill-translate"))}queryIntersectsFeature(s,r,a,h,p,g){return!s.queryGeometry.isAboveHorizon&&Pv($f(s.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,s.pixelToTileUnitsFactor),h)}isTileClipped(){return!0}},"fill-extrusion":class extends va{constructor(s){super(s,l0)}createBucket(s){return new um(s)}queryRadius(){return Yg(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(s){return new qc(this,s)}queryIntersectsFeature(s,r,a,h,p,g,v,b,E){const k=Ov(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,s.pixelToTileUnitsFactor),X=this.paint.get("fill-extrusion-height").evaluate(r,a),se=this.paint.get("fill-extrusion-base").evaluate(r,a),he=[0,0],_e=b&&g.elevation,Ee=g.elevation?g.elevation.exaggeration():1,Oe=s.tile.getBucket(this);if(_e&&Oe instanceof um){const st=Oe.centroidVertexArray,dt=E+1;dt<st.length&&(he[0]=st.geta_centroid_pos0(dt),he[1]=st.geta_centroid_pos1(dt))}if(0===he[0]&&1===he[1])return!1;"globe"===g.projection.name&&(h=d_([h],[new I(0,0),new I(Zi,Zi)],s.tileID.canonical).map(st=>st.polygon).flat());const Ve=_e?b:null,[tt,ht]=(dt=h,ut=se,Ot=X,It=k,Wt=v,ii=Ve,Bt=he,Xt=Ee,Qt=g.center.lat,"globe"===(st=g).projection.name?function(oi,Vt,di,ji,bi,Si,yi,qi,kn,_n,wn){const Wi=[],Kn=[],rn=oi.projection.upVectorScale(wn,oi.center.lat,oi.worldSize).metersToTile,Cn=[0,0,0,1],Qn=[0,0,0,1],Bn=(ur,dr,Br,fo)=>{ur[0]=dr,ur[1]=Br,ur[2]=fo,ur[3]=1},rr=dm();di>0&&(di+=rr),ji+=rr;for(const ur of Vt){const dr=[],Br=[];for(const fo of ur){const Jn=fo.x+bi.x,oo=fo.y+bi.y,Zr=oi.projection.projectTilePoint(Jn,oo,wn),In=oi.projection.upVector(wn,fo.x,fo.y);let Rr=di,bo=ji;if(yi){const pr=c0(Jn,oo,di,ji,yi,qi,kn,_n);Rr+=pr.base,bo+=pr.top}0!==di?Bn(Cn,Zr.x+In[0]*rn*Rr,Zr.y+In[1]*rn*Rr,Zr.z+In[2]*rn*Rr):Bn(Cn,Zr.x,Zr.y,Zr.z),Bn(Qn,Zr.x+In[0]*rn*bo,Zr.y+In[1]*rn*bo,Zr.z+In[2]*rn*bo),Hr(Cn,Cn,Si),Hr(Qn,Qn,Si),dr.push(new cd(Cn[0],Cn[1],Cn[2])),Br.push(new cd(Qn[0],Qn[1],Qn[2]))}Wi.push(dr),Kn.push(Br)}return[Wi,Kn]}(st,dt,ut,Ot,It,Wt,ii,Bt,Xt,Qt,s.tileID.canonical):ii?function(oi,Vt,di,ji,bi,Si,yi,qi,kn){const _n=[],wn=[],Wi=[0,0,0,1];for(const Kn of oi){const rn=[],Cn=[];for(const Qn of Kn){const Bn=Qn.x+ji.x,rr=Qn.y+ji.y,ur=c0(Bn,rr,Vt,di,Si,yi,qi,kn);Wi[0]=Bn,Wi[1]=rr,Wi[2]=ur.base,Wi[3]=1,nd(Wi,Wi,bi),Wi[3]=Math.max(Wi[3],1e-5);const dr=new cd(Wi[0]/Wi[3],Wi[1]/Wi[3],Wi[2]/Wi[3]);Wi[0]=Bn,Wi[1]=rr,Wi[2]=ur.top,Wi[3]=1,nd(Wi,Wi,bi),Wi[3]=Math.max(Wi[3],1e-5);const Br=new cd(Wi[0]/Wi[3],Wi[1]/Wi[3],Wi[2]/Wi[3]);rn.push(dr),Cn.push(Br)}_n.push(rn),wn.push(Cn)}return[_n,wn]}(dt,ut,Ot,It,Wt,ii,Bt,Xt,Qt):function(oi,Vt,di,ji,bi){const Si=[],yi=[],qi=bi[8]*Vt,kn=bi[9]*Vt,_n=bi[10]*Vt,wn=bi[11]*Vt,Wi=bi[8]*di,Kn=bi[9]*di,rn=bi[10]*di,Cn=bi[11]*di;for(const Qn of oi){const Bn=[],rr=[];for(const ur of Qn){const dr=ur.x+ji.x,Br=ur.y+ji.y,fo=bi[0]*dr+bi[4]*Br+bi[12],Jn=bi[1]*dr+bi[5]*Br+bi[13],oo=bi[2]*dr+bi[6]*Br+bi[14],Zr=bi[3]*dr+bi[7]*Br+bi[15],In=fo+qi,Rr=Jn+kn,bo=oo+_n,pr=Math.max(Zr+wn,1e-5),Kr=fo+Wi,us=Jn+Kn,Fo=oo+rn,No=Math.max(Zr+Cn,1e-5);Bn.push(new cd(In/pr,Rr/pr,bo/pr)),rr.push(new cd(Kr/No,us/No,Fo/No))}Si.push(Bn),yi.push(rr)}return[Si,yi]}(dt,ut,Ot,It,Wt)),et=s.queryGeometry;var st,dt,ut,Ot,It,Wt,ii,Bt,Xt,Qt;return function(st,dt,ut){let Ot=1/0;Pv(ut,dt)&&(Ot=p_(ut,dt[0]));for(let It=0;It<dt.length;It++){const Wt=dt[It],ii=st[It];for(let Bt=0;Bt<Wt.length-1;Bt++){const Xt=Wt[Bt],Qt=[Xt,Wt[Bt+1],ii[Bt+1],ii[Bt],Xt];Cw(ut,Qt)&&(Ot=Math.min(Ot,p_(ut,Qt)))}}return Ot!==1/0&&Ot}(tt,ht,et.isPointQuery()?et.screenBounds:et.screenGeometry)}},line:class extends va{constructor(s){super(s,u0),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(s){if("line-gradient"===s){const r=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=r._styleExpression&&r._styleExpression.expression instanceof Ih,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,r){super.recalculate(s,r),this.paint._values["line-floorwidth"]=d0.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new gm(s)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(s){return new qc(this,s)}queryRadius(s){const r=s,a=Es(Wh("line-width",this,r),Wh("line-gap-width",this,r)),h=Wh("line-offset",this,r);return a/2+Math.abs(h)+Yg(this.paint.get("line-translate"))}queryIntersectsFeature(s,r,a,h,p,g){if(s.queryGeometry.isAboveHorizon)return!1;const v=$f(s.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,s.pixelToTileUnitsFactor),b=s.pixelToTileUnitsFactor/2*Es(this.paint.get("line-width").evaluate(r,a),this.paint.get("line-gap-width").evaluate(r,a)),E=this.paint.get("line-offset").evaluate(r,a);return E&&(h=function(k,X){const se=[],he=new I(0,0);for(let _e=0;_e<k.length;_e++){const Ee=k[_e],Oe=[];for(let Ve=0;Ve<Ee.length;Ve++){const tt=Ee[Ve-1],ht=Ee[Ve],et=Ee[Ve+1],st=0===Ve?he:ht.sub(tt)._unit()._perp(),dt=Ve===Ee.length-1?he:et.sub(ht)._unit()._perp(),ut=st._add(dt)._unit();ut._mult(1/(ut.x*dt.x+ut.y*dt.y)),Oe.push(ut._mult(X)._add(ht))}se.push(Oe)}return se}(h,E*s.pixelToTileUnitsFactor)),function(k,X,se){for(let he=0;he<X.length;he++){const _e=X[he];if(k.length>=3)for(let Ee=0;Ee<_e.length;Ee++)if($h(k,_e[Ee]))return!0;if(JM(k,_e,se))return!0}return!1}(v,h,b)}isTileClipped(){return!0}},symbol:q_,background:class extends va{constructor(s){super(s,v1)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends va{constructor(s){super(s,x1)}getProgramIds(){return["raster"]}},sky:class extends va{constructor(s){super(s,w1),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){"sky-gradient"===s?this._updateColorRamp():"sky-atmosphere-sun"!==s&&"sky-atmosphere-halo-color"!==s&&"sky-atmosphere-color"!==s&&"sky-atmosphere-sun-intensity"!==s||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=em({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(s){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const r=s.style.light.properties.get("position");return this._lightPosition.azimuthal!==r.azimuthal||this._lightPosition.polar!==r.polar}return!1}getCenter(s,r){if("atmosphere"===this.paint.get("sky-type")){const h=this.paint.get("sky-atmosphere-sun"),p=!h,g=s.style.light,v=g.properties.get("position");return p&&"viewport"===g.properties.get("anchor")&&De("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?Om(v.azimuthal,90-v.polar,r):Om(h[0],90-h[1],r)}const a=this.paint.get("sky-gradient-center");return Om(a[0],90-a[1],r)}is3D(){return!1}isSky(){return!0}markSkyboxValid(s){this._skyboxInvalidated=!1,this._lightPosition=s.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const s=this.paint.get("sky-type");return"atmosphere"===s?["skyboxCapture","skybox"]:"gradient"===s?["skyboxGradient"]:null}}};class Wp{constructor(r,a,h,p){this.context=r,this.format=h,this.texture=r.gl.createTexture(),this.update(a,p)}update(r,a,h){const{width:p,height:g}=r,{context:v}=this,{gl:b}=v,{HTMLImageElement:E,HTMLCanvasElement:k,HTMLVideoElement:X,ImageData:se,ImageBitmap:he}=re;if(b.bindTexture(b.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===b.RGBA&&(!a||!1!==a.premultiply)),h||this.size&&this.size[0]===p&&this.size[1]===g){const{x:_e,y:Ee}=h||{x:0,y:0};r instanceof E||r instanceof k||r instanceof X||r instanceof se||he&&r instanceof he?b.texSubImage2D(b.TEXTURE_2D,0,_e,Ee,b.RGBA,b.UNSIGNED_BYTE,r):b.texSubImage2D(b.TEXTURE_2D,0,_e,Ee,p,g,b.RGBA,b.UNSIGNED_BYTE,r.data)}else this.size=[p,g],r instanceof E||r instanceof k||r instanceof X||r instanceof se||he&&r instanceof he?b.texImage2D(b.TEXTURE_2D,0,this.format,this.format,b.UNSIGNED_BYTE,r):b.texImage2D(b.TEXTURE_2D,0,this.format,p,g,0,this.format,b.UNSIGNED_BYTE,r.data);this.useMipmap=Boolean(a&&a.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&b.generateMipmap(b.TEXTURE_2D)}bind(r,a){const{context:h}=this,{gl:p}=h;p.bindTexture(p.TEXTURE_2D,this.texture),r!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,r),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap?r===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_NEAREST:r),this.filter=r),a!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,a),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}class lS{constructor(r){this._callback=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class N0{constructor(){this.tasks={},this.taskQueue=[],ge(["process"],this),this.invoker=new lS(this.process),this.nextId=0}add(r,a){const h=this.nextId++,p=function({type:g,isSymbolTile:v,zoom:b}){return b=b||0,"message"===g?0:"maybePrepare"!==g||v?"parseTile"!==g||v?"parseTile"===g&&v?300-b:"maybePrepare"===g&&v?400-b:500:200-b:100-b}(a);if(0===p){xe();try{r()}finally{}return{cancel:()=>{}}}return this.tasks[h]={fn:r,metadata:a,priority:p,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){xe();try{if(this.taskQueue=this.taskQueue.filter(h=>!!this.tasks[h]),!this.taskQueue.length)return;const r=this.pick();if(null===r)return;const a=this.tasks[r];if(delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),!a)return;a.fn()}finally{}}pick(){let r=null,a=1/0;for(let p=0;p<this.taskQueue.length;p++){const g=this.tasks[this.taskQueue[p]];g.priority<a&&(a=g.priority,r=p)}if(null===r)return null;const h=this.taskQueue[r];return this.taskQueue.splice(r,1),h}remove(){this.invoker.remove()}}class Y_{constructor(r){this._stringToNumber={},this._numberToString=[];for(let a=0;a<r.length;a++){const h=r[a];this._stringToNumber[h]=a,this._numberToString[a]=h}}encode(r){return this._stringToNumber[r]}decode(r){return this._numberToString[r]}}const C1=["tile","layer","source","sourceLayer","state"];class Rm{constructor(r,a,h,p,g){this.type="Feature",this._vectorTileFeature=r,this._z=a,this._x=h,this._y=p,this.properties=r.properties,this.id=g}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={type:"Feature",geometry:this.geometry,properties:this.properties};void 0!==this.id&&(r.id=this.id);for(const a of C1)void 0!==this[a]&&(r[a]=this[a]);return r}}const nu=new Uint16Array(8184);for(let s=0;s<2046;s++){let r=s+2,a=0,h=0,p=0,g=0,v=0,b=0;for(1&r?p=g=v=32:a=h=b=32;(r>>=1)>1;){const k=a+p>>1,X=h+g>>1;1&r?(p=a,g=h,a=v,h=b):(a=p,h=g,p=v,g=b),v=k,b=X}const E=4*s;nu[E+0]=a,nu[E+1]=h,nu[E+2]=p,nu[E+3]=g}const Mc=new Uint16Array(2178),ru=new Uint8Array(1089),Z_=new Uint16Array(1089);function E1(s){return 0===s?-.03125:32===s?.03125:0}var M1=Ci([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const S1={type:2,extent:Zi,loadGeometry:()=>[[new I(0,0),new I(8193,0),new I(8193,8193),new I(0,8193),new I(0,0)]]};class B0{constructor(r,a,h,p,g){this.tileID=r,this.uid=M(),this.uses=0,this.tileSize=a,this.tileZoom=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=g,this.expiredRequestCount=0,this.state="loading",p&&p.transform&&(this.projection=p.transform.projection)}registerFadeDuration(r){const a=r+this.timeAdded;a<Li.now()||this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=tu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,a,h){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(p,g){const v={};if(!g)return v;for(const b of p){const E=b.layerIds.map(k=>g.getLayer(k)).filter(Boolean);if(0!==E.length){b.layers=E,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(k=>E.filter(X=>X.id===k)[0]));for(const k of E)v[k.id]=b}}return v}(r.buckets,a.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const g=this.buckets[p];if(g instanceof dl){if(this.hasSymbolBuckets=!0,!h)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const g=this.buckets[p];if(g instanceof dl&&g.hasRTLText){this.hasRTLText=!0,kt.isLoading()||kt.isLoaded()||"deferred"!==xt()||Rt();break}}this.queryPadding=0;for(const p in this.buckets){const g=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(p).queryRadius(g))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas)}else this.collisionBoxArray=new ui}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(r){return this.buckets[r.id]}upload(r){for(const h in this.buckets){const p=this.buckets[h];p.uploadPending()&&p.upload(r)}const a=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Wp(r,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Wp(r,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Wp(r,this.lineAtlas.image,a.ALPHA),this.lineAtlas.uploaded=!0)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,a,h,p,g,v,b,E){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:b,transform:v,params:g,tileTransform:this.tileTransform},r,a,h):{}}querySourceFeatures(r,a){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const p=h.loadVTLayers(),g=a?a.sourceLayer:"",v=p._geojsonTileLayer||p[g];if(!v)return;const b=uc(a&&a.filter),{z:E,x:k,y:X}=this.tileID.canonical,se={z:E,x:k,y:X};for(let he=0;he<v.length;he++){const _e=v.feature(he);if(b.needGeometry){const Ve=Gh(_e,!0);if(!b.filter(new Ct(this.tileID.overscaledZ),Ve,this.tileID.canonical))continue}else if(!b.filter(new Ct(this.tileID.overscaledZ),_e))continue;const Ee=h.getId(_e,g),Oe=new Rm(_e,E,k,X,Ee);Oe.tile=se,r.push(Oe)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const a=this.expirationTime;if(r.cacheControl){const h=Re(r.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const h=Date.now();let p=!1;if(this.expirationTime>h)p=!1;else if(a)if(this.expirationTime<a)p=!0;else{const g=this.expirationTime-a;g?this.expirationTime=h+Math.max(g,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(r,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(r).length||!a)return;const h=this.latestFeatureIndex.loadVTLayers(),p=a.style.listImages();for(const g in this.buckets){if(!a.style.hasLayer(g))continue;const v=this.buckets[g],b=v.layers[0].sourceLayer||"_geojsonTileLayer",E=h[b],k=r[b];if(!E||!k||0===Object.keys(k).length)continue;if(v.update(k,E,p,this.imageAtlas&&this.imageAtlas.patternPositions||{}),v instanceof gm||v instanceof om){const se=a.style._getSourceCache(v.layers[0].source);a._terrain&&a._terrain.enabled&&se&&v.programConfigurations.needsUpload&&a._terrain._clearRenderCacheForTile(se.id,this.tileID)}const X=a&&a.style&&a.style.getLayer(g);X&&(this.queryPadding=Math.max(this.queryPadding,X.queryRadius(v)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Li.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=Li.now()+r}setTexture(r,a){const h=a.context,p=h.gl;this.texture=this.texture||a.getTileTexture(r.width),this.texture?this.texture.update(r,{useMipmap:!0}):(this.texture=new Wp(h,r,p.RGBA,{useMipmap:!0}),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE),h.extTextureFilterAnisotropic&&p.texParameterf(p.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax))}setDependencies(r,a){const h={};for(const p of a)h[p]=!0;this.dependencies[r]=h}hasDependency(r,a){for(const h of r){const p=this.dependencies[h];if(p)for(const g of a)if(p[g])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,a){if(!a||"mercator"===a.name||this._tileDebugBuffer)return;const h=_c(S1,this.tileID.canonical,this.tileTransform)[0],p=new Un,g=new Ll;for(let v=0;v<h.length;v++){const{x:b,y:E}=h[v];p.emplaceBack(b,E),g.emplaceBack(v)}g.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(g),this._tileDebugBuffer=r.createVertexBuffer(p,Fp.members),this._tileDebugSegments=ro.simpleSegment(0,0,p.length,g.length)}_makeTileBoundsBuffers(r,a){if(this._tileBoundsBuffer||!a||"mercator"===a.name)return;const h=_c(S1,this.tileID.canonical,this.tileTransform)[0];let p,g;if(this.isRaster){const v=function(b,E){const k=tu(b,E),X=Math.pow(2,b.z);for(let Ve=0;Ve<33;Ve++)for(let tt=0;tt<33;tt++){const ht=cs((b.x+(tt+E1(tt))/32)/X),et=Xo((b.y+(Ve+E1(Ve))/32)/X),st=E.project(ht,et),dt=33*Ve+tt;Mc[2*dt+0]=Math.round((st.x*k.scale-k.x)*Zi),Mc[2*dt+1]=Math.round((st.y*k.scale-k.y)*Zi)}ru.fill(0),Z_.fill(0);for(let Ve=2045;Ve>=0;Ve--){const tt=4*Ve,ht=nu[tt+0],et=nu[tt+1],st=nu[tt+2],dt=nu[tt+3],ut=ht+st>>1,Ot=et+dt>>1,It=ut+Ot-et,Wt=Ot+ht-ut,ii=33*et+ht,Bt=33*dt+st,Xt=33*Ot+ut,Qt=Math.hypot((Mc[2*ii+0]+Mc[2*Bt+0])/2-Mc[2*Xt+0],(Mc[2*ii+1]+Mc[2*Bt+1])/2-Mc[2*Xt+1])>=16;if(ru[Xt]=ru[Xt]||(Qt?1:0),Ve<1022){const Jt=33*(et+Wt>>1)+(ht+It>>1),oi=33*(dt+Wt>>1)+(st+It>>1);ru[Xt]=ru[Xt]||ru[Jt]||ru[oi]}}const se=new tr,he=new Oo;let _e=0;function Ee(Ve,tt){const ht=33*tt+Ve;return 0===Z_[ht]&&(se.emplaceBack(Mc[2*ht+0],Mc[2*ht+1],Ve*Zi/32,tt*Zi/32),Z_[ht]=++_e),Z_[ht]-1}function Oe(Ve,tt,ht,et,st,dt){const ut=Ve+ht>>1,Ot=tt+et>>1;if(Math.abs(Ve-st)+Math.abs(tt-dt)>1&&ru[33*Ot+ut])Oe(st,dt,Ve,tt,ut,Ot),Oe(ht,et,st,dt,ut,Ot);else{const It=Ee(Ve,tt),Wt=Ee(ht,et),ii=Ee(st,dt);he.emplaceBack(It,Wt,ii)}}return Oe(0,0,32,32,32,0),Oe(32,32,0,0,0,32),{vertices:se,indices:he}}(this.tileID.canonical,a);p=v.vertices,g=v.indices}else{p=new tr,g=new Oo;for(const{x:b,y:E}of h)p.emplaceBack(b,E,0,0);const v=_p.exports(p.int16,void 0,4);for(let b=0;b<v.length;b+=3)g.emplaceBack(v[b],v[b+1],v[b+2])}this._tileBoundsBuffer=r.createVertexBuffer(p,M1.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(g),this._tileBoundsSegments=ro.simpleSegment(0,0,p.length,g.length)}_makeGlobeTileDebugBuffers(r,a){const h=a.projection;if(!h||"globe"!==h.name||a.freezeTileCoverage)return;const p=this.tileID.canonical,g=zp(N_(p,a)),v=yd(a.zoom);let b;v>0&&(b=Qu(new Float64Array(16),a.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,p,a,g,b,v),this._makeGlobeTileDebugTextBuffer(r,p,a,g,b,v)}_globePoint(r,a,h,p,g,v,b){let E=Tm(r,a,h);if(v){const k=1<<h.z,X=al(p.center.lng),se=nr(p.center.lat),he=(h.x+.5)/k-X;let _e=0;he>.5?_e=-1:he<-.5&&(_e=1);let Ee=(r/Zi+h.x)/k+_e,Oe=(a/Zi+h.y)/k;Ee=(Ee-X)*p._pixelsPerMercatorPixel+X,Oe=(Oe-se)*p._pixelsPerMercatorPixel+se;const Ve=[Ee*p.worldSize,Oe*p.worldSize,0];Hr(Ve,Ve,v),E=_d(E,Ve,b)}return Hr(E,E,g)}_makeGlobeTileDebugBorderBuffer(r,a,h,p,g,v){const b=new Un,E=new Ll,k=new cr,X=(he,_e,Ee,Oe,Ve)=>{const tt=(Ee-he)/(Ve-1),ht=(Oe-_e)/(Ve-1),et=b.length;for(let st=0;st<Ve;st++){const dt=he+st*tt,ut=_e+st*ht;b.emplaceBack(dt,ut);const Ot=this._globePoint(dt,ut,a,h,p,g,v);k.emplaceBack(Ot[0],Ot[1],Ot[2]),E.emplaceBack(et+st)}},se=Zi;X(0,0,se,0,16),X(se,0,se,se,16),X(se,se,0,se,16),X(0,se,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(E),this._tileDebugBuffer=r.createVertexBuffer(b,Fp.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(k,k0.members),this._tileDebugSegments=ro.simpleSegment(0,0,b.length,E.length)}_makeGlobeTileDebugTextBuffer(r,a,h,p,g,v){const b=new Un,E=new Oo,k=new cr,X=25;E.reserve(32),b.reserve(X),k.reserve(X);const se=(he,_e)=>X*he+_e;for(let he=0;he<X;he++){const _e=2048*he;for(let Ee=0;Ee<X;Ee++){const Oe=2048*Ee;b.emplaceBack(Oe,_e);const Ve=this._globePoint(Oe,_e,a,h,p,g,v);k.emplaceBack(Ve[0],Ve[1],Ve[2])}}for(let he=0;he<4;he++)for(let _e=0;_e<4;_e++){const Ee=se(he,_e),Oe=se(he,_e+1),Ve=se(he+1,_e),tt=se(he+1,_e+1);E.emplaceBack(Ee,Oe,Ve),E.emplaceBack(Ve,Oe,tt)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(E),this._tileDebugTextBuffer=r.createVertexBuffer(b,Fp.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(k,k0.members),this._tileDebugTextSegments=ro.simpleSegment(0,0,X,32)}}class lh{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,a,h){const p=String(a);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][p]=this.stateChanges[r][p]||{},S(this.stateChanges[r][p],h),null===this.deletedStates[r]){this.deletedStates[r]={};for(const g in this.state[r])g!==p&&(this.deletedStates[r][g]=null)}else if(this.deletedStates[r]&&null===this.deletedStates[r][p]){this.deletedStates[r][p]={};for(const g in this.state[r][p])h[g]||(this.deletedStates[r][p][g]=null)}else for(const g in h)this.deletedStates[r]&&this.deletedStates[r][p]&&null===this.deletedStates[r][p][g]&&delete this.deletedStates[r][p][g]}removeFeatureState(r,a,h){if(null===this.deletedStates[r])return;const p=String(a);if(this.deletedStates[r]=this.deletedStates[r]||{},h&&void 0!==a)null!==this.deletedStates[r][p]&&(this.deletedStates[r][p]=this.deletedStates[r][p]||{},this.deletedStates[r][p][h]=null);else if(void 0!==a)if(this.stateChanges[r]&&this.stateChanges[r][p])for(h in this.deletedStates[r][p]={},this.stateChanges[r][p])this.deletedStates[r][p][h]=null;else this.deletedStates[r][p]=null;else this.deletedStates[r]=null}getState(r,a){const h=String(a),p=S({},(this.state[r]||{})[h],(this.stateChanges[r]||{})[h]);if(null===this.deletedStates[r])return{};if(this.deletedStates[r]){const g=this.deletedStates[r][a];if(null===g)return{};for(const v in g)delete p[v]}return p}initializeTileState(r,a){r.setFeatureState(this.state,a)}coalesceChanges(r,a){const h={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const g={};for(const v in this.stateChanges[p])this.state[p][v]||(this.state[p][v]={}),S(this.state[p][v],this.stateChanges[p][v]),g[v]=this.state[p][v];h[p]=g}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const g={};if(null===this.deletedStates[p])for(const v in this.state[p])g[v]={},this.state[p][v]={};else for(const v in this.deletedStates[p]){if(null===this.deletedStates[p][v])this.state[p][v]={};else for(const b of Object.keys(this.deletedStates[p][v]))delete this.state[p][v][b];g[v]=this.state[p][v]}h[p]=h[p]||{},S(h[p],g)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(h).length)for(const p in r)r[p].setFeatureState(h,a)}}class Lm{constructor(r){this.size=r,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(r,a){const h=this.toIdx(r,a);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(r,a){return this.leaves[this.toIdx(r,a)]}toIdx(r,a){return a*this.size+r}}function z0(s,r,a,h){let p=0,g=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(h[v])<1e-15){if(a[v]<s[v]||a[v]>r[v])return null}else{const b=1/h[v];let E=(s[v]-a[v])*b,k=(r[v]-a[v])*b;if(E>k){const X=E;E=k,k=X}if(E>p&&(p=E),k<g&&(g=k),p>g)return null}return p}function K_(s,r,a,h,p,g,v,b,E,k,X){const se=h-s,he=p-r,_e=g-a,Ee=v-s,Oe=b-r,Ve=E-a,tt=X[1]*Ve-X[2]*Oe,ht=X[2]*Ee-X[0]*Ve,et=X[0]*Oe-X[1]*Ee,st=se*tt+he*ht+_e*et;if(Math.abs(st)<1e-15)return null;const dt=1/st,ut=k[0]-s,Ot=k[1]-r,It=k[2]-a,Wt=(ut*tt+Ot*ht+It*et)*dt;if(Wt<0||Wt>1)return null;const ii=Ot*_e-It*he,Bt=It*se-ut*_e,Xt=ut*he-Ot*se,Qt=(X[0]*ii+X[1]*Bt+X[2]*Xt)*dt;return Qt<0||Wt+Qt>1?null:(Ee*ii+Oe*Bt+Ve*Xt)*dt}function Fm(s,r,a){return(s-r)/(a-r)}function Q_(s,r,a,h,p,g,v,b,E){const k=1<<a,X=g-h,se=v-p,he=(s+1)/k*X+h,_e=(r+0)/k*se+p,Ee=(r+1)/k*se+p;b[0]=(s+0)/k*X+h,b[1]=_e,E[0]=he,E[1]=Ee}class Nm{constructor(r){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=r,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const a=function(g){const v=Math.ceil(Math.log2(g.dim/8)),b=[];let E=Math.ceil(Math.pow(2,v));const k=1/E,X=(_e,Ee,Oe,Ve,tt)=>{const ht=Ve?1:0,et=(_e+1)*Oe-ht,st=Ee*Oe,dt=(Ee+1)*Oe-ht;tt[0]=_e*Oe,tt[1]=st,tt[2]=et,tt[3]=dt};let se=new Lm(E);const he=[];for(let _e=0;_e<E*E;_e++){X(_e%E,Math.floor(_e/E),k,!1,he);const Ee=Vs(he[0],he[1],g),Oe=Vs(he[2],he[1],g),Ve=Vs(he[2],he[3],g),tt=Vs(he[0],he[3],g);se.minimums.push(Math.min(Ee,Oe,Ve,tt)),se.maximums.push(Math.max(Ee,Oe,Ve,tt)),se.leaves.push(1)}for(b.push(se),E/=2;E>=1;E/=2){const _e=b[b.length-1];se=new Lm(E);for(let Ee=0;Ee<E*E;Ee++){X(Ee%E,Math.floor(Ee/E),2,!0,he);const Oe=_e.getElevation(he[0],he[1]),Ve=_e.getElevation(he[2],he[1]),tt=_e.getElevation(he[2],he[3]),ht=_e.getElevation(he[0],he[3]),et=_e.isLeaf(he[0],he[1]),st=_e.isLeaf(he[2],he[1]),dt=_e.isLeaf(he[2],he[3]),ut=_e.isLeaf(he[0],he[3]),Ot=Math.min(Oe.min,Ve.min,tt.min,ht.min),It=Math.max(Oe.max,Ve.max,tt.max,ht.max),Wt=et&&st&&dt&&ut;se.maximums.push(It),se.minimums.push(Ot),se.leaves.push(It-Ot<=5&&Wt?1:0)}b.push(se)}return b}(this.dem),h=a.length-1,p=a[h];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(a,0,0,h,0)}raycastRoot(r,a,h,p,g,v,b=1){return z0([r,a,-100],[h,p,this.maximums[0]*b],g,v)}raycast(r,a,h,p,g,v,b=1){if(!this.nodeCount)return null;const E=this.raycastRoot(r,a,h,p,g,v,b);if(null==E)return null;const k=[],X=[],se=[],he=[],_e=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;_e.length>0;){const{idx:Ee,t:Oe,nodex:Ve,nodey:tt,depth:ht}=_e.pop();if(this.leaves[Ee]){Q_(Ve,tt,ht,r,a,h,p,se,he);const st=1<<ht,dt=(Ve+0)/st,ut=(Ve+1)/st,Ot=(tt+0)/st,It=(tt+1)/st,Wt=Vs(dt,Ot,this.dem)*b,ii=Vs(ut,Ot,this.dem)*b,Bt=Vs(ut,It,this.dem)*b,Xt=Vs(dt,It,this.dem)*b,Qt=K_(se[0],se[1],Wt,he[0],se[1],ii,he[0],he[1],Bt,g,v),Jt=K_(he[0],he[1],Bt,se[0],he[1],Xt,se[0],se[1],Wt,g,v),oi=Math.min(null!==Qt?Qt:Number.MAX_VALUE,null!==Jt?Jt:Number.MAX_VALUE);if(oi!==Number.MAX_VALUE)return oi;{const Vt=ed([],g,v,Oe);if(V0(Wt,ii,Xt,Bt,Fm(Vt[0],se[0],he[0]),Fm(Vt[1],se[1],he[1]))>=Vt[2])return Oe}continue}let et=0;for(let st=0;st<this._siblingOffset.length;st++){Q_((Ve<<1)+this._siblingOffset[st][0],(tt<<1)+this._siblingOffset[st][1],ht+1,r,a,h,p,se,he),se[2]=-100,he[2]=this.maximums[this.childOffsets[Ee]+st]*b;const dt=z0(se,he,g,v);if(null!=dt){const ut=dt;k[st]=ut;let Ot=!1;for(let It=0;It<et&&!Ot;It++)ut>=k[X[It]]&&(X.splice(It,0,st),Ot=!0);Ot||(X[et]=st),et++}}for(let st=0;st<et;st++){const dt=X[st];_e.push({idx:this.childOffsets[Ee]+dt,t:k[dt],nodex:(Ve<<1)+this._siblingOffset[dt][0],nodey:(tt<<1)+this._siblingOffset[dt][1],depth:ht+1})}}return null}_addNode(r,a,h){return this.minimums.push(r),this.maximums.push(a),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(r,a,h,p,g){if(1===r[p].isLeaf(a,h))return;this.childOffsets[g]||(this.childOffsets[g]=this.nodeCount);const v=p-1,b=r[v];let E=0,k=0;for(let X=0;X<this._siblingOffset.length;X++){const se=2*a+this._siblingOffset[X][0],he=2*h+this._siblingOffset[X][1],_e=b.getElevation(se,he),Ee=b.isLeaf(se,he),Oe=this._addNode(_e.min,_e.max,Ee);Ee&&(E|=1<<X),k||(k=Oe)}for(let X=0;X<this._siblingOffset.length;X++)E&1<<X||this._construct(r,2*a+this._siblingOffset[X][0],2*h+this._siblingOffset[X][1],v,k+X)}}function V0(s,r,a,h,p,g){return ci(ci(s,a,g),ci(r,h,g),p)}function Vs(s,r,a){const h=a.dim,p=D(s*h-.5,0,h-1),g=D(r*h-.5,0,h-1),v=Math.floor(p),b=Math.floor(g),E=Math.min(v+1,h-1),k=Math.min(b+1,h-1);return V0(a.get(v,b),a.get(E,b),a.get(v,k),a.get(E,k),p-v,g-b)}const J_={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Bm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(r,a,h,p=!1,g=!1){if(this.uid=r,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(h&&"mapbox"!==h&&"terrarium"!==h)return De(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const v=this.dim=a.height-2,b=new Uint32Array(a.data.buffer);if(this.pixels=new Uint8Array(a.data.buffer),this.encoding=h||"mapbox",this.borderReady=p,!p){for(let E=0;E<v;E++)b[this._idx(-1,E)]=b[this._idx(0,E)],b[this._idx(v,E)]=b[this._idx(v-1,E)],b[this._idx(E,-1)]=b[this._idx(E,0)],b[this._idx(E,v)]=b[this._idx(E,v-1)];b[this._idx(-1,-1)]=b[this._idx(0,0)],b[this._idx(v,-1)]=b[this._idx(v-1,0)],b[this._idx(-1,v)]=b[this._idx(0,v-1)],b[this._idx(v,v)]=b[this._idx(v-1,v-1)],g&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Nm(this)}get(r,a,h=!1){h&&(r=D(r,-1,this.dim),a=D(a,-1,this.dim));const p=4*this._idx(r,a);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(this.pixels[p],this.pixels[p+1],this.pixels[p+2])}static getUnpackVector(r){return J_[r]}get unpackVector(){return J_[this.encoding]}_idx(r,a){if(r<-1||r>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(r+1)}_unpackMapbox(r,a,h){return(256*r*256+256*a+h)/10-1e4}_unpackTerrarium(r,a,h){return 256*r+a+h/256-32768}static pack(r,a){const h=[0,0,0,0],p=Bm.getUnpackVector(a);let g=Math.floor((r+p[3])/p[2]);return h[2]=g%256,g=Math.floor(g/256),h[1]=g%256,g=Math.floor(g/256),h[0]=g,h}getPixels(){return new oa({width:this.stride,height:this.stride},this.pixels)}backfillBorder(r,a,h){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let p=a*this.dim,g=a*this.dim+this.dim,v=h*this.dim,b=h*this.dim+this.dim;switch(a){case-1:p=g-1;break;case 1:g=p+1}switch(h){case-1:v=b-1;break;case 1:b=v+1}const E=-a*this.dim,k=-h*this.dim;for(let X=v;X<b;X++)for(let se=p;se<g;se++){const he=4*this._idx(se,X),_e=4*this._idx(se+E,X+k);this.pixels[he+0]=r.pixels[_e+0],this.pixels[he+1]=r.pixels[_e+1],this.pixels[he+2]=r.pixels[_e+2],this.pixels[he+3]=r.pixels[_e+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Ei(Bm,"DEMData"),Ei(Nm,"DemMinMaxQuadTree",{omit:["dem"]});class T1{constructor(r,a){this.max=r,this.onRemove=a,this.reset()}reset(){for(const r in this.data)for(const a of this.data[r])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(r,a,h){const p=r.wrapped().key;void 0===this.data[p]&&(this.data[p]=[]);const g={value:a,timeout:void 0};if(void 0!==h&&(g.timeout=setTimeout(()=>{this.remove(r,g)},h)),this.data[p].push(g),this.order.push(p),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const a=this.data[r].shift();return a.timeout&&clearTimeout(a.timeout),0===this.data[r].length&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),a.value}getByKey(r){const a=this.data[r];return a?a[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,a){if(!this.has(r))return this;const h=r.wrapped().key,p=void 0===a?0:this.data[h].indexOf(a),g=this.data[h][p];return this.data[h].splice(p,1),g.timeout&&clearTimeout(g.timeout),0===this.data[h].length&&delete this.data[h],this.onRemove(g.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(r){const a=[];for(const h in this.data)for(const p of this.data[h])r(p.value)||a.push(p);for(const h of a)this.remove(h.value.tileID,h)}}class ou{constructor(r,a,h){this.func=r,this.mask=a,this.range=h}}ou.ReadOnly=!1,ou.ReadWrite=!0,ou.disabled=new ou(519,ou.ReadOnly,[0,1]);class ty{constructor(r,a,h,p,g,v){this.test=r,this.ref=a,this.mask=h,this.fail=p,this.depthFail=g,this.pass=v}}ty.disabled=new ty({func:519,mask:0},0,0,7680,7680,7680);class Ca{constructor(r,a,h){this.blendFunction=r,this.blendColor=a,this.mask=h}}Ca.Replace=[1,0],Ca.disabled=new Ca(Ca.Replace,Ur.transparent,[!1,!1,!1,!1]),Ca.unblended=new Ca(Ca.Replace,Ur.transparent,[!0,!0,!0,!0]),Ca.alphaBlended=new Ca([1,771],Ur.transparent,[!0,!0,!0,!0]);class Ss{constructor(r,a,h){this.enable=r,this.mode=a,this.frontFace=h}}Ss.disabled=new Ss(!1,1029,2305),Ss.backCCW=new Ss(!0,1029,2305),Ss.backCW=new Ss(!0,1029,2304),Ss.frontCW=new Ss(!0,1028,2304),Ss.frontCCW=new Ss(!0,1028,2305);class ql extends Ws{constructor(r,a,h){super(),this.id=r,this._onlySymbols=h,a.on("data",p=>{"source"===p.dataType&&"metadata"===p.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===p.dataType&&"content"===p.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),a.on("error",()=>{this._sourceErrored=!0}),this._source=a,this._tiles={},this._cache=new T1(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=a.minTileCacheSize,this._maxTileCacheSize=a.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new lh,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(r){this.map=r,this._minTileCacheSize=void 0===this._minTileCacheSize&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const a=this._tiles[r];if("loaded"!==a.state&&"errored"!==a.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,a){return r.isSymbolTile=this._onlySymbols,this._source.loadTile(r,a)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r,()=>{})}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r,()=>{})}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const h=this._tiles[a];h.upload(r),h.prepare(this.map.style.imageManager)}}getIds(){return T(this._tiles).map(r=>r.tileID).sort(Cd).map(r=>r.key)}getRenderableIds(r){const a=[];for(const h in this._tiles)this._isIdRenderable(+h,r)&&a.push(this._tiles[h]);return r?a.sort((h,p)=>{const g=h.tileID,v=p.tileID,b=new I(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),E=new I(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-v.overscaledZ||E.y-b.y||E.x-b.x}).map(h=>h.tileID.key):a.map(h=>h.tileID).sort(Cd).map(h=>h.key)}hasRenderableParent(r){const a=this.findLoadedParent(r,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(r,a){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(a||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)"errored"!==this._tiles[r].state&&this._reloadTile(+r,"reloading")}}_reloadTile(r,a){const h=this._tiles[r];h&&("loading"!==h.state&&(h.state=a),this._loadTile(h,this._tileLoaded.bind(this,h,r,a)))}_tileLoaded(r,a,h,p){if(p)if(r.state="errored",404!==p.status)this._source.fire(new bl(p,{tile:r}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const g=this.map.painter.terrain;this.update(this.transform,g.getScaledDemTileSize(),!0),g.resetTileLookupCache(this.id)}else this.update(this.transform);else r.timeAdded=Li.now(),"expired"===h&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(a,r),"raster-dem"===this._source.type&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new Pa("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const a=this.getRenderableIds();for(let p=0;p<a.length;p++){const g=a[p];if(r.neighboringTiles&&r.neighboringTiles[g]){const v=this.getTileByID(g);h(r,v),h(v,r)}}function h(p,g){if(!p.dem||p.dem.borderReady)return;p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0;let v=g.tileID.canonical.x-p.tileID.canonical.x;const b=g.tileID.canonical.y-p.tileID.canonical.y,E=Math.pow(2,p.tileID.canonical.z),k=g.tileID.key;0===v&&0===b||Math.abs(b)>1||(Math.abs(v)>1&&(1===Math.abs(v+E)?v+=E:1===Math.abs(v-E)&&(v-=E)),g.dem&&p.dem&&(p.dem.backfillBorder(g.dem,v,b),p.neighboringTiles&&p.neighboringTiles[k]&&(p.neighboringTiles[k].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,a,h,p){for(const g in this._tiles){let v=this._tiles[g];if(p[g]||!v.hasData()||v.tileID.overscaledZ<=a||v.tileID.overscaledZ>h)continue;let b=v.tileID;for(;v&&v.tileID.overscaledZ>a+1;){const k=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[k.key],v&&v.hasData()&&(b=k)}let E=b;for(;E.overscaledZ>a;)if(E=E.scaledTo(E.overscaledZ-1),r[E.key]){p[b.key]=b;break}}}findLoadedParent(r,a){if(r.key in this._loadedParentTiles){const h=this._loadedParentTiles[r.key];return h&&h.tileID.overscaledZ>=a?h:null}for(let h=r.overscaledZ-1;h>=a;h--){const p=r.scaledTo(h),g=this._getLoadedTile(p);if(g)return g}}_getLoadedTile(r){const a=this._tiles[r.key];return a&&a.hasData()?a:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,a){a=a||this._source.tileSize;const h=Math.ceil(r.width/a)+1,p=Math.ceil(r.height/a)+1,g=Math.floor(h*p*5),v="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,g):g,b="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(b)}handleWrapJump(r){const a=Math.round((r-(void 0===this._prevLng?r:this._prevLng))/360);if(this._prevLng=r,a){const h={};for(const p in this._tiles){const g=this._tiles[p];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+a),h[g.tileID.key]=g}this._tiles=h;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(+p,this._tiles[p])}}update(r,a,h){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!h)return;let p;this.updateCacheSize(r,a),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(b=>new $r(b.canonical.z,b.wrap,b.canonical.z,b.canonical.x,b.canonical.y)):(p=r.coveringTiles({tileSize:a||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!h,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(p=p.filter(b=>this._source.hasTile(b)))):p=[];const g=this._updateRetainedTiles(p);if(j0(this._source.type)&&0!==p.length){const b={},E={},k=Object.keys(g);for(const se of k){const he=g[se],_e=this._tiles[se];if(!_e||_e.fadeEndTime&&_e.fadeEndTime<=Li.now())continue;const Ee=this.findLoadedParent(he,Math.max(he.overscaledZ-ql.maxOverzooming,this._source.minzoom));Ee&&(this._addTile(Ee.tileID),b[Ee.tileID.key]=Ee.tileID),E[se]=he}const X=p[p.length-1].overscaledZ;for(const se in this._tiles){const he=this._tiles[se];if(g[se]||!he.hasData())continue;let _e=he.tileID;for(;_e.overscaledZ>X;){_e=_e.scaledTo(_e.overscaledZ-1);const Ee=this._tiles[_e.key];if(Ee&&Ee.hasData()&&E[_e.key]){g[se]=he.tileID;break}}}for(const se in b)g[se]||(this._coveredTiles[se]=!0,g[se]=b[se])}for(const b in g)this._tiles[b].clearFadeHold();const v=function(b,E){const k=[];for(const X in b)X in E||k.push(X);return k}(this._tiles,g);for(const b of v){const E=this._tiles[b];E.hasSymbolBuckets&&!E.holdingForFade()?E.setHoldDuration(this.map._fadeDuration):E.hasSymbolBuckets&&!E.symbolFadeFinished()||this._removeTile(+b)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const a={};if(0===r.length)return a;const h={},p=r.reduce((k,X)=>Math.min(k,X.overscaledZ),1/0),g=r[0].overscaledZ,v=Math.max(g-ql.maxOverzooming,this._source.minzoom),b=Math.max(g+ql.maxUnderzooming,this._source.minzoom),E={};for(const k of r){const X=this._addTile(k);a[k.key]=k,X.hasData()||p<this._source.maxzoom&&(E[k.key]=k)}this._retainLoadedChildren(E,p,b,a);for(const k of r){let X=this._tiles[k.key];if(X.hasData())continue;if(k.canonical.z>=this._source.maxzoom){const he=k.children(this._source.maxzoom)[0],_e=this.getTile(he);if(_e&&_e.hasData()){a[he.key]=he;continue}}else{const he=k.children(this._source.maxzoom);if(a[he[0].key]&&a[he[1].key]&&a[he[2].key]&&a[he[3].key])continue}let se=X.wasRequested();for(let he=k.overscaledZ-1;he>=v;--he){const _e=k.scaledTo(he);if(h[_e.key]||(h[_e.key]=!0,X=this.getTile(_e),!X&&se&&(X=this._addTile(_e)),X&&(a[_e.key]=_e,se=X.wasRequested(),X.hasData())))break}}return a}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const a=[];let h,p=this._tiles[r].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){h=this._loadedParentTiles[p.key];break}a.push(p.key);const g=p.scaledTo(p.overscaledZ-1);if(h=this._getLoadedTile(g),h)break;p=g}for(const g of a)this._loadedParentTiles[g]=h}}_addTile(r){let a=this._tiles[r.key];if(a)return a;a=this._cache.getAndRemove(r),a&&(this._setTileReloadTimer(r.key,a),a.tileID=r,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,a)));const h=Boolean(a);if(!h){const p=this.map?this.map.painter:null;a=new B0(r,this._source.tileSize*r.overscaleFactor(),this.transform.tileZoom,p,this._isRaster),this._loadTile(a,this._tileLoaded.bind(this,a,r.key,a.state))}return a?(a.uses++,this._tiles[r.key]=a,h||this._source.fire(new Pa("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a):null}_setTileReloadTimer(r,a){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const h=a.getExpiryTimeout();h&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},h))}_removeTile(r){const a=this._tiles[r];a&&(a.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),a.uses>0||(a.hasData()&&"reloading"!==a.state?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,a,h){const p=[],g=this.transform;if(!g)return p;const v="globe"===g.projection.name,b=al(g.center.lng);for(const E in this._tiles){const k=this._tiles[E];if(h&&k.clearQueryDebugViz(),k.holdingForFade())continue;let X;if(v){const se=k.tileID.canonical;if(0===se.z){const he=[Math.abs(D(b,...Ed(se,-1))-b),Math.abs(D(b,...Ed(se,1))-b)];X=[0,2*he.indexOf(Math.min(...he))-1]}else{const he=[Math.abs(D(b,...Ed(se,-1))-b),Math.abs(D(b,...Ed(se,0))-b),Math.abs(D(b,...Ed(se,1))-b)];X=[he.indexOf(Math.min(...he))-1]}}else X=[0];for(const se of X){const he=r.containsTile(k,g,a,se);he&&p.push(he)}}return p}getVisibleCoordinates(r){const a=this.getRenderableIds(r).map(h=>this._tiles[h].tileID);for(const h of a)h.projMatrix=this.transform.calculateProjMatrix(h.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(j0(this._source.type))for(const r in this._tiles){const a=this._tiles[r];if(void 0!==a.fadeEndTime&&a.fadeEndTime>=Li.now())return!0}return!1}setFeatureState(r,a,h){this._state.updateState(r=r||"_geojsonTileLayer",a,h)}removeFeatureState(r,a,h){this._state.removeFeatureState(r=r||"_geojsonTileLayer",a,h)}getFeatureState(r,a){return this._state.getState(r=r||"_geojsonTileLayer",a)}setDependencies(r,a,h){const p=this._tiles[r];p&&p.setDependencies(a,h)}reloadTilesForDependencies(r,a){for(const h in this._tiles)this._tiles[h].hasDependency(r,a)&&this._reloadTile(+h,"reloading");this._cache.filter(h=>!h.hasDependency(r,a))}_preloadTiles(r,a){const h=new Map,p=Array.isArray(r)?r:[r],g=this.map.painter.terrain,v=this.usedForTerrain&&g?g.getScaledDemTileSize():this._source.tileSize;for(const b of p){const E=b.coveringTiles({tileSize:v,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const k of E)h.set(k.key,k);this.usedForTerrain&&b.updateElevation(!1)}U(Array.from(h.values()),(b,E)=>{const k=new B0(b,this._source.tileSize*b.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(k,X=>{"raster-dem"===this._source.type&&k.dem&&this._backfillDEM(k),E(X,k)})},a)}}function Cd(s,r){const a=Math.abs(2*s.wrap)-+(s.wrap<0),h=Math.abs(2*r.wrap)-+(r.wrap<0);return s.overscaledZ-r.overscaledZ||h-a||r.canonical.y-s.canonical.y||r.canonical.x-s.canonical.x}function j0(s){return"raster"===s||"image"===s||"video"===s||"custom"===s}function Ed(s,r){const a=1<<s.z;return[s.x/a+r,(s.x+1)/a+r]}ql.maxOverzooming=10,ql.maxUnderzooming=3;class qp{constructor(r,a,h){this._demTile=r,this._dem=this._demTile.dem,this._scale=a,this._offset=h}static create(r,a,h){const p=h||r.findDEMTileFor(a);if(!p||!p.dem)return;const g=p.dem,v=p.tileID,b=1<<a.canonical.z-v.canonical.z;return new qp(p,p.tileSize/Zi/b,[(a.canonical.x/b-v.canonical.x)*g.dim,(a.canonical.y/b-v.canonical.y)*g.dim])}tileCoordToPixel(r,a){const h=a*this._scale+this._offset[1],p=Math.floor(r*this._scale+this._offset[0]),g=Math.floor(h);return new I(p,g)}getElevationAt(r,a,h,p){const g=r*this._scale+this._offset[0],v=a*this._scale+this._offset[1],b=Math.floor(g),E=Math.floor(v),k=this._dem;return p=!!p,h?ci(ci(k.get(b,E,p),k.get(b,E+1,p),v-E),ci(k.get(b+1,E,p),k.get(b+1,E+1,p),v-E),g-b):k.get(b,E,p)}getElevationAtPixel(r,a,h){return this._dem.get(r,a,!!h)}getMeterToDEM(r){return(1<<this._demTile.tileID.canonical.z)*ra(1,r)*this._dem.stride}}class zm{constructor(r,a){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Bh(Zi,16,0),this.featureIndexArray=new qu,this.promoteId=a}insert(r,a,h,p,g,v=0){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,p,g,v);const E=this.grid;for(let k=0;k<a.length;k++){const X=a[k],se=[1/0,1/0,-1/0,-1/0];for(let he=0;he<X.length;he++){const _e=X[he];se[0]=Math.min(se[0],_e.x),se[1]=Math.min(se[1],_e.y),se[2]=Math.max(se[2],_e.x),se[3]=Math.max(se[3],_e.y)}se[0]<Zi&&se[1]<Zi&&se[2]>=0&&se[3]>=0&&E.insert(b,se[0],se[1],se[2],se[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new c_(new Sp(this.rawTileData)).layers,this.sourceLayerCoder=new Y_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const r in this.vtLayers)this.vtFeatures[r]=[]}return this.vtLayers}query(r,a,h,p){this.loadVTLayers();const g=r.params||{},v=uc(g.filter),b=r.tileResult,E=r.transform,k=b.bufferedTilespaceBounds,X=this.grid.query(k.min.x,k.min.y,k.max.x,k.max.y,(Ee,Oe,Ve,tt)=>qg(b.bufferedTilespaceGeometry,Ee,Oe,Ve,tt));X.sort(U0);let se=null;E.elevation&&X.length>0&&(se=qp.create(E.elevation,this.tileID));const he={};let _e;for(let Ee=0;Ee<X.length;Ee++){const Oe=X[Ee];if(Oe===_e)continue;_e=Oe;const Ve=this.featureIndexArray.get(Oe);let tt=null;this.loadMatchingFeature(he,Ve,v,g.layers,g.availableImages,a,h,p,(ht,et,st,dt=0)=>(tt||(tt=_c(ht,this.tileID.canonical,r.tileTransform)),et.queryIntersectsFeature(b,ht,st,tt,this.z,r.transform,r.pixelPosMatrix,se,dt)))}return he}loadMatchingFeature(r,a,h,p,g,v,b,E,k){const{featureIndex:X,bucketIndex:se,sourceLayerIndex:he,layoutVertexArrayOffset:_e}=a,Ee=this.bucketLayerIDs[se];if(p&&!function(ht,et){for(let st=0;st<ht.length;st++)if(et.indexOf(ht[st])>=0)return!0;return!1}(p,Ee))return;const Oe=this.sourceLayerCoder.decode(he),Ve=this.vtLayers[Oe].feature(X);if(h.needGeometry){const ht=Gh(Ve,!0);if(!h.filter(new Ct(this.tileID.overscaledZ),ht,this.tileID.canonical))return}else if(!h.filter(new Ct(this.tileID.overscaledZ),Ve))return;const tt=this.getId(Ve,Oe);for(let ht=0;ht<Ee.length;ht++){const et=Ee[ht];if(p&&p.indexOf(et)<0)continue;const st=v[et];if(!st)continue;let dt={};void 0!==tt&&E&&(dt=E.getState(st.sourceLayer||"_geojsonTileLayer",tt));const ut=S({},b[et]);ut.paint=Vm(ut.paint,st.paint,Ve,dt,g),ut.layout=Vm(ut.layout,st.layout,Ve,dt,g);const Ot=!k||k(Ve,st,dt,_e);if(!Ot)continue;const It=new Rm(Ve,this.z,this.x,this.y,tt);It.layer=ut;let Wt=r[et];void 0===Wt&&(Wt=r[et]=[]),Wt.push({featureIndex:X,feature:It,intersectionZ:Ot})}}lookupSymbolFeatures(r,a,h,p,g,v,b,E){const k={};this.loadVTLayers();const X=uc(g);for(const se of r)this.loadMatchingFeature(k,{bucketIndex:h,sourceLayerIndex:p,featureIndex:se,layoutVertexArrayOffset:0},X,v,b,E,a);return k}loadFeature(r){const{featureIndex:a,sourceLayerIndex:h}=r;this.loadVTLayers();const p=this.sourceLayerCoder.decode(h),g=this.vtFeatures[p];if(g[a])return g[a];const v=this.vtLayers[p].feature(a);return g[a]=v,v}hasLayer(r){for(const a of this.bucketLayerIDs)for(const h of a)if(r===h)return!0;return!1}getId(r,a){let h=r.id;if(this.promoteId){const p="string"==typeof this.promoteId?this.promoteId:this.promoteId[a];null!=p&&(h=r.properties[p]),"boolean"==typeof h&&(h=Number(h))}return h}}function Vm(s,r,a,h,p){return $(s,(g,v)=>{const b=r instanceof li?r.get(v):null;return b&&b.evaluate?b.evaluate(a,h,p):b})}function U0(s,r){return r-s}Ei(zm,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class jm{constructor(r,a){this.width=r,this.height=a,this.nextRow=0,this.image=new bc({width:r,height:a}),this.positions={},this.uploaded=!1}getDash(r,a){const h=this.getKey(r,a);return this.positions[h]}trim(){const r=this.width,a=this.height=ae(this.nextRow);this.image.resize({width:r,height:a})}getKey(r,a){return r.join(",")+a}getDashRanges(r,a,h){const p=[];let g=r.length%2==1?-r[r.length-1]*h:0,v=r[0]*h,b=!0;p.push({left:g,right:v,isDash:b,zeroLength:0===r[0]});let E=r[0];for(let k=1;k<r.length;k++){b=!b;const X=r[k];g=E*h,E+=X,v=E*h,p.push({left:g,right:v,isDash:b,zeroLength:0===X})}return p}addRoundDash(r,a,h){const p=a/2;for(let g=-h;g<=h;g++){const v=this.width*(this.nextRow+h+g);let b=0,E=r[b];for(let k=0;k<this.width;k++){k/E.right>1&&(E=r[++b]);const X=Math.abs(k-E.left),se=Math.abs(k-E.right),he=Math.min(X,se);let _e;const Ee=g/h*(p+1);if(E.isDash){const Oe=p-Math.abs(Ee);_e=Math.sqrt(he*he+Oe*Oe)}else _e=p-Math.sqrt(he*he+Ee*Ee);this.image.data[v+k]=Math.max(0,Math.min(255,_e+128))}}}addRegularDash(r,a){for(let E=r.length-1;E>=0;--E){const k=r[E],X=r[E+1];k.zeroLength?r.splice(E,1):X&&X.isDash===k.isDash&&(X.left=k.left,r.splice(E,1))}const h=r[0],p=r[r.length-1];h.isDash===p.isDash&&(h.left=p.left-this.width,p.right=h.right+this.width);const g=this.width*this.nextRow;let v=0,b=r[v];for(let E=0;E<this.width;E++){E/b.right>1&&(b=r[++v]);const k=Math.abs(E-b.left),X=Math.abs(E-b.right),se=Math.min(k,X);this.image.data[g+E]=Math.max(0,Math.min(255,(b.isDash?se:-se)+a+128))}}addDash(r,a){const h=this.getKey(r,a);if(this.positions[h])return this.positions[h];const p="round"===a,g=p?7:0,v=2*g+1;if(this.nextRow+v>this.height)return De("LineAtlas out of space"),null;0===r.length&&r.push(1);let b=0;for(let X=0;X<r.length;X++)r[X]<0&&(De("Negative value is found in line dasharray, replacing values with 0"),r[X]=0),b+=r[X];if(0!==b){const X=this.width/b,se=this.getDashRanges(r,this.width,X);p?this.addRoundDash(se,X,g):this.addRegularDash(se,"square"===a?.5*X:0)}const E=this.nextRow+g;this.nextRow+=v;const k={tl:[E,g],br:[b,0]};return this.positions[h]=k,k}}Ei(jm,"LineAtlas");class H0{constructor(r){const a={},h=[];for(const b in r){const E=r[b],k=a[b]={};for(const X in E.glyphs){const se=E.glyphs[+X];if(!se||0===se.bitmap.width||0===se.bitmap.height)continue;const he=se.metrics.localGlyph?2:1,_e={x:0,y:0,w:se.bitmap.width+2*he,h:se.bitmap.height+2*he};h.push(_e),k[X]=_e}}const{w:p,h:g}=C_(h),v=new bc({width:p||1,height:g||1});for(const b in r){const E=r[b];for(const k in E.glyphs){const X=E.glyphs[+k];if(!X||0===X.bitmap.width||0===X.bitmap.height)continue;const se=a[b][k],he=X.metrics.localGlyph?2:1;bc.copy(X.bitmap,v,{x:0,y:0},{x:se.x+he,y:se.y+he},X.bitmap)}}this.image=v,this.positions=a}}Ei(H0,"GlyphAtlas");class cS{constructor(r){this.tileID=new $r(r.tileID.overscaledZ,r.tileID.wrap,r.tileID.canonical.z,r.tileID.canonical.x,r.tileID.canonical.y),this.tileZoom=r.tileZoom,this.uid=r.uid,this.zoom=r.zoom,this.canonical=r.tileID.canonical,this.pixelRatio=r.pixelRatio,this.tileSize=r.tileSize,this.source=r.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=r.showCollisionBoxes,this.collectResourceTiming=!!r.collectResourceTiming,this.returnDependencies=!!r.returnDependencies,this.promoteId=r.promoteId,this.enableTerrain=!!r.enableTerrain,this.isSymbolTile=r.isSymbolTile,this.tileTransform=tu(r.tileID.canonical,r.projection),this.projection=r.projection}parse(r,a,h,p,g){this.status="parsing",this.data=r,this.collisionBoxArray=new ui;const v=new Y_(Object.keys(r.layers).sort()),b=new zm(this.tileID,this.promoteId);b.bucketLayerIDs=[];const E={},k=new jm(256,256),X={featureIndex:b,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:k,availableImages:h},se=a.familiesBySource[this.source];for(const dt in se){const ut=r.layers[dt];if(!ut)continue;let Ot=!1,It=!1;for(const Bt of se[dt])"symbol"===Bt[0].type?Ot=!0:It=!0;if(!0===this.isSymbolTile&&!Ot||!1===this.isSymbolTile&&!It)continue;1===ut.version&&De(`Vector tile source "${this.source}" layer "${dt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Wt=v.encode(dt),ii=[];for(let Bt=0;Bt<ut.length;Bt++){const Xt=ut.feature(Bt),Qt=b.getId(Xt,dt);ii.push({feature:Xt,id:Qt,index:Bt,sourceLayerIndex:Wt})}for(const Bt of se[dt]){const Xt=Bt[0];void 0!==this.isSymbolTile&&"symbol"===Xt.type!==this.isSymbolTile||Xt.minzoom&&this.zoom<Math.floor(Xt.minzoom)||Xt.maxzoom&&this.zoom>=Xt.maxzoom||"none"!==Xt.visibility&&(iy(Bt,this.zoom,h),(E[Xt.id]=Xt.createBucket({index:b.bucketLayerIDs.length,layers:Bt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Wt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:h})).populate(ii,X,this.tileID.canonical,this.tileTransform),b.bucketLayerIDs.push(Bt.map(Qt=>Qt.id)))}}let he,_e,Ee,Oe;k.trim();const Ve={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},tt=$(X.glyphDependencies,dt=>Object.keys(dt).map(Number));Object.keys(tt).length?p.send("getGlyphs",{uid:this.uid,stacks:tt},(dt,ut)=>{he||(he=dt,_e=ut,st.call(this))},void 0,!1,Ve):_e={};const ht=Object.keys(X.iconDependencies);ht.length?p.send("getImages",{icons:ht,source:this.source,tileID:this.tileID,type:"icons"},(dt,ut)=>{he||(he=dt,Ee=ut,st.call(this))},void 0,!1,Ve):Ee={};const et=Object.keys(X.patternDependencies);function st(){if(he)return g(he);if(_e&&Ee&&Oe){const dt=new H0(_e),ut=new _0(Ee,Oe);for(const Ot in E){const It=E[Ot];It instanceof dl?(iy(It.layers,this.zoom,h),u1(It,_e,dt.positions,Ee,ut.iconPositions,this.showCollisionBoxes,h,this.tileID.canonical,this.tileZoom,this.projection)):It.hasPattern&&(It instanceof gm||It instanceof om||It instanceof um)&&(iy(It.layers,this.zoom,h),It.addFeatures(X,this.tileID.canonical,ut.patternPositions,h,this.tileTransform))}this.status="done",g(null,{buckets:T(E).filter(Ot=>!Ot.isEmpty()),featureIndex:b,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:dt.image,lineAtlas:k,imageAtlas:ut,glyphMap:this.returnDependencies?_e:null,iconMap:this.returnDependencies?Ee:null,glyphPositions:this.returnDependencies?dt.positions:null})}}et.length?p.send("getImages",{icons:et,source:this.source,tileID:this.tileID,type:"patterns"},(dt,ut)=>{he||(he=dt,Oe=ut,st.call(this))},void 0,!1,Ve):Oe={},st.call(this)}}function iy(s,r,a){const h=new Ct(r);for(const p of s)p.recalculate(h,a)}class ny{constructor(r){this.entries={},this.scheduler=r}request(r,a,h,p){const g=this.entries[r]=this.entries[r]||{callbacks:[]};if(g.result){const[v,b]=g.result;return this.scheduler?this.scheduler.add(()=>{p(v,b)},a):p(v,b),()=>{}}return g.callbacks.push(p),g.cancel||(g.cancel=h((v,b)=>{g.result=[v,b];for(const E of g.callbacks)this.scheduler?this.scheduler.add(()=>{E(v,b)},a):E(v,b);setTimeout(()=>delete this.entries[r],3e3)})),()=>{g.result||(g.callbacks=g.callbacks.filter(v=>v!==p),g.callbacks.length||(g.cancel(),delete this.entries[r]))}}}function G0(s,r,a){const h=JSON.stringify(s.request);return s.data&&(this.deduped.entries[h]={result:[null,s.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom},p=>{const g=vi(s.request,(v,b,E,k)=>{v?p(v):b&&p(null,{vectorTile:a?void 0:new c_(new Sp(b)),rawData:b,cacheControl:E,expires:k})});return()=>{g.cancel(),p()}},r)}u.ARRAY_TYPE=Lo,u.AUTH_ERR_MSG=bn,u.Aabb=Cs,u.Actor=class{constructor(s,r,a){this.target=s,this.parent=r,this.mapId=a,this.callbacks={},this.cancelCallbacks={},ge(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=xe()?s:re,this.scheduler=new N0}send(s,r,a,h,p=!1,g){const v=Math.round(1e18*Math.random()).toString(36).substring(0,10);a&&(a.metadata=g,this.callbacks[v]=a);const b=Le(this.globalScope)?void 0:[];return this.target.postMessage({id:v,type:s,hasCallback:!!a,targetMapId:h,mustQueue:p,sourceMapId:this.mapId,data:rl(r,b)},b),{cancel:()=>{a&&delete this.callbacks[v],this.target.postMessage({id:v,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(s){const r=s.data,a=r.id;if(a&&(!r.targetMapId||this.mapId===r.targetMapId))if("<cancel>"===r.type){const h=this.cancelCallbacks[a];delete this.cancelCallbacks[a],h&&h.cancel()}else if(r.mustQueue||xe()){const h=this.callbacks[a];this.cancelCallbacks[a]=this.scheduler.add(()=>this.processTask(a,r),h&&h.metadata||{type:"message"})}else this.processTask(a,r)}processTask(s,r){if("<response>"===r.type){const a=this.callbacks[s];delete this.callbacks[s],a&&(r.error?a(za(r.error)):a(null,za(r.data)))}else{const a=Le(this.globalScope)?void 0:[],h=r.hasCallback?(g,v)=>{delete this.cancelCallbacks[s],this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:g?rl(g):null,data:rl(v,a)},a)}:g=>{},p=za(r.data);if(this.parent[r.type])this.parent[r.type](r.sourceMapId,p,h);else if(this.parent.getWorkerSource){const g=r.type.split(".");this.parent.getWorkerSource(r.sourceMapId,g[0],p.source)[g[1]](p,h)}else h(new Error(`Could not find function ${r.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},u.CanonicalTileID=fm,u.Color=Ur,u.ColorMode=Ca,u.CullFaceMode=Ss,u.DEMData=Bm,u.DataConstantProperty=St,u.DedupedRequest=ny,u.DepthMode=ou,u.EXTENT=Zi,u.Elevation=class{isDataAvailableAtPoint(s){const r=this._source();if(this.isUsingMockSource()||!r||s.y<0||s.y>1)return!1;const a=r.getSource().maxzoom,h=1<<a,p=Math.floor(s.x),g=Math.floor((s.x-p)*h),v=Math.floor(s.y*h),b=this.findDEMTileFor(new $r(a,p,a,g,v));return!(!b||!b.dem)}getAtPointOrZero(s,r=0){return this.getAtPoint(s,r)||0}getAtPoint(s,r,a=!0){if(this.isUsingMockSource())return null;null==r&&(r=null);const h=this._source();if(!h||s.y<0||s.y>1)return r;const p=h.getSource().maxzoom,g=1<<p,v=Math.floor(s.x),b=s.x-v,E=new $r(p,v,p,Math.floor(b*g),Math.floor(s.y*g)),k=this.findDEMTileFor(E);if(!k||!k.dem)return r;const X=k.dem,se=1<<k.tileID.canonical.z,he=(b*se-k.tileID.canonical.x)*X.dim,_e=(s.y*se-k.tileID.canonical.y)*X.dim,Ee=Math.floor(he),Oe=Math.floor(_e);return(a?this.exaggeration():1)*ci(ci(X.get(Ee,Oe),X.get(Ee,Oe+1),_e-Oe),ci(X.get(Ee+1,Oe),X.get(Ee+1,Oe+1),_e-Oe),he-Ee)}getAtTileOffset(s,r,a){const h=1<<s.canonical.z;return this.getAtPointOrZero(new xa(s.wrap+(s.canonical.x+r/Zi)/h,(s.canonical.y+a/Zi)/h))}getAtTileOffsetFunc(s,r,a,h){return p=>{const g=this.getAtTileOffset(s,p.x,p.y),v=h.upVector(s.canonical,p.x,p.y);return ba(v,v,g*h.upVectorScale(s.canonical,r,a).metersToTile),v}}getForTilePoints(s,r,a,h){if(this.isUsingMockSource())return!1;const p=qp.create(this,s,h);return!!p&&(r.forEach(g=>{g[2]=this.exaggeration()*p.getElevationAt(g[0],g[1],a)}),!0)}getMinMaxForTile(s){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(s);if(!r||!r.dem)return null;const a=r.dem.tree,h=r.tileID,p=1<<s.canonical.z-h.canonical.z;let g=s.canonical.x/p-h.canonical.x,v=s.canonical.y/p-h.canonical.y,b=0;for(let E=0;E<s.canonical.z-h.canonical.z&&!a.leaves[b];E++){g*=2,v*=2;const k=2*Math.floor(v)+Math.floor(g);b=a.childOffsets[b]+k,g%=1,v%=1}return{min:this.exaggeration()*a.minimums[b],max:this.exaggeration()*a.maximums[b]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(s,r,a){throw new Error("Pure virtual method called.")}pointCoordinate(s){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(s){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},u.ErrorEvent=bl,u.EvaluationParameters=Ct,u.Event=Pa,u.Evented=Ws,u.FillExtrusionBucket=um,u.Frustum=Zf,u.FrustumCorners=Hv,u.GLOBE_METERS_TO_ECEF=Ni,u.GLOBE_RADIUS=sn,u.GLOBE_SCALE_MATCH_LATITUDE=45,u.GLOBE_ZOOM_THRESHOLD_MAX=6,u.GLOBE_ZOOM_THRESHOLD_MIN=5,u.GlobeSharedBuffers=class{constructor(s){this._createGrid(s),this._createPoles(s)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const s of this._poleSegments)s.destroy();for(const s of this._gridSegments)s.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const s of this._wireframeSegments)s.destroy()}}_createGrid(s){const r=new Un,a=new Oo,h=65;for(let p=0;p<h;p++)for(let g=0;g<h;g++)r.emplaceBack(g,p);this._gridSegments=[];for(let p=0,g=0;p<Jh.length;p++){const v=Jh[p];for(let E=0;E<v;E++)for(let k=0;k<64;k++){const X=E*h+k;a.emplaceBack(X+1,X,X+h),a.emplaceBack(X+h,X+h+1,X+1)}const b=64*v*2;this._gridSegments.push(ro.simpleSegment(0,g,(v+1)*h,b)),g+=b}this._gridBuffer=s.createVertexBuffer(r,Fp.members),this._gridIndexBuffer=s.createIndexBuffer(a,!0)}_createPoles(s){const r=new Oo;for(let p=0;p<=64;p++)r.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=s.createIndexBuffer(r,!0);const a=new Va,h=new Va;this._poleSegments=[];for(let p=0,g=0;p<5;p++){const v=360/(1<<p);a.emplaceBack(0,-sn,0,.5,0),h.emplaceBack(0,-sn,0,.5,1);for(let b=0;b<=64;b++){const E=b/64,k=ci(0,v,E),[X,se,he]=oh(Am,m1,k,sn);a.emplaceBack(X,se,he,E,0),h.emplaceBack(X,se,he,E,1)}this._poleSegments.push(ro.simpleSegment(g,0,66,64)),g+=66}this._poleNorthVertexBuffer=s.createVertexBuffer(a,A0,!1),this._poleSouthVertexBuffer=s.createVertexBuffer(h,A0,!1)}getGridBuffers(s){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[s]]}getPoleBuffers(s){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[s]]}getWirefameBuffers(s,r){if(!this._wireframeSegments){const a=new na,h=64,p=h+1;this._wireframeSegments=[];for(let g=0,v=0;g<Jh.length;g++){const b=Jh[g];for(let k=0;k<b;k++)for(let X=0;X<h;X++){const se=k*p+X;a.emplaceBack(se,se+1),a.emplaceBack(se,se+p),a.emplaceBack(se,se+p+1)}const E=b*h*3;this._wireframeSegments.push(ro.simpleSegment(0,v,(b+1)*p,E)),v+=E}this._wireframeIndexBuffer=s.createIndexBuffer(a)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[r]]}},u.GlyphManager=nh,u.ImagePosition=Ap,u.LivePerformanceUtils=gi,u.LngLat=Dn,u.LngLatBounds=gc,u.LocalGlyphMode=wm,u.MAX_MERCATOR_LATITUDE=zl,u.MercatorCoordinate=xa,u.ONE_EM=24,u.OverscaledTileID=$r,u.PerformanceMarkers=Yt,u.Properties=ki,u.RGBAImage=oa,u.Ray=Uv,u.RequestManager=class{constructor(s,r,a){this._transformRequestFn=s,this._customAccessToken=r,this._silenceAuthErrors=!!a,this._createSkuToken()}_createSkuToken(){const s=function(){let r="";for(let a=0;a<10;a++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",j,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,r){return this._transformRequestFn&&this._transformRequestFn(s,r)||{url:s}}normalizeStyleURL(s,r){if(!Ri(s))return s;const a=kr(s);return a.path=`/styles/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||r)}normalizeGlyphsURL(s,r){if(!Ri(s))return s;const a=kr(s);return a.path=`/fonts/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||r)}normalizeSourceURL(s,r,a,h){if(!Ri(s))return s;const p=kr(s);return p.path=`/v4/${p.authority}.json`,p.params.push("secure"),a&&p.params.push(`language=${a}`),h&&p.params.push(`worldview=${h}`),this._makeAPIURL(p,this._customAccessToken||r)}normalizeSpriteURL(s,r,a,h){const p=kr(s);return Ri(s)?(p.path=`/styles/v1${p.path}/sprite${r}${a}`,this._makeAPIURL(p,this._customAccessToken||h)):(p.path+=`${r}${a}`,Fr(p))}normalizeTileURL(s,r,a){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!Ri(s))return s;const h=kr(s);h.path=h.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${r||a&&"raster"!==h.authority&&512===a?"@2x":""}${Se.supported?".webp":"$1"}`),"raster"===h.authority?h.path=`/${Ce.RASTER_URL_PREFIX}${h.path}`:(h.path=h.path.replace(/^.+\/v4\//,"/"),h.path=`/${Ce.TILE_URL_VERSION}${h.path}`);const p=this._customAccessToken||function(g){for(const v of g){const b=v.match(/^access_token=(.*)$/);if(b)return b[1]}return null}(h.params)||Ce.ACCESS_TOKEN;return Ce.REQUIRE_ACCESS_TOKEN&&p&&this._skuToken&&h.params.push(`sku=${this._skuToken}`),this._makeAPIURL(h,p)}canonicalizeTileURL(s,r){const a=kr(s);if(!a.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!a.path.match(/\.[\w]+$/))return s;let h="mapbox://";a.path.match(/^\/raster\/v1\//)?h+=`raster/${a.path.replace(`/${Ce.RASTER_URL_PREFIX}/`,"")}`:h+=`tiles/${a.path.replace(`/${Ce.TILE_URL_VERSION}/`,"")}`;let p=a.params;return r&&(p=p.filter(g=>!g.match(/^access_token=/))),p.length&&(h+=`?${p.join("&")}`),h}canonicalizeTileset(s,r){const a=!!r&&Ri(r),h=[];for(const p of s.tiles||[])_r(p)?h.push(this.canonicalizeTileURL(p,a)):h.push(p);return h}_makeAPIURL(s,r){const a="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",h=kr(Ce.API_URL);if(s.protocol=h.protocol,s.authority=h.authority,"http"===s.protocol){const p=s.params.indexOf("secure");p>=0&&s.params.splice(p,1)}if("/"!==h.path&&(s.path=`${h.path}${s.path}`),!Ce.REQUIRE_ACCESS_TOKEN)return Fr(s);if(r=r||Ce.ACCESS_TOKEN,!this._silenceAuthErrors){if(!r)throw new Error(`An API access token is required to use Mapbox GL. ${a}`);if("s"===r[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${a}`)}return s.params=s.params.filter(p=>-1===p.indexOf("access_token")),s.params.push(`access_token=${r||""}`),Fr(s)}},u.ResourceType=ct,u.SegmentVector=ro,u.SourceCache=ql,u.StencilMode=ty,u.StructArrayLayout1ui2=Ll,u.StructArrayLayout2f1f2i16=Hn,u.StructArrayLayout2i4=Un,u.StructArrayLayout2ui4=na,u.StructArrayLayout3f12=ol,u.StructArrayLayout3ui6=Oo,u.StructArrayLayout4i8=tr,u.StructArrayLayout5f20=Va,u.Texture=Wp,u.Tile=B0,u.Transitionable=Ht,u.Uniform1f=Vf,u.Uniform1i=class extends Fl{constructor(s){super(s),this.current=0}set(s,r,a){this.fetchUniformLocation(s,r)&&this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},u.Uniform2f=class extends Fl{constructor(s){super(s),this.current=[0,0]}set(s,r,a){this.fetchUniformLocation(s,r)&&(a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1])))}},u.Uniform3f=class extends Fl{constructor(s){super(s),this.current=[0,0,0]}set(s,r,a){this.fetchUniformLocation(s,r)&&(a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2])))}},u.Uniform4f=Mv,u.UniformColor=yw,u.UniformMatrix2f=class extends Fl{constructor(s){super(s),this.current=ya}set(s,r,a){if(this.fetchUniformLocation(s,r))for(let h=0;h<4;h++)if(a[h]!==this.current[h]){this.current=a,this.gl.uniformMatrix2fv(this.location,!1,a);break}}},u.UniformMatrix3f=class extends Fl{constructor(s){super(s),this.current=Sv}set(s,r,a){if(this.fetchUniformLocation(s,r))for(let h=0;h<9;h++)if(a[h]!==this.current[h]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}},u.UniformMatrix4f=class extends Fl{constructor(s){super(s),this.current=QM}set(s,r,a){if(this.fetchUniformLocation(s,r)){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let h=1;h<16;h++)if(a[h]!==this.current[h]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}}},u.UnwrappedTileID=mm,u.ValidationError=wi,u.VectorTileFeature=ld,u.VectorTileWorkerSource=class extends Ws{constructor(s,r,a,h,p){super(),this.actor=s,this.layerIndex=r,this.availableImages=a,this.loadVectorData=p||G0,this.loading={},this.loaded={},this.deduped=new ny(s.scheduler),this.isSpriteLoaded=h,this.scheduler=s.scheduler}loadTile(s,r){const a=s.uid,h=s&&s.request,p=h&&h.collectResourceTiming,g=this.loading[a]=new cS(s);g.abort=this.loadVectorData(s,(v,b)=>{const E=!this.loading[a];if(delete this.loading[a],E||v||!b)return g.status="done",E||(this.loaded[a]=g),r(v);const k=b.rawData,X={};b.expires&&(X.expires=b.expires),b.cacheControl&&(X.cacheControl=b.cacheControl),g.vectorTile=b.vectorTile||new c_(new Sp(k));const se=()=>{g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,(he,_e)=>{if(he||!_e)return r(he);const Ee={};if(p){const Oe=zi(h);Oe.length>0&&(Ee.resourceTiming=JSON.parse(JSON.stringify(Oe)))}r(null,S({rawTileData:k.slice(0)},_e,X,Ee))})};this.isSpriteLoaded?se():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(se,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom}):se()}),this.loaded=this.loaded||{},this.loaded[a]=g})}reloadTile(s,r){const a=this.loaded,h=s.uid,p=this;if(a&&a[h]){const g=a[h];g.showCollisionBoxes=s.showCollisionBoxes,g.enableTerrain=!!s.enableTerrain,g.projection=s.projection,g.tileTransform=tu(s.tileID.canonical,s.projection);const v=(b,E)=>{const k=g.reloadCallback;k&&(delete g.reloadCallback,g.parse(g.vectorTile,p.layerIndex,this.availableImages,p.actor,k)),r(b,E)};"parsing"===g.status?g.reloadCallback=v:"done"===g.status&&(g.vectorTile?g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,v):v())}}abortTile(s,r){const a=s.uid,h=this.loading[a];h&&(h.abort&&h.abort(),delete this.loading[a]),r()}removeTile(s,r){const a=this.loaded,h=s.uid;a&&a[h]&&delete a[h],r()}},u.WritingMode=wa,u.add=xc,u.addDynamicAttributes=W_,u.adjoint=function(s,r){var a=r[0],h=r[1],p=r[2],g=r[3],v=r[4],b=r[5],E=r[6],k=r[7],X=r[8];return s[0]=v*X-b*k,s[1]=p*k-h*X,s[2]=h*b-p*v,s[3]=b*E-g*X,s[4]=a*X-p*E,s[5]=p*g-a*b,s[6]=g*k-v*E,s[7]=h*E-a*k,s[8]=a*v-h*g,s},u.asyncAll=U,u.bezier=J,u.bindAll=ge,u.boundsAttributes=M1,u.bufferConvexPolygon=function(s,r){const a=[];for(let h=0;h<s.length;h++){const p=A(h-1,-1,s.length-1),g=A(h+1,-1,s.length-1),v=s[h],b=s[g],E=s[p].sub(v).unit(),k=b.sub(v).unit(),X=k.angleWithSep(E.x,E.y),se=E.add(k).unit().mult(-1*r/Math.sin(X/2));a.push(v.add(se))}return a},u.cacheEntryPossiblyAdded=function(s){it++,it>bt&&(s.getActor().send("enforceCacheSizeLimit",Ut),it=0)},u.calculateGlobeLabelMatrix=function(s,r){const{x:a,y:h}=s.point,p=f1(a,h,s.worldSize/s._pixelsPerMercatorPixel,0,0);return vc(p,p,Dm(Xl(r)))},u.calculateGlobeMatrix=function(s){const{x:r,y:a}=s.point,{lng:h,lat:p}=s._center;return f1(r,a,s.worldSize,h,p)},u.calculateGlobeMercatorMatrix=function(s){const r=s.pixelsPerMeter,a=r/ra(1,s.center.lat),h=Vl(new Float64Array(16));return Ju(h,h,[s.point.x,s.point.y,0]),Qc(h,h,[a,a,r]),Float32Array.from(h)},u.circumferenceAtLatitude=Pt,u.clamp=D,u.clearTileCache=function(s){if(!lt())return;const r=re.caches.delete(at);s&&r.catch(s).then(()=>s())},u.clipLine=bm,u.clone=function(s){var r=new Lo(16);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[3],r[4]=s[4],r[5]=s[5],r[6]=s[6],r[7]=s[7],r[8]=s[8],r[9]=s[9],r[10]=s[10],r[11]=s[11],r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15],r},u.clone$1=Me,u.collisionCircleLayout=Yw,u.config=Ce,u.conjugate=function(s,r){return s[0]=-r[0],s[1]=-r[1],s[2]=-r[2],s[3]=r[3],s},u.create=function(){var s=new Lo(16);return Lo!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},u.create$1=Lv,u.createExpression=il,u.createLayout=Ci,u.createStyleLayer=function(s){return"custom"===s.type?new b1(s):new aS[s.type](s)},u.cross=Qg,u.degToRad=W,u.distance=function(s,r){return Math.hypot(r[0]-s[0],r[1]-s[1],r[2]-s[2])},u.div=function(s,r,a){return s[0]=r[0]/a[0],s[1]=r[1]/a[1],s[2]=r[2]/a[2],s},u.dot=Ua,u.earthRadius=Zc,u.ease=q,u.easeCubicInOut=ee,u.ecefToLatLng=function([s,r,a]){const h=Math.hypot(s,r,a),p=Math.atan2(s,a),g=.5*Math.PI-Math.acos(-r/h);return new Dn(ie(p),ie(g))},u.emitValidationErrors=Gu,u.endsWith=V,u.enforceCacheSizeLimit=function(s){Pe(),wt&&wt.then(r=>{r.keys().then(a=>{for(let h=0;h<a.length-s;h++)r.delete(a[h])})})},u.evaluateSizeForFeature=Ep,u.evaluateSizeForZoom=hd,u.evaluateVariableOffset=P_,u.evented=pt,u.exactEquals=function(s,r){return s[0]===r[0]&&s[1]===r[1]&&s[2]===r[2]&&s[3]===r[3]},u.exactEquals$1=function(s,r){return s[0]===r[0]&&s[1]===r[1]&&s[2]===r[2]},u.exported=Li,u.exported$1=Se,u.extend=S,u.extend$1=Ya,u.fillExtrusionHeightLift=dm,u.filterObject=de,u.fromMat4=function(s,r){return s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[4],s[4]=r[5],s[5]=r[6],s[6]=r[8],s[7]=r[9],s[8]=r[10],s},u.fromQuat=function(s,r){var a=r[0],h=r[1],p=r[2],g=r[3],v=a+a,b=h+h,E=p+p,k=a*v,X=h*v,se=h*b,he=p*v,_e=p*b,Ee=p*E,Oe=g*v,Ve=g*b,tt=g*E;return s[0]=1-se-Ee,s[1]=X+tt,s[2]=he-Ve,s[3]=0,s[4]=X-tt,s[5]=1-k-Ee,s[6]=_e+Oe,s[7]=0,s[8]=he+Ve,s[9]=_e-Oe,s[10]=1-k-se,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},u.fromRotation=function(s,r){var a=Math.sin(r),h=Math.cos(r);return s[0]=h,s[1]=a,s[2]=0,s[3]=-a,s[4]=h,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},u.fromScaling=Nv,u.furthestTileCorner=function(s){const r=Math.round((s+45+360)%360/90)%4;return te[r]},u.getAABBPointSquareDist=function(s,r,a){let h=0;for(let p=0;p<2;++p){const g=a?a[p]:0;s[p]>g&&(h+=(s[p]-g)*(s[p]-g)),r[p]<g&&(h+=(g-r[p])*(g-r[p]))}return h},u.getAnchorAlignment=xm,u.getAnchorJustification=O_,u.getBounds=function(s){let r=1/0,a=1/0,h=-1/0,p=-1/0;for(const g of s)r=Math.min(r,g.x),a=Math.min(a,g.y),h=Math.max(h,g.x),p=Math.max(p,g.y);return{min:new I(r,a),max:new I(h,p)}},u.getColumn=Ze,u.getGridMatrix=function(s,r,a,h){const p=r.getNorth(),g=r.getSouth(),v=r.getWest(),b=r.getEast(),E=1<<s.z,k=b-v,X=p-g,se=k/64,he=-X/Jh[a],_e=[0,se,0,he,0,0,p,v,0];if(s.z>0){const Ee=180/h;Fv(_e,_e,[Ee/k+1,0,0,0,Ee/X+1,0,-.5*Ee/se,.5*Ee/he,1])}return _e[2]=E,_e[5]=s.x,_e[8]=s.y,_e},u.getImage=Qi,u.getJSON=function(s,r){return Kt(S(s,{type:"json"}),r)},u.getLatitudinalLod=function(s){const r=80.051129;s=D(s,-80.051129,r)/r*90;const a=Math.pow(Math.abs(Math.sin(W(s))),3);return Math.round(a*(Jh.length-1))},u.getMapSessionAPI=_t,u.getPerformanceMeasurement=zi,u.getProjection=Im,u.getRTLTextPluginStatus=xt,u.getReferrer=Nt,u.getTilePoint=function(s,{x:r,y:a},h=0){return new I(((r-h)*s.scale-s.x)*Zi,(a*s.scale-s.y)*Zi)},u.getTileVec3=function(s,r,a=0){return Bs(((r.x-a)*s.scale-s.x)*Zi,(r.y*s.scale-s.y)*Zi,Dv(r.z,r.y))},u.getVideo=function(s,r){const a=re.document.createElement("video");a.muted=!0,a.onloadstart=function(){r(null,a)};for(let h=0;h<s.length;h++){const p=re.document.createElement("source");Ki(s[h])||(a.crossOrigin="Anonymous"),p.src=s[h],a.appendChild(p)}return{cancel:()=>{}}},u.globeCenterToScreenPoint=function(s){const r=[0,0,0],a=Vl(new Float64Array(16));return vc(a,s.pixelMatrix,s.globeMatrix),Hr(r,r,a),new I(r[0],r[1])},u.globeDenormalizeECEF=Dm,u.globeECEFOrigin=function(s,r){const a=[0,0,0];return Hr(a,a,zp(Xl(r.canonical))),Hr(a,a,s),a},u.globeNormalizeECEF=zp,u.globePixelsToTileUnits=function(s,r){return Zi/(512*Math.pow(2,s))*z_(Xl(r))},u.globePoleMatrixForTile=function(s,r,a){const h=Vl(new Float64Array(16)),p=(r/(1<<s)-.5)*Math.PI*2;return jl(h,a.globeMatrix,p),Float32Array.from(h)},u.globeTileBounds=Xl,u.globeTiltAtLngLat=eu,u.globeToMercatorTransition=yd,u.globeUseCustomAntiAliasing=function(s,r,a){const h=yd(a.zoom),p=s.style.map._antialias,g=!!r.extStandardDerivatives,v=r.extStandardDerivativesForceOff||s.terrain&&s.terrain.exaggeration()>0;return 0===h&&!p&&!v&&g},u.identity=Vl,u.identity$1=Tw,u.invert=Qu,u.isFullscreen=function(){return!!re.document.fullscreenElement||!!re.document.webkitFullscreenElement},u.isLngLatBehindGlobe=V_,u.isMapAuthenticated=function(s){return Mt.has(s)},u.isMapboxURL=Ri,u.isSafariWithAntialiasingBug=function(s){const r=s.navigator?s.navigator.userAgent:null;return!!Le(s)&&r&&(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},u.latFromMercatorY=Xo,u.latLngToECEF=Bp,u.len=jv,u.length=hs,u.length$1=function(s){return Math.hypot(s[0],s[1],s[2],s[3])},u.lngFromMercatorX=cs,u.loadVectorTile=G0,u.makeRequest=Kt,u.mapValue=function(s,r,a,h,p){return D((s-r)/(a-r)*(p-h)+h,h,p)},u.mercatorScale=Hf,u.mercatorXfromLng=al,u.mercatorYfromLat=nr,u.mercatorZfromAltitude=ra,u.mul=Mw,u.mul$1=gp,u.multiply=vc,u.multiply$1=Fv,u.multiply$2=Vv,u.nextPowerOfTwo=ae,u.normalize=ws,u.normalize$1=t_,u.normalize$2=e_,u.number=ci,u.ortho=function(s,r,a,h,p,g,v){var b=1/(r-a),E=1/(h-p),k=1/(g-v);return s[0]=-2*b,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*E,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*k,s[11]=0,s[12]=(r+a)*b,s[13]=(p+h)*E,s[14]=(v+g)*k,s[15]=1,s},u.pbf=Sp,u.perspective=function(s,r,a,h,p){var g,v=1/Math.tan(r/2);return s[0]=v/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=v,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,null!=p&&p!==1/0?(s[10]=(p+h)*(g=1/(h-p)),s[14]=2*p*h*g):(s[10]=-1,s[14]=-2*h),s},u.pick=function(s,r){const a={};for(let h=0;h<r.length;h++){const p=r[h];p in s&&(a[p]=s[p])}return a},u.plugin=kt,u.pointGeometry=I,u.polesInViewport=function(s){const r=Vl(new Float64Array(16));vc(r,s.pixelMatrix,s.globeMatrix);const a=[0,Ha,0],h=[0,Ga,0];return Hr(a,a,r),Hr(h,h,r),[a[0]>0&&a[0]<=s.width&&a[1]>0&&a[1]<=s.height&&!V_(s,new Dn(s.center.lat,90)),h[0]>0&&h[0]<=s.width&&h[1]>0&&h[1]<=s.height&&!V_(s,new Dn(s.center.lat,-90))]},u.polygonContainsPoint=$h,u.polygonIntersectsBox=qg,u.polygonIntersectsPolygon=Cw,u.polygonizeBounds=function(s,r,a=0,h=!0){const p=new I(a,a),g=s.sub(p),v=r.add(p),b=[g,new I(v.x,g.y),v,new I(g.x,v.y)];return h&&b.push(g.clone()),b},u.posAttributes=Fp,u.postMapLoadEvent=nt,u.postPerformanceEvent=Dt,u.postTurnstileEvent=Fe,u.potpack=C_,u.prevPowerOfTwo=function(s){return s<=1?1:Math.pow(2,Math.floor(Math.log(s)/Math.LN2))},u.radToDeg=ie,u.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],u.registerForPluginStateChange=function(s){return s({pluginStatus:Je,pluginURL:Ye}),pt.on("pluginStateChange",s),s},u.removeAuthState=function(s){Mt.delete(s)},u.renderColorRamp=em,u.resample=Uh,u.rotateX=Xf,u.rotateX$1=qf,u.rotateY=jl,u.rotateY$1=Yf,u.rotateZ=function(s,r,a){var h=Math.sin(a),p=Math.cos(a),g=r[0],v=r[1],b=r[2],E=r[3],k=r[4],X=r[5],se=r[6],he=r[7];return r!==s&&(s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[0]=g*p+k*h,s[1]=v*p+X*h,s[2]=b*p+se*h,s[3]=E*p+he*h,s[4]=k*p-g*h,s[5]=X*p-v*h,s[6]=se*p-b*h,s[7]=he*p-E*h,s},u.rotateZ$1=function(s,r,a){a*=.5;var h=r[0],p=r[1],g=r[2],v=r[3],b=Math.sin(a),E=Math.cos(a);return s[0]=h*E+p*b,s[1]=p*E-h*b,s[2]=g*E+v*b,s[3]=v*E-g*b,s},u.scale=Qc,u.scale$1=Jg,u.scale$2=ba,u.scaleAndAdd=ed,u.set=function(s,r,a,h){return s[0]=r,s[1]=a,s[2]=h,s},u.setCacheLimits=function(s,r){Ut=s,bt=r},u.setColumn=function(s,r,a){s[4*r+0]=a[0],s[4*r+1]=a[1],s[4*r+2]=a[2],s[4*r+3]=a[3]},u.setRTLTextPlugin=function(s,r,a=!1){if(Je===$e||Je===qe||Je===Ue)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ye=Li.resolveURL(s),Je=$e,He=r,mt(),a||Rt()},u.smoothstep=z,u.spec=$t,u.squaredLength=function(s){var r=s[0],a=s[1],h=s[2];return r*r+a*a+h*h},u.storeAuthState=function(s,r){r?Mt.add(s):Mt.delete(s)},u.sub=xo,u.subtract=Kg,u.symbolSize=f0,u.tileAABB=function(s,r,a,h,p,g,v,b,E){if("globe"===E.name)return function Wr(s,r,a){const h=r/s.worldSize,p=s.globeMatrix;if(a.z<=1){const It=Xl(a).getCorners();return B_(It,p,h),Cs.fromPoints(It)}const g=Sm(a),v=Np(g);B_(v,p,h);const b=Number.MAX_VALUE,E=[-b,-b,-b],k=[b,b,b];if(g.contains(s.center)){for(const ii of v)fp(k,k,ii),mp(E,E,ii);E[2]=0;const It=s.point,Wt=[It.x*h,It.y*h,0];return fp(k,k,Wt),mp(E,E,Wt),new Cs(k,E)}const X=[p[12]*h,p[13]*h,p[14]*h],se=g.getCenter(),he=D(s.center.lat,-85.051129,zl),_e=D(se.lat,-85.051129,zl),Ee=al(s.center.lng),Oe=nr(he);let Ve=Ee-al(se.lng);const tt=Oe-nr(_e);Ve>.5?Ve-=1:Ve<-.5&&(Ve+=1);let ht=0;Math.abs(Ve)>Math.abs(tt)?ht=Ve>=0?1:3:(ht=tt>=0?0:2,ed(X,X,[p[4]*h,p[5]*h,p[6]*h],-Math.sin(W(tt>=0?g.getSouth():g.getNorth()))*sn));const et=v[ht],st=v[(ht+1)%4],dt=new O0(et,st,X),ut=[F_(dt,0)||et[0],F_(dt,1)||et[1],F_(dt,2)||et[2]],Ot=yd(s.zoom);if(Ot>0){const It=function({x:ii,y:Bt,z:Xt},Qt,Jt,oi,Vt){const di=1/(1<<Xt);let ji=ii*di,bi=ji+di,Si=Bt*di,yi=Si+di,qi=0;const kn=(ji+bi)/2-oi;return kn>.5?qi=-1:kn<-.5&&(qi=1),ji=((ji+qi)*Qt-(oi*=Qt))*Jt+oi,bi=((bi+qi)*Qt-oi)*Jt+oi,Si=(Si*Qt-(Vt*=Qt))*Jt+Vt,yi=(yi*Qt-Vt)*Jt+Vt,[[ji,yi,0],[bi,yi,0],[bi,Si,0],[ji,Si,0]]}(a,r,s._pixelsPerMercatorPixel,Ee,Oe);for(let ii=0;ii<v.length;ii++)_d(v[ii],It[ii],Ot);const Wt=xc([],It[ht],It[(ht+1)%4]);ba(Wt,Wt,.5),_d(ut,Wt,Ot)}for(const It of v)fp(k,k,It),mp(E,E,It);return k[2]=Math.min(et[2],st[2]),fp(k,k,ut),mp(E,E,ut),new Cs(k,E)}(s,r,new fm(a,h,p));const k=tu({z:a,x:h,y:p},E);return new Cs([(g+k.x/k.scale)*r,r*(k.y/k.scale),v],[(g+k.x2/k.scale)*r,r*(k.y2/k.scale),b])},u.tileCornersToBounds=Sm,u.tileTransform=tu,u.transformMat3=function(s,r,a){var h=r[0],p=r[1],g=r[2];return s[0]=h*a[0]+p*a[3]+g*a[6],s[1]=h*a[1]+p*a[4]+g*a[7],s[2]=h*a[2]+p*a[5]+g*a[8],s},u.transformMat4=Hr,u.transformMat4$1=nd,u.transformQuat=td,u.transitionTileAABBinECEF=N_,u.translate=Ju,u.transpose=function(s,r){if(s===r){var a=r[1],h=r[2],p=r[5];s[1]=r[3],s[2]=r[6],s[3]=a,s[5]=r[7],s[6]=h,s[7]=p}else s[0]=r[0],s[1]=r[3],s[2]=r[6],s[3]=r[1],s[4]=r[4],s[5]=r[7],s[6]=r[2],s[7]=r[5],s[8]=r[8];return s},u.triggerPluginCompletionEvent=rt,u.uniqueId=M,u.updateGlobeVertexNormal=function(s,r,a,h,p){const g=5*r+2;s.float32[g+0]=a,s.float32[g+1]=h,s.float32[g+2]=p},u.validateCustomStyleLayer=function(s){const r=[],a=s.id;return void 0===a&&r.push({message:`layers.${a}: missing required property "id"`}),void 0===s.render&&r.push({message:`layers.${a}: missing required method "render"`}),s.renderingMode&&"2d"!==s.renderingMode&&"3d"!==s.renderingMode&&r.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),r},u.validateFilter=s=>ma(Uc(s)),u.validateFog=s=>ma(Vn(s)),u.validateLayer=s=>ma(Uu(s)),u.validateLight=s=>ma(Lf(s)),u.validateSource=s=>ma(ip(s)),u.validateStyle=Hu,u.validateTerrain=s=>ma(ai(s)),u.values=T,u.vectorTile=sm,u.version=me,u.warnOnce=De,u.window=re,u.wrap=A}),lo(0,function(u){function re(Qe){if("number"==typeof Qe||"boolean"==typeof Qe||"string"==typeof Qe||null==Qe)return JSON.stringify(Qe);if(Array.isArray(Qe)){let Fe="[";for(const Ke of Qe)Fe+=`${re(Ke)},`;return`${Fe}]`}let Ae="{";for(const Fe of Object.keys(Qe).sort())Ae+=`${Fe}:${re(Qe[Fe])},`;return`${Ae}}`}function me(Qe){let Ae="";for(const Fe of u.refProperties)Ae+=`/${re(Qe[Fe])}`;return Ae}class Te{constructor(Ae){this.keyCache={},Ae&&this.replace(Ae)}replace(Ae){this._layerConfigs={},this._layers={},this.update(Ae,[])}update(Ae,Fe){for(const nt of Ae)this._layerConfigs[nt.id]=nt,(this._layers[nt.id]=u.createStyleLayer(nt)).compileFilter(),this.keyCache[nt.id]&&delete this.keyCache[nt.id];for(const nt of Fe)delete this.keyCache[nt],delete this._layerConfigs[nt],delete this._layers[nt];this.familiesBySource={};const Ke=function(nt,gt){const Dt={};for(let _t=0;_t<nt.length;_t++){const Mt=gt&&gt[nt[_t].id]||me(nt[_t]);gt&&(gt[nt[_t].id]=Mt);let Yt=Dt[Mt];Yt||(Yt=Dt[Mt]=[]),Yt.push(nt[_t])}const Et=[];for(const _t in Dt)Et.push(Dt[_t]);return Et}(u.values(this._layerConfigs),this.keyCache);for(const nt of Ke){const gt=nt.map(gi=>this._layers[gi.id]),Dt=gt[0];if("none"===Dt.visibility)continue;const Et=Dt.source||"";let _t=this.familiesBySource[Et];_t||(_t=this.familiesBySource[Et]={});const Mt=Dt.sourceLayer||"_geojsonTileLayer";let Yt=_t[Mt];Yt||(Yt=_t[Mt]=[]),Yt.push(gt)}}}class Ce{loadTile(Ae,Fe){const{uid:Ke,encoding:nt,rawImageData:gt,padding:Dt,buildQuadTree:Et}=Ae,_t=u.window.ImageBitmap&&gt instanceof u.window.ImageBitmap?this.getImageData(gt,Dt):gt;Fe(null,new u.DEMData(Ke,_t,nt,Dt<1,Et))}getImageData(Ae,Fe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Ae.width,Ae.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Ae.width,this.offscreenCanvas.height=Ae.height,this.offscreenCanvasContext.drawImage(Ae,0,0,Ae.width,Ae.height);const Ke=this.offscreenCanvasContext.getImageData(-Fe,-Fe,Ae.width+2*Fe,Ae.height+2*Fe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ke}}var Se=function Qe(Ae,Fe){var Ke,nt=Ae&&Ae.type;if("FeatureCollection"===nt)for(Ke=0;Ke<Ae.features.length;Ke++)Qe(Ae.features[Ke],Fe);else if("GeometryCollection"===nt)for(Ke=0;Ke<Ae.geometries.length;Ke++)Qe(Ae.geometries[Ke],Fe);else if("Feature"===nt)Qe(Ae.geometry,Fe);else if("Polygon"===nt)be(Ae.coordinates,Fe);else if("MultiPolygon"===nt)for(Ke=0;Ke<Ae.coordinates.length;Ke++)be(Ae.coordinates[Ke],Fe);return Ae};function be(Qe,Ae){if(0!==Qe.length){ce(Qe[0],Ae);for(var Fe=1;Fe<Qe.length;Fe++)ce(Qe[Fe],!Ae)}}function ce(Qe,Ae){for(var Fe=0,Ke=0,nt=0,gt=Qe.length,Dt=gt-1;nt<gt;Dt=nt++){var Et=(Qe[nt][0]-Qe[Dt][0])*(Qe[Dt][1]+Qe[nt][1]),_t=Fe+Et;Ke+=Math.abs(Fe)>=Math.abs(Et)?Fe-_t+Et:Et-_t+Fe,Fe=_t}Fe+Ke>=0!=!!Ae&&Qe.reverse()}const ne=u.VectorTileFeature.prototype.toGeoJSON;class K{constructor(Ae){this._feature=Ae,this.extent=u.EXTENT,this.type=Ae.type,this.properties=Ae.tags,"id"in Ae&&!isNaN(Ae.id)&&(this.id=parseInt(Ae.id,10))}loadGeometry(){if(1===this._feature.type){const Ae=[];for(const Fe of this._feature.geometry)Ae.push([new u.pointGeometry(Fe[0],Fe[1])]);return Ae}{const Ae=[];for(const Fe of this._feature.geometry){const Ke=[];for(const nt of Fe)Ke.push(new u.pointGeometry(nt[0],nt[1]));Ae.push(Ke)}return Ae}}toGeoJSON(Ae,Fe,Ke){return ne.call(this,Ae,Fe,Ke)}}class Y{constructor(Ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=u.EXTENT,this.length=Ae.length,this._features=Ae}feature(Ae){return new K(this._features[Ae])}}var j={exports:{}},N=u.pointGeometry,R=u.vectorTile.VectorTileFeature,I=B;function B(Qe,Ae){this.options=Ae||{},this.features=Qe,this.length=Qe.length}function P(Qe,Ae){this.id="number"==typeof Qe.id?Qe.id:void 0,this.type=Qe.type,this.rawGeometry=1===Qe.type?[Qe.geometry]:Qe.geometry,this.properties=Qe.tags,this.extent=Ae||4096}B.prototype.feature=function(Qe){return new P(this.features[Qe],this.options.extent)},P.prototype.loadGeometry=function(){var Qe=this.rawGeometry;this.geometry=[];for(var Ae=0;Ae<Qe.length;Ae++){for(var Fe=Qe[Ae],Ke=[],nt=0;nt<Fe.length;nt++)Ke.push(new N(Fe[nt][0],Fe[nt][1]));this.geometry.push(Ke)}return this.geometry},P.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Qe=this.geometry,Ae=1/0,Fe=-1/0,Ke=1/0,nt=-1/0,gt=0;gt<Qe.length;gt++)for(var Dt=Qe[gt],Et=0;Et<Dt.length;Et++){var _t=Dt[Et];Ae=Math.min(Ae,_t.x),Fe=Math.max(Fe,_t.x),Ke=Math.min(Ke,_t.y),nt=Math.max(nt,_t.y)}return[Ae,Ke,Fe,nt]},P.prototype.toGeoJSON=R.prototype.toGeoJSON;var H=u.pbf,W=I;function ie(Qe){var Ae=new H;return function(Fe,Ke){for(var nt in Fe.layers)Ke.writeMessage(3,te,Fe.layers[nt])}(Qe,Ae),Ae.finish()}function te(Qe,Ae){var Fe;Ae.writeVarintField(15,Qe.version||1),Ae.writeStringField(1,Qe.name||""),Ae.writeVarintField(5,Qe.extent||4096);var Ke={keys:[],values:[],keycache:{},valuecache:{}};for(Fe=0;Fe<Qe.length;Fe++)Ke.feature=Qe.feature(Fe),Ae.writeMessage(2,ee,Ke);var nt=Ke.keys;for(Fe=0;Fe<nt.length;Fe++)Ae.writeStringField(3,nt[Fe]);var gt=Ke.values;for(Fe=0;Fe<gt.length;Fe++)Ae.writeMessage(4,A,gt[Fe])}function ee(Qe,Ae){var Fe=Qe.feature;void 0!==Fe.id&&Ae.writeVarintField(1,Fe.id),Ae.writeMessage(2,J,Qe),Ae.writeVarintField(3,Fe.type),Ae.writeMessage(4,z,Fe)}function J(Qe,Ae){var Fe=Qe.feature,Ke=Qe.keys,nt=Qe.values,gt=Qe.keycache,Dt=Qe.valuecache;for(var Et in Fe.properties){var _t=Fe.properties[Et],Mt=gt[Et];if(null!==_t){void 0===Mt&&(Ke.push(Et),gt[Et]=Mt=Ke.length-1),Ae.writeVarint(Mt);var Yt=typeof _t;"string"!==Yt&&"boolean"!==Yt&&"number"!==Yt&&(_t=JSON.stringify(_t));var gi=Yt+":"+_t,ni=Dt[gi];void 0===ni&&(nt.push(_t),Dt[gi]=ni=nt.length-1),Ae.writeVarint(ni)}}}function q(Qe,Ae){return(Ae<<3)+(7&Qe)}function D(Qe){return Qe<<1^Qe>>31}function z(Qe,Ae){for(var Fe=Qe.loadGeometry(),Ke=Qe.type,nt=0,gt=0,Dt=Fe.length,Et=0;Et<Dt;Et++){var _t=Fe[Et],Mt=1;1===Ke&&(Mt=_t.length),Ae.writeVarint(q(1,Mt));for(var Yt=3===Ke?_t.length-1:_t.length,gi=0;gi<Yt;gi++){1===gi&&1!==Ke&&Ae.writeVarint(q(2,Yt-1));var ni=_t[gi].x-nt,Hi=_t[gi].y-gt;Ae.writeVarint(D(ni)),Ae.writeVarint(D(Hi)),nt+=ni,gt+=Hi}3===Ke&&Ae.writeVarint(q(7,1))}}function A(Qe,Ae){var Fe=typeof Qe;"string"===Fe?Ae.writeStringField(1,Qe):"boolean"===Fe?Ae.writeBooleanField(7,Qe):"number"===Fe&&(Qe%1!=0?Ae.writeDoubleField(3,Qe):Qe<0?Ae.writeSVarintField(6,Qe):Ae.writeVarintField(5,Qe))}function U(Qe,Ae,Fe,Ke,nt,gt){if(nt-Ke<=Fe)return;const Dt=Ke+nt>>1;T(Qe,Ae,Dt,Ke,nt,gt%2),U(Qe,Ae,Fe,Ke,Dt-1,gt+1),U(Qe,Ae,Fe,Dt+1,nt,gt+1)}function T(Qe,Ae,Fe,Ke,nt,gt){for(;nt>Ke;){if(nt-Ke>600){const Mt=nt-Ke+1,Yt=Fe-Ke+1,gi=Math.log(Mt),ni=.5*Math.exp(2*gi/3),Hi=.5*Math.sqrt(gi*ni*(Mt-ni)/Mt)*(Yt-Mt/2<0?-1:1);T(Qe,Ae,Fe,Math.max(Ke,Math.floor(Fe-Yt*ni/Mt+Hi)),Math.min(nt,Math.floor(Fe+(Mt-Yt)*ni/Mt+Hi)),gt)}const Dt=Ae[2*Fe+gt];let Et=Ke,_t=nt;for(S(Qe,Ae,Ke,Fe),Ae[2*nt+gt]>Dt&&S(Qe,Ae,Ke,nt);Et<_t;){for(S(Qe,Ae,Et,_t),Et++,_t--;Ae[2*Et+gt]<Dt;)Et++;for(;Ae[2*_t+gt]>Dt;)_t--}Ae[2*Ke+gt]===Dt?S(Qe,Ae,Ke,_t):(_t++,S(Qe,Ae,_t,nt)),_t<=Fe&&(Ke=_t+1),Fe<=_t&&(nt=_t-1)}}function S(Qe,Ae,Fe,Ke){O(Qe,Fe,Ke),O(Ae,2*Fe,2*Ke),O(Ae,2*Fe+1,2*Ke+1)}function O(Qe,Ae,Fe){const Ke=Qe[Ae];Qe[Ae]=Qe[Fe],Qe[Fe]=Ke}function M(Qe,Ae,Fe,Ke){const nt=Qe-Fe,gt=Ae-Ke;return nt*nt+gt*gt}j.exports=ie,j.exports.fromVectorTileJs=ie,j.exports.fromGeojsonVt=function(Qe,Ae){Ae=Ae||{};var Fe={};for(var Ke in Qe)Fe[Ke]=new W(Qe[Ke].features,Ae),Fe[Ke].name=Ke,Fe[Ke].version=Ae.version,Fe[Ke].extent=Ae.extent;return ie({layers:Fe})},j.exports.GeoJSONWrapper=W;const Z=Qe=>Qe[0],ae=Qe=>Qe[1];class ue{constructor(Ae,Fe=Z,Ke=ae,nt=64,gt=Float64Array){this.nodeSize=nt,this.points=Ae;const Dt=Ae.length<65536?Uint16Array:Uint32Array,Et=this.ids=new Dt(Ae.length),_t=this.coords=new gt(2*Ae.length);for(let Mt=0;Mt<Ae.length;Mt++)Et[Mt]=Mt,_t[2*Mt]=Fe(Ae[Mt]),_t[2*Mt+1]=Ke(Ae[Mt]);U(Et,_t,nt,0,Et.length-1,0)}range(Ae,Fe,Ke,nt){return function(gt,Dt,Et,_t,Mt,Yt,gi){const ni=[0,gt.length-1,0],Hi=[];let zi,Pi;for(;ni.length;){const Yi=ni.pop(),dn=ni.pop(),Xn=ni.pop();if(dn-Xn<=gi){for(let vr=Xn;vr<=dn;vr++)zi=Dt[2*vr],Pi=Dt[2*vr+1],zi>=Et&&zi<=Mt&&Pi>=_t&&Pi<=Yt&&Hi.push(gt[vr]);continue}const Li=Math.floor((Xn+dn)/2);zi=Dt[2*Li],Pi=Dt[2*Li+1],zi>=Et&&zi<=Mt&&Pi>=_t&&Pi<=Yt&&Hi.push(gt[Li]);const sr=(Yi+1)%2;(0===Yi?Et<=zi:_t<=Pi)&&(ni.push(Xn),ni.push(Li-1),ni.push(sr)),(0===Yi?Mt>=zi:Yt>=Pi)&&(ni.push(Li+1),ni.push(dn),ni.push(sr))}return Hi}(this.ids,this.coords,Ae,Fe,Ke,nt,this.nodeSize)}within(Ae,Fe,Ke){return function(nt,gt,Dt,Et,_t,Mt){const Yt=[0,nt.length-1,0],gi=[],ni=_t*_t;for(;Yt.length;){const Hi=Yt.pop(),zi=Yt.pop(),Pi=Yt.pop();if(zi-Pi<=Mt){for(let sr=Pi;sr<=zi;sr++)M(gt[2*sr],gt[2*sr+1],Dt,Et)<=ni&&gi.push(nt[sr]);continue}const Yi=Math.floor((Pi+zi)/2),dn=gt[2*Yi],Xn=gt[2*Yi+1];M(dn,Xn,Dt,Et)<=ni&&gi.push(nt[Yi]);const Li=(Hi+1)%2;(0===Hi?Dt-_t<=dn:Et-_t<=Xn)&&(Yt.push(Pi),Yt.push(Yi-1),Yt.push(Li)),(0===Hi?Dt+_t>=dn:Et+_t>=Xn)&&(Yt.push(Yi+1),Yt.push(zi),Yt.push(Li))}return gi}(this.ids,this.coords,Ae,Fe,Ke,this.nodeSize)}}const ge={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Qe=>Qe},V=Math.fround||($=new Float32Array(1),Qe=>($[0]=+Qe,$[0]));var $;class de{constructor(Ae){this.options=we(Object.create(ge),Ae),this.trees=new Array(this.options.maxZoom+1)}load(Ae){const{log:Fe,minZoom:Ke,maxZoom:nt,nodeSize:gt}=this.options;Fe&&console.time("total time");const Dt=`prepare ${Ae.length} points`;Fe&&console.time(Dt),this.points=Ae;let Et=[];for(let _t=0;_t<Ae.length;_t++)Ae[_t].geometry&&Et.push(Ie(Ae[_t],_t));this.trees[nt+1]=new ue(Et,Le,Ne,gt,Float32Array),Fe&&console.timeEnd(Dt);for(let _t=nt;_t>=Ke;_t--){const Mt=+Date.now();Et=this._cluster(Et,_t),this.trees[_t]=new ue(Et,Le,Ne,gt,Float32Array),Fe&&console.log("z%d: %d clusters in %dms",_t,Et.length,+Date.now()-Mt)}return Fe&&console.timeEnd("total time"),this}getClusters(Ae,Fe){let Ke=((Ae[0]+180)%360+360)%360-180;const nt=Math.max(-90,Math.min(90,Ae[1]));let gt=180===Ae[2]?180:((Ae[2]+180)%360+360)%360-180;const Dt=Math.max(-90,Math.min(90,Ae[3]));if(Ae[2]-Ae[0]>=360)Ke=-180,gt=180;else if(Ke>gt){const Yt=this.getClusters([Ke,nt,180,Dt],Fe),gi=this.getClusters([-180,nt,gt,Dt],Fe);return Yt.concat(gi)}const Et=this.trees[this._limitZoom(Fe)],_t=Et.range(ve(Ke),xe(Dt),ve(gt),xe(nt)),Mt=[];for(const Yt of _t){const gi=Et.points[Yt];Mt.push(gi.numPoints?De(gi):this.points[gi.index])}return Mt}getChildren(Ae){const Fe=this._getOriginId(Ae),Ke=this._getOriginZoom(Ae),nt="No cluster with the specified id.",gt=this.trees[Ke];if(!gt)throw new Error(nt);const Dt=gt.points[Fe];if(!Dt)throw new Error(nt);const Et=this.options.radius/(this.options.extent*Math.pow(2,Ke-1)),_t=gt.within(Dt.x,Dt.y,Et),Mt=[];for(const Yt of _t){const gi=gt.points[Yt];gi.parentId===Ae&&Mt.push(gi.numPoints?De(gi):this.points[gi.index])}if(0===Mt.length)throw new Error(nt);return Mt}getLeaves(Ae,Fe,Ke){const nt=[];return this._appendLeaves(nt,Ae,Fe=Fe||10,Ke=Ke||0,0),nt}getTile(Ae,Fe,Ke){const nt=this.trees[this._limitZoom(Ae)],gt=Math.pow(2,Ae),{extent:Dt,radius:Et}=this.options,_t=Et/Dt,Mt=(Ke-_t)/gt,Yt=(Ke+1+_t)/gt,gi={features:[]};return this._addTileFeatures(nt.range((Fe-_t)/gt,Mt,(Fe+1+_t)/gt,Yt),nt.points,Fe,Ke,gt,gi),0===Fe&&this._addTileFeatures(nt.range(1-_t/gt,Mt,1,Yt),nt.points,gt,Ke,gt,gi),Fe===gt-1&&this._addTileFeatures(nt.range(0,Mt,_t/gt,Yt),nt.points,-1,Ke,gt,gi),gi.features.length?gi:null}getClusterExpansionZoom(Ae){let Fe=this._getOriginZoom(Ae)-1;for(;Fe<=this.options.maxZoom;){const Ke=this.getChildren(Ae);if(Fe++,1!==Ke.length)break;Ae=Ke[0].properties.cluster_id}return Fe}_appendLeaves(Ae,Fe,Ke,nt,gt){const Dt=this.getChildren(Fe);for(const Et of Dt){const _t=Et.properties;if(_t&&_t.cluster?gt+_t.point_count<=nt?gt+=_t.point_count:gt=this._appendLeaves(Ae,_t.cluster_id,Ke,nt,gt):gt<nt?gt++:Ae.push(Et),Ae.length===Ke)break}return gt}_addTileFeatures(Ae,Fe,Ke,nt,gt,Dt){for(const Et of Ae){const _t=Fe[Et],Mt=_t.numPoints;let Yt,gi,ni;if(Mt)Yt=oe(_t),gi=_t.x,ni=_t.y;else{const Pi=this.points[_t.index];Yt=Pi.properties,gi=ve(Pi.geometry.coordinates[0]),ni=xe(Pi.geometry.coordinates[1])}const Hi={type:1,geometry:[[Math.round(this.options.extent*(gi*gt-Ke)),Math.round(this.options.extent*(ni*gt-nt))]],tags:Yt};let zi;Mt?zi=_t.id:this.options.generateId?zi=_t.index:this.points[_t.index].id&&(zi=this.points[_t.index].id),void 0!==zi&&(Hi.id=zi),Dt.features.push(Hi)}}_limitZoom(Ae){return Math.max(this.options.minZoom,Math.min(Math.floor(+Ae),this.options.maxZoom+1))}_cluster(Ae,Fe){const Ke=[],{radius:nt,extent:gt,reduce:Dt,minPoints:Et}=this.options,_t=nt/(gt*Math.pow(2,Fe));for(let Mt=0;Mt<Ae.length;Mt++){const Yt=Ae[Mt];if(Yt.zoom<=Fe)continue;Yt.zoom=Fe;const gi=this.trees[Fe+1],ni=gi.within(Yt.x,Yt.y,_t),Hi=Yt.numPoints||1;let zi=Hi;for(const Pi of ni){const Yi=gi.points[Pi];Yi.zoom>Fe&&(zi+=Yi.numPoints||1)}if(zi>Hi&&zi>=Et){let Pi=Yt.x*Hi,Yi=Yt.y*Hi,dn=Dt&&Hi>1?this._map(Yt,!0):null;const Xn=(Mt<<5)+(Fe+1)+this.points.length;for(const Li of ni){const sr=gi.points[Li];if(sr.zoom<=Fe)continue;sr.zoom=Fe;const vr=sr.numPoints||1;Pi+=sr.x*vr,Yi+=sr.y*vr,sr.parentId=Xn,Dt&&(dn||(dn=this._map(Yt,!0)),Dt(dn,this._map(sr)))}Yt.parentId=Xn,Ke.push(Me(Pi/zi,Yi/zi,Xn,zi,dn))}else if(Ke.push(Yt),zi>1)for(const Pi of ni){const Yi=gi.points[Pi];Yi.zoom<=Fe||(Yi.zoom=Fe,Ke.push(Yi))}}return Ke}_getOriginId(Ae){return Ae-this.points.length>>5}_getOriginZoom(Ae){return(Ae-this.points.length)%32}_map(Ae,Fe){if(Ae.numPoints)return Fe?we({},Ae.properties):Ae.properties;const Ke=this.points[Ae.index].properties,nt=this.options.map(Ke);return Fe&&nt===Ke?we({},nt):nt}}function Me(Qe,Ae,Fe,Ke,nt){return{x:V(Qe),y:V(Ae),zoom:1/0,id:Fe,parentId:-1,numPoints:Ke,properties:nt}}function Ie(Qe,Ae){const[Fe,Ke]=Qe.geometry.coordinates;return{x:V(ve(Fe)),y:V(xe(Ke)),zoom:1/0,index:Ae,parentId:-1}}function De(Qe){return{type:"Feature",id:Qe.id,properties:oe(Qe),geometry:{type:"Point",coordinates:[(Ae=Qe.x,360*(Ae-.5)),Re(Qe.y)]}};var Ae}function oe(Qe){const Ae=Qe.numPoints,Fe=Ae>=1e4?`${Math.round(Ae/1e3)}k`:Ae>=1e3?Math.round(Ae/100)/10+"k":Ae;return we(we({},Qe.properties),{cluster:!0,cluster_id:Qe.id,point_count:Ae,point_count_abbreviated:Fe})}function ve(Qe){return Qe/360+.5}function xe(Qe){const Ae=Math.sin(Qe*Math.PI/180),Fe=.5-.25*Math.log((1+Ae)/(1-Ae))/Math.PI;return Fe<0?0:Fe>1?1:Fe}function Re(Qe){const Ae=(180-360*Qe)*Math.PI/180;return 360*Math.atan(Math.exp(Ae))/Math.PI-90}function we(Qe,Ae){for(const Fe in Ae)Qe[Fe]=Ae[Fe];return Qe}function Le(Qe){return Qe.x}function Ne(Qe){return Qe.y}function Ze(Qe,Ae,Fe,Ke){for(var nt,gt=Ke,Dt=Fe-Ae>>1,Et=Fe-Ae,_t=Qe[Ae],Mt=Qe[Ae+1],Yt=Qe[Fe],gi=Qe[Fe+1],ni=Ae+3;ni<Fe;ni+=3){var Hi=at(Qe[ni],Qe[ni+1],_t,Mt,Yt,gi);if(Hi>gt)nt=ni,gt=Hi;else if(Hi===gt){var zi=Math.abs(ni-Dt);zi<Et&&(nt=ni,Et=zi)}}gt>Ke&&(nt-Ae>3&&Ze(Qe,Ae,nt,Ke),Qe[nt+2]=gt,Fe-nt>3&&Ze(Qe,nt,Fe,Ke))}function at(Qe,Ae,Fe,Ke,nt,gt){var Dt=nt-Fe,Et=gt-Ke;if(0!==Dt||0!==Et){var _t=((Qe-Fe)*Dt+(Ae-Ke)*Et)/(Dt*Dt+Et*Et);_t>1?(Fe=nt,Ke=gt):_t>0&&(Fe+=Dt*_t,Ke+=Et*_t)}return(Dt=Qe-Fe)*Dt+(Et=Ae-Ke)*Et}function wt(Qe,Ae,Fe,Ke){var nt={id:void 0===Qe?null:Qe,type:Ae,geometry:Fe,tags:Ke,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(gt){var Dt=gt.geometry,Et=gt.type;if("Point"===Et||"MultiPoint"===Et||"LineString"===Et)Tt(gt,Dt);else if("Polygon"===Et||"MultiLineString"===Et)for(var _t=0;_t<Dt.length;_t++)Tt(gt,Dt[_t]);else if("MultiPolygon"===Et)for(_t=0;_t<Dt.length;_t++)for(var Mt=0;Mt<Dt[_t].length;Mt++)Tt(gt,Dt[_t][Mt])}(nt),nt}function Tt(Qe,Ae){for(var Fe=0;Fe<Ae.length;Fe+=3)Qe.minX=Math.min(Qe.minX,Ae[Fe]),Qe.minY=Math.min(Qe.minY,Ae[Fe+1]),Qe.maxX=Math.max(Qe.maxX,Ae[Fe]),Qe.maxY=Math.max(Qe.maxY,Ae[Fe+1])}function Ut(Qe,Ae,Fe,Ke){if(Ae.geometry){var nt=Ae.geometry.coordinates,gt=Ae.geometry.type,Dt=Math.pow(Fe.tolerance/((1<<Fe.maxZoom)*Fe.extent),2),Et=[],_t=Ae.id;if(Fe.promoteId?_t=Ae.properties[Fe.promoteId]:Fe.generateId&&(_t=Ke||0),"Point"===gt)bt(nt,Et);else if("MultiPoint"===gt)for(var Mt=0;Mt<nt.length;Mt++)bt(nt[Mt],Et);else if("LineString"===gt)lt(nt,Et,Dt,!1);else if("MultiLineString"===gt){if(Fe.lineMetrics){for(Mt=0;Mt<nt.length;Mt++)lt(nt[Mt],Et=[],Dt,!1),Qe.push(wt(_t,"LineString",Et,Ae.properties));return}Pe(nt,Et,Dt,!1)}else if("Polygon"===gt)Pe(nt,Et,Dt,!0);else{if("MultiPolygon"!==gt){if("GeometryCollection"===gt){for(Mt=0;Mt<Ae.geometry.geometries.length;Mt++)Ut(Qe,{id:_t,geometry:Ae.geometry.geometries[Mt],properties:Ae.properties},Fe,Ke);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Mt=0;Mt<nt.length;Mt++){var Yt=[];Pe(nt[Mt],Yt,Dt,!0),Et.push(Yt)}}Qe.push(wt(_t,gt,Et,Ae.properties))}}function bt(Qe,Ae){Ae.push(je(Qe[0])),Ae.push(it(Qe[1])),Ae.push(0)}function lt(Qe,Ae,Fe,Ke){for(var nt,gt,Dt=0,Et=0;Et<Qe.length;Et++){var _t=je(Qe[Et][0]),Mt=it(Qe[Et][1]);Ae.push(_t),Ae.push(Mt),Ae.push(0),Et>0&&(Dt+=Ke?(nt*Mt-_t*gt)/2:Math.sqrt(Math.pow(_t-nt,2)+Math.pow(Mt-gt,2))),nt=_t,gt=Mt}var Yt=Ae.length-3;Ae[2]=1,Ze(Ae,0,Yt,Fe),Ae[Yt+2]=1,Ae.size=Math.abs(Dt),Ae.start=0,Ae.end=Ae.size}function Pe(Qe,Ae,Fe,Ke){for(var nt=0;nt<Qe.length;nt++){var gt=[];lt(Qe[nt],gt,Fe,Ke),Ae.push(gt)}}function je(Qe){return Qe/360+.5}function it(Qe){var Ae=Math.sin(Qe*Math.PI/180),Fe=.5-.25*Math.log((1+Ae)/(1-Ae))/Math.PI;return Fe<0?0:Fe>1?1:Fe}function ct(Qe,Ae,Fe,Ke,nt,gt,Dt,Et){if(Ke/=Ae,gt>=(Fe/=Ae)&&Dt<Ke)return Qe;if(Dt<Fe||gt>=Ke)return null;for(var _t=[],Mt=0;Mt<Qe.length;Mt++){var Yt=Qe[Mt],gi=Yt.geometry,ni=Yt.type,Hi=0===nt?Yt.minX:Yt.minY,zi=0===nt?Yt.maxX:Yt.maxY;if(Hi>=Fe&&zi<Ke)_t.push(Yt);else if(!(zi<Fe||Hi>=Ke)){var Pi=[];if("Point"===ni||"MultiPoint"===ni)vt(gi,Pi,Fe,Ke,nt);else if("LineString"===ni)Nt(gi,Pi,Fe,Ke,nt,!1,Et.lineMetrics);else if("MultiLineString"===ni)vi(gi,Pi,Fe,Ke,nt,!1);else if("Polygon"===ni)vi(gi,Pi,Fe,Ke,nt,!0);else if("MultiPolygon"===ni)for(var Yi=0;Yi<gi.length;Yi++){var dn=[];vi(gi[Yi],dn,Fe,Ke,nt,!0),dn.length&&Pi.push(dn)}if(Pi.length){if(Et.lineMetrics&&"LineString"===ni){for(Yi=0;Yi<Pi.length;Yi++)_t.push(wt(Yt.id,ni,Pi[Yi],Yt.tags));continue}"LineString"!==ni&&"MultiLineString"!==ni||(1===Pi.length?(ni="LineString",Pi=Pi[0]):ni="MultiLineString"),"Point"!==ni&&"MultiPoint"!==ni||(ni=3===Pi.length?"Point":"MultiPoint"),_t.push(wt(Yt.id,ni,Pi,Yt.tags))}}}return _t.length?_t:null}function vt(Qe,Ae,Fe,Ke,nt){for(var gt=0;gt<Qe.length;gt+=3){var Dt=Qe[gt+nt];Dt>=Fe&&Dt<=Ke&&(Ae.push(Qe[gt]),Ae.push(Qe[gt+1]),Ae.push(Qe[gt+2]))}}function Nt(Qe,Ae,Fe,Ke,nt,gt,Dt){for(var Et,_t,Mt=Kt(Qe),Yt=0===nt?mi:Ii,gi=Qe.start,ni=0;ni<Qe.length-3;ni+=3){var Hi=Qe[ni],zi=Qe[ni+1],Pi=Qe[ni+2],Yi=Qe[ni+3],dn=Qe[ni+4],Xn=0===nt?Hi:zi,Li=0===nt?Yi:dn,sr=!1;Dt&&(Et=Math.sqrt(Math.pow(Hi-Yi,2)+Math.pow(zi-dn,2))),Xn<Fe?Li>Fe&&(_t=Yt(Mt,Hi,zi,Yi,dn,Fe),Dt&&(Mt.start=gi+Et*_t)):Xn>Ke?Li<Ke&&(_t=Yt(Mt,Hi,zi,Yi,dn,Ke),Dt&&(Mt.start=gi+Et*_t)):Ki(Mt,Hi,zi,Pi),Li<Fe&&Xn>=Fe&&(_t=Yt(Mt,Hi,zi,Yi,dn,Fe),sr=!0),Li>Ke&&Xn<=Ke&&(_t=Yt(Mt,Hi,zi,Yi,dn,Ke),sr=!0),!gt&&sr&&(Dt&&(Mt.end=gi+Et*_t),Ae.push(Mt),Mt=Kt(Qe)),Dt&&(gi+=Et)}var vr=Qe.length-3;Hi=Qe[vr],zi=Qe[vr+1],Pi=Qe[vr+2],(Xn=0===nt?Hi:zi)>=Fe&&Xn<=Ke&&Ki(Mt,Hi,zi,Pi),vr=Mt.length-3,gt&&vr>=3&&(Mt[vr]!==Mt[0]||Mt[vr+1]!==Mt[1])&&Ki(Mt,Mt[0],Mt[1],Mt[2]),Mt.length&&Ae.push(Mt)}function Kt(Qe){var Ae=[];return Ae.size=Qe.size,Ae.start=Qe.start,Ae.end=Qe.end,Ae}function vi(Qe,Ae,Fe,Ke,nt,gt){for(var Dt=0;Dt<Qe.length;Dt++)Nt(Qe[Dt],Ae,Fe,Ke,nt,gt,!1)}function Ki(Qe,Ae,Fe,Ke){Qe.push(Ae),Qe.push(Fe),Qe.push(Ke)}function mi(Qe,Ae,Fe,Ke,nt,gt){var Dt=(gt-Ae)/(Ke-Ae);return Qe.push(gt),Qe.push(Fe+(nt-Fe)*Dt),Qe.push(1),Dt}function Ii(Qe,Ae,Fe,Ke,nt,gt){var Dt=(gt-Fe)/(nt-Fe);return Qe.push(Ae+(Ke-Ae)*Dt),Qe.push(gt),Qe.push(1),Dt}function xn(Qe,Ae){for(var Fe=[],Ke=0;Ke<Qe.length;Ke++){var nt,gt=Qe[Ke],Dt=gt.type;if("Point"===Dt||"MultiPoint"===Dt||"LineString"===Dt)nt=Qi(gt.geometry,Ae);else if("MultiLineString"===Dt||"Polygon"===Dt){nt=[];for(var Et=0;Et<gt.geometry.length;Et++)nt.push(Qi(gt.geometry[Et],Ae))}else if("MultiPolygon"===Dt)for(nt=[],Et=0;Et<gt.geometry.length;Et++){for(var _t=[],Mt=0;Mt<gt.geometry[Et].length;Mt++)_t.push(Qi(gt.geometry[Et][Mt],Ae));nt.push(_t)}Fe.push(wt(gt.id,Dt,nt,gt.tags))}return Fe}function Qi(Qe,Ae){var Fe=[];Fe.size=Qe.size,void 0!==Qe.start&&(Fe.start=Qe.start,Fe.end=Qe.end);for(var Ke=0;Ke<Qe.length;Ke+=3)Fe.push(Qe[Ke]+Ae,Qe[Ke+1],Qe[Ke+2]);return Fe}function bn(Qe,Ae){if(Qe.transformed)return Qe;var Fe,Ke,nt,gt=1<<Qe.z,Dt=Qe.x,Et=Qe.y;for(Fe=0;Fe<Qe.features.length;Fe++){var _t=Qe.features[Fe],Mt=_t.geometry,Yt=_t.type;if(_t.geometry=[],1===Yt)for(Ke=0;Ke<Mt.length;Ke+=2)_t.geometry.push(Ri(Mt[Ke],Mt[Ke+1],Ae,gt,Dt,Et));else for(Ke=0;Ke<Mt.length;Ke++){var gi=[];for(nt=0;nt<Mt[Ke].length;nt+=2)gi.push(Ri(Mt[Ke][nt],Mt[Ke][nt+1],Ae,gt,Dt,Et));_t.geometry.push(gi)}}return Qe.transformed=!0,Qe}function Ri(Qe,Ae,Fe,Ke,nt,gt){return[Math.round(Fe*(Qe*Ke-nt)),Math.round(Fe*(Ae*Ke-gt))]}function _r(Qe,Ae,Fe,Ke,nt){for(var gt=Ae===nt.maxZoom?0:nt.tolerance/((1<<Ae)*nt.extent),Dt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Fe,y:Ke,z:Ae,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Et=0;Et<Qe.length;Et++){Dt.numFeatures++,Er(Dt,Qe[Et],gt,nt);var _t=Qe[Et].minX,Mt=Qe[Et].minY,Yt=Qe[Et].maxX,gi=Qe[Et].maxY;_t<Dt.minX&&(Dt.minX=_t),Mt<Dt.minY&&(Dt.minY=Mt),Yt>Dt.maxX&&(Dt.maxX=Yt),gi>Dt.maxY&&(Dt.maxY=gi)}return Dt}function Er(Qe,Ae,Fe,Ke){var nt=Ae.geometry,gt=Ae.type,Dt=[];if("Point"===gt||"MultiPoint"===gt)for(var Et=0;Et<nt.length;Et+=3)Dt.push(nt[Et]),Dt.push(nt[Et+1]),Qe.numPoints++,Qe.numSimplified++;else if("LineString"===gt)or(Dt,nt,Qe,Fe,!1,!1);else if("MultiLineString"===gt||"Polygon"===gt)for(Et=0;Et<nt.length;Et++)or(Dt,nt[Et],Qe,Fe,"Polygon"===gt,0===Et);else if("MultiPolygon"===gt)for(var _t=0;_t<nt.length;_t++){var Mt=nt[_t];for(Et=0;Et<Mt.length;Et++)or(Dt,Mt[Et],Qe,Fe,!0,0===Et)}if(Dt.length){var Yt=Ae.tags||null;if("LineString"===gt&&Ke.lineMetrics){for(var gi in Yt={},Ae.tags)Yt[gi]=Ae.tags[gi];Yt.mapbox_clip_start=nt.start/nt.size,Yt.mapbox_clip_end=nt.end/nt.size}var ni={geometry:Dt,type:"Polygon"===gt||"MultiPolygon"===gt?3:"LineString"===gt||"MultiLineString"===gt?2:1,tags:Yt};null!==Ae.id&&(ni.id=Ae.id),Qe.features.push(ni)}}function or(Qe,Ae,Fe,Ke,nt,gt){var Dt=Ke*Ke;if(Ke>0&&Ae.size<(nt?Dt:Ke))Fe.numPoints+=Ae.length/3;else{for(var Et=[],_t=0;_t<Ae.length;_t+=3)(0===Ke||Ae[_t+2]>Dt)&&(Fe.numSimplified++,Et.push(Ae[_t]),Et.push(Ae[_t+1])),Fe.numPoints++;nt&&function(Mt,Yt){for(var gi=0,ni=0,Hi=Mt.length,zi=Hi-2;ni<Hi;zi=ni,ni+=2)gi+=(Mt[ni]-Mt[zi])*(Mt[ni+1]+Mt[zi+1]);if(gi>0===Yt)for(ni=0,Hi=Mt.length;ni<Hi/2;ni+=2){var Pi=Mt[ni],Yi=Mt[ni+1];Mt[ni]=Mt[Hi-2-ni],Mt[ni+1]=Mt[Hi-1-ni],Mt[Hi-2-ni]=Pi,Mt[Hi-1-ni]=Yi}}(Et,gt),Qe.push(Et)}}function go(Qe,Ae){var Fe=(Ae=this.options=function(nt,gt){for(var Dt in gt)nt[Dt]=gt[Dt];return nt}(Object.create(this.options),Ae)).debug;if(Fe&&console.time("preprocess data"),Ae.maxZoom<0||Ae.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ae.promoteId&&Ae.generateId)throw new Error("promoteId and generateId cannot be used together.");var nt,gt,Dt,Et,_t,Mt,Ke=function(nt,gt){var Dt=[];if("FeatureCollection"===nt.type)for(var Et=0;Et<nt.features.length;Et++)Ut(Dt,nt.features[Et],gt,Et);else Ut(Dt,"Feature"===nt.type?nt:{geometry:nt},gt);return Dt}(Qe,Ae);this.tiles={},this.tileCoords=[],Fe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ae.indexMaxZoom,Ae.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Et=nt=Ke,_t=ct(nt,1,-1-(Dt=(gt=Ae).buffer/gt.extent),Dt,0,-1,2,gt),Mt=ct(nt,1,1-Dt,2+Dt,0,-1,2,gt),(_t||Mt)&&(Et=ct(nt,1,-Dt,1+Dt,0,-1,2,gt)||[],_t&&(Et=xn(_t,1).concat(Et)),Mt&&(Et=Et.concat(xn(Mt,-1)))),(Ke=Et).length&&this.splitTile(Ke,0,0,0),Fe&&(Ke.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function yr(Qe,Ae,Fe){return 32*((1<<Qe)*Fe+Ae)+Qe}function kr(Qe,Ae){const Fe=Qe.tileID.canonical;if(!this._geoJSONIndex)return Ae(null,null);const Ke=this._geoJSONIndex.getTile(Fe.z,Fe.x,Fe.y);if(!Ke)return Ae(null,null);const nt=new Y(Ke.features);let gt=j.exports(nt);0===gt.byteOffset&&gt.byteLength===gt.buffer.byteLength||(gt=new Uint8Array(gt)),Ae(null,{vectorTile:nt,rawData:gt.buffer})}go.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},go.prototype.splitTile=function(Qe,Ae,Fe,Ke,nt,gt,Dt){for(var Et=[Qe,Ae,Fe,Ke],_t=this.options,Mt=_t.debug;Et.length;){Ke=Et.pop(),Fe=Et.pop(),Ae=Et.pop(),Qe=Et.pop();var Yt=1<<Ae,gi=yr(Ae,Fe,Ke),ni=this.tiles[gi];if(!ni&&(Mt>1&&console.time("creation"),ni=this.tiles[gi]=_r(Qe,Ae,Fe,Ke,_t),this.tileCoords.push({z:Ae,x:Fe,y:Ke}),Mt)){Mt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ae,Fe,Ke,ni.numFeatures,ni.numPoints,ni.numSimplified),console.timeEnd("creation"));var Hi="z"+Ae;this.stats[Hi]=(this.stats[Hi]||0)+1,this.total++}if(ni.source=Qe,nt){if(Ae===_t.maxZoom||Ae===nt)continue;var zi=1<<nt-Ae;if(Fe!==Math.floor(gt/zi)||Ke!==Math.floor(Dt/zi))continue}else if(Ae===_t.indexMaxZoom||ni.numPoints<=_t.indexMaxPoints)continue;if(ni.source=null,0!==Qe.length){Mt>1&&console.time("clipping");var Pi,Yi,dn,Xn,Li,sr,vr=.5*_t.buffer/_t.extent,Pa=.5-vr,bl=.5+vr,Ws=1+vr;Pi=Yi=dn=Xn=null,Li=ct(Qe,Yt,Fe-vr,Fe+bl,0,ni.minX,ni.maxX,_t),sr=ct(Qe,Yt,Fe+Pa,Fe+Ws,0,ni.minX,ni.maxX,_t),Qe=null,Li&&(Pi=ct(Li,Yt,Ke-vr,Ke+bl,1,ni.minY,ni.maxY,_t),Yi=ct(Li,Yt,Ke+Pa,Ke+Ws,1,ni.minY,ni.maxY,_t),Li=null),sr&&(dn=ct(sr,Yt,Ke-vr,Ke+bl,1,ni.minY,ni.maxY,_t),Xn=ct(sr,Yt,Ke+Pa,Ke+Ws,1,ni.minY,ni.maxY,_t),sr=null),Mt>1&&console.timeEnd("clipping"),Et.push(Pi||[],Ae+1,2*Fe,2*Ke),Et.push(Yi||[],Ae+1,2*Fe,2*Ke+1),Et.push(dn||[],Ae+1,2*Fe+1,2*Ke),Et.push(Xn||[],Ae+1,2*Fe+1,2*Ke+1)}}},go.prototype.getTile=function(Qe,Ae,Fe){var Ke=this.options,nt=Ke.extent,gt=Ke.debug;if(Qe<0||Qe>24)return null;var Dt=1<<Qe,Et=yr(Qe,Ae=(Ae%Dt+Dt)%Dt,Fe);if(this.tiles[Et])return bn(this.tiles[Et],nt);gt>1&&console.log("drilling down to z%d-%d-%d",Qe,Ae,Fe);for(var _t,Mt=Qe,Yt=Ae,gi=Fe;!_t&&Mt>0;)Mt--,Yt=Math.floor(Yt/2),gi=Math.floor(gi/2),_t=this.tiles[yr(Mt,Yt,gi)];return _t&&_t.source?(gt>1&&console.log("found parent tile z%d-%d-%d",Mt,Yt,gi),gt>1&&console.time("drilling down"),this.splitTile(_t.source,Mt,Yt,gi,Qe,Ae,Fe),gt>1&&console.timeEnd("drilling down"),this.tiles[Et]?bn(this.tiles[Et],nt):null):null};class Fr extends u.VectorTileWorkerSource{constructor(Ae,Fe,Ke,nt,gt){super(Ae,Fe,Ke,nt,kr),gt&&(this.loadGeoJSON=gt)}loadData(Ae,Fe){const Ke=Ae&&Ae.request,nt=Ke&&Ke.collectResourceTiming;this.loadGeoJSON(Ae,(gt,Dt)=>{if(gt||!Dt)return Fe(gt);if("object"!=typeof Dt)return Fe(new Error(`Input data given to '${Ae.source}' is not a valid GeoJSON object.`));{Se(Dt,!0);try{if(Ae.filter){const _t=u.createExpression(Ae.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===_t.result)throw new Error(_t.value.map(Yt=>`${Yt.key}: ${Yt.message}`).join(", "));const Mt=Dt.features.filter(Yt=>_t.value.evaluate({zoom:0},Yt));Dt={type:"FeatureCollection",features:Mt}}this._geoJSONIndex=Ae.cluster?new de(function({superclusterOptions:_t,clusterProperties:Mt}){if(!Mt||!_t)return _t;const Yt={},gi={},ni={accumulated:null,zoom:0},Hi={properties:null},zi=Object.keys(Mt);for(const Pi of zi){const[Yi,dn]=Mt[Pi],Xn=u.createExpression(dn),Li=u.createExpression("string"==typeof Yi?[Yi,["accumulated"],["get",Pi]]:Yi);Yt[Pi]=Xn.value,gi[Pi]=Li.value}return _t.map=Pi=>{Hi.properties=Pi;const Yi={};for(const dn of zi)Yi[dn]=Yt[dn].evaluate(ni,Hi);return Yi},_t.reduce=(Pi,Yi)=>{Hi.properties=Yi;for(const dn of zi)ni.accumulated=Pi[dn],Pi[dn]=gi[dn].evaluate(ni,Hi)},_t}(Ae)).load(Dt.features):new go(_t=Dt,Ae.geojsonVtOptions)}catch(_t){return Fe(_t)}this.loaded={};const Et={};if(nt){const _t=u.getPerformanceMeasurement(Ke);_t&&(Et.resourceTiming={},Et.resourceTiming[Ae.source]=JSON.parse(JSON.stringify(_t)))}Fe(null,Et)}var _t})}reloadTile(Ae,Fe){const Ke=this.loaded;return Ke&&Ke[Ae.uid]?super.reloadTile(Ae,Fe):this.loadTile(Ae,Fe)}loadGeoJSON(Ae,Fe){if(Ae.request)u.getJSON(Ae.request,Fe);else{if("string"!=typeof Ae.data)return Fe(new Error(`Input data given to '${Ae.source}' is not a valid GeoJSON object.`));try{return Fe(null,JSON.parse(Ae.data))}catch{return Fe(new Error(`Input data given to '${Ae.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Ae,Fe){try{Fe(null,this._geoJSONIndex.getClusterExpansionZoom(Ae.clusterId))}catch(Ke){Fe(Ke)}}getClusterChildren(Ae,Fe){try{Fe(null,this._geoJSONIndex.getChildren(Ae.clusterId))}catch(Ke){Fe(Ke)}}getClusterLeaves(Ae,Fe){try{Fe(null,this._geoJSONIndex.getLeaves(Ae.clusterId,Ae.limit,Ae.offset))}catch(Ke){Fe(Ke)}}}class _o{constructor(Ae){this.self=Ae,this.actor=new u.Actor(Ae,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=u.getProjection({name:"mercator"}),this.workerSourceTypes={vector:u.VectorTileWorkerSource,geojson:Fr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Fe,Ke)=>{if(this.workerSourceTypes[Fe])throw new Error(`Worker source with name "${Fe}" already registered.`);this.workerSourceTypes[Fe]=Ke},this.self.registerRTLTextPlugin=Fe=>{if(u.plugin.isParsed())throw new Error("RTL text plugin already registered.");u.plugin.applyArabicShaping=Fe.applyArabicShaping,u.plugin.processBidirectionalText=Fe.processBidirectionalText,u.plugin.processStyledBidirectionalText=Fe.processStyledBidirectionalText}}clearCaches(Ae,Fe,Ke){delete this.layerIndexes[Ae],delete this.availableImages[Ae],delete this.workerSources[Ae],delete this.demWorkerSources[Ae],Ke()}checkIfReady(Ae,Fe,Ke){Ke()}setReferrer(Ae,Fe){this.referrer=Fe}spriteLoaded(Ae,Fe){this.isSpriteLoaded[Ae]=Fe;for(const Ke in this.workerSources[Ae]){const nt=this.workerSources[Ae][Ke];for(const gt in nt)nt[gt]instanceof u.VectorTileWorkerSource&&(nt[gt].isSpriteLoaded=Fe,nt[gt].fire(new u.Event("isSpriteLoaded")))}}setImages(Ae,Fe,Ke){this.availableImages[Ae]=Fe;for(const nt in this.workerSources[Ae]){const gt=this.workerSources[Ae][nt];for(const Dt in gt)gt[Dt].availableImages=Fe}Ke()}enableTerrain(Ae,Fe,Ke){this.terrain=Fe,Ke()}setProjection(Ae,Fe){this.projections[Ae]=u.getProjection(Fe)}setLayers(Ae,Fe,Ke){this.getLayerIndex(Ae).replace(Fe),Ke()}updateLayers(Ae,Fe,Ke){this.getLayerIndex(Ae).update(Fe.layers,Fe.removedIds),Ke()}loadTile(Ae,Fe,Ke){const nt=this.enableTerrain?u.extend({enableTerrain:this.terrain},Fe):Fe;nt.projection=this.projections[Ae]||this.defaultProjection,this.getWorkerSource(Ae,Fe.type,Fe.source).loadTile(nt,Ke)}loadDEMTile(Ae,Fe,Ke){const nt=this.enableTerrain?u.extend({buildQuadTree:this.terrain},Fe):Fe;this.getDEMWorkerSource(Ae,Fe.source).loadTile(nt,Ke)}reloadTile(Ae,Fe,Ke){const nt=this.enableTerrain?u.extend({enableTerrain:this.terrain},Fe):Fe;nt.projection=this.projections[Ae]||this.defaultProjection,this.getWorkerSource(Ae,Fe.type,Fe.source).reloadTile(nt,Ke)}abortTile(Ae,Fe,Ke){this.getWorkerSource(Ae,Fe.type,Fe.source).abortTile(Fe,Ke)}removeTile(Ae,Fe,Ke){this.getWorkerSource(Ae,Fe.type,Fe.source).removeTile(Fe,Ke)}removeSource(Ae,Fe,Ke){if(!this.workerSources[Ae]||!this.workerSources[Ae][Fe.type]||!this.workerSources[Ae][Fe.type][Fe.source])return;const nt=this.workerSources[Ae][Fe.type][Fe.source];delete this.workerSources[Ae][Fe.type][Fe.source],void 0!==nt.removeSource?nt.removeSource(Fe,Ke):Ke()}loadWorkerSource(Ae,Fe,Ke){try{this.self.importScripts(Fe.url),Ke()}catch(nt){Ke(nt.toString())}}syncRTLPluginState(Ae,Fe,Ke){try{u.plugin.setState(Fe);const nt=u.plugin.getPluginURL();if(u.plugin.isLoaded()&&!u.plugin.isParsed()&&null!=nt){this.self.importScripts(nt);const gt=u.plugin.isParsed();Ke(gt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${nt}`),gt)}}catch(nt){Ke(nt.toString())}}getAvailableImages(Ae){let Fe=this.availableImages[Ae];return Fe||(Fe=[]),Fe}getLayerIndex(Ae){let Fe=this.layerIndexes[Ae];return Fe||(Fe=this.layerIndexes[Ae]=new Te),Fe}getWorkerSource(Ae,Fe,Ke){return this.workerSources[Ae]||(this.workerSources[Ae]={}),this.workerSources[Ae][Fe]||(this.workerSources[Ae][Fe]={}),this.workerSources[Ae][Fe][Ke]||(this.workerSources[Ae][Fe][Ke]=new this.workerSourceTypes[Fe]({send:(gt,Dt,Et,_t,Mt,Yt)=>{this.actor.send(gt,Dt,Et,Ae,Mt,Yt)},scheduler:this.actor.scheduler},this.getLayerIndex(Ae),this.getAvailableImages(Ae),this.isSpriteLoaded[Ae])),this.workerSources[Ae][Fe][Ke]}getDEMWorkerSource(Ae,Fe){return this.demWorkerSources[Ae]||(this.demWorkerSources[Ae]={}),this.demWorkerSources[Ae][Fe]||(this.demWorkerSources[Ae][Fe]=new Ce),this.demWorkerSources[Ae][Fe]}enforceCacheSizeLimit(Ae,Fe){u.enforceCacheSizeLimit(Fe)}getWorkerPerformanceMetrics(Ae,Fe,Ke){Ke(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new _o(self)),_o}),lo(0,function(u){function re(m,l){if(Array.isArray(m)){if(!Array.isArray(l)||m.length!==l.length)return!1;for(let d=0;d<m.length;d++)if(!re(m[d],l[d]))return!1;return!0}if("object"==typeof m&&null!==m&&null!==l){if("object"!=typeof l||Object.keys(m).length!==Object.keys(l).length)return!1;for(const d in m)if(!re(m[d],l[d]))return!1;return!0}return m===l}var me=Te;function Te(m){return l=m,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var _,x,C=new Blob([""],{type:"text/javascript"}),F=URL.createObjectURL(C);try{x=new Worker(F),_=!0}catch{_=!1}return x&&x.terminate(),URL.revokeObjectURL(F),_}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var _=document.createElement("canvas");_.width=_.height=1;var x=_.getContext("2d");if(!x)return!1;var C=x.getImageData(0,0,1,1);return C&&C.width===_.width}()||(void 0===Ce[d=l&&l.failIfMajorPerformanceCaveat]&&(Ce[d]=function(_){var x,F,G,Q,C=(F=_,G=document.createElement("canvas"),(Q=Object.create(Te.webGLContextAttributes)).failIfMajorPerformanceCaveat=F,G.getContext("webgl",Q)||G.getContext("experimental-webgl",Q));if(!C)return!1;try{x=C.createShader(C.VERTEX_SHADER)}catch{return!1}return!(!x||C.isContextLost())&&(C.shaderSource(x,"void main() {}"),C.compileShader(x),!0===C.getShaderParameter(x,C.COMPILE_STATUS))}(d)),!Ce[d]||document.documentMode));var l,d}var Ce={};function Se(m,l,d){const _=u.window.document.createElement(m);return void 0!==l&&(_.className=l),d&&d.appendChild(_),_}function be(m,l,d){const _=u.window.document.createElementNS("http://www.w3.org/2000/svg",m);for(const x of Object.keys(l))_.setAttributeNS(null,x,l[x]);return d&&d.appendChild(_),_}Te.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const ce=u.window.document&&u.window.document.documentElement.style,ne=ce&&void 0!==ce.userSelect?"userSelect":"WebkitUserSelect";let K;function Y(){ce&&ne&&(K=ce[ne],ce[ne]="none")}function j(){ce&&ne&&(ce[ne]=K)}function N(m){m.preventDefault(),m.stopPropagation(),u.window.removeEventListener("click",N,!0)}function R(){u.window.addEventListener("click",N,!0),u.window.setTimeout(()=>{u.window.removeEventListener("click",N,!0)},0)}function I(m,l){const d=m.getBoundingClientRect();return H(m,d,l)}function B(m,l){const d=m.getBoundingClientRect(),_=[];for(let x=0;x<l.length;x++)_.push(H(m,d,l[x]));return _}function P(m){return void 0!==u.window.InstallTrigger&&2===m.button&&m.ctrlKey&&u.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function H(m,l,d){const _=m.offsetWidth===l.width?1:m.offsetWidth/l.width;return new u.pointGeometry((d.clientX-l.left)*_,(d.clientY-l.top)*_)}function W(m,l){var d=l[0],_=l[1],x=l[2],C=l[3],F=d*C-x*_;return F?(m[0]=C*(F=1/F),m[1]=-_*F,m[2]=-x*F,m[3]=d*F,m):null}function ie(m){const{userImage:l}=m;return!!(l&&l.render&&l.render())&&(m.data.replace(new Uint8Array(l.data.buffer)),!0)}class te extends u.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:d,callback:_}of this.requestors)this._notify(d,_);this.requestors=[]}}hasImage(l){return!!this.getImage(l)}getImage(l){return this.images[l]}addImage(l,d){this._validate(l,d)&&(this.images[l]=d)}_validate(l,d){let _=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new u.ErrorEvent(new Error(`Image "${l}" has invalid "stretchX" value`))),_=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new u.ErrorEvent(new Error(`Image "${l}" has invalid "stretchY" value`))),_=!1),this._validateContent(d.content,d)||(this.fire(new u.ErrorEvent(new Error(`Image "${l}" has invalid "content" value`))),_=!1),_}_validateStretch(l,d){if(!l)return!0;let _=0;for(const x of l){if(x[0]<_||x[1]<x[0]||d<x[1])return!1;_=x[1]}return!0}_validateContent(l,d){return!(l&&(4!==l.length||l[0]<0||d.data.width<l[0]||l[1]<0||d.data.height<l[1]||l[2]<0||d.data.width<l[2]||l[3]<0||d.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))}updateImage(l,d){d.version=this.images[l].version+1,this.images[l]=d,this.updatedImages[l]=!0}removeImage(l){const d=this.images[l];delete this.images[l],delete this.patterns[l],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l,d){let _=!0;if(!this.isLoaded())for(const x of l)this.images[x]||(_=!1);this.isLoaded()||_?this._notify(l,d):this.requestors.push({ids:l,callback:d})}_notify(l,d){const _={};for(const x of l){this.images[x]||this.fire(new u.Event("styleimagemissing",{id:x}));const C=this.images[x];C?_[x]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:Boolean(C.userImage&&C.userImage.render)}:u.warnOnce(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}d(null,_)}getPixelSize(){const{width:l,height:d}=this.atlasImage;return{width:l,height:d}}getPattern(l){const d=this.patterns[l],_=this.getImage(l);if(!_)return null;if(d&&d.position.version===_.version)return d.position;if(d)d.position.version=_.version;else{const x={w:_.data.width+2,h:_.data.height+2,x:0,y:0},C=new u.ImagePosition(x,_);this.patterns[l]={bin:x,position:C}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const d=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new u.Texture(l,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const C in this.patterns)l.push(this.patterns[C].bin);const{w:d,h:_}=u.potpack(l),x=this.atlasImage;x.resize({width:d||1,height:_||1});for(const C in this.patterns){const{bin:F}=this.patterns[C],G=F.x+1,Q=F.y+1,fe=this.images[C].data,pe=fe.width,ke=fe.height;u.RGBAImage.copy(fe,x,{x:0,y:0},{x:G,y:Q},{width:pe,height:ke}),u.RGBAImage.copy(fe,x,{x:0,y:ke-1},{x:G,y:Q-1},{width:pe,height:1}),u.RGBAImage.copy(fe,x,{x:0,y:0},{x:G,y:Q+ke},{width:pe,height:1}),u.RGBAImage.copy(fe,x,{x:pe-1,y:0},{x:G-1,y:Q},{width:1,height:ke}),u.RGBAImage.copy(fe,x,{x:0,y:0},{x:G+pe,y:Q},{width:1,height:ke})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const d of l){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const _=this.images[d];ie(_)&&this.updateImage(d,_)}}}const ee=new u.Properties({anchor:new u.DataConstantProperty(u.spec.light.anchor),position:new class{constructor(){this.specification=u.spec.light.position}possiblyEvaluate(m,l){return function([d,_,x]){const C=u.degToRad(_+90),F=u.degToRad(x);return{x:d*Math.cos(C)*Math.sin(F),y:d*Math.sin(C)*Math.sin(F),z:d*Math.cos(F),azimuthal:_,polar:x}}(m.expression.evaluate(l))}interpolate(m,l,d){return{x:u.number(m.x,l.x,d),y:u.number(m.y,l.y,d),z:u.number(m.z,l.z,d),azimuthal:u.number(m.azimuthal,l.azimuthal,d),polar:u.number(m.polar,l.polar,d)}}},color:new u.DataConstantProperty(u.spec.light.color),intensity:new u.DataConstantProperty(u.spec.light.intensity)}),J="-transition";class q extends u.Evented{constructor(l){super(),this._transitionable=new u.Transitionable(ee),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,d={}){if(!this._validate(u.validateLight,l,d))for(const _ in l){const x=l[_];u.endsWith(_,J)?this._transitionable.setTransition(_.slice(0,-J.length),x):this._transitionable.setValue(_,x)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,d,_){return(!_||!1!==_.validate)&&u.emitValidationErrors(this,l.call(u.validateStyle,u.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:u.spec})))}}const D=new u.Properties({source:new u.DataConstantProperty(u.spec.terrain.source),exaggeration:new u.DataConstantProperty(u.spec.terrain.exaggeration)}),z="-transition";class A extends u.Evented{constructor(l,d){super(),this._transitionable=new u.Transitionable(D),this.set(l),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=d}get(){return this._transitionable.serialize()}set(l){for(const d in l){const _=l[d];u.endsWith(d,z)?this._transitionable.setTransition(d.slice(0,-z.length),_):this._transitionable.setValue(d,_)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}}function U(m,l,d,_){const x=u.smoothstep(45,65,d),[C,F]=T(m,_),G=u.length(l);let Q=1-Math.min(1,Math.exp((G-C)/(F-C)*-6));return Q*=Q*Q,Q=Math.min(1,1.00747*Q),Q*x*m.alpha}function T(m,l){const d=.5/Math.tan(.5*l);return[m.range[0]+d,m.range[1]+d]}const S=new u.Properties({range:new u.DataConstantProperty(u.spec.fog.range),color:new u.DataConstantProperty(u.spec.fog.color),"high-color":new u.DataConstantProperty(u.spec.fog["high-color"]),"space-color":new u.DataConstantProperty(u.spec.fog["space-color"]),"horizon-blend":new u.DataConstantProperty(u.spec.fog["horizon-blend"]),"star-intensity":new u.DataConstantProperty(u.spec.fog["star-intensity"])}),O="-transition";class M extends u.Evented{constructor(l,d){super(),this._transitionable=new u.Transitionable(S),this.set(l),this._transitioning=this._transitionable.untransitioned(),this._transform=d}get state(){const l=this._transform,d="globe"===l.projection.name,_=u.globeToMercatorTransition(l.zoom),x=this.properties.get("range"),C=[.5,3];return{range:d?[u.number(C[0],x[0],_),u.number(C[1],x[1],_)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(l,d={}){if(!this._validate(u.validateFog,l,d)){for(const _ of Object.keys(u.spec.fog))l&&void 0===l[_]&&(l[_]=u.spec.fog[_].default);for(const _ in l){const x=l[_];u.endsWith(_,O)?this._transitionable.setTransition(_.slice(0,-O.length),x):this._transitionable.setValue(_,x)}}}getOpacity(l){if(!this._transform.projection.supportsFog)return 0;const d=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:u.smoothstep(45,65,l))*d.a}getOpacityAtLatLng(l,d){return this._transform.projection.supportsFog?function(_,x,C){const F=u.MercatorCoordinate.fromLngLat(x),G=C.elevation?C.elevation.getAtPointOrZero(F):0,Q=[F.x,F.y,G];return u.transformMat4(Q,Q,C.mercatorFogMatrix),U(_,Q,C.pitch,C._fov)}(this.state,l,d):0}getFovAdjustedRange(l){return this._transform.projection.supportsFog?T(this.state,l):[0,1]}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,d,_){return(!_||!1!==_.validate)&&u.emitValidationErrors(this,l.call(u.validateStyle,u.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:u.spec})))}}class Z{constructor(l,d){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=u.uniqueId();const _=this.workerPool.acquire(this.id);for(let x=0;x<_.length;x++){const C=new Z.Actor(_[x],d,this.id);C.name=`Worker ${x}`,this.actors.push(C)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(l,d,_){u.asyncAll(this.actors,(x,C)=>{x.send(l,d,C)},_=_||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(l=>{l.remove()}),this.actors=[],this.workerPool.release(this.id)}}function ae(m,l,d){return l*(u.EXTENT/(m.tileSize*Math.pow(2,d-m.tileID.overscaledZ)))}Z.Actor=u.Actor;class ue{constructor(l,d,_,x){this.screenBounds=l,this.cameraPoint=d,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=_,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(l,d){let _,x;if(l instanceof u.pointGeometry||"number"==typeof l[0]){const C=u.pointGeometry.convert(l);_=[C],x=d.isPointAboveHorizon(C)}else{const C=u.pointGeometry.convert(l[0]),F=u.pointGeometry.convert(l[1]);_=[C,F],x=u.polygonizeBounds(C,F).every(G=>d.isPointAboveHorizon(G))}return new ue(_,d.getCameraPoint(),x,d)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(l){return u.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],l)}bufferedCameraGeometry(l){const d=this.screenBounds[0],_=1===this.screenBounds.length?this.screenBounds[0].add(new u.pointGeometry(1,1)):this.screenBounds[1],x=u.polygonizeBounds(d,_,0,!1);return this.cameraPoint.y>_.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<_.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=_.x?x[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(x[3]=this.cameraPoint)),u.bufferConvexPolygon(x,l)}bufferedCameraGeometryGlobe(l){const d=this.screenBounds[0],_=1===this.screenBounds.length?this.screenBounds[0].add(new u.pointGeometry(1,1)):this.screenBounds[1],x=u.polygonizeBounds(d,_,l),C=this.cameraPoint.clone();switch(3*((C.y>d.y)+(C.y>_.y))+((C.x>d.x)+(C.x>_.x))){case 0:x[0]=C,x[4]=C.clone();break;case 1:x.splice(1,0,C);break;case 2:x[1]=C;break;case 3:x.splice(4,0,C);break;case 5:x.splice(2,0,C);break;case 6:x[3]=C;break;case 7:x.splice(3,0,C);break;case 8:x[2]=C}return x}containsTile(l,d,_,x=0){const C=l.queryPadding/d._pixelsPerMercatorPixel+1,F=_?this._bufferedCameraMercator(C,d):this._bufferedScreenMercator(C,d);let G=l.tileID.wrap+(F.unwrapped?x:0);const Q=F.polygon.map(Ue=>u.getTilePoint(l.tileTransform,Ue,G));if(!u.polygonIntersectsBox(Q,0,0,u.EXTENT,u.EXTENT))return;G=l.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const fe=this.screenGeometryMercator.polygon.map(Ue=>u.getTileVec3(l.tileTransform,Ue,G)),pe=fe.map(Ue=>new u.pointGeometry(Ue[0],Ue[1])),ke=d.getFreeCameraOptions().position||new u.MercatorCoordinate(0,0,0),ze=u.getTileVec3(l.tileTransform,ke,G),We=fe.map(Ue=>{const He=u.sub(Ue,Ue,ze);return u.normalize(He,He),new u.Ray(ze,He)}),$e=ae(l,1,d.zoom)*d._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:pe,tilespaceRays:We,bufferedTilespaceGeometry:Q,bufferedTilespaceBounds:(qe=u.getBounds(Q),qe.min.x=u.clamp(qe.min.x,0,u.EXTENT),qe.min.y=u.clamp(qe.min.y,0,u.EXTENT),qe.max.x=u.clamp(qe.max.x,0,u.EXTENT),qe.max.y=u.clamp(qe.max.y,0,u.EXTENT),qe),tile:l,tileID:l.tileID,pixelToTileUnitsFactor:$e};var qe}_bufferedScreenMercator(l,d){const _=$(l);if(this._screenRaycastCache[_])return this._screenRaycastCache[_];{let x;return x="globe"===d.projection.name?this._projectAndResample(this.bufferedScreenGeometry(l),d):{polygon:this.bufferedScreenGeometry(l).map(C=>d.pointCoordinate3D(C)),unwrapped:!0},this._screenRaycastCache[_]=x,x}}_bufferedCameraMercator(l,d){const _=$(l);if(this._cameraRaycastCache[_])return this._cameraRaycastCache[_];{let x;return x="globe"===d.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(l),d):{polygon:this.bufferedCameraGeometry(l).map(C=>d.pointCoordinate3D(C)),unwrapped:!0},this._cameraRaycastCache[_]=x,x}}_projectAndResample(l,d){const _=function(C,F){const G=u.multiply([],F.pixelMatrix,F.globeMatrix),Q=[0,-u.GLOBE_RADIUS,0,1],fe=[0,u.GLOBE_RADIUS,0,1],pe=[0,0,0,1];u.transformMat4$1(Q,Q,G),u.transformMat4$1(fe,fe,G),u.transformMat4$1(pe,pe,G);const ke=new u.pointGeometry(Q[0]/Q[3],Q[1]/Q[3]),ze=new u.pointGeometry(fe[0]/fe[3],fe[1]/fe[3]),We=u.polygonContainsPoint(C,ke)&&Q[3]<pe[3],$e=u.polygonContainsPoint(C,ze)&&fe[3]<pe[3];if(!We&&!$e)return null;const qe=function(xt,Rt,kt){for(let Ct=1;Ct<xt.length;Ct++){const si=V(Rt.pointCoordinate3D(xt[Ct-1]).x),At=V(Rt.pointCoordinate3D(xt[Ct]).x);if(kt<0){if(si<At)return{idx:Ct,t:-si/(At-1-si)}}else if(At<si)return{idx:Ct,t:(1-si)/(At+1-si)}}return null}(C,F,We?-1:1);if(!qe)return null;const{idx:Ue,t:He}=qe;let Je=Ue>1?ge(C.slice(0,Ue),F):[],Ye=Ue<C.length?ge(C.slice(Ue),F):[];Je=Je.map(xt=>new u.pointGeometry(V(xt.x),xt.y)),Ye=Ye.map(xt=>new u.pointGeometry(V(xt.x),xt.y));const rt=[...Je];0===rt.length&&rt.push(Ye[Ye.length-1]);const mt=u.number(rt[rt.length-1].y,(0===Ye.length?Je[0]:Ye[0]).y,He);let pt;return pt=We?[new u.pointGeometry(0,mt),new u.pointGeometry(0,0),new u.pointGeometry(1,0),new u.pointGeometry(1,mt)]:[new u.pointGeometry(1,mt),new u.pointGeometry(1,1),new u.pointGeometry(0,1),new u.pointGeometry(0,mt)],rt.push(...pt),0===Ye.length?rt.push(Je[0]):rt.push(...Ye),{polygon:rt.map(xt=>new u.MercatorCoordinate(xt.x,xt.y)),unwrapped:!1}}(l,d);if(_)return _;const x=function(C,F){let G=!1,Q=-1/0,fe=0;for(let ke=0;ke<C.length-1;ke++)C[ke].x>Q&&(Q=C[ke].x,fe=ke);for(let ke=0;ke<C.length-1;ke++){const ze=(fe+ke)%(C.length-1),We=C[ze],$e=C[ze+1];Math.abs(We.x-$e.x)>.5&&(We.x<$e.x?(We.x+=1,0===ze&&(C[C.length-1].x+=1)):($e.x+=1,ze+1===C.length-1&&(C[0].x+=1)),G=!0)}const pe=u.mercatorXfromLng(F.center.lng);return G&&pe<Math.abs(pe-1)&&C.forEach(ke=>{ke.x-=1}),{polygon:C,unwrapped:G}}(ge(l,d).map(C=>new u.pointGeometry(V(C.x),C.y)),d);return{polygon:x.polygon.map(C=>new u.MercatorCoordinate(C.x,C.y)),unwrapped:x.unwrapped}}}function ge(m,l){return u.resample(m,d=>{const _=l.pointCoordinate3D(d);d.x=_.x,d.y=_.y},1/256)}function V(m){return m<0?1+m%1:m%1}function $(m){return 100*m|0}function de(m,l,d,_,x){const C=function(F,G){if(F)return x(F);if(G){m.url&&G.tiles&&m.tiles&&delete m.tiles;const Q=u.pick(u.extend(G,m),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);G.vector_layers&&(Q.vectorLayers=G.vector_layers,Q.vectorLayerIds=Q.vectorLayers.map(fe=>fe.id)),Q.tiles=l.canonicalizeTileset(Q,m.url),x(null,Q)}};return m.url?u.getJSON(l.transformRequest(l.normalizeSourceURL(m.url,null,d,_),u.ResourceType.Source),C):u.exported.frame(()=>C(null,m))}class Me{constructor(l,d,_){this.bounds=u.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=d||0,this.maxzoom=_||24}validateBounds(l){return Array.isArray(l)&&4===l.length?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const d=Math.pow(2,l.z),_=Math.floor(u.mercatorXfromLng(this.bounds.getWest())*d),x=Math.floor(u.mercatorYfromLat(this.bounds.getNorth())*d),C=Math.ceil(u.mercatorXfromLng(this.bounds.getEast())*d),F=Math.ceil(u.mercatorYfromLat(this.bounds.getSouth())*d);return l.x>=_&&l.x<C&&l.y>=x&&l.y<F}}class Ie{constructor(l,d,_){this.context=l;const x=l.gl;this.buffer=x.createBuffer(),this.dynamicDraw=Boolean(_),this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||d.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const d=this.context.gl;this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const De={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class oe{constructor(l,d,_,x){this.length=d.length,this.attributes=_,this.itemSize=d.bytesPerElement,this.dynamicDraw=x,this.context=l;const C=l.gl;this.buffer=C.createBuffer(),l.bindVertexBuffer.set(this.buffer),C.bufferData(C.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||d.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,d){for(let _=0;_<this.attributes.length;_++){const x=d.attributes[this.attributes[_].name];void 0!==x&&l.enableVertexAttribArray(x)}}setVertexAttribPointers(l,d,_){for(let x=0;x<this.attributes.length;x++){const C=this.attributes[x],F=d.attributes[C.name];void 0!==F&&l.vertexAttribPointer(F,C.components,l[De[C.type]],!1,this.itemSize,C.offset+this.itemSize*(_||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ve{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class xe extends ve{getDefault(){return u.Color.transparent}set(l){const d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Re extends ve{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class we extends ve{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class Le extends ve{getDefault(){return[!0,!0,!0,!0]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Ne extends ve{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class Ze extends ve{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class at extends ve{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const d=this.current;(l.func!==d.func||l.ref!==d.ref||l.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class wt extends ve{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class Tt extends ve{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=l,this.dirty=!1}}class Ut extends ve{getDefault(){return[0,1]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class bt extends ve{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=l,this.dirty=!1}}class lt extends ve{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class Pe extends ve{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.BLEND):d.disable(d.BLEND),this.current=l,this.dirty=!1}}class je extends ve{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class it extends ve{getDefault(){return u.Color.transparent}set(l){const d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class ct extends ve{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class vt extends ve{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=l,this.dirty=!1}}class Nt extends ve{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class Kt extends ve{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class vi extends ve{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class Ki extends ve{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class mi extends ve{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Ii extends ve{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class xn extends ve{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Qi extends ve{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class bn extends ve{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Ri extends ve{getDefault(){return null}set(l){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class _r extends ve{constructor(l){super(l),this.vao=l.extVertexArrayObject}getDefault(){return null}set(l){this.vao&&(l!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(l),this.current=l,this.dirty=!1)}}class Er extends ve{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class or extends ve{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class go extends ve{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class yr extends ve{constructor(l,d){super(l),this.context=l,this.parent=d}getDefault(){return null}}class kr extends yr{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Fr extends yr{attachment(){return this.gl.DEPTH_ATTACHMENT}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class _o extends Fr{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Qe{constructor(l,d,_,x){this.context=l,this.width=d,this.height=_;const C=this.framebuffer=l.gl.createFramebuffer();this.colorAttachment=new kr(l,C),x&&(this.depthAttachment=new Fr(l,C))}destroy(){const l=this.context.gl,d=this.colorAttachment.get();if(d&&l.deleteTexture(d),this.depthAttachment){const _=this.depthAttachment.get();_&&l.deleteRenderbuffer(_)}l.deleteFramebuffer(this.framebuffer)}}class Ae{constructor(l){this.gl=l,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new xe(this),this.clearDepth=new Re(this),this.clearStencil=new we(this),this.colorMask=new Le(this),this.depthMask=new Ne(this),this.stencilMask=new Ze(this),this.stencilFunc=new at(this),this.stencilOp=new wt(this),this.stencilTest=new Tt(this),this.depthRange=new Ut(this),this.depthTest=new bt(this),this.depthFunc=new lt(this),this.blend=new Pe(this),this.blendFunc=new je(this),this.blendColor=new it(this),this.blendEquation=new ct(this),this.cullFace=new vt(this),this.cullFaceSide=new Nt(this),this.frontFace=new Kt(this),this.program=new vi(this),this.activeTexture=new Ki(this),this.viewport=new mi(this),this.bindFramebuffer=new Ii(this),this.bindRenderbuffer=new xn(this),this.bindTexture=new Qi(this),this.bindVertexBuffer=new bn(this),this.bindElementBuffer=new Ri(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new _r(this),this.pixelStoreUnpack=new Er(this),this.pixelStoreUnpackPremultiplyAlpha=new or(this),this.pixelStoreUnpackFlipY=new go(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=l.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=l.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=l.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.extTextureHalfFloat=l.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(l.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=l.getExtension("OES_standard_derivatives"),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,d){return new Ie(this,l,d)}createVertexBuffer(l,d,_){return new oe(this,l,d,_)}createRenderbuffer(l,d,_){const x=this.gl,C=x.createRenderbuffer();return this.bindRenderbuffer.set(C),x.renderbufferStorage(x.RENDERBUFFER,l,d,_),this.bindRenderbuffer.set(null),C}createFramebuffer(l,d,_){return new Qe(this,l,d,_)}clear({color:l,depth:d,stencil:_}){const x=this.gl;let C=0;l&&(C|=x.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),void 0!==d&&(C|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),void 0!==_&&(C|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),x.clear(C)}setCullFace(l){!1===l.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){re(l.blendFunction,u.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Fe extends u.Evented{constructor(l,d,_,x){super(),this.id=l,this.dispatcher=_,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.extend({type:"raster"},d),u.extend(this,u.pick(d,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=de(this._options,this.map._requestManager,null,null,(l,d)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new u.ErrorEvent(l)):d&&(u.extend(this,d),d.bounds&&(this.tileBounds=new Me(d.bounds,this.minzoom,this.maxzoom)),u.postTurnstileEvent(d.tiles),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return u.extend({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,d){const _=u.exported.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),_,this.tileSize);l.request=u.getImage(this.map._requestManager.transformRequest(x,u.ResourceType.Tile),(C,F,G,Q)=>(delete l.request,l.aborted?(l.state="unloaded",d(null)):C?(l.state="errored",d(C)):F?(this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:G,expires:Q}),l.setTexture(F,this.map.painter),l.state="loaded",u.cacheEntryPossiblyAdded(this.dispatcher),void d(null)):d(null)))}static loadTileData(l,d,_){l.setTexture(d,_)}static unloadTileData(l,d){l.texture&&d.saveTileTexture(l.texture)}abortTile(l,d){l.request&&(l.request.cancel(),delete l.request),d()}unloadTile(l,d){l.texture&&this.map.painter.saveTileTexture(l.texture),d()}hasTransition(){return!1}}let Ke;function nt(m,l,d,_,x,C,F,G){const Q=[m,d,x,l,_,C,1,1,1],fe=[F,G,1],pe=u.adjoint([],Q),[ke,ze,We]=u.transformMat3(fe,fe,u.transpose(pe,pe));return u.multiply$1(Q,[ke,0,0,0,ze,0,0,0,We],Q)}class gt extends u.Evented{constructor(l,d,_,x){super(),this.id=l,this.dispatcher=_,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=d,this._dirty=!1}load(l,d){this._loaded=d||!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=u.getImage(this.map._requestManager.transformRequest(this.url,u.ResourceType.Image),(_,x)=>{if(this._imageRequest=null,this._loaded=!0,_)this.fire(new u.ErrorEvent(_));else if(x){const{HTMLImageElement:C}=u.window;this.image=x instanceof C?u.exported.getImageData(x):x,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,l&&(this.coordinates=l),this._finishLoading()}})}loaded(){return this._loaded}updateImage(l){return this.image&&l.url?(this._imageRequest&&l.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=l.url,this.load(l.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(l){this.coordinates=l,this._boundsArray=void 0;const d=l.map(u.MercatorCoordinate.fromLngLat);return this.tileID=function(_){let x=1/0,C=1/0,F=-1/0,G=-1/0;for(const ke of _)x=Math.min(x,ke.x),C=Math.min(C,ke.y),F=Math.max(F,ke.x),G=Math.max(G,ke.y);const Q=Math.max(F-x,G-C),fe=Math.max(0,Math.floor(-Math.log(Q)/Math.LN2)),pe=Math.pow(2,fe);return new u.CanonicalTileID(fe,Math.floor((x+F)/2*pe),Math.floor((C+G)/2*pe))}(d),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(l){for(const Q in this.tiles){const fe=this.tiles[Q];"loaded"!==fe.state&&(fe.state="loaded",fe.texture=this.texture)}if(this._boundsArray)return;const d=u.tileTransform(this.tileID,this.map.transform.projection),[_,x,C,F]=this.coordinates.map(Q=>{const fe=d.projection.project(Q[0],Q[1]);return u.getTilePoint(d,fe)._round()});this.perspectiveTransform=function(Q,fe,pe,ke,ze,We,$e,qe,Ue,He){const Je=nt(0,0,Q,0,0,fe,Q,fe),Ye=nt(pe,ke,ze,We,$e,qe,Ue,He);return u.multiply$1(Ye,u.adjoint(Je,Je),Ye),[Ye[6]/Ye[8]*Q/u.EXTENT,Ye[7]/Ye[8]*fe/u.EXTENT]}(this.width,this.height,_.x,_.y,x.x,x.y,F.x,F.y,C.x,C.y);const G=this._boundsArray=new u.StructArrayLayout4i8;G.emplaceBack(_.x,_.y,0,0),G.emplaceBack(x.x,x.y,u.EXTENT,0),G.emplaceBack(F.x,F.y,0,u.EXTENT),G.emplaceBack(C.x,C.y,u.EXTENT,u.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=l.createVertexBuffer(G,u.boundsAttributes.members),this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const l=this.map.painter.context,d=l.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new u.Texture(l,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(l)}loadTile(l,d){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},d(null)):(l.state="errored",d(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Dt={vector:class extends u.Evented{constructor(m,l,d,_){if(super(),this.id=m,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.extend(this,u.pick(l,["url","scheme","tileSize","promoteId"])),this._options=u.extend({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new u.DedupedRequest}load(m){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,d=this.map._worldview;this._tileJSONRequest=de(this._options,this.map._requestManager,l,d,(_,x)=>{this._tileJSONRequest=null,this._loaded=!0,_?(l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),d&&2!==d.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${d}`),this.fire(new u.ErrorEvent(_))):x&&(u.extend(this,x),x.bounds&&(this.tileBounds=new Me(x.bounds,this.minzoom,this.maxzoom)),u.postTurnstileEvent(x.tiles,this.map._requestManager._customAccessToken),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"}))),m&&m(_)})}loaded(){return this._loaded}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}onAdd(m){this.map=m,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>{const m=this.map.style._getSourceCaches(this.id);for(const l of m)l.clearTiles()})}setSourceProperty(m){m(),this.reload()}setTiles(m){return this._options.tiles=m,this.reload(),this}setUrl(m){return this.url=m,this._options.url=m,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return u.extend({},this._options)}loadTile(m,l){const d=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(d,u.ResourceType.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:u.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:m.isSymbolTile};if(_.request.collectResourceTiming=this._collectResourceTiming,m.actor&&"expired"!==m.state)"loading"===m.state?m.reloadCallback=l:m.request=m.actor.send("reloadTile",_,x.bind(this));else if(m.actor=this._tileWorkers[d]=this._tileWorkers[d]||this.dispatcher.getActor(),this.dispatcher.ready)m.request=m.actor.send("loadTile",_,x.bind(this),void 0,!0);else{const C=u.loadVectorTile.call({deduped:this._deduped},_,(F,G)=>{F||!G?x.call(this,F):(_.data={cacheControl:G.cacheControl,expires:G.expires,rawData:G.rawData.slice(0)},m.actor&&m.actor.send("loadTile",_,x.bind(this),void 0,!0))},!0);m.request={cancel:C}}function x(C,F){return delete m.request,m.aborted?l(null):C&&404!==C.status?l(C):(F&&F.resourceTiming&&(m.resourceTiming=F.resourceTiming),this.map._refreshExpiredTiles&&F&&m.setExpiryData(F),m.loadVectorData(F,this.map.painter),u.cacheEntryPossiblyAdded(this.dispatcher),l(null),void(m.reloadCallback&&(this.loadTile(m,m.reloadCallback),m.reloadCallback=null)))}}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.actor&&m.actor.send("abortTile",{uid:m.uid,type:this.type,source:this.id})}unloadTile(m){m.unloadVectorData(),m.actor&&m.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}},raster:Fe,"raster-dem":class extends Fe{constructor(m,l,d,_){super(m,l,d,_),this.type="raster-dem",this.maxzoom=22,this._options=u.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}loadTile(m,l){const d=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function _(x,C){x&&(m.state="errored",l(x)),C&&(m.dem=C,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",l(null))}m.request=u.getImage(this.map._requestManager.transformRequest(d,u.ResourceType.Tile),function(x,C,F,G){if(delete m.request,m.aborted)m.state="unloaded",l(null);else if(x)m.state="errored",l(x);else if(C){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:F,expires:G});const Q=u.window.ImageBitmap&&C instanceof u.window.ImageBitmap&&(null==Ke&&(Ke=u.window.OffscreenCanvas&&new u.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof u.window.createImageBitmap),Ke),fe=1-(C.width-u.prevPowerOfTwo(C.width))/2;fe<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const pe=Q?C:u.exported.getImageData(C,fe),ke={uid:m.uid,coord:m.tileID,source:this.id,rawImageData:pe,encoding:this.encoding,padding:fe};m.actor&&"expired"!==m.state||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",ke,_.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(m){const l=m.canonical,d=Math.pow(2,l.z),_=(l.x-1+d)%d,x=0===l.x?m.wrap-1:m.wrap,C=(l.x+1+d)%d,F=l.x+1===d?m.wrap+1:m.wrap,G={};return G[new u.OverscaledTileID(m.overscaledZ,x,l.z,_,l.y).key]={backfilled:!1},G[new u.OverscaledTileID(m.overscaledZ,F,l.z,C,l.y).key]={backfilled:!1},l.y>0&&(G[new u.OverscaledTileID(m.overscaledZ,x,l.z,_,l.y-1).key]={backfilled:!1},G[new u.OverscaledTileID(m.overscaledZ,m.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},G[new u.OverscaledTileID(m.overscaledZ,F,l.z,C,l.y-1).key]={backfilled:!1}),l.y+1<d&&(G[new u.OverscaledTileID(m.overscaledZ,x,l.z,_,l.y+1).key]={backfilled:!1},G[new u.OverscaledTileID(m.overscaledZ,m.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},G[new u.OverscaledTileID(m.overscaledZ,F,l.z,C,l.y+1).key]={backfilled:!1}),G}unloadTile(m){m.demTexture&&this.map.painter.saveTileTexture(m.demTexture),m.fbo&&(m.fbo.destroy(),delete m.fbo),m.dem&&delete m.dem,delete m.neighboringTiles,m.state="unloaded"}},geojson:class extends u.Evented{constructor(m,l,d,_){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(_),this._data=l.data,this._options=u.extend({},l),this._collectResourceTiming=l.collectResourceTiming,void 0!==l.maxzoom&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;const x=u.EXTENT/this.tileSize;this.workerOptions=u.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(void 0!==l.buffer?l.buffer:128)*x,tolerance:(void 0!==l.tolerance?l.tolerance:.375)*x,extent:u.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:void 0!==l.clusterMaxZoom?l.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:u.EXTENT,radius:(void 0!==l.clusterRadius?l.clusterRadius:50)*x,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}getClusterExpansionZoom(m,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id},l),this}getClusterChildren(m,l){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id},l),this}getClusterLeaves(m,l,d,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:m,limit:l,offset:d},_),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new u.Event("dataloading",{dataType:"source"})),this._loaded=!1;const m=u.extend({},this.workerOptions),l=this._data;"string"==typeof l?(m.request=this.map._requestManager.transformRequest(u.exported.resolveURL(l),u.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,m,(d,_)=>{if(this._loaded=!0,this._pendingLoad=null,d)this.fire(new u.ErrorEvent(d));else{const x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(x.resourceTiming=_.resourceTiming[this.id]),this.fire(new u.Event("data",x)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(m,l){const d=m.actor?"reloadTile":"loadTile";m.actor=this.actor,m.request=this.actor.send(d,{type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:u.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(_,x)=>(delete m.request,m.unloadVectorData(),m.aborted?l(null):_?l(_):(m.loadVectorData(x,this.map.painter,"reloadTile"===d),l(null))),void 0,"loadTile"===d)}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m){m.unloadVectorData(),this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return u.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends gt{constructor(m,l,d,_){super(m,l,d,_),this.roundZoom=!0,this.type="video",this.options=l}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const l of m.urls)this.urls.push(this.map._requestManager.transformRequest(l,u.ResourceType.Source).url);u.getVideo(this.urls,(l,d)=>{this._loaded=!0,l?this.fire(new u.ErrorEvent(l)):d&&(this.video=d,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const l=this.video.seekable;m<l.start(0)||m>l.end(0)?this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const m=this.map.painter.context,l=m.gl;this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new u.Texture(m,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:gt,canvas:class extends gt{constructor(m,l,d,_){super(m,l,d,_),l.coordinates?Array.isArray(l.coordinates)&&4===l.coordinates.length&&!l.coordinates.some(x=>!Array.isArray(x)||2!==x.length||x.some(C=>"number"!=typeof C))||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${m}`,null,'missing required property "coordinates"'))),l.animate&&"boolean"!=typeof l.animate&&this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),l.canvas?"string"==typeof l.canvas||l.canvas instanceof u.window.HTMLCanvasElement||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${m}`,null,'missing required property "canvas"'))),this.options=l,this.animate=void 0===l.animate||l.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof u.window.HTMLCanvasElement?this.options.canvas:u.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const l=this.map.painter.context;this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new u.Texture(l,this.canvas,l.gl.RGBA,{premultiply:!0}),this._prepareData(l)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends u.Evented{constructor(m,l,d,_){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=d,this._implementation=l,this.setEventedParent(_),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new u.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new u.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Me(this._implementation.bounds,this.minzoom,this.maxzoom)),l.update=this._update.bind(this),l.clearTiles=this._clearTiles.bind(this),l.coveringTiles=this._coveringTiles.bind(this),u.extend(this,u.pick(l,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return u.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this._map=m,this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:l,y:d,z:_}=m.canonical;return this._implementation.hasTile({x:l,y:d,z:_})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,l){const{x:d,y:_,z:x}=m.tileID.canonical,C=new u.window.AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:d,y:_,z:x},{signal:C.signal})).then(function(F){return delete m.request,m.aborted?(m.state="unloaded",l(null)):void 0===F?(m.state="errored",l(null)):null===F?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",l(null)):(G=F)instanceof u.window.ImageData||G instanceof u.window.HTMLCanvasElement||G instanceof u.window.ImageBitmap||G instanceof u.window.HTMLImageElement?(this.loadTileData(m,F),m.state="loaded",void l(null)):(m.state="errored",l(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var G}.bind(this)).catch(F=>{20!==F.code&&(m.state="errored",l(F))}),m.request.cancel=()=>C.abort()}loadTileData(m,l){Fe.loadTileData(m,l,this._map.painter)}unloadTileData(m){Fe.unloadTileData(m,this._map.painter)}unloadTile(m,l){if(this.unloadTileData(m),this._implementation.unloadTile){const{x:d,y:_,z:x}=m.tileID.canonical;this._implementation.unloadTile({x:d,y:_,z:x})}l()}abortTile(m,l){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),l()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Et=function(m,l,d,_){const x=new Dt[l.type](m,l,d,_);if(x.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${x.id}`);return u.bindAll(["load","abort","unload","serialize","prepare"],x),x};function _t(m,l){const d=u.identity([]);return u.scale(d,d,[.5*m.width,.5*-m.height,1]),u.translate(d,d,[1,-1,0]),u.multiply(d,d,m.calculateProjMatrix(l.toUnwrapped())),Float32Array.from(d)}function Mt(m,l,d,_,x,C,F,G=!1){const Q=m.tilesIn(_,F,G);Q.sort(gi);const fe=[];for(const ke of Q)fe.push({wrappedTileID:ke.tile.tileID.wrapped().key,queryResults:ke.tile.queryRenderedFeatures(l,d,m._state,ke,x,C,_t(m.transform,ke.tile.tileID),G)});const pe=function(ke){const ze={},We={};for(const $e of ke){const qe=$e.queryResults,Ue=$e.wrappedTileID,He=We[Ue]=We[Ue]||{};for(const Je in qe){const Ye=qe[Je],rt=He[Je]=He[Je]||{},mt=ze[Je]=ze[Je]||[];for(const pt of Ye)rt[pt.featureIndex]||(rt[pt.featureIndex]=!0,mt.push(pt))}}return ze}(fe);for(const ke in pe)pe[ke].forEach(ze=>{const We=ze.feature,$e=We.layer;$e&&"background"!==$e.type&&"sky"!==$e.type&&(We.source=$e.source,$e["source-layer"]&&(We.sourceLayer=$e["source-layer"]),We.state=void 0!==We.id?m.getFeatureState($e["source-layer"],We.id):{})});return pe}function Yt(m,l){const d=m.getRenderableIds().map(C=>m.getTileByID(C)),_=[],x={};for(let C=0;C<d.length;C++){const F=d[C],G=F.tileID.canonical.key;x[G]||(x[G]=!0,F.querySourceFeatures(_,l))}return _}function gi(m,l){const d=m.tileID,_=l.tileID;return d.overscaledZ-_.overscaledZ||d.canonical.y-_.canonical.y||d.wrap-_.wrap||d.canonical.x-_.canonical.x}function ni(){return null!=ia.workerClass?new ia.workerClass:new u.window.Worker(ia.workerUrl)}const Hi="mapboxgl_preloaded_worker_pool";class zi{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<zi.workerCount;)this.workers.push(new ni);return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],0===this.numActive()&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Hi]}numActive(){return Object.keys(this.active).length}}let Pi;function Yi(){return Pi||(Pi=new zi),Pi}function dn(m,l){const d={};for(const _ in m)"ref"!==_&&(d[_]=m[_]);return u.refProperties.forEach(_=>{_ in l&&(d[_]=l[_])}),d}function Xn(m){m=m.slice();const l=Object.create(null);for(let d=0;d<m.length;d++)l[m[d].id]=m[d];for(let d=0;d<m.length;d++)"ref"in m[d]&&(m[d]=dn(m[d],l[m[d].ref]));return m}zi.workerCount=2;const Li={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function sr(m,l,d){d.push({command:Li.addSource,args:[m,l[m]]})}function vr(m,l,d){l.push({command:Li.removeSource,args:[m]}),d[m]=!0}function Pa(m,l,d,_){vr(m,d,_),sr(m,l,d)}function bl(m,l,d){let _;for(_ in m[d])if(m[d].hasOwnProperty(_)&&"data"!==_&&!re(m[d][_],l[d][_]))return!1;for(_ in l[d])if(l[d].hasOwnProperty(_)&&"data"!==_&&!re(m[d][_],l[d][_]))return!1;return!0}function Ws(m,l,d,_,x,C){let F;for(F in l=l||{},m=m||{})m.hasOwnProperty(F)&&(re(m[F],l[F])||d.push({command:C,args:[_,F,l[F],x]}));for(F in l)l.hasOwnProperty(F)&&!m.hasOwnProperty(F)&&(re(m[F],l[F])||d.push({command:C,args:[_,F,l[F],x]}))}function $t(m){return m.id}function Ya(m,l){return m[l.id]=l,m}class io{constructor(l,d){this.reset(l,d)}reset(l,d){this.points=l||[],this._distances=[0];for(let _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(1===this.points.length)return this.points[0];l=u.clamp(l,0,1);let d=1,_=this._distances[d];const x=l*this.paddedLength+this.padding;for(;_<x&&d<this._distances.length;)_=this._distances[++d];const C=d-1,F=this._distances[C],G=_-F,Q=G>0?(x-F)/G:0;return this.points[C].mult(1-Q).add(this.points[d].mult(Q))}}class xr{constructor(l,d,_){const x=this.boxCells=[],C=this.circleCells=[];this.xCellCount=Math.ceil(l/_),this.yCellCount=Math.ceil(d/_);for(let F=0;F<this.xCellCount*this.yCellCount;F++)x.push([]),C.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=d,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,d,_,x,C){this._forEachCell(d,_,x,C,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(d),this.bboxes.push(_),this.bboxes.push(x),this.bboxes.push(C)}insertCircle(l,d,_,x){this._forEachCell(d-x,_-x,d+x,_+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(d),this.circles.push(_),this.circles.push(x)}_insertBoxCell(l,d,_,x,C,F){this.boxCells[C].push(F)}_insertCircleCell(l,d,_,x,C,F){this.circleCells[C].push(F)}_query(l,d,_,x,C,F){if(_<0||l>this.width||x<0||d>this.height)return!C&&[];const G=[];if(l<=0&&d<=0&&this.width<=_&&this.height<=x){if(C)return!0;for(let Q=0;Q<this.boxKeys.length;Q++)G.push({key:this.boxKeys[Q],x1:this.bboxes[4*Q],y1:this.bboxes[4*Q+1],x2:this.bboxes[4*Q+2],y2:this.bboxes[4*Q+3]});for(let Q=0;Q<this.circleKeys.length;Q++){const fe=this.circles[3*Q],pe=this.circles[3*Q+1],ke=this.circles[3*Q+2];G.push({key:this.circleKeys[Q],x1:fe-ke,y1:pe-ke,x2:fe+ke,y2:pe+ke})}return F?G.filter(F):G}return this._forEachCell(l,d,_,x,this._queryCell,G,{hitTest:C,seenUids:{box:{},circle:{}}},F),C?G.length>0:G}_queryCircle(l,d,_,x,C){const F=l-_,G=l+_,Q=d-_,fe=d+_;if(G<0||F>this.width||fe<0||Q>this.height)return!x&&[];const pe=[];return this._forEachCell(F,Q,G,fe,this._queryCellCircle,pe,{hitTest:x,circle:{x:l,y:d,radius:_},seenUids:{box:{},circle:{}}},C),x?pe.length>0:pe}query(l,d,_,x,C){return this._query(l,d,_,x,!1,C)}hitTest(l,d,_,x,C){return this._query(l,d,_,x,!0,C)}hitTestCircle(l,d,_,x){return this._queryCircle(l,d,_,!0,x)}_queryCell(l,d,_,x,C,F,G,Q){const fe=G.seenUids,pe=this.boxCells[C];if(null!==pe){const ze=this.bboxes;for(const We of pe)if(!fe.box[We]){fe.box[We]=!0;const $e=4*We;if(l<=ze[$e+2]&&d<=ze[$e+3]&&_>=ze[$e+0]&&x>=ze[$e+1]&&(!Q||Q(this.boxKeys[We]))){if(G.hitTest)return F.push(!0),!0;F.push({key:this.boxKeys[We],x1:ze[$e],y1:ze[$e+1],x2:ze[$e+2],y2:ze[$e+3]})}}}const ke=this.circleCells[C];if(null!==ke){const ze=this.circles;for(const We of ke)if(!fe.circle[We]){fe.circle[We]=!0;const $e=3*We;if(this._circleAndRectCollide(ze[$e],ze[$e+1],ze[$e+2],l,d,_,x)&&(!Q||Q(this.circleKeys[We]))){if(G.hitTest)return F.push(!0),!0;{const qe=ze[$e],Ue=ze[$e+1],He=ze[$e+2];F.push({key:this.circleKeys[We],x1:qe-He,y1:Ue-He,x2:qe+He,y2:Ue+He})}}}}}_queryCellCircle(l,d,_,x,C,F,G,Q){const fe=G.circle,pe=G.seenUids,ke=this.boxCells[C];if(null!==ke){const We=this.bboxes;for(const $e of ke)if(!pe.box[$e]){pe.box[$e]=!0;const qe=4*$e;if(this._circleAndRectCollide(fe.x,fe.y,fe.radius,We[qe+0],We[qe+1],We[qe+2],We[qe+3])&&(!Q||Q(this.boxKeys[$e])))return F.push(!0),!0}}const ze=this.circleCells[C];if(null!==ze){const We=this.circles;for(const $e of ze)if(!pe.circle[$e]){pe.circle[$e]=!0;const qe=3*$e;if(this._circlesCollide(We[qe],We[qe+1],We[qe+2],fe.x,fe.y,fe.radius)&&(!Q||Q(this.circleKeys[$e])))return F.push(!0),!0}}}_forEachCell(l,d,_,x,C,F,G,Q){const fe=this._convertToXCellCoord(l),pe=this._convertToYCellCoord(d),ke=this._convertToXCellCoord(_),ze=this._convertToYCellCoord(x);for(let We=fe;We<=ke;We++)for(let $e=pe;$e<=ze;$e++)if(C.call(this,l,d,_,x,this.xCellCount*$e+We,F,G,Q))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,d,_,x,C,F){const G=x-l,Q=C-d,fe=_+F;return fe*fe>G*G+Q*Q}_circleAndRectCollide(l,d,_,x,C,F,G){const Q=(F-x)/2,fe=Math.abs(l-(x+Q));if(fe>Q+_)return!1;const pe=(G-C)/2,ke=Math.abs(d-(C+pe));if(ke>pe+_)return!1;if(fe<=Q||ke<=pe)return!0;const ze=fe-Q,We=ke-pe;return ze*ze+We*We<=_*_}}const ys=Math.tan(85*Math.PI/180);function vs(m,l,d,_,x,C,F){const G=u.create();if(d)if("globe"===C.name){const Q=u.calculateGlobeLabelMatrix(x,l);u.multiply(G,G,Q)}else{const Q=W([],F);G[0]=Q[0],G[1]=Q[1],G[4]=Q[2],G[5]=Q[3],_||u.rotateZ(G,G,x.angle)}else u.multiply(G,x.labelPlaneMatrix,m);return G}function Nc(m,l,d,_,x,C,F){const G=vs(m,l,d,_,x,C,F);return"globe"===C.name&&d||(G[2]=G[6]=G[10]=G[14]=0),G}function br(m,l,d,_,x,C,F){if(d){if("globe"===C.name){const G=vs(m,l,d,_,x,C,F);return u.invert(G,G),u.multiply(G,m,G),G}{const G=u.clone(m),Q=u.identity([]);return Q[0]=F[0],Q[1]=F[1],Q[4]=F[2],Q[5]=F[3],u.multiply(G,G,Q),_||u.rotateZ(G,G,-x.angle),G}}return x.glCoordMatrix}function Mo(m,l,d,_){const x=[m,l,d,1];d?u.transformMat4$1(x,x,_):Ji(x,x,_);const C=x[3];return x[0]/=C,x[1]/=C,x[2]/=C,x}function ri(m,l){return Math.min(.5+m/l*.5,1.5)}function Sn(m,l){const d=m[0]/m[3],_=m[1]/m[3];return d>=-l[0]&&d<=l[0]&&_>=-l[1]&&_<=l[1]}function Tn(m,l,d,_,x,C,F,G,Q,fe){const pe=d.transform,ke=_?m.textSizeData:m.iconSizeData,ze=u.evaluateSizeForZoom(ke,d.transform.zoom),We="globe"===pe.projection.name,$e=[256/d.width*2+1,256/d.height*2+1],qe=_?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;qe.clear();let Ue=null;We&&(Ue=_?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const He=m.lineVertexArray,Je=_?m.text.placedSymbolArray:m.icon.placedSymbolArray,Ye=d.transform.width/d.transform.height;let rt,mt=!1;for(let pt=0;pt<Je.length;pt++){const xt=Je.get(pt),{numGlyphs:Rt,writingMode:kt}=xt;if(kt!==u.WritingMode.vertical||mt||rt===u.WritingMode.horizontal||(mt=!0),rt=kt,(xt.hidden||kt===u.WritingMode.vertical)&&!mt){Gi(Rt,qe);continue}mt=!1;const Ct=new u.pointGeometry(xt.tileAnchorX,xt.tileAnchorY);let{x:si,y:At,z:Ht}=pe.projection.projectTilePoint(Ct.x,Ct.y,fe.canonical);if(Q){const[ki,Di,Ui]=Q(Ct);si+=ki,At+=Di,Ht+=Ui}const Ft=[si,At,Ht,1];if(u.transformMat4$1(Ft,Ft,l),!Sn(Ft,$e)){Gi(Rt,qe);continue}const ei=ri(d.transform.cameraToCenterDistance,Ft[3]),zt=u.evaluateSizeForFeature(ke,ze,xt),Zt=F?zt/ei:zt*ei,li=Mo(si,At,Ht,x);if(li[3]<=0){Gi(Rt,qe);continue}let St={};const Lt=F?null:Q,Ti=pn(xt,Zt,!1,G,l,x,C,m.glyphOffsetArray,He,qe,Ue,li,Ct,St,Ye,Lt,pe.projection,fe,F);mt=Ti.useVertical,Lt&&Ti.needsFlipping&&(St={}),(Ti.notEnoughRoom||mt||Ti.needsFlipping&&pn(xt,Zt,!0,G,l,x,C,m.glyphOffsetArray,He,qe,Ue,li,Ct,St,Ye,Lt,pe.projection,fe,F).notEnoughRoom)&&Gi(Rt,qe)}_?(m.text.dynamicLayoutVertexBuffer.updateData(qe),Ue&&m.text.globeExtVertexBuffer.updateData(Ue)):(m.icon.dynamicLayoutVertexBuffer.updateData(qe),Ue&&m.icon.globeExtVertexBuffer.updateData(Ue))}function On(m,l,d,_,x,C,F,G,Q,fe,pe,ke,ze,We,$e,qe){const{lineStartIndex:Ue,glyphStartIndex:He,segment:Je}=G,Ye=He+G.numGlyphs,rt=Ue+G.lineLength,mt=l.getoffsetX(He),pt=l.getoffsetX(Ye-1),xt=ca(m*mt,d,_,x,C,F,Je,Ue,rt,Q,fe,pe,ke,ze,!0,We,$e,qe);if(!xt)return null;const Rt=ca(m*pt,d,_,x,C,F,Je,Ue,rt,Q,fe,pe,ke,ze,!0,We,$e,qe);return Rt?{first:xt,last:Rt}:null}function tn(m,l,d,_){return m===u.WritingMode.horizontal&&Math.abs(_)>Math.abs(d)?{useVertical:!0}:m===u.WritingMode.vertical?_>0?{needsFlipping:!0}:null:0!==l&&(0===(x=d)||Math.abs(_/x)>ys)?1===l?{needsFlipping:!0}:null:d<0?{needsFlipping:!0}:null;var x}function pn(m,l,d,_,x,C,F,G,Q,fe,pe,ke,ze,We,$e,qe,Ue,He,Je){const Ye=l/24,rt=m.lineOffsetX*Ye,mt=m.lineOffsetY*Ye,{lineStartIndex:pt,glyphStartIndex:xt,numGlyphs:Rt,segment:kt,writingMode:Ct,flipState:si}=m,At=pt+m.lineLength,Ht=Ft=>{if(pe){const[li,St,Lt]=Ft.up,Ti=fe.length;u.updateGlobeVertexNormal(pe,Ti+0,li,St,Lt),u.updateGlobeVertexNormal(pe,Ti+1,li,St,Lt),u.updateGlobeVertexNormal(pe,Ti+2,li,St,Lt),u.updateGlobeVertexNormal(pe,Ti+3,li,St,Lt)}const[ei,zt,Zt]=Ft.point;u.addDynamicAttributes(fe,ei,zt,Zt,Ft.angle)};if(Rt>1){const Ft=On(Ye,G,rt,mt,d,ke,ze,m,Q,C,We,qe,!1,Ue,He,Je);if(!Ft)return{notEnoughRoom:!0};if(_&&!d){let[ei,zt,Zt]=Ft.first.point,[li,St,Lt]=Ft.last.point;[ei,zt]=Mo(ei,zt,Zt,F),[li,St]=Mo(li,St,Lt,F);const Ti=tn(Ct,si,(li-ei)*$e,St-zt);if(m.flipState=Ti&&Ti.needsFlipping?1:2,Ti)return Ti}Ht(Ft.first);for(let ei=xt+1;ei<xt+Rt-1;ei++){const zt=ca(Ye*G.getoffsetX(ei),rt,mt,d,ke,ze,kt,pt,At,Q,C,We,qe,!1,!1,Ue,He,Je);if(!zt)return fe.length-=4*(ei-xt),{notEnoughRoom:!0};Ht(zt)}Ht(Ft.last)}else{if(_&&!d){const ei=Mo(ze.x,ze.y,0,x),zt=pt+kt+1,Zt=new u.pointGeometry(Q.getx(zt),Q.gety(zt)),li=Mo(Zt.x,Zt.y,0,x),St=li[3]>0?li:ti(ze,Zt,ei,1,x,void 0,Ue,He.canonical),Lt=tn(Ct,si,(St[0]-ei[0])*$e,St[1]-ei[1]);if(m.flipState=Lt&&Lt.needsFlipping?1:2,Lt)return Lt}const Ft=ca(Ye*G.getoffsetX(xt),rt,mt,d,ke,ze,kt,pt,At,Q,C,We,qe,!1,!1,Ue,He,Je);if(!Ft)return{notEnoughRoom:!0};Ht(Ft)}return{}}function vu(m,l,d,_,x){const{x:C,y:F,z:G}=_.projectTilePoint(m.x,m.y,l);if(!x)return Mo(C,F,G,d);const[Q,fe,pe]=x(m);return Mo(C+Q,F+fe,G+pe,d)}function ti(m,l,d,_,x,C,F,G){const Q=vu(m.sub(l)._unit()._add(m),G,x,F,C);return u.sub(Q,d,Q),u.normalize(Q,Q),u.scaleAndAdd(Q,d,Q,_)}function ca(m,l,d,_,x,C,F,G,Q,fe,pe,ke,ze,We,$e,qe,Ue,He){const Je=_?m-l:m+l;let Ye=Je>0?1:-1,rt=0;_&&(Ye*=-1,rt=Math.PI),Ye<0&&(rt+=Math.PI);let mt=G+F+(Ye>0?0:1)|0,pt=x,xt=x,Rt=0,kt=0;const Ct=Math.abs(Je),si=[],At=[];let Ht=C,Ft=Ht;const ei=()=>ti(Ft,Ht,xt,Ct-Rt+1,pe,ze,qe,Ue.canonical);for(;Rt+kt<=Ct;){if(mt+=Ye,mt<G||mt>=Q)return null;if(xt=pt,Ft=Ht,si.push(xt),We&&At.push(Ft),Ht=new u.pointGeometry(fe.getx(mt),fe.gety(mt)),pt=ke[mt],!pt){const Ui=vu(Ht,Ue.canonical,pe,qe,ze);pt=Ui[3]>0?ke[mt]=Ui:ei()}Rt+=kt,kt=u.distance(xt,pt)}$e&&ze&&(ke[mt]&&(pt=ei(),kt=u.distance(xt,pt)),ke[mt]=pt);const zt=(Ct-Rt)/kt,Zt=Ht.sub(Ft)._mult(zt)._add(Ft),li=u.sub([],pt,xt),St=u.scaleAndAdd([],xt,li,zt);let Lt=[0,0,1],Ti=li[0],ki=li[1];if(He&&(Lt=qe.upVector(Ue.canonical,Zt.x,Zt.y),0!==Lt[0]||0!==Lt[1]||1!==Lt[2])){const Ui=[Lt[2],0,-Lt[0]],cn=u.cross([],Lt,Ui);u.normalize(Ui,Ui),u.normalize(cn,cn),Ti=u.dot(li,Ui),ki=u.dot(li,cn)}if(d){const Ui=u.cross([],Lt,li);u.normalize(Ui,Ui),u.scaleAndAdd(St,St,Ui,d*Ye)}const Di=rt+Math.atan2(ki,Ti);return si.push(St),We&&At.push(Zt),{point:St,angle:Di,path:si,tilePath:At,up:Lt}}function Gi(m,l){const d=l.length,_=d+4*m;l.resize(_),l.float32.fill(-1/0,4*d,4*_)}function Ji(m,l,d){const _=l[0],x=l[1];return m[0]=d[0]*_+d[4]*x+d[12],m[1]=d[1]*_+d[5]*x+d[13],m[3]=d[3]*_+d[7]*x+d[15],m}const Oa=100;class xu{constructor(l,d,_=new xr(l.width+200,l.height+200,25),x=new xr(l.width+200,l.height+200,25)){this.transform=l,this.grid=_,this.ignoredGrid=x,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Oa,this.screenBottomBoundary=l.height+Oa,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.fogState=d}placeCollisionBox(l,d,_,x,C,F,G,Q){let fe=_.projectedAnchorX,pe=_.projectedAnchorY,ke=_.projectedAnchorZ;const ze=_.elevation,We=_.tileID,$e=l.getProjection();if(ze&&We){const[pt,xt,Rt]=$e.upVector(We.canonical,_.tileAnchorX,_.tileAnchorY),kt=$e.upVectorScale(We.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;fe+=pt*ze*kt,pe+=xt*ze*kt,ke+=Rt*ze*kt}const qe=this.projectAndGetPerspectiveRatio(G,fe,pe,ke,_.tileID,"globe"===$e.name||!!ze||this.transform.pitch>0,$e),Ue=F*qe.perspectiveRatio,He=(_.x1*d+x.x-_.padding)*Ue+qe.point.x,Je=(_.y1*d+x.y-_.padding)*Ue+qe.point.y,Ye=(_.x2*d+x.x+_.padding)*Ue+qe.point.x,rt=(_.y2*d+x.y+_.padding)*Ue+qe.point.y,mt=qe.perspectiveRatio<=.55||qe.occluded;return!this.isInsideGrid(He,Je,Ye,rt)||!C&&this.grid.hitTest(He,Je,Ye,rt,Q)||mt?{box:[],offscreen:!1,occluded:qe.occluded}:{box:[He,Je,Ye,rt],offscreen:this.isOffscreen(He,Je,Ye,rt),occluded:!1}}placeCollisionCircles(l,d,_,x,C,F,G,Q,fe,pe,ke,ze,We,$e,qe){const Ue=[],He=this.transform.elevation,Je=l.getProjection(),Ye=He?He.getAtTileOffsetFunc(qe,this.transform.center.lat,this.transform.worldSize,Je):null,rt=new u.pointGeometry(_.tileAnchorX,_.tileAnchorY);let{x:mt,y:pt,z:xt}=Je.projectTilePoint(rt.x,rt.y,qe.canonical);if(Ye){const[Zt,li,St]=Ye(rt);mt+=Zt,pt+=li,xt+=St}const Rt="globe"===Je.name,kt=this.projectAndGetPerspectiveRatio(G,mt,pt,xt,qe,Rt||!!He||this.transform.pitch>0,Je),{perspectiveRatio:Ct}=kt,si=(ke?F/Ct:F*Ct)/u.ONE_EM,At=Mo(mt,pt,xt,Q),Ht=kt.signedDistanceFromCamera>0?On(si,C,_.lineOffsetX*si,_.lineOffsetY*si,!1,At,rt,_,x,Q,{},He&&!ke?Ye:null,ke&&!!He,Je,qe,ke):null;let Ft=!1,ei=!1,zt=!0;if(Ht&&!kt.occluded){const Zt=.5*We*Ct+$e,li=new u.pointGeometry(-100,-100),St=new u.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Lt=new io,{first:Ti,last:ki}=Ht,Di=Ti.path.length;let Ui=[];for(let Ci=Di-1;Ci>=1;Ci--)Ui.push(Ti.path[Ci]);for(let Ci=1;Ci<ki.path.length;Ci++)Ui.push(ki.path[Ci]);const cn=2.5*Zt;fe&&(Ui=Ui.map(([Ci,jn,Un],cr)=>(Ye&&!Rt&&(Un=Ye(cr<Di-1?Ti.tilePath[Di-1-cr]:ki.tilePath[cr-Di+2])[2]),Mo(Ci,jn,Un,fe))),Ui.some(Ci=>Ci[3]<=0)&&(Ui=[]));let Fi=[];if(Ui.length>0){let Ci=1/0,jn=-1/0,Un=1/0,cr=-1/0;for(const tr of Ui)Ci=Math.min(Ci,tr[0]),Un=Math.min(Un,tr[1]),jn=Math.max(jn,tr[0]),cr=Math.max(cr,tr[1]);jn>=li.x&&Ci<=St.x&&cr>=li.y&&Un<=St.y&&(Fi=[Ui.map(tr=>new u.pointGeometry(tr[0],tr[1]))],(Ci<li.x||jn>St.x||Un<li.y||cr>St.y)&&(Fi=u.clipLine(Fi,li.x,li.y,St.x,St.y)))}for(const Ci of Fi){Lt.reset(Ci,.25*Zt);let jn=0;jn=Lt.length<=.5*Zt?1:Math.ceil(Lt.paddedLength/cn)+1;for(let Un=0;Un<jn;Un++){const cr=Un/Math.max(jn-1,1),tr=Lt.lerp(cr),os=tr.x+Oa,bs=tr.y+Oa;Ue.push(os,bs,Zt,0);const ss=os-Zt,Ns=bs-Zt,ir=os+Zt,fr=bs+Zt;if(zt=zt&&this.isOffscreen(ss,Ns,ir,fr),ei=ei||this.isInsideGrid(ss,Ns,ir,fr),!d&&this.grid.hitTestCircle(os,bs,Zt,ze)&&(Ft=!0,!pe))return{circles:[],offscreen:!1,collisionDetected:Ft,occluded:!1}}}}return{circles:!pe&&Ft||!ei?[]:Ue,offscreen:zt,collisionDetected:Ft,occluded:kt.occluded}}queryRenderedSymbols(l){if(0===l.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const d=[];let _=1/0,x=1/0,C=-1/0,F=-1/0;for(const pe of l){const ke=new u.pointGeometry(pe.x+Oa,pe.y+Oa);_=Math.min(_,ke.x),x=Math.min(x,ke.y),C=Math.max(C,ke.x),F=Math.max(F,ke.y),d.push(ke)}const G=this.grid.query(_,x,C,F).concat(this.ignoredGrid.query(_,x,C,F)),Q={},fe={};for(const pe of G){const ke=pe.key;if(void 0===Q[ke.bucketInstanceId]&&(Q[ke.bucketInstanceId]={}),Q[ke.bucketInstanceId][ke.featureIndex])continue;const ze=[new u.pointGeometry(pe.x1,pe.y1),new u.pointGeometry(pe.x2,pe.y1),new u.pointGeometry(pe.x2,pe.y2),new u.pointGeometry(pe.x1,pe.y2)];u.polygonIntersectsPolygon(d,ze)&&(Q[ke.bucketInstanceId][ke.featureIndex]=!0,void 0===fe[ke.bucketInstanceId]&&(fe[ke.bucketInstanceId]=[]),fe[ke.bucketInstanceId].push(ke.featureIndex))}return fe}insertCollisionBox(l,d,_,x,C){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:x,collisionGroupID:C},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,d,_,x,C){const F=d?this.ignoredGrid:this.grid,G={bucketInstanceId:_,featureIndex:x,collisionGroupID:C};for(let Q=0;Q<l.length;Q+=4)F.insertCircle(G,l[Q],l[Q+1],l[Q+2])}projectAndGetPerspectiveRatio(l,d,_,x,C,F,G){const Q=[d,_,x,1];let fe=!1;if(x||this.transform.pitch>0){u.transformMat4$1(Q,Q,l);const ke="globe"===G.name;this.fogState&&C&&!ke&&(fe=function(We,$e,qe,Ue,He,Je){const Ye=Je.calculateFogTileMatrix(He),rt=[$e,qe,Ue];return u.transformMat4(rt,rt,Ye),U(We,rt,Je.pitch,Je._fov)}(this.fogState,d,_,x,C.toUnwrapped(),this.transform)>.9)}else Ji(Q,Q,l);const pe=Q[3];return{point:new u.pointGeometry((Q[0]/pe+1)/2*this.transform.width+Oa,(-Q[1]/pe+1)/2*this.transform.height+Oa),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(G)/pe*.5,1.5),signedDistanceFromCamera:pe,occluded:F&&Q[2]>pe||fe}}isOffscreen(l,d,_,x){return _<Oa||l>=this.screenRightBoundary||x<Oa||d>this.screenBottomBoundary}isInsideGrid(l,d,_,x){return _>=0&&l<this.gridRightBoundary&&x>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const l=u.identity([]);return u.translate(l,l,[-100,-100,0]),l}}function Eh(m,l,d){const _=l.createTileMatrix(m,m.worldSize,d.toUnwrapped());return u.multiply(new Float32Array(16),m.projMatrix,_)}function wl(m,l,d){if(l.projection.name===d.projection.name)return m.projMatrix;const _=d.clone();return _.setProjection(l.projection),Eh(_,l.getProjection(),m)}function So(m,l,d){return l.name===d.projection.name?m.projMatrix:Eh(d,l,m)}class wf{constructor(l,d,_,x){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?d:-d))):x&&_?1:0,this.placed=_}isHidden(){return 0===this.opacity&&!this.placed}}class Cl{constructor(l,d,_,x,C,F=!1){this.text=new wf(l?l.text:null,d,_,C),this.icon=new wf(l?l.icon:null,d,x,C),this.clipped=F}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class bu{constructor(l,d,_,x=!1){this.text=l,this.icon=d,this.skipFade=_,this.clipped=x}}class Xs{constructor(){this.invProjMatrix=u.create(),this.viewportMatrix=u.create(),this.circles=[]}}class Cf{constructor(l,d,_,x,C){this.bucketInstanceId=l,this.featureIndex=d,this.sourceLayerIndex=_,this.bucketIndex=x,this.tileID=C}}class Ps{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const d=++this.maxGroupID;this.collisionGroups[l]={ID:d,predicate:_=>_.collisionGroupID===d}}return this.collisionGroups[l]}}function Ur(m,l,d,_,x){const{horizontalAlign:C,verticalAlign:F}=u.getAnchorAlignment(m),G=-(C-.5)*l,Q=-(F-.5)*d,fe=u.evaluateVariableOffset(m,_);return new u.pointGeometry(G+fe[0]*x,Q+fe[1]*x)}function wu(m,l,d,_,x){const C=new u.pointGeometry(m,l);return d&&C._rotate(_?x:-x),C}class $d{constructor(l,d,_,x,C){this.transform=l.clone(),this.projection=l.projection.name,this.collisionIndex=new xu(this.transform,C),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Ps(_),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,d,_,x){const C=_.getBucket(d),F=_.latestFeatureIndex;if(!C||!F||d.id!==C.layerIds[0])return;const G=C.layers[0].layout,Q=_.collisionBoxArray,fe=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),pe=_.tileSize/u.EXTENT,ke=_.tileID.toUnwrapped();this.transform.setProjection(C.projection);const ze=(We=_.tileID,$e=C.getProjection(),qe=this.transform,$e.name===this.projection?qe.calculateProjMatrix(We.toUnwrapped()):Eh(qe,$e,We));var We,$e,qe;const Ue="map"===G.get("text-pitch-alignment"),He="map"===G.get("text-rotation-alignment");d.compileFilter();const Je=d.dynamicFilter(),Ye=d.dynamicFilterNeedsFeature(),rt=this.transform.calculatePixelsToTileUnitsMatrix(_),mt=Nc(ze,_.tileID.canonical,Ue,He,this.transform,C.getProjection(),rt);let pt=null;if(Ue){const kt=br(ze,_.tileID.canonical,Ue,He,this.transform,C.getProjection(),rt);pt=u.multiply([],this.transform.labelPlaneMatrix,kt)}let xt=null;Je&&_.latestFeatureIndex&&(xt={unwrappedTileID:ke,dynamicFilter:Je,dynamicFilterNeedsFeature:Ye,featureIndex:_.latestFeatureIndex}),this.retainedQueryData[C.bucketInstanceId]=new Cf(C.bucketInstanceId,F,C.sourceLayerIndex,C.index,_.tileID);const Rt={bucket:C,layout:G,posMatrix:ze,textLabelPlaneMatrix:mt,labelToScreenMatrix:pt,clippingData:xt,scale:fe,textPixelRatio:pe,holdingForFade:_.holdingForFade(),collisionBoxArray:Q,partiallyEvaluatedTextSize:u.evaluateSizeForZoom(C.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:u.evaluateSizeForZoom(C.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(C.sourceID)};if(x)for(const kt of C.sortKeyRanges){const{sortKey:Ct,symbolInstanceStart:si,symbolInstanceEnd:At}=kt;l.push({sortKey:Ct,symbolInstanceStart:si,symbolInstanceEnd:At,parameters:Rt})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:Rt})}attemptAnchorPlacement(l,d,_,x,C,F,G,Q,fe,pe,ke,ze,We,$e,qe,Ue,He,Je){const{textOffset0:Ye,textOffset1:rt,crossTileID:mt}=ze,pt=[Ye,rt],xt=Ur(l,_,x,pt,C),Rt=this.collisionIndex.placeCollisionBox($e,C,d,wu(xt.x,xt.y,F,G,this.transform.angle),ke,Q,fe,pe.predicate);if(Ue){const kt=$e.getSymbolInstanceIconSize(Je,this.transform.zoom,ze.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox($e,kt,Ue,wu(xt.x,xt.y,F,G,this.transform.angle),ke,Q,fe,pe.predicate).box.length)return}if(Rt.box.length>0){let kt;return this.prevPlacement&&this.prevPlacement.variableOffsets[mt]&&this.prevPlacement.placements[mt]&&this.prevPlacement.placements[mt].text&&(kt=this.prevPlacement.variableOffsets[mt].anchor),this.variableOffsets[mt]={textOffset:pt,width:_,height:x,anchor:l,textScale:C,prevAnchor:kt},this.markUsedJustification($e,l,ze,qe),$e.allowVerticalPlacement&&(this.markUsedOrientation($e,qe,ze),this.placedOrientations[mt]=qe),{shift:xt,placedGlyphBoxes:Rt}}}placeLayerBucketPart(l,d,_,x){const{bucket:C,layout:F,posMatrix:G,textLabelPlaneMatrix:Q,labelToScreenMatrix:fe,clippingData:pe,textPixelRatio:ke,holdingForFade:ze,collisionBoxArray:We,partiallyEvaluatedTextSize:$e,partiallyEvaluatedIconSize:qe,collisionGroup:Ue}=l.parameters,He=F.get("text-optional"),Je=F.get("icon-optional"),Ye=F.get("text-allow-overlap"),rt=F.get("icon-allow-overlap"),mt="map"===F.get("text-rotation-alignment"),pt="map"===F.get("text-pitch-alignment"),xt="none"!==F.get("icon-text-fit"),Rt="viewport-y"===F.get("symbol-z-order");this.transform.setProjection(C.projection);let kt=Ye&&(rt||!C.hasIconData()||Je),Ct=rt&&(Ye||!C.hasTextData()||He);!C.collisionArrays&&We&&C.deserializeCollisionBoxes(We),_&&x&&C.updateCollisionDebugBuffers(this.transform.zoom,We);const si=(At,Ht,Ft)=>{const{crossTileID:ei,numVerticalGlyphVertices:zt}=At;if(pe){const ir={zoom:this.transform.zoom,pitch:this.transform.pitch};let fr=null;if(pe.dynamicFilterNeedsFeature){const Ln=this.retainedQueryData[C.bucketInstanceId];fr=pe.featureIndex.loadFeature({featureIndex:At.featureIndex,bucketIndex:Ln.bucketIndex,sourceLayerIndex:Ln.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,pe.dynamicFilter)(ir,fr,this.retainedQueryData[C.bucketInstanceId].tileID.canonical,new u.pointGeometry(At.tileAnchorX,At.tileAnchorY),this.transform.calculateDistanceTileData(pe.unwrappedTileID)))return this.placements[ei]=new bu(!1,!1,!1,!0),void(d[ei]=!0)}if(d[ei])return;if(ze)return void(this.placements[ei]=new bu(!1,!1,!1));let Zt=!1,li=!1,St=!0,Lt=!1,Ti=!1,ki=null,Di={box:null,offscreen:null,occluded:null},Ui={box:null,offscreen:null,occluded:null},cn=null,Fi=null,Ci=null,jn=0,Un=0,cr=0;Ft.textFeatureIndex?jn=Ft.textFeatureIndex:At.useRuntimeCollisionCircles&&(jn=At.featureIndex),Ft.verticalTextFeatureIndex&&(Un=Ft.verticalTextFeatureIndex);const tr=ir=>{ir.tileID=this.retainedQueryData[C.bucketInstanceId].tileID;const fr=this.transform.elevation;(fr||ir.elevation)&&(ir.elevation=fr?fr.getAtTileOffset(ir.tileID,ir.tileAnchorX,ir.tileAnchorY):0)},os=Ft.textBox;if(os){tr(os);const ir=Ln=>{let Nr=u.WritingMode.horizontal;if(C.allowVerticalPlacement&&!Ln&&this.prevPlacement){const Yr=this.prevPlacement.placedOrientations[ei];Yr&&(this.placedOrientations[ei]=Yr,Nr=Yr,this.markUsedOrientation(C,Nr,At))}return Nr},fr=(Ln,Nr)=>{if(C.allowVerticalPlacement&&zt>0&&Ft.verticalTextBox){for(const Yr of C.writingModes)if(Yr===u.WritingMode.vertical?(Di=Nr(),Ui=Di):Di=Ln(),Di&&Di.box&&Di.box.length)break}else Di=Ln()};if(F.get("text-variable-anchor")){let Ln=F.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ei]){const mr=this.prevPlacement.variableOffsets[ei];Ln.indexOf(mr.anchor)>0&&(Ln=Ln.filter(Hn=>Hn!==mr.anchor),Ln.unshift(mr.anchor))}const Nr=(mr,Hn,fc)=>{const ol=C.getSymbolInstanceTextSize($e,At,this.transform.zoom,Ht),Oo=(mr.x2-mr.x1)*ol+2*mr.padding,po=(mr.y2-mr.y1)*ol+2*mr.padding,as=xt&&!rt?Hn:null;as&&tr(as);let ls={box:[],offscreen:!1,occluded:!1};const Va=Ye?2*Ln.length:Ln.length;for(let mc=0;mc<Va;++mc){const na=this.attemptAnchorPlacement(Ln[mc%Ln.length],mr,Oo,po,ol,mt,pt,ke,G,Ue,mc>=Ln.length,At,Ht,C,fc,as,$e,qe);if(na&&(ls=na.placedGlyphBoxes,ls&&ls.box&&ls.box.length)){Zt=!0,ki=na.shift;break}}return ls};fr(()=>Nr(os,Ft.iconBox,u.WritingMode.horizontal),()=>{const mr=Ft.verticalTextBox;return mr&&tr(mr),C.allowVerticalPlacement&&!(Di&&Di.box&&Di.box.length)&&zt>0&&mr?Nr(mr,Ft.verticalIconBox,u.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Di&&(Zt=Di.box,St=Di.offscreen,Lt=Di.occluded);const Yr=ir(Di&&Di.box);if(!Zt&&this.prevPlacement){const mr=this.prevPlacement.variableOffsets[ei];mr&&(this.variableOffsets[ei]=mr,this.markUsedJustification(C,mr.anchor,At,Yr))}}else{const Ln=(Nr,Yr)=>{const mr=C.getSymbolInstanceTextSize($e,At,this.transform.zoom,Ht),Hn=this.collisionIndex.placeCollisionBox(C,mr,Nr,new u.pointGeometry(0,0),Ye,ke,G,Ue.predicate);return Hn&&Hn.box&&Hn.box.length&&(this.markUsedOrientation(C,Yr,At),this.placedOrientations[ei]=Yr),Hn};fr(()=>Ln(os,u.WritingMode.horizontal),()=>{const Nr=Ft.verticalTextBox;return C.allowVerticalPlacement&&zt>0&&Nr?(tr(Nr),Ln(Nr,u.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),ir(Di&&Di.box&&Di.box.length)}}if(cn=Di,Zt=cn&&cn.box&&cn.box.length>0,St=cn&&cn.offscreen,Lt=cn&&cn.occluded,At.useRuntimeCollisionCircles){const ir=C.text.placedSymbolArray.get(At.centerJustifiedTextSymbolIndex>=0?At.centerJustifiedTextSymbolIndex:At.verticalPlacedTextSymbolIndex),fr=u.evaluateSizeForFeature(C.textSizeData,$e,ir),Ln=F.get("text-padding");Fi=this.collisionIndex.placeCollisionCircles(C,Ye,ir,C.lineVertexArray,C.glyphOffsetArray,fr,G,Q,fe,_,pt,Ue.predicate,At.collisionCircleDiameter*fr/u.ONE_EM,Ln,this.retainedQueryData[C.bucketInstanceId].tileID),Zt=Ye||Fi.circles.length>0&&!Fi.collisionDetected,St=St&&Fi.offscreen,Lt=Fi.occluded}if(Ft.iconFeatureIndex&&(cr=Ft.iconFeatureIndex),Ft.iconBox){const ir=fr=>{tr(fr);const Ln=xt&&ki?wu(ki.x,ki.y,mt,pt,this.transform.angle):new u.pointGeometry(0,0),Nr=C.getSymbolInstanceIconSize(qe,this.transform.zoom,At.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(C,Nr,fr,Ln,rt,ke,G,Ue.predicate)};Ui&&Ui.box&&Ui.box.length&&Ft.verticalIconBox?(Ci=ir(Ft.verticalIconBox),li=Ci.box.length>0):(Ci=ir(Ft.iconBox),li=Ci.box.length>0),St=St&&Ci.offscreen,Ti=Ci.occluded}const bs=He||0===At.numHorizontalGlyphVertices&&0===zt,ss=Je||0===At.numIconVertices;if(bs||ss?ss?bs||(li=li&&Zt):Zt=li&&Zt:li=Zt=li&&Zt,Zt&&cn&&cn.box&&this.collisionIndex.insertCollisionBox(cn.box,F.get("text-ignore-placement"),C.bucketInstanceId,Ui&&Ui.box&&Un?Un:jn,Ue.ID),li&&Ci&&this.collisionIndex.insertCollisionBox(Ci.box,F.get("icon-ignore-placement"),C.bucketInstanceId,cr,Ue.ID),Fi&&(Zt&&this.collisionIndex.insertCollisionCircles(Fi.circles,F.get("text-ignore-placement"),C.bucketInstanceId,jn,Ue.ID),_)){const ir=C.bucketInstanceId;let fr=this.collisionCircleArrays[ir];void 0===fr&&(fr=this.collisionCircleArrays[ir]=new Xs);for(let Ln=0;Ln<Fi.circles.length;Ln+=4)fr.circles.push(Fi.circles[Ln+0]),fr.circles.push(Fi.circles[Ln+1]),fr.circles.push(Fi.circles[Ln+2]),fr.circles.push(Fi.collisionDetected?1:0)}const Ns="globe"!==C.projection.name;kt=kt&&(Ns||!Lt),Ct=Ct&&(Ns||!Ti),this.placements[ei]=new bu(Zt||kt,li||Ct,St||C.justReloaded),d[ei]=!0};if(Rt){const At=C.getSortedSymbolIndexes(this.transform.angle);for(let Ht=At.length-1;Ht>=0;--Ht){const Ft=At[Ht];si(C.symbolInstances.get(Ft),Ft,C.collisionArrays[Ft])}}else for(let At=l.symbolInstanceStart;At<l.symbolInstanceEnd;At++)si(C.symbolInstances.get(At),At,C.collisionArrays[At]);if(_&&C.bucketInstanceId in this.collisionCircleArrays){const At=this.collisionCircleArrays[C.bucketInstanceId];u.invert(At.invProjMatrix,G),At.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(l,d,_,x){const{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:F,rightJustifiedTextSymbolIndex:G,verticalPlacedTextSymbolIndex:Q,crossTileID:fe}=_,pe=u.getAnchorJustification(d),ke=x===u.WritingMode.vertical?Q:"left"===pe?C:"center"===pe?F:"right"===pe?G:-1;C>=0&&(l.text.placedSymbolArray.get(C).crossTileID=ke>=0&&C!==ke?0:fe),F>=0&&(l.text.placedSymbolArray.get(F).crossTileID=ke>=0&&F!==ke?0:fe),G>=0&&(l.text.placedSymbolArray.get(G).crossTileID=ke>=0&&G!==ke?0:fe),Q>=0&&(l.text.placedSymbolArray.get(Q).crossTileID=ke>=0&&Q!==ke?0:fe)}markUsedOrientation(l,d,_){const x=d===u.WritingMode.horizontal||d===u.WritingMode.horizontalOnly?d:0,C=d===u.WritingMode.vertical?d:0,{leftJustifiedTextSymbolIndex:F,centerJustifiedTextSymbolIndex:G,rightJustifiedTextSymbolIndex:Q,verticalPlacedTextSymbolIndex:fe}=_,pe=l.text.placedSymbolArray;F>=0&&(pe.get(F).placedOrientation=x),G>=0&&(pe.get(G).placedOrientation=x),Q>=0&&(pe.get(Q).placedOrientation=x),fe>=0&&(pe.get(fe).placedOrientation=C)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let _=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const x=d?d.symbolFadeChange(l):1,C=d?d.opacities:{},F=d?d.variableOffsets:{},G=d?d.placedOrientations:{};for(const Q in this.placements){const fe=this.placements[Q],pe=C[Q];pe?(this.opacities[Q]=new Cl(pe,x,fe.text,fe.icon,null,fe.clipped),_=_||fe.text!==pe.text.placed||fe.icon!==pe.icon.placed):(this.opacities[Q]=new Cl(null,x,fe.text,fe.icon,fe.skipFade,fe.clipped),_=_||fe.text||fe.icon)}for(const Q in C){const fe=C[Q];if(!this.opacities[Q]){const pe=new Cl(fe,x,!1,!1);pe.isHidden()||(this.opacities[Q]=pe,_=_||fe.text.placed||fe.icon.placed)}}for(const Q in F)this.variableOffsets[Q]||!this.opacities[Q]||this.opacities[Q].isHidden()||(this.variableOffsets[Q]=F[Q]);for(const Q in G)this.placedOrientations[Q]||!this.opacities[Q]||this.opacities[Q].isHidden()||(this.placedOrientations[Q]=G[Q]);_?this.lastPlacementChangeTime=l:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:l)}updateLayerOpacities(l,d){const _={};for(const x of d){const C=x.getBucket(l);C&&x.latestFeatureIndex&&l.id===C.layerIds[0]&&this.updateBucketOpacities(C,_,x.collisionBoxArray)}}updateBucketOpacities(l,d,_){l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const x=l.layers[0].layout,C=!!l.layers[0].dynamicFilter(),F=new Cl(null,0,!1,!1,!0),G=x.get("text-allow-overlap"),Q=x.get("icon-allow-overlap"),fe=x.get("text-variable-anchor"),pe="map"===x.get("text-rotation-alignment"),ke="map"===x.get("text-pitch-alignment"),ze="none"!==x.get("icon-text-fit"),We=new Cl(null,0,G&&(Q||!l.hasIconData()||x.get("icon-optional")),Q&&(G||!l.hasTextData()||x.get("text-optional")),!0);!l.collisionArrays&&_&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(_);const $e=(Ue,He,Je)=>{for(let Ye=0;Ye<He/4;Ye++)Ue.opacityVertexArray.emplaceBack(Je)};let qe=0;for(let Ue=0;Ue<l.symbolInstances.length;Ue++){const He=l.symbolInstances.get(Ue),{numHorizontalGlyphVertices:Je,numVerticalGlyphVertices:Ye,crossTileID:rt,numIconVertices:mt}=He;let pt=this.opacities[rt];d[rt]?pt=F:pt||(pt=We,this.opacities[rt]=pt),d[rt]=!0;const xt=Je>0||Ye>0,Rt=mt>0,kt=this.placedOrientations[rt],Ct=kt===u.WritingMode.vertical,si=kt===u.WritingMode.horizontal||kt===u.WritingMode.horizontalOnly;if(!xt&&!Rt||pt.isHidden()||qe++,xt){const At=hi(pt.text);$e(l.text,Je,Ct?Mh:At),$e(l.text,Ye,si?Mh:At);const Ht=pt.text.isHidden(),{leftJustifiedTextSymbolIndex:Ft,centerJustifiedTextSymbolIndex:ei,rightJustifiedTextSymbolIndex:zt,verticalPlacedTextSymbolIndex:Zt}=He,li=l.text.placedSymbolArray,St=Ht||Ct?1:0;Ft>=0&&(li.get(Ft).hidden=St),ei>=0&&(li.get(ei).hidden=St),zt>=0&&(li.get(zt).hidden=St),Zt>=0&&(li.get(Zt).hidden=Ht||si?1:0);const Lt=this.variableOffsets[rt];Lt&&this.markUsedJustification(l,Lt.anchor,He,kt);const Ti=this.placedOrientations[rt];Ti&&(this.markUsedJustification(l,"left",He,Ti),this.markUsedOrientation(l,Ti,He))}if(Rt){const At=hi(pt.icon),{placedIconSymbolIndex:Ht,verticalPlacedIconSymbolIndex:Ft}=He,ei=l.icon.placedSymbolArray,zt=pt.icon.isHidden()?1:0;Ht>=0&&($e(l.icon,mt,Ct?Mh:At),ei.get(Ht).hidden=zt),Ft>=0&&($e(l.icon,He.numVerticalIconVertices,si?Mh:At),ei.get(Ft).hidden=zt)}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const At=l.collisionArrays[Ue];if(At){let Ht=new u.pointGeometry(0,0),Ft=!0;if(At.textBox||At.verticalTextBox){if(fe){const zt=this.variableOffsets[rt];zt?(Ht=Ur(zt.anchor,zt.width,zt.height,zt.textOffset,zt.textScale),pe&&Ht._rotate(ke?this.transform.angle:-this.transform.angle)):Ft=!1}C&&(Ft=!pt.clipped),At.textBox&&Vo(l.textCollisionBox.collisionVertexArray,pt.text.placed,!Ft||Ct,Ht.x,Ht.y),At.verticalTextBox&&Vo(l.textCollisionBox.collisionVertexArray,pt.text.placed,!Ft||si,Ht.x,Ht.y)}const ei=Ft&&Boolean(!si&&At.verticalIconBox);At.iconBox&&Vo(l.iconCollisionBox.collisionVertexArray,pt.icon.placed,ei,ze?Ht.x:0,ze?Ht.y:0),At.verticalIconBox&&Vo(l.iconCollisionBox.collisionVertexArray,pt.icon.placed,!ei,ze?Ht.x:0,ze?Ht.y:0)}}}if(l.fullyClipped=0===qe,l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){const Ue=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=Ue.invProjMatrix,l.placementViewportMatrix=Ue.viewportMatrix,l.collisionCircleArray=Ue.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return 0===this.fadeDuration?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,d){const _=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*_>l}setStale(){this.stale=!0}}function Vo(m,l,d,_,x){m.emplaceBack(l?1:0,d?1:0,_||0,x||0),m.emplaceBack(l?1:0,d?1:0,_||0,x||0),m.emplaceBack(l?1:0,d?1:0,_||0,x||0),m.emplaceBack(l?1:0,d?1:0,_||0,x||0)}const qs=Math.pow(2,25),Ag=Math.pow(2,24),jo=Math.pow(2,17),an=Math.pow(2,16),Cu=Math.pow(2,9),Ef=Math.pow(2,8),Eu=Math.pow(2,1);function hi(m){if(0===m.opacity&&!m.placed)return 0;if(1===m.opacity&&m.placed)return 4294967295;const l=m.placed?1:0,d=Math.floor(127*m.opacity);return d*qs+l*Ag+d*jo+l*an+d*Cu+l*Ef+d*Eu+l}const Mh=0;class fn{constructor(l){this._sortAcrossTiles="viewport-y"!==l.layout.get("symbol-z-order")&&void 0!==l.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,d,_,x,C){const F=this._bucketParts;for(;this._currentTileIndex<l.length;)if(d.getBucketParts(F,x,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,C())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,F.sort((G,Q)=>G.sortKey-Q.sortKey));this._currentPartIndex<F.length;){const G=F[this._currentPartIndex];if(d.placeLayerBucketPart(G,this._seenCrossTileIDs,_,0===G.symbolInstanceStart),this._currentPartIndex++,C())return!0}return!1}}class Ys{constructor(l,d,_,x,C,F,G,Q){this.placement=new $d(l,C,F,G,Q),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(l,d,_){const x=u.exported.now(),C=()=>{const F=u.exported.now()-x;return!this._forceFullPlacement&&F>2};for(;this._currentPlacementIndex>=0;){const F=d[l[this._currentPlacementIndex]],G=this.placement.collisionIndex.transform.zoom;if("symbol"===F.type&&(!F.minzoom||F.minzoom<=G)&&(!F.maxzoom||F.maxzoom>G)){if(this._inProgressLayer||(this._inProgressLayer=new fn(F)),this._inProgressLayer.continuePlacement(_[F.source],this.placement,this._showCollisionBoxes,F,C))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const Sh=512/u.EXTENT/2;class Th{constructor(l,d,_){this.tileID=l,this.indexedSymbolInstances={},this.bucketInstanceId=_;for(let x=0;x<d.length;x++){const C=d.get(x),F=C.key;this.indexedSymbolInstances[F]||(this.indexedSymbolInstances[F]=[]),this.indexedSymbolInstances[F].push({crossTileID:C.crossTileID,coord:this.getScaledCoordinates(C,l)})}}getScaledCoordinates(l,d){const _=Sh/Math.pow(2,d.canonical.z-this.tileID.canonical.z);return{x:Math.floor((d.canonical.x*u.EXTENT+l.tileAnchorX)*_),y:Math.floor((d.canonical.y*u.EXTENT+l.tileAnchorY)*_)}}findMatches(l,d,_){const x=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let C=0;C<l.length;C++){const F=l.get(C);if(F.crossTileID)continue;const G=this.indexedSymbolInstances[F.key];if(!G)continue;const Q=this.getScaledCoordinates(F,d);for(const fe of G)if(Math.abs(fe.coord.x-Q.x)<=x&&Math.abs(fe.coord.y-Q.y)<=x&&!_[fe.crossTileID]){_[fe.crossTileID]=!0,F.crossTileID=fe.crossTileID;break}}}}class kg{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Wd{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const d=Math.round((l-this.lng)/360);if(0!==d)for(const _ in this.indexes){const x=this.indexes[_],C={};for(const F in x){const G=x[F];G.tileID=G.tileID.unwrapTo(G.tileID.wrap+d),C[G.tileID.key]=G}this.indexes[_]=C}this.lng=l}addBucket(l,d,_){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let C=0;C<d.symbolInstances.length;C++)d.symbolInstances.get(C).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const x=this.usedCrossTileIDs[l.overscaledZ];for(const C in this.indexes){const F=this.indexes[C];if(Number(C)>l.overscaledZ)for(const G in F){const Q=F[G];Q.tileID.isChildOf(l)&&Q.findMatches(d.symbolInstances,l,x)}else{const G=F[l.scaledTo(Number(C)).key];G&&G.findMatches(d.symbolInstances,l,x)}}for(let C=0;C<d.symbolInstances.length;C++){const F=d.symbolInstances.get(C);F.crossTileID||(F.crossTileID=_.generate(),x[F.crossTileID]=!0)}return void 0===this.indexes[l.overscaledZ]&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Th(l,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(l,d){for(const _ in d.indexedSymbolInstances)for(const x of d.indexedSymbolInstances[_])delete this.usedCrossTileIDs[l][x.crossTileID]}removeStaleBuckets(l){let d=!1;for(const _ in this.indexes){const x=this.indexes[_];for(const C in x)l[x[C].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,x[C]),delete x[C],d=!0)}return d}}class El{constructor(){this.layerIndexes={},this.crossTileIDs=new kg,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,d,_,x){let C=this.layerIndexes[l.id];void 0===C&&(C=this.layerIndexes[l.id]=new Wd);let F=!1;const G={};"globe"!==x.name&&C.handleWrapJump(_);for(const Q of d){const fe=Q.getBucket(l);fe&&l.id===fe.layerIds[0]&&(fe.bucketInstanceId||(fe.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(Q.tileID,fe,this.crossTileIDs)&&(F=!0),G[fe.bucketInstanceId]=!0)}return C.removeStaleBuckets(G)&&(F=!0),F}pruneUnusedLayers(l){const d={};l.forEach(_=>{d[_]=!0});for(const _ in this.layerIndexes)d[_]||delete this.layerIndexes[_]}}const ic=(m,l)=>u.emitValidationErrors(m,l&&l.filter(d=>"source.canvas"!==d.identifier)),Mu=u.pick(Li,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),nc=u.pick(Li,["setCenter","setZoom","setBearing","setPitch"]),Ml={version:8,layers:[],sources:{}},nn={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class co extends u.Evented{constructor(l,d={}){super(),this.map=l,this.dispatcher=new Z(Yi(),this),this.imageManager=new te,this.imageManager.setEventedParent(this),this.glyphManager=new u.GlyphManager(l._requestManager,d.localFontFamily?u.LocalGlyphMode.all:d.localIdeographFontFamily?u.LocalGlyphMode.ideographs:u.LocalGlyphMode.none,d.localFontFamily||d.localIdeographFontFamily),this.crossTileSymbolIndex=new El,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",u.getReferrer());const _=this;this._rtlTextPluginCallback=co.registerForPluginStateChange(x=>{_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(C,F)=>{if(u.triggerPluginCompletionEvent(C),F&&F.every(G=>G))for(const G in _._sourceCaches){const Q=_._sourceCaches[G],fe=Q.getSource().type;"vector"!==fe&&"geojson"!==fe||Q.reload()}})}),this.on("data",x=>{if("source"!==x.dataType||"metadata"!==x.sourceDataType)return;const C=this.getSource(x.sourceId);if(C&&C.vectorLayerIds)for(const F in this._layers){const G=this._layers[F];G.source===C.id&&this._validateLayer(G)}})}loadURL(l,d={}){this.fire(new u.Event("dataloading",{dataType:"style"}));const _="boolean"==typeof d.validate?d.validate:!u.isMapboxURL(l);l=this.map._requestManager.normalizeStyleURL(l,d.accessToken);const x=this.map._requestManager.transformRequest(l,u.ResourceType.Style);this._request=u.getJSON(x,(C,F)=>{this._request=null,C?this.fire(new u.ErrorEvent(C)):F&&this._load(F,_)})}loadJSON(l,d={}){this.fire(new u.Event("dataloading",{dataType:"style"})),this._request=u.exported.frame(()=>{this._request=null,this._load(l,!1!==d.validate)})}loadEmpty(){this.fire(new u.Event("dataloading",{dataType:"style"})),this._load(Ml,!1)}_updateLayerCount(l,d){const _=d?1:-1;l.is3D()&&(this._num3DLayers+=_),"circle"===l.type&&(this._numCircleLayers+=_),"symbol"===l.type&&(this._numSymbolLayers+=_)}_load(l,d){if(d&&ic(this,u.validateStyle(l)))return;this._loaded=!0,this.stylesheet=u.clone$1(l),this._updateMapProjection();for(const x in l.sources)this.addSource(x,l.sources[x],{validate:!1});this._changed=!1,l.sprite?this._loadSprite(l.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(l.glyphs);const _=Xn(this.stylesheet.layers);this._order=_.map(x=>x.id),this._layers={},this._serializedLayers={};for(let x of _)x=u.createStyleLayer(x),x.setEventedParent(this,{layer:{id:x.id}}),this._layers[x.id]=x,this._serializedLayers[x.id]=x.serialize(),this._updateLayerCount(x,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new q(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new u.Event("data",{dataType:"style"})),this.fire(new u.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(l){l?this.stylesheet.projection=l:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(l){this._spriteRequest=function(d,_,x){let C,F,G;const Q=u.exported.devicePixelRatio>1?"@2x":"";let fe=u.getJSON(_.transformRequest(_.normalizeSpriteURL(d,Q,".json"),u.ResourceType.SpriteJSON),(ze,We)=>{fe=null,G||(G=ze,C=We,ke())}),pe=u.getImage(_.transformRequest(_.normalizeSpriteURL(d,Q,".png"),u.ResourceType.SpriteImage),(ze,We)=>{pe=null,G||(G=ze,F=We,ke())});function ke(){if(G)x(G);else if(C&&F){const ze=u.exported.getImageData(F),We={};for(const $e in C){const{width:qe,height:Ue,x:He,y:Je,sdf:Ye,pixelRatio:rt,stretchX:mt,stretchY:pt,content:xt}=C[$e],Rt=new u.RGBAImage({width:qe,height:Ue});u.RGBAImage.copy(ze,Rt,{x:He,y:Je},{x:0,y:0},{width:qe,height:Ue}),We[$e]={data:Rt,pixelRatio:rt,sdf:Ye,stretchX:mt,stretchY:pt,content:xt}}x(null,We)}}return{cancel(){fe&&(fe.cancel(),fe=null),pe&&(pe.cancel(),pe=null)}}}(l,this.map._requestManager,(d,_)=>{if(this._spriteRequest=null,d)this.fire(new u.ErrorEvent(d));else if(_)for(const x in _)this.imageManager.addImage(x,_[x]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new u.Event("data",{dataType:"style"}))})}_validateLayer(l){const d=this.getSource(l.source);if(!d)return;const _=l.sourceLayer;_&&("geojson"===d.type||d.vectorLayerIds&&-1===d.vectorLayerIds.indexOf(_))&&this.fire(new u.ErrorEvent(new Error(`Source layer "${_}" does not exist on source "${d.id}" as specified by style layer "${l.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this._sourceCaches)if(!this._sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(l){const d=[];for(const _ of l){const x=this._layers[_];"custom"!==x.type&&d.push(x.serialize())}return d}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const l in this._sourceCaches)if(this._sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(l){return!!this.terrain&&nn[l.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(l){if(!this._loaded)return;const d=this._changed;if(this._changed){const x=Object.keys(this._updatedLayers),C=Object.keys(this._removedLayers);(x.length||C.length)&&this._updateWorkerLayers(x,C);for(const F in this._updatedSources){const G=this._updatedSources[F];"reload"===G?this._reloadSource(F):"clear"===G&&this._clearSource(F)}this._updateTilesForChangedImages();for(const F in this._updatedPaintProps)this._layers[F].updateTransitions(l);this.light.updateTransitions(l),this.fog&&this.fog.updateTransitions(l),this._resetUpdates()}const _={};for(const x in this._sourceCaches){const C=this._sourceCaches[x];_[x]=C.used,C.used=!1}for(const x of this._order){const C=this._layers[x];if(C.recalculate(l,this._availableImages),!C.isHidden(l.zoom)){const G=this._getLayerSourceCache(C);G&&(G.used=!0)}const F=this.map.painter;if(F){const G=C.getProgramIds();if(!G)continue;const Q=C.getProgramConfiguration(l.zoom);for(const fe of G)F.useProgram(fe,Q)}}for(const x in _){const C=this._sourceCaches[x];_[x]!==C.used&&C.getSource().fire(new u.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:C.getSource().id}))}this.light.recalculate(l),this.terrain&&this.terrain.recalculate(l),this.fog&&this.fog.recalculate(l),this.z=l.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),d&&this.fire(new u.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const d in this._sourceCaches)this._sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateWorkerLayers(l,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(l),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(l){if(this._checkLoaded(),ic(this,u.validateStyle(l)))return!1;(l=u.clone$1(l)).layers=Xn(l.layers);const d=function(x,C){if(!x)return[{command:Li.setStyle,args:[C]}];let F=[];try{if(!re(x.version,C.version))return[{command:Li.setStyle,args:[C]}];re(x.center,C.center)||F.push({command:Li.setCenter,args:[C.center]}),re(x.zoom,C.zoom)||F.push({command:Li.setZoom,args:[C.zoom]}),re(x.bearing,C.bearing)||F.push({command:Li.setBearing,args:[C.bearing]}),re(x.pitch,C.pitch)||F.push({command:Li.setPitch,args:[C.pitch]}),re(x.sprite,C.sprite)||F.push({command:Li.setSprite,args:[C.sprite]}),re(x.glyphs,C.glyphs)||F.push({command:Li.setGlyphs,args:[C.glyphs]}),re(x.transition,C.transition)||F.push({command:Li.setTransition,args:[C.transition]}),re(x.light,C.light)||F.push({command:Li.setLight,args:[C.light]}),re(x.fog,C.fog)||F.push({command:Li.setFog,args:[C.fog]}),re(x.projection,C.projection)||F.push({command:Li.setProjection,args:[C.projection]});const G={},Q=[];!function(ke,ze,We,$e){let qe;for(qe in ze=ze||{},ke=ke||{})ke.hasOwnProperty(qe)&&(ze.hasOwnProperty(qe)||vr(qe,We,$e));for(qe in ze)ze.hasOwnProperty(qe)&&(ke.hasOwnProperty(qe)?re(ke[qe],ze[qe])||("geojson"===ke[qe].type&&"geojson"===ze[qe].type&&bl(ke,ze,qe)?We.push({command:Li.setGeoJSONSourceData,args:[qe,ze[qe].data]}):Pa(qe,ze,We,$e)):sr(qe,ze,We))}(x.sources,C.sources,Q,G);const fe=[];x.layers&&x.layers.forEach(ke=>{ke.source&&G[ke.source]?F.push({command:Li.removeLayer,args:[ke.id]}):fe.push(ke)});let pe=x.terrain;pe&&G[pe.source]&&(F.push({command:Li.setTerrain,args:[void 0]}),pe=void 0),F=F.concat(Q),re(pe,C.terrain)||F.push({command:Li.setTerrain,args:[C.terrain]}),function(ke,ze,We){ze=ze||[];const $e=(ke=ke||[]).map($t),qe=ze.map($t),Ue=ke.reduce(Ya,{}),He=ze.reduce(Ya,{}),Je=$e.slice(),Ye=Object.create(null);let rt,mt,pt,xt,Rt,kt,Ct;for(rt=0,mt=0;rt<$e.length;rt++)pt=$e[rt],He.hasOwnProperty(pt)?mt++:(We.push({command:Li.removeLayer,args:[pt]}),Je.splice(Je.indexOf(pt,mt),1));for(rt=0,mt=0;rt<qe.length;rt++)pt=qe[qe.length-1-rt],Je[Je.length-1-rt]!==pt&&(Ue.hasOwnProperty(pt)?(We.push({command:Li.removeLayer,args:[pt]}),Je.splice(Je.lastIndexOf(pt,Je.length-mt),1)):mt++,kt=Je[Je.length-rt],We.push({command:Li.addLayer,args:[He[pt],kt]}),Je.splice(Je.length-rt,0,pt),Ye[pt]=!0);for(rt=0;rt<qe.length;rt++)if(pt=qe[rt],xt=Ue[pt],Rt=He[pt],!Ye[pt]&&!re(xt,Rt))if(re(xt.source,Rt.source)&&re(xt["source-layer"],Rt["source-layer"])&&re(xt.type,Rt.type)){for(Ct in Ws(xt.layout,Rt.layout,We,pt,null,Li.setLayoutProperty),Ws(xt.paint,Rt.paint,We,pt,null,Li.setPaintProperty),re(xt.filter,Rt.filter)||We.push({command:Li.setFilter,args:[pt,Rt.filter]}),re(xt.minzoom,Rt.minzoom)&&re(xt.maxzoom,Rt.maxzoom)||We.push({command:Li.setLayerZoomRange,args:[pt,Rt.minzoom,Rt.maxzoom]}),xt)xt.hasOwnProperty(Ct)&&"layout"!==Ct&&"paint"!==Ct&&"filter"!==Ct&&"metadata"!==Ct&&"minzoom"!==Ct&&"maxzoom"!==Ct&&(0===Ct.indexOf("paint.")?Ws(xt[Ct],Rt[Ct],We,pt,Ct.slice(6),Li.setPaintProperty):re(xt[Ct],Rt[Ct])||We.push({command:Li.setLayerProperty,args:[pt,Ct,Rt[Ct]]}));for(Ct in Rt)Rt.hasOwnProperty(Ct)&&!xt.hasOwnProperty(Ct)&&"layout"!==Ct&&"paint"!==Ct&&"filter"!==Ct&&"metadata"!==Ct&&"minzoom"!==Ct&&"maxzoom"!==Ct&&(0===Ct.indexOf("paint.")?Ws(xt[Ct],Rt[Ct],We,pt,Ct.slice(6),Li.setPaintProperty):re(xt[Ct],Rt[Ct])||We.push({command:Li.setLayerProperty,args:[pt,Ct,Rt[Ct]]}))}else We.push({command:Li.removeLayer,args:[pt]}),kt=Je[Je.lastIndexOf(pt)+1],We.push({command:Li.addLayer,args:[Rt,kt]})}(fe,C.layers,F)}catch(G){console.warn("Unable to compute style diff:",G),F=[{command:Li.setStyle,args:[C]}]}return F}(this.serialize(),l).filter(x=>!(x.command in nc));if(0===d.length)return!1;const _=d.filter(x=>!(x.command in Mu));if(_.length>0)throw new Error(`Unimplemented: ${_.map(x=>x.command).join(", ")}.`);return d.forEach(x=>{"setTransition"!==x.command&&"setProjection"!==x.command&&this[x.command].apply(this,x.args)}),this.stylesheet=l,this._updateMapProjection(),!0}addImage(l,d){return this.getImage(l)?this.fire(new u.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(l,d),this._afterImageUpdated(l),this)}updateImage(l,d){this.imageManager.updateImage(l,d)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){return this.getImage(l)?(this.imageManager.removeImage(l),this._afterImageUpdated(l),this):this.fire(new u.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(l,d,_={}){if(this._checkLoaded(),void 0!==this.getSource(l))throw new Error("There is already a source with this ID");if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(u.validateSource,`sources.${l}`,d,null,_))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const x=Et(l,d,this.dispatcher,this);x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(l),source:x.serialize(),sourceId:l}));const C=F=>{const G=(F?"symbol:":"other:")+l,Q=this._sourceCaches[G]=new u.SourceCache(G,x,F);(F?this._symbolSourceCaches:this._otherSourceCaches)[l]=Q,Q.style=this,Q.onAdd(this.map)};C(!1),"vector"!==d.type&&"geojson"!==d.type||C(!0),x.onAdd&&x.onAdd(this.map),this._changed=!0}removeSource(l){this._checkLoaded();const d=this.getSource(l);if(!d)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===l)return this.fire(new u.ErrorEvent(new Error(`Source "${l}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.get().source===l)return this.fire(new u.ErrorEvent(new Error(`Source "${l}" cannot be removed while terrain is using it.`)));const _=this._getSourceCaches(l);for(const x of _)delete this._sourceCaches[x.id],delete this._updatedSources[x.id],x.fire(new u.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles();return delete this._otherSourceCaches[l],delete this._symbolSourceCaches[l],d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(l,d){this._checkLoaded(),this.getSource(l).setData(d),this._changed=!0}getSource(l){const d=this._getSourceCache(l);return d&&d.getSource()}_getSources(){const l=[];for(const d in this._otherSourceCaches){const _=this._getSourceCache(d);_&&l.push(_.getSource())}return l}addLayer(l,d,_={}){this._checkLoaded();const x=l.id;if(this.getLayer(x))return void this.fire(new u.ErrorEvent(new Error(`Layer with id "${x}" already exists on this map`)));let C;if("custom"===l.type){if(ic(this,u.validateCustomStyleLayer(l)))return;C=u.createStyleLayer(l)}else{if("object"==typeof l.source&&(this.addSource(x,l.source),l=u.clone$1(l),l=u.extend(l,{source:x})),this._validate(u.validateLayer,`layers.${x}`,l,{arrayIndex:-1},_))return;C=u.createStyleLayer(l),this._validateLayer(C),C.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[C.id]=C.serialize(),this._updateLayerCount(C,!0)}const F=d?this._order.indexOf(d):this._order.length;if(d&&-1===F)return void this.fire(new u.ErrorEvent(new Error(`Layer with id "${d}" does not exist on this map.`)));this._order.splice(F,0,x),this._layerOrderChanged=!0,this._layers[x]=C;const G=this._getLayerSourceCache(C);if(this._removedLayers[x]&&C.source&&G&&"custom"!==C.type){const Q=this._removedLayers[x];delete this._removedLayers[x],Q.type!==C.type?this._updatedSources[C.source]="clear":(this._updatedSources[C.source]="reload",G.pause())}this._updateLayer(C),C.onAdd&&C.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(l,d){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new u.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===d)return;const _=this._order.indexOf(l);this._order.splice(_,1);const x=d?this._order.indexOf(d):this._order.length;d&&-1===x?this.fire(new u.ErrorEvent(new Error(`Layer with id "${d}" does not exist on this map.`))):(this._order.splice(x,0,l),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(l){this._checkLoaded();const d=this._layers[l];if(!d)return void this.fire(new u.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be removed.`)));d.setEventedParent(null),this._updateLayerCount(d,!1);const _=this._order.indexOf(l);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=d,delete this._layers[l],delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],d.onRemove&&d.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(l){return this._layers[l]}hasLayer(l){return l in this._layers}hasLayerType(l){for(const d in this._layers)if(this._layers[d].type===l)return!0;return!1}setLayerZoomRange(l,d,_){this._checkLoaded();const x=this.getLayer(l);x?x.minzoom===d&&x.maxzoom===_||(null!=d&&(x.minzoom=d),null!=_&&(x.maxzoom=_),this._updateLayer(x)):this.fire(new u.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(l,d,_={}){this._checkLoaded();const x=this.getLayer(l);if(x){if(!re(x.filter,d))return null==d?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(u.validateFilter,`layers.${x.id}.filter`,d,{layerType:x.type},_)||(x.filter=u.clone$1(d),this._updateLayer(x)))}else this.fire(new u.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be filtered.`)))}getFilter(l){const d=this.getLayer(l);return d&&u.clone$1(d.filter)}setLayoutProperty(l,d,_,x={}){this._checkLoaded();const C=this.getLayer(l);C?re(C.getLayoutProperty(d),_)||(C.setLayoutProperty(d,_,x),this._updateLayer(C)):this.fire(new u.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(l,d){const _=this.getLayer(l);if(_)return _.getLayoutProperty(d);this.fire(new u.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style.`)))}setPaintProperty(l,d,_,x={}){this._checkLoaded();const C=this.getLayer(l);C?re(C.getPaintProperty(d),_)||(C.setPaintProperty(d,_,x)&&this._updateLayer(C),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new u.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(l,d){const _=this.getLayer(l);return _&&_.getPaintProperty(d)}setFeatureState(l,d){this._checkLoaded();const _=l.source,x=l.sourceLayer,C=this.getSource(_);if(!C)return void this.fire(new u.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const F=C.type;if("geojson"===F&&x)return void this.fire(new u.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===F&&!x)return void this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===l.id&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided.")));const G=this._getSourceCaches(_);for(const Q of G)Q.setFeatureState(x,l.id,d)}removeFeatureState(l,d){this._checkLoaded();const _=l.source,x=this.getSource(_);if(!x)return void this.fire(new u.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const C=x.type,F="vector"===C?l.sourceLayer:void 0;if("vector"===C&&!F)return void this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&"string"!=typeof l.id&&"number"!=typeof l.id)return void this.fire(new u.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const G=this._getSourceCaches(_);for(const Q of G)Q.removeFeatureState(F,l.id,d)}getFeatureState(l){this._checkLoaded();const d=l.source,_=l.sourceLayer,x=this.getSource(d);if(x){if("vector"!==x.type||_)return void 0===l.id&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(d)[0].getFeatureState(_,l.id);this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new u.ErrorEvent(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return u.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const l={};for(const d in this._sourceCaches){const _=this._sourceCaches[d].getSource();l[_.id]||(l[_.id]=_.serialize())}return u.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:l,layers:this._serializeLayers(this._order)},d=>void 0!==d)}_updateLayer(l){this._updatedLayers[l.id]=!0;const d=this._getLayerSourceCache(l);l.source&&!this._updatedSources[l.source]&&d&&"raster"!==d.getSource().type&&(this._updatedSources[l.source]="reload",d.pause()),this._changed=!0,l.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(l){const d=F=>"fill-extrusion"===this._layers[F].type,_={},x=[];for(let F=this._order.length-1;F>=0;F--){const G=this._order[F];if(d(G)){_[G]=F;for(const Q of l){const fe=Q[G];if(fe)for(const pe of fe)x.push(pe)}}}x.sort((F,G)=>G.intersectionZ-F.intersectionZ);const C=[];for(let F=this._order.length-1;F>=0;F--){const G=this._order[F];if(d(G))for(let Q=x.length-1;Q>=0;Q--){const fe=x[Q].feature;if(_[fe.layer.id]<F)break;C.push(fe),x.pop()}else for(const Q of l){const fe=Q[G];if(fe)for(const pe of fe)C.push(pe.feature)}}return C}queryRenderedFeatures(l,d,_){d&&d.filter&&this._validate(u.validateFilter,"queryRenderedFeatures.filter",d.filter,null,d);const x={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new u.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const Q of d.layers){const fe=this._layers[Q];if(!fe)return this.fire(new u.ErrorEvent(new Error(`The layer '${Q}' does not exist in the map's style and cannot be queried for features.`))),[];x[fe.source]=!0}}const C=[];d.availableImages=this._availableImages;const F=d&&d.layers?d.layers.some(Q=>{const fe=this.getLayer(Q);return fe&&fe.is3D()}):this.has3DLayers(),G=ue.createFromScreenPoints(l,_);for(const Q in this._sourceCaches){const fe=this._sourceCaches[Q].getSource().id;d.layers&&!x[fe]||C.push(Mt(this._sourceCaches[Q],this._layers,this._serializedLayers,G,d,_,F,!!this.map._showQueryGeometry))}return this.placement&&C.push(function(Q,fe,pe,ke,ze,We,$e){const qe={},Ue=We.queryRenderedSymbols(ke),He=[];for(const Je of Object.keys(Ue).map(Number))He.push($e[Je]);He.sort(gi);for(const Je of He){const Ye=Je.featureIndex.lookupSymbolFeatures(Ue[Je.bucketInstanceId],fe,Je.bucketIndex,Je.sourceLayerIndex,ze.filter,ze.layers,ze.availableImages,Q);for(const rt in Ye){const mt=qe[rt]=qe[rt]||[],pt=Ye[rt];pt.sort((xt,Rt)=>{const kt=Je.featureSortOrder;if(kt){const Ct=kt.indexOf(xt.featureIndex);return kt.indexOf(Rt.featureIndex)-Ct}return Rt.featureIndex-xt.featureIndex});for(const xt of pt)mt.push(xt)}}for(const Je in qe)qe[Je].forEach(Ye=>{const rt=Ye.feature,mt=pe(Q[Je]).getFeatureState(rt.layer["source-layer"],rt.id);rt.source=rt.layer.source,rt.layer["source-layer"]&&(rt.sourceLayer=rt.layer["source-layer"]),rt.state=mt});return qe}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),G.screenGeometry,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(C)}querySourceFeatures(l,d){d&&d.filter&&this._validate(u.validateFilter,"querySourceFeatures.filter",d.filter,null,d);const _=this._getSourceCaches(l);let x=[];for(const C of _)x=x.concat(Yt(C,d));return x}addSourceType(l,d,_){return co.getSourceType(l)?_(new Error(`A source type called "${l}" already exists.`)):(co.setSourceType(l,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:d.workerSourceURL},_):_(null,null))}getLight(){return this.light.getLight()}setLight(l,d={}){this._checkLoaded();const _=this.light.getLight();let x=!1;for(const F in l)if(!re(l[F],_[F])){x=!0;break}if(!x)return;const C=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(l,d),this.light.updateTransitions(C)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(l,d=1){if(this._checkLoaded(),!l)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(1===d){if("object"==typeof l.source){const _="terrain-dem-src";this.addSource(_,l.source),l=u.clone$1(l),l=u.extend(l,{source:_})}if(this._validate(u.validateTerrain,"terrain",l))return}if(!this.terrain||this.terrain&&d!==this.terrain.drapeRenderMode)this._createTerrain(l,d);else{const _=this.terrain,x=_.get();for(const C of Object.keys(u.spec.terrain))!l.hasOwnProperty(C)&&u.spec.terrain[C].default&&(l[C]=u.spec.terrain[C].default);for(const C in l)if(!re(l[C],x[C])){_.set(l),this.stylesheet.terrain=l;const F=this._setTransitionParameters({duration:0});_.updateTransitions(F);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(l){const d=this.fog=new M(l,this.map.transform);this.stylesheet.fog=l;const _=this._setTransitionParameters({duration:0});d.updateTransitions(_)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const l of this.map._markers)l._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(l){if(this._checkLoaded(),!l)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const d=this.fog,_=d.get();0===Object.keys(l).length&&d.set(l);for(const x in l)if(!re(l[x],_[x])){d.set(l),this.stylesheet.fog=l;const C=this._setTransitionParameters({duration:0});d.updateTransitions(C);break}}else this._createFog(l);this._markersNeedUpdate=!0}_setTransitionParameters(l){return{now:u.exported.now(),transition:u.extend(l,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const l=this._order.filter(_=>this.isLayerDraped(this._layers[_])),d=this._order.filter(_=>!this.isLayerDraped(this._layers[_]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...l),this._drapedFirstOrder.push(...d)}_createTerrain(l,d){const _=this.terrain=new A(l,d);this.stylesheet.terrain=l,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const x=this._setTransitionParameters({duration:0});_.updateTransitions(x)}_force3DLayerUpdate(){for(const l in this._layers){const d=this._layers[l];"fill-extrusion"===d.type&&this._updateLayer(d)}}_forceSymbolLayerUpdate(){for(const l in this._layers){const d=this._layers[l];"symbol"===d.type&&this._updateLayer(d)}}_validate(l,d,_,x,C={}){return(!C||!1!==C.validate)&&ic(this,l.call(u.validateStyle,u.extend({key:d,style:this.serialize(),value:_,styleSpec:u.spec},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),u.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this._sourceCaches)this._sourceCaches[l].clearTiles(),this._sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(l){const d=this._getSourceCaches(l);for(const _ of d)_.clearTiles()}_reloadSource(l){const d=this._getSourceCaches(l);for(const _ of d)_.resume(),_.reload()}_reloadSources(){for(const l of this._getSources())l.reload&&l.reload()}_updateSources(l){for(const d in this._sourceCaches)this._sourceCaches[d].update(l)}_generateCollisionBoxes(){for(const l in this._sourceCaches){const d=this._sourceCaches[l];d.resume(),d.reload()}}_updatePlacement(l,d,_,x,C=!1){let F=!1,G=!1;const Q={};for(const fe of this._order){const pe=this._layers[fe];if("symbol"!==pe.type)continue;if(!Q[pe.source]){const ze=this._getLayerSourceCache(pe);if(!ze)continue;Q[pe.source]=ze.getRenderableIds(!0).map(We=>ze.getTileByID(We)).sort((We,$e)=>$e.tileID.overscaledZ-We.tileID.overscaledZ||(We.tileID.isLessThan($e.tileID)?-1:1))}const ke=this.crossTileSymbolIndex.addLayer(pe,Q[pe.source],l.center.lng,l.projection);F=F||ke}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),C=C||this._layerOrderChanged||0===_,this._layerOrderChanged&&this.fire(new u.Event("neworder")),(C||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(u.exported.now(),l.zoom))&&(this.pauseablePlacement=new Ys(l,this._order,C,d,_,x,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Q),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(u.exported.now()),G=!0),F&&this.pauseablePlacement.placement.setStale()),G||F)for(const fe of this._order){const pe=this._layers[fe];"symbol"===pe.type&&this.placement.updateLayerOpacities(pe,Q[pe.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(u.exported.now())}_releaseSymbolFadeTiles(){for(const l in this._sourceCaches)this._sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,d,_){this.imageManager.getImages(d.icons,_),this._updateTilesForChangedImages();const x=C=>{C&&C.setDependencies(d.tileID.key,d.type,d.icons)};x(this._otherSourceCaches[d.source]),x(this._symbolSourceCaches[d.source])}getGlyphs(l,d,_){this.glyphManager.getGlyphs(d.stacks,_)}getResource(l,d,_){return u.makeRequest(d,_)}_getSourceCache(l){return this._otherSourceCaches[l]}_getLayerSourceCache(l){return"symbol"===l.type?this._symbolSourceCaches[l.source]:this._otherSourceCaches[l.source]}_getSourceCaches(l){const d=[];return this._otherSourceCaches[l]&&d.push(this._otherSourceCaches[l]),this._symbolSourceCaches[l]&&d.push(this._symbolSourceCaches[l]),d}_isSourceCacheLoaded(l){const d=this._getSourceCaches(l);return 0===d.length?(this.fire(new u.ErrorEvent(new Error(`There is no source with ID '${l}'`))),!1):d.every(_=>_.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}co.getSourceType=function(m){return Dt[m]},co.setSourceType=function(m,l){Dt[m]=l},co.registerForPluginStateChange=u.registerForPluginStateChange;var Su="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",Uo="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Xd="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Ig="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",ha="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Zs={},qd={};const Tu=[];Ks(Su,Tu),Ks(Xd,Tu),Ks(Ig,Tu),Ks(ha,Tu),Zs=Vi("",Xd),qd=Vi(ha,Ig);const Os=Vi("\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),wr=Su,Du="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var Mf={background:Vi("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Vi("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Vi("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Vi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Vi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Vi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Vi("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Vi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Vi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:Vi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Vi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Vi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Vi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Vi("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Vi("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Vi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Vi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Vi("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Vi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Vi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Vi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:Vi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:Vi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:Vi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:Vi("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Vi("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Uo),skyboxGradient:Vi("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Uo),skyboxCapture:Vi("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Vi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;\n#ifdef GLOBE_POLES\nvec3 up_vector=normalize(globe_pos)*u_tile_up_scale;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:Vi("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function Ks(m,l){const d=m.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let _ of d)if(_=_.trim(),"#"===_[0]&&_.includes("if")&&!_.includes("endif")){_=_.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=_.split(" ");for(const C of x)l.includes(C)||l.push(C)}}function Vi(m,l){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,_=l.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),x={},C=[...Tu];return Ks(m,C),Ks(l,C),{fragmentSource:m=m.replace(d,(F,G,Q,fe,pe)=>(x[pe]=!0,"define"===G?`\n#ifndef HAS_UNIFORM_u_${pe}\nvarying ${Q} ${fe} ${pe};\n#else\nuniform ${Q} ${fe} u_${pe};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${pe}\n    ${Q} ${fe} ${pe} = u_${pe};\n#endif\n`)),vertexSource:l=l.replace(d,(F,G,Q,fe,pe)=>{const ke="float"===fe?"vec2":"vec4",ze=pe.match(/color/)?"color":ke;return x[pe]?"define"===G?`\n#ifndef HAS_UNIFORM_u_${pe}\nuniform lowp float u_${pe}_t;\nattribute ${Q} ${ke} a_${pe};\nvarying ${Q} ${fe} ${pe};\n#else\nuniform ${Q} ${fe} u_${pe};\n#endif\n`:"vec4"===ze?`\n#ifndef HAS_UNIFORM_u_${pe}\n    ${pe} = a_${pe};\n#else\n    ${Q} ${fe} ${pe} = u_${pe};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${pe}\n    ${pe} = unpack_mix_${ze}(a_${pe}, u_${pe}_t);\n#else\n    ${Q} ${fe} ${pe} = u_${pe};\n#endif\n`:"define"===G?`\n#ifndef HAS_UNIFORM_u_${pe}\nuniform lowp float u_${pe}_t;\nattribute ${Q} ${ke} a_${pe};\n#else\nuniform ${Q} ${fe} u_${pe};\n#endif\n`:"vec4"===ze?`\n#ifndef HAS_UNIFORM_u_${pe}\n    ${Q} ${fe} ${pe} = a_${pe};\n#else\n    ${Q} ${fe} ${pe} = u_${pe};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${pe}\n    ${Q} ${fe} ${pe} = unpack_mix_${ze}(a_${pe}, u_${pe}_t);\n#else\n    ${Q} ${fe} ${pe} = u_${pe};\n#endif\n`}),staticAttributes:_,usedDefines:C}}class Dh{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(l,d,_,x,C,F,G){this.context=l;let Q=this.boundPaintVertexBuffers.length!==x.length;for(let pe=0;!Q&&pe<x.length;pe++)this.boundPaintVertexBuffers[pe]!==x[pe]&&(Q=!0);let fe=this.boundDynamicVertexBuffers.length!==G.length;for(let pe=0;!fe&&pe<G.length;pe++)this.boundDynamicVertexBuffers[pe]!==G[pe]&&(fe=!0);if(!l.extVertexArrayObject||!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==_||Q||fe||this.boundIndexBuffer!==C||this.boundVertexOffset!==F)this.freshBind(d,_,x,C,F,G);else{l.bindVertexArrayOES.set(this.vao);for(const pe of G)pe&&pe.bind();C&&C.dynamicDraw&&C.bind()}}freshBind(l,d,_,x,C,F){let G;const Q=l.numAttributes,fe=this.context,pe=fe.gl;if(fe.extVertexArrayObject)this.vao&&this.destroy(),this.vao=fe.extVertexArrayObject.createVertexArrayOES(),fe.bindVertexArrayOES.set(this.vao),G=0,this.boundProgram=l,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=x,this.boundVertexOffset=C,this.boundDynamicVertexBuffers=F;else{G=fe.currentNumAttributes||0;for(let ke=Q;ke<G;ke++)pe.disableVertexAttribArray(ke)}d.enableAttributes(pe,l),d.bind(),d.setVertexAttribPointers(pe,l,C);for(const ke of _)ke.enableAttributes(pe,l),ke.bind(),ke.setVertexAttribPointers(pe,l,C);for(const ke of F)ke&&(ke.enableAttributes(pe,l),ke.bind(),ke.setVertexAttribPointers(pe,l,C));x&&x.bind(),fe.currentNumAttributes=Q}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function rc(m,l){const d=Math.pow(2,l.canonical.z),_=l.canonical.y;return[new u.MercatorCoordinate(0,_/d).toLngLat().lat,new u.MercatorCoordinate(0,(_+1)/d).toLngLat().lat]}function Ah(m,l,d,_,x,C,F){const G=m.context,Q=G.gl,fe=d.fbo;if(!fe)return;m.prepareDrawTile();const pe=m.useProgram("hillshade");G.activeTexture.set(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_2D,fe.colorAttachment.get());const ke=((qe,Ue,He,Je)=>{const Ye=He.paint.get("hillshade-shadow-color"),rt=He.paint.get("hillshade-highlight-color"),mt=He.paint.get("hillshade-accent-color");let pt=He.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===He.paint.get("hillshade-illumination-anchor")&&(pt-=qe.transform.angle);const xt=!qe.options.moving;return{u_matrix:Je||qe.transform.calculateProjMatrix(Ue.tileID.toUnwrapped(),xt),u_image:0,u_latrange:rc(0,Ue.tileID),u_light:[He.paint.get("hillshade-exaggeration"),pt],u_shadow:Ye,u_highlight:rt,u_accent:mt}})(m,d,_,m.terrain?l.projMatrix:null);m.prepareDrawProgram(G,pe,l.toUnwrapped());const{tileBoundsBuffer:ze,tileBoundsIndexBuffer:We,tileBoundsSegments:$e}=m.getTileBoundsBuffers(d);pe.draw(G,Q.TRIANGLES,x,C,F,u.CullFaceMode.disabled,ke,_.id,ze,We,$e)}function oc(m,l,d){if(!l.needsDEMTextureUpload)return;const _=m.context,x=_.gl;_.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||m.getTileTexture(d.stride);const C=d.getPixels();l.demTexture?l.demTexture.update(C,{premultiply:!1}):l.demTexture=new u.Texture(_,C,x.RGBA,{premultiply:!1}),l.needsDEMTextureUpload=!1}function Qs(m,l,d,_,x,C){const F=m.context,G=F.gl;if(!l.dem)return;const Q=l.dem;if(F.activeTexture.set(G.TEXTURE1),oc(m,l,Q),!l.demTexture)return;l.demTexture.bind(G.NEAREST,G.CLAMP_TO_EDGE);const fe=Q.dim;F.activeTexture.set(G.TEXTURE0);let pe=l.fbo;if(!pe){const $e=new u.Texture(F,{width:fe,height:fe,data:null},G.RGBA);$e.bind(G.LINEAR,G.CLAMP_TO_EDGE),pe=l.fbo=F.createFramebuffer(fe,fe,!0),pe.colorAttachment.set($e.texture)}F.bindFramebuffer.set(pe.framebuffer),F.viewport.set([0,0,fe,fe]);const{tileBoundsBuffer:ke,tileBoundsIndexBuffer:ze,tileBoundsSegments:We}=m.getMercatorTileBoundsBuffers();m.useProgram("hillshadePrepare").draw(F,G.TRIANGLES,_,x,C,u.CullFaceMode.disabled,(($e,qe)=>{const Ue=qe.stride,He=u.create();return u.ortho(He,0,u.EXTENT,-u.EXTENT,0,0,1),u.translate(He,He,[0,-u.EXTENT,0]),{u_matrix:He,u_image:1,u_dimension:[Ue,Ue],u_zoom:$e.overscaledZ,u_unpack:qe.unpackVector}})(l.tileID,Q),d.id,ke,ze,We),l.needsHillshadePrepare=!1}const Za=m=>({u_matrix:new u.UniformMatrix4f(m),u_image0:new u.Uniform1i(m),u_skirt_height:new u.Uniform1f(m)}),Au=(m,l)=>({u_matrix:m,u_image0:0,u_skirt_height:l}),Cr=(m,l,d,_,x,C,F,G,Q,fe,pe,ke,ze,We)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:l,u_normalize_matrix:Float32Array.from(_),u_merc_matrix:d,u_zoom_transition:x,u_merc_center:C,u_image0:0,u_frustum_tl:F,u_frustum_tr:G,u_frustum_br:Q,u_frustum_bl:fe,u_globe_pos:pe,u_globe_radius:ke,u_viewport:ze,u_grid_matrix:We?Float32Array.from(We):new Float32Array(9)});function ku(m,l){return null!=m&&null!=l&&!(!m.hasData()||!l.hasData())&&null!=m.demTexture&&null!=l.demTexture&&m.tileID.key!==l.tileID.key}const Sl=new class{constructor(){this.operations={}}newMorphing(m,l,d,_,x){if(m in this.operations){const C=this.operations[m];C.to.tileID.key!==d.tileID.key&&(C.queued=d)}else this.operations[m]={startTime:_,phase:0,duration:x,from:l,to:d,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const l=this.operations[m];return{from:l.from,to:l.to,phase:l.phase}}update(m){for(const l in this.operations){const d=this.operations[l];for(d.phase=(m-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,m)){delete this.operations[l];break}}}_nextOp(m,l){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=l,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},sc={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function mn(m,l){const d=1<<m.z;return!l&&(0===m.x||m.x===d-1)||0===m.y||m.y===d-1}const kh=m=>({u_matrix:m});function Ih(m,l,d,_,x){if(x>0){const C=u.exported.now(),F=(C-m.timeAdded)/x,G=l?(C-l.timeAdded)/x:-1,Q=d.getSource(),fe=_.coveringZoomLevel({tileSize:Q.tileSize,roundZoom:Q.roundZoom}),pe=!l||Math.abs(l.tileID.overscaledZ-fe)>Math.abs(m.tileID.overscaledZ-fe),ke=pe&&m.refreshedUponExpiration?1:u.clamp(pe?F:1-G,0,1);return m.refreshedUponExpiration&&F>=1&&(m.refreshedUponExpiration=!1),l?{opacity:1,mix:1-ke}:{opacity:ke,mix:0}}return{opacity:1,mix:0}}class ci extends u.SourceCache{constructor(l){const d={type:"raster-dem",maxzoom:l.transform.maxZoom},_=new Z(Yi(),null),x=Et("mock-dem",d,_,l.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(l,d){l.state="loaded",d(null)}}class To extends u.SourceCache{constructor(l){const d=Et("proxy",{type:"geojson",maxzoom:l.transform.maxZoom},new Z(Yi(),null),l.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=l,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(l,d,_){if(l.freezeTileCoverage)return;this.transform=l;const x=l.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((C,F)=>{if(C[F.key]="",!this._tiles[F.key]){const G=new u.Tile(F,this._source.tileSize*F.overscaleFactor(),l.tileZoom);G.state="loaded",this._tiles[F.key]=G}return C},{});for(const C in this._tiles)C in x||(this.freeFBO(C),this._tiles[C].unloadVectorData(),delete this._tiles[C])}freeFBO(l){const d=this.proxyCachedFBO[l];if(void 0!==d){const _=Object.values(d);this.renderCachePool.push(..._),delete this.proxyCachedFBO[l]}}deallocRenderCache(){this.renderCache.forEach(l=>l.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ar extends u.OverscaledTileID{constructor(l,d,_){super(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y),this.proxyTileKey=d,this.projMatrix=_}}class Ho extends u.Elevation{constructor(l,d){super(),this.painter=l,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[_,x,C]=function(Q){const fe=new u.StructArrayLayout4i8,pe=new u.StructArrayLayout3ui6;fe.reserve(17161),pe.reserve(33800);const ze=u.EXTENT/128,We=u.EXTENT+ze/2,$e=We+ze;for(let Ue=-ze;Ue<$e;Ue+=ze)for(let He=-ze;He<$e;He+=ze){const Je=He<0||He>We||Ue<0||Ue>We?24575:0,Ye=u.clamp(Math.round(He),0,u.EXTENT),rt=u.clamp(Math.round(Ue),0,u.EXTENT);fe.emplaceBack(Ye+Je,rt,Ye,rt)}const qe=(Ue,He)=>{const Je=131*He+Ue;pe.emplaceBack(Je+1,Je,Je+131),pe.emplaceBack(Je+131,Je+131+1,Je+1)};for(let Ue=1;Ue<129;Ue++)for(let He=1;He<129;He++)qe(He,Ue);return[0,129].forEach(Ue=>{for(let He=0;He<130;He++)qe(He,Ue),qe(Ue,He)}),[fe,pe,32768]}(),F=l.context;this.gridBuffer=F.createVertexBuffer(_,u.boundsAttributes.members),this.gridIndexBuffer=F.createIndexBuffer(x),this.gridSegments=u.SegmentVector.simpleSegment(0,0,_.length,x.length),this.gridNoSkirtSegments=u.SegmentVector.simpleSegment(0,0,_.length,C),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new To(d.map),this.orthoMatrix=u.create(),u.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,u.EXTENT,0,u.EXTENT,0,1);const G=F.gl;this._overlapStencilMode=new u.StencilMode({func:G.GEQUAL,mask:255},0,255,G.KEEP,G.KEEP,G.REPLACE),this._previousZoom=l.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ci(d.map)}set style(l){l.on("data",this._onStyleDataEvent.bind(this)),l.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=l,this._checkRenderCacheEfficiency()}update(l,d,_){if(l&&l.terrain){this._style!==l&&(this.style=l),this.enabled=!0;const x=l.terrain.properties;this.sourceCache=0===l.terrain.drapeRenderMode?this._mockSourceCache:l._getSourceCache(x.get("source")),this._exaggeration=x.get("exaggeration");const C=()=>{this.sourceCache.used&&u.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const F=this.getScaledDemTileSize();this.sourceCache.update(d,F,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,C(),this._initializing=!0),C(),d.updateElevation(!0,_),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(l){this._findCoveringTileCache[l]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const l=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==l.efficiency&&u.warnOnce(`Terrain render cache efficiency is not optimal (${l.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${l.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(l){l.coord&&"source"===l.dataType?this._clearRenderCacheForTile(l.sourceCacheId,l.coord):"style"===l.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const l in this._style._sourceCaches)this._style._sourceCaches[l].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(l=>l.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const l=2*this.proxySourceCache.getSource().tileSize;return[l,l]}set useVertexMorphing(l){this._useVertexMorphing=l}updateTileBinding(l){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const d=this.proxySourceCache,_=this.painter.transform;this._initializing&&(this._initializing=0===_._centerAltitude&&-1===this.getAtPointOrZero(u.MercatorCoordinate.fromLngLat(_.center),-1),this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=d.getIds().map(Q=>{const fe=d.getTileByID(Q).tileID;return fe.projMatrix=_.calculateProjMatrix(fe.toUnwrapped()),fe});(function(Q,fe){const pe=fe.transform.pointCoordinate(fe.transform.getCameraPoint()),ke=new u.pointGeometry(pe.x,pe.y);Q.sort((ze,We)=>{if(We.overscaledZ-ze.overscaledZ)return We.overscaledZ-ze.overscaledZ;const $e=new u.pointGeometry(ze.canonical.x+(1<<ze.canonical.z)*ze.wrap,ze.canonical.y),qe=new u.pointGeometry(We.canonical.x+(1<<We.canonical.z)*We.wrap,We.canonical.y),Ue=ke.mult(1<<ze.canonical.z);return Ue.x-=.5,Ue.y-=.5,Ue.distSqr($e)-Ue.distSqr(qe)})})(x,this.painter),this._previousZoom=_.zoom;const C=this.proxyToSource||{};this.proxyToSource={},x.forEach(Q=>{this.proxyToSource[Q.key]={}}),this.terrainTileForTile={};const F=this._style._sourceCaches;for(const Q in F){const fe=F[Q];if(!fe.used||(fe!==this.sourceCache&&this.resetTileLookupCache(fe.id),this._setupProxiedCoordsForOrtho(fe,l[Q],C),fe.usedForTerrain))continue;const pe=l[Q];fe.getSource().reparseOverscaled&&this._assignTerrainTiles(pe)}this.proxiedCoords[d.id]=x.map(Q=>new ar(Q,Q.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(C),this.renderingToTexture=!1,this._updateTimestamp=u.exported.now();const G={};this._visibleDemTiles=[];for(const Q of this.proxyCoords){const fe=this.terrainTileForTile[Q.key];if(!fe)continue;const pe=fe.tileID.key;pe in G||(this._visibleDemTiles.push(fe),G[pe]=pe)}}_assignTerrainTiles(l){this._initializing||l.forEach(d=>{if(this.terrainTileForTile[d.key])return;const _=this._findTileCoveringTileID(d,this.sourceCache);_&&(this.terrainTileForTile[d.key]=_)})}_prepareDEMTextures(){const l=this.painter.context,d=l.gl;for(const _ in this.terrainTileForTile){const x=this.terrainTileForTile[_],C=x.dem;!C||x.demTexture&&!x.needsDEMTextureUpload||(l.activeTexture.set(d.TEXTURE1),oc(this.painter,x,C))}}_prepareDemTileUniforms(l,d,_,x){if(!d||null==d.demTexture)return!1;const C=l.tileID.canonical,F=Math.pow(2,d.tileID.canonical.z-C.z),G=x||"";return _[`u_dem_tl${G}`]=[C.x*F%1,C.y*F%1],_[`u_dem_scale${G}`]=F,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const l=this.painter.context,d=l.gl;if(!this._emptyDepthBufferTexture){const _=new u.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new u.Texture(l,_,d.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let l=0;const d=this._visibleDemTiles.reduce((_,x)=>{if(!x.dem)return _;const C=x.dem.tree.minimums[0];return C>0&&l++,_+C},0);return l?d/l:0}_updateEmptyDEMTexture(){const l=this.painter.context,d=l.gl;l.activeTexture.set(d.TEXTURE2);const _=this._getLoadedAreaMinimum(),x=new u.RGBAImage({width:1,height:1},new Uint8Array(u.DEMData.pack(_,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let C=this._emptyDEMTexture;return C?C.update(x,{premultiply:!1}):C=this._emptyDEMTexture=new u.Texture(l,x,d.RGBA,{premultiply:!1}),C}setupElevationDraw(l,d,_){const x=this.painter.context,C=x.gl,F=(G=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:u.DEMData.getUnpackVector(G),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var G;F.u_dem_size=this.sourceCache.getSource().tileSize,F.u_exaggeration=this.exaggeration();let Q=null,fe=null,pe=1;if(_&&_.morphing&&this._useVertexMorphing){const ke=_.morphing.srcDemTile,ze=_.morphing.dstDemTile;pe=_.morphing.phase,ke&&ze&&(this._prepareDemTileUniforms(l,ke,F,"_prev")&&(fe=ke),this._prepareDemTileUniforms(l,ze,F)&&(Q=ze))}if(fe&&Q?(x.activeTexture.set(C.TEXTURE2),Q.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),x.activeTexture.set(C.TEXTURE4),fe.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),F.u_dem_lerp=pe):(Q=this.terrainTileForTile[l.tileID.key],x.activeTexture.set(C.TEXTURE2),(this._prepareDemTileUniforms(l,Q,F)?Q.demTexture:this.emptyDEMTexture).bind(C.NEAREST,C.CLAMP_TO_EDGE)),x.activeTexture.set(C.TEXTURE3),_&&_.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),this._depthFBO&&(F.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),F.u_depth_size_inv=[1,1]),_&&_.useMeterToDem&&Q){const ke=(1<<Q.tileID.canonical.z)*u.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;F.u_meter_to_dem=ke}if(_&&_.labelPlaneMatrixInv&&(F.u_label_plane_matrix_inv=_.labelPlaneMatrixInv),d.setTerrainUniformValues(x,F),"globe"===this.painter.transform.projection.name){const ke=this.globeUniformValues(this.painter.transform,l.tileID.canonical,_&&_.useDenormalizedUpVectorScale);d.setGlobeUniformValues(x,ke)}}globeUniformValues(l,d,_){const x=l.projection;return{u_tile_tl_up:x.upVector(d,0,0),u_tile_tr_up:x.upVector(d,u.EXTENT,0),u_tile_br_up:x.upVector(d,u.EXTENT,u.EXTENT),u_tile_bl_up:x.upVector(d,0,u.EXTENT),u_tile_up_scale:_?u.GLOBE_METERS_TO_ECEF:x.upVectorScale(d,l.center.lat,l.worldSize).metersToTile}}renderToBackBuffer(l){const d=this.painter,_=this.painter.context;0!==l.length&&(_.bindFramebuffer.set(null),_.viewport.set([0,0,d.width,d.height]),d.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,C,F,G,Q){if("globe"===x.transform.projection.name)!function(fe,pe,ke,ze,We){const $e=fe.context,qe=$e.gl;let Ue,He;const Je=fe.options.showTerrainWireframe?2:0,Ye=fe.transform,rt=u.globeUseCustomAntiAliasing(fe,$e,Ye),mt=(ei,zt)=>{if(He===ei)return;const Zt=[sc[ei],"PROJECTION_GLOBE_VIEW"];rt&&Zt.push("CUSTOM_ANTIALIASING"),zt&&Zt.push(sc[Je]),Ue=fe.useProgram("globeRaster",null,Zt),He=ei},pt=fe.colorModeForRenderPass(),xt=new u.DepthMode(qe.LEQUAL,u.DepthMode.ReadWrite,fe.depthRangeFor3D);Sl.update(We);const Rt=u.calculateGlobeMercatorMatrix(Ye),kt=[u.mercatorXfromLng(Ye.center.lng),u.mercatorYfromLat(Ye.center.lat)],Ct=Je?[!1,!0]:[!1],si=fe.globeSharedBuffers,At=[Ye.width*u.exported.devicePixelRatio,Ye.height*u.exported.devicePixelRatio],Ht=Float32Array.from(Ye.globeMatrix),Ft={useDenormalizedUpVectorScale:!0};if(Ct.forEach(ei=>{He=-1;const zt=ei?qe.LINES:qe.TRIANGLES;for(const Zt of ze){const li=ke.getTile(Zt),St=u.StencilMode.disabled,Lt=pe.prevTerrainTileForTile[Zt.key],Ti=pe.terrainTileForTile[Zt.key];ku(Lt,Ti)&&Sl.newMorphing(Zt.key,Lt,Ti,We,250),$e.activeTexture.set(qe.TEXTURE0),li.texture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE);const ki=Sl.getMorphValuesForProxy(Zt.key),Di=ki?1:0;ki&&u.extend$1(Ft,{morphing:{srcDemTile:ki.from,dstDemTile:ki.to,phase:u.easeCubicInOut(ki.phase)}});const Ui=u.tileCornersToBounds(Zt.canonical),cn=u.getLatitudinalLod(Ui.getCenter().lat),Fi=u.getGridMatrix(Zt.canonical,Ui,cn,Ye.worldSize/Ye._pixelsPerMercatorPixel),Ci=u.globeNormalizeECEF(u.globeTileBounds(Zt.canonical)),jn=Cr(Ye.projMatrix,Ht,Rt,Ci,u.globeToMercatorTransition(Ye.zoom),kt,Ye.frustumCorners.TL,Ye.frustumCorners.TR,Ye.frustumCorners.BR,Ye.frustumCorners.BL,Ye.globeCenterInViewSpace,Ye.globeRadius,At,Fi);if(mt(Di,ei),pe.setupElevationDraw(li,Ue,Ft),fe.prepareDrawProgram($e,Ue,Zt.toUnwrapped()),si){const[Un,cr,tr]=ei?si.getWirefameBuffers(fe.context,cn):si.getGridBuffers(cn);Ue.draw($e,zt,xt,St,pt,u.CullFaceMode.backCCW,jn,"globe_raster",Un,cr,tr)}}}),si){const ei=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];rt&&ei.push("CUSTOM_ANTIALIASING"),Ue=fe.useProgram("globeRaster",null,ei);for(const zt of ze){const{x:Zt,y:li,z:St}=zt.canonical,Lt=0===li,Ti=li===(1<<St)-1,[ki,Di,Ui,cn]=si.getPoleBuffers(St);if(cn&&(Lt||Ti)){const Fi=ke.getTile(zt);$e.activeTexture.set(qe.TEXTURE0),Fi.texture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE);let Ci=u.globePoleMatrixForTile(St,Zt,Ye);const jn=u.globeNormalizeECEF(u.globeTileBounds(zt.canonical)),Un=(cr,tr)=>cr.draw($e,qe.TRIANGLES,xt,u.StencilMode.disabled,pt,u.CullFaceMode.disabled,Cr(Ye.projMatrix,Ci,Ci,jn,0,kt,Ye.frustumCorners.TL,Ye.frustumCorners.TR,Ye.frustumCorners.BR,Ye.frustumCorners.BL,Ye.globeCenterInViewSpace,Ye.globeRadius,At),"globe_pole_raster",tr,Ui,cn);pe.setupElevationDraw(Fi,Ue,Ft),fe.prepareDrawProgram($e,Ue,zt.toUnwrapped()),Lt&&Un(Ue,ki),Ti&&(Ci=u.scale(u.create(),Ci,[1,-1,1]),Un(Ue,Di))}}}}(x,C,F,G,Q);else{const fe=x.context,pe=fe.gl;let ke,ze;const We=x.options.showTerrainWireframe?2:0,$e=(Ye,rt)=>{if(ze===Ye)return;const mt=[sc[Ye]];rt&&mt.push(sc[We]),ke=x.useProgram("terrainRaster",null,mt),ze=Ye},qe=x.colorModeForRenderPass(),Ue=new u.DepthMode(pe.LEQUAL,u.DepthMode.ReadWrite,x.depthRangeFor3D);Sl.update(Q);const He=x.transform,Je=6*Math.pow(1.5,22-He.zoom)*C.exaggeration();(We?[!1,!0]:[!1]).forEach(Ye=>{ze=-1;const rt=Ye?pe.LINES:pe.TRIANGLES,[mt,pt]=Ye?C.getWirefameBuffer():[C.gridIndexBuffer,C.gridSegments];for(const xt of G){const Rt=F.getTile(xt),kt=u.StencilMode.disabled,Ct=C.prevTerrainTileForTile[xt.key],si=C.terrainTileForTile[xt.key];ku(Ct,si)&&Sl.newMorphing(xt.key,Ct,si,Q,250),fe.activeTexture.set(pe.TEXTURE0),Rt.texture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE,pe.LINEAR_MIPMAP_NEAREST);const At=Sl.getMorphValuesForProxy(xt.key),Ht=At?1:0;let Ft;At&&(Ft={morphing:{srcDemTile:At.from,dstDemTile:At.to,phase:u.easeCubicInOut(At.phase)}});const ei=Au(xt.projMatrix,mn(xt.canonical,He.renderWorldCopies)?Je/10:Je);$e(Ht,Ye),C.setupElevationDraw(Rt,ke,Ft),x.prepareDrawProgram(fe,ke,xt.toUnwrapped()),ke.draw(fe,rt,Ue,kt,qe,u.CullFaceMode.backCCW,ei,"terrain_raster",C.gridBuffer,mt,pt)}})}}(d,this,this.proxySourceCache,l,this._updateTimestamp),this.renderingToTexture=!0,d.gpuTimingDeferredRenderEnd(),l.splice(0,l.length))}renderBatch(l){if(0===this._drapedRenderBatches.length)return l+1;this.renderingToTexture=!0;const d=this.painter,_=this.painter.context,x=this.proxySourceCache,C=this.proxiedCoords[x.id],F=this._drapedRenderBatches.shift(),G=[],Q=d.style.order;let fe=0;for(const pe of C){const ke=x.getTileByID(pe.proxyTileKey),ze=x.proxyCachedFBO[pe.key]?x.proxyCachedFBO[pe.key][l]:void 0,We=void 0!==ze?x.renderCache[ze]:this.pool[fe++],$e=void 0!==ze;if(ke.texture=We.tex,$e&&!We.dirty){G.push(ke.tileID);continue}let qe;_.bindFramebuffer.set(We.fb.framebuffer),this.renderedToTile=!1,We.dirty&&(_.clear({color:u.Color.transparent,stencil:0}),We.dirty=!1);for(let Ue=F.start;Ue<=F.end;++Ue){const He=d.style._layers[Q[Ue]];if(He.isHidden(d.transform.zoom))continue;const Je=d.style._getLayerSourceCache(He),Ye=Je?this.proxyToSource[pe.key][Je.id]:[pe];if(!Ye)continue;const rt=Ye;_.viewport.set([0,0,We.fb.width,We.fb.height]),qe!==(Je?Je.id:null)&&(this._setupStencil(We,Ye,He,Je),qe=Je?Je.id:null),d.renderLayer(d,Je,He,rt)}this.renderedToTile?(We.dirty=!0,G.push(ke.tileID)):$e||--fe,5===fe&&(fe=0,this.renderToBackBuffer(G))}return this.renderToBackBuffer(G),this.renderingToTexture=!1,_.bindFramebuffer.set(null),_.viewport.set([0,0,d.width,d.height]),F.end+1}postRender(){}renderCacheEfficiency(l){const d=l.order.length;if(0===d)return{efficiency:100};let _,x=0,C=0,F=!1;for(let G=0;G<d;++G){const Q=l._layers[l.order[G]];this._style.isLayerDraped(Q)?(F&&++x,++C):F||(F=!0,_=Q.id)}return 0===C?{efficiency:100}:{efficiency:100*(1-x/C),firstUndrapedLayer:_}}getMinElevationBelowMSL(){let l=0;return this._visibleDemTiles.filter(d=>d.dem).forEach(d=>{l=Math.min(l,d.dem.tree.minimums[0])}),0===l?l:(l-30)*this._exaggeration}raycast(l,d,_){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(C=>C.dem).map(C=>{const F=C.tileID,G=1<<F.overscaledZ,{x:Q,y:fe}=F.canonical,pe=Q/G,ke=(Q+1)/G,ze=fe/G,We=(fe+1)/G;return{minx:pe,miny:ze,maxx:ke,maxy:We,t:C.dem.tree.raycastRoot(pe,ze,ke,We,l,d,_),tile:C}});x.sort((C,F)=>(null!==C.t?C.t:Number.MAX_VALUE)-(null!==F.t?F.t:Number.MAX_VALUE));for(const C of x){if(null==C.t)return null;const F=C.tile.dem.tree.raycast(C.minx,C.miny,C.maxx,C.maxy,l,d,_);if(null!=F)return F}return null}_createFBO(){const l=this.painter.context,d=l.gl,_=this.drapeBufferSize;l.activeTexture.set(d.TEXTURE0);const x=new u.Texture(l,{width:_[0],height:_[1],data:null},d.RGBA);x.bind(d.LINEAR,d.CLAMP_TO_EDGE);const C=l.createFramebuffer(_[0],_[1],!1);return C.colorAttachment.set(x.texture),C.depthAttachment=new _o(l,C.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=l.createRenderbuffer(l.gl.DEPTH_STENCIL,_[0],_[1]),this._stencilRef=0,C.depthAttachment.set(this._sharedDepthStencil),l.clear({stencil:0})):C.depthAttachment.set(this._sharedDepthStencil),l.extTextureFilterAnisotropic&&!l.extTextureFilterAnisotropicForceOff&&d.texParameterf(d.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax),{fb:C,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const l in this._style._sourceCaches)if(this._style._sourceCaches[l].hasTransition())return!0;return this._style.order.some(l=>{const d=this._style._layers[l],_=d.isHidden(this.painter.transform.zoom);return"custom"!==d.type&&!_&&d.hasTransition()})}_clearRasterFadeFromRenderCache(){let l=!1;for(const d in this._style._sourceCaches)if(this._style._sourceCaches[d]._source instanceof Fe){l=!0;break}if(l)for(let d=0;d<this._style.order.length;++d){const _=this._style._layers[this._style.order[d]],x=_.isHidden(this.painter.transform.zoom),C=this._style._getLayerSourceCache(_);if("raster"!==_.type||x||!C)continue;const F=_.paint.get("raster-fade-duration");for(const G of this.proxyCoords){const Q=this.proxyToSource[G.key][C.id];if(Q)for(const fe of Q){const pe=Ih(C.getTile(fe),C.findLoadedParent(fe,0),C,this.painter.transform,F);(1!==pe.opacity||0!==pe.mix)&&this._clearRenderCacheForTile(C.id,fe)}}}}_setupDrapedRenderBatches(){const l=this._style.order,d=l.length;if(0===d)return;const _=[];let x,C=0,F=this._style._layers[l[C]];for(;!this._style.isLayerDraped(F)&&F.isHidden(this.painter.transform.zoom)&&++C<d;)F=this._style._layers[l[C]];for(;C<d;++C){const G=this._style._layers[l[C]];G.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(G)?void 0===x&&(x=C):void 0!==x&&(_.push({start:x,end:C-1}),x=void 0))}void 0!==x&&_.push({start:x,end:C-1}),this._drapedRenderBatches=_}_setupRenderCache(l){const d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){const F=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let G=0;G<F.length;++G){const Q=Object.values(F[G]);d.renderCachePool.push(...Q)}}return}this._clearRasterFadeFromRenderCache();const _=this.proxyCoords,x=this._tilesDirty;for(let F=_.length-1;F>=0;F--){const G=_[F];if(d.getTileByID(G.key),void 0!==d.proxyCachedFBO[G.key]){const Q=l[G.key],fe=this.proxyToSource[G.key];let pe=0;for(const ke in fe){const ze=fe[ke],We=Q[ke];if(!We||We.length!==ze.length||ze.some(($e,qe)=>$e!==We[qe]||x[ke]&&x[ke].hasOwnProperty($e.key))){pe=-1;break}++pe}for(const ke in d.proxyCachedFBO[G.key])d.renderCache[d.proxyCachedFBO[G.key][ke]].dirty=pe<0||pe!==Object.values(Q).length}}const C=[...this._drapedRenderBatches];C.sort((F,G)=>G.end-G.start-(F.end-F.start));for(const F of C)for(const G of _){if(d.proxyCachedFBO[G.key])continue;let Q=d.renderCachePool.pop();void 0===Q&&d.renderCache.length<50&&(Q=d.renderCache.length,d.renderCache.push(this._createFBO())),void 0!==Q&&(d.proxyCachedFBO[G.key]={},d.proxyCachedFBO[G.key][F.start]=Q,d.renderCache[Q].dirty=!0)}this._tilesDirty={}}_setupStencil(l,d,_,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const C=this.painter.context,F=C.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let G;if(_.isTileClipped())G=d.length,this._overlapStencilMode.test={func:F.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);G=1,this._overlapStencilMode.test={func:F.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+G>255&&(C.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=G,this._overlapStencilMode.ref=this._stencilRef,_.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(l){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[l.key]),this._overlapStencilMode):u.StencilMode.disabled}_renderTileClippingMasks(l,d){const _=this.painter,x=this.painter.context,C=x.gl;_._tileClippingMaskIDs={},x.setColorMode(u.ColorMode.disabled),x.setDepthMode(u.DepthMode.disabled);const F=_.useProgram("clippingMask");for(const G of l){const Q=_._tileClippingMaskIDs[G.key]=--d;F.draw(x,C.TRIANGLES,u.DepthMode.disabled,new u.StencilMode({func:C.ALWAYS,mask:0},Q,255,C.KEEP,C.KEEP,C.REPLACE),u.ColorMode.disabled,u.CullFaceMode.disabled,kh(G.projMatrix),"$clipping",_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}pointCoordinate(l){const d=this.painter.transform;if(l.x<0||l.x>d.width||l.y<0||l.y>d.height)return null;const _=[l.x,l.y,1,1];u.transformMat4$1(_,_,d.pixelMatrixInverse),u.scale$1(_,_,1/_[3]),_[0]/=d.worldSize,_[1]/=d.worldSize;const x=d._camera.position,C=u.mercatorZfromAltitude(1,d.center.lat),F=[x[0],x[1],x[2]/C,0],G=u.subtract([],_.slice(0,3),F);u.normalize(G,G);const Q=this.raycast(F,G,this._exaggeration);return null!==Q&&Q?(u.scaleAndAdd(F,F,G,Q),F[3]=F[2],F[2]*=C,F):null}drawDepth(){const l=this.painter,d=l.context,_=this.proxySourceCache,x=Math.ceil(l.width),C=Math.ceil(l.height);if(!this._depthFBO||this._depthFBO.width===x&&this._depthFBO.height===C||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const F=d.gl,G=d.createFramebuffer(x,C,!0);d.activeTexture.set(F.TEXTURE0);const Q=new u.Texture(d,{width:x,height:C,data:null},F.RGBA);Q.bind(F.NEAREST,F.CLAMP_TO_EDGE),G.colorAttachment.set(Q.texture);const fe=d.createRenderbuffer(d.gl.DEPTH_COMPONENT16,x,C);G.depthAttachment.set(fe),this._depthFBO=G,this._depthTexture=Q}d.bindFramebuffer.set(this._depthFBO.framebuffer),d.viewport.set([0,0,x,C]),function(F,G,Q,fe){if("globe"===F.transform.projection.name)return;const pe=F.context,ke=pe.gl;pe.clear({depth:1});const ze=F.useProgram("terrainDepth"),We=new u.DepthMode(ke.LESS,u.DepthMode.ReadWrite,F.depthRangeFor3D);for(const $e of fe){const qe=Q.getTile($e),Ue=Au($e.projMatrix,0);G.setupElevationDraw(qe,ze),ze.draw(pe,ke.TRIANGLES,We,u.StencilMode.disabled,u.ColorMode.unblended,u.CullFaceMode.backCCW,Ue,"terrain_depth",G.gridBuffer,G.gridIndexBuffer,G.gridNoSkirtSegments)}}(l,this,_,this.proxyCoords)}_setupProxiedCoordsForOrtho(l,d,_){if(l.getSource()instanceof gt)return this._setupProxiedCoordsForImageSource(l,d,_);this._findCoveringTileCache[l.id]=this._findCoveringTileCache[l.id]||{};const x=this.proxiedCoords[l.id]=[],C=this.proxyCoords;for(let G=0;G<C.length;G++){const Q=C[G],fe=this._findTileCoveringTileID(Q,l);if(fe){const pe=this._createProxiedId(Q,fe,_[Q.key]&&_[Q.key][l.id]);x.push(pe),this.proxyToSource[Q.key][l.id]=[pe]}}let F=!1;for(let G=0;G<d.length;G++){const Q=l.getTile(d[G]);if(!Q||!Q.hasData())continue;const fe=this._findTileCoveringTileID(Q.tileID,this.proxySourceCache);if(fe&&fe.tileID.canonical.z!==Q.tileID.canonical.z){const pe=this.proxyToSource[fe.tileID.key][l.id],ke=this._createProxiedId(fe.tileID,Q,_[fe.tileID.key]&&_[fe.tileID.key][l.id]);pe?pe.splice(pe.length-1,0,ke):this.proxyToSource[fe.tileID.key][l.id]=[ke],x.push(ke),F=!0}}this._sourceTilesOverlap[l.id]=F}_setupProxiedCoordsForImageSource(l,d,_){if(!l.getSource().loaded())return;const x=this.proxiedCoords[l.id]=[],C=this.proxyCoords,F=l.getSource(),G=new u.pointGeometry(F.tileID.x,F.tileID.y)._div(1<<F.tileID.z),Q=F.coordinates.map(u.MercatorCoordinate.fromLngLat).reduce((pe,ke)=>(pe.min.x=Math.min(pe.min.x,ke.x-G.x),pe.min.y=Math.min(pe.min.y,ke.y-G.y),pe.max.x=Math.max(pe.max.x,ke.x-G.x),pe.max.y=Math.max(pe.max.y,ke.y-G.y),pe),{min:new u.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new u.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),fe=(pe,ke)=>{const ze=pe.wrap+pe.canonical.x/(1<<pe.canonical.z),We=pe.canonical.y/(1<<pe.canonical.z),$e=u.EXTENT/(1<<pe.canonical.z),qe=ke.wrap+ke.canonical.x/(1<<ke.canonical.z),Ue=ke.canonical.y/(1<<ke.canonical.z);return ze+$e<qe+Q.min.x||ze>qe+Q.max.x||We+$e<Ue+Q.min.y||We>Ue+Q.max.y};for(let pe=0;pe<C.length;pe++){const ke=C[pe];for(let ze=0;ze<d.length;ze++){const We=l.getTile(d[ze]);if(!We||!We.hasData()||fe(ke,We.tileID))continue;const $e=this._createProxiedId(ke,We,_[ke.key]&&_[ke.key][l.id]),qe=this.proxyToSource[ke.key][l.id];qe?qe.push($e):this.proxyToSource[ke.key][l.id]=[$e],x.push($e)}}}_createProxiedId(l,d,_){let x=this.orthoMatrix;if(_){const C=_.find(F=>F.key===d.tileID.key);if(C)return C}if(d.tileID.key!==l.key){const C=l.canonical.z-d.tileID.canonical.z;let F,G,Q;x=u.create();const fe=d.tileID.wrap-l.wrap<<l.overscaledZ;C>0?(F=u.EXTENT>>C,G=F*((d.tileID.canonical.x<<C)-l.canonical.x+fe),Q=F*((d.tileID.canonical.y<<C)-l.canonical.y)):(F=u.EXTENT<<-C,G=u.EXTENT*(d.tileID.canonical.x-(l.canonical.x+fe<<-C)),Q=u.EXTENT*(d.tileID.canonical.y-(l.canonical.y<<-C))),u.ortho(x,0,F,0,F,0,1),u.translate(x,x,[G,Q,0])}return new ar(d.tileID,l.key,x)}_findTileCoveringTileID(l,d){let _=d.getTile(l);if(_&&_.hasData())return _;const x=this._findCoveringTileCache[d.id],C=x[l.key];if(_=C?d.getTileByID(C):null,_&&_.hasData()||null===C)return _;let F=_?_.tileID:l,G=F.overscaledZ;const Q=d.getSource().minzoom,fe=[];if(!C){const ke=d.getSource().maxzoom;if(l.canonical.z>=ke){const ze=l.canonical.z-ke;d.getSource().reparseOverscaled?(G=Math.max(l.canonical.z+2,d.transform.tileZoom),F=new u.OverscaledTileID(G,l.wrap,ke,l.canonical.x>>ze,l.canonical.y>>ze)):0!==ze&&(G=ke,F=new u.OverscaledTileID(G,l.wrap,ke,l.canonical.x>>ze,l.canonical.y>>ze))}F.key!==l.key&&(fe.push(F.key),_=d.getTile(F))}const pe=ke=>{fe.forEach(ze=>{x[ze]=ke}),fe.length=0};for(G-=1;G>=Q&&(!_||!_.hasData());G--){_&&pe(_.tileID.key);const ke=F.calculateScaledKey(G);if(_=d.getTileByID(ke),_&&_.hasData())break;const ze=x[ke];if(null===ze)break;void 0===ze?fe.push(ke):_=d.getTileByID(ze)}return pe(_?_.tileID.key:null),_&&_.hasData()?_:null}findDEMTileFor(l){return this.enabled?this._findTileCoveringTileID(l,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(l,d){let _=this._tilesDirty[l];_||(_=this._tilesDirty[l]={}),_[d.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const l=function(d){let _=0;const x=new u.StructArrayLayout2ui4,C=131;for(let F=1;F<129;F++){for(let G=1;G<129;G++)_=F*C+G,x.emplaceBack(_,_+1),x.emplaceBack(_,_+C),x.emplaceBack(_+1,_+C),128===F&&x.emplaceBack(_+C,_+C+1);x.emplaceBack(_+1,_+1+C)}return x}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(l),this.wireframeSegments=u.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,l.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Do{static cacheKey(l,d,_,x){let C=`${d}${x?x.cacheKey:""}`;for(const F of _)l.usedDefines.includes(F)&&(C+=`/${F}`);return C}constructor(l,d,_,x,C,F){const G=l.gl;this.program=G.createProgram();const Q=function(Ue){const He=[];for(let Je=0;Je<Ue.length;Je++){if(null===Ue[Je])continue;const Ye=Ue[Je].split(" ");He.push(Ye.pop())}return He}(_.staticAttributes),fe=x?x.getBinderAttributes():[],pe=Q.concat(fe);let ke=x?x.defines():[];ke=ke.concat(F.map(Ue=>`#define ${Ue}`));const ze=ke.concat(l.extStandardDerivatives?"#extension GL_OES_standard_derivatives : enable\n".concat(Du):Du,Du,wr,Os.fragmentSource,qd.fragmentSource,_.fragmentSource).join("\n"),We=ke.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",wr,Os.vertexSource,qd.vertexSource,Zs.vertexSource,_.vertexSource).join("\n"),$e=G.createShader(G.FRAGMENT_SHADER);if(G.isContextLost())return void(this.failedToCreate=!0);G.shaderSource($e,ze),G.compileShader($e),G.attachShader(this.program,$e);const qe=G.createShader(G.VERTEX_SHADER);if(G.isContextLost())this.failedToCreate=!0;else{G.shaderSource(qe,We),G.compileShader(qe),G.attachShader(this.program,qe),this.attributes={},this.numAttributes=pe.length;for(let Ue=0;Ue<this.numAttributes;Ue++)pe[Ue]&&(G.bindAttribLocation(this.program,Ue,pe[Ue]),this.attributes[pe[Ue]]=Ue);G.linkProgram(this.program),G.deleteShader(qe),G.deleteShader($e),this.fixedUniforms=C(l),this.binderUniforms=x?x.getUniforms(l):[],F.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new u.Uniform1i(Ue=l),u_dem_prev:new u.Uniform1i(Ue),u_dem_unpack:new u.Uniform4f(Ue),u_dem_tl:new u.Uniform2f(Ue),u_dem_scale:new u.Uniform1f(Ue),u_dem_tl_prev:new u.Uniform2f(Ue),u_dem_scale_prev:new u.Uniform1f(Ue),u_dem_size:new u.Uniform1f(Ue),u_dem_lerp:new u.Uniform1f(Ue),u_exaggeration:new u.Uniform1f(Ue),u_depth:new u.Uniform1i(Ue),u_depth_size_inv:new u.Uniform2f(Ue),u_meter_to_dem:new u.Uniform1f(Ue),u_label_plane_matrix_inv:new u.UniformMatrix4f(Ue)}),F.includes("GLOBE")&&(this.globeUniforms=(Ue=>({u_tile_tl_up:new u.Uniform3f(Ue),u_tile_tr_up:new u.Uniform3f(Ue),u_tile_br_up:new u.Uniform3f(Ue),u_tile_bl_up:new u.Uniform3f(Ue),u_tile_up_scale:new u.Uniform1f(Ue)}))(l)),F.includes("FOG")&&(this.fogUniforms=(Ue=>({u_fog_matrix:new u.UniformMatrix4f(Ue),u_fog_range:new u.Uniform2f(Ue),u_fog_color:new u.Uniform4f(Ue),u_fog_horizon_blend:new u.Uniform1f(Ue),u_fog_temporal_offset:new u.Uniform1f(Ue),u_frustum_tl:new u.Uniform3f(Ue),u_frustum_tr:new u.Uniform3f(Ue),u_frustum_br:new u.Uniform3f(Ue),u_frustum_bl:new u.Uniform3f(Ue),u_globe_pos:new u.Uniform3f(Ue),u_globe_radius:new u.Uniform1f(Ue),u_globe_transition:new u.Uniform1f(Ue),u_is_globe:new u.Uniform1i(Ue),u_viewport:new u.Uniform2f(Ue)}))(l))}var Ue}setTerrainUniformValues(l,d){if(!this.terrainUniforms)return;const _=this.terrainUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const x in d)_[x]&&_[x].set(this.program,x,d[x])}}setGlobeUniformValues(l,d){if(!this.globeUniforms)return;const _=this.globeUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const x in d)_[x]&&_[x].set(this.program,x,d[x])}}setFogUniformValues(l,d){if(!this.fogUniforms)return;const _=this.fogUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const x in d)_[x].set(this.program,x,d[x])}}draw(l,d,_,x,C,F,G,Q,fe,pe,ke,ze,We,$e,qe){const Ue=l.gl;if(this.failedToCreate)return;l.program.set(this.program),l.setDepthMode(_),l.setStencilMode(x),l.setColorMode(C),l.setCullFace(F);for(const Je of Object.keys(this.fixedUniforms))this.fixedUniforms[Je].set(this.program,Je,G[Je]);$e&&$e.setUniforms(this.program,l,this.binderUniforms,ze,{zoom:We});const He={[Ue.LINES]:2,[Ue.TRIANGLES]:3,[Ue.LINE_STRIP]:1}[d];for(const Je of ke.get()){const Ye=Je.vaos||(Je.vaos={});(Ye[Q]||(Ye[Q]=new Dh)).bind(l,this,fe,$e?$e.getPaintVertexBuffers():[],pe,Je.vertexOffset,qe||[]),Ue.drawElements(d,Je.primitiveLength*He,Ue.UNSIGNED_SHORT,Je.primitiveOffset*He*2)}}}function Ka(m,l){const d=Math.pow(2,l.tileID.overscaledZ),_=l.tileSize*Math.pow(2,m.transform.tileZoom)/d,x=_*(l.tileID.canonical.x+l.tileID.wrap*d),C=_*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_tile_units_to_pixels:1/ae(l,1,m.transform.tileZoom),u_pixel_coord_upper:[x>>16,C>>16],u_pixel_coord_lower:[65535&x,65535&C]}}const xs=u.create(),Rs=(m,l,d,_,x,C,F,G,Q,fe,pe)=>{const ke=l.style.light,ze=ke.properties.get("position"),We=[ze.x,ze.y,ze.z],$e=u.create$1();"viewport"===ke.properties.get("anchor")&&(u.fromRotation($e,-l.transform.angle),u.transformMat3(We,We,$e));const qe=ke.properties.get("color"),Ue=l.transform,He={u_matrix:m,u_lightpos:We,u_lightintensity:ke.properties.get("intensity"),u_lightcolor:[qe.r,qe.g,qe.b],u_vertical_gradient:+d,u_opacity:_,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:xs,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:x,u_edge_radius:C};return"globe"===Ue.projection.name&&(He.u_tile_id=[F.canonical.x,F.canonical.y,1<<F.canonical.z],He.u_zoom_transition=Q,He.u_inv_rot_matrix=pe,He.u_merc_center=fe,He.u_up_dir=Ue.projection.upVector(new u.CanonicalTileID(0,0,0),fe[0]*u.EXTENT,fe[1]*u.EXTENT),He.u_height_lift=G),He},Ai=(m,l,d,_,x,C,F,G,Q,fe,pe,ke)=>{const ze=Rs(m,l,d,_,x,C,F,Q,fe,pe,ke),We={u_height_factor:-Math.pow(2,F.overscaledZ)/G.tileSize/8};return u.extend(ze,Ka(l,G),We)},gn=m=>({u_matrix:m}),Mr=(m,l,d)=>u.extend(gn(m),Ka(l,d)),ns=(m,l)=>({u_matrix:m,u_world:l}),Qa=(m,l,d,_)=>u.extend(Mr(m,l,d),{u_world:_}),ho=u.create(),Tl=(m,l,d,_,x,C)=>{const F=m.transform,G="globe"===F.projection.name;let Q;if("map"===C.paint.get("circle-pitch-alignment"))if(G){const pe=u.globePixelsToTileUnits(F.zoom,l.canonical)*F._pixelsPerMercatorPixel;Q=Float32Array.from([pe,0,0,pe])}else Q=F.calculatePixelsToTileUnitsMatrix(d);else Q=new Float32Array([F.pixelsToGLUnits[0],0,0,F.pixelsToGLUnits[1]]);const fe={u_camera_to_center_distance:F.cameraToCenterDistance,u_matrix:m.translatePosMatrix(l.projMatrix,d,C.paint.get("circle-translate"),C.paint.get("circle-translate-anchor")),u_device_pixel_ratio:u.exported.devicePixelRatio,u_extrude_scale:Q,u_inv_rot_matrix:ho,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(G){fe.u_inv_rot_matrix=_,fe.u_merc_center=x,fe.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],fe.u_zoom_transition=u.globeToMercatorTransition(F.zoom);const pe=x[0]*u.EXTENT,ke=x[1]*u.EXTENT;fe.u_up_dir=F.projection.upVector(new u.CanonicalTileID(0,0,0),pe,ke)}return fe},qr=m=>{const l=[];return"map"===m.paint.get("circle-pitch-alignment")&&l.push("PITCH_WITH_MAP"),"map"===m.paint.get("circle-pitch-scale")&&l.push("SCALE_WITH_MAP"),l},Ja=(m,l,d,_)=>{const x=u.EXTENT/d.tileSize;return{u_matrix:m,u_camera_to_center_distance:l.getCameraToCenterDistance(_),u_extrude_scale:[l.pixelsToGLUnits[0]/x,l.pixelsToGLUnits[1]/x]}},ua=(m,l,d=1)=>({u_matrix:m,u_color:l,u_overlay:0,u_overlay_scale:d}),An=u.create(),ac=(m,l,d,_,x,C,F)=>{const G=m.transform,Q="globe"===G.projection.name,fe=Q?u.globePixelsToTileUnits(G.zoom,l.canonical)*G._pixelsPerMercatorPixel:ae(d,1,C),pe={u_matrix:l.projMatrix,u_extrude_scale:fe,u_intensity:F,u_inv_rot_matrix:An,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(Q){pe.u_inv_rot_matrix=_,pe.u_merc_center=x,pe.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],pe.u_zoom_transition=u.globeToMercatorTransition(G.zoom);const ke=x[0]*u.EXTENT,ze=x[1]*u.EXTENT;pe.u_up_dir=G.projection.upVector(new u.CanonicalTileID(0,0,0),ke,ze)}return pe},Dl=(m,l,d,_,x,C,F)=>{const G=m.transform,Q=G.calculatePixelsToTileUnitsMatrix(l);return{u_matrix:yo(m,l,d,_),u_pixels_to_tile_units:Q,u_device_pixel_ratio:C,u_units_to_pixels:[1/G.pixelsToGLUnits[0],1/G.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:x,u_texsize:Al(d)?l.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Ra(l,m.transform),u_alpha_discard_threshold:0,u_trim_offset:F}},Js=(m,l,d,_,x)=>{const C=m.transform;return{u_matrix:yo(m,l,d,_),u_texsize:l.imageAtlasTexture.size,u_pixels_to_tile_units:C.calculatePixelsToTileUnitsMatrix(l),u_device_pixel_ratio:x,u_image:0,u_tile_units_to_pixels:Ra(l,C),u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Ra(m,l){return 1/ae(m,1,l.tileZoom)}function yo(m,l,d,_){return m.translatePosMatrix(_||l.tileID.projMatrix,l,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}function Al(m){const l=m.paint.get("line-dasharray").value;return l.value||"constant"!==l.kind}const lc=(m,l,d,_,x,C)=>{return{u_matrix:m,u_tl_parent:l,u_scale_parent:d,u_fade_t:_.mix,u_opacity:_.opacity*x.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:x.paint.get("raster-brightness-min"),u_brightness_high:x.paint.get("raster-brightness-max"),u_saturation_factor:(G=x.paint.get("raster-saturation"),G>0?1-1/(1.001-G):-G),u_contrast_factor:(F=x.paint.get("raster-contrast"),F>0?1/(1-F):1+F),u_spin_weights:Ls(x.paint.get("raster-hue-rotate")),u_perspective_transform:C};var F,G};function Ls(m){m*=Math.PI/180;const l=Math.sin(m),d=Math.cos(m);return[(2*d+1)/3,(-Math.sqrt(3)*l-d+1)/3,(Math.sqrt(3)*l-d+1)/3]}const cc=u.create(),Ph=(m,l,d,_,x,C,F,G,Q,fe,pe,ke,ze,We,$e,qe)=>{const Ue=x.transform,He={u_is_size_zoom_constant:+("constant"===m||"source"===m),u_is_size_feature_constant:+("constant"===m||"camera"===m),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:Ue.cameraToCenterDistance,u_rotate_symbol:+d,u_aspect_ratio:Ue.width/Ue.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:F,u_coord_matrix:G,u_is_text:+Q,u_pitch_with_map:+_,u_texsize:fe,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:cc,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:cc,u_up_vector:[0,-1,0]};return"globe"===qe.name&&(He.u_tile_id=[pe.canonical.x,pe.canonical.y,1<<pe.canonical.z],He.u_zoom_transition=ke,He.u_inv_rot_matrix=We,He.u_merc_center=ze,He.u_camera_forward=Ue._camera.forward(),He.u_ecef_origin=u.globeECEFOrigin(Ue.globeMatrix,pe.toUnwrapped()),He.u_tile_matrix=Float32Array.from(Ue.globeMatrix),He.u_up_vector=$e),He},Sr=(m,l,d,_,x,C,F,G,Q,fe,pe,ke,ze,We,$e,qe,Ue)=>u.extend(Ph(m,l,d,_,x,C,F,G,Q,fe,ke,ze,We,$e,qe,Ue),{u_gamma_scale:_?x.transform.cameraToCenterDistance*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:u.exported.devicePixelRatio,u_is_halo:+pe}),Iu=(m,l,d,_,x,C,F,G,Q,fe,pe,ke,ze,We,$e,qe)=>u.extend(Sr(m,l,d,_,x,C,F,G,!0,Q,!0,pe,ke,ze,We,$e,qe),{u_texsize_icon:fe,u_texture_icon:1}),Pg=(m,l,d)=>({u_matrix:m,u_opacity:l,u_color:d}),Bc=(m,l,d,_,x)=>u.extend(function(C,F,G){const Q=F.imageManager.getPattern(C.toString()),{width:fe,height:pe}=F.imageManager.getPixelSize(),ke=Math.pow(2,G.tileID.overscaledZ),ze=G.tileSize*Math.pow(2,F.transform.tileZoom)/ke,We=ze*(G.tileID.canonical.x+G.tileID.wrap*ke),$e=ze*G.tileID.canonical.y;return{u_image:0,u_pattern_tl:Q.tl,u_pattern_br:Q.br,u_texsize:[fe,pe],u_pattern_size:Q.displaySize,u_tile_units_to_pixels:1/ae(G,1,F.transform.tileZoom),u_pixel_coord_upper:[We>>16,$e>>16],u_pixel_coord_lower:[65535&We,65535&$e]}}(_,d,x),{u_matrix:m,u_opacity:l}),Yd={fillExtrusion:m=>({u_matrix:new u.UniformMatrix4f(m),u_lightpos:new u.Uniform3f(m),u_lightintensity:new u.Uniform1f(m),u_lightcolor:new u.Uniform3f(m),u_vertical_gradient:new u.Uniform1f(m),u_opacity:new u.Uniform1f(m),u_edge_radius:new u.Uniform1f(m),u_ao:new u.Uniform2f(m),u_tile_id:new u.Uniform3f(m),u_zoom_transition:new u.Uniform1f(m),u_inv_rot_matrix:new u.UniformMatrix4f(m),u_merc_center:new u.Uniform2f(m),u_up_dir:new u.Uniform3f(m),u_height_lift:new u.Uniform1f(m)}),fillExtrusionPattern:m=>({u_matrix:new u.UniformMatrix4f(m),u_lightpos:new u.Uniform3f(m),u_lightintensity:new u.Uniform1f(m),u_lightcolor:new u.Uniform3f(m),u_vertical_gradient:new u.Uniform1f(m),u_height_factor:new u.Uniform1f(m),u_edge_radius:new u.Uniform1f(m),u_ao:new u.Uniform2f(m),u_tile_id:new u.Uniform3f(m),u_zoom_transition:new u.Uniform1f(m),u_inv_rot_matrix:new u.UniformMatrix4f(m),u_merc_center:new u.Uniform2f(m),u_up_dir:new u.Uniform3f(m),u_height_lift:new u.Uniform1f(m),u_image:new u.Uniform1i(m),u_texsize:new u.Uniform2f(m),u_pixel_coord_upper:new u.Uniform2f(m),u_pixel_coord_lower:new u.Uniform2f(m),u_tile_units_to_pixels:new u.Uniform1f(m),u_opacity:new u.Uniform1f(m)}),fill:m=>({u_matrix:new u.UniformMatrix4f(m)}),fillPattern:m=>({u_matrix:new u.UniformMatrix4f(m),u_image:new u.Uniform1i(m),u_texsize:new u.Uniform2f(m),u_pixel_coord_upper:new u.Uniform2f(m),u_pixel_coord_lower:new u.Uniform2f(m),u_tile_units_to_pixels:new u.Uniform1f(m)}),fillOutline:m=>({u_matrix:new u.UniformMatrix4f(m),u_world:new u.Uniform2f(m)}),fillOutlinePattern:m=>({u_matrix:new u.UniformMatrix4f(m),u_world:new u.Uniform2f(m),u_image:new u.Uniform1i(m),u_texsize:new u.Uniform2f(m),u_pixel_coord_upper:new u.Uniform2f(m),u_pixel_coord_lower:new u.Uniform2f(m),u_tile_units_to_pixels:new u.Uniform1f(m)}),circle:m=>({u_camera_to_center_distance:new u.Uniform1f(m),u_extrude_scale:new u.UniformMatrix2f(m),u_device_pixel_ratio:new u.Uniform1f(m),u_matrix:new u.UniformMatrix4f(m),u_inv_rot_matrix:new u.UniformMatrix4f(m),u_merc_center:new u.Uniform2f(m),u_tile_id:new u.Uniform3f(m),u_zoom_transition:new u.Uniform1f(m),u_up_dir:new u.Uniform3f(m)}),collisionBox:m=>({u_matrix:new u.UniformMatrix4f(m),u_camera_to_center_distance:new u.Uniform1f(m),u_extrude_scale:new u.Uniform2f(m)}),collisionCircle:m=>({u_matrix:new u.UniformMatrix4f(m),u_inv_matrix:new u.UniformMatrix4f(m),u_camera_to_center_distance:new u.Uniform1f(m),u_viewport_size:new u.Uniform2f(m)}),debug:m=>({u_color:new u.UniformColor(m),u_matrix:new u.UniformMatrix4f(m),u_overlay:new u.Uniform1i(m),u_overlay_scale:new u.Uniform1f(m)}),clippingMask:m=>({u_matrix:new u.UniformMatrix4f(m)}),heatmap:m=>({u_extrude_scale:new u.Uniform1f(m),u_intensity:new u.Uniform1f(m),u_matrix:new u.UniformMatrix4f(m),u_inv_rot_matrix:new u.UniformMatrix4f(m),u_merc_center:new u.Uniform2f(m),u_tile_id:new u.Uniform3f(m),u_zoom_transition:new u.Uniform1f(m),u_up_dir:new u.Uniform3f(m)}),heatmapTexture:m=>({u_image:new u.Uniform1i(m),u_color_ramp:new u.Uniform1i(m),u_opacity:new u.Uniform1f(m)}),hillshade:m=>({u_matrix:new u.UniformMatrix4f(m),u_image:new u.Uniform1i(m),u_latrange:new u.Uniform2f(m),u_light:new u.Uniform2f(m),u_shadow:new u.UniformColor(m),u_highlight:new u.UniformColor(m),u_accent:new u.UniformColor(m)}),hillshadePrepare:m=>({u_matrix:new u.UniformMatrix4f(m),u_image:new u.Uniform1i(m),u_dimension:new u.Uniform2f(m),u_zoom:new u.Uniform1f(m),u_unpack:new u.Uniform4f(m)}),line:m=>({u_matrix:new u.UniformMatrix4f(m),u_pixels_to_tile_units:new u.UniformMatrix2f(m),u_device_pixel_ratio:new u.Uniform1f(m),u_units_to_pixels:new u.Uniform2f(m),u_dash_image:new u.Uniform1i(m),u_gradient_image:new u.Uniform1i(m),u_image_height:new u.Uniform1f(m),u_texsize:new u.Uniform2f(m),u_tile_units_to_pixels:new u.Uniform1f(m),u_alpha_discard_threshold:new u.Uniform1f(m),u_trim_offset:new u.Uniform2f(m)}),linePattern:m=>({u_matrix:new u.UniformMatrix4f(m),u_texsize:new u.Uniform2f(m),u_pixels_to_tile_units:new u.UniformMatrix2f(m),u_device_pixel_ratio:new u.Uniform1f(m),u_image:new u.Uniform1i(m),u_units_to_pixels:new u.Uniform2f(m),u_tile_units_to_pixels:new u.Uniform1f(m),u_alpha_discard_threshold:new u.Uniform1f(m)}),raster:m=>({u_matrix:new u.UniformMatrix4f(m),u_tl_parent:new u.Uniform2f(m),u_scale_parent:new u.Uniform1f(m),u_fade_t:new u.Uniform1f(m),u_opacity:new u.Uniform1f(m),u_image0:new u.Uniform1i(m),u_image1:new u.Uniform1i(m),u_brightness_low:new u.Uniform1f(m),u_brightness_high:new u.Uniform1f(m),u_saturation_factor:new u.Uniform1f(m),u_contrast_factor:new u.Uniform1f(m),u_spin_weights:new u.Uniform3f(m),u_perspective_transform:new u.Uniform2f(m)}),symbolIcon:m=>({u_is_size_zoom_constant:new u.Uniform1i(m),u_is_size_feature_constant:new u.Uniform1i(m),u_size_t:new u.Uniform1f(m),u_size:new u.Uniform1f(m),u_camera_to_center_distance:new u.Uniform1f(m),u_rotate_symbol:new u.Uniform1i(m),u_aspect_ratio:new u.Uniform1f(m),u_fade_change:new u.Uniform1f(m),u_matrix:new u.UniformMatrix4f(m),u_label_plane_matrix:new u.UniformMatrix4f(m),u_coord_matrix:new u.UniformMatrix4f(m),u_is_text:new u.Uniform1i(m),u_pitch_with_map:new u.Uniform1i(m),u_texsize:new u.Uniform2f(m),u_tile_id:new u.Uniform3f(m),u_zoom_transition:new u.Uniform1f(m),u_inv_rot_matrix:new u.UniformMatrix4f(m),u_merc_center:new u.Uniform2f(m),u_camera_forward:new u.Uniform3f(m),u_tile_matrix:new u.UniformMatrix4f(m),u_up_vector:new u.Uniform3f(m),u_ecef_origin:new u.Uniform3f(m),u_texture:new u.Uniform1i(m)}),symbolSDF:m=>({u_is_size_zoom_constant:new u.Uniform1i(m),u_is_size_feature_constant:new u.Uniform1i(m),u_size_t:new u.Uniform1f(m),u_size:new u.Uniform1f(m),u_camera_to_center_distance:new u.Uniform1f(m),u_rotate_symbol:new u.Uniform1i(m),u_aspect_ratio:new u.Uniform1f(m),u_fade_change:new u.Uniform1f(m),u_matrix:new u.UniformMatrix4f(m),u_label_plane_matrix:new u.UniformMatrix4f(m),u_coord_matrix:new u.UniformMatrix4f(m),u_is_text:new u.Uniform1i(m),u_pitch_with_map:new u.Uniform1i(m),u_texsize:new u.Uniform2f(m),u_texture:new u.Uniform1i(m),u_gamma_scale:new u.Uniform1f(m),u_device_pixel_ratio:new u.Uniform1f(m),u_tile_id:new u.Uniform3f(m),u_zoom_transition:new u.Uniform1f(m),u_inv_rot_matrix:new u.UniformMatrix4f(m),u_merc_center:new u.Uniform2f(m),u_camera_forward:new u.Uniform3f(m),u_tile_matrix:new u.UniformMatrix4f(m),u_up_vector:new u.Uniform3f(m),u_ecef_origin:new u.Uniform3f(m),u_is_halo:new u.Uniform1i(m)}),symbolTextAndIcon:m=>({u_is_size_zoom_constant:new u.Uniform1i(m),u_is_size_feature_constant:new u.Uniform1i(m),u_size_t:new u.Uniform1f(m),u_size:new u.Uniform1f(m),u_camera_to_center_distance:new u.Uniform1f(m),u_rotate_symbol:new u.Uniform1i(m),u_aspect_ratio:new u.Uniform1f(m),u_fade_change:new u.Uniform1f(m),u_matrix:new u.UniformMatrix4f(m),u_label_plane_matrix:new u.UniformMatrix4f(m),u_coord_matrix:new u.UniformMatrix4f(m),u_is_text:new u.Uniform1i(m),u_pitch_with_map:new u.Uniform1i(m),u_texsize:new u.Uniform2f(m),u_texsize_icon:new u.Uniform2f(m),u_texture:new u.Uniform1i(m),u_texture_icon:new u.Uniform1i(m),u_gamma_scale:new u.Uniform1f(m),u_device_pixel_ratio:new u.Uniform1f(m),u_is_halo:new u.Uniform1i(m)}),background:m=>({u_matrix:new u.UniformMatrix4f(m),u_opacity:new u.Uniform1f(m),u_color:new u.UniformColor(m)}),backgroundPattern:m=>({u_matrix:new u.UniformMatrix4f(m),u_opacity:new u.Uniform1f(m),u_image:new u.Uniform1i(m),u_pattern_tl:new u.Uniform2f(m),u_pattern_br:new u.Uniform2f(m),u_texsize:new u.Uniform2f(m),u_pattern_size:new u.Uniform2f(m),u_pixel_coord_upper:new u.Uniform2f(m),u_pixel_coord_lower:new u.Uniform2f(m),u_tile_units_to_pixels:new u.Uniform1f(m)}),terrainRaster:Za,terrainDepth:Za,skybox:m=>({u_matrix:new u.UniformMatrix4f(m),u_sun_direction:new u.Uniform3f(m),u_cubemap:new u.Uniform1i(m),u_opacity:new u.Uniform1f(m),u_temporal_offset:new u.Uniform1f(m)}),skyboxGradient:m=>({u_matrix:new u.UniformMatrix4f(m),u_color_ramp:new u.Uniform1i(m),u_center_direction:new u.Uniform3f(m),u_radius:new u.Uniform1f(m),u_opacity:new u.Uniform1f(m),u_temporal_offset:new u.Uniform1f(m)}),skyboxCapture:m=>({u_matrix_3f:new u.UniformMatrix3f(m),u_sun_direction:new u.Uniform3f(m),u_sun_intensity:new u.Uniform1f(m),u_color_tint_r:new u.Uniform4f(m),u_color_tint_m:new u.Uniform4f(m),u_luminance:new u.Uniform1f(m)}),globeRaster:m=>({u_proj_matrix:new u.UniformMatrix4f(m),u_globe_matrix:new u.UniformMatrix4f(m),u_normalize_matrix:new u.UniformMatrix4f(m),u_merc_matrix:new u.UniformMatrix4f(m),u_zoom_transition:new u.Uniform1f(m),u_merc_center:new u.Uniform2f(m),u_image0:new u.Uniform1i(m),u_grid_matrix:new u.UniformMatrix3f(m),u_frustum_tl:new u.Uniform3f(m),u_frustum_tr:new u.Uniform3f(m),u_frustum_br:new u.Uniform3f(m),u_frustum_bl:new u.Uniform3f(m),u_globe_pos:new u.Uniform3f(m),u_globe_radius:new u.Uniform1f(m),u_viewport:new u.Uniform2f(m)}),globeAtmosphere:m=>({u_frustum_tl:new u.Uniform3f(m),u_frustum_tr:new u.Uniform3f(m),u_frustum_br:new u.Uniform3f(m),u_frustum_bl:new u.Uniform3f(m),u_horizon:new u.Uniform1f(m),u_transition:new u.Uniform1f(m),u_fadeout_range:new u.Uniform1f(m),u_color:new u.Uniform4f(m),u_high_color:new u.Uniform4f(m),u_space_color:new u.Uniform4f(m),u_star_intensity:new u.Uniform1f(m),u_star_density:new u.Uniform1f(m),u_star_size:new u.Uniform1f(m),u_temporal_offset:new u.Uniform1f(m),u_horizon_angle:new u.Uniform1f(m),u_rotation_matrix:new u.UniformMatrix4f(m)})};let La;function Oh(m,l,d,_,x,C,F){const G=m.context,Q=G.gl,fe=m.transform,pe=m.useProgram("collisionBox"),ke=[];let ze=0,We=0;for(let rt=0;rt<_.length;rt++){const mt=_[rt],pt=l.getTile(mt),xt=pt.getBucket(d);if(!xt)continue;const Rt=wl(mt,xt,fe);let kt=Rt;0===x[0]&&0===x[1]||(kt=m.translatePosMatrix(Rt,pt,x,C));const Ct=F?xt.textCollisionBox:xt.iconCollisionBox,si=xt.collisionCircleArray;if(si.length>0){const At=u.create(),Ht=kt;u.mul(At,xt.placementInvProjMatrix,fe.glCoordMatrix),u.mul(At,At,xt.placementViewportMatrix),ke.push({circleArray:si,circleOffset:We,transform:Ht,invTransform:At,projection:xt.getProjection()}),ze+=si.length/4,We=ze}Ct&&(m.terrain&&m.terrain.setupElevationDraw(pt,pe),pe.draw(G,Q.LINES,u.DepthMode.disabled,u.StencilMode.disabled,m.colorModeForRenderPass(),u.CullFaceMode.disabled,Ja(kt,fe,pt,xt.getProjection()),d.id,Ct.layoutVertexBuffer,Ct.indexBuffer,Ct.segments,null,fe.zoom,null,[Ct.collisionVertexBuffer,Ct.collisionVertexBufferExt]))}if(!F||!ke.length)return;const $e=m.useProgram("collisionCircle"),qe=new u.StructArrayLayout2f1f2i16;qe.resize(4*ze),qe._trim();let Ue=0;for(const rt of ke)for(let mt=0;mt<rt.circleArray.length/4;mt++){const pt=4*mt,xt=rt.circleArray[pt+0],Rt=rt.circleArray[pt+1],kt=rt.circleArray[pt+2],Ct=rt.circleArray[pt+3];qe.emplace(Ue++,xt,Rt,kt,Ct,0),qe.emplace(Ue++,xt,Rt,kt,Ct,1),qe.emplace(Ue++,xt,Rt,kt,Ct,2),qe.emplace(Ue++,xt,Rt,kt,Ct,3)}(!La||La.length<2*ze)&&(La=function(rt){const mt=2*rt,pt=new u.StructArrayLayout3ui6;pt.resize(mt),pt._trim();for(let xt=0;xt<mt;xt++){const Rt=6*xt;pt.uint16[Rt+0]=4*xt+0,pt.uint16[Rt+1]=4*xt+1,pt.uint16[Rt+2]=4*xt+2,pt.uint16[Rt+3]=4*xt+2,pt.uint16[Rt+4]=4*xt+3,pt.uint16[Rt+5]=4*xt+0}return pt}(ze));const He=G.createIndexBuffer(La,!0),Je=G.createVertexBuffer(qe,u.collisionCircleLayout.members,!0);for(const rt of ke){const mt={u_matrix:rt.transform,u_inv_matrix:rt.invTransform,u_camera_to_center_distance:(Ye=fe).getCameraToCenterDistance(rt.projection),u_viewport_size:[Ye.width,Ye.height]};$e.draw(G,Q.TRIANGLES,u.DepthMode.disabled,u.StencilMode.disabled,m.colorModeForRenderPass(),u.CullFaceMode.disabled,mt,d.id,Je,He,u.SegmentVector.simpleSegment(0,2*rt.circleOffset,rt.circleArray.length,rt.circleArray.length/2),null,fe.zoom)}var Ye;Je.destroy(),He.destroy()}const da=u.create();function Go({width:m,height:l,anchor:d,textOffset:_,textScale:x},C){const{horizontalAlign:F,verticalAlign:G}=u.getAnchorAlignment(d),Q=-(F-.5)*m,fe=-(G-.5)*l,pe=u.evaluateVariableOffset(d,_);return new u.pointGeometry((Q/x+pe[0])*C,(fe/x+pe[1])*C)}function Sf(m,l,d,_,x,C,F,G,Q,fe,pe){const ke=m.text.placedSymbolArray,ze=m.text.dynamicLayoutVertexArray,We=m.icon.dynamicLayoutVertexArray,$e={},qe=m.getProjection(),Ue=So(G,qe,C),He=C.elevation,Je=qe.upVectorScale(G.canonical,C.center.lat,C.worldSize).metersToTile;ze.clear();for(let Ye=0;Ye<ke.length;Ye++){const rt=ke.get(Ye),{tileAnchorX:mt,tileAnchorY:pt,numGlyphs:xt}=rt,Rt=m.allowVerticalPlacement&&!rt.placedOrientation,kt=rt.hidden||!rt.crossTileID||Rt?null:_[rt.crossTileID];if(kt){let Ct=0,si=0,At=0;if(He){const Ti=He?He.getAtTileOffset(G,mt,pt):0,[ki,Di,Ui]=qe.upVector(G.canonical,mt,pt);Ct=Ti*ki*Je,si=Ti*Di*Je,At=Ti*Ui*Je}let[Ht,Ft,ei,zt]=Mo(rt.projectedAnchorX+Ct,rt.projectedAnchorY+si,rt.projectedAnchorZ+At,d?Ue:F);const Zt=ri(C.getCameraToCenterDistance(qe),zt);let li=x.evaluateSizeForFeature(m.textSizeData,fe,rt)*Zt/u.ONE_EM;d&&(li*=m.tilePixelRatio/Q);const St=Go(kt,li);d?(({x:Ht,y:Ft,z:ei}=qe.projectTilePoint(mt+St.x,pt+St.y,G.canonical)),[Ht,Ft,ei]=Mo(Ht+Ct,Ft+si,ei+At,F)):(l&&St._rotate(-C.angle),Ht+=St.x,Ft+=St.y,ei=0);const Lt=m.allowVerticalPlacement&&rt.placedOrientation===u.WritingMode.vertical?Math.PI/2:0;for(let Ti=0;Ti<xt;Ti++)u.addDynamicAttributes(ze,Ht,Ft,ei,Lt);pe&&rt.associatedIconIndex>=0&&($e[rt.associatedIconIndex]={x:Ht,y:Ft,z:ei,angle:Lt})}else Gi(xt,ze)}if(pe){We.clear();const Ye=m.icon.placedSymbolArray;for(let rt=0;rt<Ye.length;rt++){const mt=Ye.get(rt),{numGlyphs:pt}=mt,xt=$e[rt];if(mt.hidden||!xt)Gi(pt,We);else{const{x:Rt,y:kt,z:Ct,angle:si}=xt;for(let At=0;At<pt;At++)u.addDynamicAttributes(We,Rt,kt,Ct,si)}}m.icon.dynamicLayoutVertexBuffer.updateData(We)}m.text.dynamicLayoutVertexBuffer.updateData(ze)}function rs(m,l,d){return d.iconsInText&&l?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function Ao(m,l,d,_,x,C,F,G,Q,fe,pe,ke){const ze=m.context,We=ze.gl,$e=m.transform,qe="map"===G,Ue="map"===Q,He=qe&&"point"!==d.layout.get("symbol-placement"),Je=qe&&!Ue&&!He,Ye=void 0!==d.layout.get("symbol-sort-key").constantOr(1);let rt=!1;const mt=m.depthModeForSublayer(0,u.DepthMode.ReadOnly),pt=[u.mercatorXfromLng($e.center.lng),u.mercatorYfromLat($e.center.lat)],xt=d.layout.get("text-variable-anchor"),Rt="globe"===$e.projection.name,kt=[],Ct=[0,-1,0];let si=Ct;!Rt&&!$e.mercatorFromTransition||qe||(si=function(At){const Ht=At._camera.getWorldToCamera(At.worldSize,1),Ft=u.multiply([],Ht,At.globeMatrix);u.invert(Ft,Ft);const ei=[0,0,0],zt=[0,1,0,0];return u.transformMat4$1(zt,zt,Ft),ei[0]=zt[0],ei[1]=zt[1],ei[2]=zt[2],u.normalize(ei,ei),ei}($e));for(const At of _){const Ht=l.getTile(At),Ft=Ht.getBucket(d);if(!Ft||"mercator"===Ft.projection.name&&Rt)continue;const ei=x?Ft.text:Ft.icon;if(!ei||Ft.fullyClipped||!ei.segments.get().length)continue;const zt=ei.programConfigurations.get(d.id),Zt=x||Ft.sdfIcons,li=x?Ft.textSizeData:Ft.iconSizeData,St=Ue||0!==$e.pitch,Lt=u.evaluateSizeForZoom(li,$e.zoom);let Ti,ki,Di,Ui,cn=[0,0],Fi=null;if(x){if(ki=Ht.glyphAtlasTexture,Di=We.LINEAR,Ti=Ht.glyphAtlasTexture.size,Ft.iconsInText){cn=Ht.imageAtlasTexture.size,Fi=Ht.imageAtlasTexture;const po="composite"===li.kind||"camera"===li.kind;Ui=St||m.options.rotating||m.options.zooming||po?We.LINEAR:We.NEAREST}}else{const po=1!==d.layout.get("icon-size").constantOr(0)||Ft.iconsNeedLinear;ki=Ht.imageAtlasTexture,Di=Zt||m.options.rotating||m.options.zooming||po||St?We.LINEAR:We.NEAREST,Ti=Ht.imageAtlasTexture.size}const Ci="globe"===Ft.projection.name,jn=Ci?si:Ct,Un=Ci?u.globeToMercatorTransition($e.zoom):0,cr=So(At,Ft.getProjection(),$e),tr=$e.calculatePixelsToTileUnitsMatrix(Ht),os=vs(cr,Ht.tileID.canonical,Ue,qe,$e,Ft.getProjection(),tr),bs=m.terrain&&Ue&&He?u.invert(u.create(),os):da,ss=br(cr,Ht.tileID.canonical,Ue,qe,$e,Ft.getProjection(),tr),Ns=xt&&Ft.hasTextData(),ir="none"!==d.layout.get("icon-text-fit")&&Ns&&Ft.hasIconData();if(He){const po=$e.elevation,as=po?po.getAtTileOffsetFunc(At,$e.center.lat,$e.worldSize,Ft.getProjection()):null,ls=Nc(cr,Ht.tileID.canonical,Ue,qe,$e,Ft.getProjection(),tr);Tn(Ft,cr,m,x,ls,ss,Ue,fe,as,At)}const fr=He||x&&xt||ir,Ln=m.translatePosMatrix(cr,Ht,C,F),Nr=fr?da:os,Yr=m.translatePosMatrix(ss,Ht,C,F,!0),mr=Ft.getProjection().createInversionMatrix($e,At.canonical),Hn=[];m.terrainRenderModeElevated()&&Ue&&Hn.push("PITCH_WITH_MAP_TERRAIN"),Ci&&Hn.push("PROJECTION_GLOBE_VIEW"),fr&&Hn.push("PROJECTED_POS_ON_VIEWPORT");const fc=Zt&&0!==d.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1);let ol;ol=Zt?Ft.iconsInText?Iu(li.kind,Lt,Je,Ue,m,Ln,Nr,Yr,Ti,cn,At,Un,pt,mr,jn,Ft.getProjection()):Sr(li.kind,Lt,Je,Ue,m,Ln,Nr,Yr,x,Ti,!0,At,Un,pt,mr,jn,Ft.getProjection()):Ph(li.kind,Lt,Je,Ue,m,Ln,Nr,Yr,x,Ti,At,Un,pt,mr,jn,Ft.getProjection());const Oo={program:m.useProgram(rs(Zt,x,Ft),zt,Hn),buffers:ei,uniformValues:ol,atlasTexture:ki,atlasTextureIcon:Fi,atlasInterpolation:Di,atlasInterpolationIcon:Ui,isSDF:Zt,hasHalo:fc,tile:Ht,labelPlaneMatrixInv:bs};if(Ye&&Ft.canOverlap){rt=!0;const po=ei.segments.get();for(const as of po)kt.push({segments:new u.SegmentVector([as]),sortKey:as.sortKey,state:Oo})}else kt.push({segments:ei.segments,sortKey:0,state:Oo})}rt&&kt.sort((At,Ht)=>At.sortKey-Ht.sortKey);for(const At of kt){const Ht=At.state;if(m.terrain&&m.terrain.setupElevationDraw(Ht.tile,Ht.program,{useDepthForOcclusion:!Rt,labelPlaneMatrixInv:Ht.labelPlaneMatrixInv}),ze.activeTexture.set(We.TEXTURE0),Ht.atlasTexture.bind(Ht.atlasInterpolation,We.CLAMP_TO_EDGE),Ht.atlasTextureIcon&&(ze.activeTexture.set(We.TEXTURE1),Ht.atlasTextureIcon&&Ht.atlasTextureIcon.bind(Ht.atlasInterpolationIcon,We.CLAMP_TO_EDGE)),Ht.isSDF){const Ft=Ht.uniformValues;Ht.hasHalo&&(Ft.u_is_halo=1,Pu(Ht.buffers,At.segments,d,m,Ht.program,mt,pe,ke,Ft)),Ft.u_is_halo=0}Pu(Ht.buffers,At.segments,d,m,Ht.program,mt,pe,ke,Ht.uniformValues)}}function Pu(m,l,d,_,x,C,F,G,Q){const fe=_.context,pe=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.globeExtVertexBuffer];x.draw(fe,fe.gl.TRIANGLES,C,F,G,u.CullFaceMode.disabled,Q,d.id,m.layoutVertexBuffer,m.indexBuffer,l,d.paint,_.transform.zoom,m.programConfigurations.get(d.id),pe)}function Rh(m,l,d,_,x,C,F){const G=m.context.gl,Q=d.paint.get("fill-pattern"),fe=Q&&Q.constantOr(1);let pe,ke,ze,We,$e;F?(ke=fe&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",pe=G.LINES):(ke=fe?"fillPattern":"fill",pe=G.TRIANGLES);for(const qe of _){const Ue=l.getTile(qe);if(fe&&!Ue.patternsLoaded())continue;const He=Ue.getBucket(d);if(!He)continue;m.prepareDrawTile();const Je=He.programConfigurations.get(d.id),Ye=m.useProgram(ke,Je);fe&&(m.context.activeTexture.set(G.TEXTURE0),Ue.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),Je.updatePaintBuffers());const rt=Q.constantOr(null);if(rt&&Ue.imageAtlas){const pt=Ue.imageAtlas.patternPositions[rt.toString()];pt&&Je.setConstantPatternPositions(pt)}const mt=m.translatePosMatrix(qe.projMatrix,Ue,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(F){We=He.indexBuffer2,$e=He.segments2;const pt=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[G.drawingBufferWidth,G.drawingBufferHeight];ze="fillOutlinePattern"===ke&&fe?Qa(mt,m,Ue,pt):ns(mt,pt)}else We=He.indexBuffer,$e=He.segments,ze=fe?Mr(mt,m,Ue):gn(mt);m.prepareDrawProgram(m.context,Ye,qe.toUnwrapped()),Ye.draw(m.context,pe,x,m.stencilModeForClipping(qe),C,u.CullFaceMode.disabled,ze,d.id,He.layoutVertexBuffer,We,$e,d.paint,m.transform.zoom,Je)}}function zc(m,l,d,_,x,C,F){const G=m.context,Q=G.gl,fe=m.transform,pe=d.paint.get("fill-extrusion-pattern"),ke=pe.constantOr(1),ze=d.paint.get("fill-extrusion-opacity"),We=[d.paint.get("fill-extrusion-ambient-occlusion-intensity"),d.paint.get("fill-extrusion-ambient-occlusion-radius")],$e=d.layout.get("fill-extrusion-edge-radius"),qe="globe"===fe.projection.name?u.fillExtrusionHeightLift():0,Ue="globe"===fe.projection.name,He=Ue?u.globeToMercatorTransition(fe.zoom):0,Je=[u.mercatorXfromLng(fe.center.lng),u.mercatorYfromLat(fe.center.lat)],Ye=[];Ue&&(Ye.push("PROJECTION_GLOBE_VIEW"),m.style.terrainSetForDrapingOnly()&&Ye.push("TERRAIN")),We[0]>0&&Ye.push("FAUX_AO");for(const rt of _){const mt=l.getTile(rt),pt=mt.getBucket(d);if(!pt||pt.projection.name!==fe.projection.name)continue;const xt=pt.programConfigurations.get(d.id),Rt=m.useProgram(ke?"fillExtrusionPattern":"fillExtrusion",xt,Ye);if(m.terrain){const ei=m.terrain;if(m.style.terrainSetForDrapingOnly())ei.setupElevationDraw(mt,Rt,{useMeterToDem:!0});else{if(!pt.enableTerrain)continue;if(ei.setupElevationDraw(mt,Rt,{useMeterToDem:!0}),pa(G,l,rt,pt,d,ei),!pt.centroidVertexBuffer){const zt=Rt.attributes.a_centroid_pos;void 0!==zt&&Q.vertexAttrib2f(zt,0,0)}}}ke&&(m.context.activeTexture.set(Q.TEXTURE0),mt.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),xt.updatePaintBuffers());const kt=pe.constantOr(null);if(kt&&mt.imageAtlas){const ei=mt.imageAtlas.patternPositions[kt.toString()];ei&&xt.setConstantPatternPositions(ei)}const Ct=m.translatePosMatrix(rt.projMatrix,mt,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),si=fe.projection.createInversionMatrix(fe,rt.canonical),At=d.paint.get("fill-extrusion-vertical-gradient"),Ht=ke?Ai(Ct,m,At,ze,We,$e,rt,mt,qe,He,Je,si):Rs(Ct,m,At,ze,We,$e,rt,qe,He,Je,si);m.prepareDrawProgram(G,Rt,rt.toUnwrapped());const Ft=[];m.terrain&&Ft.push(pt.centroidVertexBuffer),Ue&&Ft.push(pt.layoutVertexExtBuffer),Rt.draw(G,G.gl.TRIANGLES,x,C,F,u.CullFaceMode.backCCW,Ht,d.id,pt.layoutVertexBuffer,pt.indexBuffer,pt.segments,d.paint,m.transform.zoom,xt,Ft)}}function pa(m,l,d,_,x,C){const F=[He=>{let Je=He.canonical.x-1,Ye=He.wrap;return Je<0&&(Je=(1<<He.canonical.z)-1,Ye--),new u.OverscaledTileID(He.overscaledZ,Ye,He.canonical.z,Je,He.canonical.y)},He=>{let Je=He.canonical.x+1,Ye=He.wrap;return Je===1<<He.canonical.z&&(Je=0,Ye++),new u.OverscaledTileID(He.overscaledZ,Ye,He.canonical.z,Je,He.canonical.y)},He=>new u.OverscaledTileID(He.overscaledZ,He.wrap,He.canonical.z,He.canonical.x,(0===He.canonical.y?1<<He.canonical.z:He.canonical.y)-1),He=>new u.OverscaledTileID(He.overscaledZ,He.wrap,He.canonical.z,He.canonical.x,He.canonical.y===(1<<He.canonical.z)-1?0:He.canonical.y+1)],G=He=>{const Je=l.getSource().minzoom,Ye=mt=>{const pt=l.getTileByID(mt);if(pt&&pt.hasData())return pt.getBucket(x)},rt=[0,-1,1];for(const mt of rt){if(He.overscaledZ+mt<Je)continue;const pt=Ye(He.calculateScaledKey(He.overscaledZ+mt));if(pt)return pt}},Q=[0,0,0],fe=(He,Je)=>(Q[0]=Math.min(He.min.y,Je.min.y),Q[1]=Math.max(He.max.y,Je.max.y),Q[2]=u.EXTENT-Je.min.x>He.max.x?Je.min.x-u.EXTENT:He.max.x,Q),pe=(He,Je)=>(Q[0]=Math.min(He.min.x,Je.min.x),Q[1]=Math.max(He.max.x,Je.max.x),Q[2]=u.EXTENT-Je.min.y>He.max.y?Je.min.y-u.EXTENT:He.max.y,Q),ke=[(He,Je)=>fe(He,Je),(He,Je)=>fe(Je,He),(He,Je)=>pe(He,Je),(He,Je)=>pe(Je,He)],ze=new u.pointGeometry(0,0);let We,$e,qe;const Ue=(He,Je,Ye,rt,mt)=>{const pt=[[rt?Ye:He,rt?He:Ye,0],[rt?Ye:Je,rt?Je:Ye,0]],xt=mt<0?u.EXTENT+mt:mt,Rt=[rt?xt:(He+Je)/2,rt?(He+Je)/2:xt,0];return 0===Ye&&mt<0||0!==Ye&&mt>0?C.getForTilePoints(qe,[Rt],!0,$e):pt.push(Rt),C.getForTilePoints(d,pt,!0,We),Math.max(pt[0][2],pt[1][2],Rt[2])/C.exaggeration()};for(let He=0;He<4;He++){const Je=(He<2?1:5)-He,Ye=_.borders[He];if(0===Ye.length)continue;const rt=qe=F[He](d),mt=G(rt);if(!(mt&&mt instanceof u.FillExtrusionBucket&&mt.enableTerrain)||_.borderDoneWithNeighborZ[He]===mt.canonical.z&&mt.borderDoneWithNeighborZ[Je]===_.canonical.z||($e=C.findDEMTileFor(rt),!$e||!$e.dem))continue;if(!We){const kt=C.findDEMTileFor(d);if(!kt||!kt.dem)return;We=kt}const pt=mt.borders[Je];let xt=0;const Rt=mt.borderDoneWithNeighborZ[Je]!==_.canonical.z;if(_.canonical.z===mt.canonical.z){for(let kt=0;kt<Ye.length;kt++){const Ct=_.featuresOnBorder[Ye[kt]],si=Ct.borders[He];let At;for(;xt<pt.length&&(At=mt.featuresOnBorder[pt[xt]],!(At.borders[Je][1]>si[0]+3));)Rt&&mt.encodeCentroid(void 0,At,!1),xt++;if(At&&xt<pt.length){const Ht=xt;let Ft=0;for(;!(At.borders[Je][0]>si[1]-3)&&(Ft++,++xt!==pt.length);)At=mt.featuresOnBorder[pt[xt]];if(At=mt.featuresOnBorder[pt[Ht]],Ct.intersectsCount()>1||At.intersectsCount()>1||1!==Ft){1!==Ft&&(xt=Ht),_.encodeCentroid(void 0,Ct,!1),Rt&&mt.encodeCentroid(void 0,At,!1);continue}const ei=ke[He](Ct,At),zt=He%2?u.EXTENT-1:0;ze.x=Ue(ei[0],Math.min(u.EXTENT-1,ei[1]),zt,He<2,ei[2]),ze.y=0,_.encodeCentroid(ze,Ct,!1),Rt&&mt.encodeCentroid(ze,At,!1)}else _.encodeCentroid(void 0,Ct,!1)}_.borderDoneWithNeighborZ[He]=mt.canonical.z,_.needsCentroidUpdate=!0,Rt&&(mt.borderDoneWithNeighborZ[Je]=_.canonical.z,mt.needsCentroidUpdate=!0)}else{for(const kt of Ye)_.encodeCentroid(void 0,_.featuresOnBorder[kt],!1);if(Rt){for(const kt of pt)mt.encodeCentroid(void 0,mt.featuresOnBorder[kt],!1);mt.borderDoneWithNeighborZ[Je]=_.canonical.z,mt.needsCentroidUpdate=!0}_.borderDoneWithNeighborZ[He]=mt.canonical.z,_.needsCentroidUpdate=!0}}(_.needsCentroidUpdate||!_.centroidVertexBuffer&&0!==_.centroidVertexArray.length)&&_.uploadCentroid(m)}const Og=new u.Color(1,0,0,1),bv=new u.Color(0,1,0,1),Zd=new u.Color(0,0,1,1),Kd=new u.Color(1,0,1,1),Rg=new u.Color(0,1,1,1);function Lg(m,l,d){const _=m.context,x=m.transform,C=_.gl,F="globe"===x.projection.name,G=F?["PROJECTION_GLOBE_VIEW"]:null;let Q=d.projMatrix;if(F&&u.globeToMercatorTransition(x.zoom)>0){const Ct=u.transitionTileAABBinECEF(d.canonical,x),si=u.globeDenormalizeECEF(Ct);Q=u.multiply(new Float32Array(16),x.globeMatrix,si),u.multiply(Q,x.projMatrix,Q)}const fe=m.useProgram("debug",null,G),pe=l.getTileByID(d.key);m.terrain&&m.terrain.setupElevationDraw(pe,fe);const ke=u.DepthMode.disabled,ze=u.StencilMode.disabled,We=m.colorModeForRenderPass();_.activeTexture.set(C.TEXTURE0),m.emptyTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),F?pe._makeGlobeTileDebugBuffers(m.context,x):pe._makeDebugTileBoundsBuffers(m.context,x.projection);const qe=pe._tileDebugBuffer||m.debugBuffer,Ue=pe._tileDebugIndexBuffer||m.debugIndexBuffer,He=pe._tileDebugSegments||m.debugSegments;fe.draw(_,C.LINE_STRIP,ke,ze,We,u.CullFaceMode.disabled,ua(Q,u.Color.red),"$debug",qe,Ue,He,null,null,null,[pe._globeTileDebugBorderBuffer]);const Je=pe.latestRawTileData,Ye=Math.floor((Je&&Je.byteLength||0)/1024),rt=l.getTile(d).tileSize,mt=512/Math.min(rt,512)*(d.overscaledZ/x.zoom)*.5;let pt=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(pt+=` => ${d.overscaledZ}`),pt+=` ${Ye}kb`,function(Ct,si){Ct.initDebugOverlayCanvas();const At=Ct.debugOverlayCanvas,Ht=Ct.context.gl,Ft=Ct.debugOverlayCanvas.getContext("2d");Ft.clearRect(0,0,At.width,At.height),Ft.shadowColor="white",Ft.shadowBlur=2,Ft.lineWidth=1.5,Ft.strokeStyle="white",Ft.textBaseline="top",Ft.font="bold 36px Open Sans, sans-serif",Ft.fillText(si,5,5),Ft.strokeText(si,5,5),Ct.debugOverlayTexture.update(At),Ct.debugOverlayTexture.bind(Ht.LINEAR,Ht.CLAMP_TO_EDGE)}(m,pt);const xt=pe._tileDebugTextBuffer||m.debugBuffer,Rt=pe._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,kt=pe._tileDebugTextSegments||m.debugSegments;fe.draw(_,C.TRIANGLES,ke,ze,u.ColorMode.alphaBlended,u.CullFaceMode.disabled,ua(Q,u.Color.transparent,mt),"$debug",xt,Rt,kt,null,null,null,[pe._globeTileDebugTextBuffer])}function Tf(m,l,d,_){el(m,0,l+d/2,m.transform.width,d,_)}function Qd(m,l,d,_){el(m,l-d/2,0,d,m.transform.height,_)}function el(m,l,d,_,x,C){const F=m.context,G=F.gl;G.enable(G.SCISSOR_TEST),G.scissor(l*u.exported.devicePixelRatio,d*u.exported.devicePixelRatio,_*u.exported.devicePixelRatio,x*u.exported.devicePixelRatio),F.clear({color:C}),G.disable(G.SCISSOR_TEST)}const Ou=u.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Fg}=Ou;function ea(m,l,d,_){m.emplaceBack(l,d,_)}class Vc{constructor(l){this.vertexArray=new u.StructArrayLayout3f12,this.indices=new u.StructArrayLayout3ui6,ea(this.vertexArray,-1,-1,1),ea(this.vertexArray,1,-1,1),ea(this.vertexArray,-1,1,1),ea(this.vertexArray,1,1,1),ea(this.vertexArray,-1,-1,-1),ea(this.vertexArray,1,-1,-1),ea(this.vertexArray,-1,1,-1),ea(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=l.createVertexBuffer(this.vertexArray,Fg),this.indexBuffer=l.createIndexBuffer(this.indices),this.segment=u.SegmentVector.simpleSegment(0,0,36,12)}}function jc(m,l,d,_,x,C){const F=m.gl,G=l.paint.get("sky-atmosphere-color"),Q=l.paint.get("sky-atmosphere-halo-color"),fe=l.paint.get("sky-atmosphere-sun-intensity"),pe={u_matrix_3f:u.fromMat4(u.create$1(),_),u_sun_direction:x,u_sun_intensity:fe,u_color_tint_r:[($e=G).r,$e.g,$e.b,$e.a],u_color_tint_m:[(qe=Q).r,qe.g,qe.b,qe.a],u_luminance:5e-5};var $e,qe;F.framebufferTexture2D(F.FRAMEBUFFER,F.COLOR_ATTACHMENT0,F.TEXTURE_CUBE_MAP_POSITIVE_X+C,l.skyboxTexture,0),d.draw(m,F.TRIANGLES,u.DepthMode.disabled,u.StencilMode.disabled,u.ColorMode.unblended,u.CullFaceMode.frontCW,pe,"skyboxCapture",l.skyboxGeometry.vertexBuffer,l.skyboxGeometry.indexBuffer,l.skyboxGeometry.segment)}const Df=u.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Yn{constructor(l){const d=new u.StructArrayLayout5f20;d.emplaceBack(-1,1,1,0,0),d.emplaceBack(1,1,1,1,0),d.emplaceBack(1,-1,1,1,1),d.emplaceBack(-1,-1,1,0,1);const _=new u.StructArrayLayout3ui6;_.emplaceBack(0,1,2),_.emplaceBack(2,3,0),this.vertexBuffer=l.createVertexBuffer(d,Df.members),this.indexBuffer=l.createIndexBuffer(_),this.segments=u.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ru={symbol:function(m,l,d,_,x){if("translucent"!==m.renderPass)return;const C=u.StencilMode.disabled,F=m.colorModeForRenderPass();d.layout.get("text-variable-anchor")&&function(G,Q,fe,pe,ke,ze,We){const $e=Q.transform,qe="map"===ke,Ue="map"===ze;for(const He of G){const Je=pe.getTile(He),Ye=Je.getBucket(fe);if(!Ye||!Ye.text||!Ye.text.segments.get().length)continue;const rt=u.evaluateSizeForZoom(Ye.textSizeData,$e.zoom),mt=So(He,Ye.getProjection(),$e),pt=$e.calculatePixelsToTileUnitsMatrix(Je),xt=vs(mt,Je.tileID.canonical,Ue,qe,$e,Ye.getProjection(),pt),Rt="none"!==fe.layout.get("icon-text-fit")&&Ye.hasIconData();if(rt){const kt=Math.pow(2,$e.zoom-Je.tileID.overscaledZ);Sf(Ye,qe,Ue,We,u.symbolSize,$e,xt,He,kt,rt,Rt)}}}(_,m,d,l,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),x),0!==d.paint.get("icon-opacity").constantOr(1)&&Ao(m,l,d,_,!1,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),d.layout.get("icon-rotation-alignment"),d.layout.get("icon-pitch-alignment"),d.layout.get("icon-keep-upright"),C,F),0!==d.paint.get("text-opacity").constantOr(1)&&Ao(m,l,d,_,!0,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),d.layout.get("text-keep-upright"),C,F),l.map.showCollisionBoxes&&(Oh(m,l,d,_,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),Oh(m,l,d,_,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(m,l,d,_){if("translucent"!==m.renderPass)return;const x=d.paint.get("circle-opacity"),C=d.paint.get("circle-stroke-width"),F=d.paint.get("circle-stroke-opacity"),G=void 0!==d.layout.get("circle-sort-key").constantOr(1);if(0===x.constantOr(1)&&(0===C.constantOr(1)||0===F.constantOr(1)))return;const Q=m.context,fe=Q.gl,pe=m.transform,ke=m.depthModeForSublayer(0,u.DepthMode.ReadOnly),ze=u.StencilMode.disabled,We=m.colorModeForRenderPass(),$e="globe"===pe.projection.name,qe=[u.mercatorXfromLng(pe.center.lng),u.mercatorYfromLat(pe.center.lat)],Ue=[];for(let Je=0;Je<_.length;Je++){const Ye=_[Je],rt=l.getTile(Ye),mt=rt.getBucket(d);if(!mt||mt.projection.name!==pe.projection.name)continue;const pt=mt.programConfigurations.get(d.id),xt=qr(d);$e&&xt.push("PROJECTION_GLOBE_VIEW");const Rt=m.useProgram("circle",pt,xt),kt=mt.layoutVertexBuffer,Ct=mt.globeExtVertexBuffer,si=mt.indexBuffer,At=pe.projection.createInversionMatrix(pe,Ye.canonical),Ht={programConfiguration:pt,program:Rt,layoutVertexBuffer:kt,globeExtVertexBuffer:Ct,indexBuffer:si,uniformValues:Tl(m,Ye,rt,At,qe,d),tile:rt};if(G){const Ft=mt.segments.get();for(const ei of Ft)Ue.push({segments:new u.SegmentVector([ei]),sortKey:ei.sortKey,state:Ht})}else Ue.push({segments:mt.segments,sortKey:0,state:Ht})}G&&Ue.sort((Je,Ye)=>Je.sortKey-Ye.sortKey);const He={useDepthForOcclusion:!$e};for(const Je of Ue){const{programConfiguration:Ye,program:rt,layoutVertexBuffer:mt,globeExtVertexBuffer:pt,indexBuffer:xt,uniformValues:Rt,tile:kt}=Je.state,Ct=Je.segments;m.terrain&&m.terrain.setupElevationDraw(kt,rt,He),m.prepareDrawProgram(Q,rt,kt.tileID.toUnwrapped()),rt.draw(Q,fe.TRIANGLES,ke,ze,We,u.CullFaceMode.disabled,Rt,d.id,mt,xt,Ct,d.paint,pe.zoom,Ye,[pt])}},heatmap:function(m,l,d,_){if(0!==d.paint.get("heatmap-opacity"))if("offscreen"===m.renderPass){const x=m.context,C=x.gl,F=u.StencilMode.disabled,G=new u.ColorMode([C.ONE,C.ONE],u.Color.transparent,[!0,!0,!0,!0]);(function(We,$e,qe,Ue){const He=We.gl,Je=$e.width*Ue,Ye=$e.height*Ue;We.activeTexture.set(He.TEXTURE1),We.viewport.set([0,0,Je,Ye]);let rt=qe.heatmapFbo;if(!rt||rt&&(rt.width!==Je||rt.height!==Ye)){rt&&rt.destroy();const mt=He.createTexture();He.bindTexture(He.TEXTURE_2D,mt),He.texParameteri(He.TEXTURE_2D,He.TEXTURE_WRAP_S,He.CLAMP_TO_EDGE),He.texParameteri(He.TEXTURE_2D,He.TEXTURE_WRAP_T,He.CLAMP_TO_EDGE),He.texParameteri(He.TEXTURE_2D,He.TEXTURE_MIN_FILTER,He.LINEAR),He.texParameteri(He.TEXTURE_2D,He.TEXTURE_MAG_FILTER,He.LINEAR),rt=qe.heatmapFbo=We.createFramebuffer(Je,Ye,!1),function(pt,xt,Rt,kt,Ct,si){const At=pt.gl;At.texImage2D(At.TEXTURE_2D,0,At.RGBA,Ct,si,0,At.RGBA,pt.extRenderToTextureHalfFloat?pt.extTextureHalfFloat.HALF_FLOAT_OES:At.UNSIGNED_BYTE,null),kt.colorAttachment.set(Rt)}(We,0,mt,rt,Je,Ye)}else He.bindTexture(He.TEXTURE_2D,rt.colorAttachment.get()),We.bindFramebuffer.set(rt.framebuffer)})(x,m,d,"globe"===m.transform.projection.name?.5:.25),x.clear({color:u.Color.transparent});const Q=m.transform,fe="globe"===Q.projection.name,pe=fe?["PROJECTION_GLOBE_VIEW"]:null,ke=fe?u.CullFaceMode.frontCCW:u.CullFaceMode.disabled,ze=[u.mercatorXfromLng(Q.center.lng),u.mercatorYfromLat(Q.center.lat)];for(let We=0;We<_.length;We++){const $e=_[We];if(l.hasRenderableParent($e))continue;const qe=l.getTile($e),Ue=qe.getBucket(d);if(!Ue||Ue.projection.name!==Q.projection.name)continue;const He=Ue.programConfigurations.get(d.id),Je=m.useProgram("heatmap",He,pe),{zoom:Ye}=m.transform;m.terrain&&m.terrain.setupElevationDraw(qe,Je),m.prepareDrawProgram(x,Je,$e.toUnwrapped());const rt=Q.projection.createInversionMatrix(Q,$e.canonical);Je.draw(x,C.TRIANGLES,u.DepthMode.disabled,F,G,ke,ac(m,$e,qe,rt,ze,Ye,d.paint.get("heatmap-intensity")),d.id,Ue.layoutVertexBuffer,Ue.indexBuffer,Ue.segments,d.paint,m.transform.zoom,He,fe?[Ue.globeExtVertexBuffer]:null)}x.viewport.set([0,0,m.width,m.height])}else"translucent"===m.renderPass&&(m.context.setColorMode(m.colorModeForRenderPass()),function(x,C){const F=x.context,G=F.gl,Q=C.heatmapFbo;if(!Q)return;F.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,Q.colorAttachment.get()),F.activeTexture.set(G.TEXTURE1);let fe=C.colorRampTexture;fe||(fe=C.colorRampTexture=new u.Texture(F,C.colorRamp,G.RGBA)),fe.bind(G.LINEAR,G.CLAMP_TO_EDGE),x.useProgram("heatmapTexture").draw(F,G.TRIANGLES,u.DepthMode.disabled,u.StencilMode.disabled,x.colorModeForRenderPass(),u.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:C.paint.get("heatmap-opacity")},C.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,C.paint,x.transform.zoom)}(m,d))},line:function(m,l,d,_){if("translucent"!==m.renderPass)return;const x=d.paint.get("line-opacity"),C=d.paint.get("line-width");if(0===x.constantOr(1)||0===C.constantOr(1))return;const F=m.depthModeForSublayer(0,u.DepthMode.ReadOnly),G=m.colorModeForRenderPass(),Q=m.terrain&&m.terrain.renderingToTexture?1:u.exported.devicePixelRatio,fe=d.paint.get("line-dasharray"),pe=fe.constantOr(1),ke=d.layout.get("line-cap"),ze=d.paint.get("line-pattern"),We=ze.constantOr(1),$e=d.paint.get("line-gradient"),qe=We?"linePattern":"line",Ue=m.context,He=Ue.gl,Je=(rt=>{const mt=[];Al(rt)&&mt.push("RENDER_LINE_DASH"),rt.paint.get("line-gradient")&&mt.push("RENDER_LINE_GRADIENT");const pt=rt.paint.get("line-trim-offset");0===pt[0]&&0===pt[1]||mt.push("RENDER_LINE_TRIM_OFFSET");const xt=rt.paint.get("line-pattern").constantOr(1),Rt=1!==rt.paint.get("line-opacity").constantOr(1);return!xt&&Rt&&mt.push("RENDER_LINE_ALPHA_DISCARD"),mt})(d);let Ye=Je.includes("RENDER_LINE_ALPHA_DISCARD");m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(Ye=!1);for(const rt of _){const mt=l.getTile(rt);if(We&&!mt.patternsLoaded())continue;const pt=mt.getBucket(d);if(!pt)continue;m.prepareDrawTile();const xt=pt.programConfigurations.get(d.id),Rt=m.useProgram(qe,xt,Je),kt=ze.constantOr(null);if(kt&&mt.imageAtlas){const Zt=mt.imageAtlas.patternPositions[kt.toString()];Zt&&xt.setConstantPatternPositions(Zt)}const Ct=fe.constantOr(null),si=ke.constantOr(null);if(!We&&Ct&&si&&mt.lineAtlas){const Zt=mt.lineAtlas.getDash(Ct,si);Zt&&xt.setConstantPatternPositions(Zt)}let[At,Ht]=d.paint.get("line-trim-offset");("round"===si||"square"===si)&&At!==Ht&&(0===At&&(At-=1),1===Ht&&(Ht+=1));const Ft=m.terrain?rt.projMatrix:null,ei=We?Js(m,mt,d,Ft,Q):Dl(m,mt,d,Ft,pt.lineClipsArray.length,Q,[At,Ht]);if($e){const Zt=pt.gradients[d.id];let li=Zt.texture;if(d.gradientVersion!==Zt.version){let St=256;if(d.stepInterpolant){const Lt=l.getSource().maxzoom,Ti=rt.canonical.z===Lt?Math.ceil(1<<m.transform.maxZoom-rt.canonical.z):1;St=u.clamp(u.nextPowerOfTwo(pt.maxLineLength/u.EXTENT*1024*Ti),256,Ue.maxTextureSize)}Zt.gradient=u.renderColorRamp({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:St,image:Zt.gradient||void 0,clips:pt.lineClipsArray}),Zt.texture?Zt.texture.update(Zt.gradient):Zt.texture=new u.Texture(Ue,Zt.gradient,He.RGBA),Zt.version=d.gradientVersion,li=Zt.texture}Ue.activeTexture.set(He.TEXTURE1),li.bind(d.stepInterpolant?He.NEAREST:He.LINEAR,He.CLAMP_TO_EDGE)}pe&&(Ue.activeTexture.set(He.TEXTURE0),mt.lineAtlasTexture.bind(He.LINEAR,He.REPEAT),xt.updatePaintBuffers()),We&&(Ue.activeTexture.set(He.TEXTURE0),mt.imageAtlasTexture.bind(He.LINEAR,He.CLAMP_TO_EDGE),xt.updatePaintBuffers()),m.prepareDrawProgram(Ue,Rt,rt.toUnwrapped());const zt=Zt=>{Rt.draw(Ue,He.TRIANGLES,F,Zt,G,u.CullFaceMode.disabled,ei,d.id,pt.layoutVertexBuffer,pt.indexBuffer,pt.segments,d.paint,m.transform.zoom,xt,[pt.layoutVertexBuffer2])};if(Ye){const Zt=m.stencilModeForClipping(rt).ref;0===Zt&&m.terrain&&Ue.clear({stencil:0});const li={func:He.EQUAL,mask:255};ei.u_alpha_discard_threshold=.8,zt(new u.StencilMode(li,Zt,255,He.KEEP,He.KEEP,He.INVERT)),ei.u_alpha_discard_threshold=0,zt(new u.StencilMode(li,Zt,255,He.KEEP,He.KEEP,He.KEEP))}else zt(m.stencilModeForClipping(rt))}Ye&&(m.resetStencilClippingMasks(),m.terrain&&Ue.clear({stencil:0}))},fill:function(m,l,d,_){const x=d.paint.get("fill-color"),C=d.paint.get("fill-opacity");if(0===C.constantOr(1))return;const F=m.colorModeForRenderPass(),G=d.paint.get("fill-pattern"),Q=m.opaquePassEnabledForLayer()&&!G.constantOr(1)&&1===x.constantOr(u.Color.transparent).a&&1===C.constantOr(0)?"opaque":"translucent";if(m.renderPass===Q){const fe=m.depthModeForSublayer(1,"opaque"===m.renderPass?u.DepthMode.ReadWrite:u.DepthMode.ReadOnly);Rh(m,l,d,_,fe,F,!1)}if("translucent"===m.renderPass&&d.paint.get("fill-antialias")){const fe=m.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,u.DepthMode.ReadOnly);Rh(m,l,d,_,fe,F,!0)}},"fill-extrusion":function(m,l,d,_){const x=d.paint.get("fill-extrusion-opacity");if(0!==x&&"translucent"===m.renderPass){const C=new u.DepthMode(m.context.gl.LEQUAL,u.DepthMode.ReadWrite,m.depthRangeFor3D);if(1!==x||d.paint.get("fill-extrusion-pattern").constantOr(1))zc(m,l,d,_,C,u.StencilMode.disabled,u.ColorMode.disabled),zc(m,l,d,_,C,m.stencilModeFor3D(),m.colorModeForRenderPass()),m.resetStencilClippingMasks();else{const F=m.colorModeForRenderPass();zc(m,l,d,_,C,u.StencilMode.disabled,F)}}},hillshade:function(m,l,d,_){if("offscreen"!==m.renderPass&&"translucent"!==m.renderPass)return;const x=m.context,C=m.depthModeForSublayer(0,u.DepthMode.ReadOnly),F=m.colorModeForRenderPass(),G=m.terrain&&m.terrain.renderingToTexture,[Q,fe]="translucent"!==m.renderPass||G?[{},_]:m.stencilConfigForOverlap(_);for(const pe of fe){const ke=l.getTile(pe);if(ke.needsHillshadePrepare&&"offscreen"===m.renderPass)Qs(m,ke,d,C,u.StencilMode.disabled,F);else if("translucent"===m.renderPass){const ze=G&&m.terrain?m.terrain.stencilModeForRTTOverlap(pe):Q[pe.overscaledZ];Ah(m,pe,ke,d,C,ze,F)}}x.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,l,d,_,x,C){if("translucent"!==m.renderPass||0===d.paint.get("raster-opacity")||!_.length)return;const F=m.context,G=F.gl,Q=l.getSource(),fe=m.useProgram("raster"),pe=m.colorModeForRenderPass(),ke=m.terrain&&m.terrain.renderingToTexture,[ze,We]=Q instanceof gt||ke?[{},_]:m.stencilConfigForOverlap(_),$e=We[We.length-1].overscaledZ,qe=!m.options.moving;for(const Ue of We){const He=ke?u.DepthMode.disabled:m.depthModeForSublayer(Ue.overscaledZ-$e,1===d.paint.get("raster-opacity")?u.DepthMode.ReadWrite:u.DepthMode.ReadOnly,G.LESS),Je=Ue.toUnwrapped(),Ye=l.getTile(Ue);if(ke&&(!Ye||!Ye.hasData()))continue;const rt=ke?Ue.projMatrix:m.transform.calculateProjMatrix(Je,qe),mt=m.terrain&&ke?m.terrain.stencilModeForRTTOverlap(Ue):ze[Ue.overscaledZ],pt=C?0:d.paint.get("raster-fade-duration");Ye.registerFadeDuration(pt);const xt=l.findLoadedParent(Ue,0),Rt=Ih(Ye,xt,l,m.transform,pt);let kt,Ct;m.terrain&&m.terrain.prepareDrawTile();const si="nearest"===d.paint.get("raster-resampling")?G.NEAREST:G.LINEAR;F.activeTexture.set(G.TEXTURE0),Ye.texture.bind(si,G.CLAMP_TO_EDGE),F.activeTexture.set(G.TEXTURE1),xt?(xt.texture.bind(si,G.CLAMP_TO_EDGE),kt=Math.pow(2,xt.tileID.overscaledZ-Ye.tileID.overscaledZ),Ct=[Ye.tileID.canonical.x*kt%1,Ye.tileID.canonical.y*kt%1]):Ye.texture.bind(si,G.CLAMP_TO_EDGE);const At=lc(rt,Ct||[0,0],kt||1,Rt,d,Q instanceof gt?Q.perspectiveTransform:[0,0]);if(m.prepareDrawProgram(F,fe,Je),Q instanceof gt)Q.boundsBuffer&&Q.boundsSegments&&fe.draw(F,G.TRIANGLES,He,u.StencilMode.disabled,pe,u.CullFaceMode.disabled,At,d.id,Q.boundsBuffer,m.quadTriangleIndexBuffer,Q.boundsSegments);else{const{tileBoundsBuffer:Ht,tileBoundsIndexBuffer:Ft,tileBoundsSegments:ei}=m.getTileBoundsBuffers(Ye);fe.draw(F,G.TRIANGLES,He,mt,pe,u.CullFaceMode.disabled,At,d.id,Ht,Ft,ei)}}m.resetStencilClippingMasks()},background:function(m,l,d,_){const x=d.paint.get("background-color"),C=d.paint.get("background-opacity");if(0===C)return;const F=m.context,G=F.gl,Q=m.transform,fe=Q.tileSize,pe=d.paint.get("background-pattern");if(m.isPatternMissing(pe))return;const ke=!pe&&1===x.a&&1===C&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==ke)return;const ze=u.StencilMode.disabled,We=m.depthModeForSublayer(0,"opaque"===ke?u.DepthMode.ReadWrite:u.DepthMode.ReadOnly),$e=m.colorModeForRenderPass(),qe=m.useProgram(pe?"backgroundPattern":"background");let Ue,He=_;He||(Ue=m.getBackgroundTiles(),He=Object.values(Ue).map(Je=>Je.tileID)),pe&&(F.activeTexture.set(G.TEXTURE0),m.imageManager.bind(m.context));for(const Je of He){const Ye=Je.toUnwrapped(),rt=_?Je.projMatrix:m.transform.calculateProjMatrix(Ye);m.prepareDrawTile();const mt=l?l.getTile(Je):Ue?Ue[Je.key]:new u.Tile(Je,fe,Q.zoom,m),pt=pe?Bc(rt,C,m,pe,{tileID:Je,tileSize:fe}):Pg(rt,C,x);m.prepareDrawProgram(F,qe,Ye);const{tileBoundsBuffer:xt,tileBoundsIndexBuffer:Rt,tileBoundsSegments:kt}=m.getTileBoundsBuffers(mt);qe.draw(F,G.TRIANGLES,We,ze,$e,u.CullFaceMode.disabled,pt,d.id,xt,Rt,kt)}},sky:function(m,l,d){const _=m.transform,x="mercator"===_.projection.name||"globe"===_.projection.name?1:u.smoothstep(7,8,_.zoom),C=d.paint.get("sky-opacity")*x;if(0===C)return;const F=m.context,G=d.paint.get("sky-type"),Q=new u.DepthMode(F.gl.LEQUAL,u.DepthMode.ReadOnly,[0,1]),fe=m.frameCounter/1e3%1;"atmosphere"===G?"offscreen"===m.renderPass?d.needsSkyboxCapture(m)&&(function(pe,ke,ze,We){const $e=pe.context,qe=$e.gl;let Ue=ke.skyboxFbo;if(!Ue){Ue=ke.skyboxFbo=$e.createFramebuffer(32,32,!1),ke.skyboxGeometry=new Vc($e),ke.skyboxTexture=$e.gl.createTexture(),qe.bindTexture(qe.TEXTURE_CUBE_MAP,ke.skyboxTexture),qe.texParameteri(qe.TEXTURE_CUBE_MAP,qe.TEXTURE_WRAP_S,qe.CLAMP_TO_EDGE),qe.texParameteri(qe.TEXTURE_CUBE_MAP,qe.TEXTURE_WRAP_T,qe.CLAMP_TO_EDGE),qe.texParameteri(qe.TEXTURE_CUBE_MAP,qe.TEXTURE_MIN_FILTER,qe.LINEAR),qe.texParameteri(qe.TEXTURE_CUBE_MAP,qe.TEXTURE_MAG_FILTER,qe.LINEAR);for(let rt=0;rt<6;++rt)qe.texImage2D(qe.TEXTURE_CUBE_MAP_POSITIVE_X+rt,0,qe.RGBA,32,32,0,qe.RGBA,qe.UNSIGNED_BYTE,null)}$e.bindFramebuffer.set(Ue.framebuffer),$e.viewport.set([0,0,32,32]);const He=ke.getCenter(pe,!0),Je=pe.useProgram("skyboxCapture"),Ye=new Float64Array(16);u.identity(Ye),u.rotateY(Ye,Ye,.5*-Math.PI),jc($e,ke,Je,Ye,He,0),u.identity(Ye),u.rotateY(Ye,Ye,.5*Math.PI),jc($e,ke,Je,Ye,He,1),u.identity(Ye),u.rotateX(Ye,Ye,.5*-Math.PI),jc($e,ke,Je,Ye,He,2),u.identity(Ye),u.rotateX(Ye,Ye,.5*Math.PI),jc($e,ke,Je,Ye,He,3),u.identity(Ye),jc($e,ke,Je,Ye,He,4),u.identity(Ye),u.rotateY(Ye,Ye,Math.PI),jc($e,ke,Je,Ye,He,5),$e.viewport.set([0,0,pe.width,pe.height])}(m,d),d.markSkyboxValid(m)):"sky"===m.renderPass&&function(pe,ke,ze,We,$e){const qe=pe.context,Ue=qe.gl,He=pe.transform,Je=pe.useProgram("skybox");qe.activeTexture.set(Ue.TEXTURE0),Ue.bindTexture(Ue.TEXTURE_CUBE_MAP,ke.skyboxTexture);const Ye={u_matrix:He.skyboxMatrix,u_sun_direction:ke.getCenter(pe,!1),u_cubemap:0,u_opacity:We,u_temporal_offset:$e};pe.prepareDrawProgram(qe,Je),Je.draw(qe,Ue.TRIANGLES,ze,u.StencilMode.disabled,pe.colorModeForRenderPass(),u.CullFaceMode.backCW,Ye,"skybox",ke.skyboxGeometry.vertexBuffer,ke.skyboxGeometry.indexBuffer,ke.skyboxGeometry.segment)}(m,d,Q,C,fe):"gradient"===G&&"sky"===m.renderPass&&function(pe,ke,ze,We,$e){const qe=pe.context,Ue=qe.gl,He=pe.transform,Je=pe.useProgram("skyboxGradient");ke.skyboxGeometry||(ke.skyboxGeometry=new Vc(qe)),qe.activeTexture.set(Ue.TEXTURE0);let Ye=ke.colorRampTexture;Ye||(Ye=ke.colorRampTexture=new u.Texture(qe,ke.colorRamp,Ue.RGBA)),Ye.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE);const rt=(mt=He.skyboxMatrix,pt=ke.getCenter(pe,!1),xt=ke.paint.get("sky-gradient-radius"),Rt=We,kt=$e,{u_matrix:mt,u_color_ramp:0,u_center_direction:pt,u_radius:u.degToRad(xt),u_opacity:Rt,u_temporal_offset:kt});var mt,pt,xt,Rt,kt;pe.prepareDrawProgram(qe,Je),Je.draw(qe,Ue.TRIANGLES,ze,u.StencilMode.disabled,pe.colorModeForRenderPass(),u.CullFaceMode.backCW,rt,"skyboxGradient",ke.skyboxGeometry.vertexBuffer,ke.skyboxGeometry.indexBuffer,ke.skyboxGeometry.segment)}(m,d,Q,C,fe)},debug:function(m,l,d){for(let _=0;_<d.length;_++)Lg(m,l,d[_])},custom:function(m,l,d){const _=m.context,x=d.implementation;if(m.transform.projection.unsupportedLayers&&m.transform.projection.unsupportedLayers.includes("custom"))u.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if("offscreen"===m.renderPass){const C=x.prerender;C&&(m.setCustomLayerDefaults(),_.setColorMode(m.colorModeForRenderPass()),C.call(x,_.gl,m.transform.customLayerMatrix()),_.setDirty(),m.setBaseState())}else if("translucent"===m.renderPass){m.setCustomLayerDefaults(),_.setColorMode(m.colorModeForRenderPass()),_.setStencilMode(u.StencilMode.disabled);const C="3d"===x.renderingMode?new u.DepthMode(m.context.gl.LEQUAL,u.DepthMode.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,u.DepthMode.ReadOnly);_.setDepthMode(C),x.render(_.gl,m.transform.customLayerMatrix()),_.setDirty(),m.setBaseState(),_.bindFramebuffer.set(null)}}};class wv{constructor(l,d){this.context=new Ae(l),this.transform=d,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=u.SourceCache.maxUnderzooming+u.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new El,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(l,d){const _=!!l&&!!l.terrain&&this.transform.projection.supportsTerrain;if(!(_||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Ho(this,l));const x=this._terrain;this.transform.elevation=_?x:null,x.update(l,this.transform,d)}_updateFog(l){const d=l.fog;if(!d||"globe"===this.transform.projection.name||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[_,x]=d.getFovAdjustedRange(this.transform._fov);if(_>x)return void(this.transform.fogCullDistSq=null);const C=_+.78*(x-_);this.transform.fogCullDistSq=C*C}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(l,d){if(this.width=l*u.exported.devicePixelRatio,this.height=d*u.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style.order)this.style._layers[_].resize()}setup(){const l=this.context,d=new u.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(u.EXTENT,0),d.emplaceBack(0,u.EXTENT),d.emplaceBack(u.EXTENT,u.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(d,u.posAttributes.members),this.tileExtentSegments=u.SegmentVector.simpleSegment(0,0,4,2);const _=new u.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(u.EXTENT,0),_.emplaceBack(0,u.EXTENT),_.emplaceBack(u.EXTENT,u.EXTENT),this.debugBuffer=l.createVertexBuffer(_,u.posAttributes.members),this.debugSegments=u.SegmentVector.simpleSegment(0,0,4,5);const x=new u.StructArrayLayout2i4;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(x,u.posAttributes.members),this.viewportSegments=u.SegmentVector.simpleSegment(0,0,4,2);const C=new u.StructArrayLayout4i8;C.emplaceBack(0,0,0,0),C.emplaceBack(u.EXTENT,0,u.EXTENT,0),C.emplaceBack(0,u.EXTENT,0,u.EXTENT),C.emplaceBack(u.EXTENT,u.EXTENT,u.EXTENT,u.EXTENT),this.mercatorBoundsBuffer=l.createVertexBuffer(C,u.boundsAttributes.members),this.mercatorBoundsSegments=u.SegmentVector.simpleSegment(0,0,4,2);const F=new u.StructArrayLayout3ui6;F.emplaceBack(0,1,2),F.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(F);const G=new u.StructArrayLayout1ui2;for(const fe of[0,1,3,2,0])G.emplaceBack(fe);this.debugIndexBuffer=l.createIndexBuffer(G),this.emptyTexture=new u.Texture(l,new u.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),l.gl.RGBA),this.identityMat=u.create();const Q=this.context.gl;this.stencilClearMode=new u.StencilMode({func:Q.ALWAYS,mask:0},0,255,Q.ZERO,Q.ZERO,Q.ZERO),this.loadTimeStamps.push(u.window.performance.now()),this.atmosphereBuffer=new Yn(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(l){return l._makeTileBoundsBuffers(this.context,this.transform.projection),l._tileBoundsBuffer?{tileBoundsBuffer:l._tileBoundsBuffer,tileBoundsIndexBuffer:l._tileBoundsIndexBuffer,tileBoundsSegments:l._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const l=this.context,d=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(l,d.TRIANGLES,u.DepthMode.disabled,this.stencilClearMode,u.ColorMode.disabled,u.CullFaceMode.disabled,kh(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(l,d,_){if(!d||this.currentStencilSource===d.id||!l.isTileClipped()||!_||0===_.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let G=!1;for(const Q of _)if(void 0===this._tileClippingMaskIDs[Q.key]){G=!0;break}if(!G)return}this.currentStencilSource=d.id;const x=this.context,C=x.gl;this.nextStencilID+_.length>256&&this.clearStencil(),x.setColorMode(u.ColorMode.disabled),x.setDepthMode(u.DepthMode.disabled);const F=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const G of _){const Q=d.getTile(G),fe=this._tileClippingMaskIDs[G.key]=this.nextStencilID++,{tileBoundsBuffer:pe,tileBoundsIndexBuffer:ke,tileBoundsSegments:ze}=this.getTileBoundsBuffers(Q);F.draw(x,C.TRIANGLES,u.DepthMode.disabled,new u.StencilMode({func:C.ALWAYS,mask:0},fe,255,C.KEEP,C.KEEP,C.REPLACE),u.ColorMode.disabled,u.CullFaceMode.disabled,kh(G.projMatrix),"$clipping",pe,ke,ze)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,d=this.context.gl;return new u.StencilMode({func:d.NOTEQUAL,mask:255},l,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(l){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(l);const d=this.context.gl;return new u.StencilMode({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(l){const d=this.context.gl,_=l.sort((F,G)=>G.overscaledZ-F.overscaledZ),x=_[_.length-1].overscaledZ,C=_[0].overscaledZ-x+1;if(C>1){this.currentStencilSource=void 0,this.nextStencilID+C>256&&this.clearStencil();const F={};for(let G=0;G<C;G++)F[G+x]=new u.StencilMode({func:d.GEQUAL,mask:255},G+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=C,[F,_]}return[{[x]:u.StencilMode.disabled},_]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new u.ColorMode([l.CONSTANT_COLOR,l.ONE],new u.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?u.ColorMode.unblended:u.ColorMode.alphaBlended}depthModeForSublayer(l,d,_){if(!this.opaquePassEnabledForLayer())return u.DepthMode.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new u.DepthMode(_||this.context.gl.LEQUAL,d,[x,x])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,d){this.style=l,this.options=d,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(u.exported.now()),this.imageManager.beginFrame();const _=this.style.order,x=this.style._sourceCaches;for(const Q in x){const fe=x[Q];fe.used&&fe.prepare(this.context)}const C={},F={},G={};for(const Q in x){const fe=x[Q];C[Q]=fe.getVisibleCoordinates(),F[Q]=C[Q].slice().reverse(),G[Q]=fe.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Q=0;Q<_.length;Q++)if(this.style._layers[_[Q]].is3D()){this.opaquePassCutoff=Q;break}if(this.terrain&&(this.terrain.updateTileBinding(G),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new u.GlobeSharedBuffers(this.context)),u.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const Q of _){const fe=this.style._layers[Q],pe=l._getLayerSourceCache(fe);if(!fe.hasOffscreenPass()||fe.isHidden(this.transform.zoom))continue;const ke=pe?F[pe.id]:void 0;("custom"===fe.type||fe.isSky()||ke&&ke.length)&&this.renderLayer(this,pe,fe,ke)}if(this.depthRangeFor3D=[0,1-(l.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:d.showOverdrawInspector?u.Color.black:u.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const Q=this.style._layers[_[this.currentLayer]],fe=l._getLayerSourceCache(Q);if(Q.isSky())continue;const pe=fe?F[fe.id]:void 0;this._renderTileClippingMasks(Q,fe,pe),this.renderLayer(this,fe,Q,pe)}if(this.style.fog&&this.transform.projection.supportsFog&&function(Q,fe){const pe=Q.context,ke=pe.gl,ze=Q.transform,We=new u.DepthMode(ke.LEQUAL,u.DepthMode.ReadOnly,[0,1]),$e=Q.useProgram("globeAtmosphere",null,"globe"===ze.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),qe=u.globeToMercatorTransition(ze.zoom),Ue=fe.properties.get("color").toArray01(),He=fe.properties.get("high-color").toArray01(),Je=fe.properties.get("space-color").toArray01PremultipliedAlpha(),Ye=u.identity$1([]);u.rotateY$1(Ye,Ye,-u.degToRad(ze._center.lng)),u.rotateX$1(Ye,Ye,u.degToRad(ze._center.lat)),u.rotateZ$1(Ye,Ye,ze.angle),u.rotateX$1(Ye,Ye,-ze._pitch);const rt=u.fromQuat(new Float32Array(16),Ye),mt=u.mapValue(fe.properties.get("star-intensity"),0,1,0,.25),xt=u.mapValue(fe.properties.get("horizon-blend"),0,1,5e-4,.25),Rt=u.globeUseCustomAntiAliasing(Q,pe,ze)&&5e-4===xt?ze.worldSize/(2*Math.PI*1.025)-1:ze.globeRadius,kt=Q.frameCounter/1e3%1,Ct=u.length(ze.globeCenterInViewSpace),si=Math.sqrt(Math.pow(Ct,2)-Math.pow(Rt,2)),At=Math.acos(si/Ct),Ht={u_frustum_tl:ze.frustumCorners.TL,u_frustum_tr:ze.frustumCorners.TR,u_frustum_br:ze.frustumCorners.BR,u_frustum_bl:ze.frustumCorners.BL,u_horizon:ze.frustumCorners.horizon,u_transition:qe,u_fadeout_range:xt,u_color:Ue,u_high_color:He,u_space_color:Je,u_star_intensity:mt,u_star_size:5*u.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:kt,u_horizon_angle:At,u_rotation_matrix:rt};Q.prepareDrawProgram(pe,$e);const Ft=Q.atmosphereBuffer;Ft&&$e.draw(pe,ke.TRIANGLES,We,u.StencilMode.disabled,u.ColorMode.alphaBlended,u.CullFaceMode.backCW,Ht,"skybox",Ft.vertexBuffer,Ft.indexBuffer,Ft.segments)}(this,this.style.fog),this.renderPass="sky",(u.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const Q=this.style._layers[_[this.currentLayer]],fe=l._getLayerSourceCache(Q);Q.isSky()&&this.renderLayer(this,fe,Q,fe?F[fe.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<_.length;){const Q=this.style._layers[_[this.currentLayer]],fe=l._getLayerSourceCache(Q);if(Q.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(Q)){if(Q.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const pe=fe?("symbol"===Q.type?G:F)[fe.id]:void 0;this._renderTileClippingMasks(Q,fe,fe?C[fe.id]:void 0),this.renderLayer(this,fe,Q,pe),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Q=null;u.values(this.style._layers).forEach(fe=>{const pe=l._getLayerSourceCache(fe);pe&&!fe.isHidden(this.transform.zoom)&&(!Q||Q.getSource().maxzoom<pe.getSource().maxzoom)&&(Q=pe)}),Q&&this.options.showTileBoundaries&&Ru.debug(this,Q,Q.getVisibleCoordinates())}this.options.showPadding&&function(Q){const fe=Q.transform.padding;Tf(Q,Q.transform.height-(fe.top||0),3,Og),Tf(Q,fe.bottom||0,3,bv),Qd(Q,fe.left||0,3,Zd),Qd(Q,Q.transform.width-(fe.right||0),3,Kd);const pe=Q.transform.centerPoint;var ke,ze,We,$e;el(ke=Q,(ze=pe.x)-1,(We=Q.transform.height-pe.y)-10,2,20,$e=Rg),el(ke,ze-10,We-1,20,2,$e)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(u.window.performance.now()),this.saveCanvasCopy())}}renderLayer(l,d,_,x){_.isHidden(this.transform.zoom)||("background"===_.type||"sky"===_.type||"custom"===_.type||x&&x.length)&&(this.id=_.id,this.gpuTimingStart(_),l.transform.projection.unsupportedLayers&&l.transform.projection.unsupportedLayers.includes(_.type)||Ru[_.type](l,d,_,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(l){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery;let _=this.gpuTimers[l.id];_||(_=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:d.createQueryEXT()}),_.calls++,d.beginQueryEXT(d.TIME_ELAPSED_EXT,_.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const l=this.context.extTimerQuery,d=l.createQueryEXT();this.deferredRenderGpuTimeQueries.push(d),l.beginQueryEXT(l.TIME_ELAPSED_EXT,d)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}collectGpuTimers(){const l=this.gpuTimers;return this.gpuTimers={},l}collectDeferredRenderGpuQueries(){const l=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],l}queryGpuTimers(l){const d={};for(const _ in l){const x=l[_],C=this.context.extTimerQuery,F=C.getQueryObjectEXT(x.query,C.QUERY_RESULT_EXT)/1e6;C.deleteQueryEXT(x.query),d[_]=F}return d}queryGpuTimeDeferredRender(l){if(!this.options.gpuTimingDeferredRender)return 0;const d=this.context.extTimerQuery;let _=0;for(const x of l)_+=d.getQueryObjectEXT(x,d.QUERY_RESULT_EXT)/1e6,d.deleteQueryEXT(x);return _}translatePosMatrix(l,d,_,x,C){if(!_[0]&&!_[1])return l;const F=C?"map"===x?this.transform.angle:0:"viewport"===x?-this.transform.angle:0;if(F){const fe=Math.sin(F),pe=Math.cos(F);_=[_[0]*pe-_[1]*fe,_[0]*fe+_[1]*pe]}const G=[C?_[0]:ae(d,_[0],this.transform.zoom),C?_[1]:ae(d,_[1],this.transform.zoom),0],Q=new Float32Array(16);return u.translate(Q,l,G),Q}saveTileTexture(l){const d=this._tileTextures[l.size[0]];d?d.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const d=this._tileTextures[l];return d&&d.length>0?d.pop():null}isPatternMissing(l){return null===l||void 0!==l&&!this.imageManager.getPattern(l.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const l=this.terrain&&this.terrain.renderingToTexture,d=this.terrain&&0===this.terrain.exaggeration(),_=this.style&&this.style.fog,x=[];return this.terrainRenderModeElevated()&&x.push("TERRAIN"),"globe"===this.transform.projection.name&&x.push("GLOBE"),d&&x.push("ZERO_EXAGGERATION"),_&&!l&&0!==_.getOpacity(this.transform.pitch)&&x.push("FOG"),l&&x.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&x.push("OVERDRAW_INSPECTOR"),x}useProgram(l,d,_){this.cache=this.cache||{};const x=_||[],C=this.currentGlobalDefines().concat(x),F=Do.cacheKey(Mf[l],l,C,d);return this.cache[F]||(this.cache[F]=new Do(this.context,l,Mf[l],d,Yd[l],C)),this.cache[F]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=u.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new u.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(l,d,_){if(this.terrain&&this.terrain.renderingToTexture)return;const x=this.style.fog;if(x){const C=x.getOpacity(this.transform.pitch),F=((G,Q,fe,pe,ke,ze,We,$e,qe,Ue,He)=>{const Je=G.transform,Ye=Q.properties.get("color").toArray01();Ye[3]=pe;const rt=G.frameCounter/1e3%1;return{u_fog_matrix:fe?Je.calculateFogTileMatrix(fe):G.identityMat,u_fog_range:Q.getFovAdjustedRange(Je._fov),u_fog_color:Ye,u_fog_horizon_blend:Q.properties.get("horizon-blend"),u_fog_temporal_offset:rt,u_frustum_tl:ke,u_frustum_tr:ze,u_frustum_br:We,u_frustum_bl:$e,u_globe_pos:qe,u_globe_radius:Ue,u_viewport:He,u_globe_transition:u.globeToMercatorTransition(Je.zoom),u_is_globe:+("globe"===Je.projection.name)}})(this,x,_,C,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*u.exported.devicePixelRatio,this.transform.height*u.exported.devicePixelRatio]);d.setFogUniformValues(l,F)}}setTileLoadedFlag(l){this.tileLoaded=l}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const l=this.context.gl,d=l.createTexture();return l.bindTexture(l.TEXTURE_2D,d),l.copyTexImage2D(l.TEXTURE_2D,0,l.RGBA,0,0,l.drawingBufferWidth,l.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const l=this.style&&this.style.fog;return!!l&&0!==l.getOpacity(this.transform.pitch)}getBackgroundTiles(){const l=this._backgroundTiles,d=this._backgroundTiles={},_=this.transform.coveringTiles({tileSize:512});for(const x of _)d[x.key]=l[x.key]||new u.Tile(x,512,this.transform.tileZoom,this);return d}clearBackgroundTiles(){this._backgroundTiles={}}}class Lh{constructor(l=0,d=0,_=0,x=0){if(isNaN(l)||l<0||isNaN(d)||d<0||isNaN(_)||_<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=d,this.left=_,this.right=x}interpolate(l,d,_){return null!=d.top&&null!=l.top&&(this.top=u.number(l.top,d.top,_)),null!=d.bottom&&null!=l.bottom&&(this.bottom=u.number(l.bottom,d.bottom,_)),null!=d.left&&null!=l.left&&(this.left=u.number(l.left,d.left,_)),null!=d.right&&null!=l.right&&(this.right=u.number(l.right,d.right,_)),this}getCenter(l,d){const _=u.clamp((this.left+l-this.right)/2,0,l),x=u.clamp((this.top+d-this.bottom)/2,0,d);return new u.pointGeometry(_,x)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new Lh(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function kl(m,l){const d=u.getColumn(m,3);u.fromQuat(m,l),u.setColumn(m,3,d)}function Af(m,l){const d=u.identity$1([]);return u.rotateZ$1(d,d,-l),u.rotateX$1(d,d,-m),d}function Ng(m,l){const d=[m[0],m[1],0],_=[l[0],l[1],0];if(u.length(d)>=1e-15){const F=u.normalize([],d);u.scale$2(_,F,u.dot(_,F)),l[0]=_[0],l[1]=_[1]}const x=u.cross([],l,m);if(u.len(x)<1e-15)return null;const C=Math.atan2(-x[1],x[0]);return Af(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),C)}class kf{constructor(l,d){this.position=l,this.orientation=d}get position(){return this._position}set position(l){if(l){const d=l instanceof u.MercatorCoordinate?l:new u.MercatorCoordinate(l[0],l[1],l[2]);this._renderWorldCopies&&(d.x=u.wrap(d.x,0,1)),this._position=d}else this._position=null}lookAtPoint(l,d){if(this.orientation=null,!this.position)return;const _=this._elevation?this._elevation.getAtPointOrZero(u.MercatorCoordinate.fromLngLat(l)):0,x=this.position,C=u.MercatorCoordinate.fromLngLat(l,_),F=[C.x-x.x,C.y-x.y,C.z-x.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=Ng(F,d)}setPitchBearing(l,d){this.orientation=Af(u.degToRad(l),u.degToRad(-d))}}class tl{constructor(l,d){this._transform=u.identity([]),this.orientation=d,this.position=l}get mercatorPosition(){const l=this.position;return new u.MercatorCoordinate(l[0],l[1],l[2])}get position(){const l=u.getColumn(this._transform,3);return[l[0],l[1],l[2]]}set position(l){var d;l&&u.setColumn(this._transform,3,[(d=l)[0],d[1],d[2],1])}get orientation(){return this._orientation}set orientation(l){this._orientation=l||u.identity$1([]),l&&kl(this._transform,this._orientation)}getPitchBearing(){const l=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(l[0]*l[0]+l[1]*l[1]),-l[2])}}setPitchBearing(l,d){this._orientation=Af(l,d),kl(this._transform,this._orientation)}forward(){const l=u.getColumn(this._transform,2);return[-l[0],-l[1],-l[2]]}up(){const l=u.getColumn(this._transform,1);return[-l[0],-l[1],-l[2]]}right(){const l=u.getColumn(this._transform,0);return[l[0],l[1],l[2]]}getCameraToWorld(l,d){const _=new Float64Array(16);return u.invert(_,this.getWorldToCamera(l,d)),_}getWorldToCameraPosition(l,d,_){const x=this.position;u.scale$2(x,x,-l);const C=new Float64Array(16);return u.fromScaling(C,[_,_,_]),u.translate(C,C,x),C[10]*=d,C}getWorldToCamera(l,d){const _=new Float64Array(16),x=new Float64Array(4),C=this.position;return u.conjugate(x,this._orientation),u.scale$2(C,C,-l),u.fromQuat(_,x),u.translate(_,_,C),_[1]*=-1,_[5]*=-1,_[9]*=-1,_[13]*=-1,_[8]*=d,_[9]*=d,_[10]*=d,_[11]*=d,_}getCameraToClipPerspective(l,d,_,x){const C=new Float64Array(16);return u.perspective(C,l,d,_,x),C}getDistanceToElevation(l,d=!1){const _=0===l?0:u.mercatorZfromAltitude(l,d?u.latFromMercatorY(this.position[1]):this.position[1]),x=this.forward();return(_-this.position[2])/x[2]}clone(){return new tl([...this.position],[...this.orientation])}}function Lu(m,l){const d=il(m.projection,m.zoom,m.width,m.height),_=function(C,F,G,Q,fe){const pe=new u.LngLat(G.lng-180*Il,G.lat),ke=new u.LngLat(G.lng+180*Il,G.lat),ze=C.project(pe.lng,pe.lat),We=C.project(ke.lng,ke.lat),$e=-Math.atan2(We.y-ze.y,We.x-ze.x),qe=u.MercatorCoordinate.fromLngLat(G);qe.y=u.clamp(qe.y,-.999975,.999975);const Ue=qe.toLngLat(),He=C.project(Ue.lng,Ue.lat),Je=u.MercatorCoordinate.fromLngLat(Ue);Je.x+=Il;const Ye=Je.toLngLat(),rt=C.project(Ye.lng,Ye.lat),mt=Nu(rt.x-He.x,rt.y-He.y,$e),pt=u.MercatorCoordinate.fromLngLat(Ue);pt.y+=Il;const xt=pt.toLngLat(),Rt=C.project(xt.lng,xt.lat),kt=Nu(Rt.x-He.x,Rt.y-He.y,$e),Ct=Math.abs(mt.x)/Math.abs(kt.y),si=u.identity([]);u.rotateZ(si,si,-$e*(1-(fe?0:Q)));const At=u.identity([]);return u.scale(At,At,[1,1-(1-Ct)*Q,1]),At[4]=-kt.x/kt.y*Q,u.rotateZ(At,At,$e),u.multiply(At,si,At),At}(m.projection,0,m.center,d,l),x=no(m);return u.scale(_,_,[x,x,1]),_}function no(m){const l=m.projection,d=il(m.projection,m.zoom,m.width,m.height),_=Fu(l,m.center),x=Fu(l,u.LngLat.convert(l.center));return Math.pow(2,_*d+(1-d)*x)}function il(m,l,d,_,x=1/0){const C=m.range;if(!C)return 0;const F=Math.min(x,Math.max(d,_)),G=Math.log(F/1024)/Math.LN2;return u.smoothstep(C[0]+G,C[1]+G,l)}const Il=1/4e4;function Fu(m,l){const d=u.clamp(l.lat,-u.MAX_MERCATOR_LATITUDE,u.MAX_MERCATOR_LATITUDE),_=new u.LngLat(l.lng-180*Il,d),x=new u.LngLat(l.lng+180*Il,d),C=m.project(_.lng,d),F=m.project(x.lng,d),G=u.MercatorCoordinate.fromLngLat(_),Q=u.MercatorCoordinate.fromLngLat(x),fe=F.x-C.x,pe=F.y-C.y,ke=Q.x-G.x,ze=Q.y-G.y,We=Math.sqrt((ke*ke+ze*ze)/(fe*fe+pe*pe));return Math.log(We)/Math.LN2}function Nu(m,l,d){const _=Math.cos(d),x=Math.sin(d);return{x:m*_-l*x,y:m*x+l*_}}class hc{constructor(l,d,_,x,C,F,G){this.tileSize=512,this._renderWorldCopies=void 0===C||C,this._minZoom=l||0,this._maxZoom=d||22,this._minPitch=_??0,this._maxPitch=x??60,this.setProjection(F),this.setMaxBounds(G),this.width=0,this.height=0,this._center=new u.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Lh,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new tl,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const l=new hc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return l._elevation=this._elevation,l._centerAltitude=this._centerAltitude,l._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,l.tileSize=this.tileSize,l.mercatorFromTransition=this.mercatorFromTransition,l.width=this.width,l.height=this.height,l.cameraElevationReference=this.cameraElevationReference,l._center=this._center,l._setZoom(this.zoom),l._seaLevelZoom=this._seaLevelZoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._nearZ=this._nearZ,l._farZ=this._farZ,l._averageElevation=this._averageElevation,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._camera=this._camera.clone(),l._calcMatrices(),l.freezeTileCoverage=this.freezeTileCoverage,l.frustumCorners=this.frustumCorners,l}get elevation(){return this._elevation}set elevation(l){this._elevation!==l&&(this._elevation=l,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(l,d=!1){const _=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||_)&&this._updateCameraOnTerrain(),(l||_)&&this._constrainCamera(d),this._calcMatrices()}getProjection(){return u.pick(this.projection,["name","center","parallels"])}setProjection(l){this.projectionOptions=l||{name:"mercator"};const d=this.projection?this.getProjection():void 0;this.projection=u.getProjection(this.projectionOptions);const _=!re(d,this.getProjection());return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setMercatorFromTransition(){const l=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=u.getProjection({name:"mercator"});const d=l!==this.projection.name;return d&&this._calcMatrices(),d}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(l){void 0===l?l=!0:null===l&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get cameraWorldSize(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return u.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.pointGeometry(this.width,this.height)}get bearing(){return u.wrap(this.rotation,-180,180)}set bearing(l){this.rotation=l}get rotation(){return-this.angle/Math.PI*180}set rotation(l){const d=-l*Math.PI/180;var _,x,C,F,G,Q,fe,pe,ke,ze;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=(_=new u.ARRAY_TYPE(4),u.ARRAY_TYPE!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_),x=this.rotationMatrix,F=this.angle,G=(C=this.rotationMatrix)[0],Q=C[1],fe=C[2],pe=C[3],ke=Math.sin(F),ze=Math.cos(F),x[0]=G*ze+fe*ke,x[1]=Q*ze+pe*ke,x[2]=G*-ke+fe*ze,x[3]=Q*-ke+pe*ze)}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const d=u.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const l=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/l)}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=u.degToRad(l),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(l){this._averageElevation=l,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(l){const d=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(l){this._zoom=l,this.scale=this.zoomScale(l),this.tileZoom=Math.floor(l),this.zoomFraction=l-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const l=this._elevation;this._centerAltitude=l.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=l.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const l=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],_=this.horizonLineFromTop();let x=0,C=0;for(let F=0;F<d.length;F++){const G=new u.pointGeometry(d[F][0]*this.width,_+d[F][1]*(this.height-_)),Q=l.pointCoordinate(G);if(!Q)continue;const fe=1/Math.hypot(Q[0]-this._camera.position[0],Q[1]-this._camera.position[1]);x+=Q[3]*fe,C+=fe}return 0===C?NaN:x/C}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const l=this._seaLevelZoom,d=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),_=this.pixelsPerMeter/this.worldSize*d,x=this._mercatorZfromZoom(l),C=this._mercatorZfromZoom(this._maxZoom),F=Math.max(x-_,C);this._setZoom(this._zoomFromMercatorZ(F))}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}computeZoomRelativeTo(l){const d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,l.toAltitude()));let _;_=l.z<this._camera.position[2]?[d.x,d.y,d.z]:[l.x,l.y,l.z];const x=u.length(u.sub([],this._camera.position,_));return u.clamp(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(l){if(!this.height||!l.position&&!l.orientation)return;this._updateCameraState();let d=!1;if(l.orientation&&!u.exactEquals(l.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(l.orientation)),l.position){const _=[l.position.x,l.position.y,l.position.z];u.exactEquals$1(_,this._camera.position)||(this._setCameraPosition(_),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const l=this._camera.position,d=new kf;return d.position=new u.MercatorCoordinate(l[0],l[1],l[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this.renderWorldCopies,d}_setCameraOrientation(l){if(!u.length$1(l))return!1;u.normalize$1(l,l);const d=u.transformQuat([],[0,0,-1],l),_=u.transformQuat([],[0,-1,0],l);if(_[2]<0)return!1;const x=Ng(d,_);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(l){const d=this.zoomScale(this.minZoom)*this.tileSize,_=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;l[2]=u.clamp(l[2],x/_,x/d),this._camera.position=l}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,d,_){this._unmodified=!1,this._edgeInsets.interpolate(l,d,_),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const d=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(l){const d=[new u.UnwrappedTileID(0,l)];if(this.renderWorldCopies){const _=this.pointCoordinate(new u.pointGeometry(0,0)),x=this.pointCoordinate(new u.pointGeometry(this.width,0)),C=this.pointCoordinate(new u.pointGeometry(this.width,this.height)),F=this.pointCoordinate(new u.pointGeometry(0,this.height)),G=Math.floor(Math.min(_.x,x.x,C.x,F.x)),Q=Math.floor(Math.max(_.x,x.x,C.x,F.x)),fe=1;for(let pe=G-fe;pe<=Q+fe;pe++)0!==pe&&d.push(new u.UnwrappedTileID(pe,l))}return d}coveringTiles(l){let d=this.coveringZoomLevel(l);const _=d,x=this.elevation&&!l.isTerrainDEM,C="mercator"===this.projection.name;if(void 0!==l.minzoom&&d<l.minzoom)return[];void 0!==l.maxzoom&&d>l.maxzoom&&(d=l.maxzoom);const F=this.locationCoordinate(this.center),G=this.center.lat,Q=1<<d,fe=[Q*F.x,Q*F.y,0],pe="globe"===this.projection.name,ke=!pe,ze=u.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d,ke),We=pe?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),$e=Q*u.mercatorZfromAltitude(1,this.center.lat),qe=this._camera.position[2]/u.mercatorZfromAltitude(1,this.center.lat),Ue=[Q*We.x,Q*We.y,qe*(ke?1:$e)],He=this.cameraToCenterDistance/l.tileSize*(l.roundZoom?1:.502),Je=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?d:0,Ye=l.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,rt=l.isTerrainDEM?-Ye:this._elevation?this._elevation.getMinElevationBelowMSL():0,mt=this.projection.isReprojectedInTileSpace?no(this):1,pt=zt=>{const li=new u.MercatorCoordinate(zt.x+25e-6,zt.y,zt.z),St=new u.MercatorCoordinate(zt.x,zt.y+25e-6,zt.z),Lt=zt.toLngLat(),Ti=li.toLngLat(),ki=St.toLngLat(),Di=this.locationCoordinate(Lt),Ui=this.locationCoordinate(Ti),cn=this.locationCoordinate(ki),Fi=Math.hypot(Ui.x-Di.x,Ui.y-Di.y),Ci=Math.hypot(cn.x-Di.x,cn.y-Di.y);return Math.sqrt(Fi*Ci)*mt/25e-6},xt=zt=>{const Zt=Ye,li=rt;return{aabb:u.tileAABB(this,Q,0,0,0,zt,li,Zt,this.projection),zoom:0,x:0,y:0,minZ:li,maxZ:Zt,wrap:zt,fullyVisible:!1}},Rt=[];let kt=[];const Ct=d,si=l.reparseOverscaled?_:d,At=zt=>zt*zt,Ht=At((qe-this._centerAltitude)*$e),Ft=zt=>{if(!this._elevation||!zt.tileID||!C)return;const Zt=this._elevation.getMinMaxForTile(zt.tileID),li=zt.aabb;Zt?(li.min[2]=Zt.min,li.max[2]=Zt.max,li.center[2]=(li.min[2]+li.max[2])/2):(zt.shouldSplit=ei(zt),zt.shouldSplit||(li.min[2]=li.max[2]=li.center[2]=this._centerAltitude))},ei=zt=>{if(zt.zoom<Je)return!0;if(zt.zoom===Ct)return!1;if(null!=zt.shouldSplit)return zt.shouldSplit;const Zt=zt.aabb.distanceX(Ue),li=zt.aabb.distanceY(Ue);let St=Ht,Lt=1;if(pe){St=At(zt.aabb.distanceZ(Ue));const Di=Math.pow(2,zt.zoom),Ui=u.latFromMercatorY((zt.y+1)/Di),cn=u.latFromMercatorY(zt.y/Di),Fi=Math.min(Math.max(G,Ui),cn),Ci=u.circumferenceAtLatitude(Fi)/u.circumferenceAtLatitude(G);if(Lt=Fi===G?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ci/this._mercatorScaleRatio),this.zoom<=u.GLOBE_ZOOM_THRESHOLD_MIN&&zt.zoom===Ct-1&&Ci>=.9)return!0}else if(x&&(St=At(zt.aabb.distanceZ(Ue)*$e)),this.projection.isReprojectedInTileSpace&&_<=5){const Di=Math.pow(2,zt.zoom),Ui=pt(new u.MercatorCoordinate((zt.x+.5)/Di,(zt.y+.5)/Di));Lt=Ui>.85?1:Ui}const Ti=Zt*Zt+li*li+St;return Ti<At((1<<Ct-zt.zoom)*He*Lt*((Di,Ui)=>{if(Ui*At(.707)<Di)return 1;const cn=Math.sqrt(Ui/Di);return cn/(1.4144271570014144+(Math.pow(1.1,cn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(St,Ht),Ti))};if(this.renderWorldCopies)for(let zt=1;zt<=3;zt++)Rt.push(xt(-zt)),Rt.push(xt(zt));for(Rt.push(xt(0));Rt.length>0;){const zt=Rt.pop(),Zt=zt.x,li=zt.y;let St=zt.fullyVisible;if(!St){const Lt=zt.aabb.intersects(ze);if(0===Lt)continue;St=2===Lt}if(zt.zoom!==Ct&&ei(zt))for(let Lt=0;Lt<4;Lt++){const Ti=(Zt<<1)+Lt%2,ki=(li<<1)+(Lt>>1),Di={aabb:C?zt.aabb.quadrant(Lt):u.tileAABB(this,Q,zt.zoom+1,Ti,ki,zt.wrap,zt.minZ,zt.maxZ,this.projection),zoom:zt.zoom+1,x:Ti,y:ki,wrap:zt.wrap,fullyVisible:St,tileID:void 0,shouldSplit:void 0,minZ:zt.minZ,maxZ:zt.maxZ};x&&!pe&&(Di.tileID=new u.OverscaledTileID(zt.zoom+1===Ct?si:zt.zoom+1,zt.wrap,zt.zoom+1,Ti,ki),Ft(Di)),Rt.push(Di)}else{const Lt=zt.zoom===Ct?si:zt.zoom;if(l.minzoom&&l.minzoom>Lt)continue;const Ti=fe[0]-(.5+Zt+(zt.wrap<<zt.zoom))*(1<<d-zt.zoom),ki=fe[1]-.5-li,Di=zt.tileID?zt.tileID:new u.OverscaledTileID(Lt,zt.wrap,zt.zoom,Zt,li);kt.push({tileID:Di,distanceSq:Ti*Ti+ki*ki})}}if(this.fogCullDistSq){const zt=this.fogCullDistSq,Zt=this.horizonLineFromTop();kt=kt.filter(li=>{const St=[0,0,0,1],Lt=[u.EXTENT,u.EXTENT,0,1],Ti=this.calculateFogTileMatrix(li.tileID.toUnwrapped());u.transformMat4$1(St,St,Ti),u.transformMat4$1(Lt,Lt,Ti);const ki=u.getAABBPointSquareDist(St,Lt);if(0===ki)return!0;let Di=!1;const Ui=this._elevation;if(Ui&&ki>zt&&0!==Zt){const cn=this.calculateProjMatrix(li.tileID.toUnwrapped());let Fi;l.isTerrainDEM||(Fi=Ui.getMinMaxForTile(li.tileID)),Fi||(Fi={min:rt,max:Ye});const Ci=u.furthestTileCorner(this.rotation),jn=[Ci[0]*u.EXTENT,Ci[1]*u.EXTENT,Fi.max];u.transformMat4(jn,jn,cn),Di=(1-jn[1])*this.height*.5<Zt}return ki<zt||Di})}return kt.sort((zt,Zt)=>zt.distanceSq-Zt.distanceSq).map(zt=>zt.tileID)}resize(l,d){this.width=l,this.height=d,this.pixelsToGLUnits=[2/l,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const d=u.clamp(l.lat,-u.MAX_MERCATOR_LATITUDE,u.MAX_MERCATOR_LATITUDE),_=this.projection.project(l.lng,d);return new u.pointGeometry(_.x*this.worldSize,_.y*this.worldSize)}unproject(l){return this.projection.unproject(l.x/this.worldSize,l.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(l,d){let _,x;const C=this.centerPoint;if("globe"===this.projection.name){const G=this.worldSize;_=(d.x-C.x)/G,x=(d.y-C.y)/G}else{const G=this.pointCoordinate(d),Q=this.pointCoordinate(C);_=G.x-Q.x,x=G.y-Q.y}const F=this.locationCoordinate(l);this.setLocation(new u.MercatorCoordinate(F.x-_,F.y-x))}setLocation(l){this.center=this.coordinateLocation(l),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(l){return this.projection.locationPoint(this,l)}locationPoint3D(l){return this.projection.locationPoint(this,l,!0)}pointLocation(l){return this.coordinateLocation(this.pointCoordinate(l))}pointLocation3D(l){return this.coordinateLocation(this.pointCoordinate3D(l))}locationCoordinate(l,d){const _=d?u.mercatorZfromAltitude(d,l.lat):void 0,x=this.projection.project(l.lng,l.lat);return new u.MercatorCoordinate(x.x,x.y,_)}coordinateLocation(l){return this.projection.unproject(l.x,l.y)}pointRayIntersection(l,d){const _=d??this._centerAltitude,x=[l.x,l.y,0,1],C=[l.x,l.y,1,1];u.transformMat4$1(x,x,this.pixelMatrixInverse),u.transformMat4$1(C,C,this.pixelMatrixInverse);const F=C[3];u.scale$1(x,x,1/x[3]),u.scale$1(C,C,1/F);const G=x[2],Q=C[2];return{p0:x,p1:C,t:G===Q?0:(_-G)/(Q-G)}}screenPointToMercatorRay(l){const d=[l.x,l.y,0,1],_=[l.x,l.y,1,1];return u.transformMat4$1(d,d,this.pixelMatrixInverse),u.transformMat4$1(_,_,this.pixelMatrixInverse),u.scale$1(d,d,1/d[3]),u.scale$1(_,_,1/_[3]),d[2]=u.mercatorZfromAltitude(d[2],this._center.lat)*this.worldSize,_[2]=u.mercatorZfromAltitude(_[2],this._center.lat)*this.worldSize,u.scale$1(d,d,1/this.worldSize),u.scale$1(_,_,1/this.worldSize),new u.Ray([d[0],d[1],d[2]],u.normalize([],u.sub([],_,d)))}rayIntersectionCoordinate(l){const{p0:d,p1:_,t:x}=l,C=u.mercatorZfromAltitude(d[2],this._center.lat),F=u.mercatorZfromAltitude(_[2],this._center.lat);return new u.MercatorCoordinate(u.number(d[0],_[0],x)/this.worldSize,u.number(d[1],_[1],x)/this.worldSize,u.number(C,F,x))}pointCoordinate(l,d=this._centerAltitude){return this.projection.pointCoordinate(this,l.x,l.y,d)}pointCoordinate3D(l){if(!this.elevation)return this.pointCoordinate(l);let d=this.projection.pointCoordinate3D(this,l.x,l.y);if(d)return new u.MercatorCoordinate(d[0],d[1],d[2]);let _=0,x=this.horizonLineFromTop();if(l.y>x)return this.pointCoordinate(l);const C=.02*x,F=l.clone();for(let G=0;G<10&&x-_>C;G++){F.y=u.number(_,x,.66);const Q=this.projection.pointCoordinate3D(this,F.x,F.y);Q?(x=F.y,d=Q):_=F.y}return d?new u.MercatorCoordinate(d[0],d[1],d[2]):this.pointCoordinate(l)}isPointAboveHorizon(l){return this.projection.isPointAboveHorizon(this,l)}_coordinatePoint(l,d){const _=d&&this.elevation?this.elevation.getAtPointOrZero(l,this._centerAltitude):this._centerAltitude,x=[l.x*this.worldSize,l.y*this.worldSize,_+l.toAltitude(),1];return u.transformMat4$1(x,x,this.pixelMatrix),x[3]>0?new u.pointGeometry(x[0]/x[3],x[1]/x[3]):new u.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getGlobeBounds(){const{top:l,left:d}=this._edgeInsets,_=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,C=this.pointCoordinate3D(new u.pointGeometry(d,l)),F=this.pointCoordinate3D(new u.pointGeometry(x,l)),G=this.pointCoordinate3D(new u.pointGeometry(x,_)),Q=this.pointCoordinate3D(new u.pointGeometry(d,_));let fe=Math.min(C.x,Q.x),pe=Math.max(F.x,G.x),ke=Math.min(C.y,F.y),ze=Math.max(Q.y,G.y);const We=Math.pow(2,-this.zoom)/16,$e=(pt,xt,Rt,kt)=>{const Ct=(pt+Rt)/2,si=(xt+kt)/2,At=new u.pointGeometry(Ct,si),Ht=this.pointCoordinate3D(At),Ft=Math.max(0,fe-Ht.x,ke-Ht.y,Ht.x-pe,Ht.y-ze);fe=Math.min(fe,Ht.x),pe=Math.max(pe,Ht.x),ke=Math.min(ke,Ht.y),ze=Math.max(ze,Ht.y),Ft>We&&($e(pt,xt,Ct,si),$e(Ct,si,Rt,kt))};$e(d,l,x,l),$e(x,l,x,_),$e(x,_,d,_),$e(d,_,d,l);const[qe,Ue]=u.polesInViewport(this),He=qe||Ue,Je=qe?90:u.latFromMercatorY(ke),Ye=He?180:u.lngFromMercatorX(pe),rt=Ue?-90:u.latFromMercatorY(ze),mt=He?-180:u.lngFromMercatorX(fe);return new u.LngLatBounds(new u.LngLat(mt,rt),new u.LngLat(Ye,Je))}_getBounds(l,d){if("globe"===this.projection.name)return this._getGlobeBounds();const _=new u.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),x=new u.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),C=new u.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),F=new u.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let G=this.pointCoordinate(_,l),Q=this.pointCoordinate(x,l);const fe=this.pointCoordinate(C,d),pe=this.pointCoordinate(F,d),ke=(ze,We)=>(We.y-ze.y)/(We.x-ze.x);return G.y>1&&Q.y>=0?G=new u.MercatorCoordinate((1-pe.y)/ke(pe,G)+pe.x,1):G.y<0&&Q.y<=1&&(G=new u.MercatorCoordinate(-pe.y/ke(pe,G)+pe.x,0)),Q.y>1&&G.y>=0?Q=new u.MercatorCoordinate((1-fe.y)/ke(fe,Q)+fe.x,1):Q.y<0&&G.y<=1&&(Q=new u.MercatorCoordinate(-fe.y/ke(fe,Q)+fe.x,0)),(new u.LngLatBounds).extend(this.coordinateLocation(G)).extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(pe)).extend(this.coordinateLocation(fe))}_getBounds3D(){const l=this.elevation;if(!l.visibleDemTiles.length||l.isUsingMockSource())return this._getBounds(0,0);const d=l.visibleDemTiles.reduce((_,x)=>{if(x.dem){const C=x.dem.tree;_.min=Math.min(_.min,C.minimums[0]),_.max=Math.max(_.max,C.maximums[0])}return _},{min:Number.MAX_VALUE,max:0});return this._getBounds(d.min*l.exaggeration(),d.max*l.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(l=!0){const d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,_=this.height/2-d*(1-this._horizonShift);return l?Math.max(0,_):_}getMaxBounds(){return this.maxBounds}setMaxBounds(l){this.maxBounds=l,this.minLat=-u.MAX_MERCATOR_LATITUDE,this.maxLat=u.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,l&&(this.minLat=l.getSouth(),this.maxLat=l.getNorth(),this.minLng=l.getWest(),this.maxLng=l.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=u.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=u.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=u.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=u.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(l,d){return this.projection.createTileMatrix(this,d,l)}calculateDistanceTileData(l){const d=l.key,_=this._distanceTileDataCache;if(_[d])return _[d];const x=l.canonical,C=1/this.height,F=this.cameraWorldSize,G=F/this.zoomScale(x.z),Q=(x.x+Math.pow(2,x.z)*l.wrap)*G,fe=x.y*G,pe=this.point;pe.x*=F/this.worldSize,pe.y*=F/this.worldSize;const ke=this.angle,ze=Math.sin(-ke),We=-Math.cos(-ke);return _[d]={bearing:[ze,We],center:[(pe.x-Q)*C,(pe.y-fe)*C],scale:G/u.EXTENT*C},_[d]}calculateFogTileMatrix(l){const d=l.key,_=this._fogTileMatrixCache;if(_[d])return _[d];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,l);return u.multiply(x,this.worldToFogMatrix,x),_[d]=new Float32Array(x),_[d]}calculateProjMatrix(l,d=!1){const _=l.key,x=d?this._alignedProjMatrixCache:this._projMatrixCache;if(x[_])return x[_];const C=this.calculatePosMatrix(l,this.worldSize);return u.multiply(C,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:d?this.alignedProjMatrix:this.projMatrix,C),x[_]=new Float32Array(C),x[_]}calculatePixelsToTileUnitsMatrix(l){const d=l.tileID.key,_=this._pixelsToTileUnitsCache;if(_[d])return _[d];const x=function(C,F){const{scale:G}=C.tileTransform,Q=G*u.EXTENT/(C.tileSize*Math.pow(2,F.zoom-C.tileID.overscaledZ+C.tileID.canonical.z));return fe=new Float32Array(4),ze=(pe=F.inverseAdjustmentMatrix)[1],We=pe[2],$e=pe[3],Ue=(ke=[Q,Q])[1],fe[0]=pe[0]*(qe=ke[0]),fe[1]=ze*qe,fe[2]=We*Ue,fe[3]=$e*Ue,fe;var fe,pe,ke,ze,We,$e,qe,Ue}(l,this);return _[d]=x,_[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const l=this._elevation;this._updateCameraState();const d=u.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(d),x=this._camera.forward(),C=u.mercatorZfromAltitude(1,this._center.lat);_[2]/=C,x[2]/=C,u.normalize(x,x);const F=l.raycast(_,x,l.exaggeration());if(F){const G=u.scaleAndAdd([],_,x,F),Q=new u.MercatorCoordinate(G[0],G[1],u.mercatorZfromAltitude(G[2],u.latFromMercatorY(G[1]))),fe=(Q.z+u.length([Q.x-_[0],Q.y-_[1],Q.z-_[2]*C]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(fe),this._centerAltitude=Q.toAltitude(),this._center=this.coordinateLocation(Q),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(l=!1){if(!this._elevation)return;const d=this._elevation,_=u.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(_),C=d.getAtPointOrZero(new u.MercatorCoordinate(...x)),F=this.pixelsPerMeter/this.worldSize*C,G=this._minimumHeightOverTerrain(),Q=x[2]-F;if(Q<=G)if(Q<0||l){const fe=this.locationCoordinate(this._center,this._centerAltitude),pe=[x[0],x[1],fe.z-x[2]],ke=u.length(pe);pe[2]-=(G-Q)/this._pixelsPerMercatorPixel;const ze=u.length(pe);if(0===ze)return;u.scale$2(pe,pe,ke/ze*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],fe.z*this._pixelsPerMercatorPixel-pe[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const l="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||l){const ze=this.center;return ze.lat=u.clamp(ze.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!l)&&(ze.lng=u.clamp(ze.lng,this.minLng,this.maxLng)),this.center=ze,void(this._constraining=!1)}const d=this._unmodified,{x:_,y:x}=this.point;let C=0,F=_,G=x;const Q=this.width/2,fe=this.height/2,pe=this.worldMinY*this.scale,ke=this.worldMaxY*this.scale;if(x-fe<pe&&(G=pe+fe),x+fe>ke&&(G=ke-fe),ke-pe<this.height&&(C=Math.max(C,this.height/(ke-pe)),G=(ke+pe)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ze=this.worldMinX*this.scale,We=this.worldMaxX*this.scale,$e=this.worldSize/2-(ze+We)/2;F=(_+$e+this.worldSize)%this.worldSize-$e,F-Q<ze&&(F=ze+Q),F+Q>We&&(F=We-Q),We-ze<this.width&&(C=Math.max(C,this.width/(We-ze)),F=(We+ze)/2)}F===_&&G===x||(this.center=this.unproject(new u.pointGeometry(F,G))),C&&(this.zoom+=this.scaleZoom(C)),this._constrainCamera(),this._unmodified=d,this._constraining=!1}_minZoomForBounds(){let l=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(l=Math.max(l,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),l}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,d=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=u.mercatorZfromAltitude(1,this.center.lat)/u.mercatorZfromAltitude(1,u.GLOBE_SCALE_MATCH_LATITUDE));const _=il(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,_),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const x=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?d:1),C=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);C[8]=2*-l.x/this.width,C[9]=2*l.y/this.height;let F=u.mul([],C,x);if(this.projection.isReprojectedInTileSpace){const mt=this.locationCoordinate(this.center),pt=u.identity([]);u.translate(pt,pt,[mt.x*this.worldSize,mt.y*this.worldSize,0]),u.multiply(pt,pt,Lu(this)),u.translate(pt,pt,[-mt.x*this.worldSize,-mt.y*this.worldSize,0]),u.multiply(F,F,pt),this.inverseAdjustmentMatrix=function(xt){const Rt=Lu(xt,!0);return W([],[Rt[0],Rt[1],Rt[4],Rt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=u.scale([],F,[this.worldSize,this.worldSize,this.worldSize/d,1]),this.projMatrix=F,this.invProjMatrix=u.invert(new Float64Array(16),this.projMatrix);const G=u.invert([],C);this.frustumCorners=u.FrustumCorners.fromInvProjectionMatrix(G,this.horizonLineFromTop(),this.height);const Q=new Float32Array(16);u.identity(Q),u.scale(Q,Q,[1,-1,1]),u.rotateX(Q,Q,this._pitch),u.rotateZ(Q,Q,this.angle);const fe=u.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),pe=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;fe[8]=2*-l.x/this.width,fe[9]=2*(l.y+pe)/this.height,this.skyboxMatrix=u.multiply(Q,fe,Q);const ke=this.point,ze=ke.x,We=ke.y,$e=this.width%2/2,qe=this.height%2/2,Ue=Math.cos(this.angle),He=Math.sin(this.angle),Je=ze-Math.round(ze)+Ue*$e+He*qe,Ye=We-Math.round(We)+Ue*qe+He*$e,rt=new Float64Array(F);if(u.translate(rt,rt,[Je>.5?Je-1:Je,Ye>.5?Ye-1:Ye,0]),this.alignedProjMatrix=rt,F=u.create(),u.scale(F,F,[this.width/2,-this.height/2,1]),u.translate(F,F,[1,-1,0]),this.labelPlaneMatrix=F,F=u.create(),u.scale(F,F,[1,-1,1]),u.translate(F,F,[-1,-1,0]),u.scale(F,F,[2/this.width,2/this.height,1]),this.glCoordMatrix=F,this.pixelMatrix=u.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},F=u.invert(new Float64Array(16),this.pixelMatrix),!F)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=F,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=u.calculateGlobeMatrix(this);const mt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=u.transformMat4(mt,mt,x),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=F;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const l=this.cameraWorldSizeForFog,d=this.cameraPixelsPerMeter,_=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,C=[l,l,d];u.scale$2(C,C,x),u.scale$2(_,_,-1),u.multiply$2(_,_,C);const F=u.create();u.translate(F,F,_),u.scale(F,F,C),this.mercatorFogMatrix=F,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(l,d,x)}_computeCameraPosition(l){const d=(l=l||this.pixelsPerMeter)/this.pixelsPerMeter,_=this._camera.forward(),x=this.point,C=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*d-l/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-_[0]*C,x.y/this.worldSize-_[1]*C,l/this.worldSize*this._centerAltitude-_[2]*C]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(l){const d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),_=this._camera.position[2],x=l[2];let C=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(C=Math.min((d-_)/x,1)),this._camera.position=u.scaleAndAdd([],this._camera.position,l,C),this._updateStateFromCamera()}_updateStateFromCamera(){const l=this._camera.position,d=this._camera.forward(),{pitch:_,bearing:x}=this._camera.getPitchBearing(),C=u.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,F=this._mercatorZfromZoom(this._maxZoom)*Math.cos(u.degToRad(this._maxPitch)),G=Math.max((l[2]-C)/Math.cos(_),F),Q=this._zoomFromMercatorZ(G);u.scaleAndAdd(l,l,d,G),this._pitch=u.clamp(_,u.degToRad(this.minPitch),u.degToRad(this.maxPitch)),this.angle=u.wrap(x,-Math.PI,Math.PI),this._setZoom(u.clamp(Q,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new u.MercatorCoordinate(l[0],l[1],l[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(l){return Math.pow(2,l)*this.tileSize}_mercatorZfromZoom(l){return this.cameraToCenterDistance/this._worldSizeFromZoom(l)}_minimumHeightOverTerrain(){const l=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(l)}_zoomFromMercatorZ(l){return this.scaleZoom(this.cameraToCenterDistance/(l*this.tileSize))}zoomFromMercatorZAdjusted(l){const d=F=>{const G=this.getCameraToCenterDistance(this.projection,F);return this.scaleZoom(G/(l*this.tileSize))};let _,x=d(this.zoom),C=Math.abs(x-d(x));for(;_!==C;)x=d(x),_=C,C=Math.abs(x-d(x));return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(u.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(l,d){const _=Math.min(l.x,d.x),x=Math.max(l.x,d.x),C=Math.min(l.y,d.y),F=Math.max(l.y,d.y);if(C<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const G=[new u.pointGeometry(_,C),new u.pointGeometry(x,F),new u.pointGeometry(_,F),new u.pointGeometry(x,C)],Q=this.renderWorldCopies?-3:0,fe=this.renderWorldCopies?4:1;for(const pe of G){const ke=this.pointRayIntersection(pe);if(ke.t<0)return!0;const ze=this.rayIntersectionCoordinate(ke);if(ze.x<Q||ze.y<0||ze.x>fe||ze.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+u.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new u.pointGeometry(0,0),new u.pointGeometry(this.width,this.height))}zoomDeltaToMovement(l,d){const _=u.length(u.sub([],this._camera.position,l)),x=this._zoomFromMercatorZ(_)+d;return _-this._mercatorZfromZoom(x)}getCameraPoint(){if("globe"===this.projection.name){const l=function([d,_,x],C){const F=[d,_,x,1];u.transformMat4$1(F,F,C);const G=F[3]=Math.max(F[3],1e-6);return F[0]/=G,F[1]/=G,F[2]/=G,F}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new u.pointGeometry(l[0],l[1])}{const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.pointGeometry(0,l))}}getCameraToCenterDistance(l,d=this.zoom){const _=il(l,d,this.width,this.height,1024),x=l.pixelSpaceConversion(this.center.lat,this.worldSize,_);return.5/Math.tan(.5*this._fov)*this.height*x}getWorldToCameraMatrix(){const l=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&u.multiply(l,l,this.globeMatrix),l}}function Fh(m,l){let d=!1,_=null;const x=()=>{_=null,d&&(m(),_=setTimeout(x,l),d=!1)};return()=>(d=!0,_||x(),_)}class wi{constructor(l){this._hashName=l&&encodeURIComponent(l),u.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Fh(this._updateHashUnthrottled.bind(this),300)}addTo(l){return this._map=l,u.window.addEventListener("hashchange",this._onHashChange,!1),l.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),u.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const l=this._map;if(!l)return"";const d=ta(l);if(this._hashName){const _=this._hashName;let x=!1;const C=u.window.location.hash.slice(1).split("&").map(F=>{const G=F.split("=")[0];return G===_?(x=!0,`${G}=${d}`):F}).filter(F=>F);return x||C.push(`${_}=${d}`),`#${C.join("&")}`}return`#${d}`}_getCurrentHash(){const l=u.window.location.hash.replace("#","");if(this._hashName){let d;return l.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(d=_)}),(d&&d[1]||"").split("/")}return l.split("/")}_onHashChange(){const l=this._map;if(!l)return!1;const d=this._getCurrentHash();if(d.length>=3&&!d.some(_=>isNaN(_))){const _=l.dragRotate.isEnabled()&&l.touchZoomRotate.isEnabled()?+(d[3]||0):l.getBearing();return l.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:_,pitch:+(d[4]||0)}),!0}return!1}_updateHashUnthrottled(){const l=u.window.location.href.replace(/(#.+)?$/,this.getHashString());u.window.history.replaceState(u.window.history.state,null,l)}}function ta(m,l){const d=m.getCenter(),_=Math.round(100*m.getZoom())/100,x=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),C=Math.pow(10,x),F=Math.round(d.lng*C)/C,G=Math.round(d.lat*C)/C,Q=m.getBearing(),fe=m.getPitch();let pe=l?`/${F}/${G}/${_}`:`${_}/${G}/${F}`;return(Q||fe)&&(pe+="/"+Math.round(10*Q)/10),fe&&(pe+=`/${Math.round(fe)}`),pe}const $o={linearity:.3,easing:u.bezier(0,0,.3,1)},Bu=u.extend({deceleration:2500,maxSpeed:1400},$o),If=u.extend({deceleration:20,maxSpeed:1400},$o),Pl=u.extend({deceleration:1e3,maxSpeed:360},$o),Pf=u.extend({deceleration:1e3,maxSpeed:90},$o);class Jd{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:u.exported.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,d=u.exported.now();for(;l.length>0&&d-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new u.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:C}of this._inertiaBuffer)d.zoom+=C.zoomDelta||0,d.bearing+=C.bearingDelta||0,d.pitch+=C.pitchDelta||0,C.panDelta&&d.pan._add(C.panDelta),C.around&&(d.around=C.around),C.pinchAround&&(d.pinchAround=C.pinchAround);const _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(d.pan.mag()){const C=uc(d.pan.mag(),_,u.extend({},Bu,l||{}));x.offset=d.pan.mult(C.amount/d.pan.mag()),x.center=this._map.transform.center,Or(x,C)}if(d.zoom){const C=uc(d.zoom,_,If);x.zoom=this._map.transform.zoom+C.amount,Or(x,C)}if(d.bearing){const C=uc(d.bearing,_,Pl);x.bearing=this._map.transform.bearing+u.clamp(C.amount,-179,179),Or(x,C)}if(d.pitch){const C=uc(d.pitch,_,Pf);x.pitch=this._map.transform.pitch+C.amount,Or(x,C)}if(x.zoom||x.bearing){const C=void 0===d.pinchAround?d.around:d.pinchAround;x.around=C?this._map.unproject(C):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function Or(m,l){(!m.duration||m.duration<l.duration)&&(m.duration=l.duration,m.easing=l.easing)}function uc(m,l,d){const{maxSpeed:_,linearity:x,deceleration:C}=d,F=u.clamp(m*x/(l/1e3),-_,_),G=Math.abs(F)/(C*x);return{easing:d.easing,duration:1e3*G,amount:F*(G/2)}}class Fs extends u.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,_,x={}){const C=I(d.getCanvasContainer(),_),F=d.unproject(C);super(l,u.extend({point:C,lngLat:F,originalEvent:_},x)),this._defaultPrevented=!1,this.target=d}}class Ol extends u.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,_){const x="touchend"===l?_.changedTouches:_.touches,C=B(d.getCanvasContainer(),x),F=C.map(Q=>d.unproject(Q)),G=C.reduce((Q,fe,pe,ke)=>Q.add(fe.div(ke.length)),new u.pointGeometry(0,0));super(l,{points:C,point:G,lngLats:F,lngLat:d.unproject(G),originalEvent:_}),this._defaultPrevented=!1}}class ko extends u.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,_){super(l,{originalEvent:_}),this._defaultPrevented=!1}}class Bg{constructor(l,d){this._map=l,this._clickTolerance=d.clickTolerance}reset(){this._mousedownPos=void 0}wheel(l){return this._firePreventable(new ko(l.type,this._map,l))}mousedown(l,d){return this._mousedownPos=d,this._firePreventable(new Fs(l.type,this._map,l))}mouseup(l){this._map.fire(new Fs(l.type,this._map,l))}preclick(l){const d=u.extend({},l);d.type="preclick",this._map.fire(new Fs(d.type,this._map,d))}click(l,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(l),this._map.fire(new Fs(l.type,this._map,l)))}dblclick(l){return this._firePreventable(new Fs(l.type,this._map,l))}mouseover(l){this._map.fire(new Fs(l.type,this._map,l))}mouseout(l){this._map.fire(new Fs(l.type,this._map,l))}touchstart(l){return this._firePreventable(new Ol(l.type,this._map,l))}touchmove(l){this._map.fire(new Ol(l.type,this._map,l))}touchend(l){this._map.fire(new Ol(l.type,this._map,l))}touchcancel(l){this._map.fire(new Ol(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ep{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(l){this._map.fire(new Fs(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Fs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new Fs(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class dc{constructor(l,d){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,d){this.isEnabled()&&l.shiftKey&&0===l.button&&(Y(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(l,d){if(!this._active)return;const _=d,x=this._startPos,C=this._lastPos;if(!x||!C||C.equals(_)||!this._box&&_.dist(x)<this._clickTolerance)return;this._lastPos=_,this._box||(this._box=Se("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));const F=Math.min(x.x,_.x),G=Math.max(x.x,_.x),Q=Math.min(x.y,_.y),fe=Math.max(x.y,_.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${F}px,${Q}px)`,this._box.style.width=G-F+"px",this._box.style.height=fe-Q+"px")})}mouseupWindow(l,d){if(!this._active)return;const _=this._startPos,x=d;if(_&&0===l.button){if(this.reset(),R(),_.x!==x.x||_.y!==x.y)return this._map.fire(new u.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:C=>C.fitScreenCoordinates(_,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",l)}}keydown(l){this._active&&27===l.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",l))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),j(),delete this._startPos,delete this._lastPos}_fireEvent(l,d){return this._map.fire(new u.Event(l,{originalEvent:d}))}}function vo(m,l){const d={};for(let _=0;_<m.length;_++)d[m[_].identifier]=l[_];return d}class zu{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(l,d,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=l.timeStamp),_.length===this.numTouches&&(this.centroid=function(x){const C=new u.pointGeometry(0,0);for(const F of x)C._add(F);return C.div(x.length)}(d),this.touches=vo(_,d)))}touchmove(l,d,_){if(this.aborted||!this.centroid)return;const x=vo(_,d);for(const C in this.touches){const F=this.touches[C],G=x[C];(!G||G.dist(F)>30)&&(this.aborted=!0)}}touchend(l,d,_){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),0===_.length){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class pc{constructor(l){this.singleTap=new zu(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(l,d,_){this.singleTap.touchstart(l,d,_)}touchmove(l,d,_){this.singleTap.touchmove(l,d,_)}touchend(l,d,_){const x=this.singleTap.touchend(l,d,_);if(x){const C=l.timeStamp-this.lastTime<500,F=!this.lastTap||this.lastTap.dist(x)<30;if(C&&F||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Of{constructor(){this._zoomIn=new pc({numTouches:1,numTaps:2}),this._zoomOut=new pc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,d,_){this._zoomIn.touchstart(l,d,_),this._zoomOut.touchstart(l,d,_)}touchmove(l,d,_){this._zoomIn.touchmove(l,d,_),this._zoomOut.touchmove(l,d,_)}touchend(l,d,_){const x=this._zoomIn.touchend(l,d,_),C=this._zoomOut.touchend(l,d,_);return x?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:F.getZoom()+1,around:F.unproject(x)},{originalEvent:l})}):C?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:F.getZoom()-1,around:F.unproject(C)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const fa={0:1,2:2};class Uc{constructor(l){this.reset(),this._clickTolerance=l.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(l,d){return!1}_move(l,d){return{}}mousedown(l,d){if(this._lastPoint)return;const _=P(l);this._correctButton(l,_)&&(this._lastPoint=d,this._eventButton=_)}mousemoveWindow(l,d){const _=this._lastPoint;if(_)if(l.preventDefault(),null!=this._eventButton&&function(x,C){const F=fa[C];return void 0===x.buttons||(x.buttons&F)!==F}(l,this._eventButton))this.reset();else if(this._moved||!(d.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(_,d)}mouseupWindow(l){this._lastPoint&&P(l)===this._eventButton&&(this._moved&&R(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vu extends Uc{mousedown(l,d){super.mousedown(l,d),this._lastPoint&&(this._active=!0)}_correctButton(l,d){return 0===d&&!l.ctrlKey}_move(l,d){return{around:d,panDelta:d.sub(l)}}}class hn extends Uc{_correctButton(l,d){return 0===d&&l.ctrlKey||2===d}_move(l,d){const _=.8*(d.x-l.x);if(_)return this._active=!0,{bearingDelta:_}}contextmenu(l){l.preventDefault()}}class ju extends Uc{_correctButton(l,d){return 0===d&&l.ctrlKey||2===d}_move(l,d){const _=-.5*(d.y-l.y);if(_)return this._active=!0,{pitchDelta:_}}contextmenu(l){l.preventDefault()}}class zg{constructor(l,d){this._map=l,this._el=l.getCanvasContainer(),this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset(),u.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new u.pointGeometry(0,0)}touchstart(l,d,_){return this._calculateTransform(l,d,_)}touchmove(l,d,_){if(this._active&&!(_.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===_.length&&!u.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return l.cancelable&&l.preventDefault(),this._calculateTransform(l,d,_)}}touchend(l,d,_){this._calculateTransform(l,d,_),this._active&&_.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,d,_){_.length>0&&(this._active=!0);const x=vo(_,d),C=new u.pointGeometry(0,0),F=new u.pointGeometry(0,0);let G=0;for(const fe in x){const pe=x[fe],ke=this._touches[fe];ke&&(C._add(pe),F._add(pe.sub(ke)),G++,x[fe]=pe)}if(this._touches=x,G<this._minTouches||!F.mag())return;const Q=F.div(G);return this._sum._add(Q),this._sum.mag()<this._clickTolerance?void 0:{around:C.div(G),panDelta:Q}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Se("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Uu{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(l){}_move(l,d,_){return{}}touchstart(l,d,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([d[0],d[1]]))}touchmove(l,d,_){const x=this._firstTwoTouches;if(!x)return;l.preventDefault();const[C,F]=x,G=nl(_,d,C),Q=nl(_,d,F);if(!G||!Q)return;const fe=this._aroundCenter?null:G.add(Q).div(2);return this._move([G,Q],fe,l)}touchend(l,d,_){if(!this._firstTwoTouches)return;const[x,C]=this._firstTwoTouches,F=nl(_,d,x),G=nl(_,d,C);F&&G||(this._active&&R(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&"center"===l.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function nl(m,l,d){for(let _=0;_<m.length;_++)if(m[_].identifier===d)return l[_]}function tp(m,l){return Math.log(m/l)/Math.LN2}class ip extends Uu{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,d){const _=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(tp(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:tp(this._distance,_),pinchAround:d}}}function Rf(m,l){return 180*m.angleWith(l)/Math.PI}class Lf extends Uu{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,d){const _=this._vector;if(this._vector=l[0].sub(l[1]),_&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Rf(this._vector,_),pinchAround:d}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const d=25/(Math.PI*this._minDiameter)*360,_=this._startVector;if(!_)return!1;const x=Rf(l,_);return Math.abs(x)<d}}function ai(m){return Math.abs(m.y)>Math.abs(m.x)}class Vn extends Uu{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(l){this._lastPoints=l,ai(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,d,_){const x=this._lastPoints;if(!x)return;const C=l[0].sub(x[0]),F=l[1].sub(x[1]);return this._map._cooperativeGestures&&!u.isFullscreen()&&_.touches.length<3||(this._valid=this.gestureBeginsVertically(C,F,_.timeStamp),!this._valid)?void 0:(this._lastPoints=l,this._active=!0,{pitchDelta:(C.y+F.y)/2*-.5})}gestureBeginsVertically(l,d,_){if(void 0!==this._valid)return this._valid;const x=l.mag()>=2,C=d.mag()>=2;if(!x&&!C)return;if(!x||!C)return null==this._firstMove&&(this._firstMove=_),_-this._firstMove<100&&void 0;const F=l.y>0==d.y>0;return ai(l)&&ai(d)&&F}}const Io={panStep:100,bearingStep:15,pitchStep:10};class lr{constructor(){const l=Io;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let d=0,_=0,x=0,C=0,F=0;switch(l.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:l.shiftKey?_=-1:(l.preventDefault(),C=-1);break;case 39:l.shiftKey?_=1:(l.preventDefault(),C=1);break;case 38:l.shiftKey?x=1:(l.preventDefault(),F=-1);break;case 40:l.shiftKey?x=-1:(l.preventDefault(),F=1);break;default:return}return this._rotationDisabled&&(_=0,x=0),{cameraAnimation:G=>{const Q=G.getZoom();G.easeTo({duration:300,easeId:"keyboardHandler",easing:uo,zoom:d?Math.round(Q)+d*(l.shiftKey?2:1):Q,bearing:G.getBearing()+_*this._bearingStep,pitch:G.getPitch()+x*this._pitchStep,offset:[-C*this._panStep,-F*this._panStep],center:G.getCenter()},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function uo(m){return m*(2-m)}const Hu=4.000244140625;class Nh{constructor(l,d){this._map=l,this._el=l.getCanvasContainer(),this._handler=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,u.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&"center"===l.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(l.ctrlKey||l.metaKey||this.isZooming()||u.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let d=l.deltaMode===u.window.WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const _=u.exported.now(),x=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,0!==d&&d%Hu==0?this._type="wheel":0!==d&&Math.abs(d)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(x*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),l.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=l,this._delta-=d,this._active||this._start(l)),l.preventDefault()}_onTimeout(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=I(this._el,l);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._map.transform;"wheel"===this._type&&l.projection.wrap&&(l._center.lng>=180||l._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const d=()=>l._terrainEnabled()&&this._aroundCoord?l.computeZoomRelativeTo(this._aroundCoord):l.zoom;if(0!==this._delta){const Q="wheel"===this._type&&Math.abs(this._delta)>Hu?this._wheelZoomRate:this._defaultZoomRate;let fe=2/(1+Math.exp(-Math.abs(this._delta*Q)));this._delta<0&&0!==fe&&(fe=1/fe);const pe=d(),ke=Math.pow(2,pe),ze="number"==typeof this._targetZoom?l.zoomScale(this._targetZoom):ke;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(ze*fe))),"wheel"===this._type&&(this._startZoom=pe,this._easing=this._smoothOutEasing(200)),this._delta=0}const _="number"==typeof this._targetZoom?this._targetZoom:d(),x=this._startZoom,C=this._easing;let F,G=!1;if("wheel"===this._type&&x&&C){const Q=Math.min((u.exported.now()-this._lastWheelEventTime)/200,1),fe=C(Q);F=u.number(x,_,fe),Q<1?this._frameId||(this._frameId=!0):G=!0}else F=_,G=!0;return this._active=!0,G&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!G,zoomDelta:F-d(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let d=u.ease;if(this._prevEase){const _=this._prevEase,x=(u.exported.now()-_.start)/_.duration,C=_.easing(x+.01)-_.easing(x),F=.27/Math.sqrt(C*C+1e-4)*.01,G=Math.sqrt(.0729-F*F);d=u.bezier(F,G,.25,1)}return this._prevEase={start:u.exported.now(),duration:l,easing:d},d}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Se("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(u.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Fa{constructor(l,d){this._clickZoom=l,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ma{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(l,d){return l.preventDefault(),{cameraAnimation:_=>{_.easeTo({duration:300,zoom:_.getZoom()+(l.shiftKey?-1:1),around:_.unproject(d)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gu{constructor(){this._tap=new pc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(l,d,_){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=d[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(l,d,_))}touchmove(l,d,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;const x=d[0],C=x.y-this._swipePoint.y;return this._swipePoint=x,l.preventDefault(),this._active=!0,{zoomDelta:C/128}}}else this._tap.touchmove(l,d,_)}touchend(l,d,_){this._tapTime?this._swipePoint&&0===_.length&&this.reset():this._tap.touchend(l,d,_)&&(this._tapTime=l.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Bh{constructor(l,d,_){this._el=l,this._mousePan=d,this._touchPan=_}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Na{constructor(l,d,_){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=d,this._mousePitch=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class np{constructor(l,d,_,x){this._el=l,this._touchZoom=d,this._touchRotate=_,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ei=m=>m.zoom||m.drag||m.pitch||m.rotate;class Wo extends u.Event{}class Ba{constructor(){this.constants=[1,1,.01],this.radius=0}setup(l,d){const _=u.sub([],d,l);this.radius=u.length(_[2]<0?u.div([],_,this.constants):[_[0],_[1],0])}projectRay(l){u.div(l,l,this.constants),u.normalize(l,l),u.mul$1(l,l,this.constants);const d=u.scale$2([],l,this.radius);if(d[2]>0){const _=u.scale$2([],[0,0,1],u.dot(d,[0,0,1])),x=u.scale$2([],u.normalize([],[d[0],d[1],0]),this.radius),C=u.add([],d,u.scale$2([],u.sub([],u.add([],x,_),d),2));d[0]=C[0],d[1]=C[1]}return d}}function rl(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class za{constructor(l,d){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Jd(l),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ba,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),u.bindAll(["handleEvent","handleWindowEvent"],this);const _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[u.window.document,"mousemove",{capture:!0}],[u.window.document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[u.window,"blur",void 0]];for(const[x,C,F]of this._listeners)x.addEventListener(C,x===u.window.document?this.handleWindowEvent:this.handleEvent,F)}destroy(){for(const[l,d,_]of this._listeners)l.removeEventListener(d,l===u.window.document?this.handleWindowEvent:this.handleEvent,_)}_addDefaultHandlers(l){const d=this._map,_=d.getCanvasContainer();this._add("mapEvent",new Bg(d,l));const x=d.boxZoom=new dc(d,l);this._add("boxZoom",x);const C=new Of,F=new ma;d.doubleClickZoom=new Fa(F,C),this._add("tapZoom",C),this._add("clickZoom",F);const G=new Gu;this._add("tapDragZoom",G);const Q=d.touchPitch=new Vn(d);this._add("touchPitch",Q);const fe=new hn(l),pe=new ju(l);d.dragRotate=new Na(l,fe,pe),this._add("mouseRotate",fe,["mousePitch"]),this._add("mousePitch",pe,["mouseRotate"]);const ke=new Vu(l),ze=new zg(d,l);d.dragPan=new Bh(_,ke,ze),this._add("mousePan",ke),this._add("touchPan",ze,["touchZoom","touchRotate"]);const We=new Lf,$e=new ip;d.touchZoomRotate=new np(_,$e,We,G),this._add("touchRotate",We,["touchPan","touchZoom"]),this._add("touchZoom",$e,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ep(d));const qe=d.scrollZoom=new Nh(d,this);this._add("scrollZoom",qe,["mousePan"]);const Ue=d.keyboard=new lr;this._add("keyboard",Ue);for(const He of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])l.interactive&&l[He]&&d[He].enable(l[He])}_add(l,d,_){this._handlers.push({handlerName:l,handler:d,allowed:_}),this._handlersById[l]=d}stop(l){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ei(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(l,d,_){for(const x in l)if(x!==_&&(!d||d.indexOf(x)<0))return!0;return!1}handleWindowEvent(l){this.handleEvent(l,`${l.type}Window`)}_getMapTouches(l){const d=[];for(const _ of l)this._el.contains(_.target)&&d.push(_);return d}handleEvent(l,d){this._updatingCamera=!0;const _="renderFrame"===l.type,x=_?void 0:l,C={needsRenderFrame:!1},F={},G={},Q=l.touches?this._getMapTouches(l.touches):void 0,fe=Q?B(this._el,Q):_?void 0:I(this._el,l);for(const{handlerName:ze,handler:We,allowed:$e}of this._handlers){if(!We.isEnabled())continue;let qe;this._blockedByActive(G,$e,ze)?We.reset():We[d||l.type]&&(qe=We[d||l.type](l,fe,Q),this.mergeHandlerResult(C,F,qe,ze,x),qe&&qe.needsRenderFrame&&this._triggerRenderFrame()),(qe||We.isActive())&&(G[ze]=We)}const pe={};for(const ze in this._previousActiveHandlers)G[ze]||(pe[ze]=x);this._previousActiveHandlers=G,(Object.keys(pe).length||rl(C))&&(this._changes.push([C,F,pe]),this._triggerRenderFrame()),(Object.keys(G).length||rl(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ke}=C;ke&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ke(this._map))}mergeHandlerResult(l,d,_,x,C){if(!_)return;u.extend(l,_);const F={handlerName:x,originalEvent:_.originalEvent||C};void 0!==_.zoomDelta&&(d.zoom=F),void 0!==_.panDelta&&(d.drag=F),void 0!==_.pitchDelta&&(d.pitch=F),void 0!==_.bearingDelta&&(d.rotate=F)}_applyChanges(){const l={},d={},_={};for(const[x,C,F]of this._changes)x.panDelta&&(l.panDelta=(l.panDelta||new u.pointGeometry(0,0))._add(x.panDelta)),x.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+x.pitchDelta),void 0!==x.around&&(l.around=x.around),void 0!==x.aroundCoord&&(l.aroundCoord=x.aroundCoord),void 0!==x.pinchAround&&(l.pinchAround=x.pinchAround),x.noInertia&&(l.noInertia=x.noInertia),u.extend(d,C),u.extend(_,F);this._updateMapTransform(l,d,_),this._changes=[]}_updateMapTransform(l,d,_){const x=this._map,C=x.transform,F=Je=>[Je.x,Je.y,Je.z];if((Je=>{const Ye=this._eventsInProgress.drag;return Ye&&!this._handlersById[Ye.handlerName].isActive()})()&&!rl(l)){const Je=C.zoom;C.cameraElevationReference="sea",C.recenterOnTerrain(),C.cameraElevationReference="ground",Je!==C.zoom&&this._map._update(!0)}if(C._isCameraConstrained&&x._stop(!0),!rl(l))return void this._fireEvents(d,_,!0);let{panDelta:G,zoomDelta:Q,bearingDelta:fe,pitchDelta:pe,around:ke,aroundCoord:ze,pinchAround:We}=l;C._isCameraConstrained&&(Q>0&&(Q=0),C._isCameraConstrained=!1),void 0!==We&&(ke=We),(Je=>d.drag&&!this._eventsInProgress.drag)()&&ke&&(this._dragOrigin=F(C.pointCoordinate3D(ke)),this._trackingEllipsoid.setup(C._camera.position,this._dragOrigin)),C.cameraElevationReference="sea",x._stop(!0),ke=ke||x.transform.centerPoint,fe&&(C.bearing+=fe),pe&&(C.pitch+=pe),C._updateCameraState();const $e=[0,0,0];if(G)if("mercator"===C.projection.name){const Je=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(ke).dir),Ye=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(ke.sub(G)).dir);$e[0]=Ye[0]-Je[0],$e[1]=Ye[1]-Je[1]}else{const Je=C.pointCoordinate(ke);if("globe"===C.projection.name){G=G.rotate(-C.angle);const Ye=C._pixelsPerMercatorPixel/C.worldSize;$e[0]=-G.x*u.mercatorScale(u.latFromMercatorY(Je.y))*Ye,$e[1]=-G.y*u.mercatorScale(C.center.lat)*Ye}else{const Ye=C.pointCoordinate(ke.sub(G));Je&&Ye&&($e[0]=Ye.x-Je.x,$e[1]=Ye.y-Je.y)}}const qe=C.zoom,Ue=[0,0,0];if(Q){const Je=F(ze||C.pointCoordinate3D(ke)),Ye={dir:u.normalize([],u.sub([],Je,C._camera.position))};if(Ye.dir[2]<0){const rt=C.zoomDeltaToMovement(Je,Q);u.scale$2(Ue,Ye.dir,rt)}}const He=u.add($e,$e,Ue);C._translateCameraConstrained(He),Q&&Math.abs(C.zoom-qe)>1e-4&&C.recenterOnTerrain(),C.cameraElevationReference="ground",this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(d,_,!0)}_fireEvents(l,d,_){const x=Ei(this._eventsInProgress),C=Ei(l),F={};for(const pe in l){const{originalEvent:ke}=l[pe];this._eventsInProgress[pe]||(F[`${pe}start`]=ke),this._eventsInProgress[pe]=l[pe]}!x&&C&&this._fireEvent("movestart",C.originalEvent);for(const pe in F)this._fireEvent(pe,F[pe]);C&&this._fireEvent("move",C.originalEvent);for(const pe in l){const{originalEvent:ke}=l[pe];this._fireEvent(pe,ke)}const G={};let Q;for(const pe in this._eventsInProgress){const{handlerName:ke,originalEvent:ze}=this._eventsInProgress[pe];this._handlersById[ke].isActive()||(delete this._eventsInProgress[pe],Q=d[ke]||ze,G[`${pe}end`]=Q)}for(const pe in G)this._fireEvent(pe,G[pe]);const fe=Ei(this._eventsInProgress);if(_&&(x||C)&&!fe){this._updatingCamera=!0;const pe=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ke=ze=>0!==ze&&-this._bearingSnap<ze&&ze<this._bearingSnap;pe?(ke(pe.bearing||this._map.getBearing())&&(pe.bearing=0),this._map.easeTo(pe,{originalEvent:Q})):(this._map.fire(new u.Event("moveend",{originalEvent:Q})),ke(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(l,d){this._map.fire(new u.Event(l,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{this._frameId=void 0,this.handleEvent(new Wo("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const ga="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ff extends u.Evented{constructor(l,d){super(),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=d.bearingSnap,u.bindAll(["_renderFrameCallback"],this)}getCenter(){return new u.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(l,d){return this.jumpTo({center:l},d)}panBy(l,d,_){return l=u.pointGeometry.convert(l).mult(-1),this.panTo(this.transform.center,u.extend({offset:l},d),_)}panTo(l,d,_){return this.easeTo(u.extend({center:l},d),_)}getZoom(){return this.transform.zoom}setZoom(l,d){return this.jumpTo({zoom:l},d),this}zoomTo(l,d,_){return this.easeTo(u.extend({zoom:l},d),_)}zoomIn(l,d){return this.zoomTo(this.getZoom()+1,l,d),this}zoomOut(l,d){return this.zoomTo(this.getZoom()-1,l,d),this}getBearing(){return this.transform.bearing}setBearing(l,d){return this.jumpTo({bearing:l},d),this}getPadding(){return this.transform.padding}setPadding(l,d){return this.jumpTo({padding:l},d),this}rotateTo(l,d,_){return this.easeTo(u.extend({bearing:l},d),_)}resetNorth(l,d){return this.rotateTo(0,u.extend({duration:1e3},l),d),this}resetNorthPitch(l,d){return this.easeTo(u.extend({bearing:0,pitch:0,duration:1e3},l),d),this}snapToNorth(l,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,d):this}getPitch(){return this.transform.pitch}setPitch(l,d){return this.jumpTo({pitch:l},d),this}cameraForBounds(l,d){l=u.LngLatBounds.convert(l);const _=d&&d.bearing||0,x=d&&d.pitch||0,C=l.getNorthWest(),F=l.getSouthEast();return this._cameraForBounds(this.transform,C,F,_,x,d)}_extendCameraOptions(l){const d={top:0,bottom:0,right:0,left:0};if("number"==typeof(l=u.extend({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding){const _=l.padding;l.padding={top:_,bottom:_,right:_,left:_}}return l.padding=u.extend(d,l.padding),l}_minimumAABBFrustumDistance(l,d){const _=d.max[0]-d.min[0],x=d.max[1]-d.min[1];return _/x>l.aspect?_/(2*Math.tan(.5*l.fovX)*l.aspect):x/(2*Math.tan(.5*l.fovY)*l.aspect)}_cameraForBoundsOnGlobe(l,d,_,x,C,F){const G=l.clone(),Q=this._extendCameraOptions(F);G.bearing=x,G.pitch=C;const fe=u.LngLat.convert(d),pe=u.LngLat.convert(_),ke=.5*(fe.lat+pe.lat),ze=.5*(fe.lng+pe.lng),We=u.latLngToECEF(ke,ze),$e=u.normalize([],We),qe=u.normalize([],u.cross([],$e,[0,1,0])),Ue=u.cross([],qe,$e),He=[qe[0],qe[1],qe[2],0,Ue[0],Ue[1],Ue[2],0,$e[0],$e[1],$e[2],0,0,0,0,1],Je=[We,u.latLngToECEF(fe.lat,fe.lng),u.latLngToECEF(pe.lat,fe.lng),u.latLngToECEF(pe.lat,pe.lng),u.latLngToECEF(fe.lat,pe.lng),u.latLngToECEF(ke,fe.lng),u.latLngToECEF(ke,pe.lng),u.latLngToECEF(fe.lat,ze),u.latLngToECEF(pe.lat,ze)];let Ye=u.Aabb.fromPoints(Je.map(St=>[u.dot(qe,St),u.dot(Ue,St),u.dot($e,St)]));const rt=u.transformMat4([],Ye.center,He);0===u.squaredLength(rt)&&u.set(rt,0,0,1),u.normalize(rt,rt),u.scale$2(rt,rt,u.GLOBE_RADIUS),G.center=u.ecefToLatLng(rt);const mt=G.getWorldToCameraMatrix(),pt=u.invert(new Float64Array(16),mt);Ye=u.Aabb.applyTransform(Ye,u.multiply([],mt,He)),u.transformMat4(rt,rt,mt);const xt=.5*(Ye.max[2]-Ye.min[2]),Rt=this._minimumAABBFrustumDistance(G,Ye),kt=u.scale$2([],[0,0,1],xt),Ct=u.add(kt,rt,kt),si=Rt+(0===G.pitch?0:u.distance(rt,Ct)),At=G.globeCenterInViewSpace,Ht=u.sub([],rt,[At[0],At[1],At[2]]);u.normalize(Ht,Ht),u.scale$2(Ht,Ht,si);const Ft=u.add([],rt,Ht);u.transformMat4(Ft,Ft,pt);const ei=u.earthRadius/u.GLOBE_RADIUS,zt=u.length(Ft),Zt=u.mercatorZfromAltitude(zt*ei-u.earthRadius,0),li=Math.min(G.zoomFromMercatorZAdjusted(Zt),Q.maxZoom);return li>.5*(u.GLOBE_ZOOM_THRESHOLD_MIN+u.GLOBE_ZOOM_THRESHOLD_MAX)?(G.setProjection({name:"mercator"}),G.zoom=li,this._cameraForBounds(G,d,_,x,C,F)):{center:G.center,zoom:li,bearing:x,pitch:C}}queryTerrainElevation(l,d){const _=this.transform.elevation;return _?(d=u.extend({},{exaggerated:!0},d),_.getAtPoint(u.MercatorCoordinate.fromLngLat(l),null,d.exaggerated)):null}_cameraForBounds(l,d,_,x,C,F){if("globe"===l.projection.name)return this._cameraForBoundsOnGlobe(l,d,_,x,C,F);const G=l.clone(),Q=this._extendCameraOptions(F),fe=G.padding;G.bearing=x,G.pitch=C;const pe=u.LngLat.convert(d),ke=u.LngLat.convert(_),ze=new u.LngLat(pe.lng,ke.lat),We=new u.LngLat(ke.lng,pe.lat),$e=G.project(pe),qe=G.project(ke),Ue=this.queryTerrainElevation(pe),He=this.queryTerrainElevation(ke),Je=this.queryTerrainElevation(ze),Ye=this.queryTerrainElevation(We),rt=[[$e.x,$e.y,Math.min(Ue||0,He||0,Je||0,Ye||0)],[qe.x,qe.y,Math.max(Ue||0,He||0,Je||0,Ye||0)]];let mt=u.Aabb.fromPoints(rt);const pt=G.getWorldToCameraMatrix(),xt=u.invert(new Float64Array(16),pt);mt=u.Aabb.applyTransform(mt,pt);const Rt=u.sub([],mt.max,mt.min),kt=fe.left||0,Ct=fe.right||0,si=fe.bottom||0,At=fe.top||0,{left:Ht,right:Ft,top:ei,bottom:zt}=Q.padding,Zt=.5*(kt+Ct),li=.5*(At+si),St=Math.min(G.scaleZoom(G.scale*Math.min((G.width-(kt+Ct+Ht+Ft))/Rt[0],(G.height-(si+At+zt+ei))/Rt[1])),Q.maxZoom),Lt=G.scale/G.zoomScale(St);mt=new u.Aabb([mt.min[0]-(Ht+Zt)*Lt,mt.min[1]-(zt+li)*Lt,mt.min[2]],[mt.max[0]+(Ft+Zt)*Lt,mt.max[1]+(ei+li)*Lt,mt.max[2]]);const Ti=.5*Rt[2],ki=this._minimumAABBFrustumDistance(G,mt),Di=[0,0,1,0];u.transformMat4$1(Di,Di,pt),u.normalize$2(Di,Di);const Ui=u.scale$2([],Di,ki+Ti),cn=u.add([],mt.center,Ui),Fi=("number"==typeof Q.offset.x&&"number"==typeof Q.offset.y?new u.pointGeometry(Q.offset.x,Q.offset.y):u.pointGeometry.convert(Q.offset)).rotate(-u.degToRad(x));mt.center[0]-=Fi.x*Lt,mt.center[1]+=Fi.y*Lt,u.transformMat4(mt.center,mt.center,xt),u.transformMat4(cn,cn,xt);const Ci=[mt.center[0],mt.center[1],cn[2]*G.pixelsPerMeter];u.scale$2(Ci,Ci,1/G.worldSize);const jn=u.lngFromMercatorX(Ci[0]),Un=u.latFromMercatorY(Ci[1]),cr=Math.min(G._zoomFromMercatorZ(Ci[2]),Q.maxZoom),tr=new u.LngLat(jn,Un);return G.mercatorFromTransition&&cr<.5*(u.GLOBE_ZOOM_THRESHOLD_MIN+u.GLOBE_ZOOM_THRESHOLD_MAX)?(G.setProjection({name:"globe"}),G.zoom=cr,this._cameraForBounds(G,d,_,x,C,F)):{center:tr,zoom:cr,bearing:x,pitch:C}}fitBounds(l,d,_){const x=this.cameraForBounds(l,d);return this._fitInternal(x,d,_)}fitScreenCoordinates(l,d,_,x,C){const F=u.pointGeometry.convert(l),G=u.pointGeometry.convert(d),Q=new u.pointGeometry(Math.min(F.x,G.x),Math.min(F.y,G.y)),fe=new u.pointGeometry(Math.max(F.x,G.x),Math.max(F.y,G.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(F,G))return this;const pe=this.transform.pointLocation3D(Q),ke=this.transform.pointLocation3D(fe),ze=this.transform.pointLocation3D(new u.pointGeometry(Q.x,fe.y)),We=this.transform.pointLocation3D(new u.pointGeometry(fe.x,Q.y)),$e=[Math.min(pe.lng,ke.lng,ze.lng,We.lng),Math.min(pe.lat,ke.lat,ze.lat,We.lat)],qe=[Math.max(pe.lng,ke.lng,ze.lng,We.lng),Math.max(pe.lat,ke.lat,ze.lat,We.lat)],Ue=x&&x.pitch?x.pitch:this.getPitch(),He=this._cameraForBounds(this.transform,$e,qe,_,Ue,x);return this._fitInternal(He,x,C)}_fitInternal(l,d,_){return l?(delete(d=u.extend(l,d)).padding,d.linear?this.easeTo(d,_):this.flyTo(d,_)):this}jumpTo(l,d){this.stop();const _=l.preloadOnly?this.transform.clone():this.transform;let x=!1,C=!1,F=!1;return"zoom"in l&&_.zoom!==+l.zoom&&(x=!0,_.zoom=+l.zoom),void 0!==l.center&&(_.center=u.LngLat.convert(l.center)),"bearing"in l&&_.bearing!==+l.bearing&&(C=!0,_.bearing=+l.bearing),"pitch"in l&&_.pitch!==+l.pitch&&(F=!0,_.pitch=+l.pitch),null==l.padding||_.isPaddingEqual(l.padding)||(_.padding=l.padding),l.preloadOnly?(this._preloadTiles(_),this):(this.fire(new u.Event("movestart",d)).fire(new u.Event("move",d)),x&&this.fire(new u.Event("zoomstart",d)).fire(new u.Event("zoom",d)).fire(new u.Event("zoomend",d)),C&&this.fire(new u.Event("rotatestart",d)).fire(new u.Event("rotate",d)).fire(new u.Event("rotateend",d)),F&&this.fire(new u.Event("pitchstart",d)).fire(new u.Event("pitch",d)).fire(new u.Event("pitchend",d)),this.fire(new u.Event("moveend",d)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||u.warnOnce(ga),this.transform.getFreeCameraOptions()}setFreeCameraOptions(l,d){const _=this.transform;if(!_.projection.supportsFreeCamera)return u.warnOnce(ga),this;this.stop();const x=_.zoom,C=_.pitch,F=_.bearing;_.setFreeCameraOptions(l);const G=x!==_.zoom,Q=C!==_.pitch,fe=F!==_.bearing;return this.fire(new u.Event("movestart",d)).fire(new u.Event("move",d)),G&&this.fire(new u.Event("zoomstart",d)).fire(new u.Event("zoom",d)).fire(new u.Event("zoomend",d)),fe&&this.fire(new u.Event("rotatestart",d)).fire(new u.Event("rotate",d)).fire(new u.Event("rotateend",d)),Q&&this.fire(new u.Event("pitchstart",d)).fire(new u.Event("pitch",d)).fire(new u.Event("pitchend",d)),this.fire(new u.Event("moveend",d)),this}easeTo(l,d){this._stop(!1,l.easeId),(!1===(l=u.extend({offset:[0,0],duration:500,easing:u.ease},l)).animate||!l.essential&&u.exported.prefersReducedMotion)&&(l.duration=0);const _=this.transform,x=this.getZoom(),C=this.getBearing(),F=this.getPitch(),G=this.getPadding(),Q="zoom"in l?+l.zoom:x,fe="bearing"in l?this._normalizeBearing(l.bearing,C):C,pe="pitch"in l?+l.pitch:F,ke="padding"in l?l.padding:_.padding,ze=u.pointGeometry.convert(l.offset);let We,$e,qe;if("globe"===_.projection.name){const kt=u.MercatorCoordinate.fromLngLat(_.center),Ct=ze.rotate(-_.angle);kt.x+=Ct.x/_.worldSize,kt.y+=Ct.y/_.worldSize;const si=kt.toLngLat(),At=u.LngLat.convert(l.center||si);this._normalizeCenter(At),We=_.centerPoint.add(Ct),$e=new u.pointGeometry(kt.x,kt.y).mult(_.worldSize),qe=new u.pointGeometry(u.mercatorXfromLng(At.lng),u.mercatorYfromLat(At.lat)).mult(_.worldSize).sub($e)}else{We=_.centerPoint.add(ze);const kt=_.pointLocation(We),Ct=u.LngLat.convert(l.center||kt);this._normalizeCenter(Ct),$e=_.project(kt),qe=_.project(Ct).sub($e)}const Ue=_.zoomScale(Q-x);let He,Je;l.around&&(He=u.LngLat.convert(l.around),Je=_.locationPoint(He));const Ye=this._zooming||Q!==x,rt=this._rotating||C!==fe,mt=this._pitching||pe!==F,pt=!_.isPaddingEqual(ke),xt=kt=>Ct=>{if(Ye&&(kt.zoom=u.number(x,Q,Ct)),rt&&(kt.bearing=u.number(C,fe,Ct)),mt&&(kt.pitch=u.number(F,pe,Ct)),pt&&(kt.interpolatePadding(G,ke,Ct),We=kt.centerPoint.add(ze)),He)kt.setLocationAtPoint(He,Je);else{const si=kt.zoomScale(kt.zoom-x),At=Q>x?Math.min(2,Ue):Math.max(.5,Ue),Ht=Math.pow(At,1-Ct),Ft=kt.unproject($e.add(qe.mult(Ct*Ht)).mult(si));kt.setLocationAtPoint(kt.renderWorldCopies?Ft.wrap():Ft,We)}return l.preloadOnly||this._fireMoveEvents(d),kt};if(l.preloadOnly){const kt=this._emulate(xt,l.duration,_);return this._preloadTiles(kt),this}const Rt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ye,this._rotating=rt,this._pitching=mt,this._padding=pt,this._easeId=l.easeId,this._prepareEase(d,l.noMoveStart,Rt),this._ease(xt(_),kt=>{_.recenterOnTerrain(),this._afterEase(d,kt)},l),this}_prepareEase(l,d,_={}){this._moving=!0,this.transform.cameraElevationReference="sea",d||_.moving||this.fire(new u.Event("movestart",l)),this._zooming&&!_.zooming&&this.fire(new u.Event("zoomstart",l)),this._rotating&&!_.rotating&&this.fire(new u.Event("rotatestart",l)),this._pitching&&!_.pitching&&this.fire(new u.Event("pitchstart",l))}_fireMoveEvents(l){this.fire(new u.Event("move",l)),this._zooming&&this.fire(new u.Event("zoom",l)),this._rotating&&this.fire(new u.Event("rotate",l)),this._pitching&&this.fire(new u.Event("pitch",l))}_afterEase(l,d){if(this._easeId&&d&&this._easeId===d)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const _=this._zooming,x=this._rotating,C=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new u.Event("zoomend",l)),x&&this.fire(new u.Event("rotateend",l)),C&&this.fire(new u.Event("pitchend",l)),this.fire(new u.Event("moveend",l))}flyTo(l,d){if(!l.essential&&u.exported.prefersReducedMotion){const St=u.pick(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(St,d)}this.stop(),l=u.extend({offset:[0,0],speed:1.2,curve:1.42,easing:u.ease},l);const _=this.transform,x=this.getZoom(),C=this.getBearing(),F=this.getPitch(),G=this.getPadding(),Q="zoom"in l?u.clamp(+l.zoom,_.minZoom,_.maxZoom):x,fe="bearing"in l?this._normalizeBearing(l.bearing,C):C,pe="pitch"in l?+l.pitch:F,ke="padding"in l?l.padding:_.padding,ze=_.zoomScale(Q-x),We=u.pointGeometry.convert(l.offset);let $e=_.centerPoint.add(We);const qe=_.pointLocation($e),Ue=u.LngLat.convert(l.center||qe);this._normalizeCenter(Ue);const He=_.project(qe),Je=_.project(Ue).sub(He);let Ye=l.curve;const rt=Math.max(_.width,_.height),mt=rt/ze,pt=Je.mag();if("minZoom"in l){const St=u.clamp(Math.min(l.minZoom,x,Q),_.minZoom,_.maxZoom),Lt=rt/_.zoomScale(St-x);Ye=Math.sqrt(Lt/pt*2)}const xt=Ye*Ye;function Rt(St){const Lt=(mt*mt-rt*rt+(St?-1:1)*xt*xt*pt*pt)/(2*(St?mt:rt)*xt*pt);return Math.log(Math.sqrt(Lt*Lt+1)-Lt)}function kt(St){return(Math.exp(St)-Math.exp(-St))/2}function Ct(St){return(Math.exp(St)+Math.exp(-St))/2}const si=Rt(0);let At=function(St){return Ct(si)/Ct(si+Ye*St)},Ht=function(St){return rt*((Ct(si)*(kt(Lt=si+Ye*St)/Ct(Lt))-kt(si))/xt)/pt;var Lt},Ft=(Rt(1)-si)/Ye;if(Math.abs(pt)<1e-6||!isFinite(Ft)){if(Math.abs(rt-mt)<1e-6)return this.easeTo(l,d);const St=mt<rt?-1:1;Ft=Math.abs(Math.log(mt/rt))/Ye,Ht=function(){return 0},At=function(Lt){return Math.exp(St*Ye*Lt)}}l.duration="duration"in l?+l.duration:1e3*Ft/("screenSpeed"in l?+l.screenSpeed/Ye:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0);const ei=C!==fe,zt=pe!==F,Zt=!_.isPaddingEqual(ke),li=St=>Lt=>{const Ti=Lt*Ft,ki=1/At(Ti);St.zoom=1===Lt?Q:x+St.scaleZoom(ki),ei&&(St.bearing=u.number(C,fe,Lt)),zt&&(St.pitch=u.number(F,pe,Lt)),Zt&&(St.interpolatePadding(G,ke,Lt),$e=St.centerPoint.add(We));const Di=1===Lt?Ue:St.unproject(He.add(Je.mult(Ht(Ti))).mult(ki));return St.setLocationAtPoint(St.renderWorldCopies?Di.wrap():Di,$e),St._updateCameraOnTerrain(),l.preloadOnly||this._fireMoveEvents(d),St};if(l.preloadOnly){const St=this._emulate(li,l.duration,_);return this._preloadTiles(St),this}return this._zooming=!0,this._rotating=ei,this._pitching=zt,this._padding=Zt,this._prepareEase(d,!1),this._ease(li(_),()=>this._afterEase(d),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const _=this._onEaseEnd;this._onEaseEnd=void 0,_.call(this,d)}if(!l){const _=this.handlers;_&&_.stop(!1)}return this}_ease(l,d,_){!1===_.animate||0===_.duration?(l(1),d()):(this._easeStart=u.exported.now(),this._easeOptions=_,this._onEaseFrame=l,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const l=Math.min((u.exported.now()-this._easeStart)/this._easeOptions.duration,1),d=this._onEaseFrame;d&&d(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(l,d){l=u.wrap(l,-180,180);const _=Math.abs(l-d);return Math.abs(l-360-d)<_&&(l-=360),Math.abs(l+360-d)<_&&(l+=360),l}_normalizeCenter(l){const d=this.transform;if(!d.renderWorldCopies||d.maxBounds)return;const _=l.lng-d.center.lng;l.lng+=_>180?-360:_<-180?360:0}_emulate(l,d,_){const x=Math.ceil(15*d/1e3),C=[],F=l(_.clone());for(let G=0;G<=x;G++){const Q=F(G/x);C.push(Q.clone())}return C}}class $u{constructor(l={}){this.options=l,u.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(l){const d=this.options&&this.options.compact;return this._map=l,this._container=Se("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Se("button","mapboxgl-ctrl-attrib-button",this._container),Se("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Se("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===d&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(l,d){const _=this._map._getUIString(`AttributionControl.${d}`);l.setAttribute("aria-label",_),l.removeAttribute("title"),l.firstElementChild&&l.firstElementChild.setAttribute("title",_)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));const d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||u.config.ACCESS_TOKEN}];if(l){const _=d.reduce((x,C,F)=>(C.value&&(x+=`${C.key}=${C.value}${F<d.length-1?"&":""}`),x),"?");l.href=`${u.config.FEEDBACK_URL}/${_}#${ta(this._map,!0)}`,l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}}_updateData(l){!l||"metadata"!==l.sourceDataType&&"visibility"!==l.sourceDataType&&"style"!==l.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let l=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const d=this._map.style._sourceCaches;for(const x in d){const C=d[x];if(C.used){const F=C.getSource();F.attribution&&l.indexOf(F.attribution)<0&&l.push(F.attribution)}}l.sort((x,C)=>x.length-C.length),l=l.filter((x,C)=>{for(let F=C+1;F<l.length;F++)if(l[F].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=[...this.options.customAttribution,...l]:l.unshift(this.options.customAttribution));const _=l.join(" | ");_!==this._attribHTML&&(this._attribHTML=_,l.length?(this._innerContainer.innerHTML=_,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class rp{constructor(){u.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(l){this._map=l,this._container=Se("div","mapboxgl-ctrl");const d=Se("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(l){l&&"metadata"!==l.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const l=this._map.style._sourceCaches;if(0===Object.entries(l).length)return!0;for(const d in l){const _=l[d].getSource();if(_.hasOwnProperty("mapbox_logo")&&!_.mapbox_logo)return!1}return!0}_updateCompact(){const l=this._container.children;if(l.length){const d=l[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class op{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const d=++this._id;return this._queue.push({callback:l,id:d,cancelled:!1}),d}remove(l){const d=this._currentlyRunning,_=d?this._queue.concat(d):this._queue;for(const x of _)if(x.id===l)return void(x.cancelled=!0)}run(l=0){const d=this._currentlyRunning=this._queue;this._queue=[];for(const _ of d)if(!_.cancelled&&(_.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function zh(m,l,d){if(m=new u.LngLat(m.lng,m.lat),l){const _=new u.LngLat(m.lng-360,m.lat),x=new u.LngLat(m.lng+360,m.lat),C=360*Math.ceil(Math.abs(m.lng-d.center.lng)/360),F=d.locationPoint(m).distSqr(l),G=l.x<0||l.y<0||l.x>d.width||l.y>d.height;d.locationPoint(_).distSqr(l)<F&&(G||Math.abs(_.lng-d.center.lng)<C)?m=_:d.locationPoint(x).distSqr(l)<F&&(G||Math.abs(x.lng-d.center.lng)<C)&&(m=x)}for(;Math.abs(m.lng-d.center.lng)>180;){const _=d.locationPoint(m);if(_.x>=0&&_.y>=0&&_.x<=d.width&&_.y<=d.height)break;m.lng>d.center.lng?m.lng-=360:m.lng+=360}return m}const Rl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Hc extends u.Evented{constructor(l,d){if(super(),(l instanceof u.window.HTMLElement||d)&&(l=u.extend({element:l},d)),u.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=l&&l.occludedOpacity||.2,l&&l.element)this._element=l.element,this._offset=u.pointGeometry.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=Se("div");const x=41,C=27,F=be("svg",{display:"block",height:x*this._scale+"px",width:C*this._scale+"px",viewBox:`0 0 ${C} ${x}`},this._element),G=be("radialGradient",{id:"shadowGradient"},be("defs",{},F));be("stop",{offset:"10%","stop-opacity":.4},G),be("stop",{offset:"100%","stop-opacity":.05},G),be("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},F),be("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},F),be("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},F),be("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},F),this._offset=u.pointGeometry.convert(l&&l.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",x=>{x.preventDefault()}),this._element.addEventListener("mousedown",x=>{x.preventDefault()});const _=this._element.classList;for(const x in Rl)_.remove(`mapboxgl-marker-anchor-${x}`);_.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(l){return l===this._map||(this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._updateMoving),l.on("moveend",this._update),l.on("remove",this._clearFadeTimer),l._addMarker(this),this.setDraggable(this._draggable),this._update(),l.on("click",this._onMapClick)),this}remove(){const l=this._map;return l&&(l.off("click",this._onMapClick),l.off("move",this._updateMoving),l.off("moveend",this._update),l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler),l.off("mouseup",this._onUp),l.off("touchend",this._onUp),l.off("mousemove",this._onMove),l.off("touchmove",this._onMove),l.off("remove",this._clearFadeTimer),l._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=u.LngLat.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(24.6+x)],"bottom-right":[-x,-1*(24.6+x)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=l,l._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(l){const d=l.code,_=l.charCode||l.keyCode;"Space"!==d&&"Enter"!==d&&32!==_&&13!==_||this.togglePopup()}_onMapClick(l){const d=l.originalEvent.target,_=this._element;this._popup&&(d===_||_.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const l=this._popup;return l?(l.isOpen()?(l.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(l.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const l=this._map,d=this._pos;if(!l||!d)return!1;const _=l.unproject(d),x=l.getFreeCameraOptions();if(!x.position)return!1;const C=x.position.toLngLat();return C.distanceTo(_)<.9*C.distanceTo(this._lngLat)}_evaluateOpacity(){const l=this._map;if(!l)return;const d=this._pos;if(!d||d.x<0||d.x>l.transform.width||d.y<0||d.y>l.transform.height)return void this._clearFadeTimer();const _=l.unproject(d);let x;l._showingGlobe()&&u.isLngLatBehindGlobe(l.transform,this._lngLat)?x=0:(x=1-l._queryFogOpacity(_),l.transform._terrainEnabled()&&l.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const l=this._pos;if(!l||!this._map)return;const d=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${l.x}px,${l.y}px)\n            ${Rl[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${d.x}px,${d.y}px)\n        `}_calculateXYTransform(){const l=this._pos,d=this._map,_=this.getPitchAlignment();if(!d||!l||"map"!==_)return"";if(!d._showingGlobe()){const Q=d.getPitch();return Q?`rotateX(${Q}deg)`:""}const x=u.radToDeg(u.globeTiltAtLngLat(d.transform,this._lngLat)),C=l.sub(u.globeCenterToScreenPoint(d.transform)),F=Math.abs(C.x)+Math.abs(C.y);if(0===F)return"";const G=x/F;return`rotateX(${-C.y*G}deg) rotateY(${C.x*G}deg)`}_calculateZTransform(){const l=this._pos,d=this._map;if(!d||!l)return"";let _=0;const x=this.getRotationAlignment();if("map"===x)if(d._showingGlobe()){const C=d.project(new u.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),F=d.project(new u.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(C);_=u.radToDeg(Math.atan2(F.y,F.x))-90}else _=-d.getBearing();else if("horizon"===x){const C=u.smoothstep(4,6,d.getZoom()),F=u.globeCenterToScreenPoint(d.transform);F.y+=C*d.transform.height;const G=l.sub(F),Q=u.radToDeg(Math.atan2(G.y,G.x));_=(Q>90?Q-270:Q+90)*(1-C)}return _+=this._rotation,_?`rotateZ(${_}deg)`:""}_update(l){u.window.cancelAnimationFrame(this._updateFrameId);const d=this._map;d&&(d.transform.renderWorldCopies&&(this._lngLat=zh(this._lngLat,this._pos,d.transform)),this._pos=d.project(this._lngLat),!0===l?this._updateFrameId=u.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),d._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(d._showingGlobe()||d.getTerrain()||d.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(l){return this._offset=u.pointGeometry.convert(l),this._update(),this}_onMove(l){const d=this._map;if(!d)return;const _=this._pointerdownPos,x=this._positionDelta;if(_&&x){if(!this._isDragging){const C=this._clickTolerance||d._clickTolerance;if(l.point.dist(_)<C)return;this._isDragging=!0}this._pos=l.point.sub(x),this._lngLat=d.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new u.Event("dragstart"))),this.fire(new u.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const l=this._map;l&&(l.off("mousemove",this._onMove),l.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new u.Event("dragend")),this._state="inactive"}_addDragHandler(l){const d=this._map,_=this._pos;d&&_&&this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(_),this._pointerdownPos=l.point,this._state="pending",d.on("mousemove",this._onMove),d.on("touchmove",this._onMove),d.once("mouseup",this._onUp),d.once("touchend",this._onUp))}setDraggable(l){this._draggable=!!l;const d=this._map;return d&&(l?(d.on("mousedown",this._addDragHandler),d.on("touchstart",this._addDragHandler)):(d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(l){return this._occludedOpacity=l||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Gc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Nf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Wu(m=new u.pointGeometry(0,0),l="bottom"){if("number"==typeof m){const d=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(l){case"top":return new u.pointGeometry(0,m);case"top-left":return new u.pointGeometry(d,d);case"top-right":return new u.pointGeometry(-d,d);case"bottom":return new u.pointGeometry(0,-m);case"bottom-left":return new u.pointGeometry(d,-d);case"bottom-right":return new u.pointGeometry(-d,-d);case"left":return new u.pointGeometry(m,0);case"right":return new u.pointGeometry(-m,0)}return new u.pointGeometry(0,0)}return m instanceof u.pointGeometry||Array.isArray(m)?u.pointGeometry.convert(m):u.pointGeometry.convert(m[l]||[0,0])}class Xu{constructor(l){this.jumpTo(l)}getValue(l){if(l<=this._startTime)return this._start;if(l>=this._endTime)return this._end;const d=u.easeCubicInOut((l-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(l){return l>=this._startTime&&l<=this._endTime}jumpTo(l){this._startTime=-1/0,this._endTime=-1/0,this._start=l,this._end=l}easeTo(l,d,_){this._start=this.getValue(d),this._end=l,this._startTime=d,this._endTime=d+_}}const sp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},ap={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},lp={showCompass:!0,showZoom:!0,visualizePitch:!1};class cp{constructor(l,d,_=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new hn({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,_&&(this.mousePitch=new ju({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),u.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),d.addEventListener("mousedown",this.mousedown),d.addEventListener("touchstart",this.touchstart,{passive:!1}),d.addEventListener("touchmove",this.touchmove),d.addEventListener("touchend",this.touchend),d.addEventListener("touchcancel",this.reset)}down(l,d){this.mouseRotate.mousedown(l,d),this.mousePitch&&this.mousePitch.mousedown(l,d),Y()}move(l,d){const _=this.map,x=this.mouseRotate.mousemoveWindow(l,d),C=x&&x.bearingDelta;if(C&&_.setBearing(_.getBearing()+C),this.mousePitch){const F=this.mousePitch.mousemoveWindow(l,d),G=F&&F.pitchDelta;G&&_.setPitch(_.getPitch()+G)}}off(){const l=this.element;l.removeEventListener("mousedown",this.mousedown),l.removeEventListener("touchstart",this.touchstart,{passive:!1}),l.removeEventListener("touchmove",this.touchmove),l.removeEventListener("touchend",this.touchend),l.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){j(),u.window.removeEventListener("mousemove",this.mousemove),u.window.removeEventListener("mouseup",this.mouseup)}mousedown(l){this.down(u.extend({},l,{ctrlKey:!0,preventDefault:()=>l.preventDefault()}),I(this.element,l)),u.window.addEventListener("mousemove",this.mousemove),u.window.addEventListener("mouseup",this.mouseup)}mousemove(l){this.move(l,I(this.element,l))}mouseup(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()}touchstart(l){1!==l.targetTouches.length?this.reset():(this._startPos=this._lastPos=B(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>l.preventDefault()},this._startPos))}touchmove(l){1!==l.targetTouches.length?this.reset():(this._lastPos=B(this.element,l.targetTouches)[0],this.move({preventDefault:()=>l.preventDefault()},this._lastPos))}touchend(l){0===l.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Vh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Bf={maxWidth:100,unit:"metric"};function zf(m,l,d){const _=Po(l),x=_/l,C={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[d];this._map._requestDomTask(()=>{this._container.style.width=m*x+"px",this._container.innerHTML=`${_}&nbsp;${C}`})}function Po(m){const l=Math.pow(10,`${Math.floor(m)}`.length-1);let d=m/l;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:d>=1?1:function(_){const x=Math.pow(10,Math.ceil(-Math.log(_)/Math.LN10));return Math.round(_*x)/x}(d),l*d}const ia={version:u.version,supported:me,setRTLTextPlugin:u.setRTLTextPlugin,getRTLTextPluginStatus:u.getRTLTextPluginStatus,Map:class extends Ff{constructor(m){if(u.LivePerformanceUtils.mark(u.PerformanceMarkers.create),null!=(m=u.extend({},ap,m)).minZoom&&null!=m.maxZoom&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=m.minPitch&&null!=m.maxPitch&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=m.minPitch&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=m.maxPitch&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&u.isSafariWithAntialiasingBug(u.window)&&(m.antialias=!1,u.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new hc(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._optimizeForTerrain=m.optimizeForTerrain,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new op,this._domRenderTaskQueue=new op,this._controls=[],this._markers=[],this._popups=[],this._mapId=u.uniqueId(),this._locale=u.extend({},sp,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Xu(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new u.RequestManager(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,"string"==typeof m.container){if(this._container=u.window.document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof u.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&u.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),u.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==u.window&&(u.window.addEventListener("online",this._onWindowOnline,!1),u.window.addEventListener("resize",this._onWindowResize,!1),u.window.addEventListener("orientationchange",this._onWindowResize,!1),u.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),u.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new za(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this._hash=m.hash&&new wi("string"==typeof m.hash&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,u.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),m.attributionControl&&this.addControl(new $u({customAttribution:m.customAttribution})),this._logoControl=new rp,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",l=>{this._update("style"===l.dataType),this.fire(new u.Event(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new u.Event(`${l.dataType}dataloading`,l))})}_getMapId(){return this._mapId}addControl(m,l){if(void 0===l&&(l=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=m.onAdd(this);this._controls.push(m);const _=this._controlPositions[l];return-1!==l.indexOf("bottom")?_.insertBefore(d,_.firstChild):_.appendChild(d),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(m);return l>-1&&this._controls.splice(l,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const l=!this._moving;return l&&this.fire(new u.Event("movestart",m)).fire(new u.Event("move",m)),this.fire(new u.Event("resize",m)),l&&this.fire(new u.Event("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(u.LngLatBounds.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new u.Event("zoomstart")).fire(new u.Event("zoom")).fire(new u.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new u.Event("zoomstart")).fire(new u.Event("zoom")).fire(new u.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new u.Event("pitchstart")).fire(new u.Event("pitch")).fire(new u.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new u.Event("pitchstart")).fire(new u.Event("pitch")).fire(new u.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return"auto"===m?u.window.navigator.language:Array.isArray(m)?0===m.length?void 0:m.map(l=>"auto"===l?u.window.navigator.language:l):m}setLanguage(m){const l=this._parseLanguage(m);if(!this.style||l===this._language)return this;this._language=l,this.style._reloadSources();for(const d of this._controls)d._setLanguage&&d._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(m){return this._lazyInitEmptyStyle(),m?"string"==typeof m&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const m=this.transform,l=m.projection.name;let d;"globe"===l&&m.zoom>=u.GLOBE_ZOOM_THRESHOLD_MAX?(m.setMercatorFromTransition(),d=!0):"mercator"===l&&m.zoom<u.GLOBE_ZOOM_THRESHOLD_MAX&&(m.setProjection({name:"globe"}),d=!0),d&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,l){return this._updateProjection(m||l||{name:"mercator"})}_updateProjection(m){let l;if(l="globe"===m.name&&this.transform.zoom>=u.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),l){this.painter.clearBackgroundTiles();for(const d in this.style._sourceCaches)this.style._sourceCaches[d].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(m){return this.transform.locationPoint3D(u.LngLat.convert(m))}unproject(m){return this.transform.pointLocation3D(u.pointGeometry.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,l,d){if("mouseenter"===m||"mouseover"===m){let _=!1;const x=F=>{const G=l.filter(fe=>this.getLayer(fe)),Q=G.length?this.queryRenderedFeatures(F.point,{layers:G}):[];Q.length?_||(_=!0,d.call(this,new Fs(m,this,F.originalEvent,{features:Q}))):_=!1},C=()=>{_=!1};return{layers:new Set(l),listener:d,delegates:{mousemove:x,mouseout:C}}}if("mouseleave"===m||"mouseout"===m){let _=!1;const x=F=>{const G=l.filter(Q=>this.getLayer(Q));(G.length?this.queryRenderedFeatures(F.point,{layers:G}):[]).length?_=!0:_&&(_=!1,d.call(this,new Fs(m,this,F.originalEvent)))},C=F=>{_&&(_=!1,d.call(this,new Fs(m,this,F.originalEvent)))};return{layers:new Set(l),listener:d,delegates:{mousemove:x,mouseout:C}}}{const _=x=>{const C=l.filter(G=>this.getLayer(G)),F=C.length?this.queryRenderedFeatures(x.point,{layers:C}):[];F.length&&(x.features=F,d.call(this,x),delete x.features)};return{layers:new Set(l),listener:d,delegates:{[m]:_}}}}on(m,l,d){if(void 0===d)return super.on(m,l);Array.isArray(l)||(l=[l]);const _=this._createDelegatedListener(m,l,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(_);for(const x in _.delegates)this.on(x,_.delegates[x]);return this}once(m,l,d){if(void 0===d)return super.once(m,l);Array.isArray(l)||(l=[l]);const _=this._createDelegatedListener(m,l,d);for(const x in _.delegates)this.once(x,_.delegates[x]);return this}off(m,l,d){if(void 0===d)return super.off(m,l);l=new Set(Array.isArray(l)?l:[l]);const _=(C,F)=>{if(C.size!==F.size)return!1;for(const G of C)if(!F.has(G))return!1;return!0},x=this._delegatedListeners?this._delegatedListeners[m]:void 0;return x&&(C=>{for(let F=0;F<C.length;F++){const G=C[F];if(G.listener===d&&_(G.layers,l)){for(const Q in G.delegates)this.off(Q,G.delegates[Q]);return C.splice(F,1),this}}})(x),this}queryRenderedFeatures(m,l){return this.style?(void 0!==l||void 0===m||m instanceof u.pointGeometry||Array.isArray(m)||(l=m,m=void 0),this.style.queryRenderedFeatures(m=m||[[0,0],[this.transform.width,this.transform.height]],l=l||{},this.transform)):[]}querySourceFeatures(m,l){return this.style.querySourceFeatures(m,l)}setStyle(m,l){return!1!==(l=u.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},l)).diff&&l.localIdeographFontFamily===this._localIdeographFontFamily&&l.localFontFamily===this._localFontFamily&&this.style&&m?(this._diffStyle(m,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._localFontFamily=l.localFontFamily,this._updateStyle(m,l))}_getUIString(m){const l=this._locale[m];if(null==l)throw new Error(`Missing UI string '${m}'`);return l}_updateStyle(m,l){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m&&(this.style=new co(this,l||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof m?this.style.loadURL(m):this.style.loadJSON(m)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new co(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,l){if("string"==typeof m){const d=this._requestManager.normalizeStyleURL(m),_=this._requestManager.transformRequest(d,u.ResourceType.Style);u.getJSON(_,(x,C)=>{x?this.fire(new u.ErrorEvent(x)):C&&this._updateDiff(C,l)})}else"object"==typeof m&&this._updateDiff(m,l)}_updateDiff(m,l){try{this.style.setState(m)&&this._update(!0)}catch(d){u.warnOnce(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(m,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(u.warnOnce("There is no style added to the map."),!1)}addSource(m,l){return this._lazyInitEmptyStyle(),this.style.addSource(m,l),this._update(!0)}isSourceLoaded(m){return!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){const m=this.style&&this.style._sourceCaches;for(const l in m){const d=m[l]._tiles;for(const _ in d){const x=d[_];if("loaded"!==x.state&&"errored"!==x.state)return!1}}return!0}addSourceType(m,l,d){this._lazyInitEmptyStyle(),this.style.addSourceType(m,l,d)}removeSource(m){return this.style.removeSource(m),this._updateTerrain(),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,l,{pixelRatio:d=1,sdf:_=!1,stretchX:x,stretchY:C,content:F}={}){if(this._lazyInitEmptyStyle(),l instanceof u.window.HTMLImageElement||u.window.ImageBitmap&&l instanceof u.window.ImageBitmap){const{width:G,height:Q,data:fe}=u.exported.getImageData(l);this.style.addImage(m,{data:new u.RGBAImage({width:G,height:Q},fe),pixelRatio:d,stretchX:x,stretchY:C,content:F,sdf:_,version:0})}else if(void 0===l.width||void 0===l.height)this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:G,height:Q}=l,fe=l;this.style.addImage(m,{data:new u.RGBAImage({width:G,height:Q},new Uint8Array(fe.data)),pixelRatio:d,stretchX:x,stretchY:C,content:F,sdf:_,version:0,userImage:fe}),fe.onAdd&&fe.onAdd(this,m)}}updateImage(m,l){const d=this.style.getImage(m);if(!d)return void this.fire(new u.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const _=l instanceof u.window.HTMLImageElement||u.window.ImageBitmap&&l instanceof u.window.ImageBitmap?u.exported.getImageData(l):l,{width:x,height:C}=_;void 0!==x&&void 0!==C?x===d.data.width&&C===d.data.height?(d.data.replace(_.data,!(l instanceof u.window.HTMLImageElement||u.window.ImageBitmap&&l instanceof u.window.ImageBitmap)),this.style.updateImage(m,d)):this.fire(new u.ErrorEvent(new Error(`The width and height of the updated image (${x}, ${C})\n                must be that same as the previous version of the image\n                (${d.data.width}, ${d.data.height})`))):this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new u.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,l){u.getImage(this._requestManager.transformRequest(m,u.ResourceType.Image),(d,_)=>{l(d,_ instanceof u.window.HTMLImageElement?u.exported.getImageData(_):_)})}listImages(){return this.style.listImages()}addLayer(m,l){return this._lazyInitEmptyStyle(),this.style.addLayer(m,l),this._update(!0)}moveLayer(m,l){return this.style.moveLayer(m,l),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,l,d){return this.style.setLayerZoomRange(m,l,d),this._update(!0)}setFilter(m,l,d={}){return this.style.setFilter(m,l,d),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,l,d,_={}){return this.style.setPaintProperty(m,l,d,_),this._update(!0)}getPaintProperty(m,l){return this.style.getPaintProperty(m,l)}setLayoutProperty(m,l,d,_={}){return this.style.setLayoutProperty(m,l,d,_),this._update(!0)}getLayoutProperty(m,l){return this.style.getLayoutProperty(m,l)}setLight(m,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,l),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(u.LngLat.convert(m),this.transform):0}setFeatureState(m,l){return this.style.setFeatureState(m,l),this._update()}removeFeatureState(m,l){return this.style.removeFeatureState(m,l),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,l=this._container.getBoundingClientRect().height||300;let d,_,x,C=this._container;for(;C&&(!_||!x);){const F=u.window.getComputedStyle(C).transform;F&&"none"!==F&&(d=F.match(/matrix.*\((.+)\)/)[1].split(", "),d[0]&&"0"!==d[0]&&"1"!==d[0]&&(_=d[0]),d[3]&&"0"!==d[3]&&"1"!==d[3]&&(x=d[3])),C=C.parentElement}this._containerWidth=_?Math.abs(m/_):m,this._containerHeight=x?Math.abs(l/x):l}_detectMissingCSS(){"rgb(250, 128, 114)"!==u.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&u.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=Se("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const l=this._canvasContainer=Se("div","mapboxgl-canvas-container",m);this._interactive&&l.classList.add("mapboxgl-interactive"),this._canvas=Se("canvas","mapboxgl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const d=this._controlContainer=Se("div","mapboxgl-control-container",m),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{_[x]=Se("div",`mapboxgl-ctrl-${x}`,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,l){const d=u.exported.devicePixelRatio||1;this._canvas.width=d*Math.ceil(m),this._canvas.height=d*Math.ceil(l),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${l}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const l=this._markers.indexOf(m);-1!==l&&this._markers.splice(l,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const l=this._popups.indexOf(m);-1!==l&&this._popups.splice(l,1)}_setupPainter(){const m=u.extend({},me.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),l=this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);l?(u.storeAuthState(l,!0),this.painter=new wv(l,this.transform),this.on("data",d=>{"source"===d.dataType&&this.painter.setTileLoadedFlag(!0)}),u.exported$1.testSupport(l)):this.fire(new u.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new u.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new u.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let l;const d=this.painter.context.extTimerQuery,_=u.exported.now();if(this.listens("gpu-timing-frame")&&(l=d.createQueryEXT(),d.beginQueryEXT(d.TIME_ELAPSED_EXT,l)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],u.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],u.window.performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();const x=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const G=this.transform.zoom,Q=this.transform.pitch,fe=u.exported.now(),pe=new u.EvaluationParameters(G,{now:fe,fadeDuration:x,pitch:Q,transition:this.style.getTransition()});this.style.update(pe)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let C=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),C=this._updateAverageElevation(_),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):C=this._updateAverageElevation(_),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,x,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new u.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new u.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),l){const G=u.exported.now()-_;d.endQueryEXT(d.TIME_ELAPSED_EXT,l),setTimeout(()=>{const Q=d.getQueryObjectEXT(l,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(l),this.fire(new u.Event("gpu-timing-frame",{cpuTime:G,gpuTime:Q})),u.window.performance.mark("frame-gpu",{startTime:_,detail:{gpuTime:Q}})},50)}if(this.listens("gpu-timing-layer")){const G=this.painter.collectGpuTimers();setTimeout(()=>{const Q=this.painter.queryGpuTimers(G);this.fire(new u.Event("gpu-timing-layer",{layerTimes:Q}))},50)}if(this.listens("gpu-timing-deferred-render")){const G=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const Q=this.painter.queryGpuTimeDeferredRender(G);this.fire(new u.Event("gpu-timing-deferred-render",{gpuTime:Q}))},50)}const F=this._sourcesDirty||this._styleDirty||this._placementDirty||C;if(F||this._repaint)this.triggerRepaint();else{const G=!this.isMoving()&&this.loaded();if(G&&(C=this._updateAverageElevation(_,!0)),C)this.triggerRepaint();else if(this._triggerFrame(!1),G&&(this.fire(new u.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Q=this._calculateSpeedIndex();this.fire(new u.Event("speedindexcompleted",{speedIndex:Q})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||F||(this._fullyLoaded=!0,u.LivePerformanceUtils.mark(u.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&u.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const l of this._markers)m&&!this.getRenderWorldCopies()&&(l._lngLat=l._lngLat.wrap()),l._update();for(const l of this._popups)!m||this.getRenderWorldCopies()||l._trackPointer||(l._lngLat=l._lngLat.wrap()),l._update()}_updateAverageElevation(m,l=!1){const d=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&d(0);if((l||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const _=this.transform.averageElevation;let x=this.transform.sampleAverageElevation(),C=!1;this.transform.elevation&&(C=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(x)?x=0:this._averageElevationLastSampledAt=m;const F=Math.abs(_-x);if(F>1){if(this._isInitialLoad||C)return this._averageElevation.jumpTo(x),d(x);this._averageElevation.easeTo(x,m,300)}else if(F>1e-4)return this._averageElevation.jumpTo(x),d(x)}return!!this._averageElevation.isEasing(m)&&d(this._averageElevation.getValue(m))}_authenticate(){u.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===u.AUTH_ERR_MSG||401===m.status)){const l=this.painter.context.gl;u.storeAuthState(l,!1),this._logoControl instanceof rp&&this._logoControl._updateLogo(),l&&l.clear(l.DEPTH_BUFFER_BIT|l.COLOR_BUFFER_BIT|l.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new u.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),u.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),l=this.painter.getCanvasCopiesAndTimestamps();l.timeStamps.push(performance.now());const d=this.painter.context.gl,_=d.createFramebuffer();function x(C){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,C,0);const F=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,F),F}return d.bindFramebuffer(d.FRAMEBUFFER,_),this._canvasPixelComparison(x(m),l.canvasCopies.map(x),l.timeStamps)}_canvasPixelComparison(m,l,d){let _=d[1]-d[0];const x=m.length/4;for(let C=0;C<l.length;C++){const F=l[C];let G=0;for(let Q=0;Q<F.length;Q+=4)F[Q]===m[Q]&&F[Q+1]===m[Q+1]&&F[Q+2]===m[Q+2]&&F[Q+3]===m[Q+3]&&(G+=1);_+=(d[C+2]-d[C+1])*(1-G/x)}return _}remove(){this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==u.window&&(u.window.removeEventListener("resize",this._onWindowResize,!1),u.window.removeEventListener("orientationchange",this._onWindowResize,!1),u.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),u.window.removeEventListener("online",this._onWindowOnline,!1),u.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),u.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new u.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=u.exported.frame(l=>{const d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(l)}))}_preloadTiles(m){const l=this.style?Object.values(this.style._sourceCaches):[];return u.asyncAll(l,(d,_)=>d._preloadTiles(m,_),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){"hidden"===u.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,m&&this._update())}_setCacheLimits(m,l){u.setCacheLimits(m,l)}get version(){return u.version}},NavigationControl:class{constructor(m){this.options=u.extend({},lp,m),this._container=Se("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(u.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",l=>{this._map&&this._map.zoomIn({},{originalEvent:l})}),Se("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",l=>{this._map&&this._map.zoomOut({},{originalEvent:l})}),Se("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(u.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",l=>{const d=this._map;d&&(this.options.visualizePitch?d.resetNorthPitch({},{originalEvent:l}):d.resetNorth({},{originalEvent:l}))}),this._compassIcon=Se("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const l=m.getZoom(),d=l===m.getMaxZoom(),_=l===m.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=l)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new cp(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,l){const d=Se("button",m,this._container);return d.type="button",d.addEventListener("click",l),d}_setButtonTitle(m,l){if(!this._map)return;const d=this._map._getUIString(`NavigationControl.${l}`);m.setAttribute("aria-label",d),m.firstElementChild&&m.firstElementChild.setAttribute("title",d)}},GeolocateControl:class extends u.Evented{constructor(m){super(),this.options=u.extend({geolocation:u.window.navigator.geolocation},Vh,m),u.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Fh(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=Se("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const l=(d=!!this.options.geolocation)=>{this._supportsGeolocation=d,m(d)};void 0!==this._supportsGeolocation?m(this._supportsGeolocation):void 0!==u.window.navigator.permissions?u.window.navigator.permissions.query({name:"geolocation"}).then(d=>l("denied"!==d.state)).catch(()=>l()):l()}_isOutOfMapMaxBounds(m){const l=this._map.getMaxBounds(),d=m.coords;return!!l&&(d.longitude<l.getWest()||d.longitude>l.getEast()||d.latitude<l.getSouth()||d.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new u.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(m),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new u.Event("geolocate",m)),this._finish()}}_updateCamera(m){const l=new u.LngLat(m.coords.longitude,m.coords.latitude),d=m.coords.accuracy,_=this._map.getBearing(),x=u.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(d),x,{geolocateSource:!0})}_updateMarker(m){if(m){const l=new u.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,l=u.mercatorZfromAltitude(1,m._center.lat)*m.worldSize,d=Math.ceil(2*this._accuracy*l);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(1===m.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===m.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new u.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=Se("button","mapboxgl-ctrl-geolocate",this._container),Se("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===m){u.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Se("div","mapboxgl-user-location"),this._dotElement.appendChild(Se("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Se("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Hc({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Se("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Hc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||"ACTIVE_LOCK"!==this._watchState||l.originalEvent&&"resize"===l.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new u.Event("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:!0===m.absolute&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return u.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new u.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{u.window.addEventListener("ondeviceorientationabsolute"in u.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==u.window.DeviceMotionEvent&&"function"==typeof u.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(l=>{"granted"===l&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),u.window.removeEventListener("deviceorientation",this._onDeviceOrientation),u.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:$u,ScaleControl:class{constructor(m){this.options=u.extend({},Bf,m),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=zf.bind(this)),u.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,l=this._map,d=l._containerHeight/2,_=l._containerWidth/2-m/2,x=l.unproject([_,d]),C=l.unproject([_+m,d]),F=x.distanceTo(C);if("imperial"===this.options.unit){const G=3.2808*F;G>5280?this._setScale(m,G/5280,"mile"):this._setScale(m,G,"foot")}else"nautical"===this.options.unit?this._setScale(m,F/1852,"nautical-mile"):F>=1e3?this._setScale(m,F/1e3,"kilometer"):this._setScale(m,F,"meter")}_setScale(m,l,d){const _=Po(l),x=_/l;this._map._requestDomTask(()=>{this._container.style.width=m*x+"px",this._container.innerHTML="nautical-mile"!==d?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:d}).format(_):`${_}&nbsp;nm`})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=Se("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof u.window.HTMLElement?this._container=m.container:u.warnOnce("Full screen control 'container' must be a DOM element.")),u.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in u.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in u.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=Se("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",u.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,u.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!u.window.document.fullscreenEnabled&&!u.window.document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=Se("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Se("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),u.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(u.window.document.fullscreenElement||u.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?u.window.document.exitFullscreen?u.window.document.exitFullscreen():u.window.document.webkitCancelFullScreen&&u.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends u.Evented{constructor(m){super(),this.options=u.extend(Object.create(Gc),m),u.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new u.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new u.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=u.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update();const l=this._map;return l&&(l.on("move",this._update),l.off("mousemove",this._onMouseEvent),l._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(u.window.document.createTextNode(m))}setHTML(m){const l=u.window.document.createDocumentFragment(),d=u.window.document.createElement("body");let _;for(d.innerHTML=m;_=d.firstChild,_;)l.appendChild(_);return this.setDOMContent(l)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let l=this._content;if(l)for(;l.hasChildNodes();)l.firstChild&&l.removeChild(l.firstChild);else l=this._content=Se("div","mapboxgl-popup-content",this._container||void 0);if(l.appendChild(m),this.options.closeButton){const d=this._closeButton=Se("button","mapboxgl-popup-close-button",l);d.type="button",d.setAttribute("aria-label","Close popup"),d.setAttribute("aria-hidden","true"),d.innerHTML="&#215;",d.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let l;return this._classList.delete(m)?l=!1:(this._classList.add(m),l=!0),this._updateClassList(),l}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const l=this._map,d=this._container,_=this._pos;if(!l||!d||!_)return"bottom";const x=d.offsetWidth,C=d.offsetHeight,F=_.x<x/2,G=_.x>l.transform.width-x/2;if(_.y+m<C)return F?"top-left":G?"top-right":"top";if(_.y>l.transform.height-C){if(F)return"bottom-left";if(G)return"bottom-right"}return F?"left":G?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const l=[...this._classList];l.push("mapboxgl-popup"),this._anchor&&l.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&l.push("mapboxgl-popup-track-pointer"),m.className=l.join(" ")}_update(m){const l=this._map,d=this._content;if(!l||!this._lngLat&&!this._trackPointer||!d)return;let _=this._container;if(_||(_=this._container=Se("div","mapboxgl-popup",l.getContainer()),this._tip=Se("div","mapboxgl-popup-tip",_),_.appendChild(d)),this.options.maxWidth&&_.style.maxWidth!==this.options.maxWidth&&(_.style.maxWidth=this.options.maxWidth),l.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=zh(this._lngLat,this._pos,l.transform)),!this._trackPointer||m){const x=this._pos=this._trackPointer&&m?m:l.project(this._lngLat),C=Wu(this.options.offset),F=this._anchor=this._getAnchor(C.y),G=Wu(this.options.offset,F),Q=x.add(G).round();l._requestDomTask(()=>{this._container&&F&&(this._container.style.transform=`${Rl[F]} translate(${Q.x}px,${Q.y}px)`)})}if(!this._marker&&l._showingGlobe()){const x=u.isLngLatBehindGlobe(l.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(Nf);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:Hc,Style:co,LngLat:u.LngLat,LngLatBounds:u.LngLatBounds,Point:u.pointGeometry,MercatorCoordinate:u.MercatorCoordinate,FreeCameraOptions:kf,Evented:u.Evented,config:u.config,prewarm:function(){Yi().acquire(Hi)},clearPrewarmedResources:function(){const m=Pi;m&&(m.isPreloaded()&&1===m.numActive()?(m.release(Hi),Pi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return u.config.ACCESS_TOKEN},set accessToken(m){u.config.ACCESS_TOKEN=m},get baseApiUrl(){return u.config.API_URL},set baseApiUrl(m){u.config.API_URL=m},get workerCount(){return zi.workerCount},set workerCount(m){zi.workerCount=m},get maxParallelImageRequests(){return u.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){u.config.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){u.clearTileCache(m)},workerUrl:"",workerClass:null,setNow:u.exported.setNow,restoreNow:u.exported.restoreNow};return ia}),Mn}()}},_s=>{_s(_s.s=906)}]);